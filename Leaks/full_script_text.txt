// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ****************************************Main Script**************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
  
SCRIPT_NAME Main

VAR_FLOAT one_sixteenth one_thirtysecond one_sixtyfourth

one_sixteenth = 0.0625 

one_thirtysecond = one_sixteenth / 2.0

one_sixtyfourth =  one_thirtysecond / 2.0

VAR_INT mission_trigger_wait_time

mission_trigger_wait_time = 250

// ***************************************Frankie 3 Warp Stuff******************************
// ******************************************DO NOT REMOVE!*********************************
VAR_INT flag_taken_money_off_fm3

flag_taken_money_off_fm3 = 0

// ********************************************Help Message*********************************
// ********************************************DO NOT REMOVE********************************

VAR_INT flag_player_had_gun_message

flag_player_had_gun_message = 0

// *********************************8Ball/Luigi Girls Warp Stuff****************************
// ***************************************DO NOT REMOVE*************************************
VAR_INT flag_reached_hideout

flag_reached_hideout = 0

VAR_INT flag_had_luigi_help_message

flag_had_luigi_help_message = 0

// *************************************LOCATE BLOB VARIABLE STUFF**************************
// ********************************************DO NOT REMOVE********************************

VAR_INT blob_flag

blob_flag = 0

// zero = false no blob displayed
// one = true blob is displayed
// before the loop set this flag to the way you want it displayed or nothing will happen

// *********************************TOTAL NUMBER OF MISSIONS********************************
// *****************************************************************************************

SET_TOTAL_NUMBER_OF_MISSIONS 73
SET_PROGRESS_TOTAL 0

// ********************************Player name for Cut-scene stuff**************************

VAR_INT script_controlled_player

VAR_INT controlmode //Control Config variable

// ********************************CREATE INDUSTRIAL OBJECTS********************************

VAR_INT backdoor playersdoor  //luigi_club_door
VAR_INT dogfood_factory_gate, doggy_door
VAR_INT misty_door1, misty_door2
VAR_INT explosive_drum1, explosive_drum2
VAR_INT laundrete_door1, laundrete_door2
VAR_INT fish_factory_gate 
VAR_INT Bank_job_door bankdoor1 bankdoor2
VAR_INT fuzz_door1, fuzz_door2
VAR_INT	joeys_garage_door2, joeys_garage_door3
VAR_INT target1 target2 target3
VAR_INT subway_gate_industrial tunnel_gate_industrial
VAR_INT bridge_is_damaged 
VAR_INT subway_gate_suburban1, subway_gate_suburban2, tunnel_gate_suburban

VAR_INT c_blip
VAR_INT c_blip1
c_blip = 0

VAR_FLOAT joeydoor2_X joeydoor2_Y joeydoor2_Z joeydoor3_X joeydoor3_Y joeydoor3_Z 

CREATE_OBJECT_NO_OFFSET playersdoor 890.883 -307.721 8.788 playersdoor
DONT_REMOVE_OBJECT playersdoor

CREATE_OBJECT_NO_OFFSET faketarget 1078.7 -384.8 15.4 target1
DONT_REMOVE_OBJECT target1

CREATE_OBJECT_NO_OFFSET faketarget 1080.5 -384.8 15.4 target2
DONT_REMOVE_OBJECT target2

CREATE_OBJECT_NO_OFFSET faketarget 1082.3 -384.8 15.4 target3
DONT_REMOVE_OBJECT target3

CREATE_OBJECT_NO_OFFSET Mistydoor 945.68 -272.31 4.854 misty_door1
DONT_REMOVE_OBJECT misty_door1
CREATE_OBJECT_NO_OFFSET Mistydoor 942.746 -273.712 4.854 misty_door2
DONT_REMOVE_OBJECT misty_door2
SET_OBJECT_HEADING misty_door2 180.0

CREATE_OBJECT_NO_OFFSET laundrtdoor1 845.773 -662.80 15.07 laundrete_door1
DONT_REMOVE_OBJECT laundrete_door1
CREATE_OBJECT_NO_OFFSET laundrtdoor1 845.773 -664.824 15.07 laundrete_door2
DONT_REMOVE_OBJECT laundrete_door2
SET_OBJECT_HEADING laundrete_door2 180.0

CREATE_OBJECT_NO_OFFSET joey_door1 1192.23 -867.252 14.124 joeys_garage_door2 //The moving one
DONT_REMOVE_OBJECT joeys_garage_door2
SET_OBJECT_HEADING joeys_garage_door2 45.0

CREATE_OBJECT_NO_OFFSET joey_door2 1190.12 -869.339 14.19 joeys_garage_door3
DONT_REMOVE_OBJECT joeys_garage_door3
SET_OBJECT_HEADING joeys_garage_door3 45.0

CREATE_OBJECT_NO_OFFSET electricgate 1250.4 -812.0 13.97 dogfood_factory_gate
DONT_REMOVE_OBJECT dogfood_factory_gate
SET_OBJECT_HEADING dogfood_factory_gate 225.0

CREATE_OBJECT_NO_OFFSET dogfoodoor01 1205.298 -802.908  15.0 doggy_door // 14.987 
DONT_REMOVE_OBJECT doggy_door 
SET_OBJECT_HEADING doggy_door 45.0

CREATE_OBJECT_NO_OFFSET electricgate 1016.0 -1107.955 12.294 fish_factory_gate
DONT_REMOVE_OBJECT fish_factory_gate
SET_OBJECT_HEADING fish_factory_gate 90.0

CREATE_OBJECT_NO_OFFSET bankjobdoor 1087.523 -233.801 11.012 Bank_job_door
DONT_REMOVE_OBJECT Bank_job_door

CREATE_OBJECT_NO_OFFSET chnabankdoor 1035.6 -700.793 15.334 bankdoor1	//chnabankdoor 1035.479 -700.743 15.334
DONT_REMOVE_OBJECT bankdoor1
SET_OBJECT_HEADING bankdoor1 180.0

CREATE_OBJECT_NO_OFFSET chnabankdoor 1035.6 -699.408 15.334 bankdoor2	//chnabankdoor
DONT_REMOVE_OBJECT bankdoor2
//SET_OBJECT_HEADING bankdoor2 180.0

CREATE_OBJECT_NO_OFFSET backdoor 891.056 -416.4373 14.955 backdoor
DONT_REMOVE_OBJECT backdoor		 

CREATE_OBJECT_NO_OFFSET fuzballdoor 1001.673 -887.855 15.775 fuzz_door1
SET_OBJECT_HEADING fuzz_door1 180.0
DONT_REMOVE_OBJECT fuzz_door1

CREATE_OBJECT_NO_OFFSET fuzballdoor 998.33 -887.94 15.775 fuzz_door2
SET_OBJECT_HEADING fuzz_door2 0.0
DONT_REMOVE_OBJECT fuzz_door2 

CREATE_OBJECT_NO_OFFSET subwaygate 988.963 -471.778 5.2 subway_gate_industrial
DONT_REMOVE_OBJECT subway_gate_industrial
SET_OBJECT_HEADING subway_gate_industrial 90.0   

CREATE_OBJECT_NO_OFFSET tunnelentrance 730.331 172.467 -21.075 tunnel_gate_industrial
DONT_REMOVE_OBJECT tunnel_gate_industrial

// ********************************CREATE COMMERCIAL OBJECTS********************************

VAR_INT plysav_lftdr_lft, plysav_lftdr_rght
VAR_INT police_door_one, police_door_two
VAR_INT colombian_gate, helix_barrier
VAR_INT phils_compnd_gate flag_player_on_phil_mission
VAR_INT inside_fence outside_fence
																  
CREATE_OBJECT_NO_OFFSET helix_barrier -73.137 -630.333 25.932 helix_barrier
DONT_REMOVE_OBJECT helix_barrier

CREATE_OBJECT_NO_OFFSET plysav_lftdr_lft 103.85 -482.8 16.25 plysav_lftdr_lft
DONT_REMOVE_OBJECT plysav_lftdr_lft

CREATE_OBJECT_NO_OFFSET plysav_lftdr_rght 102.192 -482.8 16.25 plysav_lftdr_rght
DONT_REMOVE_OBJECT plysav_lftdr_rght
SET_OBJECT_HEADING plysav_lftdr_rght 180.0

CREATE_OBJECT_NO_OFFSET electricgate 366.158 -1128.522 21.941 police_door_one
DONT_REMOVE_OBJECT police_door_one
SET_OBJECT_HEADING police_door_one 180.0

CREATE_OBJECT_NO_OFFSET electricgate 326.3 -1128.522 21.941 police_door_two
DONT_REMOVE_OBJECT police_door_two
SET_OBJECT_HEADING police_door_two 180.0
										
CREATE_OBJECT_NO_OFFSET electricgate 91.589 -318.592 15.296 colombian_gate
DONT_REMOVE_OBJECT colombian_gate
SET_OBJECT_HEADING colombian_gate 270.0

CREATE_OBJECT_NO_OFFSET electricgate 147.249 207.323 10.599 phils_compnd_gate
DONT_REMOVE_OBJECT phils_compnd_gate
SET_OBJECT_HEADING phils_compnd_gate 270.0

CREATE_OBJECT_NO_OFFSET fixed_inside 362.827 -341.883 17.186 inside_fence
DONT_REMOVE_OBJECT inside_fence

CREATE_OBJECT_NO_OFFSET fixed_outside 360.852 -391.405 22.622 outside_fence
DONT_REMOVE_OBJECT outside_fence

// ********************************CREATE SUBURBAN OBJECTS*********************************

VAR_INT newtowerdoor1 Columbian_gate2
VAR_INT airportdoor1 airportdoor2

CREATE_OBJECT_NO_OFFSET	newtowerdoor1 -664.313 2.883 19.51 newtowerdoor1
DONT_REMOVE_OBJECT newtowerdoor1
SET_OBJECT_HEADING newtowerdoor1 180.0

CREATE_OBJECT_NO_OFFSET Columbiangate -363.05 250.455 61.355 Columbian_gate2
DONT_REMOVE_OBJECT Columbian_gate2
SET_OBJECT_HEADING Columbian_gate2 180.0

CREATE_OBJECT_NO_OFFSET airportdoor1 -770.414 -599.292 11.847 airportdoor1
DONT_REMOVE_OBJECT airportdoor1

CREATE_OBJECT_NO_OFFSET airportdoor2 -770.414 -601.369 11.846 airportdoor2
DONT_REMOVE_OBJECT airportdoor2

// ******************************************Police Levels**********************************

SET_MAX_WANTED_LEVEL 4

// **************************************Industrial Garages*********************************

VAR_INT save_cars1, bombshop1, sprayshop1, collect_all_cars1, special_garage1, hours minutes
VAR_INT frankie_garage, Garage_bank, garage_lm2

SET_GARAGE 891.3 -311.1 7.7 898.4 -315.5 12.7 GARAGE_HIDEOUT_INDUSTRIAL save_cars1 //Saves current car to memory  

SET_GARAGE 1496.8 -686.2 11.0 1523.3 -666.8 17.0 GARAGE_COLLECTCARS_1 collect_all_cars1 //Inport/Export garage industrial
NO_SPECIAL_CAMERA_FOR_THIS_GARAGE collect_all_cars1

SET_GARAGE 1284.6 -100.5 13.6 1278.0 -111.0 18.6 GARAGE_BOMBSHOP2 bombshop1 //bomb shop - once armed waits for ped to enter car before detonation

SET_GARAGE 921.0 -367.5 9.8 928.7 -355.1 14.8 GARAGE_RESPRAY sprayshop1 //spray/repair shop    

SET_GARAGE 1428.8 -187.0 49.7 1442.5 -179.9 54.7 GARAGE_MISSION_KEEPCAR_REMAINCLOSED frankie_garage //Toni 3 and Frankie 1   
SET_ROTATING_GARAGE_DOOR frankie_garage

SET_GARAGE 1440.7 -805.6 10.9 1449.8 -782.1 15.9 GARAGE_MISSION Garage_bank //Joey 3 

SET_GARAGE 1074.0 -578.0 13.0 1085.0 -568.0 17.0 GARAGE_MISSION garage_lm2 //Luigi 2

// **************************************Commercial Garages*********************************

VAR_INT save_cars2, bombshop2, sprayshop2, garage_yd3, garage1_love1, garage2_love1, garage3_love1, garage4_love1, garage5_love1
VAR_INT garage_km2, rays_prize_garage, witsec_garage, loves_garage
VAR_FLOAT garage_min_x_yd3,	garage_min_y_yd3, garage_max_x_yd3, garage_max_y_yd3
garage_min_x_yd3 = 257.0   
garage_min_y_yd3 = -803.0
garage_max_x_yd3 = 263.0
garage_max_y_yd3 = -795.5

SET_GARAGE 115.1 -475.3 15.0 106.9 -487.1 19.0 GARAGE_HIDEOUT_COMMERCIAL save_cars2 //Saves current cars to memory

SET_GARAGE 386.0 -573.0 25.2 376.6 -580.1 30.2 GARAGE_BOMBSHOP1 bombshop2 // bomb shop - once armed waits 5 seconds then detonates

SET_GARAGE 386.0 -490.0 25.2 376.6 -497.0 30.2 GARAGE_RESPRAY sprayshop2 // Spray shop 

SET_GARAGE 245.4 -992.2 20.0 234.4 -1000.5 24.0 GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE rays_prize_garage //RAY 6 - MARKED MAN (BY SPRAYSHOP)
SET_ROTATING_GARAGE_DOOR rays_prize_garage
  
SET_GARAGE 375.0 -441.5 20.0837 386.0 -434.0 25.0837 GARAGE_FORCARTOCOMEOUTOF witsec_garage //RAY 1 - SILENCE THE SNEAK (BEHIND CARPARK)

SET_GARAGE 377.3 -511.4 25.1132 383.7 -502.0 30.0 GARAGE_MISSION garage_km2 //Kenji 2 

SET_GARAGE 63.8 -307.9 15.2 70.0 -316.7 19.2 GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE garage1_love1 //Love 1
SET_GARAGE 53.0 -308.0 15.2 60.0 -316.7 19.2 GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE garage2_love1 //Love 1
SET_GARAGE 24.9 -344.0 15.2 30.6 -337.1 19.2 GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE garage3_love1 //Love 1
SET_GARAGE 24.5 -355.0 15.2 30.6 -346.0 19.2 GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE garage4_love1 //Love 1
SET_GARAGE 52.5 -388.0 15.2 42.0 -374.1 19.2 GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE garage5_love1 //Love 1
 
SET_GARAGE garage_min_x_yd3 garage_min_y_yd3 26.8 garage_max_x_yd3 garage_max_y_yd3 31.8 GARAGE_MISSION garage_yd3 //Yardie 3


// ****************************************Suburban Garages*********************************

VAR_INT save_cars3, bombshop3, garage_hm3, garage_hm4, escort_garage, collect_all_cars2, sprayshop3 

SET_GARAGE -662.5 -47.4 17.0 -670.7 -30.0 22.0 GARAGE_HIDEOUT_SUBURBAN save_cars3 //Saves current car to memory
SET_ROTATING_GARAGE_DOOR save_cars3
NO_SPECIAL_CAMERA_FOR_THIS_GARAGE save_cars3

SET_GARAGE -1139.0 37.8 55.0 -1148.5 32.1 65.0 GARAGE_RESPRAY sprayshop3 // Spray shop

SET_GARAGE -1078.9 58.0 56.0 -1086.0 49.0 65.0 GARAGE_BOMBSHOP3 bombshop3 // bomb shop - detonator

SET_GARAGE -1117.5 150.9 55.0 -1097.7 121.2 65.0 GARAGE_COLLECTCARS_2 collect_all_cars2 //Inport/Export garage industrial
NO_SPECIAL_CAMERA_FOR_THIS_GARAGE collect_all_cars2

SET_GARAGE 1346.9 -315.5 49.0 1352.5 -310.7 53.0 GARAGE_MISSION_KEEPCAR garage_hm3 //Hoods 3

SET_GARAGE -824.7 -165.5 32.8 -843.5 -171.7 37.0 GARAGE_KEEPS_OPENING_FOR_SPECIFIC_CAR garage_hm4 //Hoods 4

SET_GARAGE -1049.17 -77.47 37.8 -1037.21 -69.17 42.8 GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE escort_garage //LOVE 5 - ESCORT SERVICE (WAREHOUSE)
SET_ROTATING_GARAGE_DOOR escort_garage

// ************************************Industrial Crane Positions***************************

ACTIVATE_MILITARY_CRANE 1570.3 -675.4 1565.7 -686.5 1576.8 -706.6 1639.9 -696.7 26.0 0.0 //Docks crane for the Police cars onto boat height for area 10.8

ACTIVATE_CRUSHER_CRANE 1119.8 51.8 1135.8 56.1 1149.8 46.3 1143.0 59.9 5.0 180.0 //Crusher crane 1135.8 56.1 -1.0 1149.8 46.3 7.0
					   			   
// ****************************************Restart Zones************************************

// **************************************GLOBAL ZONES*****************************************

 	SETUP_ZONE_PED_INFO CITYZON DAY   (12) 0 0 0 0 0 0 0 20   
    SETUP_ZONE_PED_INFO CITYZON NIGHT ( 8) 0 0 0 0 0 0 0 10 
    SETUP_ZONE_CAR_INFO CITYZON DAY   (10) 0 0 0 0 0 0 0 20 240 240 240 240 0 0
    SETUP_ZONE_CAR_INFO CITYZON NIGHT ( 8) 0 0 0 0 0 0 0 10 240 240 240 240 0 0
	SET_ZONE_GROUP CITYZON DAY DEFAULT_PEDGRP
	SET_ZONE_GROUP CITYZON NIGHT DEFAULT_PEDGRP

    SETUP_ZONE_PED_INFO IND_ZON DAY   (12) 0 0 0 0 0 0 0 20    
    SETUP_ZONE_PED_INFO IND_ZON NIGHT ( 8) 0 0 0 0 0 0 0 10
    SETUP_ZONE_CAR_INFO IND_ZON DAY   (10) 0 0 0 0 0 0 0 20 500 0 0 450 0 0
    SETUP_ZONE_CAR_INFO IND_ZON NIGHT ( 8) 0 0 0 0 0 0 0 10 500 0 0 450 0 0
	SET_ZONE_GROUP IND_ZON DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP IND_ZON NIGHT INDUSTRIAL_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO COM_ZON DAY   (12) 0 0 0 0 0 0 0 20  
    SETUP_ZONE_PED_INFO COM_ZON NIGHT ( 8) 0 0 0 0 0 0 0 10
    SETUP_ZONE_CAR_INFO COM_ZON DAY   (10) 0 0 0 0 0 0 0 20 0 300 450 150 0 0
    SETUP_ZONE_CAR_INFO COM_ZON NIGHT ( 8) 0 0 0 0 0 0 0 10 0 300 450 150 0	0
	SET_ZONE_GROUP COM_ZON DAY DEFAULT_PEDGRP
	SET_ZONE_GROUP COM_ZON NIGHT DEFAULT_PEDGRP

    SETUP_ZONE_PED_INFO SUB_ZON DAY   (12) 0 0 0 0 0 0 0 20 
    SETUP_ZONE_PED_INFO SUB_ZON NIGHT ( 8) 0 0 0 0 0 0 0 10
    SETUP_ZONE_CAR_INFO SUB_ZON DAY   (10) 0 0 0 0 0 0 0 20 0 500 450 0 0 0   
    SETUP_ZONE_CAR_INFO SUB_ZON NIGHT ( 8) 0 0 0 0 0 0 0 10 0 500 450 0 0 0
	SET_ZONE_GROUP SUB_ZON DAY DEFAULT_PEDGRP
	SET_ZONE_GROUP SUB_ZON NIGHT DEFAULT_PEDGRP

// Gang1 in industrial = MAFIA
// Gang2 in industrial = TRIADS
// Gang3 in industrial = DIABLOS
// Gang4 in commercial = YAKUZA
// Gang5 in commercial = YARDDIES
// Gang6 in commercial = COLUMBIANS
// Gang7 in commercial = HOODS
// PedDensity Gang1 Gang2 Gang3 Gang4 Gang5 Gang6 Gang7 Police
// CarDensity Gang1 Gang2 Gang3 Gang4 Gang5 Gang6 Gang7 Police PoorFamily RichFamily Executive Worker Special Big

//GANG ZONES 

    SETUP_ZONE_PED_INFO LITTLEI DAY	  (17) 300 0 0 (0 0 0 0) 20	//St Marks
    SETUP_ZONE_PED_INFO	LITTLEI	NIGHT (11) 400 0 0 (0 0 0 0) 10
    SETUP_ZONE_CAR_INFO LITTLEI DAY	  (10) 100 0 0 (0 0 0 0) 20 400 0 0 350 20 0
    SETUP_ZONE_CAR_INFO LITTLEI NIGHT ( 8) 150 0 0 (0 0 0 0) 10 550 0 0 150 0  0
	SET_ZONE_GROUP LITTLEI DAY LITTLEITALY_PEDGRP
	SET_ZONE_GROUP LITTLEI NIGHT LITTLEITALY_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO CHINA DAY   (20) 0 300 0 (0 0 0 0) 20 //China town 
    SETUP_ZONE_PED_INFO CHINA NIGHT (12) 0 400 0 (0 0 0 0) 10 
    SETUP_ZONE_CAR_INFO CHINA DAY   (10) 0 100 0 (0 0 0 0) 10 400 0 0 350 0 0
    SETUP_ZONE_CAR_INFO CHINA NIGHT ( 8) 0 150 0 (0 0 0 0) 20 550 0 0 200 0	0
	SET_ZONE_GROUP CHINA DAY CHINATOWN_PEDGRP
	SET_ZONE_GROUP CHINA NIGHT CHINATOWN_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO	TOWERS DAY   (15) 0 0 300 (0 0 0 0) 0 //Hepburn heoghts
    SETUP_ZONE_PED_INFO TOWERS NIGHT (10) 0 0 400 (0 0 0 0) 0
    SETUP_ZONE_CAR_INFO TOWERS DAY   ( 8) 0 0 100 (0 0 0 0) 20 400 0 0 350 0 0
    SETUP_ZONE_CAR_INFO TOWERS NIGHT ( 6) 0 0 150 (0 0 0 0) 10 550 0 0 200 0 0
	SET_ZONE_GROUP TOWERS DAY PROJECTS_PEDGRP
	SET_ZONE_GROUP TOWERS NIGHT PROJECTS_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO REDLIGH DAY   ( 6) 0 0 0 (0 0 0 0) 20 //Redlight district 
    SETUP_ZONE_PED_INFO REDLIGH NIGHT (13) 0 0 0 (0 0 0 0) 10
    SETUP_ZONE_CAR_INFO REDLIGH DAY   ( 5) 0 0 0 (0 0 0 0) 10 550 0 0 350 0	0
    SETUP_ZONE_CAR_INFO REDLIGH NIGHT ( 7) 0 0 0 (0 0 0 0) 20 600 0 0 200 0	0
	SET_ZONE_GROUP REDLIGH DAY REDLIGHT_PEDGRP
	SET_ZONE_GROUP REDLIGH NIGHT REDLIGHT_NIGHT_PEDGRP


//NAVIGATION ZONES 
	
    SETUP_ZONE_PED_INFO PORT_I DAY   (10) 0 0 0 (0 0 0 0) 0 //Trenton
    SETUP_ZONE_PED_INFO PORT_I NIGHT ( 7) 0 0 0 (0 0 0 0) 0
    SETUP_ZONE_CAR_INFO PORT_I DAY   ( 8) 0 0 0 (0 0 0 0) 20 300 0 0 400 20 0
    SETUP_ZONE_CAR_INFO PORT_I NIGHT ( 6) 0 0 0 (0 0 0 0) 10 500 0 0 400 0	0
	SET_ZONE_GROUP PORT_I DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP PORT_I NIGHT INDUSTRIAL_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO PORT_E DAY   (10) 0 0 0 (0 0 0 0) 0 //Portland Harbour
    SETUP_ZONE_PED_INFO PORT_E NIGHT ( 8) 0 0 0 (0 0 0 0) 0
    SETUP_ZONE_CAR_INFO PORT_E DAY   ( 8) 0 0 0 (0 0 0 0) 20 300 0 0 400 20 0
    SETUP_ZONE_CAR_INFO PORT_E NIGHT ( 6) 0 0 0 (0 0 0 0) 10 500 0 0 400 0	0
	SET_ZONE_GROUP PORT_E DAY DOCKS_PEDGRP
	SET_ZONE_GROUP PORT_E NIGHT DOCKS_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO PORT_S DAY   (10) 0 0 0 (0 0 0 0) 0 //Atlantic Quays
    SETUP_ZONE_PED_INFO PORT_S NIGHT ( 8) 0 0 0 (0 0 0 0) 0 				 
    SETUP_ZONE_CAR_INFO PORT_S DAY   ( 8) 0 0 0 (0 0 0 0) 20 300 0 0 500 20 0
    SETUP_ZONE_CAR_INFO PORT_S NIGHT ( 6) 0 0 0 (0 0 0 0) 10 500 0 0 400 0	0
	SET_ZONE_GROUP PORT_S DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP PORT_S NIGHT INDUSTRIAL_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO PORT_W DAY   (10) 0 10 0 (0 0 0 0) 0 //Callahan Point
    SETUP_ZONE_PED_INFO PORT_W NIGHT ( 5) 0 10 0 (0 0 0 0) 0 
    SETUP_ZONE_CAR_INFO PORT_W DAY   ( 8) 0 0 0 (0 0 0 0) 20 300 0 0 400 0 0
    SETUP_ZONE_CAR_INFO PORT_W NIGHT ( 6) 0 0 0 (0 0 0 0) 10 500 0 0 400 0 0
	SET_ZONE_GROUP PORT_W DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP PORT_W NIGHT INDUSTRIAL_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO	HARWOOD	DAY   (10) 0 0 0 (0 0 0 0) 0 //Harwood
    SETUP_ZONE_PED_INFO HARWOOD NIGHT ( 8) 0 0 0 (0 0 0 0) 0
    SETUP_ZONE_CAR_INFO HARWOOD DAY   ( 8) 0 0 0 (0 0 0 0) 20 400 0 0 300 0	0
    SETUP_ZONE_CAR_INFO HARWOOD NIGHT ( 6) 0 0 0 (0 0 0 0) 10 600 0 0 200 0	0
	SET_ZONE_GROUP HARWOOD DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP HARWOOD NIGHT INDUSTRIAL_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO	EASTBAY	DAY   (10) 0 0 0 (0 0 0 0) 0 //Portland Beach
    SETUP_ZONE_PED_INFO EASTBAY NIGHT ( 5) 0 0 0 (0 0 0 0) 0 
    SETUP_ZONE_CAR_INFO EASTBAY DAY   ( 5) 0 0 0 (0 0 0 0) 20 500 0 0 480 0 0
    SETUP_ZONE_CAR_INFO EASTBAY NIGHT ( 4) 0 0 0 (0 0 0 0) 10 500 0 0 490 0 0
	SET_ZONE_GROUP EASTBAY DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP EASTBAY NIGHT INDUSTRIAL_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO	S_VIEW DAY   (10) 0 0 0 (0 0 0 0) 30 //Portland View
    SETUP_ZONE_PED_INFO S_VIEW NIGHT ( 8) 0 0 0 (0 0 0 0) 20
    SETUP_ZONE_CAR_INFO S_VIEW DAY   (10) 0 0 0 (0 0 0 0) 30 400 0 0 300 100 0
    SETUP_ZONE_CAR_INFO S_VIEW NIGHT ( 8) 0 0 0 (0 0 0 0) 20 500 0 0 200 100 0
	SET_ZONE_GROUP S_VIEW DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP S_VIEW NIGHT INDUSTRIAL_NIGHT_PEDGRP


//OTHER ZONES 

	SETUP_ZONE_PED_INFO	COPS_1 DAY   (10) 0 0 0 (0 0 0 0) 60 //Police station in Portland View
    SETUP_ZONE_PED_INFO COPS_1 NIGHT ( 8) 0 0 0 (0 0 0 0) 60
    SETUP_ZONE_CAR_INFO COPS_1 DAY   (10) 0 0 0 (0 0 0 0) 90 400 0 0 400 0 0
    SETUP_ZONE_CAR_INFO COPS_1 NIGHT ( 8) 0 0 0 (0 0 0 0) 90 400 0 0 400 0	0
	SET_ZONE_GROUP COPS_1 DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP COPS_1 NIGHT INDUSTRIAL_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO	HOSPI_1	DAY   (10) 0 0 0 (0 0 0 0) 60 //Hospital in Portland View
    SETUP_ZONE_PED_INFO HOSPI_1 NIGHT ( 8) 0 0 0 (0 0 0 0) 60
    SETUP_ZONE_CAR_INFO HOSPI_1 DAY   (10) 0 0 0 (0 0 0 0) 90 400 0 0 400 0 0
    SETUP_ZONE_CAR_INFO HOSPI_1 NIGHT ( 8) 0 0 0 (0 0 0 0) 90 400 0 0 400 0 0
	SET_ZONE_GROUP HOSPI_1 DAY HOSPITAL_PEDGRP
	SET_ZONE_GROUP HOSPI_1 NIGHT HOSPITAL_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO ROADBR1 DAY   (30) 0 0 0 (0 0 0 0) 0 //com/ind bridge east side 
    SETUP_ZONE_PED_INFO ROADBR1 NIGHT (20) 0 0 0 (0 0 0 0) 0
    SETUP_ZONE_CAR_INFO ROADBR1 DAY   (12) 0 0 0 (0 0 0 0) 20 400 0 0 400 0 100
    SETUP_ZONE_CAR_INFO ROADBR1 NIGHT (10) 0 0 0 (0 0 0 0) 10 400 0 0 400 0	100
	SET_ZONE_GROUP ROADBR1 DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP ROADBR1 NIGHT INDUSTRIAL_NIGHT_PEDGRP

   	SETUP_ZONE_PED_INFO FISHFAC DAY   ( 2) 0 1000 0 (0 0 0 0) 0 //Fish factory  
    SETUP_ZONE_PED_INFO FISHFAC NIGHT ( 2) 0 1000 0 (0 0 0 0) 0
    SETUP_ZONE_CAR_INFO FISHFAC DAY   ( 6) 0 0 0 (0 0 0 0) 20 200 0 0 600 0	0
    SETUP_ZONE_CAR_INFO FISHFAC NIGHT ( 4) 0 0 0 (0 0 0 0) 10 200 0 0 600 0	0
	SET_ZONE_GROUP FISHFAC DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP FISHFAC NIGHT INDUSTRIAL_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO	FILLIN1 DAY   (10) 0 0 0 (0 0 0 0) 0 //Fills a gap in the zones
    SETUP_ZONE_PED_INFO FILLIN1 NIGHT ( 8) 0 0 0 (0 0 0 0) 0
    SETUP_ZONE_CAR_INFO FILLIN1 DAY   ( 8) 0 0 0 (0 0 0 0) 20 500 0 0 400 0	0
    SETUP_ZONE_CAR_INFO FILLIN1 NIGHT ( 6) 0 0 0 (0 0 0 0) 10 400 0 0 400 0	0
	SET_ZONE_GROUP FILLIN1 DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP FILLIN1 NIGHT INDUSTRIAL_NIGHT_PEDGRP

	SETUP_ZONE_PED_INFO MAIN_D1 DAY   (15) 0 300 0 (0 0 0 0) 20	//SOUTH CHINATOWN
    SETUP_ZONE_PED_INFO MAIN_D1 NIGHT (10) 0 500 0 (0 0 0 0) 10 //P R X  W   S	B
    SETUP_ZONE_CAR_INFO MAIN_D1 DAY   (24) 0 100 0 (0 0 0 0) 20 300 0 0 300 20	100
    SETUP_ZONE_CAR_INFO MAIN_D1 NIGHT (18) 0 150 0 (0 0 0 0) 10 300 0 0 300 20	100
	SET_ZONE_GROUP MAIN_D1 DAY CHINATOWN_PEDGRP
	SET_ZONE_GROUP MAIN_D1 NIGHT CHINATOWN_NIGHT_PEDGRP

	SETUP_ZONE_PED_INFO MAIN_D2 DAY   (15) 0 300 0 (0 0 0 0) 20	//CHINATOWN
    SETUP_ZONE_PED_INFO MAIN_D2 NIGHT (10) 0 400 0 (0 0 0 0) 10
    SETUP_ZONE_CAR_INFO MAIN_D2 DAY   (24) 0 100 0 (0 0 0 0) 20 300 0 0 300 20 100
    SETUP_ZONE_CAR_INFO MAIN_D2 NIGHT (18) 0 150 0 (0 0 0 0) 10 300 0 0 300 20 100
	SET_ZONE_GROUP MAIN_D2 DAY CHINATOWN_PEDGRP
	SET_ZONE_GROUP MAIN_D2 NIGHT CHINATOWN_NIGHT_PEDGRP

	SETUP_ZONE_PED_INFO MAIN_D3 DAY   (15) 0 300 0 (0 0 0 0) 20	//CHINATOWN
    SETUP_ZONE_PED_INFO MAIN_D3 NIGHT (10) 0 400 0 (0 0 0 0) 10
    SETUP_ZONE_CAR_INFO MAIN_D3 DAY   (24) 0 100 0 (0 0 0 0) 20 300 0 0 300 20 100
    SETUP_ZONE_CAR_INFO MAIN_D3 NIGHT (18) 0 150 0 (0 0 0 0) 10 300 0 0 300 20 100
	SET_ZONE_GROUP MAIN_D3 DAY CHINATOWN_PEDGRP
	SET_ZONE_GROUP MAIN_D3 NIGHT CHINATOWN_NIGHT_PEDGRP

	SETUP_ZONE_PED_INFO MAIN_D4 DAY   (15) 0 300 0 (0 0 0 0) 20	//NORTH CHINATOWN
    SETUP_ZONE_PED_INFO MAIN_D4 NIGHT (10) 0 400 0 (0 0 0 0) 10
    SETUP_ZONE_CAR_INFO MAIN_D4 DAY   (24) 0 100 0 (0 0 0 0) 20 300 0 0 300 20 100
    SETUP_ZONE_CAR_INFO MAIN_D4 NIGHT (18) 0 150 0 (0 0 0 0) 10 300 0 0 300 20 100
	SET_ZONE_GROUP MAIN_D4 DAY CHINATOWN_PEDGRP
	SET_ZONE_GROUP MAIN_D4 NIGHT CHINATOWN_NIGHT_PEDGRP

	SETUP_ZONE_PED_INFO MAIN_D5 DAY   (15) 0 0 0 (0 0 0 0) 20 //REDLIGHT
    SETUP_ZONE_PED_INFO MAIN_D5 NIGHT (10) 0 0 0 (0 0 0 0) 10
    SETUP_ZONE_CAR_INFO MAIN_D5 DAY   (24) 0 0 0 (0 0 0 0) 20 400 0 0 300 20 100
    SETUP_ZONE_CAR_INFO MAIN_D5 NIGHT (18) 0 0 0 (0 0 0 0) 10 300 0 0 400 20 100
	SET_ZONE_GROUP MAIN_D5 DAY REDLIGHT_PEDGRP
	SET_ZONE_GROUP MAIN_D5 NIGHT REDLIGHT_NIGHT_PEDGRP

	SETUP_ZONE_PED_INFO MAIN_D6 DAY   (15) 0 0 300 (0 0 0 0) 20	//TOWERS
    SETUP_ZONE_PED_INFO MAIN_D6 NIGHT (10) 0 0 400 (0 0 0 0) 10
    SETUP_ZONE_CAR_INFO MAIN_D6 DAY   (24) 0 0 100 (0 0 0 0) 20 300 0 0 300 20 100
    SETUP_ZONE_CAR_INFO MAIN_D6 NIGHT (18) 0 0 150 (0 0 0 0) 10 300 0 0 300 20 100
	SET_ZONE_GROUP MAIN_D6 DAY PROJECTS_PEDGRP
	SET_ZONE_GROUP MAIN_D6 NIGHT PROJECTS_NIGHT_PEDGRP

// ****************************Industrial switched off Road and Ped Nodes*******************

SWITCH_ROADS_OFF 619.6 -911.5 45.0 834.3 -954.5 32.0 //Industrial to commercial Bridge
MARK_ROADS_BETWEEN_LEVELS 619.6 -911.5 45.0 834.3 -954.5 32.0

SWITCH_ROADS_OFF 1381.0 -293.7 48.0 1435.8 -140.1 58.0 //Frankies Driveway
SWITCH_ROADS_OFF 1358.9 -901.9 10.0 1609.6 -615.1 16.0 //Docks 

SWITCH_ROADS_OFF 659.6 200.0 -20.0 945.8 147.5 5.0 //Tunnel
MARK_ROADS_BETWEEN_LEVELS 659.6 200.0 -20.0 945.8 147.5 5.0

SWITCH_PED_ROADS_OFF 659.6 200.0 -25.0 945.8 147.5 5.0	//Tunnel
MARK_ROADS_BETWEEN_LEVELS 659.6 200.0 -25.0 945.8 147.5 5.0

SWITCH_PED_ROADS_OFF 773.6 191.8 -25.0 819.7 182.8 5.0	//Tunnel
MARK_ROADS_BETWEEN_LEVELS 773.6 191.8 -25.0 819.7 182.8 5.0

SWITCH_PED_ROADS_OFF 1609.0 -896.0 8.0 1393.7 -967.4 30.0 //Colubian Boat

SWITCH_PED_ROADS_OFF 1048.3 -1103.4 5.0 1040.0 -1074.4 30.0 //Fish Factory

SWITCH_PED_ROADS_OFF 900.09 -297.05 6.0 842.83 -325.58 15.0	//Players hideout

SWITCH_PED_ROADS_OFF  900.5 -427.1 14.0 879.1 -404.2 17.0 //Luigis alleyway

SWITCH_PED_ROADS_OFF 847.9 -640.6 10.0 887.9 -685.8 20.0 //Toni2 alleyway

SWITCH_PED_ROADS_OFF_ANGLED 1222.9 -838.4 13.5 1256.3 -804.9 16.0 58.0 //Bitch'n Dog Food Factory

SWITCH_PED_ROADS_OFF 1005.59 -880.96 12.0 995.9 -893.34 20.0 //Fuzz Ball  

SWITCH_PED_ROADS_OFF 1070.6 -401.6 10.0 1067.8 -397.2 25.0 //AMMUNATION

// ***************************************Commercial City Zones*****************************

// Gang1 in industrial = MAFIA
// Gang2 in industrial = TRIADS
// Gang3 in industrial = DIABLOS
// Gang4 in commercial = YAKUZA
// Gang5 in commercial = YARDDIES
// Gang6 in commercial = COLUMBIANS
// Gang7 in commercial = HOODS
// PedDensity Gang1 Gang2 Gang3 Gang4 Gang5 Gang6 Gang7 Police
// CarDensity Gang1 Gang2 Gang3 Gang4 Gang5 Gang6 Gang7 Police PoorFamily RichFamily Executive Worker Special Big

//NAVIGATION ZONES

    SETUP_ZONE_PED_INFO STADIUM DAY   (30) (0 0 0) 0 0 0 0 0 //Aspatria 
    SETUP_ZONE_PED_INFO STADIUM NIGHT (16) (0 0 0) 0 0 0 0 0
    SETUP_ZONE_CAR_INFO STADIUM DAY   (20) (0 0 0) 0 0 0 0 20 300 150 0 250 0 200
    SETUP_ZONE_CAR_INFO STADIUM NIGHT (17) (0 0 0) 0 0 0 0 10 300 150 0 250 0 200
	SET_ZONE_GROUP STADIUM DAY STADIUM_PEDGRP
	SET_ZONE_GROUP STADIUM NIGHT STADIUM_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO HOSPI_2 DAY   (30) (0 0 0) 0 0 0 0 0  //Rockford
    SETUP_ZONE_PED_INFO HOSPI_2 NIGHT (16) (0 0 0) 0 0 0 0 0
    SETUP_ZONE_CAR_INFO HOSPI_2 DAY   (20) (0 0 0) 0 0 0 0 20 300 150 0 250 0 200
    SETUP_ZONE_CAR_INFO HOSPI_2 NIGHT (17) (0 0 0) 0 0 0 0 10 300 150 0 250 0 200
	SET_ZONE_GROUP HOSPI_2 DAY HOSPITAL_PEDGRP
	SET_ZONE_GROUP HOSPI_2 NIGHT HOSPITAL_NIGHT_PEDGRP

	SETUP_ZONE_PED_INFO UNIVERS DAY   (30) (0 0 0) 0 0 0 0 20 //Liberty Campus 
    SETUP_ZONE_PED_INFO UNIVERS NIGHT (16) (0 0 0) 0 0 0 0 10
    SETUP_ZONE_CAR_INFO UNIVERS DAY   (20) (0 0 0) 0 0 0 0 20 300 300 300 0 20 0
    SETUP_ZONE_CAR_INFO UNIVERS NIGHT (17) (0 0 0) 0 0 0 0 10 300 300 300 0 20 0
	SET_ZONE_GROUP UNIVERS DAY UNIVERSITY_PEDGRP
	SET_ZONE_GROUP UNIVERS NIGHT UNIVERSITY_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO CONSTRU DAY   (30) (0 0 0) 0 0 300 0 20  //Fort staunton
    SETUP_ZONE_PED_INFO CONSTRU NIGHT (16) (0 0 0) 0 0 400 0 10
    SETUP_ZONE_CAR_INFO CONSTRU DAY   (20) (0 0 0) 0 0 100 0 20 300 100 0 250 0 150
    SETUP_ZONE_CAR_INFO CONSTRU NIGHT (17) (0 0 0) 0 0 150 0 10 300 100 0 250 0 150
	SET_ZONE_GROUP CONSTRU DAY CONSTRUCTION_PEDGRP
	SET_ZONE_GROUP CONSTRU NIGHT CONSTRUCTION_NIGHT_PEDGRP				   

    SETUP_ZONE_PED_INFO PARK DAY   (30) (0 0 0) 0 0 0 0 20 //Belleville Park 
    SETUP_ZONE_PED_INFO PARK NIGHT (16) (0 0 0) 0 0 0 0 10
    SETUP_ZONE_CAR_INFO PARK DAY   (20) (0 0 0) 0 0 0 0 20 300 300 300 0 0 0
    SETUP_ZONE_CAR_INFO PARK NIGHT (17) (0 0 0) 0 0 0 0 10 300 300 300 0 0 0
	SET_ZONE_GROUP PARK DAY PARK_PEDGRP
	SET_ZONE_GROUP PARK NIGHT PARK_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO COM_EAS DAY   (30) (0 0 0) 0 300 0 0 20 // Newport
    SETUP_ZONE_PED_INFO COM_EAS NIGHT (16) (0 0 0) 0 400 0 0 10
    SETUP_ZONE_CAR_INFO COM_EAS DAY   (20) (0 0 0) 0 100 0 0 20 400 250 0 0 0 150
    SETUP_ZONE_CAR_INFO COM_EAS NIGHT (17) (0 0 0) 0 150 0 0 10 400 250 0 0 0 100
	SET_ZONE_GROUP COM_EAS DAY SHOPPING_PEDGRP
	SET_ZONE_GROUP COM_EAS NIGHT SHOPPING_NIGHT_PEDGRP

	SETUP_ZONE_PED_INFO SHOPING DAY   (20) (0 0 0) 0 0 0 0 20  //Bedford Point 
    SETUP_ZONE_PED_INFO SHOPING NIGHT (10) (0 0 0) 0 0 0 0 10 //GS-SC: Reduce clumps of peds in this area
    SETUP_ZONE_CAR_INFO SHOPING DAY   (20) (0 0 0) 0 0 0 0 30 300 250 250 0 0 100
    SETUP_ZONE_CAR_INFO SHOPING NIGHT (17) (0 0 0) 0 0 0 0 20 300 250 250 0 0 100
	SET_ZONE_GROUP SHOPING DAY SHOPPING_PEDGRP
	SET_ZONE_GROUP SHOPING NIGHT SHOPPING_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO YAKUSA DAY   (30) (0 0 0) 300 0 0 0 20  //Torrington
    SETUP_ZONE_PED_INFO YAKUSA NIGHT (16) (0 0 0) 400 0 0 0 10
    SETUP_ZONE_CAR_INFO YAKUSA DAY   (20) (0 0 0) 100 0 0 0 40 350 200 250 0 0 0
    SETUP_ZONE_CAR_INFO YAKUSA NIGHT (17) (0 0 0) 150 0 0 0 20 350 200 200 0 0 0
	SET_ZONE_GROUP YAKUSA DAY SHOPPING_PEDGRP
	SET_ZONE_GROUP YAKUSA NIGHT SHOPPING_NIGHT_PEDGRP

//OTHER ZONES

    SETUP_ZONE_PED_INFO ROADBR2 DAY   (30) (0 0 0) 0 0 0 0 20  
    SETUP_ZONE_PED_INFO ROADBR2 NIGHT (20) (0 0 0) 0 0 0 0 10
    SETUP_ZONE_CAR_INFO ROADBR2 DAY   (20) (0 0 0) 0 0 0 0 30 300 250 250 0 0 100
    SETUP_ZONE_CAR_INFO ROADBR2 NIGHT (17) (0 0 0) 0 0 0 0 20 300 250 250 0 0 100
	SET_ZONE_GROUP ROADBR2 DAY SHOPPING_PEDGRP
	SET_ZONE_GROUP ROADBR2 NIGHT SHOPPING_NIGHT_PEDGRP


// ****************************Commercial switched off Road and Ped Nodes*******************

SWITCH_PED_ROADS_OFF 106.1 -1278.3 24.0 96.3 -1273.5 27.0 //Hyaku Dojo for Kenji one
SWITCH_PED_ROADS_OFF 120.0 170.0 10.0 190.0 246.0 25.0 //Phil's place
SWITCH_PED_ROADS_OFF 31.0 -317.0 14.0 91.0 -394.0 25.0 // Colombian compound 

SWITCH_ROADS_OFF 120.0 170.0 10.0 190.0 246.0 25.0 //Phil's place

SWITCH_ROADS_OFF 121.814 -46.429 14.0 363.858 54.312 20.0 //Ambulance
SWITCH_PED_ROADS_OFF 121.814 -46.429 14.0 363.858 54.312 20.0 //Ambulance

SWITCH_ROADS_OFF 353.5 -459.0 18.0 397.5 -431.6 30.0 // Witness protection house
  
SWITCH_ROADS_OFF 465.7 -634.3 10.0 429.9 -610.1 25.0 // By Asukas condo 

SWITCH_ROADS_OFF -46.8 -648.0 39.0 -69.1 -614.0 50.0 //Commercial to Suburbia Bridge
MARK_ROADS_BETWEEN_LEVELS -46.8 -648.0 39.0 -69.1 -614.0 50.0

SWITCH_PED_ROADS_OFF 56.5 -1544.2 10.0 87.9 -1556.0 30.0 // Loves building

SWITCH_PED_ROADS_OFF 413.5 -480.2 20.0 420.9 -499.0 36.0 //ped island
SWITCH_PED_ROADS_OFF 419.5 -708.1 20.0 412.5 -717.9 36.0 //ped island
SWITCH_PED_ROADS_OFF -76.9 -985.4 20.0 -68.8 -992.6 36.0 //ped island
SWITCH_PED_ROADS_OFF -76.5 -934.4 20.0 -70.4 -928.4 36.0 //ped island
SWITCH_PED_ROADS_OFF -55.9 -934.6 20.0 -46.4 -927.2 36.0 //ped island

SWITCH_PED_ROADS_OFF -76.4 -999.6 20.0 -68.8 -628.5 36.0 //ped island

SWITCH_PED_ROADS_OFF 199.3 -935.9 20.0 134.8 -927.4 40.0 //ped island

SWITCH_ROADS_OFF 529.6 106.5 -30.0 581.4 65.7 0.0 //tunnel from commercial to intersection for sub and ind

SWITCH_PED_ROADS_OFF 57.0 -1591.0 0.0 100.0 -1531.3 30.0 // Block space in front of Donald's house 
SWITCH_PED_ROADS_OFF 115.0 162.8 0.0 193.0 248.0 15.0 // Restricted area in North Portland

// ****************************************Suburban City Zones******************************

// Gang1 in industrial = MAFIA
// Gang2 in industrial = TRIADS
// Gang3 in industrial = DIABLOS
// Gang4 in commercial = YAKUZA
// Gang5 in commercial = YARDDIES
// Gang6 in commercial = COLUMBIANS
// Gang7 in commercial = HOODS
// PedDensity Gang1 Gang2 Gang3 Gang4 Gang5 Gang6 Gang7 Police
// CarDensity Gang1 Gang2 Gang3 Gang4 Gang5 Gang6 Gang7 Police PoorFamily RichFamily Executive Worker Special Big



//NAVIGATION ZONES

    SETUP_ZONE_PED_INFO AIRPORT DAY   (20) (0 0 0 0 0) 0 0 20 //FRANCIS INTI. AIRPORT 
    SETUP_ZONE_PED_INFO AIRPORT NIGHT (10) (0 0 0 0 0) 0 0 10
    SETUP_ZONE_CAR_INFO AIRPORT DAY   (15) (0 0 0 0 0) 0 0 40 300 300 300 0 0 0
    SETUP_ZONE_CAR_INFO AIRPORT NIGHT (13) (0 0 0 0 0) 0 0 20 300 300 300 0 0 0
	SET_ZONE_GROUP AIRPORT DAY AIRPORT_PEDGRP
	SET_ZONE_GROUP AIRPORT NIGHT AIRPORT_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO PROJECT DAY   (20) (0 0 0 0 0) 0 300 0 //WICHITA GARDENS 
    SETUP_ZONE_PED_INFO PROJECT NIGHT (10) (0 0 0 0 0) 0 400 0
    SETUP_ZONE_CAR_INFO PROJECT DAY   (15) (0 0 0 0 0) 0 100 20 500 150 0 150 0 0
    SETUP_ZONE_CAR_INFO PROJECT NIGHT (13) (0 0 0 0 0) 0 150 10 500 100 0 150 0 0
	SET_ZONE_GROUP PROJECT DAY PROJECTS_PEDGRP
	SET_ZONE_GROUP PROJECT NIGHT PROJECTS_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO SUB_IND DAY   (20) (0 0 0 0 0) 0 0 20 //PIKE CREEK 
    SETUP_ZONE_PED_INFO SUB_IND NIGHT (10) (0 0 0 0 0) 0 0 10
    SETUP_ZONE_CAR_INFO SUB_IND DAY   (15) (0 0 0 0 0) 0 0 20 300 300 300 0 0 0
    SETUP_ZONE_CAR_INFO SUB_IND NIGHT (13) (0 0 0 0 0) 0 0 10 300 300 300 0 0 0
	SET_ZONE_GROUP SUB_IND DAY DOCKS_PEDGRP
	SET_ZONE_GROUP SUB_IND NIGHT DOCKS_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO SWANKS DAY   (20) (0 0 0 0 0) 70 0 30 //CEDAR CROVE 
    SETUP_ZONE_PED_INFO SWANKS NIGHT (10) (0 0 0 0 0) 90 0 20
    SETUP_ZONE_CAR_INFO SWANKS DAY   (15) (0 0 0 0 0) 70 0 30 0 400 400 0 20 0
    SETUP_ZONE_CAR_INFO SWANKS NIGHT (13) (0 0 0 0 0) 90 0 20 0 400 400 0 20 0
	SET_ZONE_GROUP SWANKS DAY SWANKSVILLE_PEDGRP
	SET_ZONE_GROUP SWANKS NIGHT SWANKSVILLE_NIGHT_PEDGRP

    SETUP_ZONE_PED_INFO BIG_DAM DAY   ( 8) (0 0 0 0 0) 0 0 0  //COCHRANE DAM
    SETUP_ZONE_PED_INFO BIG_DAM NIGHT ( 6) (0 0 0 0 0) 0 0 0
    SETUP_ZONE_CAR_INFO BIG_DAM DAY   ( 8) (0 0 0 0 0) 0 0 20 300 300 0 300 0 0
    SETUP_ZONE_CAR_INFO BIG_DAM NIGHT ( 6) (0 0 0 0 0) 0 0 10 300 300 0 300 0 0
	SET_ZONE_GROUP BIG_DAM DAY INDUSTRIAL_PEDGRP
	SET_ZONE_GROUP BIG_DAM NIGHT INDUSTRIAL_NIGHT_PEDGRP

	SETUP_ZONE_PED_INFO SUB_ZO2 DAY   (20) (0 0 0 0 0) 0 0 20 //SHORESIDE VALE
    SETUP_ZONE_PED_INFO SUB_ZO2 NIGHT (10) (0 0 0 0 0) 0 0 10
    SETUP_ZONE_CAR_INFO SUB_ZO2 DAY   (15) (0 0 0 0 0) 0 0 20 0 500 450 0 0 0   
    SETUP_ZONE_CAR_INFO SUB_ZO2 NIGHT (13) (0 0 0 0 0) 0 0 10 0 500 450 0 0 0
	SET_ZONE_GROUP SUB_ZO2 DAY DEFAULT_PEDGRP
	SET_ZONE_GROUP SUB_ZO2 NIGHT DEFAULT_PEDGRP

	SETUP_ZONE_PED_INFO SUB_ZO3 DAY   (20) (0 0 0 0 0) 0 0 20 //SHORESIDE VALE
    SETUP_ZONE_PED_INFO SUB_ZO3 NIGHT (10) (0 0 0 0 0) 0 0 10
    SETUP_ZONE_CAR_INFO SUB_ZO3 DAY   (15) (0 0 0 0 0) 0 0 20 0 500 450 0 0 0   
    SETUP_ZONE_CAR_INFO SUB_ZO3 NIGHT (13) (0 0 0 0 0) 0 0 10 0 500 450 0 0 0
	SET_ZONE_GROUP SUB_ZO3 DAY DEFAULT_PEDGRP
	SET_ZONE_GROUP SUB_ZO3 NIGHT DEFAULT_PEDGRP

	SETUP_ZONE_PED_INFO WEE_DAM DAY   ( 8) (0 0 0 0 0) 100 0 0  
	SETUP_ZONE_PED_INFO WEE_DAM NIGHT ( 5) (0 0 0 0 0) 100 0 0
	SETUP_ZONE_CAR_INFO WEE_DAM DAY   ( 0) (0 0 0 0 0) 0 0 0 0 0 0 0 0 0
	SETUP_ZONE_CAR_INFO WEE_DAM NIGHT ( 0) (0 0 0 0 0) 0 0 0 0 0 0 0 0 0
	SET_ZONE_GROUP WEE_DAM DAY DOCKS_PEDGRP
	SET_ZONE_GROUP WEE_DAM NIGHT DOCKS_NIGHT_PEDGRP

// ****************************Suburban switched off Road and Ped Nodes*********************

SWITCH_ROADS_OFF -1052.6693 -78.0430 50.0 -988.0153 -67.1608 30.0 // warehouse in Suburbia
SWITCH_PED_ROADS_OFF -1052.6693 -78.0430 50.0 -988.0153 -67.1608 30.0 // warehouse in Suburbia 

SWITCH_ROADS_OFF -952.5 361.4 10.0 -939.3 374.0 30.0 // DAM

SWITCH_ROADS_OFF -241.7 251.8 0.0 -256.2 241.4 20.0 // park area (north east)

SWITCH_ROADS_OFF -1367.7690 -731.4872 20.0 -743.1906 -410.1961 5.0 // Airport
SWITCH_ROADS_OFF -1591.4 -931.5 10.0 -1572.9 -914.6 25.0 // Airport

SWITCH_PED_ROADS_OFF -1310.8053 -568.7556 5.0 -1224.9248 -483.4936 20.0 // Airport

SWITCH_ROADS_OFF 496.7 75.5 -30.0 484.0 44.2 0.0 //tunnel to suburbia
MARK_ROADS_BETWEEN_LEVELS 496.7 75.5 -30.0 484.0 44.2 0.0

SWITCH_ROADS_OFF -287.8 396.5 70.0 -269.0 418.0 100.0 //tunnel to Miami	(EAST)
SWITCH_ROADS_OFF -877.1 545.9 60.0 -901.3 575.0 100.0 //tunnel to Miami	(WEST)

SWITCH_ROADS_OFF -690.4 101.2 10.0 -704.4 78.9 30.0  // players savehouse

SWITCH_ROADS_OFF -1194.1 98.6 50.0 -1234.0 119.2 80.0  // 

// **************************************CAR GENERATORS**********************************************

GOSUB_FILE car_generators car_gen.sc

//SPECIAL CAR GENERATORS****************************************************************************
CREATE_CAR_GENERATOR 930.93 -267.63 -100.0 340.0 CAR_BFINJECT -1 -1 0 100 0 0 10000 joeys_buggy //Joeys Buggy
SWITCH_CAR_GENERATOR joeys_buggy 0

CREATE_CAR_GENERATOR 933.7 -65.6 -100.0 0.0 CAR_BORGNINE -1 -1 0 50 0 0 10000 swank_taxi //Car park behind radio station
SWITCH_CAR_GENERATOR swank_taxi 0

// *****************************************PICK_UPS**************************************************

GOSUB_FILE main_pickups pickups.sc

//AMMU NATION*****************************************************************************************
VAR_INT ammu_shop_bloke1
VAR_INT time_difference, current_time, time_since_murdering_shopkeeper1
VAR_INT SHOP_COLT45, SHOP_COLT45_2, SHOP_UZI, SHOP_UZI2
VAR_INT	SHOP_GRENADE2 SHOP_UZI_2 SHOP_SNIPER_2 SHOP_AK47_2 SHOP_ARMOUR																	  
VAR_INT out_of_stock_uzi out_of_stock_pistol SHOP_FLAME	SHOP_MOLOTOV

//Industrial
CREATE_PICKUP WEAPON_COLT45 PICKUP_IN_SHOP_OUT_OF_STOCK 1068.5 -400.8 15.2 SHOP_COLT45 //AMMUNATION
CREATE_PICKUP WEAPON_UZI PICKUP_IN_SHOP_OUT_OF_STOCK 1070.5 -400.8 15.2 SHOP_UZI //AMMUNATION

//Commercial
CREATE_PICKUP WEAPON_AK47 PICKUP_IN_SHOP 342.5 -713.0 26.4 SHOP_AK47_2 //AMMUNATION
CREATE_PICKUP WEAPON_SNIPER PICKUP_IN_SHOP 342.5 -716.0 26.4 SHOP_SNIPER_2 //AMMUNATION
CREATE_PICKUP WEAPON_GRENADE PICKUP_IN_SHOP 344.5 -719.0 26.4 SHOP_GRENADE2 //AMMUNATION
CREATE_PICKUP WEAPON_UZI PICKUP_IN_SHOP 346.5 -719.0 26.4 SHOP_UZI_2 //AMMUNATION
CREATE_PICKUP bodyarmour PICKUP_IN_SHOP 342.5 -719.0 26.4 SHOP_ARMOUR //AMMUNATION

//Suburbia
CREATE_PICKUP WEAPON_FLAME PICKUP_IN_SHOP -1206.6 -6.6 53.3 SHOP_FLAME //AMMUNATION
CREATE_PICKUP WEAPON_MOLOTOV PICKUP_IN_SHOP -1210.6 -6.6 53.3 SHOP_MOLOTOV //AMMUNATION

//BONUS PICKUPS**************************************************************************************
SET_COLLECTABLE1_TOTAL 0

//INDUSTRIAL*****************************************************************************************
CREATE_COLLECTABLE1 1105.3 -1020.0 25.1	//Trenton Sawmill (rooftop)
CREATE_COLLECTABLE1 877.6 -788.0 27.6  //chinatown (rooftop)
CREATE_COLLECTABLE1 1254.0 -611.2 22.8 //Supasave (rooftop)
CREATE_COLLECTABLE1 1045.8 -967.1 16.0 //power plant 
CREATE_COLLECTABLE1 942.1 -793.4 14.9  //chinatown (alleyway)

CREATE_COLLECTABLE1 934.0 -718.9 14.8  //chinatown (market)
CREATE_COLLECTABLE1 898.1 -414.7 26.5 //Redlight (Luigi's)
CREATE_COLLECTABLE1 846.9 -442.5 23.2 //Redlight (rooftop)
CREATE_COLLECTABLE1 927.1 -404.4 29.1 //Redlight (rooftop opposite Luigis)
CREATE_COLLECTABLE1 864.3 -171.5 3.5 //Towers

CREATE_COLLECTABLE1 1538.3 -174.4 19.2 //beach
CREATE_COLLECTABLE1 1213.1 -127.1 15.1 //Easy Credit Autos
CREATE_COLLECTABLE1 753.6  137.0  3.5 //Harwood
CREATE_COLLECTABLE1 1162.0 -101.8 12.0 //petrol station
CREATE_COLLECTABLE1 1155.6 -191.5 14.4 //Back of building behind petrol station

CREATE_COLLECTABLE1 1285.5 -247.5 42.4 //little Italy (park)
CREATE_COLLECTABLE1 1007.2 -219.6 6.7 //Towers (Between trees)
CREATE_COLLECTABLE1 1138.2 -250.0 24.3 //little Italy (building site)
CREATE_COLLECTABLE1 1023.6 -423.7 14.9 //Redlight In building (smash glass)
CREATE_COLLECTABLE1 1237.5 -854.1 20.6 //Liberty Pharmaceuticals (roof)

CREATE_COLLECTABLE1 1478.3 -1150.7 12.0 //docks	9 (pier)
CREATE_COLLECTABLE1 1018.9 -56.8  21.0 //Radio station (Rooftop)
CREATE_COLLECTABLE1 1465.7 -166.5 55.5 //Frankies mansion
CREATE_COLLECTABLE1 1120.2 -926.2 16.0 //chinatown (near the bridge behind some buildings)
CREATE_COLLECTABLE1 1206.5 -821.5 15.0 //dogfood factory

CREATE_COLLECTABLE1 940.2 -199.9 5.0 //Towers (in bushes)
CREATE_COLLECTABLE1 979.3 -1143.1 13.1 //fishfactory
CREATE_COLLECTABLE1 1195.5 -908.8 14.9 //Trenton (in front of Joeys)
CREATE_COLLECTABLE1 1470.4 -811.4 22.4 //Docks (rooftop)
CREATE_COLLECTABLE1 1320.5 -365.5 15.2 //tramp tunnel

CREATE_COLLECTABLE1 932.6 -477.3 -10.8 //Subway Industrial side
CREATE_COLLECTABLE1 1305.9 -380.9 39.5 //Little Italy (back alley)
CREATE_COLLECTABLE1 938.2 -1258.3 3.5 //Island south ofindustrial 

//COMMERCIAL********************************************************************************
CREATE_COLLECTABLE1 36.8 -530.2 26.0 //Top of Uncle BJs deli & groceries under suburban bridge
CREATE_COLLECTABLE1 414.4 -279.3 23.6 //Building site (small building)
CREATE_COLLECTABLE1 203.5 -1252.6 59.3 //Torrington (AMco Roof top) 
CREATE_COLLECTABLE1 77.7 -352.3 16.1 //Garage at save the OOG bit 
CREATE_COLLECTABLE1 120.9 243.7 11.4 //Far North of map (Phils bit)
 
CREATE_COLLECTABLE1 49.4 36.3 16.7 //Behind Stadium 
CREATE_COLLECTABLE1 68.1 -773.3 22.8 //Under bridge (In park) 
CREATE_COLLECTABLE1 -4.0 -1129.1 26.0 //Behind Church 
CREATE_COLLECTABLE1 -134.7 -1386.9 26.2 //Doorway Bedford point (South west)
CREATE_COLLECTABLE1 -23.5 -1472.4 19.7 //Underground carpark Bedford point (South west)

CREATE_COLLECTABLE1 112.1 -1227.6 26.0 //Alley way (South central) 
CREATE_COLLECTABLE1 218.3 -1237.8 20.4 //Underground carpark Torrington (South east) 
CREATE_COLLECTABLE1 308.0 -1533.4 23.6 //Behind star statue logo (South east) 
CREATE_COLLECTABLE1 468.6 -1457.2 44.3 //Top of Kenji's casino (heli Pad)
CREATE_COLLECTABLE1 355.1 -1085.7 25.9 //Behind Police station
 
CREATE_COLLECTABLE1 312.4 -483.8 29.0 //Multi story carpark (1st floor) 
CREATE_COLLECTABLE1 322.3 -447.1 23.4 //Garage next to multi story carpark 
CREATE_COLLECTABLE1 586.7 -795.0 1.6 // Jetty (North of industrial bridge)
CREATE_COLLECTABLE1 504.3 -1027.8 1.7 //Jetty (South of industrial bridge)
CREATE_COLLECTABLE1 174.1 -1259.5 32.1 //Upstairs in smashable glass building (Bedford point central) 
 
CREATE_COLLECTABLE1 248.8 -958.3 26.0 //L shaped alley way (Central near industrial bridge)
CREATE_COLLECTABLE1 54.8 -566.5 26.1	//Basketball court
CREATE_COLLECTABLE1 -77.0 -1490.1 26.0 //Behind building in Project like area (South)
CREATE_COLLECTABLE1 556.0 -231.4 22.8 //on top of small bridge (north east)
CREATE_COLLECTABLE1 -38.2 -1434.3 31.8 //on roof near poject area (south west)

CREATE_COLLECTABLE1 194.8 -0.5 19.8 //on top of hospital (north east)
CREATE_COLLECTABLE1 223.1 -272.2 16.1 //east side of university (north)
CREATE_COLLECTABLE1 -18.1 -222.3 29.8 //Stadium entrance 
CREATE_COLLECTABLE1 -69.3 -469.2 16.1 //alleyway south of stadium 
CREATE_COLLECTABLE1 -270.7 -631.6 72.3 //commercial to suburban bridge 

CREATE_COLLECTABLE1 -59.2 -579.8 15.9 //under road tunnel (far west) Bedford point 
CREATE_COLLECTABLE1 392.8 -1135.6 15.9 //just outside Police station 
CREATE_COLLECTABLE1 145.0 -1584.0 30.7 //ped walk way (south central) 
CREATE_COLLECTABLE1 428.1 -340.4 16.2 //Construction site 
CREATE_COLLECTABLE1 351.1 -980.5 33.1 //museum 

CREATE_COLLECTABLE1 -221.8 -1487.6 5.8 //Pier south west coast (behind rocks)

//SUBURBIA************************************************************************************

CREATE_COLLECTABLE1 -1193.1 -75.8 47.4 //Industrial estate  (Behind Burke)
CREATE_COLLECTABLE1 -1090.5 131.7 58.7 //Industrial estate  (Behind import/export garage)
CREATE_COLLECTABLE1 -1015.5 -13.0 49.1 //Industrial estate (Behind Liberty Pharmaceuticals)
CREATE_COLLECTABLE1 -821.8 -184.9 33.8 //Industrial estate  (Behind Turtel Head Fish Co)

CREATE_COLLECTABLE1 -849.1 -209.4 41.8 //Industrial estate on roof (Behind Turtel Head Fish Co)
CREATE_COLLECTABLE1 -736.4 304.7 54.1 //Behind the furthest west Swank house 
CREATE_COLLECTABLE1 -678.1 308.6 59.8 //Behind the 2nd furthest west Swank house
CREATE_COLLECTABLE1 -609.2 286.7 65.1 //I front of 3rd furthest west Swank house
CREATE_COLLECTABLE1 -329.6 320.1 60.7 //columbian mansion (swimming pool) 

CREATE_COLLECTABLE1 -1221.1 562.8 68.6 //Left Dam dome
CREATE_COLLECTABLE1 -1131.9 605.4 68.6 //right Dam dome
CREATE_COLLECTABLE1 -1098.4 471.3 35.5 //First lower Dam Tower
CREATE_COLLECTABLE1 -1208.1 325.2 3.4 //Just to the west of the Dam
CREATE_COLLECTABLE1 -1216.2 347.9 30.4 //Lower dam (last mission heli pad bit) 

CREATE_COLLECTABLE1 -1211.9 -166.9 58.7 //behind hospital
CREATE_COLLECTABLE1 -1195.2 -7.7 59.8 //behind cop station on roof
CREATE_COLLECTABLE1 -206.9 328.8 3.4 //Picnic Park (Shoreside vale) 
CREATE_COLLECTABLE1 -753.2 142.0 10.1 //in tunnel behind save house  
CREATE_COLLECTABLE1 -697.9 -182.1 9.2 //under twisted bridge 

CREATE_COLLECTABLE1 -748.4 -807.0 -13.6 //Subway 
CREATE_COLLECTABLE1 -489.9 -44.9 3.8 //Projects 
CREATE_COLLECTABLE1 -632.9 67.6 18.8 //Projects (behind save house) 
CREATE_COLLECTABLE1 -546.8 10.7 3.9 //Projects (door way)
CREATE_COLLECTABLE1 -1032.6 -573.4 10.9 //Airport (west side of Dome) 

CREATE_COLLECTABLE1 -542.0 -1046.6 3.4 //Airport (end of a runway)
CREATE_COLLECTABLE1 -1556.4 -905.8 14.5 //Airport (Heli Pad)
CREATE_COLLECTABLE1 -1327.0 -624.7 11.1 //Airport under plane (furthest west)
CREATE_COLLECTABLE1 -737.4 -745.4 9.7 //In front of Airport (behind billbords)
CREATE_COLLECTABLE1 -1278.7 -776.0 11.1 //Airport under plane (furthest south)

CREATE_COLLECTABLE1 -1494.7 -1097.3 3.4 //Airport Far south by shore
CREATE_COLLECTABLE1 -837.8 -469.2 10.8 //Airport next to car park (firestation) 


// ********************************************AUDIO*********************************************

VAR_INT sound_loop1	 sound_loop2  sound_loop3  sound_loop4  sound_loop5  sound_loop6  sound_loop7  sound_loop8  sound_loop9  sound_loop10
VAR_INT sound_loop11 sound_loop12 sound_loop13 sound_loop14 sound_loop15 sound_loop16 sound_loop17 sound_loop18 sound_loop19 sound_loop20
VAR_INT misty_joey_loop

//INDUSTRIAL

//China Town
ADD_CONTINUOUS_SOUND 850.8 -663.7 15.0 SOUND_LAUNDERETTE_LOOP_L sound_loop1	//Mr Wongs Laundrette
ADD_CONTINUOUS_SOUND 913.6 -805.5 15.0 SOUND_RESTAURANT_CHINATOWN_LOOP_S sound_loop2 // Chinese Restaurant1 
ADD_CONTINUOUS_SOUND 970.0 -674.8 15.0 SOUND_SHOP_LOOP_L sound_loop3 //China market
ADD_CONTINUOUS_SOUND 975.1 -724.0 15.0 SOUND_SHOP_LOOP_L sound_loop4 //China market

//Little Italy (St Marks)
ADD_CONTINUOUS_SOUND 1220.0 -310.0 32.0 SOUND_RESTAURANT_ITALY_LOOP_S sound_loop5 //Toni's Restaurant
ADD_CONTINUOUS_SOUND 1318.4 -463.6 57.0 SOUND_RESTAURANT_GENERIC_LOOP_2_S sound_loop6 //Lips Bistro

//docks
ADD_CONTINUOUS_SOUND 1579.8 -655.2 13.0 SOUND_DOCKS_LOOP_L sound_loop13 //Docks
ADD_CONTINUOUS_SOUND 1504.8 -873.2 19.0 SOUND_DOCKS_LOOP_L sound_loop14 //Docks2

//Towers
ADD_CONTINUOUS_SOUND 962.3 -259.7 10.0 SOUND_HOME_LOOP_1_L sound_loop15 //Tower Block1
ADD_CONTINUOUS_SOUND 952.5 -148.2 8.0 SOUND_CLUB_LOOP_2_L sound_loop16 //Tower Block2
ADD_CONTINUOUS_SOUND 861.5 -247.2 8.0 SOUND_CLUB_LOOP_1_L sound_loop17 //Tower Block3

//Unsecific Areas
ADD_CONTINUOUS_SOUND 1469.0 -181.0 56.0 SOUND_PIANO_BAR_LOOP_1_S sound_loop18 // Frankies Club
ADD_CONTINUOUS_SOUND 1120.7 -1023.3 23.0 SOUND_SAWMILL_LOOP_L sound_loop19 // Sawmills

//COMMERCIAL

//SUBURBIA

ADD_CONTINUOUS_SOUND -744.7 -604.1 10.0 SOUND_AIRPORT_LOOP_L sound_loop20 //Airport

// *****************************************SPECIAL CHARACTERS********************************

VAR_INT player
VAR_INT micky
VAR_INT luigi
VAR_INT joey
VAR_INT toni
VAR_INT frankie
VAR_INT maria
VAR_INT catalina
VAR_INT miguel
VAR_INT lips
VAR_INT chunky
VAR_INT	misty

VAR_INT asuka
VAR_INT kenji
VAR_INT ray
VAR_INT love
VAR_INT joeys_ride

// Cutscene stuff

VAR_INT cs_time  // timer for cutscenes
VAR_INT cs_player
VAR_INT cs_eight
VAR_INT cs_micky
VAR_INT cs_luigi
VAR_INT cs_joey
VAR_INT cs_tony
VAR_INT cs_frankie
VAR_INT cs_maria
VAR_INT cs_catalina
VAR_INT cs_miguel
VAR_INT cs_misty
VAR_INT cs_ludoor  //Luigi club door
VAR_INT cs_joedoor  //Joey door
VAR_INT cs_eitdoor  // Eightballs door
VAR_INT cs_mafia  //Mafia goon to be standing a Sals club
VAR_INT cs_ship
VAR_INT cs_gangplank
VAR_INT cs_catcar
VAR_INT cs_curly
VAR_INT	cs_shopdoor // Uncle BJ's shop door
VAR_INT cs_rifle  //Rifle 8-ball gives player
VAR_INT cs_bomb  //Bomb 8-ball places on boat 
VAR_INT cs_note
VAR_INT cs_troll
VAR_INT cs_case

VAR_INT cs_mickyhead
VAR_INT cs_playerhead
VAR_INT cs_eighthead
VAR_INT cs_luigihead
VAR_INT cs_joeyhead
VAR_INT cs_tonyhead
VAR_INT cs_mistyhead
VAR_INT cs_frankiehead
VAR_INT cs_mariahead

VAR_INT flag_failed_luigi1  //Don't remove

flag_failed_luigi1 = 0

VAR_INT flag_ms_mission

flag_ms_mission = 0

VAR_INT cs_asuka
VAR_INT cs_kenji
VAR_INT cs_ray
VAR_INT cs_love
VAR_INT cs_phil
VAR_INT cs_yakuza //Yakuza goon to be standing at kenji's in cutscenes
VAR_INT cs_butler // Loves butler
VAR_INT cs_keeper

VAR_INT cs_asukahead
VAR_INT cs_kenjihead
VAR_INT cs_rayhead
VAR_INT cs_lovehead
VAR_INT cs_philhead
VAR_INT cs_butlerhead
VAR_INT cs_catalinahead
VAR_INT cs_miguelhead
VAR_INT cs_curlyhead
VAR_INT cs_keeperhead

VAR_INT cs_colub1 cs_colub2 cs_colub3 cs_colub4


// *****************************************CREATE PLAYER***************************************   

CREATE_PLAYER 0 811.90 -939.95 35.8 player //8Ball mission
SET_PLAYER_HEADING player 180.0
GET_PLAYER_CHAR player script_controlled_player
	 

// *****************************************Industrial Default Gangs****************************

SET_GANG_CAR_MODEL GANG_MAFIA CAR_MAFIA //The Mafia
SET_GANG_CAR_MODEL GANG_TRIAD CAR_BELLYUP //The Triads
SET_GANG_CAR_MODEL GANG_DIABLO CAR_DIABLOS //The Diablos

SET_GANG_WEAPONS GANG_MAFIA WEAPONTYPE_PISTOL WEAPONTYPE_PISTOL //The Mafia
SET_GANG_WEAPONS GANG_TRIAD WEAPONTYPE_PISTOL WEAPONTYPE_BASEBALLBAT //The Triads
SET_GANG_WEAPONS GANG_DIABLO WEAPONTYPE_BASEBALLBAT WEAPONTYPE_UNARMED //The Diablos

// *************************************Commercial Default Gangs****************************

SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_COLOMBIAN THREAT_PLAYER1	

SET_GANG_CAR_MODEL GANG_YAKUZA CAR_YAKUZA //The YAKUZA
SET_GANG_CAR_MODEL GANG_COLOMBIAN CAR_COLUMB //The COLUMBIANS
SET_GANG_CAR_MODEL GANG_YARDIE CAR_YARDIE //The YARDIES

SET_GANG_WEAPONS GANG_YAKUZA WEAPONTYPE_PISTOL WEAPONTYPE_UZI //The YAKUZA
SET_GANG_WEAPONS GANG_COLOMBIAN WEAPONTYPE_PISTOL WEAPONTYPE_UZI //The COLUMBIANS
SET_GANG_WEAPONS GANG_YARDIE WEAPONTYPE_BASEBALLBAT WEAPONTYPE_PISTOL //The YARDIES

// *************************************Suburban Default Gangs****************************

SET_GANG_CAR_MODEL GANG_HOOD CAR_HOODS //The HOODS

SET_GANG_WEAPONS GANG_HOOD WEAPONTYPE_UZI WEAPONTYPE_PISTOL //The HOODS

// **************************************Game variables*************************************

// Global variables for missions

VAR_INT flag_player_on_mission
VAR_INT flag_industrial_passed
VAR_INT flag_commercial_passed
VAR_INT flag_suburban_passed
 
flag_player_on_mission = 0
flag_industrial_passed = 0
flag_commercial_passed = 0
flag_suburban_passed = 0

// Radar Contact Blips

VAR_INT luigi_contact_blip 
VAR_INT joey_contact_blip
VAR_INT toni_contact_blip
VAR_INT frankie_contact_blip
VAR_INT diablo_contact_blip
VAR_INT asuka_contact_blip
VAR_INT kenji_contact_blip
VAR_INT ray_contact_blip
VAR_INT love_contact_blip
VAR_INT yardie_contact_blip
VAR_INT maria_contact_blip
VAR_INT eightball_contact_blip
VAR_INT hood_contact_blip
VAR_INT meat_contact_blip
VAR_INT industrail_save_blip commercial_save_blip suburban_save_blip
VAR_INT created_ind_blip_before	created_com_blip_before created_sub_blip_before

created_ind_blip_before = 0
created_com_blip_before	= 0
created_sub_blip_before	= 0

// Death Arrest Variables

VAR_INT flag_player_on_eightball_mission
VAR_INT flag_player_on_luigi_mission
VAR_INT flag_player_on_joey_mission
VAR_INT	flag_player_on_toni_mission
VAR_INT flag_player_on_frankie_mission
VAR_INT flag_player_on_diablo_mission
VAR_INT	flag_player_on_asuka_mission
VAR_INT	flag_player_on_kenji_mission
VAR_INT flag_player_on_love_mission
VAR_INT flag_player_on_yardie_mission
VAR_INT	flag_player_on_ray_mission
VAR_INT	flag_player_on_asuka_suburban_mission
VAR_INT flag_player_on_hood_mission
VAR_INT flag_player_on_meat_mission

VAR_INT wdadd1 wdadd2 wdadd3 wdadd4 //vars added to match retail script

flag_player_on_eightball_mission = 0
flag_player_on_luigi_mission = 0
flag_player_on_joey_mission = 0
flag_player_on_toni_mission = 0
flag_player_on_frankie_mission = 0
flag_player_on_diablo_mission = 0
flag_player_on_asuka_mission = 0
flag_player_on_kenji_mission = 0
flag_player_on_love_mission = 0
flag_player_on_yardie_mission = 0
flag_player_on_ray_mission = 0
flag_player_on_asuka_suburban_mission = 0
flag_player_on_hood_mission = 0
flag_player_on_meat_mission = 0

// Death Arrest Stuff

DECLARE_MISSION_FLAG flag_player_on_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_8BALL flag_player_on_eightball_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_LUIGI flag_player_on_luigi_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_JOEY flag_player_on_joey_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_TONI flag_player_on_toni_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_FRANKIE flag_player_on_frankie_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_HISPANIC flag_player_on_diablo_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_ASUKA flag_player_on_asuka_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_KENJI flag_player_on_kenji_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_LOVE flag_player_on_love_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_YARDIE flag_player_on_yardie_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_RAY flag_player_on_ray_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_ASUKA_SUBURBAN flag_player_on_asuka_suburban_mission
DECLARE_MISSION_FLAG_FOR_CONTACT CONTACT_HOODS flag_player_on_hood_mission
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_8BALL 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_LUIGI 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_JOEY 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_TONI 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_FRANKIE 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_HISPANIC 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_ASUKA 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_KENJI 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_LOVE 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_YARDIE 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_RAY 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_ASUKA_SUBURBAN 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_RAY_SUBURBAN 1000
DECLARE_BASE_BRIEF_ID_FOR_CONTACT CONTACT_HOODS 1000

// Death Arrest Setting

SET_DEATHARREST_STATE ON

// ***********************************Industrial Variables**********************************

// 8ball Missions

VAR_INT flag_eightball_mission_passed
VAR_INT flag_eightball_mission_launched
VAR_INT flag_eightball_switched_off

flag_eightball_mission_passed = 0
flag_eightball_mission_launched = 0
flag_eightball_switched_off = 0

// Luigi variables for missions

VAR_INT flag_luigi_mission1_passed
VAR_INT flag_luigi_mission2_passed
VAR_INT flag_luigi_mission3_passed
VAR_INT flag_luigi_mission4_passed
VAR_INT flag_luigi_mission5_passed					   
VAR_INT flag_all_luigi_missions_passed

flag_luigi_mission1_passed = 0
flag_luigi_mission2_passed = 0
flag_luigi_mission3_passed = 0
flag_luigi_mission4_passed = 0
flag_luigi_mission5_passed = 0
flag_all_luigi_missions_passed = 0


// Joey variables for missions

VAR_INT flag_joey_mission1_passed
VAR_INT flag_joey_mission2_passed
VAR_INT flag_joey_mission3_passed
VAR_INT flag_joey_mission4_passed
VAR_INT flag_joey_mission5_passed
VAR_INT flag_joey_mission6_passed					   
VAR_INT flag_all_joey_missions_passed

flag_joey_mission1_passed = 0
flag_joey_mission2_passed = 0
flag_joey_mission3_passed = 0
flag_joey_mission4_passed = 0
flag_joey_mission5_passed = 0
flag_joey_mission6_passed = 0
flag_all_joey_missions_passed = 0


// Toni variables for missions

VAR_INT flag_toni_mission1_passed
VAR_INT flag_toni_mission2_passed
VAR_INT flag_toni_mission3_passed
VAR_INT flag_toni_mission4_passed
VAR_INT flag_toni_mission5_passed					   
VAR_INT flag_all_toni_missions_passed

flag_toni_mission1_passed = 0
flag_toni_mission2_passed = 0
flag_toni_mission3_passed = 0
flag_toni_mission4_passed = 0
flag_toni_mission5_passed = 0
flag_all_toni_missions_passed = 0


// Frankie variables for missions

VAR_INT flag_frankie_mission1_passed
VAR_INT flag_frankie_mission2_passed
VAR_INT flag_frankie_mission2.1_passed
VAR_INT flag_frankie_mission3_passed
VAR_INT flag_frankie_mission4_passed					   
VAR_INT flag_frankie_switched_off
VAR_INT flag_all_frankie_missions_passed
VAR_INT flag_frankie_mission3_part2_launched
VAR_INT flag_player_had_cut1_fm3

flag_frankie_mission3_part2_launched = 0
flag_frankie_mission1_passed = 0
flag_frankie_mission2_passed = 0
flag_frankie_mission2.1_passed = 0
flag_frankie_mission3_passed = 0
flag_frankie_mission4_passed = 0
flag_frankie_switched_off = 0
flag_all_frankie_missions_passed = 0
flag_player_had_cut1_fm3 = 0

// Final Industrial Mission

VAR_INT flag_final_mission1_passed
VAR_INT flag_final_mission1_launched 

flag_final_mission1_passed = 0
flag_final_mission1_launched = 0

// Diablo Industrial Missions

VAR_INT flag_diablo_mission1_passed
VAR_INT flag_diablo_mission2_passed
VAR_INT flag_diablo_mission3_passed
VAR_INT flag_diablo_mission4_passed
VAR_INT flag_diablo_switched_off
VAR_INT flag_all_diablo_missions_passed
VAR_INT switch_gang_diablo_off
VAR_INT flag_diablo1_phone_message
VAR_INT flag_diablo2_phone_message
VAR_INT flag_diablo3_phone_message
VAR_INT flag_diablo4_phone_message

flag_diablo_mission1_passed = 0
flag_diablo_mission2_passed = 0
flag_diablo_mission3_passed = 0
flag_diablo_mission4_passed = 0
flag_diablo_switched_off = 0
flag_all_diablo_missions_passed = 0
flag_diablo1_phone_message = 0
flag_diablo2_phone_message = 0
flag_diablo3_phone_message = 0
flag_diablo4_phone_message = 0

// Dog Food Factory Mission

VAR_INT flag_meat_mission1_passed
VAR_INT flag_meat_mission2_passed
VAR_INT flag_meat_mission3_passed
VAR_INT flag_meat_mission4_passed
VAR_INT flag_meat_phone_ringing
VAR_INT flag_meat1_phone_message
VAR_INT flag_meat2_phone_message
VAR_INT flag_meat3_phone_message
VAR_INT flag_meat4_phone_message

flag_meat_mission1_passed = 0
flag_meat_mission2_passed = 0
flag_meat_mission3_passed = 0
flag_meat_mission4_passed = 0
flag_meat_phone_ringing = 0
flag_meat1_phone_message = 0
flag_meat2_phone_message = 0
flag_meat3_phone_message = 0
flag_meat4_phone_message = 0

// **************************Industrial phone Variables*************************************

VAR_INT Diablo_phone
VAR_INT blip_diablo_created_before 
VAR_INT	flag_diablo1_passed_before //So you can re-take the Diablo Race again

flag_diablo1_passed_before = 0 
blip_diablo_created_before = 0
GRAB_PHONE 937.9 -230.1 Diablo_phone

// Dog Food Phone
VAR_INT meat_phone

GRAB_PHONE 1224.46 -839.78 meat_phone

//--------------------YARDIE--------------------------------------------
VAR_INT yardie_phone pager_yardie_diplayed
VAR_INT blip_yardie_created_before

pager_yardie_diplayed = 0
GRAB_PHONE 120.0 -272.0 yardie_phone

//-------------------PAY DAY FOR RAY PHONES-----------------------------
VAR_INT Ray_phone1 Ray_phone2 Ray_phone3 Ray_phone4 //Ray_phone5 Ray_phone6 Ray_phone7 Ray_phone8 Ray_phone9  

GRAB_PHONE 229.1 -1537.6 Ray_phone1
GRAB_PHONE -53.5 -699.0 Ray_phone2
GRAB_PHONE 204.7 -135.1 Ray_phone3 
GRAB_PHONE 60.2 -964.8 Ray_phone4

// ********************************Suburban Phone Variables*********************************

VAR_INT hood_phone
VAR_INT flag_blip_hood_created
VAR_INT flag_hood1_phone_message
VAR_INT flag_hood2_phone_message
VAR_INT flag_hood3_phone_message
VAR_INT flag_hood4_phone_message
VAR_INT flag_hood5_phone_message

flag_blip_hood_created = 0
flag_hood1_phone_message = 0
flag_hood2_phone_message = 0
flag_hood3_phone_message = 0
flag_hood4_phone_message = 0
flag_hood5_phone_message = 0

GRAB_PHONE -443.5 -6.6 hood_phone

// ***********************************Commercial Variables**********************************

// Asuka variables for missions

VAR_INT flag_asuka_mission1_passed
VAR_INT flag_asuka_mission2_passed
VAR_INT flag_asuka_mission3_passed
VAR_INT flag_asuka_mission4_passed
VAR_INT flag_asuka_mission5_passed
VAR_INT flag_all_asuka_missions_passed

flag_asuka_mission1_passed = 0
flag_asuka_mission2_passed = 0
flag_asuka_mission3_passed = 0
flag_asuka_mission4_passed = 0
flag_asuka_mission5_passed = 0
flag_all_asuka_missions_passed = 0



// Ray variables for missions

VAR_INT flag_ray_mission1_passed
VAR_INT flag_ray_mission2_passed
VAR_INT flag_ray_mission3_passed
VAR_INT flag_ray_mission4_passed
VAR_INT flag_ray_mission5_passed
VAR_INT flag_ray_mission6_passed					   
VAR_INT flag_all_ray_missions_passed

flag_ray_mission1_passed = 0
flag_ray_mission2_passed = 0
flag_ray_mission3_passed = 0
flag_ray_mission4_passed = 0
flag_ray_mission5_passed = 0
flag_ray_mission6_passed = 0
flag_all_ray_missions_passed = 0


// Kenji variables for missions

VAR_INT flag_kenji_mission1_passed
VAR_INT flag_kenji_mission2_passed
VAR_INT flag_kenji_mission3_passed
VAR_INT flag_kenji_mission4_passed
VAR_INT flag_kenji_mission5_passed					   
VAR_INT flag_all_kenji_missions_passed

flag_kenji_mission1_passed = 0
flag_kenji_mission2_passed = 0
flag_kenji_mission3_passed = 0
flag_kenji_mission4_passed = 0
flag_kenji_mission5_passed = 0
flag_all_kenji_missions_passed = 0


// love variables for missions

VAR_INT flag_love_mission1_passed
VAR_INT flag_love_mission2_passed
VAR_INT flag_love_mission3_passed  
VAR_INT flag_love1_launched

flag_love1_launched = 0
flag_love_mission1_passed = 0
flag_love_mission2_passed = 0
flag_love_mission3_passed = 0

// Yardie Commercial Missions

VAR_INT flag_yardie_mission1_passed
VAR_INT flag_yardie_mission2_passed
VAR_INT flag_yardie_mission3_passed
VAR_INT flag_yardie_mission4_passed					   
VAR_INT flag_yardie_switched_off
VAR_INT flag_all_yardie_missions_passed
VAR_INT flag_yardie1_phone_message
VAR_INT flag_yardie2_phone_message
VAR_INT flag_yardie3_phone_message
VAR_INT flag_yardie4_phone_message

flag_yardie_mission1_passed = 0
flag_yardie_mission2_passed = 0
flag_yardie_mission3_passed = 0
flag_yardie_mission4_passed = 0
flag_yardie_switched_off = 0
flag_all_yardie_missions_passed = 0
flag_yardie1_phone_message = 0
flag_yardie2_phone_message = 0
flag_yardie3_phone_message = 0
flag_yardie4_phone_message = 0

// ***************************************Suburban Variables********************************

// Love Mission variables

VAR_INT flag_love_mission4_passed 
VAR_INT	flag_love_mission5_passed
VAR_INT	flag_love_mission6_passed
VAR_INT	flag_love_mission7_passed
VAR_INT flag_all_love_missions_passed

flag_love_mission4_passed = 0
flag_love_mission5_passed = 0
flag_love_mission6_passed = 0
flag_love_mission7_passed = 0
flag_all_love_missions_passed = 0

// Asuka Suburban variables for missions

VAR_INT flag_asuka_suburban_mission1_passed
VAR_INT flag_asuka_suburban_mission2_passed
VAR_INT flag_asuka_suburban_mission3_passed
VAR_INT flag_asuka_suburban_mission4_passed
VAR_INT flag_all_asuka_suburban_missions_passed

flag_asuka_suburban_mission1_passed = 0
flag_asuka_suburban_mission2_passed = 0
flag_asuka_suburban_mission3_passed = 0
flag_asuka_suburban_mission4_passed = 0
flag_all_asuka_suburban_missions_passed = 0


// Hood variables for missions

VAR_INT flag_hood_mission1_passed
VAR_INT flag_hood_mission2_passed
VAR_INT flag_hood_mission3_passed
VAR_INT flag_hood_mission4_passed
VAR_INT flag_hood_mission5_passed
VAR_INT flag_hood_switched_off
VAR_INT flag_all_hood_missions_passed
VAR_INT flag_done_drive_by_help 

flag_done_drive_by_help = 0
flag_hood_mission1_passed = 0
flag_hood_mission2_passed = 0
flag_hood_mission3_passed = 0
flag_hood_mission4_passed = 0
flag_hood_mission5_passed = 0
flag_hood_switched_off = 0
flag_all_hood_missions_passed = 0


//Final Strand variables

VAR_INT flag_player_on_cat_mission
VAR_INT flag_cat_mission1_passed
VAR_INT flag_cat_mission2_passed

flag_player_on_cat_mission = 0
flag_cat_mission1_passed = 0
flag_cat_mission2_passed = 0


// Odd job variables

VAR_INT	been_in_ambulance_before, flag_player_on_ambulance_mission // Ambulance Missions
VAR_INT	been_in_a_firetruk_before, flag_player_on_fire_mission // Fire Truck Missions
VAR_INT	been_in_a_copcar_before, flag_player_on_cop_mission	// Cop Car Missions
VAR_INT passed_usj_counter // Unique Stunt Jump Counter
VAR_INT got_siren_help_before

got_siren_help_before = 0
passed_usj_counter = 0

// 4x4/carpark Missions

VAR_INT	flag_4x4_mission1_passed flag_4x4_mission2_passed flag_4x4_mission3_passed flag_mayhem_mission1_passed
VAR_INT flag_4x4one_trigger flag_4x4two_trigger flag_4x4three_trigger flag_mayhem_trigger
VAR_INT record_4x4_one record_4x4_two record_4x4_three record_mayhem record_temp
VAR_INT flag_intro1_before flag_intro2_before flag_intro3_before flag_intro_mayhem_before

flag_intro1_before = 0
flag_intro2_before = 0
flag_intro3_before = 0
flag_intro_mayhem_before = 0

flag_4x4_mission1_passed = 0
flag_4x4_mission2_passed = 0
flag_4x4_mission3_passed = 0
flag_mayhem_mission1_passed = 0

flag_4x4one_trigger = 0
flag_4x4two_trigger = 0
flag_4x4three_trigger = 0
flag_mayhem_trigger	= 0


// Taxi mission

VAR_INT taxi_passed, been_in_a_taxi_before, flag_taxi1_mission_launched, been_in_taxi1_before, new_taxi_created_before 
VAR_INT spray_taxi done_taxi_help

flag_taxi1_mission_launched = 0
been_in_a_taxi_before = 0
been_in_taxi1_before = 0
taxi_passed = 0	
done_taxi_help = 0
new_taxi_created_before = 0


// RC Demolition

VAR_INT rec_rc1 rec_rc2 rec_rc3 rec_rc4 rec_rc5 rec_rc6
VAR_INT flag_just_done_rc_mission flag_rc1_passed flag_rc2_passed flag_rc3_passed flag_rc4_passed

flag_just_done_rc_mission = 0
rec_rc1 = 0
rec_rc2 = 0
rec_rc3 = 0
rec_rc4 = 0
rec_rc5 = 0
rec_rc6 = 0
flag_rc1_passed = 0
flag_rc2_passed	= 0
flag_rc3_passed	= 0
flag_rc4_passed	= 0

//OTHER STUFF

VAR_INT phils_guns_created_before 
VAR_INT started_buggy_generator_before
VAR_INT flag_joey_mission5_terminated flag_joey_mission6_terminated
VAR_INT	flag_luigi_mission4_terminated flag_luigi_mission5_terminated
VAR_INT the_scripts_started_again
VAR_INT	timer_help_message_displayed //TIMER HELP MESSAGE
VAR_INT	nicked_half_a_mil_before
VAR_INT flag_done_radio_8ball
VAR_INT van_once_a_day
VAR_INT breakout_timer breakout_timer_start breakout_diff
VAR_INT maria_exists barriers_been_added
VAR_INT door_crash_flag //Variables used to close Luigis Door in Asuka 1
VAR_FLOAT door_position_a1 
VAR_INT flag_bridge_created_8ball // Makes rubble on bridge
VAR_INT com_ammu_nation2 com_sprayshop2 ammu2_blip_added 

ammu2_blip_added = 0
flag_bridge_created_8ball = 0
flag_done_radio_8ball = 0
timer_help_message_displayed = 0
flag_joey_mission5_terminated = 0
flag_joey_mission6_terminated = 0
flag_luigi_mission4_terminated = 0
flag_luigi_mission5_terminated = 0
the_scripts_started_again = 0
phils_guns_created_before = 0
started_buggy_generator_before = 0
nicked_half_a_mil_before = 0
van_once_a_day = 0
breakout_timer = 0
breakout_timer_start = 0
breakout_diff = 0
maria_exists = 0
door_crash_flag = 0
door_position_a1 = 0.0
barriers_been_added = 0

// ********************************************Odd Jobs*************************************

START_NEW_SCRIPT t4x4_mission1_loop

START_NEW_SCRIPT t4x4_mission2_loop

START_NEW_SCRIPT t4x4_mission3_loop

START_NEW_SCRIPT multistorey_mission_loop

START_NEW_SCRIPT taxi_mission1_loop

START_NEW_SCRIPT fire_truck_mission_loop

START_NEW_SCRIPT ambulance_mission_loop

START_NEW_SCRIPT cop_mission_loop

START_NEW_SCRIPT rc_loop
	
LAUNCH_MISSION hj.sc

LAUNCH_MISSION usj.sc

LAUNCH_MISSION genstuf.sc

LAUNCH_MISSION rampage.sc

LAUNCH_MISSION import.sc

LAUNCH_MISSION camera.sc

LAUNCH_MISSION gates.sc

WAIT 0

// ********************************create and delete all the contact bips**************************

ADD_SPRITE_BLIP_FOR_CONTACT_POINT 892.8 -425.8 13.9 RADAR_SPRITE_LUIGI luigi_contact_blip
	REMOVE_BLIP	luigi_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1191.7 -870.0 -100.0 RADAR_SPRITE_JOEY joey_contact_blip
	REMOVE_BLIP	joey_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1219.6 -321.0 -100.0 RADAR_SPRITE_TONY toni_contact_blip
	REMOVE_BLIP toni_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1455.7 -187.3 -100.0 RADAR_SPRITE_SAL frankie_contact_blip
	REMOVE_BLIP	frankie_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1272.2 -92.9 -100.0 RADAR_SPRITE_EIGHT eightball_contact_blip
	REMOVE_BLIP	eightball_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 938.4 -230.5 -100.0 RADAR_SPRITE_EL diablo_contact_blip
	REMOVE_BLIP	diablo_contact_blip

ADD_SPRITE_BLIP_FOR_CONTACT_POINT 523.6 -639.4 16.6 RADAR_SPRITE_ASUKA asuka_contact_blip
	REMOVE_BLIP	asuka_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 459.1 -1413.0 26.1 RADAR_SPRITE_KENJI kenji_contact_blip
	REMOVE_BLIP	kenji_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 38.8 -725.4 -100.0 RADAR_SPRITE_RAY ray_contact_blip
	REMOVE_BLIP	ray_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 86.1 -1548.7 28.3 RADAR_SPRITE_DON love_contact_blip
	REMOVE_BLIP	love_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 120.7 -272.1 16.1 RADAR_SPRITE_LIZ yardie_contact_blip
	REMOVE_BLIP	yardie_contact_blip

ADD_SPRITE_BLIP_FOR_CONTACT_POINT -363.7 246.1 60.0 RADAR_SPRITE_CAT maria_contact_blip
	REMOVE_BLIP	maria_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT -443.5 -6.1 3.8 RADAR_SPRITE_ICE hood_contact_blip
	REMOVE_BLIP	hood_contact_blip

ADD_SPRITE_BLIP_FOR_CONTACT_POINT 893.5 -306.1 -100.0 RADAR_SPRITE_SAVE industrail_save_blip
	REMOVE_BLIP	industrail_save_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 103.0 -484.2 -100.0 RADAR_SPRITE_SAVE commercial_save_blip
	REMOVE_BLIP	commercial_save_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT -665.0 -6.5 -100.0 RADAR_SPRITE_SAVE suburban_save_blip
	REMOVE_BLIP	suburban_save_blip
ADD_SPRITE_BLIP_FOR_COORD 925.0 -359.5 -100.0 RADAR_SPRITE_SPRAY spray_taxi
	REMOVE_BLIP	spray_taxi

//Targettable objects

MAKE_OBJECT_TARGETTABLE target1
MAKE_OBJECT_TARGETTABLE target2
MAKE_OBJECT_TARGETTABLE target3

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1027.26 -933.796 15.042 50.0 indhelix_barrier FALSE 
SWAP_NEAREST_BUILDING_MODEL 1027.26 -933.796 15.042 50.0 indhelix_barrier LOD_land014  

IF IS_PLAYER_PLAYING Player
	SET_PLAYER_CONTROL Player Off
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 0 FADE_OUT

//DEBUG SETUP*************************************************************************************
/*
SWITCH_WORLD_PROCESSING OFF //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 
WAIT 1500 //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
SWITCH_WORLD_PROCESSING ON //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

IF IS_BUTTON_PRESSED PAD1 CROSS 
	LOAD_SCENE 916.3 -413.6 15.0  //START LUIGIS***************************************************************
	flag_eightball_mission_passed = 1 //TEST SO SAVE HOUSE WORKS
	IF IS_PLAYER_PLAYING player
		SET_INTRO_IS_PLAYING FALSE
		SET_TIME_OF_DAY 9 00
		SET_PLAYER_COORDINATES Player 916.3 -413.6 -100.0
		SET_PLAYER_HEADING player 140.0
		SET_CAMERA_BEHIND_PLAYER
		LAUNCH_MISSION debug.sc
		DO_FADE 1000 FADE_IN
		ADD_SCORE player 1000000
		
		//SWAP BRIDGE FROM FIXED TO DAMAGED
		SWAP_NEAREST_BUILDING_MODEL	525.362 -927.066 71.841	20.0 nbbridgcabls01 nbbridgfk2	
		SWAP_NEAREST_BUILDING_MODEL	706.432 -935.82  67.071	20.0 nbbridgcabls01 nbbridgfk2
		SWAP_NEAREST_BUILDING_MODEL	529.023 -920.098 43.504 20.0 nbbridgerdb damgbridgerdb 
		SWAP_NEAREST_BUILDING_MODEL	702.763 -939.963 38.736	20.0 nbbridgerdb damgbridgerdb 
		SWAP_NEAREST_BUILDING_MODEL	529.023 -942.94  43.504	20.0 nbbridgerda damgbbridgerda
		SWAP_NEAREST_BUILDING_MODEL	702.764 -919.963 38.736	20.0 nbbridgerda damgbbridgerda		

		SWAP_NEAREST_BUILDING_MODEL	525.362 -927.066 71.841	20.0 lodridgcabls01 lodridgfk2	
		SWAP_NEAREST_BUILDING_MODEL	706.432 -935.82  67.071	20.0 lodridgcabls01 lodridgfk2	
		SWAP_NEAREST_BUILDING_MODEL	521.146 -922.94  43.504 20.0 lodridgerdb lodgbridgerdb 
		SWAP_NEAREST_BUILDING_MODEL	702.763 -939.963 38.736	20.0 lodridgerdb lodgbridgerdb 
		SWAP_NEAREST_BUILDING_MODEL	529.023 -940.098 43.504	20.0 lodridgerda lodgbbridgerda	
		SWAP_NEAREST_BUILDING_MODEL	702.764 -919.963 38.736	20.0 lodridgerda lodgbbridgerda	
 		
		//GOSUB_FILE switch_car_generator switch.sc // GS-SC: switch.sc is a now redundant file for switching car generators on

		START_NEW_SCRIPT ind_save_loop
		START_NEW_SCRIPT sub_save_loop
		START_NEW_SCRIPT com_save_loop
		START_NEW_SCRIPT ind_restart
		START_NEW_SCRIPT com_restart
		START_NEW_SCRIPT sub_restart

		IF IS_PLAYER_PLAYING Player
			SET_PLAYER_CONTROL Player on
		ENDIF

		GOTO mission_start
	ENDIF
ENDIF
*/

//FULL GAME LOAD***********************************************************************************************

GET_CUTSCENE_TIME cs_time  // Hacked script call to bypass the intro or not.

IF cs_time = -1000
    SET_INTRO_IS_PLAYING FALSE
    SET_PLAYER_COORDINATES Player 916.3 -413.6 -100.0
DO_FADE 1000 FADE_IN

ELSE
   LOAD_AND_LAUNCH_MISSION intro.sc
ENDIF

LAUNCH_MISSION mission_skip.sc  // For now we can just launch this. Turn off for shipping.


START_NEW_SCRIPT ind_save_loop
START_NEW_SCRIPT com_save_loop
START_NEW_SCRIPT sub_save_loop

START_NEW_SCRIPT ind_restart
START_NEW_SCRIPT com_restart
START_NEW_SCRIPT sub_restart

START_NEW_SCRIPT hospital_info_loop
START_NEW_SCRIPT police_info_loop

IF IS_PLAYER_PLAYING Player
	SET_PLAYER_CONTROL Player on
ENDIF

mission_start:

WAIT 1000

IF IS_PLAYER_PLAYING Player

//INDUSTRIAL BLOCK********************************************************************************************************

	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL 

		//HOSPITAL INFO PICKUPS
		IF flag_player_on_mission = 0
		AND heal_info_trip = 0
		AND flag_health_info = 0
			CREATE_PICKUP info PICKUP_ONCE 1144.2 -596.9 14.9 heal_info //hospital info cut
			heal_info_trip = 1
		ENDIF

		IF flag_player_on_mission = 1
		AND heal_info_trip = 1
			REMOVE_PICKUP heal_info //hospital info cut
			heal_info_trip = 0
		ENDIF

		//POLICE INFO PICKUPS
		IF flag_player_on_mission = 0
		AND wanted_info_trip = 0
		AND flag_wanted_info = 0
			CREATE_PICKUP info PICKUP_ONCE 1143.9 -675.2 15.0 wanted_info //police info cut
			wanted_info_trip = 1
		ENDIF

		IF flag_player_on_mission = 1
		AND wanted_info_trip = 1
			REMOVE_PICKUP wanted_info //police info cut
			wanted_info_trip = 0
		ENDIF
		/*
		IF IS_PLAYER_IN_ZONE Player LITTLEI
			IF are_objects_targettable = 0
				MAKE_OBJECT_TARGETTABLE target1
				MAKE_OBJECT_TARGETTABLE target2
				MAKE_OBJECT_TARGETTABLE target3
				are_objects_targettable = 1
			ENDIF
		ELSE
			IF are_objects_targettable = 1
				are_objects_targettable = 0
			ENDIF
		ENDIF
		*/
	ENDIF //IS_PLAYER_IN_ZONE	
	
ENDIF	//	IF IS_PLAYER_PLAYING Player

GOTO mission_start


//  ***********************wanted/health info************************************************


hospital_info_loop:
{
WAIT 0
 

IF IS_PLAYER_PLAYING player
	IF IS_PLAYER_IN_ZONE player S_VIEW
	AND flag_player_on_mission = 0
	AND heal_info_trip = 1
		IF HAS_PICKUP_BEEN_COLLECTED heal_info
			SET_PLAYER_CONTROL player off
			WHILE GET_FADING_STATUS
				WAIT 0
			ENDWHILE
			LOAD_AND_LAUNCH_MISSION health.sc
			TERMINATE_THIS_SCRIPT
		ENDIF
	ENDIF
ENDIF
 
GOTO hospital_info_loop
} 
 
police_info_loop:
{
WAIT 0
 
IF IS_PLAYER_PLAYING player
	IF IS_PLAYER_IN_ZONE player S_VIEW
	AND flag_player_on_mission = 0
	AND wanted_info_trip = 1
		IF HAS_PICKUP_BEEN_COLLECTED wanted_info
			SET_PLAYER_CONTROL player off
			WHILE GET_FADING_STATUS
				WAIT 0
			ENDWHILE
			LOAD_AND_LAUNCH_MISSION wanted.sc
			TERMINATE_THIS_SCRIPT
		ENDIF
	ENDIF
ENDIF
 
GOTO police_info_loop 
}

// *************************************RC Demolition****************************************

rc_loop:
{
	WAIT 0
	//SCRIPT_NAME rcloop
	IF IS_PLAYER_PLAYING player
	AND flag_just_done_rc_mission = 0
		IF IS_PLAYER_IN_MODEL player CAR_TOYZ
			IF flag_player_on_mission = 0
				IF LOCATE_PLAYER_ANY_MEANS_3D player 1014.0 -120.0 5.0 5.0 5.0 5.0 false
					PRINT_BIG ( RC1 ) 15000 2
					WAIT 0
					LOAD_AND_LAUNCH_MISSION rc1.sc	//	this doesn't have a fade - maybe should always be loaded?
				ENDIF
				IF IS_PLAYER_PLAYING player
					IF LOCATE_PLAYER_ANY_MEANS_3D player 1158.0 -309.0 23.0 5.0 5.0 5.0 false
						PRINT_BIG ( RC2 ) 15000 2
						WAIT 0
						LOAD_AND_LAUNCH_MISSION rc2.sc	//	this doesn't have a fade - maybe should always be loaded?
					ENDIF
				ENDIF
				IF IS_PLAYER_PLAYING player
					IF LOCATE_PLAYER_ANY_MEANS_3D player -636.0 65.0 19.0 5.0 5.0 5.0 false
						PRINT_BIG ( RC4 ) 15000 2
						WAIT 0
						LOAD_AND_LAUNCH_MISSION rc3.sc	//	this doesn't have a fade - maybe should always be loaded?
					ENDIF
				ENDIF
				IF IS_PLAYER_PLAYING player
					IF LOCATE_PLAYER_ANY_MEANS_3D player 366.0 -1312.0 26.0 5.0 5.0 5.0 false
						PRINT_BIG ( RC3 ) 15000 2
						WAIT 0
						LOAD_AND_LAUNCH_MISSION rc4.sc	//	this doesn't have a fade - maybe should always be loaded?
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF NOT IS_PLAYER_IN_MODEL player CAR_TOYZ
			flag_just_done_rc_mission = 0
		ENDIF
	ENDIF

	GOTO rc_loop
}

// *******************************************4x4 Missions***********************************

t4x4_mission1_loop:
{
WAIT mission_trigger_wait_time  // WDTOM this is a problem; it allows the player to spam the exit vehicle button after getting into the car, but before the mission starts, which
                                // leaves the vehicle locked until the player leaves the area and comes back...

IF flag_4x4_mission1_passed = 0
	record_4x4_one = 300
ENDIF

IF IS_PLAYER_PLAYING player
	
	IF flag_player_on_mission = 0
	AND IS_PLAYER_IN_ZONE player S_VIEW
		
		IF IS_PLAYER_IN_MODEL player CAR_PATRIOT
		AND NOT IS_PLAYER_IN_AREA_2D player 1294.0 -656.0 1316.0 -638.0 false
			flag_4x4one_trigger = 1
		ENDIF
		 
		IF IS_PLAYER_IN_MODEL player CAR_PATRIOT
		AND flag_4x4one_trigger = 0
			PRINT_BIG (T4X4_1) 15000 2
			WAIT 0
			LOAD_AND_LAUNCH_MISSION 4x4_1.sc	//	ask James about the fades in this one?
		ENDIF

		IF IS_PLAYER_PLAYING player
			IF NOT IS_PLAYER_IN_ANY_CAR player
				flag_4x4one_trigger = 0
			ENDIF
		ENDIF

	ENDIF

ENDIF

GOTO t4x4_mission1_loop
}

t4x4_mission2_loop:
{
WAIT mission_trigger_wait_time

IF flag_4x4_mission2_passed = 0
	record_4x4_two = 120
ENDIF

IF IS_PLAYER_PLAYING player

	IF flag_player_on_mission = 0
	AND IS_PLAYER_IN_ZONE player PARK

		IF IS_PLAYER_IN_MODEL player CAR_LANDSTALKER
		AND NOT IS_PLAYER_IN_AREA_2D player 58.0 -585.0 68.0 -595.0 false
			flag_4x4two_trigger = 1
		ENDIF
		 
		IF IS_PLAYER_IN_MODEL player CAR_LANDSTALKER
		AND flag_4x4two_trigger = 0
			PRINT_BIG ( T4X4_2 ) 15000 2
			WAIT 0
			LOAD_AND_LAUNCH_MISSION 4x4_2.sc	//	ask James about the fades in this one?
		ENDIF

		IF IS_PLAYER_PLAYING player
			IF NOT IS_PLAYER_IN_ANY_CAR player
				flag_4x4two_trigger = 0
			ENDIF
		ENDIF

	ENDIF
ENDIF

GOTO t4x4_mission2_loop
}

t4x4_mission3_loop:
{
WAIT mission_trigger_wait_time

IF flag_4x4_mission3_passed = 0
	record_4x4_three = 300
ENDIF

IF IS_PLAYER_PLAYING player

	IF flag_player_on_mission = 0
	AND IS_PLAYER_IN_AREA_2D player -230.0 255.0 -210.0 275.0 false

		IF IS_PLAYER_IN_MODEL player CAR_PATRIOT
		AND NOT IS_PLAYER_IN_AREA_2D player -230.0 255.0 -210.0 275.0 false
			flag_4x4three_trigger = 1
		ENDIF
		 
		IF IS_PLAYER_IN_MODEL player CAR_PATRIOT
		AND flag_4x4three_trigger = 0
			PRINT_BIG (T4X4_3) 15000 2
			WAIT 0
			LOAD_AND_LAUNCH_MISSION 4x4_3.sc	//	ask James about the fades in this one?
		ENDIF

		IF IS_PLAYER_PLAYING player
			IF NOT IS_PLAYER_IN_ANY_CAR player
				flag_4x4three_trigger = 0
			ENDIF
		ENDIF

	ENDIF

ENDIF
GOTO t4x4_mission3_loop
}


multistorey_mission_loop:
{
WAIT mission_trigger_wait_time

IF flag_mayhem_mission1_passed = 0
	record_mayhem = 120
ENDIF
 
/*IF IS_PLAYER_PLAYING player

	IF flag_player_on_mission = 0
	AND IS_PLAYER_IN_ZONE player COM_EAS

		IF IS_PLAYER_IN_MODEL player CAR_STALLION
		AND NOT IS_PLAYER_IN_AREA_2D player 238.0 -612.0 267.0 -469.0 false
			flag_mayhem_trigger = 1
		ENDIF

		IF IS_PLAYER_IN_MODEL player CAR_STALLION
		AND flag_mayhem_trigger = 0
			PRINT_BIG ( MM_1 ) 15000 2
			WAIT 0
			LOAD_AND_LAUNCH_MISSION mayhem1.sc	//	ask James about the fades in this one?
		ENDIF

		IF IS_PLAYER_PLAYING player
			IF NOT IS_PLAYER_IN_ANY_CAR player
				flag_mayhem_trigger = 0
			ENDIF
		ENDIF

	ENDIF
	*/
	IF IS_PLAYER_PLAYING player

		IF flag_player_on_mission = 0
		AND IS_PLAYER_IN_AREA_2D player -2979.0 1664.0 6446.0 -2000.0 FALSE  // Check that player is on the middle island
			
			IF IS_PLAYER_IN_MODEL player CAR_STALLION // Check that player is in a Stallion
			AND flag_ms_mission = 0
				DISPLAY_RADAR 3
				DISPLAY_RADAR 10
				ADD_BLIP_FOR_CONTACT_POINT 264.3 -572.8 -100.0 c_blip
				ADD_BLIP_FOR_COORD 264.3 -572.8 -100.0 c_blip1
				flag_ms_mission = 1
			ENDIF

			IF NOT IS_PLAYER_IN_MODEL player CAR_STALLION // If player gets out of stallion, clear radar blip
			AND flag_ms_mission = 1
				REMOVE_BLIP c_blip
				REMOVE_BLIP c_blip1
				flag_ms_mission = 0
			ENDIF

			IF flag_ms_mission = 1
				
				IF LOCATE_PLAYER_ANY_MEANS_2D player 264.3 -572.8 2.0 2.0 FALSE // Check for player in corona, if so start mission
				AND IS_PLAYER_IN_MODEL player CAR_STALLION
					REMOVE_BLIP c_blip
					REMOVE_BLIP c_blip1
					PRINT_BIG ( MM_1 ) 15000 2
					WAIT 0
					LOAD_AND_LAUNCH_MISSION mayhem1.sc	//	ask James about the fades in this one?
				ENDIF
			ENDIF

		
		ELSE
			IF flag_ms_mission = 1
				REMOVE_BLIP c_blip
				REMOVE_BLIP c_blip1
				flag_ms_mission = 0
			ENDIF	
		ENDIF
	ENDIF
 
GOTO multistorey_mission_loop
}



// ********************************** Ambulance Mission **********************************
//
// Ambulance Mission


ambulance_mission_loop:
{
	WAIT 0
	
	IF IS_PLAYER_PLAYING player
		IF IS_PLAYER_IN_MODEL player CAR_AMBULANCE

			IF flag_player_on_mission = 0
			AND flag_player_on_ambulance_mission = 0
				
				IF been_in_ambulance_before = 0
					PRINT_HELP ( ATUTOR ) //Press RIGHTSHOCK to start
					been_in_ambulance_before = 1
				ENDIF

				
				IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
					WHILE IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
						WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO ambulance_mission_loop
						ENDIF
					ENDWHILE

					PRINT_BIG ( AMBUL_M ) 4000 5
					WAIT 0
					LOAD_AND_LAUNCH_MISSION ambulance.sc	//	this doesn't have a fade - maybe should always be loaded?
					been_in_ambulance_before = 1
				ENDIF
				
			ENDIF
		ELSE	// not in an ambulance
			IF been_in_ambulance_before = 1
				CLEAR_HELP
				been_in_ambulance_before = 0
			ENDIF
		ENDIF	//	IF IS_PLAYER_IN_MODEL player CAR_AMBULANCE
	ENDIF

	GOTO ambulance_mission_loop	
}


// ***************************************Fire Mission 1**********************************
//
// Fire Mission 1


fire_truck_mission_loop:
{
	WAIT 0

	IF IS_PLAYER_PLAYING player
		IF IS_PLAYER_IN_MODEL Player CAR_FIRETRUCK

			IF flag_player_on_mission = 0
			AND flag_player_on_fire_mission = 0
				
				IF been_in_a_firetruk_before = 0
					PRINT_HELP ( FTUTOR ) //Press RIGHTSHOCK to start
					been_in_a_firetruk_before = 1
				ENDIF

				IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
					WHILE IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
						WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO fire_truck_mission_loop
						ENDIF
					ENDWHILE

					PRINT_BIG ( FIRE_M ) 4000 5
					WAIT 0
					LOAD_AND_LAUNCH_MISSION firetruck.sc	//	this doesn't have a fade - maybe should always be loaded?
					been_in_a_firetruk_before = 1
				ENDIF
				
			ENDIF
		ELSE	//	not in a firetruck
			IF been_in_a_firetruk_before = 1
				CLEAR_HELP
				been_in_a_firetruk_before = 0
			ENDIF
		ENDIF	//	IF IS_PLAYER_IN_MODEL Player CAR_FIRETRUCK
	ENDIF

	GOTO fire_truck_mission_loop	
}


// ************************************** Cop Car Mission ***********************************
//
// Cop Car Mission


cop_mission_loop:
{
	WAIT 0

	IF IS_PLAYER_PLAYING player

		IF IS_PLAYER_IN_MODEL player CAR_POLICE
		OR IS_PLAYER_IN_MODEL player CAR_ENFORCER
		OR IS_PLAYER_IN_MODEL player CAR_RHINO
		OR IS_PLAYER_IN_MODEL player CAR_FBI
			IF flag_player_on_mission = 0
			AND flag_player_on_cop_mission = 0
				
				IF been_in_a_copcar_before = 0
					PRINT_HELP ( CTUTOR ) //Press RIGHTSHOCK to start
					been_in_a_copcar_before = 1
				ENDIF

				IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
					WHILE IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
						WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO cop_mission_loop
						ENDIF
					ENDWHILE

					PRINT_BIG ( COP_M ) 4000 5
					WAIT 0
					LOAD_AND_LAUNCH_MISSION copcar.sc	//	this doesn't have a fade - maybe should always be loaded?
					been_in_a_copcar_before = 1
				ENDIF
				
			ENDIF
		ELSE	//	not in a copcar
			IF been_in_a_copcar_before = 1
				CLEAR_HELP
				been_in_a_copcar_before = 0
			ENDIF
		ENDIF // If in some kind of cop car
	ENDIF	

	GOTO cop_mission_loop	
}


// ***************************************Taxi Mission 1**********************************


// Taxi Mission 1


taxi_mission1_loop:
{

	WAIT 0

	IF IS_PLAYER_PLAYING player

		IF IS_PLAYER_IN_TAXI Player

			IF flag_player_on_mission = 0
			AND flag_taxi1_mission_launched = 0
				
				IF been_in_a_taxi_before = 0
					PRINT_HELP ( TTUTOR ) //Press RIGHTSHOCK to start
					been_in_a_taxi_before = 1
				ENDIF
 
				IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
					WHILE IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
						WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO taxi_mission1_loop
						ENDIF
					ENDWHILE

					PRINT_BIG ( TAXI_M ) 4000 5
					WAIT 0
					LOAD_AND_LAUNCH_MISSION taxi1.sc	//	this doesn't have a fade - maybe should always be loaded?
					flag_taxi1_mission_launched = 1
				ENDIF
				
			ENDIF
		ELSE	// not in a taxi
			IF been_in_a_taxi_before = 1
				CLEAR_HELP
				been_in_a_taxi_before = 0
			ENDIF
		ENDIF	// IF IS_PLAYER_IN_TAXI Player
	ENDIF 

GOTO taxi_mission1_loop
}



// *************************************Meat Factory Mission 1******************************

// Meat Factory Mission 1

meat_mission1_loop:
{

WAIT mission_trigger_wait_time


	IF flag_meat_mission1_passed = 1
		TURN_PHONE_OFF meat_phone
		//flag_diablo_phone_ringing = 0
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
		GET_TIME_OF_DAY hours minutes
		IF hours >= 9
		AND hours < 19
			TURN_PHONE_ON meat_phone
		ELSE
			TURN_PHONE_OFF meat_phone
		ENDIF 	
	ELSE
		TURN_PHONE_OFF meat_phone
	ENDIF
							
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 1224.6 -840.3 15.0 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF meat_phone
					GET_TIME_OF_DAY hours minutes
					IF hours >= 9
					AND hours < 19

						MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

						SET_FADING_COLOUR 0 0 0

						DO_FADE 1500 FADE_OUT

						PRINT_BIG ( MEA1 ) 15000 2 //"THE CROOK"	 

						WHILE GET_FADING_STATUS
							WAIT 0
						ENDWHILE

						LOAD_AND_LAUNCH_MISSION meat1.sc
					ENDIF
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO meat_mission1_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 1224.6 -840.3 15.0 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO meat_mission1_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			

	GOTO meat_mission1_loop

}

// Meat Factory Mission 2

meat_mission2_loop:
{

WAIT mission_trigger_wait_time


	IF flag_meat_mission2_passed = 1
		TURN_PHONE_OFF meat_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
		GET_TIME_OF_DAY hours minutes
		IF hours >= 9
		AND hours < 19
			TURN_PHONE_ON meat_phone
		ELSE
			TURN_PHONE_OFF meat_phone
		ENDIF 	
	ELSE
		TURN_PHONE_OFF meat_phone
	ENDIF
			
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 1224.6 -840.3 15.0 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF meat_phone
					GET_TIME_OF_DAY hours minutes
					IF hours >= 9
					AND hours < 19

						MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

						SET_FADING_COLOUR 0 0 0

						DO_FADE 1500 FADE_OUT

						PRINT_BIG ( MEA2 ) 15000 2 //"THE THIEVES"

						WHILE GET_FADING_STATUS
							WAIT 0
						ENDWHILE

						LOAD_AND_LAUNCH_MISSION meat2.sc
					ENDIF
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO meat_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 1224.6 -840.3 15.0 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO meat_mission2_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			

	GOTO meat_mission2_loop

}

// Meat Factory Mission 3

meat_mission3_loop:
{

WAIT mission_trigger_wait_time


	IF flag_meat_mission3_passed = 1
		TURN_PHONE_OFF meat_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
		GET_TIME_OF_DAY hours minutes
		IF hours >= 9
		AND hours < 19
			TURN_PHONE_ON meat_phone
		ELSE
			TURN_PHONE_OFF meat_phone
		ENDIF 	
	ELSE
		TURN_PHONE_OFF meat_phone
	ENDIF
			
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 1224.6 -840.3 15.0 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF meat_phone
					GET_TIME_OF_DAY hours minutes
					IF hours >= 9
					AND hours < 19

						MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

						SET_FADING_COLOUR 0 0 0

						DO_FADE 1500 FADE_OUT

						PRINT_BIG ( MEA3 ) 15000 2 //"THE WIFE"	

						WHILE GET_FADING_STATUS
							WAIT 0
						ENDWHILE

						LOAD_AND_LAUNCH_MISSION meat3.sc
					ENDIF
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO meat_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 1224.6 -840.3 15.0 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO meat_mission3_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			

	GOTO meat_mission3_loop

}

// Meat Factory Mission 4

meat_mission4_loop:
{

WAIT mission_trigger_wait_time


	IF flag_meat_mission4_passed = 1
		TURN_PHONE_OFF meat_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
		GET_TIME_OF_DAY hours minutes
		IF hours >= 9
		AND hours < 19
			TURN_PHONE_ON meat_phone
		ELSE
			TURN_PHONE_OFF meat_phone
		ENDIF 	
	ELSE
		TURN_PHONE_OFF meat_phone
	ENDIF
			
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 1224.6 -840.3 15.0 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF meat_phone
					GET_TIME_OF_DAY hours minutes
					IF hours >= 9
					AND hours < 19

						MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

						SET_FADING_COLOUR 0 0 0

						DO_FADE 1500 FADE_OUT

						PRINT_BIG ( MEA4 ) 15000 2 //"HER LOVER"

						WHILE GET_FADING_STATUS
							WAIT 0
						ENDWHILE

						LOAD_AND_LAUNCH_MISSION meat4.sc
					ENDIF
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO meat_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 1224.6 -840.3 15.0 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO meat_mission4_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			

	GOTO meat_mission4_loop

}


// ***************************************Industrial Level**********************************

// ******************************************8Ball Mission**********************************

// 8Ball Mission


eightball_mission_loop:
{

WAIT 0

IF flag_industrial_passed = 1
AND flag_eightball_mission_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_eightball_mission_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
	AND flag_eightball_mission_launched = 0
	AND flag_player_on_mission = 0
		IF flag_reached_hideout = 0								    
			IF LOCATE_PLAYER_ON_FOOT_2D player 811.90 -939.95 3.5 3.5 FALSE
				IF CAN_PLAYER_START_MISSION Player
					LOAD_AND_LAUNCH_MISSION 8ball.sc	//	Don't know what to do about fades with this one
					flag_eightball_mission_launched = 1
				ENDIF
			ENDIF
		ELSE
			IF LOCATE_PLAYER_ON_FOOT_2D player 883.5 -308.2 3.5 3.5 FALSE 
				IF CAN_PLAYER_START_MISSION Player
					LOAD_AND_LAUNCH_MISSION 8ball.sc	//	Don't know what to do about fades with this one
					flag_eightball_mission_launched = 1
				ENDIF
			ENDIF
		ENDIF 
	ENDIF
   
GOTO eightball_mission_loop

}



// *******************************************Luigi Missions********************************

// Luigi Mission 2

luigi_mission2_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_luigi_mission2_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_luigi_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 892.8 -425.8 13.9 1.5 2.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( LM2 ) 15000 2 //"Don'a SPANK ma bitch up"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION luigi2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO luigi_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 892.8 -425.8 13.9 1.5 2.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO luigi_mission2_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
	

	GOTO luigi_mission2_loop

}



// Luigi Mission 3

luigi_mission3_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_luigi_mission3_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF


	IF flag_luigi_mission3_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 892.8 -425.8 13.9 1.5 2.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( LM3 ) 15000 2 //"Drive Misty For Me."

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION luigi3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO luigi_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 892.8 -425.8 13.9 1.5 2.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO luigi_mission3_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
	
	GOTO luigi_mission3_loop

}


// Luigi Mission 4

luigi_mission4_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_luigi_mission4_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_luigi_mission4_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF flag_toni_mission3_passed = 1
	AND flag_frankie_mission1_passed = 0
		flag_luigi_mission4_terminated = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 892.8 -425.8 13.9 1.5 2.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( LM4 ) 15000 2 //"Pump Action Pimp"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION luigi4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO luigi_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 892.8 -425.8 13.9 1.5 2.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO luigi_mission4_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF

	

	GOTO luigi_mission4_loop

}


// Luigi Mission 5

luigi_mission5_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_luigi_mission5_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF


	IF flag_luigi_mission5_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF flag_toni_mission3_passed = 1
	AND flag_frankie_mission1_passed = 0
		flag_luigi_mission5_terminated = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 892.8 -425.8 13.9 1.5 2.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( LM5 ) 15000 2 //"Fuzz Ball"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION luigi5.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO luigi_mission5_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 892.8 -425.8 13.9 1.5 2.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO luigi_mission5_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
	
	
	GOTO luigi_mission5_loop

}

// ***************************************Joey Missions*************************************


// Joey Mission 1

joey_mission1_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_joey_mission1_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_joey_mission1_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ANY_MEANS_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				GET_TIME_OF_DAY hours minutes
				IF hours >= 5
				AND hours < 21
					IF CAN_PLAYER_START_MISSION Player

						MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

						SET_FADING_COLOUR 0 0 0

						IF wdadd1 < 3
							DO_FADE 1500 FADE_OUT
						ENDIF

						SWITCH_STREAMING OFF

						PRINT_BIG ( JM1 ) 15000 2 //"Joey Mission 1"

						WHILE GET_FADING_STATUS
							WAIT 0
						ENDWHILE
						wdadd1=0
						LOAD_AND_LAUNCH_MISSION joey1.sc
					ENDIF

					IF NOT IS_PLAYER_PLAYING player
						GOTO joey_mission1_loop
					ENDIF

					WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
						WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO joey_mission1_loop
						ENDIF
					ENDWHILE
				ELSE
					PRINT_NOW ( WRONGT1 ) 5000 1 //" Wrong Time!"
					WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
						WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO joey_mission1_loop
						ENDIF

						GET_TIME_OF_DAY hours minutes
						IF hours >= 5
						AND hours < 21
							GOTO joey_mission1_loop
						ENDIF

					ENDWHILE
				ENDIF
			ENDIF
		ENDIF
	ENDIF
			
	GOTO joey_mission1_loop

}

// Joey Mission 2

joey_mission2_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_joey_mission2_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_joey_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( JM2 ) 15000 2 //"Joey Mission 2"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION joey2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO joey_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO joey_mission2_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO joey_mission2_loop

}



// Joey Mission 3

joey_mission3_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_joey_mission3_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_joey_mission3_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( JM3 ) 15000 2 //"Joey Mission 3"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION joey3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO joey_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO joey_mission3_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO joey_mission3_loop

}



// Joey Mission 4

joey_mission4_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_joey_mission4_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_joey_mission4_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( JM4 ) 15000 2 //"Joey Mission 4!"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION joey4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO joey_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO joey_mission4_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
	
	GOTO joey_mission4_loop

}


// Joey Mission 5

joey_mission5_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_joey_mission5_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_joey_mission5_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF flag_toni_mission3_passed = 1
	AND flag_frankie_mission1_passed = 0
		flag_joey_mission5_terminated = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( JM5 ) 15000 2 //"Joey Mission 5"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION joey5.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO joey_mission5_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO joey_mission5_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
	
	GOTO joey_mission5_loop

}


// Joey Mission 6

joey_mission6_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_joey_mission6_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_joey_mission6_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF flag_toni_mission3_passed = 1
	AND flag_frankie_mission1_passed = 0
		flag_joey_mission6_terminated = 1
		TERMINATE_THIS_SCRIPT
	ENDIF 

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				GET_TIME_OF_DAY hours minutes
				IF hours >= 6
				AND hours < 14
					IF CAN_PLAYER_START_MISSION Player

						MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

						SET_FADING_COLOUR 0 0 0

						DO_FADE 1500 FADE_OUT

						SWITCH_STREAMING OFF

						PRINT_BIG ( JM6 ) 15000 2 //"Joey Mission 6"

						WHILE GET_FADING_STATUS
							WAIT 0
						ENDWHILE

						LOAD_AND_LAUNCH_MISSION joey6.sc
					ENDIF

					IF NOT IS_PLAYER_PLAYING player
						GOTO joey_mission6_loop
					ENDIF

					WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
						WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO joey_mission6_loop
						ENDIF
					ENDWHILE				
				ELSE
					PRINT_NOW ( WRONGT2 ) 5000 1 //" Wrong Time!"
					WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.0 1.0 2.0 FALSE
						WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO joey_mission6_loop
						ENDIF

						GET_TIME_OF_DAY hours minutes
						IF hours >= 6
						AND hours < 14
							GOTO joey_mission6_loop
						ENDIF

					ENDWHILE
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	GOTO joey_mission6_loop

}

// ********************************************Toni Missions********************************

// Toni Mission 1

toni_mission1_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_toni_mission1_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_toni_mission1_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1219.8 -319.7 27.4 1.0 2.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( TM1 ) 15000 2 //"Toni Mission 1"	 

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION toni1.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO toni_mission1_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1219.8 -319.7 27.4 1.0 2.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO toni_mission1_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
	
	GOTO toni_mission1_loop

}


// Toni Mission 2

toni_mission2_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_toni_mission2_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_toni_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1219.8 -319.7 27.4 1.0 2.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( TM2 ) 15000 2 //"Toni Mission 2"	 

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION toni2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO toni_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1219.8 -319.7 27.4 1.0 2.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO toni_mission2_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
	
	GOTO toni_mission2_loop

}


// Toni Mission 3

toni_mission3_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_toni_mission3_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_toni_mission3_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1219.8 -319.7 27.4 1.0 2.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( TM3 ) 15000 2 //"Toni Mission 3"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION toni3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO toni_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1219.8 -319.7 27.4 1.0 2.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO toni_mission3_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
		
	GOTO toni_mission3_loop

}



// Toni Mission 4

toni_mission4_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_toni_mission4_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_toni_mission4_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF	

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1219.8 -319.7 27.4 1.0 2.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( TM4 ) 15000 2 //"Toni Mission 4"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION toni4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO toni_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1219.8 -319.7 27.4 1.0 2.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO toni_mission4_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF

	GOTO toni_mission4_loop

}

// Toni Mission 5

toni_mission5_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_toni_mission5_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_toni_mission5_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1219.8 -319.7 27.4 1.0 2.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( TM5 ) 15000 2 //"Toni Mission 5"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION toni5.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO toni_mission5_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1219.8 -319.7 27.4 1.0 2.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO toni_mission5_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
	
	GOTO toni_mission5_loop

}



// ***************************************Frankie Missions**********************************



// Frankie Mission 1

frankie_mission1_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_frankie_mission1_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_frankie_mission1_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player			   
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1455.7 -187.3 55.6 1.0 1.0 2.0 FALSE
		OR IS_PLAYER_IN_ANGLED_AREA_ON_FOOT_3D player 1466.2 -175.0 50.0 1452.9 -172.1 60.0 11.6 FALSE
			IF flag_frankie_switched_off = 0
			AND flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG FM1 15000 2 //"Pulp Friction"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION frank1.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO frankie_mission1_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1455.7 -187.3 55.6 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO frankie_mission1_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
		
	GOTO frankie_mission1_loop

}



// Frankie Mission 2

frankie_mission2_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_frankie_mission2_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_frankie_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1455.7 -187.3 55.6 1.0 1.0 2.0 FALSE
		OR IS_PLAYER_IN_ANGLED_AREA_ON_FOOT_3D player 1466.2 -175.0 50.0 1452.9 -172.1 60.0 11.6 FALSE
			IF flag_frankie_switched_off = 0
			AND flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( FM2 ) 15000 2 //"Cuttin' The Grass"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION frank2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO frankie_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1455.7 -187.3 55.6 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO frankie_mission2_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
	
	GOTO frankie_mission2_loop

}


// Frankie Mission 2.1

frankie_mission2.1_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_frankie_mission2.1_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_frankie_mission2.1_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1455.7 -187.3 55.6 1.0 1.0 2.0 FALSE
		OR IS_PLAYER_IN_ANGLED_AREA_ON_FOOT_3D player 1466.2 -175.0 50.0 1452.9 -172.1 60.0 11.6 FALSE
			IF flag_frankie_switched_off = 0
				IF flag_player_on_mission = 0
					IF CAN_PLAYER_START_MISSION Player

						MAKE_PLAYER_SAFE_FOR_CUTSCENE player

						SET_FADING_COLOUR 0 0 0

						DO_FADE 1500 FADE_OUT

						SWITCH_STREAMING OFF

						PRINT_BIG ( FM21 ) 15000 2 //"Bomb Da Base Part 1"

						WHILE GET_FADING_STATUS
							WAIT 0
						ENDWHILE

						LOAD_AND_LAUNCH_MISSION frank2.1.sc
					ENDIF

					IF NOT IS_PLAYER_PLAYING player
						GOTO frankie_mission2.1_loop
					ENDIF

					WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1455.7 -187.3 55.6 1.0 1.0 2.0 FALSE
						WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO frankie_mission2.1_loop
						ENDIF
					ENDWHILE
				ENDIF
			ELSE
				PRINT_NOW ( FRANGO ) 5000 1 //"Frankie is not available at this time!"
				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1455.7 -187.3 55.6 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO frankie_mission2.1_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
	
	GOTO frankie_mission2.1_loop

}


// Frankie Mission 3 Starts at 8balls garage

frankie_mission3_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_frankie_mission3_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_frankie_mission3_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF flag_frankie_mission3_part2_launched = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	 												
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D	player 1272.2 -92.9 13.8 1.0 1.0 2.0 FALSE
			IF flag_eightball_switched_off = 0
			AND flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( FM3 ) 15000 2 //"Bomb Da Base"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION frank3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO frankie_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 1272.2 -92.9 13.8 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO frankie_mission3_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
		
	GOTO frankie_mission3_loop

}


// Frankie Mission 4

frankie_mission4_loop:
{

WAIT mission_trigger_wait_time

IF flag_industrial_passed = 1
AND flag_frankie_mission4_passed = 0
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_frankie_mission4_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 1455.7 -187.3 55.6 1.0 1.0 2.0 FALSE
		OR IS_PLAYER_IN_ANGLED_AREA_ON_FOOT_3D player 1466.2 -175.0 50.0 1452.9 -172.1 60.0 11.6 FALSE
			IF flag_frankie_switched_off = 0
			AND flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( FM4 ) 15000 2 //"Frankie Mission 4"	 

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION frank4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO frankie_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 1455.7 -187.3 55.6 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO frankie_mission4_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
		
	GOTO frankie_mission4_loop

}


// *****************************************Diablo Missions*******************************


// Diablo Mission 1

diablo_mission1_loop:
{

WAIT mission_trigger_wait_time

IF flag_diablo_mission1_passed = 1
	TURN_PHONE_OFF diablo_phone
	TERMINATE_THIS_SCRIPT
ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON diablo_phone
	ELSE
		TURN_PHONE_OFF diablo_phone
	ENDIF
			
	IF IS_PLAYER_PLAYING player			   
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 938.4 -230.5 3.9 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF diablo_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( DIAB1 ) 15000 2 //"Diablo Mission 1"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION diablo1.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO diablo_mission1_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 938.4 -230.5 3.9 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO diablo_mission1_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO diablo_mission1_loop

}


// Diablo Mission 2

diablo_mission2_loop:
{

WAIT mission_trigger_wait_time

	IF flag_diablo_mission2_passed = 1
		TURN_PHONE_OFF diablo_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON diablo_phone
	ELSE
		TURN_PHONE_OFF diablo_phone
	ENDIF
			
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 938.4 -230.5 3.9 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF diablo_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( DIAB2 ) 15000 2 //"Diablo Mission 2"	 

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION diablo2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO diablo_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 938.4 -230.5 3.9 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO diablo_mission2_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
 	GOTO diablo_mission2_loop

}



// Diablo Mission 3

diablo_mission3_loop:
{

WAIT mission_trigger_wait_time

	IF flag_diablo_mission3_passed = 1
		TURN_PHONE_OFF diablo_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON diablo_phone
	ELSE
		TURN_PHONE_OFF diablo_phone
	ENDIF
			
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 938.4 -230.5 3.9 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF diablo_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( DIAB3 ) 15000 2 //"Diablo Mission 3"	 

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION diablo3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO diablo_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 938.4 -230.5 3.9 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO diablo_mission3_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF	

	GOTO diablo_mission3_loop

}


// Diablo Mission 4

diablo_mission4_loop:
{

WAIT mission_trigger_wait_time

	IF flag_diablo_mission4_passed = 1
		TURN_PHONE_OFF diablo_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON diablo_phone
	ELSE
		TURN_PHONE_OFF diablo_phone
	ENDIF
		
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 938.4 -230.5 3.9 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF diablo_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( DIAB4 ) 15000 2 //"Diablo Mission 4"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION diablo4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO diablo_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 938.4 -230.5 3.9 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO diablo_mission4_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF	

	GOTO diablo_mission4_loop

}


// ***************************************Commercial Level**********************************
 
// *****************************************Asuka Missions************************************
 
// Asuka Mission 1


asuka_mission1_loop:
{

WAIT mission_trigger_wait_time

	IF flag_asuka_mission1_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 523.7 -639.0 16.1 1.0 4.5 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG AM1 15000 2

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION asuka1.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO asuka_mission1_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 523.7 -639.0 16.1 1.0 4.5 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO asuka_mission1_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF

	GOTO asuka_mission1_loop

}


// Asuka Mission 2

asuka_mission2_loop:
{

WAIT mission_trigger_wait_time

	IF flag_asuka_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 523.7 -639.0 16.1 1.0 4.5 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( AM2 ) 15000 2 //"Asuka Mission 2"	 

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION asuka2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO asuka_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 523.7 -639.0 16.1 1.0 4.5 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO asuka_mission2_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF

	GOTO asuka_mission2_loop
}

 
 
// Asuka Mission 3

asuka_mission3_loop:
{

WAIT mission_trigger_wait_time

	IF flag_asuka_mission3_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 523.7 -639.0 16.1 1.0 4.5 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( AM3 ) 15000 2 //"Asuka Mission 3"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION asuka3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO asuka_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 523.7 -639.0 16.1 1.0 4.5 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO asuka_mission3_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF

	GOTO asuka_mission3_loop
}





// Asuka Mission 4

asuka_mission4_loop:
{

WAIT mission_trigger_wait_time

	IF flag_asuka_mission4_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 523.7 -639.0 16.1 1.0 4.5 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( AM4 ) 15000 2 //"Asuka Mission 4"	 

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION asuka4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO asuka_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 523.7 -639.0 16.1 1.0 4.5 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO asuka_mission4_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF

	GOTO asuka_mission4_loop
}




// Asuka Mission 5

asuka_mission5_loop:
{

WAIT mission_trigger_wait_time

IF flag_love_mission4_passed = 1
	TERMINATE_THIS_SCRIPT
ENDIF

	IF flag_asuka_mission5_passed = 1 
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 523.7 -639.0 16.1 1.0 4.5 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( AM5 ) 15000 2 //"Asuka Mission 5"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION asuka5.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO asuka_mission5_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 523.7 -639.0 16.1 1.0 4.5 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO asuka_mission5_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF

	GOTO asuka_mission5_loop
}


// ******************************************Kenji Missions*********************************

// Kenji Mission 1

kenji_mission1_loop:
{

WAIT mission_trigger_wait_time

	IF flag_kenji_mission1_passed = 1
	OR flag_love_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 459.1 -1413.0 26.1 1.5 1.5 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( KM1 ) 15000 2 //"Kanbu Bust out"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION kenji1.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO kenji_mission1_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 459.1 -1413.0 26.1 1.5 1.5 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO kenji_mission1_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF

	GOTO kenji_mission1_loop

}


// Kenji Mission 2

kenji_mission2_loop:
{

WAIT mission_trigger_wait_time

	IF flag_kenji_mission2_passed = 1
	OR flag_love_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 459.1 -1413.0 26.1 1.5 1.5 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( KM2 ) 15000 2 //"Gone in Sixty"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION kenji2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO kenji_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 459.1 -1413.0 26.1 1.5 1.5 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO kenji_mission2_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
   		
	GOTO kenji_mission2_loop

}

// Kenji Mission 3

kenji_mission3_loop:
{

WAIT mission_trigger_wait_time

	IF flag_kenji_mission3_passed = 1
	OR flag_love_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 459.1 -1413.0 26.1 1.5 1.5 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( KM3 ) 15000 2  //"Kenji Mission 3"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION kenji3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO kenji_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 459.1 -1413.0 26.1 1.5 1.5 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO kenji_mission3_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO kenji_mission3_loop

}




// Kenji Mission 4

kenji_mission4_loop:
{

WAIT mission_trigger_wait_time

	IF flag_kenji_mission4_passed = 1
	OR flag_love_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player	
		IF LOCATE_PLAYER_ON_FOOT_3D Player 459.1 -1413.0 26.1 1.5 1.5 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( KM4 ) 15000 2  //"SHIMA"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION kenji4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO kenji_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 459.1 -1413.0 26.1 1.5 1.5 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO kenji_mission4_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO kenji_mission4_loop

}



// Kenji Mission 5

kenji_mission5_loop:
{

WAIT mission_trigger_wait_time

	IF flag_kenji_mission5_passed = 1
	OR flag_love_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 459.1 -1413.0 26.1 1.5 1.5 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG KM5 15000 2 // "SMACK DOWN"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION kenji5.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO kenji_mission5_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 459.1 -1413.0 26.1 1.5 1.5 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO kenji_mission5_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF

		
	GOTO kenji_mission5_loop

}




// ******************************************Ray Missions***********************************



// Ray Mission 1

ray_mission1_loop:
{

WAIT 0

	IF flag_ray_mission1_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					rays_cutscene_flag = 1
					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG RM1 15000 2 //"Silence the sneak"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION ray1.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO ray_mission1_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO ray_mission1_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
		
	GOTO ray_mission1_loop

}



// Ray Mission 2

ray_mission2_loop:
{

WAIT 0

	IF flag_ray_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					rays_cutscene_flag = 1
					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT	//	used to be 250

					SWITCH_STREAMING OFF

					PRINT_BIG RM2 15000 2 //"Arms Shortage"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION ray2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO ray_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO ray_mission2_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
		
	GOTO ray_mission2_loop

}


// Ray Mission 3

ray_mission3_loop:
{

WAIT 0

	IF flag_ray_mission3_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					rays_cutscene_flag = 1
					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG RM3 15000 2 //"Evidence Dash"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION ray3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO ray_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO ray_mission3_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO ray_mission3_loop

}






// Ray Mission 4

ray_mission4_loop:
{

WAIT 0

	IF flag_ray_mission4_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					rays_cutscene_flag = 1
					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG RM4 15000 2 //"Gone Fishing"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION ray4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO ray_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO ray_mission4_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
      	
	GOTO ray_mission4_loop

}




// Ray Mission 5

ray_mission5_loop:
{

WAIT 0

	IF flag_ray_mission5_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					rays_cutscene_flag = 1
					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT	//	used to be 250

					SWITCH_STREAMING OFF

					PRINT_BIG RM5 15000 2 //"Plaster Blaster"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION ray5.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO ray_mission5_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO ray_mission5_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO ray_mission5_loop

}

// Ray Mission 6

ray_mission6_loop:
{																					 

WAIT 0

	IF flag_ray_mission6_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG RM6 15000 2 //"Marked Man"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION ray6.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO ray_mission6_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.2 1.2 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO ray_mission6_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO ray_mission6_loop

}


// ***************************************love Missions**********************************



// love Mission 1

love_mission1_loop:
{

WAIT mission_trigger_wait_time

	IF flag_love_mission1_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( LOVE1 ) 15000 2  //"Resue the Old Oriental Gentleman"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION love1.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO love_mission1_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO love_mission1_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF

	GOTO love_mission1_loop

}


// love Mission 2

love_mission2_loop:
{

WAIT mission_trigger_wait_time

	IF flag_love_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF

	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( LOVE2 ) 15000 2	//"Love Mission 2"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION love2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO love_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO love_mission2_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO love_mission2_loop

}


// love Mission 3

love_mission3_loop:
{

WAIT mission_trigger_wait_time

	IF flag_love_mission3_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG LOVE3 15000 2	//"love Mission 3"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION love3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO love_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO love_mission3_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO love_mission3_loop

}

// LOVE MISSION 4 AND 5 ARE IN SUBURBAIN MISSIONS AS THIS IS WHERE THEY ARE BASED 

// *****************************************Yardie Missions*********************************


// Yardie Mission 1

yardie_mission1_loop:
{

WAIT mission_trigger_wait_time


	IF flag_yardie_mission1_passed = 1
		TURN_PHONE_OFF yardie_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON yardie_phone
	ELSE
		TURN_PHONE_OFF yardie_phone
	ENDIF
				
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 120.7 -272.1 16.1 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF yardie_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( YD1 ) 15000 2 //"Yardie Mission 1"	 

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION yard1.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO yardie_mission1_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 120.7 -272.1 16.1 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO yardie_mission1_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO yardie_mission1_loop

}

// Yardie Mission 2

yardie_mission2_loop:
{

WAIT mission_trigger_wait_time


	IF flag_yardie_mission2_passed = 1
		TURN_PHONE_OFF yardie_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON yardie_phone
	ELSE
		TURN_PHONE_OFF yardie_phone
	ENDIF
				
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 120.7 -272.1 16.1 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF yardie_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( YD2 ) 15000 2 //"Yardie Mission 2"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION yard2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO yardie_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 120.7 -272.1 16.1 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO yardie_mission2_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO yardie_mission2_loop

}

// Yardie Mission 3

yardie_mission3_loop:
{

WAIT mission_trigger_wait_time


	IF flag_yardie_mission3_passed = 1
		TURN_PHONE_OFF yardie_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON yardie_phone
	ELSE
		TURN_PHONE_OFF yardie_phone
	ENDIF
				
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 120.7 -272.1 16.1 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF yardie_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( YD3 ) 15000 2 //"Yardie Mission 3"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION yard3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO yardie_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 120.7 -272.1 16.1 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO yardie_mission3_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO yardie_mission3_loop

}

// Yardie Mission 4

yardie_mission4_loop:
{

WAIT mission_trigger_wait_time


	IF flag_yardie_mission4_passed = 1
		TURN_PHONE_OFF yardie_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON yardie_phone
	ELSE
		TURN_PHONE_OFF yardie_phone
	ENDIF
				
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player 120.7 -272.1 16.1 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF yardie_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( YD4 ) 15000 2 //"Yardie Mission 4"	 

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION yard4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO yardie_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 120.7 -272.1 16.1 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO yardie_mission4_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO yardie_mission4_loop

}


// ***************************************Suburban Level************************************

// ********************************Donald Love Suburban Missions****************************

// Love Mission 4

love_mission4_loop:
{																					 

WAIT mission_trigger_wait_time

	IF flag_love_mission4_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG LOVE4 15000 2

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION love4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO love_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO love_mission4_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO love_mission4_loop

}



// Love Mission 5

love_mission5_loop:
{																					 

WAIT mission_trigger_wait_time

	IF flag_love_mission5_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG LOVE5 15000 2

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION love5.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO love_mission5_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO love_mission5_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO love_mission5_loop
									
}

// Love Mission 6

love_mission6_loop:
{																					 

WAIT mission_trigger_wait_time

	IF flag_love_mission6_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG LOVE6	15000 2

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION love6.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO love_mission6_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO love_mission6_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO love_mission6_loop

}

// Love Mission 7

love_mission7_loop:
{																					 

WAIT mission_trigger_wait_time

	IF flag_love_mission7_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0	
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG LOVE7	15000 2

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION love7.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO love_mission7_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO love_mission7_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO love_mission7_loop

}
  
// ****************************************Asuka Suburban Missions**************************


// Asuka Mission 1

asuka_suburban_mission1_loop:
{

WAIT mission_trigger_wait_time

	IF flag_asuka_suburban_mission1_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player			   
		IF LOCATE_PLAYER_ON_FOOT_3D player 367.3 -328.1 19.5 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( AS1 ) 15000 2

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION asusb1.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO asuka_suburban_mission1_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 367.3 -328.1 19.5 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO asuka_suburban_mission1_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO asuka_suburban_mission1_loop

}

// Asuka Mission 2

asuka_suburban_mission2_loop:
{

WAIT mission_trigger_wait_time

	IF flag_asuka_suburban_mission2_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D player 367.3 -328.1 19.5 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT	//	used to be 250

					SWITCH_STREAMING OFF

					PRINT_BIG ( AS2 ) 15000 2

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION asusb2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO asuka_suburban_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 367.3 -328.1 19.5 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO asuka_suburban_mission2_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO asuka_suburban_mission2_loop

}


// Asuka Mission 3

asuka_suburban_mission3_loop:
{

WAIT mission_trigger_wait_time

	IF flag_asuka_suburban_mission3_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D player 367.3 -328.1 19.5 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT	//	used to be 250

					SWITCH_STREAMING OFF

					PRINT_BIG ( AS3 ) 15000 2

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION asusb3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO asuka_suburban_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 367.3 -328.1 19.5 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO asuka_suburban_mission3_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO asuka_suburban_mission3_loop

}

// Asuka Mission 4
/*
asuka_suburban_mission4_loop:
{

WAIT mission_trigger_wait_time

	IF flag_asuka_suburban_mission4_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D player 367.3 -328.1 19.5 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0	
				IF CAN_PLAYER_START_MISSION Player

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					SWITCH_STREAMING OFF

					PRINT_BIG ( AS4 ) 15000 2

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION asusb4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO asuka_suburban_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player 367.3 -328.1 19.5 1.0 1.0 2.0 FALSE
					WAIT 0
					IF NOT IS_PLAYER_PLAYING player
						GOTO asuka_suburban_mission4_loop
					ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO asuka_suburban_mission4_loop

}
*/

// **********************************************Hood Missions******************************

// Hood Mission 1

hood_mission1_loop:
{

WAIT mission_trigger_wait_time


	IF flag_hood_mission1_passed = 1
		TURN_PHONE_OFF hood_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON hood_phone
	ELSE
		TURN_PHONE_OFF hood_phone
	ENDIF
				
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player -443.5 -6.1 3.8 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF hood_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( HM_1 ) 15000 2 //"Uzi Driver"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION hood1.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO hood_mission1_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player -443.5 -6.1 3.8 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO hood_mission1_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO hood_mission1_loop

}


// Hood Mission 2

hood_mission2_loop:
{

WAIT mission_trigger_wait_time


	IF flag_hood_mission2_passed = 1
		TURN_PHONE_OFF hood_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON hood_phone
	ELSE
		TURN_PHONE_OFF hood_phone
	ENDIF
				
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player -443.5 -6.1 3.8 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF hood_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( HM_2 ) 15000 2 //"TOYMINATOR"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION hood2.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO hood_mission2_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player -443.5 -6.1 3.8 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO hood_mission2_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO hood_mission2_loop

}

// Hood Mission 3

hood_mission3_loop:
{

WAIT mission_trigger_wait_time


	IF flag_hood_mission3_passed = 1

		IF flag_hood_mission5_passed = 0 
			TURN_PHONE_OFF hood_phone
			TERMINATE_THIS_SCRIPT
		ENDIF

	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON hood_phone
	ELSE
		TURN_PHONE_OFF hood_phone
	ENDIF
				
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player -443.5 -6.1 3.8 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF hood_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( HM_3 ) 15000 2 //"RIGGED TO BLOW"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION hood3.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO hood_mission3_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player -443.5 -6.1 3.8 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO hood_mission3_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO hood_mission3_loop

}

// Hood Mission 4

hood_mission4_loop:
{

WAIT mission_trigger_wait_time


	IF flag_hood_mission4_passed = 1
		TURN_PHONE_OFF hood_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON hood_phone
	ELSE
		TURN_PHONE_OFF hood_phone
	ENDIF
				
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player -443.5 -6.1 3.8 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF hood_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( HM_4 ) 15000 2 //"GOLD GRAB"	

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION hood4.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO hood_mission4_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player -443.5 -6.1 3.8 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO hood_mission4_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO hood_mission4_loop

}

// Hood Mission 5

hood_mission5_loop:
{

WAIT mission_trigger_wait_time


	IF flag_hood_mission5_passed = 1
		TURN_PHONE_OFF hood_phone
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF flag_player_on_mission = 0
	   TURN_PHONE_ON hood_phone
	ELSE
		TURN_PHONE_OFF hood_phone
	ENDIF
			
	IF IS_PLAYER_PLAYING player	
		IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D	player -443.5 -6.1 3.8 1.0 1.0 2.0 FALSE
			IF flag_player_on_mission = 0
				IF CAN_PLAYER_START_MISSION Player
					TURN_PHONE_OFF hood_phone

					MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

					SET_FADING_COLOUR 0 0 0

					DO_FADE 1500 FADE_OUT

					PRINT_BIG ( HM_5 ) 15000 2 //"RUMBLE BLUES"

					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE

					LOAD_AND_LAUNCH_MISSION hood5.sc
				ENDIF

				IF NOT IS_PLAYER_PLAYING player
					GOTO hood_mission5_loop
				ENDIF

				WHILE LOCATE_PLAYER_ON_FOOT_3D player -443.5 -6.1 3.8 1.0 1.0 2.0 FALSE
					WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO hood_mission5_loop
						ENDIF
				ENDWHILE
			ENDIF
		ENDIF
	ENDIF
			
	GOTO hood_mission5_loop

}


// Catalina Mission 1

cat_mission1_loop:
{

WAIT mission_trigger_wait_time

	IF flag_cat_mission1_passed = 1
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		IF LOCATE_PLAYER_ON_FOOT_3D Player -362.8 246.5 60.0 4.5 4.5 2.0 FALSE
			IF flag_player_on_mission = 0
				IF nicked_half_a_mil_before = 1
					GOTO payed_before
				ENDIF 

				IF IS_SCORE_GREATER Player 499999
					payed_before:
						IF CAN_PLAYER_START_MISSION Player

							MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

							SET_FADING_COLOUR 0 0 0

							DO_FADE 1500 FADE_OUT

							SWITCH_STREAMING OFF

							PRINT_BIG ( CAT2 ) 15000 2 //"Catalina"

							WHILE GET_FADING_STATUS
								WAIT 0
							ENDWHILE

							LOAD_AND_LAUNCH_MISSION cat1.sc
						ENDIF

						IF NOT IS_PLAYER_PLAYING player
							GOTO cat_mission1_loop
						ENDIF

						WHILE LOCATE_PLAYER_ON_FOOT_3D Player -362.8 246.5 60.0 4.5 4.5 2.0 FALSE
							WAIT 0
							IF NOT IS_PLAYER_PLAYING player
								GOTO cat_mission1_loop
							ENDIF
						ENDWHILE

				ELSE 
					PRINT_NOW ( CAT_MON ) 5000 1 //"You don't have enough money"
					WHILE LOCATE_PLAYER_ON_FOOT_3D Player -362.8 246.5 60.0 4.5 4.5 2.0 FALSE
						WAIT 0
						IF NOT IS_PLAYER_PLAYING player
							GOTO cat_mission1_loop
						ENDIF
					ENDWHILE
				ENDIF
			ENDIF
		ENDIF
	ENDIF
			
	GOTO cat_mission1_loop

}


ind_save_loop:
{
//	Should be called before main loop

	SCRIPT_NAME I_SAVE

ind_save_loop_inner:

	WAIT 250

	IF IS_PLAYER_PLAYING Player

		IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
						   
			//SAVE HOUSE BLIP
			IF created_ind_blip_before = 0 
				REMOVE_BLIP	industrail_save_blip
				ADD_SPRITE_BLIP_FOR_CONTACT_POINT 870.0 -308.2 -100.0 RADAR_SPRITE_SAVE industrail_save_blip
				CHANGE_BLIP_DISPLAY industrail_save_blip BLIP_ONLY
				created_ind_blip_before = 1
			ENDIF		
	
		//SAVE HOUSE DOOR
			IF IS_PLAYER_IN_ZONE player REDLIGH

				IF flag_eightball_mission_passed = 1
					IF flag_player_on_mission = 0
						WHILE NOT ROTATE_OBJECT playersdoor 210.0 10.0 FALSE
							WAIT 0

						ENDWHILE
					ELSE
						WHILE NOT ROTATE_OBJECT playersdoor 0.0 10.0 FALSE
							WAIT 0

						ENDWHILE
					ENDIF
				ENDIF

				//INDUSTRIAL SAVE HOUSE
				IF IS_PLAYER_PLAYING Player
					IF CAN_PLAYER_START_MISSION Player // allowing the player to jump around inside
						IF flag_player_on_mission = 0
							IF IS_PLAYER_IN_AREA_ON_FOOT_3D player 891.2 -309.7 7.7 899.3 -303.3 12.7 FALSE //REAL ONE!!!!!!!
								SET_PLAYER_CONTROL Player Off
								SET_FIXED_CAMERA_POSITION 884.56 -305.35 13.53 0.0 0.0 0.0
								POINT_CAMERA_AT_POINT 885.25 -305.85 13.0 JUMP_CUT
								
								LOAD_MISSION_AUDIO DOOR_1
								WHILE NOT HAS_MISSION_AUDIO_LOADED
									WAIT 0
								ENDWHILE
								PLAY_MISSION_AUDIO
								
								WHILE NOT ROTATE_OBJECT playersdoor 0.0 8.0 FALSE
									WAIT 0

								ENDWHILE
								
								WHILE NOT HAS_MISSION_AUDIO_FINISHED
									WAIT 0
								ENDWHILE
							
								ACTIVATE_SAVE_MENU //THE GAME SAVES/RE-LOADS HERE!!!!!
														
								WAIT 0
															
								WHILE NOT HAS_SAVE_GAME_FINISHED
									WAIT 0

								ENDWHILE

								SET_FADING_COLOUR 0 0 0
								DO_FADE 1000 FADE_OUT
								IF IS_PLAYER_PLAYING Player
									SET_PLAYER_CONTROL Player Off
								ENDIF

								WAIT 1000
								/*
								LOAD_MISSION_AUDIO DOOR_2
								WHILE NOT HAS_MISSION_AUDIO_LOADED
									WAIT 0
								ENDWHILE
								PLAY_MISSION_AUDIO
								*/
	 							WHILE NOT ROTATE_OBJECT playersdoor 210.0 10.0 FALSE
							 		WAIT 0

								ENDWHILE

								CLEAR_AREA 888.6 -308.4 -100.0 1.0 TRUE

								IF IS_PLAYER_PLAYING Player
			 		   				SET_PLAYER_COORDINATES player 888.6 -308.4 -100.0
									SET_PLAYER_HEADING player 90.0

									DO_FADE 1000 FADE_IN
									RESTORE_CAMERA_JUMPCUT
									SET_CAMERA_IN_FRONT_OF_PLAYER
								ENDIF

								WAIT 1000

								IF IS_PLAYER_PLAYING Player
									SET_PLAYER_CONTROL Player on
								ENDIF
									
							ENDIF
						ENDIF
					ENDIF //	IF CAN_PLAYER_START_MISSION Player
				ENDIF

			ENDIF // IF IS_PLAYER_IN_ZONE player REDLIGH
		ELSE	// not in industrial

			IF created_ind_blip_before = 1
				REMOVE_BLIP industrail_save_blip
				created_ind_blip_before = 0
			ENDIF

		ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
	ENDIF // IF IS_PLAYER_PLAYING Player

	GOTO ind_save_loop_inner
}


ind_restart:
{
//	Should be called before main loop

	SCRIPT_NAME I_RSTRT

ind_restart_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player

		IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL 

			ADD_HOSPITAL_RESTART 1144.3 -596.9 13.9	90.0
			ADD_POLICE_RESTART 1143.9 -675.2 -100.0	90.0
			TERMINATE_THIS_SCRIPT
		ENDIF

	ENDIF

	GOTO ind_restart_inner
}

diablo_phone_start:
{
//	Should be called in joey3 mission passed

	SCRIPT_NAME DIAB_PH

diablo_phone_start_inner:

	WAIT 10000

	IF IS_PLAYER_PLAYING Player
		IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

		// Diablo Phone
			IF flag_player_on_mission = 0

				ADD_PAGER_MESSAGE ( DIAB1_A ) 140 2 0  
				START_NEW_SCRIPT diablo_mission1_loop
				START_NEW_SCRIPT diablo_blip_loop
				TERMINATE_THIS_SCRIPT

			ENDIF
		ENDIF
	ENDIF

	GOTO diablo_phone_start_inner
}

diablo_blip_loop:
{
//	Should be called in diablo_phone_start

	SCRIPT_NAME DIAB_BP

diablo_blip_loop_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player
		IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

			IF blip_diablo_created_before = 0
				REMOVE_BLIP diablo_contact_blip
				ADD_SPRITE_BLIP_FOR_CONTACT_POINT 938.4 -230.5 -100.0 RADAR_SPRITE_EL diablo_contact_blip
				blip_diablo_created_before = 1
			ENDIF
		ELSE

			IF blip_diablo_created_before = 1
				REMOVE_BLIP	diablo_contact_blip
				blip_diablo_created_before = 0
			ENDIF

		ENDIF

	ENDIF

	GOTO diablo_blip_loop_inner
}

joeys_buggy_loop:
{
// Should be called in asuka1 mission passed

	SCRIPT_NAME JOE_BUG

joeys_buggy_loop_inner:

	WAIT 500

	IF IS_PLAYER_PLAYING Player

		IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL 

		//START JOEYS BUGGY GENERATOR AT MISTYS
	 		GET_TIME_OF_DAY hours minutes
			IF hours > 17
			AND hours < 24
				IF started_buggy_generator_before = 0
					SWITCH_CAR_GENERATOR joeys_buggy 101
					ADD_CONTINUOUS_SOUND 937.1 -275.5 8.9 SOUND_MISTYS_HOUSE_LOOP_L misty_joey_loop //misty and joey
					started_buggy_generator_before = 1
				ENDIF			
			ELSE
				IF started_buggy_generator_before = 1
					SWITCH_CAR_GENERATOR joeys_buggy 0
					REMOVE_SOUND misty_joey_loop
					started_buggy_generator_before = 0
				ENDIF
			ENDIF							
		ENDIF
	ENDIF

	GOTO joeys_buggy_loop_inner
}

toni5_flames_loop:
{
//	Should be called in toni5 mission passed

	SCRIPT_NAME TONI_FR

toni5_flames_loop_inner:

	WAIT 500

	IF IS_PLAYER_PLAYING Player
		//SWITCH OFF FLAMES AFTER TONI 5
		IF NOT IS_PLAYER_IN_ZONE Player PORT_W
			REMOVE_ALL_SCRIPT_FIRES
			TERMINATE_THIS_SCRIPT
		ENDIF
	ENDIF

	GOTO toni5_flames_loop_inner
}

blob_help_loop:
{
//	Should be called in eightball mission passed

	SCRIPT_NAME BLOB_HP

blob_help_loop_inner:

	WAIT 100

	IF IS_PLAYER_PLAYING Player
		//CONTACT BLOB HELP MESSAGE
		IF IS_PLAYER_IN_AREA_ON_FOOT_3D player 895.3 -428.0 12.0 900.3 -423.2 18.0 FALSE
			PRINT_HELP ( HELP12 ) // Tells player about contact blobs
			TERMINATE_THIS_SCRIPT
		ENDIF
	ENDIF

	GOTO blob_help_loop_inner
}

toni4_pager_loop:
{
//	Should be called in frankie2 mission passed

	SCRIPT_NAME TONI4PG

toni4_pager_loop_inner:

	WAIT 10000

	IF IS_PLAYER_PLAYING Player

		IF flag_player_on_mission = 0

			IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL 

				//ADD MESSAGE AFTER FRANKIE 2 IS PASSED AND TONI 4 IS NOT COMPLETED
				IF flag_toni_mission4_passed = 0
					ADD_PAGER_MESSAGE ( TONI_P ) 140 2 0
				ENDIF

				START_NEW_SCRIPT toni5_pager_loop
				TERMINATE_THIS_SCRIPT

			ENDIF

		ENDIF
	ENDIF

	GOTO toni4_pager_loop_inner
}

toni5_pager_loop:
{
//	Should be called in toni4_pager_loop

	SCRIPT_NAME TONI5PG

toni5_pager_loop_inner:

	WAIT 10000

	IF IS_PLAYER_PLAYING Player

		IF flag_player_on_mission = 0

			IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL 

				//ADD MESSAGE AFTER FRANKIE 2 IS PASSED AND TONI 5 IS NOT COMPLETED
				IF flag_toni_mission4_passed = 1

					IF flag_toni_mission5_passed = 0
						ADD_PAGER_MESSAGE ( TONI_P ) 140 2 0
					ENDIF

					TERMINATE_THIS_SCRIPT

				ENDIF
			ENDIF

		ENDIF
	ENDIF

	GOTO toni5_pager_loop_inner
}

close_fuzz_doors:
{
// Should be called in cleanup for luigi5

	SCRIPT_NAME FUZZ_DR

	WHILE flag_moved_door1_lm5 = 0
	OR flag_moved_door2_lm5 = 0

		WAIT 0
		   
  		IF counter_girls_trying_to_get_to_ball = 0
				
			IF NOT IS_AREA_OCCUPIED 1008.0 -899.0 14.0 996.5 -886.5 20.0 FALSE TRUE TRUE FALSE TRUE

				IF ROTATE_OBJECT fuzz_door1 180.0 10.0 FALSE
					flag_moved_door1_lm5 = 1
				ENDIF	
		
				IF ROTATE_OBJECT fuzz_door2 0.0 10.0 FALSE
					flag_moved_door2_lm5 = 1
				ENDIF

			ENDIF

		ENDIF

	ENDWHILE

	TERMINATE_THIS_SCRIPT
}


com_save_loop:
{
// Should be called before main loop

	SCRIPT_NAME C_SAVE

com_save_loop_inner:

	WAIT 250

	IF IS_PLAYER_PLAYING Player
		IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
		 
			//SAVE HOUSE BLIP
			IF created_com_blip_before = 0
				REMOVE_BLIP	commercial_save_blip
				ADD_SPRITE_BLIP_FOR_CONTACT_POINT 103.3 -469.2 -100.0 RADAR_SPRITE_SAVE commercial_save_blip
				CHANGE_BLIP_DISPLAY commercial_save_blip BLIP_ONLY
				created_com_blip_before = 1
			ENDIF

			//SAVE HOUSE DOORS
			IF IS_PLAYER_IN_ZONE player PARK 

				IF flag_player_on_mission = 0
					WHILE NOT SLIDE_OBJECT plysav_lftdr_lft 105.35 -482.8 16.25 0.1 0.0 0.0 FALSE
					OR NOT SLIDE_OBJECT plysav_lftdr_rght 100.692 -482.8 16.25 0.1 0.0 0.0 FALSE
						WAIT 0

					ENDWHILE

				ELSE
					WHILE NOT SLIDE_OBJECT plysav_lftdr_lft 103.85 -482.8 16.25 0.1 0.0 0.0 FALSE
					OR NOT SLIDE_OBJECT plysav_lftdr_rght 102.192 -482.8 16.25 0.1 0.0 0.0 FALSE
						WAIT 0

					ENDWHILE
				ENDIF

				//COMMERCIAL SAVE HOUSE
				IF IS_PLAYER_PLAYING Player
					IF CAN_PLAYER_START_MISSION Player
						IF flag_player_on_mission = 0
							IF IS_PLAYER_IN_AREA_ON_FOOT_3D player 105.7 -486.0 15.0 100.8 -483.4 18.0 FALSE
								SET_PLAYER_CONTROL Player Off
								SET_FIXED_CAMERA_POSITION 98.53 -472.06 19.84 0.0 0.0 0.0
								POINT_CAMERA_AT_POINT 98.94 -472.90 19.47 JUMP_CUT

								LOAD_MISSION_AUDIO DOOR_3
								WHILE NOT HAS_MISSION_AUDIO_LOADED
									WAIT 0
								ENDWHILE
								PLAY_MISSION_AUDIO

								WHILE NOT SLIDE_OBJECT plysav_lftdr_lft 103.85 -482.8 16.25 0.0625 0.0 0.0 FALSE
								OR NOT SLIDE_OBJECT plysav_lftdr_rght 102.192 -482.8 16.25 0.0625 0.0 0.0 FALSE
									WAIT 0

								ENDWHILE

								WHILE NOT HAS_MISSION_AUDIO_FINISHED
									WAIT 0
								ENDWHILE

								ACTIVATE_SAVE_MENU //THE GAME SAVES/RE-LOADS HERE!!!!!

								WAIT 0
									
								WHILE NOT HAS_SAVE_GAME_FINISHED
									WAIT 0

								ENDWHILE

								SET_FADING_COLOUR 0 0 0
								DO_FADE 1000 FADE_OUT
				 				IF IS_PLAYER_PLAYING Player
									SET_PLAYER_CONTROL Player OFF
								ENDIF

								WAIT 1000
								/*
								LOAD_MISSION_AUDIO DOOR_4
								WHILE NOT HAS_MISSION_AUDIO_LOADED
									WAIT 0
								ENDWHILE
								PLAY_MISSION_AUDIO
								*/
								WHILE NOT SLIDE_OBJECT plysav_lftdr_lft 105.35 -482.8 16.25 0.1 0.0 0.0 FALSE
								OR NOT SLIDE_OBJECT plysav_lftdr_rght 100.692 -482.8 16.25 0.1 0.0 0.0 FALSE
									WAIT 0

								ENDWHILE
								
								CLEAR_AREA 103.0 -478.5 14.9 1.0 TRUE

								IF IS_PLAYER_PLAYING Player
					 		   		SET_PLAYER_COORDINATES player 103.0 -478.5 14.9
									SET_PLAYER_HEADING player 0.0

									DO_FADE 1000 FADE_IN
									RESTORE_CAMERA_JUMPCUT
									SET_CAMERA_IN_FRONT_OF_PLAYER
								ENDIF

								WAIT 1000

								IF IS_PLAYER_PLAYING Player
									SET_PLAYER_CONTROL Player on
								ENDIF
										
							ENDIF
						ENDIF
					ENDIF	//	IF CAN_PLAYER_START_MISSION Player
				ENDIF

			ENDIF // IF IS_PLAYER_IN_ZONE player PARK
		ELSE	// not in commercial

			IF created_com_blip_before = 1
				REMOVE_BLIP commercial_save_blip
				created_com_blip_before = 0
			ENDIF

		ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
	ENDIF // IF IS_PLAYER_PLAYING Player

	GOTO com_save_loop_inner
}

com_restart:
{
// Should be called before main loop

	SCRIPT_NAME C_RSTRT

com_restart_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player
		IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
		 
			IF flag_industrial_passed = 1
				ADD_HOSPITAL_RESTART 183.5 -17.8 16.2 180.0
				ADD_POLICE_RESTART 340.3 -1123.4 25.0 180.0
				SET_MAX_WANTED_LEVEL 5
				TERMINATE_THIS_SCRIPT
			ENDIF
		ENDIF
	ENDIF

	GOTO com_restart_inner
}


yardie_phone_start:
{
//	Should be called in asuka1 mission passed

	SCRIPT_NAME YARD_PH

yardie_phone_start_inner:

	WAIT 10000

	IF IS_PLAYER_PLAYING Player
		IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
			
			// Yardie Phone
			IF flag_player_on_mission = 0 

				ADD_PAGER_MESSAGE ( YD_P ) 140 2 0	 
				START_NEW_SCRIPT yardie_mission1_loop
				START_NEW_SCRIPT yardie_blip_loop
				TERMINATE_THIS_SCRIPT

			ENDIF	
		ENDIF //IS_PLAYER_IN_ZONE
	ENDIF //IS PLAYER PLAYING

	GOTO yardie_phone_start_inner
}

yardie_blip_loop:
{
//	Should be called in yardie_phone_start

	SCRIPT_NAME YARD_BP

yardie_blip_loop_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player
		IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL

			IF flag_yardie_mission4_passed = 1
				TERMINATE_THIS_SCRIPT
			ENDIF

			IF blip_yardie_created_before = 0
				REMOVE_BLIP	yardie_contact_blip
				ADD_SPRITE_BLIP_FOR_CONTACT_POINT 120.7 -272.1 16.1 RADAR_SPRITE_LIZ yardie_contact_blip
				//FLASH_RADAR_BLIP yardie_contact_blip
				blip_yardie_created_before = 1
			ENDIF
		ELSE

//			IF flag_yardie_mission4_passed = 0
				IF blip_yardie_created_before = 1
					REMOVE_BLIP	yardie_contact_blip
					blip_yardie_created_before = 0
				ENDIF
//			ENDIF

		ENDIF
	ENDIF

	GOTO yardie_blip_loop_inner
}

close_asuka1_door:
{
// Should be called in cleanup for asuka1

	SCRIPT_NAME ASUK_DR

	IF DOES_OBJECT_EXIST backdoor
		GET_OBJECT_HEADING backdoor door_position_a1
		IF door_crash_flag = 1
			WHILE NOT door_position_a1 = 0.0
				
				IF IS_PLAYER_PLAYING player
					IF NOT IS_PLAYER_IN_AREA_3D player 889.618 -418.098 15.0 895.151 -412.675 18.0 0
					//IF NOT IS_PLAYER_IN_AREA_3D player 893.494 -417.093 14.943 894.934 -413.657 17.916 0
						IF door_position_a1 > -10.0
						AND door_position_a1 < 10.0
							door_position_a1 = 0.0
						ELSE
							door_position_a1 -= 10.0
						ENDIF
						SET_OBJECT_HEADING backdoor door_position_a1
					ENDIF
				ELSE
					door_position_a1 = 0.0
					SET_OBJECT_HEADING backdoor door_position_a1
				ENDIF

				WAIT 0
			ENDWHILE
		ENDIF
	ENDIF

	TERMINATE_THIS_SCRIPT
}



sub_save_loop:
{
//	Should be called before main loop

	SCRIPT_NAME S_SAVE

sub_save_loop_inner:

	WAIT 250

	IF IS_PLAYER_PLAYING Player
		IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	
			//SAVE HOUSE BLIP
			IF created_sub_blip_before = 0
				REMOVE_BLIP	suburban_save_blip
				ADD_SPRITE_BLIP_FOR_CONTACT_POINT -665.0 -6.5 -100.0 RADAR_SPRITE_SAVE suburban_save_blip
				CHANGE_BLIP_DISPLAY suburban_save_blip BLIP_ONLY
				created_sub_blip_before = 1
			ENDIF

			//SAVE HOUSE DOOR
			IF IS_PLAYER_IN_ZONE player PROJECT

				IF flag_player_on_mission = 0
					WHILE NOT ROTATE_OBJECT newtowerdoor1 250.0 10.0 FALSE
						WAIT 0

					ENDWHILE
				ELSE
					WHILE NOT ROTATE_OBJECT newtowerdoor1 180.0 10.0 FALSE
						WAIT 0

					ENDWHILE
				ENDIF

				//SUBURBAN SAVE HOUSE
				IF IS_PLAYER_PLAYING Player
					IF CAN_PLAYER_START_MISSION Player
						IF flag_player_on_mission = 0	
							IF IS_PLAYER_IN_AREA_ON_FOOT_3D player -670.5 3.9 18.0 -660.0 12.7 22.0 FALSE
									SET_PLAYER_CONTROL Player Off
									SET_FIXED_CAMERA_POSITION -678.15 -6.46 24.49 0.0 0.0 0.0
									POINT_CAMERA_AT_POINT -677.39 -5.92 24.11 JUMP_CUT
									/*
									LOAD_MISSION_AUDIO DOOR_5
									WHILE NOT HAS_MISSION_AUDIO_LOADED
										WAIT 0
									ENDWHILE
									PLAY_MISSION_AUDIO
									*/
									WHILE NOT ROTATE_OBJECT newtowerdoor1 180.0 8.0 FALSE
										WAIT 0

									ENDWHILE
									/*
									WHILE NOT HAS_MISSION_AUDIO_FINISHED
										WAIT 0

									ENDWHILE
									*/
									ACTIVATE_SAVE_MENU //THE GAME SAVES/RE-LOADS HERE!!!!!
											
									WAIT 0
																
									WHILE NOT HAS_SAVE_GAME_FINISHED
										WAIT 0

									ENDWHILE

									SET_FADING_COLOUR 0 0 0
									DO_FADE 1000 FADE_OUT
					 				IF IS_PLAYER_PLAYING Player
										SET_PLAYER_CONTROL Player Off
									ENDIF

									WAIT 1000
									/*
									LOAD_MISSION_AUDIO DOOR_6
									WHILE NOT HAS_MISSION_AUDIO_LOADED
										WAIT 0
									ENDWHILE
									PLAY_MISSION_AUDIO
									*/
									WHILE NOT ROTATE_OBJECT newtowerdoor1 250.0 10.0 FALSE
										WAIT 0

									ENDWHILE

									CLEAR_AREA -666.8 -1.8 -100.0 1.0 TRUE

									IF IS_PLAYER_PLAYING Player
						 		   		SET_PLAYER_COORDINATES player -666.8 -1.8 -100.0
										SET_PLAYER_HEADING player 180.0

										DO_FADE 1000 FADE_IN
										RESTORE_CAMERA_JUMPCUT
										SET_CAMERA_IN_FRONT_OF_PLAYER
									ENDIF

									WAIT 1000
									
								IF IS_PLAYER_PLAYING Player
									SET_PLAYER_CONTROL Player on
								ENDIF
										
							ENDIF
						ENDIF
					ENDIF	//	IF CAN_PLAYER_START_MISSION Player
				ENDIF

			ENDIF // IF IS_PLAYER_IN_ZONE player PROJECT
		ELSE //	not in suburban

			IF created_sub_blip_before = 1
				REMOVE_BLIP	suburban_save_blip
				created_sub_blip_before = 0
			ENDIF

		ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	ENDIF // IF IS_PLAYER_PLAYING Player

	GOTO sub_save_loop_inner
}

sub_restart:
{
//	Should be called before main loop

	SCRIPT_NAME S_RSTRT

sub_restart_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player
		IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	
			IF flag_commercial_passed = 1 
				ADD_HOSPITAL_RESTART -1253.0 -138.2 57.8 90.0
				ADD_POLICE_RESTART -1259.5 -44.5 57.8 90.0
				SET_MAX_WANTED_LEVEL 6
				TERMINATE_THIS_SCRIPT
			ENDIF
		ENDIF
	ENDIF

	GOTO sub_restart_inner
}


hood_phone_start:
{
//	Should be called in love3 mission passed

	SCRIPT_NAME HOOD_PH

hood_phone_start_inner:

	WAIT 10000

	IF IS_PLAYER_PLAYING Player
		IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN

			// Hood Phone
			IF flag_player_on_mission = 0 

				ADD_PAGER_MESSAGE ( HOOD1_A ) 140 2 0 
				START_NEW_SCRIPT hood_mission1_loop
				START_NEW_SCRIPT hood_blip_loop
				TERMINATE_THIS_SCRIPT

			ENDIF	
		ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	ENDIF // IF IS_PLAYER_PLAYING Player

	GOTO hood_phone_start_inner
}

hood_blip_loop:
{
//	Should be called in hood_phone_start

	SCRIPT_NAME HOOD_BP

hood_blip_loop_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player
		IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN

			IF flag_hood_mission5_passed = 1
				TERMINATE_THIS_SCRIPT
			ENDIF

			IF flag_blip_hood_created = 0
				REMOVE_BLIP	hood_contact_blip
				ADD_SPRITE_BLIP_FOR_CONTACT_POINT -443.5 -6.1 3.8 RADAR_SPRITE_ICE hood_contact_blip
				flag_blip_hood_created = 1
			ENDIF
		ELSE

			IF flag_blip_hood_created = 1
				REMOVE_BLIP	hood_contact_blip
				flag_blip_hood_created = 0
			ENDIF

		ENDIF //IS_PLAYER_IN_ZONE
	ENDIF //IS PLAYER PLAYING

	GOTO hood_blip_loop_inner
}


luigi_message:

// Called after Luigis Girls passed
{

	SCRIPT_NAME Luihelp

	WAIT 1000

	IF IS_PLAYER_PLAYING player

		IF flag_had_luigi_help_message = 0

			IF flag_luigi_mission1_passed = 1
				PRINT_HELP ( NEW_H2 ) //"To look around, swipe your finger on the center of the screen."
				flag_had_luigi_help_message = 1
			ENDIF

		ENDIF

		IF flag_had_luigi_help_message = 1
			timera = 0
			flag_had_luigi_help_message = 2
		ENDIF

		WHILE timera < 6000

			WAIT 0

		ENDWHILE
		
		IF flag_had_luigi_help_message = 2

			IF flag_player_on_mission = 0
				PRINT_HELP ( LM1_8 ) //"Work for Luigi or piss about!"
				flag_had_luigi_help_message = 3
			ENDIF
				
		ENDIF

		IF flag_had_luigi_help_message = 3
			timera = 0
			flag_had_luigi_help_message = 4
		ENDIF		

		WHILE timera < 6000
			WAIT 0
		ENDWHILE

		IF flag_had_luigi_help_message = 4
			IF flag_player_on_mission = 0
				PRINT_HELP ( LM1_8A ) //"To earn some extra cash, why not 'borrow' a taxi..."  
				flag_had_luigi_help_message = 5
			ENDIF
		ENDIF		
		

	ENDIF

	TERMINATE_THIS_SCRIPT
	
}


pistol_message:

// Called after Luigis 4 or Joey 2 is passed
{

	SCRIPT_NAME pistol1

	pistol_create:

	WAIT 10000

	IF IS_PLAYER_PLAYING player

		IF flag_player_on_mission = 0

			IF out_of_stock_pistol = 0
				REMOVE_PICKUP SHOP_COLT45 
				CREATE_PICKUP WEAPON_COLT45 PICKUP_IN_SHOP 1068.5 -400.8 15.2 SHOP_COLT45_2	//AMMU NATION
   				ADD_PAGER_MESSAGE ( COLT_IN ) 140 2 0
   				out_of_stock_pistol = 1
			ENDIF

		ENDIF

	ENDIF

	IF out_of_stock_pistol = 1 
		TERMINATE_THIS_SCRIPT
	ENDIF

	GOTO pistol_create	
}



uzi_message:

// Called after Joey 4
{

	SCRIPT_NAME uzi1

	uzi_create:

	WAIT 5000

	IF IS_PLAYER_PLAYING player

		IF flag_player_on_mission = 0

			IF out_of_stock_uzi = 0
				ADD_PAGER_MESSAGE ( UZI_IN ) 140 2 0
   				out_of_stock_uzi = 1
			ENDIF

		ENDIF

	ENDIF

	IF out_of_stock_uzi = 1 
		TERMINATE_THIS_SCRIPT
	ENDIF
	
	GOTO uzi_create
}

imp_exp_pager:
{
//To be played after Pulp Friction

	WAIT 100000

	IF flag_player_on_mission = 0
		IF IS_PLAYER_PLAYING Player
			ADD_PAGER_MESSAGE IMPEXPP 140 2 0
			TERMINATE_THIS_SCRIPT
		ENDIF
	ENDIF

	GOTO imp_exp_pager
}

emergency_crane_pager:
{
//To be played after Bomb Da Base

	WAIT 200000

	IF flag_player_on_mission = 0
		IF IS_PLAYER_PLAYING Player
			ADD_PAGER_MESSAGE EMVHPUP 140 2 0
			TERMINATE_THIS_SCRIPT
		ENDIF
	ENDIF

	GOTO emergency_crane_pager
}

van_heist_garage_pager:
{
//To be played after Van Heist

	WAIT 300000

	IF flag_player_on_mission = 0
		IF IS_PLAYER_PLAYING Player
			ADD_PAGER_MESSAGE VANHSTP 140 2 0
			TERMINATE_THIS_SCRIPT
		ENDIF
	ENDIF

	GOTO van_heist_garage_pager
}

car_generators:

// *************************************INDUSTRIAL CAR GENERATORS***************************
VAR_INT gen_car1  gen_car2  gen_car3  gen_car4  gen_car5  gen_car6  gen_car8  gen_car9  gen_car10
VAR_INT gen_car11 gen_car12 gen_car13 gen_car14 gen_car15 gen_car16 gen_car17 gen_car18 gen_car19 gen_car20
VAR_INT gen_car21 gen_car22 gen_car23 gen_car24 gen_car25 gen_car26 gen_car28 gen_car29 gen_car30
VAR_INT gen_car31 gen_car32 gen_car33 gen_car34 gen_car35 gen_car36 gen_car37 gen_car38 gen_car39 gen_car40
VAR_INT gen_car41 gen_car42 gen_car43 gen_car44 gen_car45 gen_car46 gen_car47 gen_car48 gen_car49 gen_car50
VAR_INT gen_car51 gen_car52 gen_car53 gen_car54 gen_car55 gen_car56 gen_car57 gen_car58 gen_car59 gen_car60
VAR_INT gen_car61 gen_car62 gen_car63 gen_car64 gen_car66



VAR_INT joeys_buggy, swank_taxi //SPECIALS


// GS-SC: Additions to the used car dealership in the north of Portland

VAR_INT ud_car1 ud_car2 ud_car3 ud_car4 ud_car5 ud_car6 ud_car7 ud_car8


//CREATE_CAR_GENERATOR X Y Z Heading Model Remap1 Remap2 ParkedFlag ChanceOfCarAlarm ChanceOfLocked MinDelay MaxDelay CarGenID

//PORTLAND VIEW
CREATE_CAR_GENERATOR 1140.7 -630.2 -100.0 0.0 CAR_AMBULANCE -1 -1 0 0 30 0 10000 gen_car1 //At hospital
SWITCH_CAR_GENERATOR gen_car1 101

CREATE_CAR_GENERATOR 1139.0 -646.0 -100.0 90.0 CAR_POLICE -1 -1 0 0 60 0 10000 gen_car2 //At police station
SWITCH_CAR_GENERATOR gen_car2 101

CREATE_CAR_GENERATOR 1139.7 -684.7 -100.0 270.0 CAR_POLICE -1 -1 0 0 70 0 10000 gen_car3 //At police station
SWITCH_CAR_GENERATOR gen_car3 101 
	 
CREATE_CAR_GENERATOR 1284.3 -620.5 11.7 0.0 CAR_IDAHO -1 -1 0 40 0 0 10000 gen_car4 //Supa save car park
SWITCH_CAR_GENERATOR gen_car4 101

CREATE_CAR_GENERATOR 1299.0 -641.8 11.7 0.0 CAR_PATRIOT -1 -1 0 40 0 0 10000 gen_car5 //Supa save car park
SWITCH_CAR_GENERATOR gen_car5 101 

CREATE_CAR_GENERATOR 1265.9 -620.8 11.7 180.0 CAR_BOBCAT -1 -1 0 40 0 0 10000 gen_car6 //Supa save car park
SWITCH_CAR_GENERATOR gen_car6 101

//CREATE_CAR_GENERATOR 1378.4 -607.2 -100.0 180.0 CAR_PONY -1 -1 0 0 0 0 10000 gen_car65 //Behind Supa save car park


//SAINT MARKS
CREATE_CAR_GENERATOR 1208.67 -258.26 24.5 270.0	CAR_MOONBEAM -1 -1 0 90 0 0 10000 gen_car9 //Little Italy garages up from Tonis
SWITCH_CAR_GENERATOR gen_car9 101

CREATE_CAR_GENERATOR 1347.04 -448.44 49.5 0.0 CAR_BOBCAT -1 -1 0 60 0 0 10000 gen_car10	//Bistro car park
SWITCH_CAR_GENERATOR gen_car10 101

CREATE_CAR_GENERATOR 1336.0 -452.19 49.3 270.0 CAR_SENTINEL -1 -1 0 90 0 0 10000 gen_car11 //Bistro car park
SWITCH_CAR_GENERATOR gen_car11 101

CREATE_CAR_GENERATOR 1223.13 -325.3 25.6 180.0 CAR_KURUMA  -1 -1 0 10 0 0 10000 gen_car12 //Tonis car park
SWITCH_CAR_GENERATOR gen_car12 101

CREATE_CAR_GENERATOR 1285.4  -306.18 39.4 270.0	CAR_MAFIA -1 -1 0 90 0 0 10000 gen_car13	//Behind tonis retaurant
SWITCH_CAR_GENERATOR gen_car13 101

CREATE_CAR_GENERATOR 1285.38 -318.56 39.4 90.0 CAR_IDAHO -1 -1 0 40 0 0 10000 gen_car14 //Behind tonis retaurant
SWITCH_CAR_GENERATOR gen_car14 101

CREATE_CAR_GENERATOR 1142.14 -95.59 7.0 180.0 CAR_BOBCAT -1 -1 0 50 0 0 10000 gen_car15	 //Petrol station car park
SWITCH_CAR_GENERATOR gen_car15 101

CREATE_CAR_GENERATOR 1147.35 -95.49 7.0 0.0 CAR_ESPERANTO -1 -1 0 50 0 0 10000 gen_car16 //Petrol station car park
SWITCH_CAR_GENERATOR gen_car16 101

CREATE_CAR_GENERATOR 1233.1 -127.2 15.0 38.0 CAR_BANSHEE -1 -1 0 0 0 0 10000 gen_car17 //Swank car in showroom
SWITCH_CAR_GENERATOR gen_car17 101

CREATE_CAR_GENERATOR 1338.13 -257.11 49.3 270.0	CAR_TAXI -1 -1 0 0 0 0 10000 gen_car18	//Park north east little italy
SWITCH_CAR_GENERATOR gen_car18 101

CREATE_CAR_GENERATOR 1407.6 -176.1 -100.0 140.0	CAR_MAFIA -1 -1 0 0 0 0 10000 gen_car57	//Park north east little italy
SWITCH_CAR_GENERATOR gen_car57 101

CREATE_CAR_GENERATOR 1405.0 -163.4 -100.0 280.0	CAR_MAFIA -1 -1 0 0 0 0 10000 gen_car58	//Park north east little italy
SWITCH_CAR_GENERATOR gen_car58 101

//HARWOOD

CREATE_CAR_GENERATOR 1212.3 -66.1 10.7 0.0 CAR_BLISTA -1 -1 0 100 0 0 10000 ud_car1 //Blista Used lot
SWITCH_CAR_GENERATOR ud_car1 101

CREATE_CAR_GENERATOR 1241.1 -97.7 13.8 180.0 CAR_RUMPO -1 -1 0 60 0 0 10000 ud_car2 //Used car lot
SWITCH_CAR_GENERATOR ud_car2 101

CREATE_CAR_GENERATOR 1243.3 -116.7 14.9 270.0 CAR_ESPERANTO -1 -1 0 60 0 0 10000 ud_car3 //Used car lot
SWITCH_CAR_GENERATOR ud_car3 101

CREATE_CAR_GENERATOR 1215.3 -128.7 15.0 45.0 CAR_PATRIOT -1 -1 0 60 0 0 10000 ud_car4 //Used car lot
SWITCH_CAR_GENERATOR ud_car4 101

CREATE_CAR_GENERATOR 1217.3 -128.7 15.0 235.0 CAR_BLISTA -1 -1 0 60 0 0 10000 ud_car5 //Used car lot
SWITCH_CAR_GENERATOR ud_car5 101

//CREATE_CAR_GENERATOR 1231.4.3 -128.7 15.0 75.0 CAR_STALLION -1 -1 0 60 0 0 10000 ud_car6 //Used car lot
//SWITCH_CAR_GENERATOR ud_car6 101

CREATE_CAR_GENERATOR 1220.3 -166.7 15.0 180.0 CAR_BOBCAT -1 -1 0 60 0 0 10000 ud_car7 //Used car lot
SWITCH_CAR_GENERATOR ud_car7 101

CREATE_CAR_GENERATOR 1209.3 -89.6 13.0 90.0 CAR_PERENNIAL -1 -1 0 60 0 0 10000 ud_car8 //Used car lot
SWITCH_CAR_GENERATOR ud_car8 101

CREATE_CAR_GENERATOR 1210.0 -70.0 14.9 0.0 CAR_BOBCAT -1 -1 0 60 0 0 10000 gen_car19 //Used car lot
SWITCH_CAR_GENERATOR gen_car19 101

CREATE_CAR_GENERATOR 1234.0 -97.0 14.9 0.0 CAR_PERENNIAL -1 -1 0 60 0 0 10000 gen_car20 //Used car lot
SWITCH_CAR_GENERATOR gen_car20 101

CREATE_CAR_GENERATOR 1226.7 -68.0 14.9 0.0 CAR_KURUMA -1 -1 0 0 0 0 10000 gen_car22 //Used car lot
SWITCH_CAR_GENERATOR gen_car22 101

CREATE_CAR_GENERATOR 1107.5 -58.0 -100.0 270.0 CAR_FIRETRUCK -1 -1 0 0 0 0 10000 gen_car21 //AT fire station
SWITCH_CAR_GENERATOR gen_car21 101


CREATE_CAR_GENERATOR 973.3 -55.1 -100.0 270.0 CAR_MOONBEAM -1 -1 0 40 0 0 10000 gen_car24 //Car park near radio station
SWITCH_CAR_GENERATOR gen_car24 101

CREATE_CAR_GENERATOR 982.15 -36.61 -100.0 90.0 CAR_KURUMA -1 -1 0 90 0 0 10000 gen_car25 //Car park near radio station
SWITCH_CAR_GENERATOR gen_car25 101

CREATE_CAR_GENERATOR 1263.5 -69.5 -100.0 270.0 CAR_RUMPO -1 -1 0 0 0 0 10000 gen_car59 //By 8Balls garage 
SWITCH_CAR_GENERATOR gen_car59 101

//HEPBURN HEIGHTS
CREATE_CAR_GENERATOR 986.2 -146.3 4.5 270.0 CAR_STALLION -1 -1 0 10 0 0 10000 gen_car23 //Tower block carpark North east
SWITCH_CAR_GENERATOR gen_car23 101

//CHINATOWN

CREATE_CAR_GENERATOR 1027.5 -873.1 14.5 270.0 CAR_IDAHO -1 -1 0 40 0 0 10000 gen_car28 //Fuzzball car park
SWITCH_CAR_GENERATOR gen_car28 0

CREATE_CAR_GENERATOR 1006.18 -838.49 14.5 90.0 CAR_ESPERANTO -1 -1 0 50 0 0 10000 gen_car29 //Fuzzball car park
SWITCH_CAR_GENERATOR gen_car29 0

CREATE_CAR_GENERATOR 857.1 -790.19 14.5 0.0 CAR_PONY -1 -1 0 90 0 0 10000 gen_car30 //South west Chinatown (down alleyway that leads to roof)
SWITCH_CAR_GENERATOR gen_car30 101

CREATE_CAR_GENERATOR 866.9 -663.7 -100.0 270.0 CAR_MRWONGS -1 -1 0 100 0 0 10000 gen_car31 //Back of laundrette 
SWITCH_CAR_GENERATOR gen_car31 101

CREATE_CAR_GENERATOR 861.9 -546.0 -100.0 177.0 CAR_BELLYUP -1 -1 0 0 0 0 10000 gen_car53 //Fish warehouses
SWITCH_CAR_GENERATOR gen_car53 101

//TRENTON
//CREATE_CAR_GENERATOR 1119.0 -763.0 -100.0 0.0 CAR_MANANA -1 -1 0 10 0 0 10000 gen_car7 //Just south of the police station
//SWITCH_CAR_GENERATOR gen_car7 101

CREATE_CAR_GENERATOR 1119.04 -770.45 14.3 180.0 CAR_PERENNIAL -1 -1 0 10 0 0 10000 gen_car8 //Just south of the police station
SWITCH_CAR_GENERATOR gen_car8 101

CREATE_CAR_GENERATOR 1102.84 -983.51 14.6 270.0 CAR_RUMPO -1 -1 0 90 0 0 10000 gen_car32 // South west trenton (nect to the sawmill)  
SWITCH_CAR_GENERATOR gen_car32 101

CREATE_CAR_GENERATOR 1103.05 -976.43 14.6 270.0 CAR_MULE -1 -1 0 0 0 0 10000 gen_car33	// South west trenton (nect to the sawmill)
//SWITCH_CAR_GENERATOR gen_car33 101

CREATE_CAR_GENERATOR 1242.9 -730.5 14.8 311.0 CAR_CABBIE -1 -1 0 0 0 0 10000 gen_car34 //At Taxi depot
SWITCH_CAR_GENERATOR gen_car34 101

//CREATE_CAR_GENERATOR 1244.4 -732.2 14.8 135.0 CAR_TAXI -1 -1 0 0 0 0 10000 gen_car35 //At Taxi depot
//SWITCH_CAR_GENERATOR gen_car35 101

CREATE_CAR_GENERATOR 1220.9 -899.0 -100.0 177.4 CAR_STALLION -1 -1 0 80 0 0 10000 gen_car36 //Next to Joeys (AMco car park)
SWITCH_CAR_GENERATOR gen_car36 101

CREATE_CAR_GENERATOR 1226.4 -882.1 -100.0 314.9 CAR_PONY -1 -1 0 10 0 0 10000 gen_car37 //Next to Joeys (AMco car park)
SWITCH_CAR_GENERATOR gen_car37 101

CREATE_CAR_GENERATOR 1277.5 -990.0 14.2 225.0 CAR_COACH -1 -1 0 100 0 0 10000 gen_car38 //At bus Depot
SWITCH_CAR_GENERATOR gen_car38 101

//CREATE_CAR_GENERATOR 1256.6 -992.3 14.2 45.0 CAR_COACH -1 -1 0 100 0 0 10000 gen_car39 //At bus Depot
//SWITCH_CAR_GENERATOR gen_car39 101

CREATE_CAR_GENERATOR 1278.0 -973.3 14.2 45.0 CAR_COACH -1 -1 0 100 0 0 10000 gen_car40 //At bus Depot
SWITCH_CAR_GENERATOR gen_car40 101	


//PORTLAND HARBOUR (DOCKS)
CREATE_CAR_GENERATOR 1427.01 -786.75 -100.0 90.0 CAR_PERENNIAL -1 -1 0 0 0 0 10000 gen_car41 //Docks car park
SWITCH_CAR_GENERATOR gen_car41 101

CREATE_CAR_GENERATOR 1407.59 -791.2 -100.0 270.0 CAR_MULE -1 -1 0 20 0 0 10000 gen_car42 //Docks car park
SWITCH_CAR_GENERATOR gen_car42 101

CREATE_CAR_GENERATOR 1427.43 -799.69 -100.0 270.0 CAR_KURUMA -1 -1 0 90 0 0 10000 gen_car43 //Docks car park
SWITCH_CAR_GENERATOR gen_car43 101

CREATE_CAR_GENERATOR 1545.1 -845.6 -100.0 269.9 CAR_YANKEE -1 -1 0 0 0 0 10000 gen_car54 //Docks 
SWITCH_CAR_GENERATOR gen_car54 101

CREATE_CAR_GENERATOR 1495.1 -810.9 11.9 182.4 CAR_MULE -1 -1 0 0 0 0 10000 gen_car55 //Docks 
SWITCH_CAR_GENERATOR gen_car55 101

CREATE_CAR_GENERATOR 1576.8 -715.1 -100.0 93.0 CAR_YANKEE -1 -1 0 0 0 0 10000 gen_car56 //Docks 
SWITCH_CAR_GENERATOR gen_car56 101

CREATE_CAR_GENERATOR 1368.1 -1026.0 -100.0 11.7 CAR_LINERUNNER -1 -1 0 0 0 0 10000 gen_car66 //Docks by unique jump
SWITCH_CAR_GENERATOR gen_car66 101
	 

//CALLAHAN POINT
CREATE_CAR_GENERATOR 856.38 -993.76 4.6 0.0 CAR_KURUMA -1 -1 0 0 0 0 10000 gen_car44 //Greasy joes car park
SWITCH_CAR_GENERATOR gen_car44 0

CREATE_CAR_GENERATOR 898.21 -996.86 4.6 90.0 CAR_LINERUNNER -1 -1 0 0 0 0 10000 gen_car45 //Greasy joes car park
SWITCH_CAR_GENERATOR gen_car45 0

CREATE_CAR_GENERATOR 874.3 -983.74 4.6 90.0 CAR_MOONBEAM -1 -1 0 0 0 0 10000 gen_car46 //Greasy joes car park
SWITCH_CAR_GENERATOR gen_car46 0

CREATE_CAR_GENERATOR 978.6 -1093.0 13.3 0.0 CAR_BELLYUP -1 -1 0 0 0 0 10000 gen_car47 //Fish Factory
SWITCH_CAR_GENERATOR gen_car47 0

CREATE_CAR_GENERATOR 996.3 -1127.5 13.3 270.0 CAR_BELLYUP -1 -1 0 100 0 0 10000 gen_car48 //Fish Factory
SWITCH_CAR_GENERATOR gen_car48 0

CREATE_CAR_GENERATOR 1012.5 -1141.0 13.3 180.0 CAR_BELLYUP -1 -1 0 0 0 0 10000 gen_car49 //Fish Factory
SWITCH_CAR_GENERATOR gen_car49 0


//REDLIGHT DISTRICT
CREATE_CAR_GENERATOR 973.0 -420.0 14.5 0.0 CAR_PERENNIAL -1 -1 0 0 0 0 10000 gen_car51 //Back alleyway in Redlight district
SWITCH_CAR_GENERATOR gen_car51 101 								   

//CRUSHER
CREATE_CAR_GENERATOR 1111.8  45.0 -100.0 266.0 CAR_PONY -1 -1 0 0 0 0 10000 gen_car52 //By crusher
SWITCH_CAR_GENERATOR gen_car52 101

//BEACH
CREATE_CAR_GENERATOR 1460.5 -345.0 -100.0 270.0 CAR_BOBCAT -1 -1 0 0 0 0 10000 gen_car64 //Fish Factory
SWITCH_CAR_GENERATOR gen_car64 101

// *************************************COMMERCIAL CAR GENERATORS*****************************
VAR_INT com_car1 com_car2 com_car3 com_car4 com_car5 com_car6 com_car7 com_car8 com_car9 com_car10 phil_car 
VAR_INT	com_car11 com_car12 com_car13 com_car14 com_car15 com_car16 com_car17 com_car18 com_car19 com_car20
VAR_INT com_car21 com_car22 com_car23 com_car24	com_car25 com_car26 com_car27 com_car28 com_car29 com_car30
VAR_INT com_car31 com_car32 com_car33 com_car34	com_car35 com_car36 com_car37 com_car38 com_car39 com_car40
VAR_INT com_car41 com_car42 com_car43 com_car44	com_car45 com_car46 com_car47 com_car48 com_car49 special_tank

//CREATE_CAR_GENERATOR CarModel Remap1 Remap2 ParkedFlag ChanceOfCarAlarm ChanceOfLocked MinDelay MaxDelay CarGenID

CREATE_CAR_GENERATOR 354.2 -1055.9 -100.0 0.0 CAR_POLICE -1 -1 0 0 0 0 10000 com_car1 //At police station
SWITCH_CAR_GENERATOR com_car1 101

CREATE_CAR_GENERATOR 340.1 -1055.9 -100.0 90.0 CAR_ENFORCER -1 -1 0 0 0 0 10000 com_car2 //At police station
SWITCH_CAR_GENERATOR com_car2 101

CREATE_CAR_GENERATOR 356.5 -1170.3 22.0 0.0 CAR_POLICE -1 -1 0 0 0 0 10000 com_car25 //At police station
SWITCH_CAR_GENERATOR com_car25 101

CREATE_CAR_GENERATOR 334.4 -1151.0 22.0 90.0 CAR_SENTINEL -1 -1 0 70 0 0 10000 com_car26 //At police station
SWITCH_CAR_GENERATOR com_car26 101

//HOSPITAL
CREATE_CAR_GENERATOR 194.7 -41.1 -100.0 0.0 CAR_AMBULANCE -1 -1 0 0 0 0 10000 com_car3 //At Hospital
SWITCH_CAR_GENERATOR com_car3 101

CREATE_CAR_GENERATOR 216.5 -40.8 -100.0 180.0 CAR_AMBULANCE -1 -1 0 0 0 0 10000 com_car4 //At Hospital
SWITCH_CAR_GENERATOR com_car4 101

CREATE_CAR_GENERATOR 315.9 -7.0 -100.0 212.1 CAR_MOONBEAM -1 -1 0 50 0 0 10000 com_car5 //At Hospital car park
SWITCH_CAR_GENERATOR com_car5 101

CREATE_CAR_GENERATOR 216.5 -40.8 -100.0 180.0 CAR_ESPERANTO -1 -1 0 50 0 0 10000 com_car6 //At Hospital car park
SWITCH_CAR_GENERATOR com_car6 101

CREATE_CAR_GENERATOR 315.9 -7.0 -100.0 212.1 CAR_KURUMA -1 -1 0 50 0 0 10000 com_car7 //At Hospital car park
SWITCH_CAR_GENERATOR com_car7 101

CREATE_CAR_GENERATOR 299.3 10.8 -100.0 35.5 CAR_BOBCAT -1 -1 0 50 0 0 10000 com_car8 //At Hospital car park
SWITCH_CAR_GENERATOR com_car8 101

CREATE_CAR_GENERATOR 338.7 -4.6 -100.0 267.7 CAR_STALLION -1 -1 0 50 0 0 10000 com_car9 //At Hospital car park
SWITCH_CAR_GENERATOR com_car9 101

CREATE_CAR_GENERATOR 358.7 11.7 -100.0 272.7 CAR_RUMPO -1 -1 0 50 0 0 10000 com_car10 //At Hospital car park
SWITCH_CAR_GENERATOR com_car10 101

//ASUKAS
CREATE_CAR_GENERATOR 500.0 -659.4 -100.0 0.0 CAR_YAKUZA -1 -1 0 0 0 0 10000 com_car11 //By Asukas place
SWITCH_CAR_GENERATOR com_car11 101

CREATE_CAR_GENERATOR 486.5 -643.6 -100.0 180.0 CAR_BLISTA -1 -1 0 40 0 0 10000 com_car12 //By Asukas place
SWITCH_CAR_GENERATOR com_car12 101

CREATE_CAR_GENERATOR 475.5 -617.4 15.2 0.0 CAR_YAKUZA -1 -1 0 0 0 0 10000 com_car20 //By Asukas place
SWITCH_CAR_GENERATOR com_car20 101

CREATE_CAR_GENERATOR 485.0 -710.0 -100.0 270.0 CAR_LANDSTALKER -1 -1 0 60 0 0 10000 com_car21 //By Asukas place
SWITCH_CAR_GENERATOR com_car21 101

CREATE_CAR_GENERATOR 477.6 -731.4 -100.0 90.0 CAR_BANSHEE -1 -1 0 80 0 0 10000 com_car27 //By Asukas place
SWITCH_CAR_GENERATOR com_car27 101

//BELLEVILLE PARK
CREATE_CAR_GENERATOR 63.4 -591.3 25.9 90.0 CAR_LANDSTALKER -1 -1 0 0 0 0 10000 com_car28 //By cottage
SWITCH_CAR_GENERATOR com_car28 101

//TORRINGTON
CREATE_CAR_GENERATOR 233.5 -1236.7 20.5 0.0 CAR_MANANA -1 -1 0 20 0 0 10000 com_car29 //Underground car park
SWITCH_CAR_GENERATOR com_car29 101

CREATE_CAR_GENERATOR 259.2 -1196.7 20.5 90.0 CAR_YAKUZA -1 -1 0 60 40 0 10000 com_car30 //Underground car park
SWITCH_CAR_GENERATOR com_car30 101

CREATE_CAR_GENERATOR 228.8 -1205.7 20.5 180.0 CAR_BLISTA -1 -1 0 30 40 0 10000 com_car31 //Underground car park
SWITCH_CAR_GENERATOR com_car31 101

CREATE_CAR_GENERATOR 211.5 -1213.5 20.5 90.0 CAR_KURUMA -1 -1 0 20 70 0 10000 com_car32 //Underground car park
SWITCH_CAR_GENERATOR com_car32 101

CREATE_CAR_GENERATOR 458.9 -1503.4 -100.0 0.0 CAR_SENTINEL -1 -1 0 20 70 0 10000 com_car33 //Casino car park
SWITCH_CAR_GENERATOR com_car33 101

CREATE_CAR_GENERATOR 442.7 -1465.7 18.4 180.0 CAR_YAKUZA -1 -1 0 50 50 0 10000 com_car34 //Casino car park
SWITCH_CAR_GENERATOR com_car34 101

CREATE_CAR_GENERATOR 424.4 -1501.0 -100.0 90.0 CAR_IDAHO -1 -1 0 30 30 0 10000 com_car35 //Casino car park
SWITCH_CAR_GENERATOR com_car35 101

CREATE_CAR_GENERATOR 476.1 -1496.4 -100.0 220.0 CAR_BANSHEE -1 -1 0 80 0 0 10000 com_car36 //Casino car park
SWITCH_CAR_GENERATOR com_car36 101


//FORT STAUNTON
CREATE_CAR_GENERATOR 352.4 -345.5 -100.0 180.0 CAR_COLUMB -1 -1 0 0 30 0 10000 com_car37 //Construction site
SWITCH_CAR_GENERATOR com_car37 101

//CREATE_CAR_GENERATOR 394.7 -171.4 18.0 295.0 CAR_COLUMB -1 -1 0 20 30 0 10000 com_car38 //Construction site 
//SWITCH_CAR_GENERATOR com_car38 101

CREATE_CAR_GENERATOR 388.0 -95.0 -100.0 65.0 CAR_PANLANT -1 -1 0 0 0 0 10000 com_car39 //Construction site
SWITCH_CAR_GENERATOR com_car39 101

CREATE_CAR_GENERATOR 302.9 -245.2 -100.0 270.0 CAR_PANLANT -1 -1 0 0 0 0 10000 com_car40 //Construction site
SWITCH_CAR_GENERATOR com_car40 101

CREATE_CAR_GENERATOR 339.8449 -290.6314 16.0 158.2191 CAR_YAKUZA -1 -1 0 0 0 0 10000 gen_car60 //Construction site
SWITCH_CAR_GENERATOR gen_car60 0

CREATE_CAR_GENERATOR 359.1079 -291.0880 16.0 146.8412 CAR_YAKUZA -1 -1 0 0 0 0 10000 gen_car61 //Construction site
SWITCH_CAR_GENERATOR gen_car61 0

CREATE_CAR_GENERATOR 361.9012 -339.1167 16.0 339.3615 CAR_YAKUZA -1 -1 0 0 0 0 10000 gen_car62 //Construction site
SWITCH_CAR_GENERATOR gen_car62 0



//ASPATRIA
CREATE_CAR_GENERATOR -51.6 -324.0 -100.0 90.0 CAR_BOBCAT -1 -1 0 30 30 0 10000 com_car41 //Stadium Parking Lot
SWITCH_CAR_GENERATOR com_car41 101

CREATE_CAR_GENERATOR -40.5 -346.8 -100.0 270.0 CAR_IDAHO -1 -1 0 30 30 0 10000 com_car42 //Stadium Parking Lot
SWITCH_CAR_GENERATOR com_car42 101

CREATE_CAR_GENERATOR -30.0 -366.9 -100.0 270.0 CAR_MULE -1 -1 0 30 30 0 10000 com_car43 //Stadium Parking Lot
SWITCH_CAR_GENERATOR com_car43 101

CREATE_CAR_GENERATOR -62.3 -344.1 -100.0 90.0 CAR_BLISTA -1 -1 0 30 30 0 10000 com_car44 //Stadium Parking Lot
SWITCH_CAR_GENERATOR com_car44 101

CREATE_CAR_GENERATOR -72.2 -332.5 -100.0 270.0 CAR_STALLION -1 -1 0 30 30 0 10000 com_car45 //Stadium Parking Lot
SWITCH_CAR_GENERATOR com_car45 101

CREATE_CAR_GENERATOR -83.9 -443.6 -100.0 90.0 CAR_FIRETRUCK -1 -1 0 0 0 0 10000 gen_car35 //AT fire station
SWITCH_CAR_GENERATOR gen_car35 101

//NEWPORT 
CREATE_CAR_GENERATOR 301.71 -582.55 25.9 270.72 CAR_ESPERANTO -1 -1 0 70 0 0 10000 com_car15 //Multi story car park
SWITCH_CAR_GENERATOR com_car15 101

CREATE_CAR_GENERATOR 302.42 -562.54 25.9 88.21 CAR_RUMPO -1 -1 0 70 0 0 10000 com_car16 //Multi story car park
SWITCH_CAR_GENERATOR com_car16 101

CREATE_CAR_GENERATOR 283.21 -566.47 25.9 91.84 CAR_STALLION -1 -1 0 70 0 0 10000 com_car17 //Multi story car park
SWITCH_CAR_GENERATOR com_car17 101

CREATE_CAR_GENERATOR 302.2400 -510.4034 25.9 269.54 CAR_BLISTA -1 -1 0 70 0 0 10000 com_car19 //Multi story car park
SWITCH_CAR_GENERATOR com_car19 101

CREATE_CAR_GENERATOR 324.5 -455.9 22.5 90.0 CAR_BLISTA -1 -1 0 50 0 0 10000 com_car24 //Behind Multi story
SWITCH_CAR_GENERATOR com_car24 101


//BOATS
CREATE_CAR_GENERATOR 593.3 -664.0 0.0 0.0 BOAT_SPEEDER -1 -1 0 0 0 0 10000 com_car13 //At Asukas Jetty
SWITCH_CAR_GENERATOR com_car13 101

CREATE_CAR_GENERATOR 568.0 -686.0 0.0 180.0 BOAT_REEFER -1 -1 0 0 0 0 10000 com_car23 //At Asukas Jetty
SWITCH_CAR_GENERATOR com_car23 0

CREATE_CAR_GENERATOR 592.4 -766.7 0.0 0.0 BOAT_REEFER -1 -1 0 0 0 0 10000 com_car14 //Jetty south of Asukas
SWITCH_CAR_GENERATOR com_car14 101

CREATE_CAR_GENERATOR 554.8 -767.6 0.0 0.0 BOAT_PREDATOR	-1 -1 0 0 0 0 10000 com_car22 //Jetty south of Asukas
SWITCH_CAR_GENERATOR com_car22 101

CREATE_CAR_GENERATOR 133.56 208.76 11.93 180.0 CAR_BARRACKS -1 -1 0 0 0 10000 40000 phil_car //PHIL'S TRUCK--------
SWITCH_CAR_GENERATOR phil_car 101

//Kingdom Come carpark
CREATE_CAR_GENERATOR -52.28 -1458.3 26.15 90.0 CAR_MOONBEAM -1 -1 0 20 20 0 10000 com_car46
SWITCH_CAR_GENERATOR com_car46 101

CREATE_CAR_GENERATOR -77.5 -1485.0 26.0 90.0 CAR_KURUMA -1 -1 0 20 20 0 10000 com_car47
SWITCH_CAR_GENERATOR com_car47 101

CREATE_CAR_GENERATOR -70.9 -1443.6 25.8 180.0 CAR_STINGER -1 -1 0 40 40 0 10000 com_car48
SWITCH_CAR_GENERATOR com_car48 101

//Underground Bedford Point

CREATE_CAR_GENERATOR 9.5 -1475.7 19.7 0.0 CAR_RUMPO -1 -1 0 40 40 0 10000 com_car49
SWITCH_CAR_GENERATOR com_car49 101

CREATE_CAR_GENERATOR 132.0 173.9 11.6 0.0 CAR_RHINO -1 -1 0 0 0 0 10000 special_tank
SWITCH_CAR_GENERATOR special_tank 0

// *************************************SUBURBAN CAR GENERATORS******************************
VAR_INT sub_car1 sub_car2 sub_car3 sub_car4 sub_car5 sub_car6 sub_car7 sub_car8 sub_car9  
VAR_INT sub_car10 sub_car11 sub_car12 sub_car13 sub_car14 sub_car15 sub_car16 sub_car17 sub_car18 sub_car19  
VAR_INT sub_car20 sub_car21 sub_car22 sub_car23 sub_car24 sub_car25 sub_car26 sub_car27 sub_car28 sub_car29  
VAR_INT sub_car30 sub_car31 sub_car32 sub_car33 sub_car34 sub_car35 sub_car36 sub_car37 sub_car38 sub_car39 
VAR_INT sub_car40 sub_car41 sub_car42 sub_car43 sub_car44 sub_car45 sub_car46 

//CREATE_CAR_GENERATOR X Y Z Rot CarModel Remap1 Remap2 ParkedFlag ChanceOfCarAlarm ChanceOfLocked MinDelay MaxDelay CarGenID

CREATE_CAR_GENERATOR -458.4 268.0 -100.0 180.0 CAR_CHEETAH -1 -1 0 100 0 0 10000 sub_car1 //Swankville carpark
SWITCH_CAR_GENERATOR sub_car1 101

CREATE_CAR_GENERATOR -585.1 265.0 -100.0 0.0 CAR_LANDSTALKER -1 -1 0 100 0 0 10000 sub_car2 //Swankville carpark
SWITCH_CAR_GENERATOR sub_car2 101

CREATE_CAR_GENERATOR -712.1 263.6 -100.0 180.0 CAR_STINGER -1 -1 0 100 0 0 10000 sub_car3 //Swankville carpark
SWITCH_CAR_GENERATOR sub_car3 101

CREATE_CAR_GENERATOR -1249.1 -92.5 -100.0 90.0 CAR_AMBULANCE -1 -1 0 0 0 0 10000 sub_car4 //At Hospital
SWITCH_CAR_GENERATOR sub_car4 101

CREATE_CAR_GENERATOR -1266.0 -37.7 -100.0 160.0 CAR_POLICE -1 -1 0 0 50 0 10000 sub_car5 //At police station
SWITCH_CAR_GENERATOR sub_car5 101

CREATE_CAR_GENERATOR -402.0 291.6 -100.0 252.0 CAR_COLUMB -1 -1 0 0 0 0 10000 sub_car6 //Swankville carpark
SWITCH_CAR_GENERATOR sub_car6 101

CREATE_CAR_GENERATOR -218.5 263.7 3.5 90.0 CAR_PATRIOT -1 -1 0 0 0 0 10000 sub_car7 //Picnic area
SWITCH_CAR_GENERATOR sub_car7 101

CREATE_CAR_GENERATOR -839.4 -463.8 -100.0 90.0 CAR_FIRETRUCK -1 -1 0 0 0 0 10000 sub_car25 //AT airport
SWITCH_CAR_GENERATOR sub_car25 101	  

CREATE_CAR_GENERATOR -1268.4851 -528.6431 10.2 180.0 PLANE_DODO -1 -1 0 0 0 0 10000 gen_car63 //At airport
SWITCH_CAR_GENERATOR gen_car63 0

CREATE_CAR_GENERATOR -755.0409 204.3065 27.7 179.8454 CAR_BANSHEE -1 -1 0 80 0 0 10000 sub_car40//projects
SWITCH_CAR_GENERATOR sub_car40 101

CREATE_CAR_GENERATOR -724.7776 180.2350 27.7 182.0509 CAR_STALLION -1 -1 0 70 5 0 10000 sub_car41//projects
SWITCH_CAR_GENERATOR sub_car41 101

CREATE_CAR_GENERATOR -668.2543 99.3071 17.8 359.5899 CAR_BLISTA -1 -1 0 70 5 0 10000 sub_car42//projects 
SWITCH_CAR_GENERATOR sub_car42 101

CREATE_CAR_GENERATOR -449.9598 -13.2082 2.9 0.6847 CAR_COLUMB -1 -1 0 70 5 0 10000 sub_car43//projects 
SWITCH_CAR_GENERATOR sub_car43 101

CREATE_CAR_GENERATOR -510.8174 74.5390 2.9 0.2808 CAR_LANDSTALKER -1 -1 0 70 5 0 10000 sub_car44//projects 
SWITCH_CAR_GENERATOR sub_car44 101

CREATE_CAR_GENERATOR -217.6635 318.7584 2.5 358.8526 CAR_BOBCAT -1 -1 0 70 2 0 10000 sub_car45//projects
SWITCH_CAR_GENERATOR sub_car45 101

CREATE_CAR_GENERATOR -561.3663 -6.3410 2.9 91.0259 CAR_KURUMA -1 -1 0 70 1 0 10000 sub_car46//projects
SWITCH_CAR_GENERATOR sub_car46 101

// ********************AIRPORT CARPARK********************************************************

CREATE_CAR_GENERATOR -896.68 -414.2 11.25 90.0 CAR_LANDSTALKER -1 -1 0 20 20 0 10000 sub_car8 //AT airport
SWITCH_CAR_GENERATOR sub_car8 101	  

CREATE_CAR_GENERATOR -896.68 -395.2 11.25 270.0 CAR_BLISTA -1 -1 0 20 40 0 10000 sub_car9 //AT airport
SWITCH_CAR_GENERATOR sub_car9 101	  

CREATE_CAR_GENERATOR -882.1 -391.7 11.0 0.0 CAR_STALLION -1 -1 0 30 20 0 10000 sub_car10 //AT airport
SWITCH_CAR_GENERATOR sub_car10 101	  

CREATE_CAR_GENERATOR -862.9 -404.4 11.0 180.0 CAR_INFERNUS -1 -1 0 60 20 0 10000 sub_car11 //AT airport
SWITCH_CAR_GENERATOR sub_car11 101	  

CREATE_CAR_GENERATOR -846.65 -413.6 11.0 180.0 CAR_SENTINEL -1 -1 0 30 40 0 10000 sub_car12 //AT airport
SWITCH_CAR_GENERATOR sub_car12 101	  

CREATE_CAR_GENERATOR -814.85 -372.4 11.0 180.0 CAR_MANANA -1 -1 0 10 20 0 10000 sub_car13 //AT airport
SWITCH_CAR_GENERATOR sub_car13 101	  

CREATE_CAR_GENERATOR -821.2 -404.7 11.0 180.0 CAR_RUMPO -1 -1 0 10 10 0 10000 sub_car14 //AT airport
SWITCH_CAR_GENERATOR sub_car14 101	  

CREATE_CAR_GENERATOR -767.9 -404.65 11.0 0.0 CAR_TAXI -1 -1 0 10 20 0 10000 sub_car15 //AT airport
SWITCH_CAR_GENERATOR sub_car15 101	  

CREATE_CAR_GENERATOR -773.4 -373.13 11.0 180.0 CAR_ESPERANTO -1 -1 0 20 20 0 10000 sub_car16 //AT airport
SWITCH_CAR_GENERATOR sub_car16 101	  

// *****************************OUT FRONT OF AIRPORT**************************************

CREATE_CAR_GENERATOR -750.4 -603.13 11.0 270.0 CAR_TAXI -1 -1 0 20 20 0 10000 sub_car19 //AT airport
SWITCH_CAR_GENERATOR sub_car19 101	  

CREATE_CAR_GENERATOR -750.4 -567.13 11.0 270.0 CAR_TAXI -1 -1 0 20 20 0 10000 sub_car20 //AT airport
SWITCH_CAR_GENERATOR sub_car20 101	  

//  **************************AIRSTRIP*************************************************
CREATE_CAR_GENERATOR -856.4 -1228.13 1.0 250.0 BOAT_SPEEDER -1 -1 0 0 0 0 10000 sub_car17 //Runway
SWITCH_CAR_GENERATOR sub_car17 101	  

CREATE_CAR_GENERATOR -1126.4 -1034.13 1.0 270.0 BOAT_PREDATOR -1 -1 0 0 0 0 10000 sub_car18 //Runway
SWITCH_CAR_GENERATOR sub_car18 101	  

CREATE_CAR_GENERATOR -1574.0 -873.0 11.0 90.0 CAR_POLICE -1 -1 0 0 0 0 10000 sub_car21 //POLICE HELIPAD
SWITCH_CAR_GENERATOR sub_car21 101	  

CREATE_CAR_GENERATOR -1073.0 -753.0 11.0 360.0 CAR_RUMPO -1 -1 0 20 10 0 10000 sub_car22 //FREIGHT TERMINAL
SWITCH_CAR_GENERATOR sub_car22 101	  

CREATE_CAR_GENERATOR -1088.0 -753.0 11.0 360.0 CAR_RUMPO -1 -1 0 20 10 0 10000 sub_car23 //FREIGHT TERMINAL
SWITCH_CAR_GENERATOR sub_car23 101	  

CREATE_CAR_GENERATOR -848.0 -657.0 11.0 90.0 CAR_RUMPO -1 -1 0 20 10 0 10000 sub_car24 //FREIGHT TERMINAL
SWITCH_CAR_GENERATOR sub_car24 101	  

CREATE_CAR_GENERATOR -847.5811 -753.2242 10.2 143.6972 PLANE_DODO -1 -1 0 0 0 0 10000 sub_car30 //IN HANGAR
SWITCH_CAR_GENERATOR sub_car30 101

CREATE_CAR_GENERATOR -1525.3434 -924.3124 10.2 246.7710 PLANE_DODO -1 -1 0 0 0 0 10000 sub_car31 //WEST AIRPORT BY CHOPPERS
SWITCH_CAR_GENERATOR sub_car31 101

 
 

// ******************RC DESTRUCTION DERBY******************************************************
VAR_INT rc_van1 rc_van2 rc_van3 rc_van4 rc_van5 rc_van6

CREATE_CAR_GENERATOR 1014.0 -120.0 5.0 270.0 CAR_TOYZ -1 -1 0 0 0 0 10000 rc_van1 //Diablos
SWITCH_CAR_GENERATOR rc_van1 101

CREATE_CAR_GENERATOR 1158.0 -309.0 23.0 180.0 CAR_TOYZ -1 -1 0 0 0 0 10000 rc_van2 //Mafia
SWITCH_CAR_GENERATOR rc_van2 101

CREATE_CAR_GENERATOR -633.8 64.6 19.0 175.0 CAR_TOYZ -1 -1 0 0 0 0 10000 rc_van3 //Hood
SWITCH_CAR_GENERATOR rc_van3 101

CREATE_CAR_GENERATOR 366.0 -1312.0 26.0 180.0 CAR_TOYZ -1 -1 0 0 0 0 10000 rc_van4 //Yakuza
SWITCH_CAR_GENERATOR rc_van4 101



RETURN

main_pickups:

VAR_INT ind_pickup1	ind_pickup2 ind_pickup3 ind_pickup4	ind_pickup5 ind_pickup6 ind_pickup7 ind_pickup8 ind_pickup9 ind_pickup10
VAR_INT ind_pickup11 ind_pickup12 ind_pickup13 ind_pickup14	ind_pickup15 ind_pickup16 ind_pickup17 ind_pickup18 ind_pickup19 ind_pickup20
VAR_INT ind_pickup21 ind_pickup22 ind_pickup23 ind_pickup24	ind_pickup25 ind_pickup26 ind_pickup27 ind_pickup28	ind_pickup29 ind_pickup30
VAR_INT ind_pickup31 ind_pickup32 ind_pickup33 ind_pickup34	ind_pickup35 ind_pickup36 ind_pickup37 ind_pickup38 ind_pickup39 ind_pickup40
VAR_INT	info_pickup1 info_pickup2 info_pickup3 info_pickup4 info_pickup5 info_pickup6 ind_pickup41 //ind_pickup42 ind_pickup43 ind_pickup44
//VAR_INT ind_pickup45 ind_pickup46 ind_pickup47 ind_pickup48 ind_pickup49
VAR_INT	info_pickup7a info_pickup7b info_pickup8 info_pickup9 info_pickup10a info_pickup10b info_pickup10c
VAR_INT FREE_BASEBALLBAT1, FREE_BASEBALLBAT2, FREE_BASEBALLBAT3

current_time = 0
time_since_murdering_shopkeeper1 = -60000

out_of_stock_uzi = 0								   
out_of_stock_pistol = 0

//INDUSTRIAL********************************************************************************

//WEAPONS
CREATE_PICKUP WEAPON_BAT PICKUP_ON_STREET 883.5 -302.1 8.0 FREE_BASEBALLBAT1	//PLAYERS SAVE HOUSE INDUSTRIAL
CREATE_PICKUP_WITH_AMMO WEAPON_AK47 PICKUP_ON_STREET_SLOW 60 1249.0 -858.5 20.6 ind_pickup1 //Liberty Pharmaceuticals (roof)
CREATE_PICKUP_WITH_AMMO WEAPON_FLAME PICKUP_ON_STREET_SLOW 150 1018.3 -30.8 22.5 ind_pickup2 //Radio station (roof)
CREATE_PICKUP_WITH_AMMO WEAPON_SHOTGUN PICKUP_ON_STREET_SLOW 10 1217.3 -255.2 33.1 ind_pickup3 //Little Italy behind park (rooftop)
CREATE_PICKUP_WITH_AMMO WEAPON_SHOTGUN PICKUP_ON_STREET_SLOW 10 939.0 -113.3 3.7 ind_pickup4 //Behind Hepburn heights (far North) 
CREATE_PICKUP_WITH_AMMO WEAPON_UZI PICKUP_ON_STREET_SLOW 50 1138.7 -1035.5 20.2 ind_pickup5	//Saw mill roof
CREATE_PICKUP_WITH_AMMO WEAPON_UZI PICKUP_ON_STREET_SLOW 50 1309.5 -380.9 40.2 ind_pickup6 //Little Italy (back alley
CREATE_PICKUP_WITH_AMMO WEAPON_UZI PICKUP_ON_STREET_SLOW 50 1224.8 141.9 9.3 ind_pickup7 //Far North (south of little rocky island)
CREATE_PICKUP_WITH_AMMO WEAPON_COLT45 PICKUP_ON_STREET_SLOW 24 1017.6 -960.9 21.2 ind_pickup39 //On ledge at the bottom of Callahan bridge
CREATE_PICKUP_WITH_AMMO WEAPON_AK47 PICKUP_ON_STREET_SLOW 120 1253.6578 -314.1173 34.1 ind_pickup40 //Behind Toni's

//HEALTH
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 1147.8 -597.1 14.9 ind_pickup8 //Hospital industial
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 1147.8 -585.3 14.9 ind_pickup9 //Hospital industial
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 1252.8 -854.7 20.6 ind_pickup10 //Liberty Pharmaceuticals (roof)
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 822.5 -1048.7 14.3 ind_pickup11 //Far south (west of fish factory)
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 918.0 -735.9 14.6 ind_pickup12 //Alleyway at market place
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 1391.1 -1023.5 11.9 ind_pickup13 //Behind lorry jump in the docks 
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 1282.8 -815.4 15.0 ind_pickup14 //Near Meat factory
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 1267.6 -296.6 39.9 ind_pickup32 //Behind Tonis
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 1141.8 -63.0 7.4 ind_pickup33 //Petrol station
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 938.5 -181.9 4.9 ind_pickup34 //Hepburn Heights
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 972.9 -413.2 15.1 ind_pickup35 //Donkey porn alleyway
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 1387.7 -456.5 49.6 ind_pickup36 //Opposite Marcos Bistro

//ARMOUR
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 1116.4 -1237.4 11.9 ind_pickup15 //Far south industrail jetty
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 1250.2 -852.0 20.6 ind_pickup16 //Liberty Pharmaceuticals (roof)
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 1588.9 -624.0 11.8 ind_pickup17 //Docks (old smack ma bitch up area)
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 1236.0 -920.6 15.1 ind_pickup18 //Behind buildings by Joeys garage
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 1138.7 -1033.5 20.2 ind_pickup38 //Saw mill roof
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 1253.6578 -317.9105 34.1 ind_pickup41 //Behind Toni's

//ADRENALINE
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW 1394.6 -865.4 11.8 ind_pickup19 //Docks (behind cabins)
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW 1087.5 -156.5 9.8 ind_pickup20 //Garages near petrol station
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW 1247.1 -855.1 20.6 ind_pickup21 //Liberty Pharmaceuticals (roof)
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW 878.3 -521.3 16.5 ind_pickup22 //Fish place north chinatown
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW 1161.1 -546.9 21.5 ind_pickup37 //Hospital industial

//POLICE BRIBES
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 790.0 -560.7 27.0 ind_pickup23 //Over water front jump
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 1283.7 -388.7 34.6 ind_pickup24 //Long back alleyway (St Marks)
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 1440.2 -891.1 11.8 ind_pickup25 //Under large crane next to columbian boat
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 1078.9 -912.5 15.2 ind_pickup27 //Alley way between Trenton and Chinatown
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 995.8 -438.8 22.7 ind_pickup28 //Railway line (redlight)
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 1061.9 -567.7 16.6 ind_pickup29 //Alley way between redlight and Chinatown
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 859.6 -981.9 10.5 ind_pickup30 //On Greasy Joes
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 922.2 -848.1 14.9 ind_pickup31 //Basketball courts

//CAMERA
//CREATE_PICKUP camerapickup PICKUP_ON_STREET 881.3 60.4 9.7 ind_pickup42 //North Harwood waste ground
//CREATE_PICKUP camerapickup PICKUP_ON_STREET 1024.0 -477.3 14.9 ind_pickup43 //Near subway
//CREATE_PICKUP camerapickup PICKUP_ON_STREET 1159.4 -755.4 14.7 ind_pickup44	//Behind Joeys garage
//CREATE_PICKUP camerapickup PICKUP_ON_STREET 1402.3 -804.9 11.6 ind_pickup45 //Docks
//CREATE_PICKUP camerapickup PICKUP_ON_STREET 839.8 -1029.1 15.6 ind_pickup46	//South opposite Greasy Joes
//CREATE_PICKUP camerapickup PICKUP_ON_STREET 1427.7 -4.6 9.4 ind_pickup47 //Far north
//CREATE_PICKUP camerapickup PICKUP_ON_STREET 1459.6 -363.5 14.7 ind_pickup48	//Beach
//CREATE_PICKUP camerapickup PICKUP_ON_STREET 1114.9 -113.2 10.1 ind_pickup49 //Near fire station


 
//COMMERCIAL********************************************************************************

//VAR_INT phils_m16 phils_uzi phils_shotgun
VAR_INT	com_pickup1 com_pickup2 com_pickup3 com_pickup4 com_pickup5 com_pickup6 com_pickup7 com_pickup8 com_pickup9 com_pickup10 
VAR_INT	com_pickup11 com_pickup12 com_pickup13 com_pickup14 com_pickup15 com_pickup16 com_pickup17 com_pickup18	com_pickup19 com_pickup20
VAR_INT	com_pickup21 com_pickup22 com_pickup23 com_pickup24 com_pickup25 com_pickup26 com_pickup27 com_pickup28 com_pickup29 com_pickup30
VAR_INT com_pickup31 com_pickup32 com_pickup33 com_pickup34 com_pickup35 com_pickup36 com_pickup37 com_pickup38 com_pickup40 com_pickup41

//WEAPONS
CREATE_PICKUP WEAPON_BAT PICKUP_ON_STREET 99.1 -478.7 15.9 FREE_BASEBALLBAT2 //PLAYERS SAVE HOUSE COMMERCIAL -OK
CREATE_PICKUP_WITH_AMMO WEAPON_SNIPER PICKUP_ON_STREET_SLOW 15 -77.5 -482.7 28.8 com_pickup1 //Roof jump from Suburban bridge -OK
CREATE_PICKUP_WITH_AMMO WEAPON_AK47 PICKUP_ON_STREET_SLOW 60 18.9 -1240.9 27.8 com_pickup2	//Columned walkway near church -OK
CREATE_PICKUP_WITH_AMMO WEAPON_SHOTGUN PICKUP_ON_STREET_SLOW 10 93.1 -724.2 31.5 com_pickup3 //Park behind monument -OK
CREATE_PICKUP_WITH_AMMO WEAPON_MOLOTOV PICKUP_ON_STREET_SLOW 10 202.8 -108.3 20.1 com_pickup4 //Liberty Campus -OK
CREATE_PICKUP_WITH_AMMO WEAPON_AK47 PICKUP_ON_STREET_SLOW 60 422.4 -92.0 16.14 com_pickup5 // NE construction site under ruins -OK
CREATE_PICKUP_WITH_AMMO WEAPON_M16 PICKUP_ON_STREET_SLOW 60 -31.45 -1456.38 26.13 com_pickup6 // South Comm behind wall nr carpark -OK
CREATE_PICKUP_WITH_AMMO WEAPON_SHOTGUN PICKUP_ON_STREET_SLOW 10 -253.0 -1340.34 5.85 com_pickup7 //Far South West Quay -OK

//HEALTH
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 182.9 -16.3 16.2 com_pickup8 //Hospital commercial -OK
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 222.6 16.0 16.2 com_pickup9 //Hospital commercial -OK
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 513.6 -680.6 16.6 com_pickup10 //Place opposite Asukas -OK
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -25.3 -1142.3 26.1 com_pickup11 //Church -OK
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -48.56 -579.0 26.2 com_pickup12 //Grassy bank start of ramp for lift bridge -OK
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -26.35 -767.63 26.17	com_pickup13 //Entry old office block left of OrBit facing park -OK
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -24.67 -1275.76 25.71 com_pickup14 //In shrubs North side glass 20thC building -OK
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -178.34 -1409.0 26.1	com_pickup15 //Annex off South West circle road -OK
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 228.46 -1516.33 27.42 com_pickup16 //Stepped entry to second of twin tower block nr subway -OK
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 200.0 -1219.14 26.92	com_pickup17 //Raised pavement AmCo building -OK
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 371.25 -1028.1 26.03	com_pickup18 // Grassy ledge above police HQ -OK 
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 189.7 -602.2 28.1 com_pickup19 //Shopping promenade nr park -OK
CREATE_PICKUP health PICKUP_ON_STREET_SLOW 398.4569 -289.0348 23.2 com_pickup40 //Building site

//ARMOUR
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 410.1 -935.2 16.1 com_pickup20 //Far south industrail jetty between trailers -OK
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW -80.5 -482.7 28.8 com_pickup21 //Roof jump from Suburban bridge -OK
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 22.1 -1241.1 27.8 com_pickup22 //Columned walkway near church -OK
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 151.75 -106.4 20.16 com_pickup23	//Liberty Campus -OK
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW -44.7 -1456.38 26.13	com_pickup24 // South Comm behind wall nr carpark -OK
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 398.4569 -285.3912 23.2 com_pickup41 //Building site

//ADRENALINE
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW 169.3 -990.5 29.5 com_pickup25 //TW@T CAFE -OK
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW 231.8 -338.7 31.7 com_pickup26 //Opposite consturction yard, raised walkway -OK
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW 89.0 -931.8 27.1 com_pickup27 // -main intersection Callahan Bridge -OK
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW 212.4 -896.6 23.15 com_pickup28 // Entrance to tower, right of Callahan Bridge -OK

//POLICE BRIBES
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 320.7 -782.13 28.8 com_pickup29 //Maze of paths behind AmmuNation -OK
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 351.0 -1176.6 16.7 com_pickup30 //Police HQ tunnel -OK
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 108.3 -1398.7 21.8 com_pickup31 //tight alleyway south central behind town hall -OK
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 419.7 -1439.6 25.6 com_pickup32 //Casino -OK
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 283.6 -809.7 28.9 com_pickup33 //little grassy path from flyover towards park -OK
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 181.3 -262.4 15.9 com_pickup34 //University -OK
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW -16.4 -458.6 18.6 com_pickup35 //Behind fire station -OK
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW -150.5 -112.8 16.16 com_pickup36 //Behind stadium -OK
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 357.58 -898.55 23.53 com_pickup37	// Grassy path Callahan Bridge -OK
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 412.2 -1564.6 24.5 com_pickup38  //Over Jump (South by Casino) -OK

//SUBURBIA**************************************************************************************

VAR_INT sub_pickup1 sub_pickup2 sub_pickup3 sub_pickup4 sub_pickup6 sub_pickup7	sub_pickup8	sub_pickup9	sub_pickup10 
VAR_INT sub_pickup11 sub_pickup12 sub_pickup13 sub_pickup14 sub_pickup15 sub_pickup16 sub_pickup17 sub_pickup18	sub_pickup19 sub_pickup20
VAR_INT sub_pickup21 sub_pickup22 sub_pickup23 sub_pickup24 sub_pickup25 sub_pickup26 sub_pickup27 sub_pickup28 sub_pickup29 sub_pickup30
VAR_INT sub_pickup31

//WEAPONS
CREATE_PICKUP WEAPON_BAT PICKUP_ON_STREET -661.1 -3.8 18.8 FREE_BASEBALLBAT3 //PLAYERS SAVE HOUSE SUBURBAN
CREATE_PICKUP_WITH_AMMO WEAPON_AK47 PICKUP_ON_STREET_SLOW 60 -1065.2 -153.7 33.7 sub_pickup1 // south Industrail area
CREATE_PICKUP_WITH_AMMO WEAPON_M16 PICKUP_ON_STREET_SLOW 60 -555.0 311.2 70.8 sub_pickup2 //back of second mansion to the east of the Columbian mansion
CREATE_PICKUP_WITH_AMMO WEAPON_M16 PICKUP_ON_STREET_SLOW 60 -1153.6 440.3 35.5 sub_pickup3 //Dam 2nd tower (suburban)
CREATE_PICKUP_WITH_AMMO WEAPON_SHOTGUN PICKUP_ON_STREET_SLOW 15 -1141.9 333.0 3.4 sub_pickup4  //To west of Dam on the lower ground
CREATE_PICKUP_WITH_AMMO WEAPON_SNIPER PICKUP_ON_STREET_SLOW 5 -973.8 455.7 23.5 sub_pickup6 //On lower half of Dam
CREATE_PICKUP_WITH_AMMO WEAPON_ROCKET PICKUP_ON_STREET_SLOW 3 -855.4 304.6 49.1 sub_pickup7 //On furthest west mansion roof
CREATE_PICKUP_WITH_AMMO WEAPON_FLAME PICKUP_ON_STREET_SLOW 300 -632.7 -589.3 18.8 sub_pickup31 //Under the suburban bridge

//HEALTH
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -1247.5 -79.5 58.8 sub_pickup8 //Hospital suburban
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -1247.5 -82.5 58.8 sub_pickup9 //Hospital suburban
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -1120.7 586.4 68.6 sub_pickup10 //East Dam dome 
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -1072.5 449.0 23.6 sub_pickup11 //lower Dam opposite side of the first crates 
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -1142.0 330.6 3.4 sub_pickup12 //To west of Dam on the lower ground  
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -1198.6 -39.7 53.2 sub_pickup13 //Garages behind police station  
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -1384.6 -747.4 10.9 sub_pickup14 //airport between ramps
CREATE_PICKUP health PICKUP_ON_STREET_SLOW -466.6 30.4 3.9 sub_pickup15 //Projects

//ARMOUR
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW -426.9 290.2 62.9 sub_pickup16 //Columbian mansion (in garage)
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW -698.0 -560.7 22.4 sub_pickup17 //On tunnel entrance roof 
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW -1066.7 47.0 48.9 sub_pickup18 //North industrial next to bridge 
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW -1186.9 -40.1 53.2 sub_pickup19 //Garages behind police station 

//ADRENALINE
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW -710.1 180.3 28.7 sub_pickup20 //Car park in between mansions and projects
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW -501.1 62.9 3.8 sub_pickup21 //Projects
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW -963.0 -113.4 34.2 sub_pickup22 //Behind billboard east central 
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW -1374.6 -747.4 10.9 sub_pickup23 //airport between ramps 
CREATE_PICKUP adrenaline PICKUP_ON_STREET_SLOW -1092.0 -24.2 48.9 sub_pickup24 //Liberty Pharmaceuticals

//POLICE BRIBES
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW -1247.8 136.0 68.5 sub_pickup25 //North west industrial
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW -468.6 -62.0 3.8 sub_pickup26 //Projects between garage
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW -1107.5 -77.2 46.1 sub_pickup27 //central Industrial on stairs
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW -618.7 -722.6 18.9 sub_pickup28 //At airport statue next to subway
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW -1252.4 -641.6 11.1 sub_pickup29 //Airport in the middle of the planes
CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW -853.4 -255.6 32.9 sub_pickup30 //Grassy verge between airport ad Pike Creek


//INFO PICKUPS***********************************************************************************

//health info/wanted info
VAR_INT heal_info wanted_info flag_health_info flag_wanted_info
VAR_INT heal_info_trip wanted_info_trip
 
flag_health_info = 0
flag_wanted_info = 0
heal_info_trip = 0
wanted_info_trip = 0

CREATE_PICKUP info PICKUP_ON_STREET 921.3 -352.8 10.9 info_pickup1 //Spary shop
START_NEW_SCRIPT check_info_pickup info_pickup1 1

CREATE_PICKUP info PICKUP_ON_STREET 1279.5 -98.3 15.0 info_pickup2 //Bomb shop
START_NEW_SCRIPT check_info_pickup info_pickup2	2
CREATE_PICKUP info PICKUP_ON_STREET 1065.0 -392.8 14.9 info_pickup3	//Ammu nation
START_NEW_SCRIPT check_info_pickup info_pickup3	3
CREATE_PICKUP info PICKUP_ON_STREET 889.5 -316.1 8.7 info_pickup4 //Save garage 
START_NEW_SCRIPT check_info_pickup info_pickup4	4
CREATE_PICKUP info PICKUP_ON_STREET 889.5 -305.8 8.7 info_pickup5 //Save house
START_NEW_SCRIPT check_info_pickup info_pickup5 5
CREATE_PICKUP info PICKUP_ON_STREET 1130.4 52.8 0.4 info_pickup6 //Crusher
START_NEW_SCRIPT check_info_pickup info_pickup6 6
CREATE_PICKUP info PICKUP_ON_STREET 1028.8 -927.4 15.0 info_pickup7a //Callahan Bridge
START_NEW_SCRIPT check_info_pickup_2 info_pickup7a 7
CREATE_PICKUP info PICKUP_ON_STREET 916.5 -472.0 -18.8 info_pickup7b //SUBWAY
START_NEW_SCRIPT check_info_pickup_2 info_pickup7b 11
CREATE_PICKUP info PICKUP_ON_STREET 758.7 164.2 -19.9 info_pickup8 //Porter Tunnel 
START_NEW_SCRIPT check_info_pickup_2 info_pickup8	8
CREATE_PICKUP info PICKUP_ON_STREET 991.9 -471.3 3.7 info_pickup9 //Tube -industrial
START_NEW_SCRIPT check_info_pickup_2 info_pickup9 9
CREATE_PICKUP info PICKUP_ON_STREET 1318.7 -524.9 43.3 info_pickup10a //A-trains
START_NEW_SCRIPT check_info_pickup_2 info_pickup10a 10
CREATE_PICKUP info PICKUP_ON_STREET 772.0 -588.4 23.9 info_pickup10b //A-trains
START_NEW_SCRIPT check_info_pickup_2 info_pickup10b 10
CREATE_PICKUP info PICKUP_ON_STREET 1039.0 -149.8 23.9 info_pickup10c //A-trains
START_NEW_SCRIPT check_info_pickup_2 info_pickup10c 10



RETURN
MISSION_START

// *****************************************************************************************
// ****************************************Stunt Jump*************************************** 
// *****************************************************************************************

// Variables for mission

VAR_INT	car_player_is_in_hj
VAR_INT flag_takeoff_hj
VAR_INT height_int_hj
VAR_INT flag_wheels_hj
VAR_INT stunt_flags_hj
VAR_INT flag_car_upsidedown_hj
VAR_INT counter_stunt_rolls_hj
VAR_INT	height_decimals_int_hj
VAR_INT	distance_decimals_int_hj
VAR_INT jumpdistance_int_hj
VAR_INT counter_land_on_wheels_hj
VAR_INT counter_wheels_hj
VAR_INT	total_rotation_int
VAR_INT longest_flight_time
VAR_INT got_flight_start
VAR_INT flight_timer_start
VAR_INT flight_timer_end
VAR_INT flight_time	flag_flight_hj
VAR_INT collision_counter
VAR_INT cash_reward cash_reward_temp
VAR_FLOAT height_float_hj
VAR_FLOAT x_float_hj
VAR_FLOAT y_float_hj
VAR_FLOAT z_float_hj
VAR_FLOAT takeoff_x_float_hj
VAR_FLOAT takeoff_y_float_hj
VAR_FLOAT takeoff_z_float_hj
VAR_FLOAT jumpend_x_float_hj
VAR_FLOAT jumpend_y_float_hj
VAR_FLOAT difference_x_float_hj
VAR_FLOAT difference_y_float_hj
VAR_FLOAT sum_difference_xy_hj
VAR_FLOAT jumpdistance_float_hj
VAR_FLOAT heading_hj
VAR_FLOAT temp_float
VAR_FLOAT old_heading_hj
VAR_FLOAT heading_difference
VAR_FLOAT heading_difference_temp
VAR_FLOAT total_rotation

// ****************************************Mission Start************************************

SET_DEATHARREST_STATE OFF
SCRIPT_NAME hj

longest_flight_time = 0

mission_start_hj:

WAIT 0

IF NOT IS_PLAYER_PLAYING player
	GOTO mission_start_hj
ENDIF

IF ARE_ANY_CAR_CHEATS_ACTIVATED
	GOTO mission_start_hj
ENDIF

IF IS_PLAYER_IN_ANY_CAR player

	STORE_CAR_PLAYER_IS_IN_NO_SAVE player car_player_is_in_hj

	IF NOT IS_BOAT car_player_is_in_hj

		IF IS_CAR_IN_AIR_PROPER car_player_is_in_hj
			
			total_rotation_int			= 0
			heading_hj					= 0.0
			flag_wheels_hj				= 0
			counter_land_on_wheels_hj 	= 0
			counter_stunt_rolls_hj 		= 0
			flag_car_upsidedown_hj 		= 0
			counter_wheels_hj 			= 0
			stunt_flags_hj		  		= 0
			flag_takeoff_hj	       		= 0
			height_int_hj          		= 0
			height_float_hj		   		= -100.0
			x_float_hj		       		= 0.0
			y_float_hj			   		= 0.0
			z_float_hj			   		= 0.0
			takeoff_x_float_hj	   		= 0.0
			takeoff_y_float_hj	   		= 0.0
			takeoff_z_float_hj	   		= 0.0
			jumpend_x_float_hj	   		= 0.0
			jumpend_y_float_hj	   		= 0.0
			difference_x_float_hj  		= 0.0
			difference_y_float_hj  		= 0.0
			sum_difference_xy_hj   		= 0.0
			jumpdistance_float_hj  		= 0.0
			jumpdistance_int_hj	  		= 0
			distance_decimals_int_hj	= 0
			height_decimals_int_hj		= 0
			temp_float					= 0.0
			heading_difference			= 0.0
			total_rotation				= 0.0
			heading_difference_temp		= 0.0
			old_heading_hj				= 0.0
			got_flight_start			= 0
			flight_timer_start			= 0
			flight_timer_end			= 0
			flight_time					= 0
			flag_flight_hj				= 0
			collision_counter			= 0

			IF IS_CAR_MODEL car_player_is_in_hj PLANE_DODO
				GOTO dodo_flight_time
			ENDIF

	    	WHILE IS_CAR_IN_AIR_PROPER car_player_is_in_hj
			OR collision_counter < 10

				++ collision_counter

	    		GET_CAR_COORDINATES car_player_is_in_hj x_float_hj y_float_hj z_float_hj
	    	
				old_heading_hj = heading_hj
				
	    		IF flag_takeoff_hj = 0
	    			GET_CAR_HEADING car_player_is_in_hj old_heading_hj
	    			takeoff_x_float_hj = x_float_hj
	    			takeoff_y_float_hj = y_float_hj
	    			takeoff_z_float_hj = z_float_hj
	    			flag_takeoff_hj = 1
	    		ENDIF

	    		WAIT 0

				IF IS_CAR_DEAD car_player_is_in_hj
					GOTO mission_start_hj
				ENDIF

	    		IF NOT IS_PLAYER_PLAYING player
	    			GOTO mission_start_hj
	    		ENDIF 			
	    		
	    		IF NOT IS_PLAYER_IN_ANY_CAR player
	    			GOTO mission_start_hj
	    		ENDIF

	    		IF NOT IS_CAR_UPRIGHT car_player_is_in_hj
	    		AND flag_car_upsidedown_hj = 0
	    			flag_car_upsidedown_hj = 1
	    		ENDIF

	    		IF IS_CAR_UPRIGHT car_player_is_in_hj
	    		AND flag_car_upsidedown_hj = 1
	    			++ counter_stunt_rolls_hj
	    			flag_car_upsidedown_hj = 0
	    		ENDIF

	    		GET_CAR_HEADING car_player_is_in_hj heading_hj

				heading_difference = heading_hj - old_heading_hj

				IF heading_difference > 180.0
					heading_difference_temp = heading_difference     
					heading_difference = 360.0 - heading_difference_temp
				ELSE
					IF heading_difference < -180.0
						heading_difference_temp = heading_difference     
						heading_difference = 360.0 + heading_difference_temp
					ENDIF
				ENDIF

				IF heading_difference < 0.0
					heading_difference_temp = heading_difference
					heading_difference = 0.0 - heading_difference_temp
				ENDIF

				total_rotation = total_rotation + heading_difference

				total_rotation_int =# total_rotation 
				
	    		IF z_float_hj > height_float_hj
	    			height_float_hj = z_float_hj	 
	    		ENDIF
	    	
	    		z_float_hj = 0.0
	    			 
	    	ENDWHILE

		ELSE
			GOTO mission_start_hj
		ENDIF
	ELSE
		GOTO mission_start_hj
	ENDIF
ELSE
	GOTO mission_start_hj
ENDIF 

IF flag_takeoff_hj = 1
	GET_CAR_COORDINATES car_player_is_in_hj jumpend_x_float_hj jumpend_y_float_hj temp_float
		
	WHILE counter_land_on_wheels_hj < 90
		
		IF IS_CAR_DEAD car_player_is_in_hj
			GOTO mission_start_hj
		ELSE
			IF NOT IS_CAR_IN_AIR car_player_is_in_hj
				++ counter_wheels_hj
			ENDIF
		ENDIF
		
		WAIT 0

		IF NOT IS_PLAYER_PLAYING player
			GOTO mission_start_hj
		ENDIF

		++ counter_land_on_wheels_hj

	ENDWHILE

	counter_land_on_wheels_hj = 0

  	difference_x_float_hj = takeoff_x_float_hj - jumpend_x_float_hj
	difference_y_float_hj = takeoff_y_float_hj - jumpend_y_float_hj
	difference_x_float_hj = difference_x_float_hj * difference_x_float_hj
	difference_y_float_hj = difference_y_float_hj * difference_y_float_hj
	sum_difference_xy_hj = difference_x_float_hj + difference_y_float_hj
	SQRT sum_difference_xy_hj jumpdistance_float_hj
	REGISTER_JUMP_DISTANCE jumpdistance_float_hj
	jumpdistance_int_hj =# jumpdistance_float_hj
	height_float_hj = height_float_hj - takeoff_z_float_hj
	REGISTER_JUMP_HEIGHT height_float_hj
	height_int_hj =# height_float_hj
	temp_float =# jumpdistance_int_hj
	jumpdistance_float_hj = jumpdistance_float_hj - temp_float
	temp_float = jumpdistance_float_hj * 100.0
	distance_decimals_int_hj =# temp_float
	temp_float =# height_int_hj
	height_float_hj = height_float_hj - temp_float
	temp_float = height_float_hj * 100.0
	height_decimals_int_hj =# temp_float
	REGISTER_JUMP_FLIPS counter_stunt_rolls_hj
	REGISTER_JUMP_SPINS total_rotation_int
ENDIF

IF height_float_hj > 4.0	   	//4 METERS HIGH
	++ stunt_flags_hj
ENDIF

IF jumpdistance_int_hj > 30    	//30 METERS LONG
	++ stunt_flags_hj
ENDIF

IF counter_stunt_rolls_hj > 0  	//1 ROLLS/FLIPS IN MID AIR
	++ stunt_flags_hj
ENDIF

IF total_rotation_int > 360    	//360 SPIN IN MID AIR
	++ stunt_flags_hj
ENDIF

IF counter_wheels_hj > 60 		//LAND ON WHEELS
   	flag_wheels_hj = 1
ENDIF

IF stunt_flags_hj > 0

	cash_reward = counter_stunt_rolls_hj * 180
	cash_reward += total_rotation_int
	cash_reward_temp = jumpdistance_int_hj * 6
	cash_reward += cash_reward_temp
	cash_reward_temp = height_int_hj * 45
	cash_reward += cash_reward_temp
	IF flag_wheels_hj = 1
		cash_reward *= 2
	ENDIF
	cash_reward *= stunt_flags_hj
	cash_reward /= 3
	ADD_SCORE player cash_reward

    IF stunt_flags_hj = 1
    AND flag_wheels_hj = 0
    	PRINT_WITH_NUMBER HJ_IS cash_reward 2000 1 //"INSANE STUNT BONUS"
		REGISTER_JUMP_STUNT 1
    ENDIF

    IF stunt_flags_hj = 1
    AND flag_wheels_hj = 1
    	PRINT_WITH_NUMBER HJ_PIS cash_reward 2000 1 //"PERFECT INSANE STUNT BONUS"
		REGISTER_JUMP_STUNT 2
    ENDIF

    IF stunt_flags_hj = 2
    AND flag_wheels_hj = 0
    	PRINT_WITH_NUMBER HJ_DIS cash_reward 2000 1 //"DOUBLE INSANE STUNT BONUS"
		REGISTER_JUMP_STUNT 3
    ENDIF

    IF stunt_flags_hj = 2
    AND flag_wheels_hj = 1
    	PRINT_WITH_NUMBER HJ_PDIS cash_reward 2000 1 //"PERFECT DOUBLE INSANE STUNT BONUS"
		REGISTER_JUMP_STUNT 4
    ENDIF

    IF stunt_flags_hj = 3
    AND flag_wheels_hj = 0
    	PRINT_WITH_NUMBER HJ_TIS cash_reward 2000 1 //"TRIPLE INSANE STUNT BONUS"
		REGISTER_JUMP_STUNT 5
    ENDIF

    IF stunt_flags_hj = 3
    AND flag_wheels_hj = 1
    	PRINT_WITH_NUMBER HJ_PTIS cash_reward 2000 1 //"PERFECT TRIPLE INSANE STUNT BONUS"
		REGISTER_JUMP_STUNT 6
    ENDIF

    IF stunt_flags_hj = 4
    AND flag_wheels_hj = 0
    	PRINT_WITH_NUMBER HJ_QIS cash_reward 2000 1 //"QUADRUPLE INSANE STUNT BONUS"
		REGISTER_JUMP_STUNT 7
    ENDIF

    IF stunt_flags_hj = 4
    AND flag_wheels_hj = 1
    	PRINT_WITH_NUMBER HJ_PQIS cash_reward 3000 1 //"PERFECT QUADRUPLE INSANE STUNT BONUS"
		REGISTER_JUMP_STUNT 8
    ENDIF

	IF ARE_MEASUREMENTS_IN_METRES
	    IF flag_wheels_hj = 1
	    	PRINT_WITH_6_NUMBERS HJSTATW jumpdistance_int_hj distance_decimals_int_hj height_int_hj height_decimals_int_hj counter_stunt_rolls_hj total_rotation_int 5000 5
	    ELSE
	    	PRINT_WITH_6_NUMBERS HJSTAT jumpdistance_int_hj distance_decimals_int_hj height_int_hj height_decimals_int_hj counter_stunt_rolls_hj total_rotation_int 5000 5
		ENDIF
	ELSE
		CONVERT_METRES_TO_FEET_INT jumpdistance_int_hj jumpdistance_int_hj
		CONVERT_METRES_TO_FEET_INT height_int_hj height_int_hj
	    IF flag_wheels_hj = 1
	    	PRINT_WITH_4_NUMBERS HJSTAWF jumpdistance_int_hj height_int_hj counter_stunt_rolls_hj total_rotation_int 5000 5
	    ELSE
	    	PRINT_WITH_4_NUMBERS HJSTATF jumpdistance_int_hj height_int_hj counter_stunt_rolls_hj total_rotation_int 5000 5
		ENDIF
	ENDIF

	//ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_PART_MISSION_COMPLETE

ENDIF

GOTO mission_start_hj

dodo_flight_time:

WHILE IS_CAR_IN_AIR_PROPER car_player_is_in_hj

	IF got_flight_start	= 0
		GET_GAME_TIMER flight_timer_start
		flag_flight_hj = 1
		got_flight_start = 1
	ENDIF

	IF IS_CAR_IN_WATER car_player_is_in_hj
		GOTO cessna_fight_bit
	ENDIF

	WAIT 0

	IF IS_CAR_DEAD car_player_is_in_hj
		GOTO mission_start_hj
	ENDIF

	IF NOT IS_PLAYER_PLAYING player
		GOTO mission_start_hj
	ENDIF 			
    		
	IF NOT IS_PLAYER_IN_ANY_CAR player
		GOTO mission_start_hj
	ENDIF

ENDWHILE

cessna_fight_bit:

IF flag_flight_hj = 1
	GET_GAME_TIMER flight_timer_end

	flight_time = flight_timer_end - flight_timer_start

	flight_time = flight_time / 1000

	IF flight_time > 1
		IF flight_time > longest_flight_time
			longest_flight_time = flight_time
		ENDIF

		PRINT_WITH_NUMBER_NOW DODO_FT flight_time 5000 1

		REGISTER_LONGEST_DODO_FLIGHT flight_time
	ENDIF
ENDIF

GOTO mission_start_hj

MISSION_END
 
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ********************************** Unique Stunt Jumps *********************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

 
// Variables for mission

VAR_INT	players_car_usj cash_reward_usj total_completed_usj
VAR_INT flag_1st_locate_usj flag_2nd_locate_usj	usj_number collision_counter_usj
VAR_INT flag_usj1_passed flag_usj2_passed flag_usj3_passed flag_usj4_passed	flag_usj5_passed flag_usj6_passed flag_usj7_passed
VAR_INT flag_usj8_passed flag_usj9_passed flag_usj10_passed flag_usj11_passed flag_usj12_passed	flag_usj13_passed flag_usj14_passed
VAR_INT flag_usj15_passed flag_usj16_passed	flag_usj17_passed flag_usj18_passed	flag_usj19_passed flag_usj20_passed
VAR_FLOAT car_speed_usj camera_x camera_y camera_z

// ****************************************Mission Start************************************

flag_usj1_passed = 0
flag_usj2_passed = 0
flag_usj3_passed = 0
flag_usj4_passed = 0
flag_usj5_passed = 0
flag_usj6_passed = 0
flag_usj7_passed = 0
flag_usj8_passed = 0
flag_usj9_passed = 0
flag_usj10_passed = 0
flag_usj11_passed = 0
flag_usj12_passed = 0
flag_usj13_passed = 0
flag_usj14_passed = 0
flag_usj15_passed = 0
flag_usj16_passed = 0
flag_usj17_passed = 0
flag_usj18_passed = 0
flag_usj19_passed = 0
flag_usj20_passed = 0

cash_reward_usj = 5000
usj_number = 0
total_completed_usj = 0

SET_DEATHARREST_STATE OFF
SET_UNIQUE_JUMPS_TOTAL 20

SCRIPT_NAME usj


mission_start_usj:

WAIT 0

IF NOT IS_PLAYER_PLAYING player
	GOTO mission_start_usj
ENDIF

IF NOT IS_PLAYER_IN_ANY_CAR player
	GOTO mission_start_usj
ENDIF
	
STORE_CAR_PLAYER_IS_IN_NO_SAVE player players_car_usj

IF IS_BOAT players_car_usj
	GOTO mission_start_usj
ENDIF

GET_CAR_SPEED players_car_usj car_speed_usj

IF NOT car_speed_usj > 25.0
	GOTO mission_start_usj
ENDIF

IF NOT IS_CAR_IN_AIR_PROPER players_car_usj
	GOTO mission_start_usj
ENDIF

IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
	
	IF IS_PLAYER_IN_ZONE player	ROADBR1
		IF LOCATE_PLAYER_IN_CAR_2D player 940.4 -933.7 4.0 4.0 0 //BETWEEN CALLAHAN BRIDGE
			usj_number = 1
			camera_x = 998.0
			camera_y = -938.5
			camera_z = 19.3
			GOTO the_jump
		ENDIF
		IF LOCATE_PLAYER_IN_CAR_3D player 793.17 -929.963 42.166 4.0 2.0 3.0 0 //OVER CALLAHAN BRIDGE
			usj_number = 11
			camera_x = 841.8475//853.8542
			camera_y = -930.1524//-927.6523
			camera_z = 34.3645//34.0808
			GOTO the_jump
		ENDIF
	ENDIF

	IF IS_PLAYER_IN_ZONE player	PORT_S
		IF LOCATE_PLAYER_IN_CAR_2D player 1168.983 -1156.913 10.0 7.0 0//1156.0 -1154.0 4.0 8.0 0 //OVER DOCKS
			usj_number = 2
			camera_x = 1217.2
			camera_y = -1162.4
			camera_z = 15.0
			GOTO the_jump
		ENDIF
		IF LOCATE_PLAYER_IN_CAR_2D player 1231.858 -1129.855 4.0 2.5 0 //OVER WAREHOUSE NEAR RAVE
			usj_number = 5
			camera_x = 1201.384
			camera_y = -1135.662
			camera_z = 19.64
			GOTO the_jump
		ENDIF
	ENDIF
	
	IF IS_PLAYER_IN_ZONE player	CHINA
		IF LOCATE_PLAYER_IN_CAR_2D player 789.697 -572.312 2.7 5.0 0 // OVER FOOTBRIDGE
			usj_number = 3
			camera_x = 779.957
			camera_y = -561.1698
			camera_z = 25.1615
			GOTO the_jump
		ENDIF
		IF LOCATE_PLAYER_IN_CAR_3D player 991.727 -470.397 19.785 2.0 4.0 3.0 0	//ONTO LTRAIN TRACKS BY SUBWAY
			usj_number = 10
			camera_x = 987.5289
			camera_y = -462.6134
			camera_z = 21.8678
			GOTO the_jump
		ENDIF
	ENDIF
	
	IF IS_PLAYER_IN_ZONE player	PORT_I
		IF LOCATE_PLAYER_IN_CAR_2D player 1136.621 -976.864 4.0 2.5 0 //OVER FREIGHT BACKS
			usj_number = 6
			camera_x = 1107.076 
			camera_y = -964.015
			camera_z =  22.981
			GOTO the_jump
		ENDIF
	ENDIF
	
	IF IS_PLAYER_IN_ZONE player	PORT_E
		IF LOCATE_PLAYER_IN_CAR_2D player 1375.758 -952.149 5.0 5.0 0 //OVER WAREHOUSE BY SAWMILLS
			usj_number = 7
			camera_x = 1369.274 
			camera_y = -981.598
			camera_z = 18.734
			GOTO the_jump
		ENDIF
	ENDIF

	GOTO mission_start_usj
ENDIF

IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
	IF IS_PLAYER_IN_ZONE player	COM_EAS
		IF LOCATE_PLAYER_IN_CAR_3D player 470.728 -918.38 19.828 6.0 3.0 3.0 0 //UNDER CALLAHAN BRIDGE
			usj_number = 4
			camera_x = 460.954
			camera_y = -947.844
			camera_z = 17.934
			GOTO the_jump
		ENDIF
		IF LOCATE_PLAYER_IN_CAR_2D player 271.152 -607.027 4.0 5.0 0 //OUT OF CARPARK
			usj_number = 13
			camera_x = 281.8645
			camera_y = -626.5409
			camera_z = 26.9559
			GOTO the_jump
		ENDIF
		IF LOCATE_PLAYER_IN_CAR_2D player 320.223 -896.357 6.0 5.0 0 //ONTO CALLAHAN BRIDGE
			usj_number = 14
			camera_x = 332.8589
			camera_y = -906.3721
			camera_z = 39.7656
			GOTO the_jump
		ENDIF
	ENDIF
	IF IS_PLAYER_IN_ZONE player	PARK
		IF LOCATE_PLAYER_IN_CAR_3D player 157.584 -998.192 30.39 2.5 2.8 2.0 0//159.987 -998.158 30.379 0.5 2.8 2.0 0 //TWAT CAFE
			usj_number = 12
			camera_x = 141.5205
			camera_y = -1006.8531
			camera_z = 26.177
			GOTO the_jump
		ENDIF
	ENDIF
	GOTO mission_start_usj
ENDIF

IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	
	IF IS_PLAYER_IN_ZONE player SUB_IND
		IF LOCATE_PLAYER_IN_CAR_3D player -1182.442 22.213 74.03 3.0 4.0 3.0 0 //BAIT WAREHOUSE GOING EAST
			usj_number = 8
			camera_x = -1204.47
			camera_y = -14.721
			camera_z = 62.1738
			GOTO the_jump
		ENDIF
	ENDIF
	
	IF IS_PLAYER_IN_ZONE player BIG_DAM
		IF LOCATE_PLAYER_IN_CAR_3D player -1160.622 105.944 73.531 4.0 3.5 3.0 0 //BAIT WAREHOUSE GOING SOUTH
			usj_number = 9
			camera_x = -1137.7355
			camera_y = 115.1705
			camera_z = 64.4229
			GOTO the_jump
		ENDIF
		IF LOCATE_PLAYER_IN_CAR_2D player -994.754 253.616 10.0 15.0 0 //BY COCHRANE BRIDGE
			usj_number = 15
			camera_x = -1014.4852//-1039.1022
			camera_y = 268.1786//265.3116
			camera_z = 38.8862//3.4568
			GOTO the_jump
		ENDIF
	ENDIF

	IF IS_PLAYER_IN_ZONE player PROJECT
		IF LOCATE_PLAYER_IN_CAR_2D player -699.058 -172.26 6.0 7.0 0 //	JAMES BOND BRIDGE
			usj_number = 16
			camera_x = -738.03
			camera_y = -132.5792
			camera_z = 12.501
			GOTO the_jump
		ENDIF
	ENDIF

	IF IS_PLAYER_IN_ZONE player AIRPORT
		IF LOCATE_PLAYER_IN_CAR_2D player -1100.542 -847.44 4.0 12.0 0 // AIRPORT HANGAR SE
			usj_number = 17
			camera_x = -1068.0343
			camera_y = -863.0062
			camera_z = 18.4249
			GOTO the_jump
		ENDIF
		IF LOCATE_PLAYER_IN_CAR_2D player -1375.772 -848.662 4.0 12.0 0 // AIRPORT HANGAR SW
			usj_number = 18
			camera_x = -1337.7358
			camera_y = -862.9677
			camera_z = 18.0594
			GOTO the_jump
		ENDIF
		IF LOCATE_PLAYER_IN_CAR_2D player -1379.849 -625.095 12.0 4.0 0 // AIRPORT HANGAR NW
			usj_number = 19
			camera_x = -1397.5281
			camera_y = -572.0431
			camera_z = 18.8811
			GOTO the_jump
		ENDIF
		IF LOCATE_PLAYER_IN_CAR_2D player -1177.38 -569.913 3.3 2.0 0 // AIRPORT PLANE
			usj_number = 20
			camera_x = -1195.1605//-1192.1388
			camera_y = -560.7097//-556.9338
			camera_z = 18.9029//11.134
			GOTO the_jump
		ENDIF
	ENDIF

	GOTO mission_start_usj
ENDIF

GOTO mission_start_usj

the_jump:

flag_1st_locate_usj = 0 
flag_2nd_locate_usj = 0
collision_counter_usj = 0

SET_TIME_SCALE 0.3
SET_FIXED_CAMERA_POSITION camera_x camera_y camera_z 0.0 0.0 0.0
POINT_CAMERA_AT_CAR players_car_usj FIXED JUMP_CUT

WHILE IS_CAR_IN_AIR_PROPER players_car_usj
OR collision_counter_usj < 10

	++ collision_counter_usj
	
	WAIT 0

	IF IS_CAR_DEAD players_car_usj
		GOTO camera_restore_if_fail
	ENDIF
	
	IF IS_CAR_IN_WATER players_car_usj
		GOTO camera_restore_if_fail
	ENDIF
	
	IF NOT IS_PLAYER_PLAYING player
		GOTO camera_restore_if_fail
	ENDIF

	IF NOT IS_PLAYER_IN_ANY_CAR player
		GOTO camera_restore_if_fail
	ENDIF
	
	IF usj_number = 1
		IF LOCATE_PLAYER_IN_CAR_3D player 946.5 -934.1 26.8 1.0	4.0 6.0	0
			flag_1st_locate_usj = 1
		ENDIF

		IF LOCATE_PLAYER_IN_CAR_3D player 993.5 -933.8 21.8 1.0	4.0 6.0	0
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF
													 	 	
	IF usj_number = 2
		IF LOCATE_PLAYER_IN_CAR_3D player 1190.0 -1154.0 25.0 1.0 10.0 10.0	0
			flag_1st_locate_usj = 1
		ENDIF

		IF LOCATE_PLAYER_IN_CAR_3D player 1243.6 -1154.0 13.5 20.0 15.0 3.0	0
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF
	
	IF usj_number = 3
		IF LOCATE_PLAYER_IN_CAR_3D player 789.316 -563.296 29.202 10.0 0.5 5.0 0
			flag_1st_locate_usj = 1
		ENDIF

		IF LOCATE_PLAYER_IN_CAR_3D player 789.316 -558.888 29.202 10.0 0.5 5.0 0
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF
	
	IF usj_number = 4
		IF LOCATE_PLAYER_IN_CAR_3D player 470.728 -931.7 24.828 9.0 0.5 8.0 0
			flag_1st_locate_usj = 1
		ENDIF

		IF LOCATE_PLAYER_IN_CAR_3D player 470.532 -962.841 16.589 6.5 14.5 2.0 0
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF
		
	IF usj_number = 5
		IF LOCATE_PLAYER_IN_CAR_3D player 1205.573 -1124.826 25.819 1.0 15.0 10.0 0
			flag_1st_locate_usj = 1
		ENDIF

		IF LOCATE_PLAYER_IN_CAR_3D player 1182.763 -1124.826 25.819 1.0 15.0 10.0 0
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 6
		IF LOCATE_PLAYER_IN_CAR_3D player 1127.485 -978.877 29.145 1.0 15.0 10.0 0
			flag_1st_locate_usj = 1
		ENDIF

		IF LOCATE_PLAYER_IN_CAR_3D player 1104.808 -978.877 29.145 1.0 15.0 10.0 0
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 7
		IF LOCATE_PLAYER_IN_CAR_3D player 1376.953 -984.634 23.53 8.0 0.5 7.5 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 8
		IF LOCATE_PLAYER_IN_CAR_3D player -1197.722 -41.855 63.732 30.0 5.5 8.0 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 9
		IF LOCATE_PLAYER_IN_CAR_3D player -1095.672 116.771 60.304 16.5 4.0 2.5 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 10
		IF LOCATE_PLAYER_IN_CAR_3D player 995.212 -440.228 26.456 4.3 0.5 5.0 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 11
		IF LOCATE_PLAYER_IN_CAR_3D player 879.708 -933.811 26.845 30.0 5.5 0.5 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 12
		IF LOCATE_PLAYER_IN_CAR_3D player 130.308 -999.861 32.406 0.5 6.0 7.5 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 13
		IF LOCATE_PLAYER_IN_CAR_2D player 271.836 -656.396 5.0 5.0 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 14
		IF LOCATE_PLAYER_IN_CAR_2D player 308.231 -942.208 23.0 5.0 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 15
		IF LOCATE_PLAYER_IN_CAR_2D player -1073.749 246.756 38.0 22.0 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 16
		IF LOCATE_PLAYER_IN_CAR_2D player -706.363 -91.074 18.0 30.0 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 17
		IF LOCATE_PLAYER_IN_CAR_3D player -1067.966 -847.738 27.527 0.5 14.5 10.0 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 18
		IF LOCATE_PLAYER_IN_CAR_3D player -1342.627 -847.864 26.928 0.5 14.5 10.0 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 19
		IF LOCATE_PLAYER_IN_CAR_3D player -1380.287 -573.483 22.686 14.3 0.5 10.0 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF usj_number = 20
		IF LOCATE_PLAYER_IN_CAR_3D player -1184.052 -569.913 24.278 0.5 6.0 8.0 0
			flag_1st_locate_usj = 1
			flag_2nd_locate_usj = 1
		ENDIF
	ENDIF 
	
	IF flag_1st_locate_usj = 1
	AND flag_2nd_locate_usj = 1
		GOTO mission_usj_passed
	ENDIF

ENDWHILE

WHILE IS_CAR_IN_AIR_PROPER players_car_usj
	WAIT 0

	IF IS_CAR_DEAD players_car_usj
		GOTO camera_restore_if_fail
	ENDIF

	IF IS_CAR_IN_WATER players_car_usj
		GOTO camera_restore_if_fail
	ENDIF

	IF NOT IS_PLAYER_PLAYING player
		GOTO camera_restore_if_fail
	ENDIF

	IF NOT IS_PLAYER_IN_ANY_CAR player
		GOTO camera_restore_if_fail
	ENDIF

ENDWHILE

WAIT 600
camera_restore_if_fail:
SET_TIME_SCALE 1.0
RESTORE_CAMERA_JUMPCUT

GOTO mission_start_usj
   
// mission usj1 passed

mission_usj_passed:

WHILE IS_CAR_IN_AIR_PROPER players_car_usj
	WAIT 0

	IF IS_CAR_DEAD players_car_usj
		GOTO camera_restore_if_fail
	ENDIF

	IF IS_CAR_IN_WATER players_car_usj
		GOTO camera_restore_if_fail
	ENDIF

	IF NOT IS_PLAYER_PLAYING player
		GOTO camera_restore_if_fail
	ENDIF

	IF NOT IS_PLAYER_IN_ANY_CAR player
		GOTO camera_restore_if_fail
	ENDIF

ENDWHILE

WAIT 600
camera_restore_if_passed:
SET_TIME_SCALE 1.0
RESTORE_CAMERA_JUMPCUT

IF usj_number = 1
AND	flag_usj1_passed = 0
	flag_usj1_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 2
AND	flag_usj2_passed = 0
	flag_usj2_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 3
AND	flag_usj3_passed = 0
	flag_usj3_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 4
AND	flag_usj4_passed = 0
	flag_usj4_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 5
AND	flag_usj5_passed = 0
	flag_usj5_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 6
AND	flag_usj6_passed = 0
	flag_usj6_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 7
AND	flag_usj7_passed = 0
	flag_usj7_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 8
AND	flag_usj8_passed = 0
	flag_usj8_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 9
AND	flag_usj9_passed = 0
	flag_usj9_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 10
AND	flag_usj10_passed = 0
	flag_usj10_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 11
AND	flag_usj11_passed = 0
	flag_usj11_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 12
AND	flag_usj12_passed = 0
	flag_usj12_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 13
AND	flag_usj13_passed = 0
	flag_usj13_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 14
AND	flag_usj14_passed = 0
	flag_usj14_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 15
AND	flag_usj15_passed = 0
	flag_usj15_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 16
AND	flag_usj16_passed = 0
	flag_usj16_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 17
AND	flag_usj17_passed = 0
	flag_usj17_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 18
AND	flag_usj18_passed = 0
	flag_usj18_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 19
AND	flag_usj19_passed = 0
	flag_usj19_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

IF usj_number = 20
AND	flag_usj20_passed = 0
	flag_usj20_passed = 1
	++ total_completed_usj
	PLAYER_MADE_PROGRESS 1
	GOTO reward_usj
ENDIF

GOTO mission_start_usj

reward_usj:
IF total_completed_usj < 20 
	PRINT_BIG_Q USJ 5000 5 //UNIQUE STUNT BONUS!
	PRINT_WITH_NUMBER_BIG REWARD cash_reward_usj 6000 6
	ADD_SCORE player cash_reward_usj
ELSE
	PRINT_BIG_Q USJ_ALL 5000 5 //ALL UNIQUE STUNTS COMPLETED!
	PRINT_WITH_NUMBER_BIG REWARD 1000000 6000 6
	ADD_SCORE player 1000000
ENDIF

ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_PART_MISSION_COMPLETE

REGISTER_UNIQUE_JUMP_FOUND
cash_reward_usj += 5000
GOTO mission_start_usj

MISSION_END
MISSION_START

VAR_INT tramp1 tramp2 tramp3 tramp4 tramp_is_dead tramps_been_created
VAR_INT	tramp1_dead tramp2_dead tramp3_dead tramp4_dead
VAR_INT has_player_been_in_tramp_tunnel_before 
VAR_INT flag_sounds_added_redlight
VAR_INT	camera_ammu1 camera_ammu2 ammu_sample 
VAR_INT has_player_been_at_fish_before
VAR_INT flag_need_wall_change_km1 ammu_bloke_kill_player
VAR_INT flag_failed_love1 special_ammu_audio 
VAR_INT need_to_clear_area_flag	// VARIABLE FOR PARKED CARS GENERATOR FOR THE MULTISTORY CARPARK IN NEWPORT
VAR_INT fish_triad1 fish_triad2 fish_triad3 fish_triad4 fish_triad5 fish_triad6
VAR_INT flag_sounds_added_dog // Sound effects for the dog food factory
VAR_INT second_floor_cars_exist third_floor_cars_exist fourth_floor_cars_exist fifth_floor_cars_exist

second_floor_cars_exist	= 0
third_floor_cars_exist	= 0
fourth_floor_cars_exist	= 0
fifth_floor_cars_exist	= 0

need_to_clear_area_flag = 0	// VARIABLE FOR PARKED CARS GENERATOR FOR THE MULTISTORY CARPARK IN NEWPORT
has_player_been_at_fish_before = 0 
has_player_been_in_tramp_tunnel_before = 0
flag_sounds_added_redlight = 0
tramps_been_created = 0
tramp_is_dead = 0
camera_ammu1 = 0
camera_ammu2 = 0
flag_sounds_added_dog = 0 // Sound effects for the dog food factory	

//loaded_all_industrial_models_before = 0
//loaded_all_commercial_models_before = 0
//loaded_all_suburban_models_before = 0
flag_failed_love1 = 0
flag_need_wall_change_km1 = 0
flag_player_on_phil_mission = 0
tramp1 = -1
tramp2 = -1
tramp3 = -1
tramp4 = -1
tramp1_dead = 0
tramp2_dead	= 0
tramp4_dead	= 0
tramp3_dead	= 0
ammu_sample = 0
special_ammu_audio = 0
ammu_bloke_kill_player = 0

SCRIPT_NAME	genstuf

SET_DEATHARREST_STATE OFF


mission_start_genstuf:

{
	START_NEW_SCRIPT ind_ammu
	START_NEW_SCRIPT fish_factory_gen
	START_NEW_SCRIPT tramp_tunnel
	START_NEW_SCRIPT ind_sound

	START_NEW_SCRIPT com_ammu
	START_NEW_SCRIPT com_car_park
	START_NEW_SCRIPT dog_sound
	START_NEW_SCRIPT cobblers

	MISSION_END
}

cobblers:
{
WAIT 1000
IF flag_industrial_passed = 1
	REMOVE_PICKUP info_pickup7a
	REMOVE_PICKUP info_pickup8
	REMOVE_PICKUP info_pickup9
	REMOVE_PICKUP info_pickup3
	REMOVE_PICKUP info_pickup4
	REMOVE_PICKUP info_pickup5
	REMOVE_PICKUP info_pickup1
	TERMINATE_THIS_SCRIPT
ENDIF

GOTO cobblers
}

check_info_pickup:
{

LVAR_INT pickup message_num

start_pickup_script:

WHILE NOT HAS_PICKUP_BEEN_COLLECTED pickup
	WAIT 500
ENDWHILE

IF message_num = 1
	PRINT_HELP ( SPRAY )
ENDIF

IF message_num = 2
	PRINT_HELP ( BOMB )
ENDIF

IF message_num = 3
	PRINT_HELP ( AMMU ) 
ENDIF

IF message_num = 4
	PRINT_HELP ( SAVE2 ) 
ENDIF

IF message_num = 5
	PRINT_HELP ( SAVE1 ) 
ENDIF

IF message_num = 6
	PRINT_HELP ( CRUSH )
ENDIF
/*
IF message_num = 7
	PRINT_HELP ( BRIDGE1 )
ENDIF

IF message_num = 8
	PRINT_HELP ( TUNNEL ) 
ENDIF

IF message_num = 9
	PRINT_HELP ( TUBE )
ENDIF

IF message_num = 10
	PRINT_HELP ( A_TRAIN )
ENDIF

WHILE HAS_PICKUP_BEEN_COLLECTED pickup
	WAIT 500
ENDWHILE
*/
GOTO start_pickup_script
}



check_info_pickup_2:
{

LVAR_INT pickup message_num

start_pickup_script_2:

WHILE NOT HAS_PICKUP_BEEN_COLLECTED pickup
	WAIT 500
ENDWHILE

/*
IF message_num = 1
	PRINT_HELP ( SPRAY )
ENDIF

IF message_num = 2
	PRINT_HELP ( BOMB )
ENDIF

IF message_num = 3
	PRINT_HELP ( AMMU ) 
ENDIF

IF message_num = 4
	PRINT_HELP ( SAVE2 ) 
ENDIF

IF message_num = 5
	PRINT_HELP ( SAVE1 ) 
ENDIF

IF message_num = 6
	PRINT_HELP ( CRUSH )
ENDIF
*/
IF message_num = 7
	PRINT_HELP ( BRIDGE1 )
ENDIF

IF message_num = 8
	PRINT_HELP ( TUNNEL ) 
ENDIF

IF message_num = 9
	PRINT_HELP ( TUBE1 )
ENDIF

IF message_num = 10
	
	PRINT_HELP ( L_TRN_1 ) //"Press the~h~ \ button~w~ to ~h~enter ~w~or ~h~exit~w~ a vehicle." 
	
ENDIF

IF message_num = 11
	
	PRINT_HELP ( S_TRN_1 ) //"Press the~h~ \ button~w~ to ~h~enter ~w~or ~h~exit~w~ a vehicle." 
	
ENDIF

/*
WHILE HAS_PICKUP_BEEN_COLLECTED pickup
	WAIT 500
ENDWHILE
*/
GOTO start_pickup_script_2
}

ind_ammu:
{
//	Should be called in mission_start_genstuf

	SCRIPT_NAME I_AMMU

ind_ammu_inner:
	
	WAIT 70

	IF IS_PLAYER_PLAYING Player

		IF IS_PLAYER_IN_ZONE player LITTLEI

			IF IS_PLAYER_IN_AREA_3D player 1066.6 -403.5 14.0 1072.8 -394.0 18.0 FALSE

				IF camera_ammu1 = 0
					SET_PLAYER_CONTROL Player Off
					SET_FADING_COLOUR 1 1 1
					SWITCH_STREAMING OFF
					LOAD_SPECIAL_CHARACTER 4 sam
					SET_MUSIC_DOES_FADE FALSE
					DO_FADE 500 FADE_OUT
					WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 4
						WAIT 0
					ENDWHILE
					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE
					SWITCH_STREAMING ON
					GET_GAME_TIMER current_time
					time_difference = current_time - time_since_murdering_shopkeeper1

					IF time_difference > 60000 
						CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL4 1070.81 -396.97 14.2 ammu_shop_bloke1
						SET_CHAR_PERSONALITY ammu_shop_bloke1 PEDSTAT_TOUGH_GUY 
						SET_CHAR_HEADING ammu_shop_bloke1 170.0
						SET_CHAR_STAY_IN_SAME_PLACE ammu_shop_bloke1 TRUE
						GIVE_WEAPON_TO_CHAR ammu_shop_bloke1 WEAPONTYPE_SHOTGUN 999
						IF IS_PLAYER_PLAYING player
							CHAR_LOOK_AT_PLAYER_ALWAYS ammu_shop_bloke1 Player
						ENDIF
					ENDIF

					UNLOAD_SPECIAL_CHARACTER 4
					SET_FIXED_CAMERA_POSITION 1071.95 -402.8 17.0 0.0 0.0 0.0
					ENABLE_PLAYER_CONTROL_CAMERA
					IF IS_PLAYER_PLAYING player
						POINT_CAMERA_AT_PLAYER player FIXED JUMP_CUT
						CLEAR_AREA 1067.9 -397.3 14.2 1.0 TRUE
			 		   	SET_PLAYER_COORDINATES player 1067.9 -397.3 14.2
						SET_PLAYER_HEADING player 200.0
					ENDIF
					DO_FADE 500 FADE_IN
					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE
					IF IS_PLAYER_PLAYING player
						SET_PLAYER_CONTROL Player on
					ENDIF

					IF NOT IS_CHAR_DEAD ammu_shop_bloke1
						IF special_ammu_audio = 0 
							IF ammu_sample = 0
								SET_CHAR_SAY ammu_shop_bloke1 SOUND_AMMUNATION_CHAT_1
							ENDIF
							IF ammu_sample = 1
								SET_CHAR_SAY ammu_shop_bloke1 SOUND_AMMUNATION_CHAT_2
							ENDIF
							IF ammu_sample = 2
								SET_CHAR_SAY ammu_shop_bloke1 SOUND_AMMUNATION_CHAT_3
							ENDIF
						ENDIF
					ENDIF

					camera_ammu1 = 1
				ELSE	//	camera_ammu1 = 1

					IF IS_PLAYER_SHOOTING player
						IF NOT IS_CHAR_DEAD ammu_shop_bloke1
							IF ammu_bloke_kill_player = 0
								IF IS_PLAYER_PLAYING player
									SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT ammu_shop_bloke1 Player
								ENDIF
								ammu_bloke_kill_player = 1
							ENDIF
						ENDIF
					ENDIF

				ENDIF
			ELSE	//	player not in area (1066.6 -403.5 14.0 1072.8 -394.0 18.0)
				IF camera_ammu1 = 1
					SET_PLAYER_CONTROL Player Off
					DO_FADE 500 FADE_OUT
					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE
					IF IS_CHAR_DEAD	ammu_shop_bloke1
					AND	time_difference > 60000 //time_difference is greater than 60,000 means shopkeeper has been created 
						GET_GAME_TIMER time_since_murdering_shopkeeper1 
					ENDIF
					DELETE_CHAR	ammu_shop_bloke1
					CLEAR_AREA 1063.3 -395.3 14.2 1.0 TRUE
					IF IS_PLAYER_PLAYING player
		 		   		SET_PLAYER_COORDINATES player 1063.3 -395.3 14.2
						SET_PLAYER_HEADING player 90.0
						RESTORE_CAMERA_JUMPCUT
						SET_CAMERA_IN_FRONT_OF_PLAYER
					ENDIF
					DO_FADE 500 FADE_IN
					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE
					SET_MUSIC_DOES_FADE TRUE
					IF IS_PLAYER_PLAYING player
						SET_PLAYER_CONTROL Player on
					ENDIF
					
					ammu_sample ++

					IF ammu_sample > 2
						ammu_sample = 0
					ENDIF
					
					ammu_bloke_kill_player = 0	
					camera_ammu1 = 0
				ENDIF

			ENDIF //IS_PLAYER_IN_AREA_3D
		ELSE	//	not in LITTLEI

			IF camera_ammu1 = 1
				IF IS_CHAR_DEAD	ammu_shop_bloke1
				AND	time_difference > 60000 //time_difference is greater than 30,000 means shopkeeper has been created
					GET_GAME_TIMER time_since_murdering_shopkeeper1 
				ENDIF
				RESTORE_CAMERA_JUMPCUT
				SET_CAMERA_IN_FRONT_OF_PLAYER
				DELETE_CHAR	ammu_shop_bloke1
				SET_MUSIC_DOES_FADE TRUE
				camera_ammu1 = 0
			ENDIF

		ENDIF	//	IF IS_PLAYER_IN_ZONE player LITTLEI

	ENDIF //IS_PLAYER_PLAYING

	GOTO ind_ammu_inner
}


fish_factory_gen:
{
//	Should be called in mission_start_genstuf

	SCRIPT_NAME FISHGEN

fish_factory_gen_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player
		//IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

//FISH FACTORY SET UP
		IF fish_factory_destroyed = 0

			IF IS_PLAYER_IN_ZONE Player PORT_W

			//CREATES A GANG OF TRIADS DOWN AT THE FISH FACTORY
			
				IF has_player_been_at_fish_before = 0
					REQUEST_MODEL PED_GANG_TRIAD_A
					REQUEST_MODEL PED_GANG_TRIAD_B
						WHILE NOT HAS_MODEL_LOADED PED_GANG_TRIAD_A
						OR NOT HAS_MODEL_LOADED PED_GANG_TRIAD_B
							WAIT 0
						ENDWHILE
					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 997.0 -1112.0 -100.0 fish_triad1
					GIVE_WEAPON_TO_CHAR fish_triad1 WEAPONTYPE_PISTOL 100
					//SET_CHAR_THREAT_SEARCH fish_triad1 THREAT_GANG_MAFIA
					SET_CHAR_THREAT_SEARCH fish_triad1 THREAT_PLAYER1

					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 964.0 -1095.0 -100.0 fish_triad2
					GIVE_WEAPON_TO_CHAR fish_triad2 WEAPONTYPE_PISTOL 100
					//SET_CHAR_THREAT_SEARCH fish_triad2 THREAT_GANG_MAFIA
					SET_CHAR_THREAT_SEARCH fish_triad2 THREAT_PLAYER1

					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 982.0 -1085.0 -100.0 fish_triad3
					GIVE_WEAPON_TO_CHAR fish_triad3 WEAPONTYPE_PISTOL 100
					//SET_CHAR_THREAT_SEARCH fish_triad3 THREAT_GANG_MAFIA
					SET_CHAR_THREAT_SEARCH fish_triad3 THREAT_PLAYER1

					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 953.0 -1122.0 -100.0 fish_triad4
					GIVE_WEAPON_TO_CHAR fish_triad4 WEAPONTYPE_PISTOL 100
					//SET_CHAR_THREAT_SEARCH fish_triad4 THREAT_GANG_MAFIA
					SET_CHAR_THREAT_SEARCH fish_triad4 THREAT_PLAYER1

					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 1008.0 -1126.0 -100.0 fish_triad5
					GIVE_WEAPON_TO_CHAR fish_triad5 WEAPONTYPE_PISTOL 100
					//SET_CHAR_THREAT_SEARCH fish_triad5 THREAT_GANG_MAFIA
					SET_CHAR_THREAT_SEARCH fish_triad5 THREAT_PLAYER1

					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 974.0 -1142.0 -100.0 fish_triad6
					GIVE_WEAPON_TO_CHAR fish_triad6 WEAPONTYPE_PISTOL 100
					//SET_CHAR_THREAT_SEARCH fish_triad6 THREAT_GANG_MAFIA
					SET_CHAR_THREAT_SEARCH fish_triad6 THREAT_PLAYER1

					CHAR_WANDER_DIR fish_triad1 0
					CHAR_WANDER_DIR fish_triad2 0
					CHAR_WANDER_DIR fish_triad3 0
					CHAR_WANDER_DIR fish_triad4 0
					CHAR_WANDER_DIR fish_triad5 0
					CHAR_WANDER_DIR fish_triad6 0
					has_player_been_at_fish_before = 1
				ENDIF

			ELSE	//	Player not in PORT_W

				IF has_player_been_at_fish_before = 1
					MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad1
					MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad2
					MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad3
					MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad4
					MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad5
					MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad6

					IF flag_player_on_mission = 0
						MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_A
						MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_B
						has_player_been_at_fish_before = 0
					ENDIF
				ENDIF

			ENDIF //IS PLAYER IN ZONE

		ELSE

			IF has_player_been_at_fish_before = 1
				MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad1
				MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad2
				MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad3
				MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad4
				MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad5
				MARK_CHAR_AS_NO_LONGER_NEEDED fish_triad6

				IF flag_player_on_mission = 0
					MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_A
					MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_B
					has_player_been_at_fish_before = 0
				ENDIF
			ENDIF

		ENDIF  //fish_factory_destroyed

		//ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

	ENDIF //IS_PLAYER_PLAYING

	GOTO fish_factory_gen_inner
}


tramp_tunnel:
{
//	Should be called in mission_start_genstuf

	SCRIPT_NAME TRAMPS

tramp_tunnel_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player
		//IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

//CREATES TRAMPS IN ABANDONED TUNNEL
		IF IS_PLAYER_IN_ZONE Player LITTLEI

			IF IS_PLAYER_IN_AREA_3D Player 1325.0 -512.0 14.0 1315.0 -165.8 17.0 FALSE	
				IF has_player_been_in_tramp_tunnel_before = 0

					REQUEST_MODEL PED_SCUM_MAN
					REQUEST_MODEL PED_SCUM_WOMAN

					WHILE NOT HAS_MODEL_LOADED PED_SCUM_MAN
					OR NOT HAS_MODEL_LOADED PED_SCUM_WOMAN
						WAIT 0
					ENDWHILE

					CREATE_CHAR PEDTYPE_BUM PED_SCUM_MAN 1320.4 -370.0 15.0 tramp1
					GIVE_WEAPON_TO_CHAR tramp1 WEAPONTYPE_MOLOTOV 1
					SET_CHAR_PERSONALITY tramp1 PEDSTAT_GEEK_GUY
					SET_CHAR_THREAT_SEARCH tramp1 THREAT_GUN
					SET_CHAR_THREAT_SEARCH tramp1 THREAT_DEADPEDS

					CREATE_CHAR PEDTYPE_BUM PED_SCUM_WOMAN 1317.0 -365.0 15.0 tramp2
					GIVE_WEAPON_TO_CHAR tramp2 WEAPONTYPE_MOLOTOV 1
					SET_CHAR_HEADING tramp2 290.0
					SET_CHAR_PERSONALITY tramp2 PEDSTAT_GEEK_GUY
					SET_CHAR_THREAT_SEARCH tramp2 THREAT_GUN
					SET_CHAR_THREAT_SEARCH tramp2 THREAT_DEADPEDS

					CREATE_CHAR PEDTYPE_BUM PED_SCUM_WOMAN 1322.4 -367.0 15.0 tramp3
					GIVE_WEAPON_TO_CHAR tramp3 WEAPONTYPE_MOLOTOV 1
					SET_CHAR_HEADING tramp3 57.0
					SET_CHAR_PERSONALITY tramp3 PEDSTAT_GEEK_GUY
					SET_CHAR_THREAT_SEARCH tramp3 THREAT_GUN
					SET_CHAR_THREAT_SEARCH tramp3 THREAT_DEADPEDS

					CREATE_CHAR PEDTYPE_BUM PED_SCUM_MAN 1320.0 -362.0 15.0 tramp4
					GIVE_WEAPON_TO_CHAR tramp4 WEAPONTYPE_MOLOTOV 1
					SET_CHAR_HEADING tramp4 180.0
					SET_CHAR_PERSONALITY tramp4 PEDSTAT_GEEK_GUY
					SET_CHAR_THREAT_SEARCH tramp4 THREAT_GUN
					SET_CHAR_THREAT_SEARCH tramp4 THREAT_DEADPEDS

					MARK_MODEL_AS_NO_LONGER_NEEDED PED_SCUM_MAN
					MARK_MODEL_AS_NO_LONGER_NEEDED PED_SCUM_WOMAN
					
					tramps_been_created = 1
					has_player_been_in_tramp_tunnel_before = 1
				ELSE
					IF tramps_been_created = 1
						IF tramp_is_dead = 0
							IF IS_CHAR_DEAD	tramp1
							OR IS_CHAR_DEAD	tramp2
							OR IS_CHAR_DEAD	tramp3
							OR IS_CHAR_DEAD	tramp4
								timerA = 0
								tramp_is_dead = 1
							ENDIF
						ENDIF
					ENDIF

				ENDIF
			ELSE
				IF has_player_been_in_tramp_tunnel_before = 1
					IF tramps_been_created = 1	
						MARK_CHAR_AS_NO_LONGER_NEEDED tramp1
						MARK_CHAR_AS_NO_LONGER_NEEDED tramp2
						MARK_CHAR_AS_NO_LONGER_NEEDED tramp3
						MARK_CHAR_AS_NO_LONGER_NEEDED tramp4
						tramps_been_created = 0
					ENDIF

					IF tramp_is_dead = 1
						IF timerA > 1440000
							tramp_is_dead = 0
							has_player_been_in_tramp_tunnel_before = 0
						ENDIF
					ELSE
						has_player_been_in_tramp_tunnel_before = 0
					ENDIF
				ENDIF
			ENDIF	//	IF IS_PLAYER_IN_AREA_3D Player 1325.0 -512.0 14.0 1315.0 -165.8 17.0 FALSE

		ELSE	//	IF IS_PLAYER_IN_ZONE Player LITTLEI
			IF has_player_been_in_tramp_tunnel_before = 1
				IF tramps_been_created = 1	
					MARK_CHAR_AS_NO_LONGER_NEEDED tramp1
					MARK_CHAR_AS_NO_LONGER_NEEDED tramp2
					MARK_CHAR_AS_NO_LONGER_NEEDED tramp3
					MARK_CHAR_AS_NO_LONGER_NEEDED tramp4
					tramps_been_created = 0
				ENDIF

				IF tramp_is_dead = 1
					IF timerA > 1440000
						tramp_is_dead = 0
						has_player_been_in_tramp_tunnel_before = 0
					ENDIF
				ELSE
					has_player_been_in_tramp_tunnel_before = 0
				ENDIF
			ENDIF
		ENDIF

		//ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

	ENDIF //IS_PLAYER_PLAYING

	GOTO tramp_tunnel_inner
}

ind_sound:
{
//	Should be called in mission_start_genstuf

	SCRIPT_NAME I_SOUND

ind_sound_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player

		//IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
//TIME OF DAY SOUND EFFECTS	(REDLIGHT)

		IF IS_PLAYER_IN_ZONE Player REDLIGH
			GET_TIME_OF_DAY hours minutes

			IF hours >= 20
			OR hours <= 5
				IF flag_sounds_added_redlight = 0
					ADD_CONTINUOUS_SOUND 891.9 -416.9 16.1 SOUND_STRIP_CLUB_LOOP_2_S sound_loop8 //Luigi's club
					ADD_CONTINUOUS_SOUND 924.2 -464.3 16.0 SOUND_STRIP_CLUB_LOOP_1_S sound_loop9 //Sex Kitten Club
					ADD_CONTINUOUS_SOUND 901.1 -392.0 15.0 SOUND_PORN_CINEMA_1_S sound_loop10 //XXX Cinema1
					ADD_CONTINUOUS_SOUND 901.2 -339.0 10.0 SOUND_PORN_CINEMA_2_S sound_loop11 //XXX Cinema2
					ADD_CONTINUOUS_SOUND 960.1 -379.0 15.0 SOUND_PORN_CINEMA_3_S sound_loop12 //XXX Cinema
					flag_sounds_added_redlight = 1
			    ENDIF
		  	ELSE
			  	IF flag_sounds_added_redlight = 1
		  	  		REMOVE_SOUND sound_loop8
			  		REMOVE_SOUND sound_loop9
			  		REMOVE_SOUND sound_loop10
					REMOVE_SOUND sound_loop11
					REMOVE_SOUND sound_loop12
					flag_sounds_added_redlight = 0
				ENDIF
			ENDIF
		ENDIF	//	IF IS_PLAYER_IN_ZONE Player REDLIGH

		//ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

	ENDIF	//	IF IS_PLAYER_PLAYING Player

	GOTO ind_sound_inner
}


dog_sound:  // Sound effects for the dog food factory
{
//	Should be called in mission_start_genstuf

	SCRIPT_NAME D_SOUND

dog_sound_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING player

		//IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
			
		IF IS_PLAYER_IN_ZONE player PORT_I
			GET_TIME_OF_DAY hours minutes

			IF hours >= 9
			AND hours <= 17
				IF flag_sounds_added_dog = 0
					//Portland Industrial
					ADD_CONTINUOUS_SOUND 1210.9 -802.2 15.0 SOUND_SAWMILL_LOOP_L sound_loop7 //Dog food factory
					flag_sounds_added_dog = 1
			    ENDIF
		  	ELSE
			  	IF flag_sounds_added_dog = 1
		  	  		REMOVE_SOUND sound_loop7
			  		flag_sounds_added_dog = 0
				ENDIF
			ENDIF
		ENDIF	//	IF IS_PLAYER_IN_ZONE Player REDLIGH

		//ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

	ENDIF	//	IF IS_PLAYER_PLAYING Player

	GOTO dog_sound_inner
}

com_ammu:
{
//	Should be called in mission_start_genstuf

	SCRIPT_NAME C_AMMU

com_ammu_inner:

	WAIT 70

	IF IS_PLAYER_PLAYING Player

// AMMU NATION COMMERCIAL

		IF IS_PLAYER_IN_ZONE player COM_EAS

			IF IS_PLAYER_IN_AREA_3D player 353.3 -711.7 24.0 339.8 -722.4 28.0 FALSE
				
				IF camera_ammu2 = 0		
					SET_PLAYER_CONTROL Player Off
					SET_FADING_COLOUR 1 1 1
					SWITCH_STREAMING OFF
					LOAD_SPECIAL_CHARACTER 4 sam
					SET_MUSIC_DOES_FADE FALSE
					DO_FADE 500 FADE_OUT
					WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 4
						WAIT 0
					ENDWHILE
					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE
					SWITCH_STREAMING ON
					GET_GAME_TIMER current_time
					time_difference = current_time - time_since_murdering_shopkeeper1

					IF time_difference > 60000 
						CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL4 350.2 -719.9 25.4 ammu_shop_bloke1
						SET_CHAR_PERSONALITY ammu_shop_bloke1 PEDSTAT_TOUGH_GUY
						SET_CHAR_HEADING ammu_shop_bloke1 70.0
						SET_CHAR_STAY_IN_SAME_PLACE ammu_shop_bloke1 TRUE
						GIVE_WEAPON_TO_CHAR ammu_shop_bloke1 WEAPONTYPE_SHOTGUN 999
						IF IS_PLAYER_PLAYING player
							CHAR_LOOK_AT_PLAYER_ALWAYS ammu_shop_bloke1 Player
						ENDIF
					ENDIF

					UNLOAD_SPECIAL_CHARACTER 4
					SET_FIXED_CAMERA_POSITION 341.74 -720.676 28.019 0.0 0.0 0.0
					ENABLE_PLAYER_CONTROL_CAMERA
					IF IS_PLAYER_PLAYING player
						POINT_CAMERA_AT_PLAYER player FIXED JUMP_CUT
						CLEAR_AREA 350.7 -713.1 26.4 1.0 TRUE
		 		   		SET_PLAYER_COORDINATES player 350.7 -713.1 25.4
						SET_PLAYER_HEADING player 108.0
					ENDIF
					DO_FADE 500 FADE_IN
					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE
					IF IS_PLAYER_PLAYING player
						SET_PLAYER_CONTROL Player on
					ENDIF
					
					IF NOT IS_CHAR_DEAD ammu_shop_bloke1
						IF special_ammu_audio = 0 
							IF ammu_sample = 0
								SET_CHAR_SAY ammu_shop_bloke1 SOUND_AMMUNATION_CHAT_1
							ENDIF
							IF ammu_sample = 1
								SET_CHAR_SAY ammu_shop_bloke1 SOUND_AMMUNATION_CHAT_2
							ENDIF
							IF ammu_sample = 2
								SET_CHAR_SAY ammu_shop_bloke1 SOUND_AMMUNATION_CHAT_3
							ENDIF
						ENDIF
					ENDIF
					
					camera_ammu2 = 1
				ELSE	//	camera_ammu2 = 1

					IF IS_PLAYER_SHOOTING player
						IF NOT IS_CHAR_DEAD ammu_shop_bloke1
							IF ammu_bloke_kill_player = 0
								IF IS_PLAYER_PLAYING player
									SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT ammu_shop_bloke1 Player
								ENDIF
								ammu_bloke_kill_player = 1
							ENDIF
						ENDIF
					ENDIF

				ENDIF

			ELSE	//	player not in area (353.3 -711.7 24.0 340.3 -718.0 28.0)

				IF camera_ammu2 = 1
					SET_PLAYER_CONTROL Player Off
					DO_FADE 500 FADE_OUT
					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE
					IF IS_CHAR_DEAD	ammu_shop_bloke1
					AND	time_difference > 60000 //time_difference is greater than 60,000 means shopkeeper has been created 
						GET_GAME_TIMER time_since_murdering_shopkeeper1 
					ENDIF
					DELETE_CHAR	ammu_shop_bloke1

					CLEAR_AREA 352.0 -708.8 25.4 1.0 TRUE

					IF IS_PLAYER_PLAYING player
		 		   		SET_PLAYER_COORDINATES player 352.0 -708.8 25.4
						SET_PLAYER_HEADING player 0.0
						RESTORE_CAMERA_JUMPCUT
						SET_CAMERA_IN_FRONT_OF_PLAYER
					ENDIF

					DO_FADE 500 FADE_IN
					WHILE GET_FADING_STATUS
						WAIT 0
					ENDWHILE
					SET_MUSIC_DOES_FADE TRUE

					IF IS_PLAYER_PLAYING player
						SET_PLAYER_CONTROL Player on
					ENDIF
					
					ammu_sample ++

					IF ammu_sample > 2
						ammu_sample = 0
					ENDIF
					
					ammu_bloke_kill_player = 0
					camera_ammu2 = 0
				ENDIF 
			ENDIF //IS_PLAYER_IN_AREA_3D

		ELSE	//	player not in COM_EAS

			IF camera_ammu2 = 1
				IF IS_CHAR_DEAD	ammu_shop_bloke1
				AND	time_difference > 60000 //time_difference is greater than 30,000 means shopkeeper has been created
					GET_GAME_TIMER time_since_murdering_shopkeeper1 
				ENDIF
				RESTORE_CAMERA_JUMPCUT
				SET_CAMERA_IN_FRONT_OF_PLAYER
				DELETE_CHAR	ammu_shop_bloke1
				SET_MUSIC_DOES_FADE TRUE
				camera_ammu2 = 0
			ENDIF

		ENDIF	//	IF IS_PLAYER_IN_ZONE player COM_EAS

	ENDIF //IS_PLAYER_PLAYING

	GOTO com_ammu_inner
}




com_car_park:
{
//	Should be called in mission_start_genstuf

	SCRIPT_NAME C_CARP

com_car_park_inner:

	WAIT 250

	IF IS_PLAYER_PLAYING Player

		IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL

		// PARKED CARS GENERATOR FOR THE MULTISTORY CARPARK IN NEWPORT
			IF IS_PLAYER_IN_ZONE player COM_EAS

				IF IS_PLAYER_IN_AREA_3D	player 266.83 -610.93 25.0 306.31 -479.92 30.0 0 // 1ST FLOOR LOCATE
					SET_CAR_DENSITY_MULTIPLIER 0.0
					IF second_floor_cars_exist = 0
						GOSUB second_floor_of_cars
						second_floor_cars_exist = 1
					ENDIF
					IF third_floor_cars_exist = 1
						CLEAR_AREA_OF_CARS 266.83 -610.93 30.4 306.31 -479.92 34.84 // 3RD FLOOR CLEAR
						third_floor_cars_exist = 0
					ENDIF
					IF fourth_floor_cars_exist = 1
						CLEAR_AREA_OF_CARS 306.31 -610.93 32.84 346.81 -479.92 40.0 // 4TH FLOOR CLEAR
						fourth_floor_cars_exist = 0
					ENDIF
					IF fifth_floor_cars_exist = 1
						CLEAR_AREA_OF_CARS 266.83 -610.93 35.23 306.31 -479.92 40.0	// 5TH FLOOR CLEAR
						fifth_floor_cars_exist = 0
					ENDIF
					need_to_clear_area_flag = 1 
				ENDIF

				IF need_to_clear_area_flag > 0
					IF IS_PLAYER_IN_AREA_3D player 306.31 -610.93 28.0 346.81 -479.92 32.42 0 // 2ND FLOOR LOCATE
						IF second_floor_cars_exist = 0
							GOSUB second_floor_of_cars
							second_floor_cars_exist = 1
						ENDIF
						IF third_floor_cars_exist = 0
							GOSUB third_floor_of_cars
							third_floor_cars_exist = 1
						ENDIF
						IF fourth_floor_cars_exist = 1
							CLEAR_AREA_OF_CARS 306.31 -610.93 32.84 346.81 -479.92 40.0 // 4TH FLOOR CLEAR
							fourth_floor_cars_exist = 0
						ENDIF
						IF fifth_floor_cars_exist = 1
							CLEAR_AREA_OF_CARS 266.83 -610.93 35.23 306.31 -479.92 40.0	// 5TH FLOOR CLEAR
							fifth_floor_cars_exist = 0
						ENDIF
						need_to_clear_area_flag = 2
					ENDIF
				ENDIF

				IF need_to_clear_area_flag > 1
					IF IS_PLAYER_IN_AREA_3D player 266.83 -610.93 30.4 306.31 -479.92 34.84 0 // 3RD FLOOR LOCATE
						IF second_floor_cars_exist = 0
							GOSUB second_floor_of_cars
							second_floor_cars_exist = 1
						ENDIF
						IF third_floor_cars_exist = 0
							GOSUB third_floor_of_cars
							third_floor_cars_exist = 1
						ENDIF
						IF fourth_floor_cars_exist = 0
							GOSUB fourth_floor_of_cars
							fourth_floor_cars_exist = 1
						ENDIF
						IF fifth_floor_cars_exist = 1
							CLEAR_AREA_OF_CARS 266.83 -610.93 35.23 306.31 -479.92 40.0	// 5TH FLOOR CLEAR
							fifth_floor_cars_exist = 0
						ENDIF
						need_to_clear_area_flag = 3
					ENDIF
				ENDIF

				IF need_to_clear_area_flag > 2
					IF IS_PLAYER_IN_AREA_3D player 306.31 -610.93 32.84 346.81 -479.92 40.0 0 // 4TH FLOOR LOCATE
						IF second_floor_cars_exist = 1
							CLEAR_AREA_OF_CARS 306.31 -610.93 28.0 346.81 -479.92 32.42 // 2ND FLOOR CLEAR
							second_floor_cars_exist = 0
						ENDIF
						IF third_floor_cars_exist = 0
							GOSUB third_floor_of_cars
							third_floor_cars_exist = 1
						ENDIF
						IF fourth_floor_cars_exist = 0
							GOSUB fourth_floor_of_cars
							fourth_floor_cars_exist = 1
						ENDIF
						IF fifth_floor_cars_exist = 0
							GOSUB fifth_floor_of_cars
							fifth_floor_cars_exist = 1
						ENDIF
						need_to_clear_area_flag = 4
					ENDIF
				ENDIF

				IF need_to_clear_area_flag > 3
					IF IS_PLAYER_IN_AREA_3D player 266.83 -610.93 35.23 306.31 -479.92 40.0 0 // 5TH FLOOR LOCATE
						IF second_floor_cars_exist = 1
							CLEAR_AREA_OF_CARS 306.31 -610.93 28.0 346.81 -479.92 32.42 // 2ND FLOOR CLEAR
							second_floor_cars_exist = 0
						ENDIF
						IF third_floor_cars_exist = 1
							CLEAR_AREA_OF_CARS 266.83 -610.93 30.4 306.31 -479.92 34.84 // 3RD FLOOR CLEAR
							third_floor_cars_exist = 0
						ENDIF
						IF fourth_floor_cars_exist = 0
							GOSUB fourth_floor_of_cars
							fourth_floor_cars_exist = 1
						ENDIF
						IF fifth_floor_cars_exist = 0
							GOSUB fifth_floor_of_cars
							fifth_floor_cars_exist = 1
						ENDIF
						need_to_clear_area_flag = 5
					ENDIF
				ENDIF

				IF need_to_clear_area_flag > 0
					IF NOT IS_PLAYER_IN_AREA_3D player 266.83 -610.93 25.0 346.81 -479.92 40.0 0 // ENTIRE CARPARK LOCATE
						SET_CAR_DENSITY_MULTIPLIER 1.0
						CLEAR_AREA_OF_CARS 306.31 -610.93 28.0 346.81 -479.92 32.42 // 2ND FLOOR CLEAR
						CLEAR_AREA_OF_CARS 266.83 -610.93 30.4 306.31 -479.92 34.84 // 3RD FLOOR CLEAR
						CLEAR_AREA_OF_CARS 306.31 -610.93 32.84 346.81 -479.92 40.0 // 4TH FLOOR CLEAR
						CLEAR_AREA_OF_CARS 266.83 -610.93 35.23 306.31 -479.92 40.0	// 5TH FLOOR CLEAR
						second_floor_cars_exist = 0
						third_floor_cars_exist  = 0
						fourth_floor_cars_exist = 0
						fifth_floor_cars_exist	= 0
						need_to_clear_area_flag = 0
					ENDIF
				ENDIF
			ENDIF //IS_PLAYER_IN_ZONE player COM_EAS // CARPARK STUFF

		ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
		IF need_to_clear_area_flag > 0
			IF NOT IS_PLAYER_IN_AREA_3D player 266.83 -610.93 25.0 346.81 -479.92 40.0 0 // ENTIRE CARPARK LOCATE
				SET_CAR_DENSITY_MULTIPLIER 1.0
				CLEAR_AREA_OF_CARS 306.31 -610.93 28.0 346.81 -479.92 32.42 // 2ND FLOOR CLEAR
				CLEAR_AREA_OF_CARS 266.83 -610.93 30.4 306.31 -479.92 34.84 // 3RD FLOOR CLEAR
				CLEAR_AREA_OF_CARS 306.31 -610.93 32.84 346.81 -479.92 40.0 // 4TH FLOOR CLEAR
				CLEAR_AREA_OF_CARS 266.83 -610.93 35.23 306.31 -479.92 40.0	// 5TH FLOOR CLEAR
				second_floor_cars_exist = 0
				third_floor_cars_exist  = 0
				fourth_floor_cars_exist = 0
				fifth_floor_cars_exist	= 0
				need_to_clear_area_flag = 0
			ENDIF
		ENDIF
	ENDIF //IS_PLAYER_PLAYING

	GOTO com_car_park_inner
}

second_floor_of_cars://////////////////////////////////////////////
	CREATE_RANDOM_CAR_FOR_CAR_PARK 311.5469 -510.2604 28.1100 91.0159 	  // 2ND FLOOR CARS
	CREATE_RANDOM_CAR_FOR_CAR_PARK 323.5103 -526.5427 28.1100 270.3409 
	CREATE_RANDOM_CAR_FOR_CAR_PARK 342.6624 -542.3556 28.1100 268.3777 
	CREATE_RANDOM_CAR_FOR_CAR_PARK 310.4375 -574.6250 28.0625 269.4375  		// WDSCRIPTMATCH ADDED
	//CREATE_RANDOM_CAR_FOR_CAR_PARK 311.4912 -554.4299 28.1100 91.0689			// WDSCRIPTMATCH REMOVED
	//CREATE_RANDOM_CAR_FOR_CAR_PARK 310.4685 -574.6492 28.1100 269.4606		// WDSCRIPTMATCH REMOVED
	//CREATE_RANDOM_CAR_FOR_CAR_PARK 342.7477 -590.4939 28.1100 268.4776		// WDSCRIPTMATCH REMOVED
RETURN/////////////////////////////////////////////////////////////

third_floor_of_cars:///////////////////////////////////////////////
	CREATE_RANDOM_CAR_FOR_CAR_PARK 302.2802 -580.5526 30.5114  270.3723   // 3RD FLOOR CARS
	CREATE_RANDOM_CAR_FOR_CAR_PARK 289.5574 -564.5915 30.5114 88.0410 
	CREATE_RANDOM_CAR_FOR_CAR_PARK 283.8795 -548.4308 30.5114 92.5479 
	//CREATE_RANDOM_CAR_FOR_CAR_PARK 270.6312 -528.4613 30.5114 88.6249 		// WDSCRIPTMATCH REMOVED
	//CREATE_RANDOM_CAR_FOR_CAR_PARK 301.5385 -484.7673 30.3863 271.6668 		// WDSCRIPTMATCH REMOVED
RETURN/////////////////////////////////////////////////////////////

fourth_floor_of_cars://////////////////////////////////////////////
	CREATE_RANDOM_CAR_FOR_CAR_PARK 311.0863 -512.6859 32.8451 91.1545 	  // 4TH FLOOR CARS
	CREATE_RANDOM_CAR_FOR_CAR_PARK 342.6769 -536.3028 32.8375 266.6709 
	CREATE_RANDOM_CAR_FOR_CAR_PARK 311.4744 -564.1841 32.8375 267.5539 
	//CREATE_RANDOM_CAR_FOR_CAR_PARK 330.5274 -584.3387 32.8375 267.7581 		// WDSCRIPTMATCH REMOVED
	//CREATE_RANDOM_CAR_FOR_CAR_PARK 342.9128 -600.6630 32.8375 87.2900 		// WDSCRIPTMATCH REMOVED
RETURN/////////////////////////////////////////////////////////////

fifth_floor_of_cars:///////////////////////////////////////////////
	CREATE_RANDOM_CAR_FOR_CAR_PARK 282.3572 -582.5417 35.2389 267.0331 	 // 5TH FLOOR CARS
	CREATE_RANDOM_CAR_FOR_CAR_PARK 302.7462 -574.5422 35.2465 271.0973
	CREATE_RANDOM_CAR_FOR_CAR_PARK 283.187500 -502.750000 35.187500 89.437500 		// WDSCRIPTMATCH ADDED
	CREATE_RANDOM_CAR_FOR_CAR_PARK 302.375000 -485.500000 35.187500 266.000000 		// WDSCRIPTMATCH ADDED
	//CREATE_RANDOM_CAR_FOR_CAR_PARK 270.9382 -530.4745 35.2389 88.3213  		// WDSCRIPTMATCH REMOVED
	//CREATE_RANDOM_CAR_FOR_CAR_PARK 303.2198 -510.6057 35.2389 88.6673  		// WDSCRIPTMATCH REMOVED
	//CREATE_RANDOM_CAR_FOR_CAR_PARK 283.2274 -502.7662 35.2389 89.4868 		// WDSCRIPTMATCH REMOVED
	//CREATE_RANDOM_CAR_FOR_CAR_PARK 302.4006 -485.5503 35.2389 266.0503		// WDSCRIPTMATCH REMOVED
RETURN/////////////////////////////////////////////////////////////


/*
check_for_dead_peds_in_genstuf:

IF IS_CHAR_DEAD tramp1
	tramp1_dead = 1
ELSE
	tramp1_dead = 0
ENDIF

IF IS_CHAR_DEAD tramp2
	tramp2_dead = 1
ELSE
	tramp2_dead = 0
ENDIF

IF IS_CHAR_DEAD tramp3
	tramp3_dead = 1
ELSE
	tramp3_dead = 0
ENDIF

IF IS_CHAR_DEAD tramp4
	tramp4_dead = 1
ELSE
	tramp4_dead = 0
ENDIF
RETURN
*/
MISSION_START

SET_DEATHARREST_STATE OFF

SCRIPT_NAME rampage

VAR_INT rampage_reward frenzy_status total_rampages_passed

VAR_INT rampage_01 rampage_02 rampage_03 rampage_04 rampage_05 
VAR_INT rampage_06 rampage_07 rampage_08 rampage_09 rampage_10 
VAR_INT rampage_11 rampage_12 rampage_13 rampage_14 rampage_15 
VAR_INT rampage_16 rampage_17 rampage_18 rampage_19 rampage_20

VAR_INT rampage_01_flag rampage_02_flag rampage_03_flag rampage_04_flag rampage_05_flag
VAR_INT rampage_06_flag rampage_07_flag rampage_08_flag rampage_09_flag rampage_10_flag
VAR_INT rampage_11_flag rampage_12_flag rampage_13_flag	rampage_14_flag rampage_15_flag
VAR_INT rampage_16_flag rampage_17_flag rampage_18_flag	rampage_19_flag rampage_20_flag

VAR_INT rampage_01_failed rampage_02_failed rampage_03_failed rampage_04_failed rampage_05_failed
VAR_INT rampage_06_failed rampage_07_failed rampage_08_failed rampage_09_failed rampage_10_failed
VAR_INT rampage_11_failed rampage_12_failed rampage_13_failed rampage_14_failed rampage_15_failed
VAR_INT rampage_16_failed rampage_17_failed rampage_18_failed rampage_19_failed rampage_20_failed

VAR_INT rampage_01_kills rampage_02_kills rampage_03_kills rampage_04_kills rampage_05_kills
VAR_INT rampage_06_kills rampage_07_kills rampage_08_kills rampage_09_kills rampage_10_kills
VAR_INT rampage_11_kills rampage_12_kills rampage_13_kills rampage_14_kills rampage_15_kills
VAR_INT rampage_16_kills rampage_17_kills rampage_18_kills rampage_19_kills rampage_20_kills

rampage_reward = 5000
frenzy_status = 0
total_rampages_passed = 0

rampage_01_flag = 0
rampage_02_flag = 0
rampage_03_flag = 0
rampage_04_flag = 0
rampage_05_flag = 0
rampage_06_flag = 0
rampage_07_flag = 0
rampage_08_flag = 0
rampage_09_flag = 0
rampage_10_flag = 0
rampage_11_flag = 0
rampage_12_flag = 0
rampage_13_flag = 0
rampage_14_flag = 0
rampage_15_flag = 0
rampage_16_flag = 0
rampage_17_flag = 0
rampage_18_flag = 0
rampage_19_flag = 0
rampage_20_flag = 0

rampage_01_failed = 0
rampage_02_failed = 0
rampage_03_failed = 0
rampage_04_failed = 0
rampage_05_failed = 0
rampage_06_failed = 0
rampage_07_failed = 0
rampage_08_failed = 0
rampage_09_failed = 0
rampage_10_failed = 0
rampage_11_failed = 0
rampage_12_failed = 0
rampage_13_failed = 0
rampage_14_failed = 0
rampage_15_failed = 0
rampage_16_failed = 0
rampage_17_failed = 0
rampage_18_failed = 0
rampage_19_failed = 0
rampage_20_failed = 0

CREATE_PICKUP killfrenzy PICKUP_ONCE  958.0 -431.0 14.5 rampage_01  //OPPOSITE LUIGI'S IN AN ALLEYWAY
CREATE_PICKUP killfrenzy PICKUP_ONCE 1076.9 -859.9 15.2 rampage_02  //BOTTOM OF CALAHAN BRIDGE
CREATE_PICKUP killfrenzy PICKUP_ONCE 1312.3 -315.7 42.6 rampage_03  //ST MARKS BEHIND TONI'S
CREATE_PICKUP killfrenzy PICKUP_ONCE  883.3 -806.2 15.0 rampage_04  //BEHIND BUILDING CHINATOWN NEAR BRIDGE
CREATE_PICKUP killfrenzy PICKUP_ONCE 1274.7 -742.7 15.0 rampage_05  //IN ALLEY NEAR DOG FOOD FACTORY
CREATE_PICKUP killfrenzy PICKUP_ONCE 1195.3 -497.9 39.3 rampage_06  //ON TOP TRAIN TRACKS BY HOSPITAL

CREATE_PICKUP killfrenzy PICKUP_ONCE  204.1 -1237.4 45.1 rampage_07  //ON ROOF ON AMCO BUILDING COMMERCIAL
CREATE_PICKUP killfrenzy PICKUP_ONCE  -22.1 -1526.9 26.1 rampage_08  //CARPARK AREA OPPOSITE LOVES BUILDING
CREATE_PICKUP killfrenzy PICKUP_ONCE    8.0  -910.0 26.5 rampage_09  //SOUTH WEST CORNER OF PARK
CREATE_PICKUP killfrenzy PICKUP_ONCE  181.1  -338.2 16.5 rampage_10  //BEHIND UNIVERSITY	SOUTH
CREATE_PICKUP killfrenzy PICKUP_ONCE  -57.5 -1070.8 26.3 rampage_11  //IN GRAVEYARD BY CATHEDRAL
CREATE_PICKUP killfrenzy PICKUP_ONCE  392.9  -795.4 31.3 rampage_12  //BETWEEN OVERPASS LANES NEAR ASUKA'S KENDO
CREATE_PICKUP killfrenzy PICKUP_ONCE  -41.6  -451.8 16.6 rampage_13  //BEHIND FIRESTATION

CREATE_PICKUP killfrenzy PICKUP_ONCE -585.4  284.7 64.0 rampage_14  //BEHIND A GARAGE IN THE MANSION AREA SUBURBIA
CREATE_PICKUP killfrenzy PICKUP_ONCE -560.3  -23.6  9.3 rampage_15  //ONTOP OF A GARAGE IN THE PROJECTS AREA UNDER OVERPASS
CREATE_PICKUP killfrenzy PICKUP_ONCE -867.0 -145.4 49.8 rampage_16  //ONTOP OF WAREHOUSE PIKE CREEK AIRPORT END
CREATE_PICKUP killfrenzy PICKUP_ONCE -705.9 -617.5 16.4 rampage_17  //BEHIND BILLBOARD AT AIRPORT
CREATE_PICKUP killfrenzy PICKUP_ONCE -987.7 -206.1 33.6 rampage_18  //BEHIND A GUARD BOX SOUTH PIKE CREEK
CREATE_PICKUP killfrenzy PICKUP_ONCE -1186.3  41.0 68.8 rampage_19  //BEHIND BOX IN THE BAIT WAREHOUSE
CREATE_PICKUP killfrenzy PICKUP_ONCE -431.6  110.9 15.6 rampage_20  //BEHIND BILLBOARD NORTH PROJECTS

SET_TOTAL_NUMBER_OF_KILL_FRENZIES 20

rampage_01_kills = 30
rampage_02_kills = 13
rampage_03_kills = 20
rampage_04_kills = 25
rampage_05_kills = 20
rampage_06_kills = 10
rampage_07_kills = 17
rampage_08_kills = 25
rampage_09_kills = 8
rampage_10_kills = 15
rampage_11_kills = 30
rampage_12_kills = 16
rampage_13_kills = 25
rampage_14_kills = 20
rampage_15_kills = 20
rampage_16_kills = 15
rampage_17_kills = 20
rampage_18_kills = 7
rampage_19_kills = 15
rampage_20_kills = 20

//START_KILL_FRENZY StartMessage WeaponType TimeLimit TargetNumber PedOrCarModel ExtraModel1 ExtraModel2 ExtraModel3 FrenzyText
//				   | TEXT LABEL	|		   | MILLISEC |		  	  |	-1 ALL PEDS	 |									 | True	- Has Kill Frenzy text
//				   | 			|		   |		  |			  |	-2 ALL CARS	 |		-1 TO IGNORE THESE			 | False - No text

rampage_pickup_loop:

WAIT 500

//IF IS_GERMAN_GAME
//OR IS_FRENCH_GAME
//	GOTO german_rampage_over
//ENDIF

IF rampage_01_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_01
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_M16 120000 rampage_01_kills PED_GANG_DIABLO_A PED_GANG_DIABLO_B -1 -1 FALSE // "Murder 20 Diablos in 120 seconds!"
		REQUEST_MODEL PED_GANG_DIABLO_A
		REQUEST_MODEL PED_GANG_DIABLO_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_DIABLO
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_01 rampage_01_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_01_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5
			REMOVE_PICKUP rampage_01
			IF rampage_01_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE 987.6 -907.3 15.3 rampage_01  //NEXT TO FUZZBALL
				rampage_01_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE 958.0 -431.0 14.5 rampage_01  //OPPOSITE LUIGI'S IN AN ALLEYWAY
				rampage_01_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_DIABLO_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_DIABLO_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_02_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_02
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_ROCKET 120000 rampage_02_kills -2 -1 -1 -1 FALSE // "Destroy 20 vehicles in 120 seconds!"
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_02 rampage_02_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_02_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5
			REMOVE_PICKUP rampage_02
			IF rampage_02_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE 982.4 -1009.4 14.9 rampage_02  //EAST OF GREASY JOES
				rampage_02_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE 1076.9 -859.9 15.2 rampage_02  //BOTTOM OF CALAHAN BRIDGE
				rampage_02_failed = 0
			ENDIF
		ENDIF
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_03_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_03
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_CHAINGUN 120000 rampage_03_kills PED_GANG_MAFIA_A PED_GANG_MAFIA_B -1 -1 FALSE // "Kill 20 Mafia in 120 seconds!"
		REQUEST_MODEL PED_GANG_MAFIA_A
		REQUEST_MODEL PED_GANG_MAFIA_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_MAFIA
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_03 rampage_03_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_03_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5
			IF rampage_03_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE 1209.5 -380.1 25.5 rampage_03  //JUST SOUTH OF TONI'S BEHIND WALL
				rampage_03_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE 1312.3 -315.7 42.6 rampage_03  //ST MARKS BEHIND TONI'S			
				rampage_03_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_04_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_04
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_UZI 120000 rampage_04_kills PED_GANG_TRIAD_A PED_GANG_TRIAD_B -1 -1 FALSE // "Kill 20 Triads in 120 seconds!"
		REQUEST_MODEL PED_GANG_TRIAD_A
		REQUEST_MODEL PED_GANG_TRIAD_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_TRIAD
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_04 rampage_04_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_04_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_04_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE 1253.9 -572.9 12.5 rampage_04  //SUPASAVE
				rampage_04_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE  883.3 -806.2 15.0 rampage_04  //BEHIND BUILDING CHINATOWN NEAR BRIDGE
				rampage_04_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_05_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_05
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_SHOTGUN 120000 rampage_05_kills PED_GANG_TRIAD_A PED_GANG_TRIAD_B -1 -1 FALSE // "Kill 20 Triads in 120 seconds!"
		REQUEST_MODEL PED_GANG_TRIAD_A
		REQUEST_MODEL PED_GANG_TRIAD_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_TRIAD
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_05 rampage_05_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_05_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_05_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE 1179.2 -566.0 27.3 rampage_05  //ON TOP OF HOSPITAL ROOF
				rampage_05_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE 1274.7 -742.7 15.0 rampage_05  //IN ALLEY NEAR DOG FOOD FACTORY
				rampage_05_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_06_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_06
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_GRENADE 120000 rampage_06_kills -2 -1 -1 -1 FALSE // "Destroy 20 vehicles in 120 seconds!"
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_06 rampage_06_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_06_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_06_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE 1124.6 -816.8 26.5 rampage_06  //ON TOP OF TRAIN TRACKS NEAR FUZZ BALL
				rampage_06_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE 1195.3 -497.9 39.3 rampage_06  //ON TOP TRAIN TRACKS BY HOSPITAL
				rampage_06_failed = 0
			ENDIF
		ENDIF
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_07_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_07
		flag_player_on_mission = 1
		START_KILL_FRENZY_HEADSHOT PAGE_00 WEAPONTYPE_SNIPERRIFLE 120000 rampage_07_kills PED_GANG_YARDIE_A PED_GANG_YARDIE_B -1 -1 FALSE // "Pop 20 Yardie heads in 120 seconds!"
		REQUEST_MODEL PED_GANG_YARDIE_A
		REQUEST_MODEL PED_GANG_YARDIE_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_YARDIE
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_07 rampage_07_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_07_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_07_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  440.3 -1391.2 44.2 rampage_07  //ON TOP OF CASINO
				rampage_07_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE  204.1 -1237.4 45.1 rampage_07  //ON ROOF ON AMCO BUILDING COMMERCIAL
				rampage_07_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YARDIE_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YARDIE_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_08_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_08
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_FLAMETHROWER 120000 rampage_08_kills PED_GANG_YAKUZA_A PED_GANG_YAKUZA_B -1 -1 FALSE // "Burn 20 Yakuza in 120 seconds!"
		REQUEST_MODEL PED_GANG_YAKUZA_A
		REQUEST_MODEL PED_GANG_YAKUZA_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_YAKUZA
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_08 rampage_08_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_08_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_08_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -22.7 -1116.7 26.1 rampage_08  //SOUTH END OF CATHEDRAL
				rampage_08_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -22.1 -1526.9 26.1 rampage_08  //CARPARK AREA OPPOSITE LOVES BUILDING
				rampage_08_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_09_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_09
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_SHOTGUN 120000 rampage_09_kills -2 -1 -1 -1 FALSE // "Destroy 20 vehicles in 120 seconds!"
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_09 rampage_09_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_09_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_09_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE 134.2 -552.8 26.0 rampage_09  //NORTH EAST CORNER OF PARK
				rampage_09_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE   8.0  -910.0 26.5 rampage_09  //SOUTH WEST CORNER OF PARK
				rampage_09_failed = 0
			ENDIF
		ENDIF
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_10_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_10
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_M16 120000 rampage_10_kills -2 -1 -1 -1 FALSE // "Destroy 20 vehicles in 120 seconds!"
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_10 rampage_10_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_10_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_10_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  434.3 -147.8 20.9 rampage_10  //IN CONTRUCTION YARD NE
				rampage_10_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE   181.1  -338.2 16.5 rampage_10  //BEHIND UNIVERSITY	SOUTH
				rampage_10_failed = 0
			ENDIF
		ENDIF
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_11_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_11
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_ROCKET 120000 rampage_11_kills PED_GANG_YARDIE_A PED_GANG_YARDIE_B -1 -1 FALSE // "Annihialate 20 Yardies in 120 seconds!"
		REQUEST_MODEL PED_GANG_YARDIE_A
		REQUEST_MODEL PED_GANG_YARDIE_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_YARDIE
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_11 rampage_11_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_11_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_11_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -101.4 -1386.8 26.3 rampage_11  //BY LIBERTY TREE BUILDING
				rampage_11_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE   -57.5 -1070.8 26.3 rampage_11  //IN GRAVEYARD BY CATHEDRAL
				rampage_11_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YARDIE_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YARDIE_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_12_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_12
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_MOLOTOV 120000 rampage_12_kills PED_GANG_YAKUZA_A PED_GANG_YAKUZA_B -1 -1 FALSE // "Torch 20 Yakuza in 120 seconds!"
		REQUEST_MODEL PED_GANG_YAKUZA_A
		REQUEST_MODEL PED_GANG_YAKUZA_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_YAKUZA
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_12 rampage_12_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_12_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_12_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  374.4  -609.4 26.7 rampage_12  //BEHIND MULTISTOREY
				rampage_12_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE  392.9  -795.4 31.3 rampage_12  //BETWEEN OVERPASS LANES NEAR ASUKA'S KENDO
				rampage_12_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_13_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_13
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_GRENADE 120000 rampage_13_kills PED_GANG_YARDIE_A PED_GANG_YARDIE_B -1 -1 FALSE // "Explode 20 Yardies in 120 seconds!"
		REQUEST_MODEL PED_GANG_YARDIE_A
		REQUEST_MODEL PED_GANG_YARDIE_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_YARDIE
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_13 rampage_13_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_13_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_13_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  176.8  -360.1 16.2 rampage_13  //ALLEYWAY BETWEEN STADIUM AND PARK
				rampage_13_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE   -41.6  -451.8 16.6 rampage_13  //BEHIND FIRESTATION
				rampage_13_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YARDIE_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YARDIE_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_14_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_14
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_FLAMETHROWER 120000 rampage_14_kills PED_GANG_COLOMBIAN_A PED_GANG_COLOMBIAN_B -1 -1 FALSE // "Fry 20 Colombians in 120 seconds!"
		REQUEST_MODEL PED_GANG_COLOMBIAN_A
		REQUEST_MODEL PED_GANG_COLOMBIAN_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_COLOMBIAN
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_14 rampage_14_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_14_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_14_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -1149.2 160.5 58.9 rampage_14  //NORTH PIKE CREEK IN WAREHOUSE COURTYARD
				rampage_14_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -585.4  284.7 64.0 rampage_14  //BEHIND A GARAGE IN THE MANSION AREA SUBURBIA
				rampage_14_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_15_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_15
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_SHOTGUN 120000 rampage_15_kills PED_GANG_HOOD_A PED_GANG_HOOD_B -1 -1 FALSE // "Splatter 20 Hoods in 120 seconds!"
		REQUEST_MODEL PED_GANG_HOOD_A
		REQUEST_MODEL PED_GANG_HOOD_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_HOOD
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_15 rampage_15_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_15_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_15_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -632.1 -413.8 18.0 rampage_15  //BEHIND BILLBOARD NEAR AIRPORT
				rampage_15_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -560.3  -23.6  9.3 rampage_15  //ONTOP OF A GARAGE IN THE PROJECTS AREA UNDER OVERPASS
				rampage_15_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_HOOD_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_HOOD_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_16_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_16
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_ROCKET 120000 rampage_16_kills -2 -1 -1 -1 FALSE // "Destroy 20 vehicles in 120 seconds!"
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_16 rampage_16_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_16_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_16_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -939.0 -303.3 33.6 rampage_16  //BEHIND BILLBOARD BETWEEN AIRPORT & PIKE CREEK
				rampage_16_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -867.0 -145.4 49.8 rampage_16  //ONTOP OF WAREHOUSE PIKE CREEK AIRPORT END
				rampage_16_failed = 0
			ENDIF
		ENDIF
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_17_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_17
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_RUNOVERBYCAR 120000 rampage_17_kills PED_GANG_COLOMBIAN_A PED_GANG_COLOMBIAN_B -1 -1 FALSE // "Splatter 20 Colombians with a car in 120 seconds!"
		REQUEST_MODEL PED_GANG_COLOMBIAN_A
		REQUEST_MODEL PED_GANG_COLOMBIAN_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_COLOMBIAN
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_17 rampage_17_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_17_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_17_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -1181.9 -264.8 46.0 rampage_17  //IN GRASSY HILLY AREA NORTH OF AIRPORT
				rampage_17_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -705.9 -617.5 16.4 rampage_17  //BEHIND BILLBOARD AT AIRPORT
				rampage_17_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_18_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_18
		flag_player_on_mission = 1
		START_KILL_FRENZY PAGE_00 WEAPONTYPE_UZI_DRIVEBY 120000 rampage_18_kills -2 -1 -1 -1 FALSE // "Driveby and Destroy 20 vehicles in 120 seconds!"
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_18 rampage_18_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_18_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_18_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -1080.2 208.4 3.7 rampage_18  //BEHIND ROCK AT BOTTOM OF DAM
				rampage_18_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -987.7 -206.1 33.6 rampage_18  //BEHIND A GUARD BOX SOUTH PIKE CREEK
				rampage_18_failed = 0
			ENDIF
		ENDIF
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_19_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_19
		flag_player_on_mission = 1
		START_KILL_FRENZY_HEADSHOT PAGE_00 WEAPONTYPE_SNIPERRIFLE 120000 rampage_19_kills PED_GANG_COLOMBIAN_A PED_GANG_COLOMBIAN_B -1 -1 FALSE // "Remove 20 Colombian heads in 120 seconds!"
		REQUEST_MODEL PED_GANG_COLOMBIAN_A
		REQUEST_MODEL PED_GANG_COLOMBIAN_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_COLOMBIAN
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_19 rampage_19_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_19_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_19_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -1170.2 -42.2 59.2 rampage_19  //ONTOP OF ROOF SOUTH OF BAIT WAREHOUSE
				rampage_19_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -1186.3  41.0 68.8 rampage_19  //BEHIND BOX IN THE BAIT WAREHOUSE
				rampage_19_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF rampage_20_flag = 0
	IF HAS_PICKUP_BEEN_COLLECTED rampage_20
		flag_player_on_mission = 1
		START_KILL_FRENZY_HEADSHOT PAGE_00 WEAPONTYPE_M16 120000 rampage_20_kills PED_GANG_HOOD_A PED_GANG_HOOD_B -1 -1 FALSE // "Behead 20 Hoods in 120 seconds!"
		REQUEST_MODEL PED_GANG_HOOD_A
		REQUEST_MODEL PED_GANG_HOOD_B
		FORCE_RANDOM_PED_TYPE PEDTYPE_GANG_HOOD
		PRINT_BIG RAMPAGE 5000 5
		PRINT_WITH_NUMBER_BIG PAGE_20 rampage_20_kills 6000 6
		READ_KILL_FRENZY_STATUS frenzy_status
		
		WHILE frenzy_status = 1
			WAIT 0
			READ_KILL_FRENZY_STATUS frenzy_status
		ENDWHILE

		IF frenzy_status = 2
			rampage_20_flag = 1
			GOSUB rampage_rewards
		ENDIF

		IF frenzy_status = 3
			PRINT_BIG RAMP_F 5000 5			
			IF rampage_20_failed = 0
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -798.4 126.0 29.0 rampage_20  //BEHIND BILLBOARD NW PROJECTS
				rampage_20_failed = 1
			ELSE
				CREATE_PICKUP killfrenzy PICKUP_ONCE  -431.6  110.9 15.6 rampage_20  //BEHIND BILLBOARD NORTH PROJECTS
				rampage_20_failed = 0
			ENDIF
		ENDIF
		FORCE_RANDOM_PED_TYPE -1
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_HOOD_A
		MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_HOOD_B
		flag_player_on_mission = 0
	ENDIF
ENDIF

IF total_rampages_passed = 20
	GOTO rampage_passed
ENDIF

GOTO rampage_pickup_loop

rampage_passed:

MISSION_HAS_FINISHED

//german_rampage_over:

PLAYER_MADE_PROGRESS 1
MISSION_END


rampage_rewards:

	++ total_rampages_passed
	rampage_reward = total_rampages_passed * 5000
	CLEAR_WANTED_LEVEL player
	
	IF total_rampages_passed = 10
		USE_TEXT_COMMANDS 125 // HACKED achievement unlock // INSTIGATOR
	ENDIF

	IF total_rampages_passed < 20
		ADD_SCORE player rampage_reward			
		PRINT_BIG RAMP_P 5000 5
		PRINT_WITH_NUMBER_BIG REWARD rampage_reward	6000 6
	ELSE
		ADD_SCORE player 1000000			
		PRINT_BIG RAMP_A 5000 5	//"ALL RAMPAGES COMPLETED!"
		PRINT_WITH_NUMBER_BIG REWARD 1000000 6000 6

		USE_TEXT_COMMANDS 124 // HACKED achievement unlock // BLOOD_IN_THE_STREETS
	ENDIF

RETURN
MISSION_START

//IMPORT EXPORT VARIABLES
VAR_INT imported_car import_car_been_created_before	import_car_type
VAR_INT imported_car2 import_car_been_created_before2 import_car_type2

VAR_INT	industrial_garage_slots_filled create_car_pickups_industrial changed_industrial_garage_before
VAR_INT industrial_slot1 industrial_slot2 industrial_slot3 industrial_slot4 industrial_slot5 industrial_slot6 industrial_slot7 industrial_slot8
VAR_INT industrial_slot9 industrial_slot10 industrial_slot11 industrial_slot12 industrial_slot13 industrial_slot14 industrial_slot15 industrial_slot16
VAR_INT securicar_pickup moonbeam_pickup coach_pickup flatbed_pickup linerunner_pickup trashmaster_pickup patriot_pickup whoopee_pickup
VAR_INT	blista_pickup mule_pickup yankee_pickup	bobcat_pickup dodo_pickup bus_pickup rumpo_pickup pony_pickup
VAR_INT securicar_score_off moonbeam_score_off coach_score_off flatbed_score_off linerunner_score_off trashmaster_score_off patriot_score_off whoopee_score_off
VAR_INT	blista_score_off mule_score_off yankee_score_off bobcat_score_off dodo_score_off bus_score_off rumpo_score_off pony_score_off


VAR_INT	suburban_garage_slots_filled create_car_pickups_suburban changed_suburban_garage_before
VAR_INT suburban_slot1 suburban_slot2 suburban_slot3 suburban_slot4 suburban_slot5 suburban_slot6 suburban_slot7 suburban_slot8
VAR_INT suburban_slot9 suburban_slot10 suburban_slot11 suburban_slot12 suburban_slot13 suburban_slot14 suburban_slot15 suburban_slot16
VAR_INT	sentinet_pickup cheetah_pickup banshee_pickup idaho_pickup infernus_pickup taxi_pickup kuruma_pickup stretch_pickup	 
VAR_INT	perennial_pickup stinger_pickup manana_pickup landstalker_pickup stallion_pickup injection_pickup cabbie_pickup esperanto_pickup	 
VAR_INT	sentinet_score_off cheetah_score_off banshee_score_off idaho_score_off infernus_score_off taxi_score_off kuruma_score_off stretch_score_off	 
VAR_INT	perennial_score_off stinger_score_off manana_score_off landstalker_score_off stallion_score_off injection_score_off cabbie_score_off esperanto_score_off


VAR_INT military_car military_car_been_created_before military_car_type3  
VAR_INT	military_slots_filled create_military_pickups cran_activated_before

VAR_INT	copcar_pickup swatvan_pickup fbi_pickup tank_pickup firetruck_pickup ambulance_pickup barracks_pickup  
	   
VAR_INT number_of_packages_collected bonus_weapons_created

VAR_INT earned_free_pistol earned_free_uzi earned_free_armour earned_free_shotgun earned_free_grenades 
VAR_INT earned_free_molotovs earned_free_ak47 earned_free_sniper earned_free_m16 earned_free_launcher earned_free_flamethrower

VAR_INT bonus_gun1 bonus_gun2 bonus_gun3 bonus_gun4 bonus_gun5 bonus_gun6 bonus_gun7 bonus_gun8 bonus_gun9 bonus_gun10 bonus_gunflame
VAR_INT bonus_bribe1 bonus_bribe2 bonus_bribe3 bonus_bribe4 bonus_bribe5 bonus_bribe6 bonus_health bonus_adrenaline
VAR_INT ind_copcar_kills com_copcar_kills sub_copcar_kills total_saved_peds ambulance_pager_flag play_pager_message1 play_pager_message2 play_pager_message3
VAR_INT ind_fires_exting com_fires_exting sub_fires_exting

earned_free_pistol = 0
earned_free_uzi = 0
earned_free_armour = 0
earned_free_shotgun = 0
earned_free_grenades = 0
earned_free_molotovs = 0
earned_free_ak47 = 0
earned_free_sniper = 0
earned_free_m16 = 0
earned_free_launcher = 0
earned_free_flamethrower = 0
ind_copcar_kills = 0
com_copcar_kills = 0
sub_copcar_kills = 0
ind_fires_exting = 0
com_fires_exting = 0
sub_fires_exting = 0
total_saved_peds = 0

play_pager_message1 = 0
play_pager_message2 = 0
play_pager_message3	= 0
ambulance_pager_flag = 0

bonus_weapons_created = 0

import_car_been_created_before = 0
import_car_been_created_before2 = 0
military_car_been_created_before = 0

industrial_garage_slots_filled = 0
suburban_garage_slots_filled = 0
military_slots_filled = 0

create_car_pickups_industrial = 0
create_car_pickups_suburban = 0
create_military_pickups = 0

changed_suburban_garage_before = 0
changed_industrial_garage_before = 0
cran_activated_before = 0

SCRIPT_NAME	import

SET_DEATHARREST_STATE OFF

//IMPORT EXPORT GARAGE1***************************************************************************************

mission_import_start:

{
	WAIT 100

	START_NEW_SCRIPT import1_loop
	START_NEW_SCRIPT military_crane_loop
	START_NEW_SCRIPT import2_loop
	START_NEW_SCRIPT check_packages

mission_import_start_inner:

	WAIT 500

IF IS_PLAYER_PLAYING player

	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

		IF IS_PLAYER_IN_ZONE player REDLIGH

			IF IS_PLAYER_IN_AREA_3D player 828.9 -283.8 0.0 894.2 -323.5 26.0 FALSE
				IF bonus_weapons_created = 0

					IF earned_free_pistol = 1
						CREATE_PICKUP_WITH_AMMO  WEAPON_COLT45 PICKUP_ON_STREET_SLOW 90 876.8 -317.1 10.0 bonus_gun1
					ENDIF
					IF earned_free_uzi = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_UZI PICKUP_ON_STREET_SLOW 250 874.8 -317.1 10.0 bonus_gun2
					ENDIF
					IF earned_free_grenades = 1										 
						CREATE_PICKUP_WITH_AMMO WEAPON_GRENADE PICKUP_ON_STREET_SLOW 10 872.8 -317.1 10.0 bonus_gun3
					ENDIF
					IF earned_free_shotgun = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_SHOTGUN PICKUP_ON_STREET_SLOW 50 870.8 -317.1 10.0 bonus_gun4
					ENDIF
					IF earned_free_armour = 1
						CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 868.8 -317.1 10.0 bonus_gun5
					ENDIF 
					IF earned_free_molotovs = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_MOLOTOV PICKUP_ON_STREET_SLOW 10 866.8 -317.1 10.0 bonus_gun6
					ENDIF
					IF earned_free_ak47 = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_AK47 PICKUP_ON_STREET_SLOW 300 864.8 -317.1 10.0 bonus_gun7
					ENDIF
					IF earned_free_sniper = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_SNIPER PICKUP_ON_STREET_SLOW 50 862.8 -317.1 10.0 bonus_gun8
					ENDIF
					IF earned_free_m16 = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_M16 PICKUP_ON_STREET_SLOW 600 860.8 -317.1 10.0 bonus_gun9
					ENDIF
					IF earned_free_flamethrower = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_FLAME PICKUP_ON_STREET_SLOW 2000 858.8 -317.1 10.0 bonus_gunflame
					ENDIF
					IF earned_free_launcher = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_ROCKET PICKUP_ON_STREET_SLOW 50 856.8 -317.1 10.0 bonus_gun10
					ENDIF

					IF ind_copcar_kills	> 9
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 877.6 -313.8 8.5 bonus_bribe1
					ENDIF
					
					IF ind_copcar_kills	> 19
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 875.6 -313.8 8.5 bonus_bribe2
					ENDIF
					
					IF com_copcar_kills	> 9
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 873.6 -313.8 8.5 bonus_bribe3
					ENDIF
					
					IF com_copcar_kills	> 19
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 871.6 -313.8 8.5 bonus_bribe4
					ENDIF
					
					IF sub_copcar_kills	> 9
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 869.6 -313.8 8.5 bonus_bribe5
					ENDIF
					
					IF sub_copcar_kills	> 19
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 867.6 -313.8 8.5 bonus_bribe6
					ENDIF
					
					IF total_saved_peds > 34
						CREATE_PICKUP HEALTH PICKUP_ON_STREET_SLOW 878.9 -299.0 8.2 bonus_health
					ENDIF
					
					IF total_saved_peds > 69
						CREATE_PICKUP ADRENALINE PICKUP_ON_STREET_SLOW 876.9 -299.0 8.2 bonus_adrenaline
					ENDIF
					
					bonus_weapons_created = 1
				ENDIF
					
			ELSE	//	player is not in area (828.9 -283.8 0.0 894.2 -323.5 26.0)
										 
				IF bonus_weapons_created = 1
					GOSUB remove_bonus_pickups
					bonus_weapons_created = 0
				ENDIF

			ENDIF	//	IF IS_PLAYER_IN_AREA_3D player 828.9 -283.8 0.0 894.2 -323.5 26.0 FALSE

		ELSE	//	player is not in REDLIGH

			IF bonus_weapons_created = 1
				GOSUB remove_bonus_pickups
				bonus_weapons_created = 0
			ENDIF

		ENDIF	//	IF IS_PLAYER_IN_ZONE player REDLIGH

	ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL


	IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
		
		IF IS_PLAYER_IN_ZONE player PARK

			IF IS_PLAYER_IN_AREA_3D player 39.5 -443.8 53.0 167.5 -484.6 15.0 FALSE
				IF bonus_weapons_created = 0

					IF earned_free_pistol = 1
						CREATE_PICKUP_WITH_AMMO  WEAPON_COLT45 PICKUP_ON_STREET_SLOW 90 132.7 -477.9 15.9 bonus_gun1
					ENDIF
					IF earned_free_uzi = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_UZI PICKUP_ON_STREET_SLOW 250 132.7 -479.9 15.9 bonus_gun2
					ENDIF
					IF earned_free_grenades = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_GRENADE PICKUP_ON_STREET_SLOW 10 129.1 -477.9 15.9 bonus_gun3
					ENDIF
					IF earned_free_shotgun = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_SHOTGUN PICKUP_ON_STREET_SLOW 50 129.1 -479.9 15.9 bonus_gun4
					ENDIF
					IF earned_free_armour = 1
						CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 125.6 -477.9 15.9 bonus_gun5
					ENDIF
					IF earned_free_molotovs = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_MOLOTOV PICKUP_ON_STREET_SLOW 10 125.6 -479.9 15.9 bonus_gun6
					ENDIF
					IF earned_free_ak47 = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_AK47 PICKUP_ON_STREET_SLOW 300 122.1 -477.9 15.9 bonus_gun7
					ENDIF
					IF earned_free_sniper = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_SNIPER PICKUP_ON_STREET_SLOW 50 122.1 -479.9 15.9 bonus_gun8
					ENDIF
					IF earned_free_m16 = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_M16 PICKUP_ON_STREET_SLOW 600 118.7 -477.9 15.9 bonus_gun9
					ENDIF
					IF earned_free_flamethrower = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_FLAME PICKUP_ON_STREET_SLOW 2000 118.7 -479.9 15.9 bonus_gunflame
					ENDIF
					IF earned_free_launcher = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_ROCKET PICKUP_ON_STREET_SLOW 50 125.6 -475.9 15.9 bonus_gun10
					ENDIF
					
					IF ind_copcar_kills	> 9
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 114.5 -458.0 15.5 bonus_bribe1
					ENDIF
					
					IF ind_copcar_kills	> 19
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 112.5 -458.0 15.5 bonus_bribe2
					ENDIF
					
					IF com_copcar_kills	> 9
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 110.5 -458.0 15.5 bonus_bribe3
					ENDIF
					
					IF com_copcar_kills	> 19
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 108.5 -458.0 15.5 bonus_bribe4
					ENDIF
					
					IF sub_copcar_kills	> 9
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 106.5 -458.0 15.5 bonus_bribe5
					ENDIF
					
					IF sub_copcar_kills	> 19
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW 104.5 -458.0 15.5 bonus_bribe6
					ENDIF

					IF total_saved_peds > 34
						CREATE_PICKUP HEALTH PICKUP_ON_STREET_SLOW 94.6 -472.5 15.5 bonus_health
					ENDIF
					
					IF total_saved_peds > 69
						CREATE_PICKUP ADRENALINE PICKUP_ON_STREET_SLOW 92.6 -472.5 15.5 bonus_adrenaline
					ENDIF

					bonus_weapons_created = 1
				ENDIF

			ELSE	//	player is not in area (39.5 -443.8 53.0 167.5 -484.6 15.0)
			
				IF bonus_weapons_created = 1
					GOSUB remove_bonus_pickups
					bonus_weapons_created = 0
				ENDIF

			ENDIF	//	IF IS_PLAYER_IN_AREA_3D player 39.5 -443.8 53.0 167.5 -484.6 15.0 FALSE

		ELSE	//	player is not in PARK

			IF bonus_weapons_created = 1
				GOSUB remove_bonus_pickups
				bonus_weapons_created = 0
			ENDIF
												 
		ENDIF	//	IF IS_PLAYER_IN_ZONE player PARK

	ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL

	
	IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN

		IF IS_PLAYER_IN_ZONE player PROJECT

			IF IS_PLAYER_IN_AREA_3D player -595.8 -68.2 10.0 -700.7 3.1 30.0 FALSE
				IF bonus_weapons_created = 0

					IF earned_free_pistol = 1
						CREATE_PICKUP_WITH_AMMO  WEAPON_COLT45 PICKUP_ON_STREET_SLOW 90 -650.5 -24.8 18.8 bonus_gun1
					ENDIF
					IF earned_free_uzi = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_UZI PICKUP_ON_STREET_SLOW 250 -648.5 -24.8 18.8 bonus_gun2
					ENDIF
					IF earned_free_grenades = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_GRENADE PICKUP_ON_STREET_SLOW 10 -646.5 -24.8 18.8 bonus_gun3
					ENDIF
					IF earned_free_shotgun = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_SHOTGUN PICKUP_ON_STREET_SLOW 50 -644.5 -24.8 18.8 bonus_gun4
					ENDIF
					IF earned_free_armour = 1
						CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW -642.5 -24.8 18.8 bonus_gun5
					ENDIF
					IF earned_free_molotovs = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_MOLOTOV PICKUP_ON_STREET_SLOW 10 -640.5 -24.8 18.8 bonus_gun6
					ENDIF
					IF earned_free_ak47 = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_AK47 PICKUP_ON_STREET_SLOW 300 -638.5 -24.8 18.8 bonus_gun7
					ENDIF
					IF earned_free_sniper = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_SNIPER PICKUP_ON_STREET_SLOW 50 -636.5 -24.8 18.8 bonus_gun8
					ENDIF
					IF earned_free_m16 = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_M16 PICKUP_ON_STREET_SLOW 600 -634.5 -24.8 18.8 bonus_gun9
					ENDIF
					IF earned_free_flamethrower = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_FLAME PICKUP_ON_STREET_SLOW 2000 -632.5 -24.8 18.8 bonus_gunflame
					ENDIF
					IF earned_free_launcher = 1
						CREATE_PICKUP_WITH_AMMO WEAPON_ROCKET PICKUP_ON_STREET_SLOW 20 -630.5 -24.8 18.8 bonus_gun10
					ENDIF

					IF ind_copcar_kills	> 9
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW -663.0 -28.0 18.3 bonus_bribe1
					ENDIF
					
					IF ind_copcar_kills	> 19
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW -665.0 -28.0 18.3 bonus_bribe2
					ENDIF
					
					IF com_copcar_kills	> 9
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW -667.0 -28.0 18.3 bonus_bribe3
					ENDIF
					
					IF com_copcar_kills	> 19
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW -669.0 -28.0 18.3 bonus_bribe4
					ENDIF
					
					IF sub_copcar_kills	> 9
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW -671.0 -28.0 18.3 bonus_bribe5
					ENDIF
					
					IF sub_copcar_kills	> 19
						CREATE_PICKUP BRIBE PICKUP_ON_STREET_SLOW -673.0 -28.0 18.3 bonus_bribe6
					ENDIF

					IF total_saved_peds > 34
						CREATE_PICKUP HEALTH PICKUP_ON_STREET_SLOW -654.3 -21.7 18.3 bonus_health
					ENDIF
					
					IF total_saved_peds > 69
						CREATE_PICKUP ADRENALINE PICKUP_ON_STREET_SLOW -654.3 -19.7 18.3 bonus_adrenaline
					ENDIF

					bonus_weapons_created = 1
				ENDIF
			ELSE	//	player is not in area (-595.8 -68.2 10.0 -700.7 3.1 30.0)
															 
				IF bonus_weapons_created = 1
					GOSUB remove_bonus_pickups
					bonus_weapons_created = 0
				ENDIF

			ENDIF	//	IF IS_PLAYER_IN_AREA_3D player -595.8 -68.2 10.0 -700.7 3.1 30.0 FALSE

		ELSE	//	player is not in PROJECT

			IF bonus_weapons_created = 1
				GOSUB remove_bonus_pickups
				bonus_weapons_created = 0
			ENDIF

		ENDIF	//	IF IS_PLAYER_IN_ZONE player PROJECT

	ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN

ENDIF //IS_PLAYER_PLAYING		

GOTO mission_import_start_inner

}

MISSION_END



import1_loop:
{
//	Should be called in mission_import_start

	SCRIPT_NAME IMPORT1

import1_loop_inner:

	WAIT 500

	IF IS_PLAYER_PLAYING Player

		IF IS_PLAYER_IN_ZONE player PORT_E

			IF NOT industrial_garage_slots_filled = 16

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 1
				AND industrial_slot1 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -674.578 13.582 securicar_score_off
					DONT_REMOVE_OBJECT securicar_score_off
					SET_OBJECT_HEADING securicar_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot1 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 2
				AND industrial_slot2 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -674.578 13.385 moonbeam_score_off
					DONT_REMOVE_OBJECT moonbeam_score_off
					SET_OBJECT_HEADING moonbeam_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot2 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 3
				AND industrial_slot3 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -674.578 13.18 coach_score_off
					DONT_REMOVE_OBJECT coach_score_off
					SET_OBJECT_HEADING coach_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot3 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 4
				AND industrial_slot4 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -674.578 12.972 flatbed_score_off
					DONT_REMOVE_OBJECT flatbed_score_off
					SET_OBJECT_HEADING flatbed_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot4 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 5
				AND industrial_slot5 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -674.578 12.75 linerunner_score_off
					DONT_REMOVE_OBJECT linerunner_score_off
					SET_OBJECT_HEADING linerunner_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot5 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 6
				AND industrial_slot6 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -674.578 12.549 trashmaster_score_off
					DONT_REMOVE_OBJECT trashmaster_score_off
					SET_OBJECT_HEADING trashmaster_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot6 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 7
				AND industrial_slot7 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -674.578 12.35 patriot_score_off
					DONT_REMOVE_OBJECT patriot_score_off
					SET_OBJECT_HEADING patriot_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot7 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 8
				AND industrial_slot8 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -674.578 12.131 whoopee_score_off
					DONT_REMOVE_OBJECT whoopee_score_off
					SET_OBJECT_HEADING whoopee_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot8 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 9
				AND industrial_slot9 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -675.459 13.582 blista_score_off
					DONT_REMOVE_OBJECT blista_score_off
					SET_OBJECT_HEADING blista_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot9 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 10
				AND industrial_slot10 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -675.474 13.361 mule_score_off
					DONT_REMOVE_OBJECT mule_score_off
					SET_OBJECT_HEADING mule_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot10 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 11
				AND industrial_slot11 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -675.474 13.151 yankee_score_off
					DONT_REMOVE_OBJECT yankee_score_off
					SET_OBJECT_HEADING yankee_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot11 = 1
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 12
				AND industrial_slot12 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -675.474 12.966 bobcat_score_off
					DONT_REMOVE_OBJECT bobcat_score_off
					SET_OBJECT_HEADING bobcat_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot12 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 13
				AND industrial_slot13 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -675.474 12.757 dodo_score_off
					DONT_REMOVE_OBJECT dodo_score_off
					SET_OBJECT_HEADING dodo_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot13 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 14
				AND industrial_slot14 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -675.474 12.52 bus_score_off
					DONT_REMOVE_OBJECT bus_score_off
					SET_OBJECT_HEADING bus_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot14 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 15
				AND industrial_slot15 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -675.474 12.322 rumpo_score_off
					DONT_REMOVE_OBJECT rumpo_score_off
					SET_OBJECT_HEADING rumpo_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot15 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars1 16
				AND industrial_slot16 = 0
					industrial_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line 1496.036 -675.474 12.131 pony_score_off
					DONT_REMOVE_OBJECT pony_score_off
					SET_OBJECT_HEADING pony_score_off 270.0
					PLAYER_MADE_PROGRESS 1
					industrial_slot16 = 1 
				ENDIF

			ELSE

		//IF industrial_garage_slots_filled = 16

				IF changed_industrial_garage_before = 0
					CHANGE_GARAGE_TYPE collect_all_cars1 GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE
					changed_industrial_garage_before = 1
				ENDIF

		pick_up_pick_ups:
				WAIT 0

				IF IS_PLAYER_PLAYING player

					IF IS_PLAYER_IN_AREA_2D player 1486.9 -686.2 1524.1 -666.8 FALSE
					
						IF create_car_pickups_industrial = 0
							
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 1 1501.0 -683.0 12.1 securicar_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 2 1505.0 -683.0 12.1 moonbeam_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 3 1509.0 -683.0 12.1 coach_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 4 1513.0 -683.0 12.1 flatbed_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 5 1517.0 -683.0 12.1 linerunner_pickup

							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 6 1521.0 -683.0 12.1 trashmaster_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 7 1521.0 -680.0 12.1 patriot_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 8 1521.0 -677.0 12.1 whoopee_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 9 1521.0 -674.0 12.1 blista_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 10 1521.0 -671.0 12.1 mule_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 11 1521.0 -668.0 12.1 yankee_pickup

							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 12 1517.0 -668.0 12.1 bobcat_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 13 1513.0 -668.0 12.1 dodo_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 14 1509.0 -668.0 12.1 bus_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 15 1505.0 -668.0 12.1 rumpo_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 16 1501.0 -668.0 12.1 pony_pickup
						
							WAIT 1000
							OPEN_GARAGE collect_all_cars1
							create_car_pickups_industrial = 1
						
						ENDIF
					
										
						IF import_car_been_created_before = 0

							IF HAS_PICKUP_BEEN_COLLECTED securicar_pickup
								import_car_type = 118
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED moonbeam_pickup
								import_car_type = 108
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED coach_pickup
								import_car_type = 127
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED flatbed_pickup
								import_car_type = 145
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED linerunner_pickup
								import_car_type = 93
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED trashmaster_pickup
								import_car_type = 98
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED patriot_pickup
								import_car_type = 96
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED whoopee_pickup
								import_car_type = 113 
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED blista_pickup
								import_car_type = 102
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED mule_pickup
								import_car_type = 104
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED yankee_pickup
								import_car_type = 146
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED bobcat_pickup
								import_car_type = 112
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED dodo_pickup
								import_car_type = 126
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED bus_pickup
								import_car_type = 121
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED rumpo_pickup
								import_car_type = 130
								GOTO load_vehicle
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED pony_pickup
								import_car_type = 103
								GOTO load_vehicle
							ENDIF
					
							GOTO pick_up_pick_ups

				load_vehicle:

							PRINT_NOW (IMPORT1) 5000 2
							GOSUB mission_remove_pickups_ind

							IF IS_PLAYER_PLAYING player
								WHILE NOT IS_PLAYER_IN_AREA_2D player 1486.9 -686.2 1495.5 -674.1 FALSE
									WAIT 0
 									IF IS_PLAYER_PLAYING player

									ENDIF
								ENDWHILE
							ENDIF

							IF IS_PLAYER_PLAYING player
								SET_PLAYER_CONTROL Player Off
							ENDIF

							CLOSE_GARAGE collect_all_cars1

							WHILE NOT IS_GARAGE_CLOSED collect_all_cars1
								WAIT 0

							ENDWHILE

							REQUEST_MODEL import_car_type

							WHILE NOT HAS_MODEL_LOADED import_car_type
								WAIT 0

							ENDWHILE 

							CREATE_CAR import_car_type 1504.1 -680.1 12.1 imported_car
							MARK_MODEL_AS_NO_LONGER_NEEDED import_car_type
							SET_CAR_HEADING imported_car 90.0
							LOCK_CAR_DOORS imported_car CARLOCK_UNLOCKED
							WAIT 1000
							OPEN_GARAGE collect_all_cars1
							IF IS_PLAYER_PLAYING Player
								SET_PLAYER_CONTROL Player On
							ENDIF
							import_car_been_created_before = 1

						 ENDIF	//	IF import_car_been_created_before = 0

					ELSE	//	player not in area (1486.9 -686.2 1524.1 -666.8)

						IF create_car_pickups_industrial = 1
							CLOSE_GARAGE collect_all_cars1
								WHILE NOT IS_GARAGE_CLOSED collect_all_cars1
									WAIT 0

								ENDWHILE

							GOSUB mission_remove_pickups_ind

							IF import_car_been_created_before = 1
								IF NOT IS_CAR_DEAD imported_car
									IF IS_CAR_IN_AREA_2D imported_car 1496.8 -686.2 1523.3 -666.8 FALSE
										DELETE_CAR imported_car
		 							ELSE
										MARK_CAR_AS_NO_LONGER_NEEDED imported_car
									ENDIF
								ENDIF
							ENDIF

							import_car_been_created_before = 0
							create_car_pickups_industrial = 0
						ENDIF

					ENDIF //IS_PLAYER_IN_AREA_2D 

				ENDIF //IS_PLAYER_PLAYING

			ENDIF //IF industrial_garage_slots = 16

		ENDIF	//	IF IS_PLAYER_IN_ZONE player PORT_E

	ENDIF	//	IF IS_PLAYER_PLAYING Player

	GOTO import1_loop_inner
}


military_crane_loop:
{
//	Should be called in mission_import_start

	SCRIPT_NAME M_CRANE

military_crane_loop_inner:

	WAIT 500

	IF IS_PLAYER_PLAYING Player

		IF IS_PLAYER_IN_AREA_2D player 1548.1 -745.5 1583.0 -675.1 FALSE 

			IF HAS_MILITARY_CRANE_COLLECTED_ALL_CARS
					
				IF cran_activated_before = 0
					DEACTIVATE_CRANE 1570.3 -675.4
					ACTIVATE_CRANE 1570.3 -675.4 1638.7 -687.1 1647.9 -700.1 1571.1 -696.5 16.0 0.0
					ADD_SCORE player 200000
					PLAYER_MADE_PROGRESS 7
					cran_activated_before = 1
				ENDIF

				IF NOT IS_AREA_OCCUPIED 1565.9 -706.7 9.0 1577.2 -686.3 20.0 FALSE TRUE FALSE FALSE FALSE
					IF create_military_pickups = 0
					AND military_car_been_created_before = 0
						CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 39 1571.0 -687.0 11.8 copcar_pickup
						CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 35 1571.0 -691.0 11.8 swatvan_pickup
						CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 36 1571.0 -694.0 11.8 fbi_pickup
						CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 37 1571.0 -697.0 11.8 tank_pickup
						CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 38 1571.0 -700.0 11.8 barracks_pickup
						CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 34 1571.0 -703.0 11.8 ambulance_pickup
						CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 33 1571.0 -706.0 11.8 firetruck_pickup
						create_military_pickups = 1
					ENDIF
				ENDIF
					
					//IF IS_PLAYER_IN_AREA_2D player 1558.1 -716.4 1583.0 -675.1 FALSE

				IF military_car_been_created_before = 0
			
					IF HAS_PICKUP_BEEN_COLLECTED copcar_pickup
						military_car_type3 = 116
						GOTO load_vehicle3
					ENDIF

					IF HAS_PICKUP_BEEN_COLLECTED swatvan_pickup
						military_car_type3 = 117
						GOTO load_vehicle3
					ENDIF

					IF HAS_PICKUP_BEEN_COLLECTED fbi_pickup
						military_car_type3 = 107
						GOTO load_vehicle3
					ENDIF

					IF HAS_PICKUP_BEEN_COLLECTED barracks_pickup
						military_car_type3 = 123
						GOTO load_vehicle3
					ENDIF

					IF HAS_PICKUP_BEEN_COLLECTED tank_pickup
						military_car_type3 = 122
						GOTO load_vehicle3
					ENDIF

					IF HAS_PICKUP_BEEN_COLLECTED ambulance_pickup
						military_car_type3 = 106
						GOTO load_vehicle3
					ENDIF

					IF HAS_PICKUP_BEEN_COLLECTED firetruck_pickup 
						military_car_type3 = 97
						GOTO load_vehicle3
					ENDIF

					GOTO military_crane_loop_inner //pick_up_pick_ups3

				load_vehicle3:

					GOSUB mission_remove_pickups_military

					REQUEST_MODEL military_car_type3

					WHILE NOT HAS_MODEL_LOADED military_car_type3
						WAIT 0

					ENDWHILE 

					CREATE_CAR military_car_type3 1643.2 -693.2 -100.0 military_car
					MARK_MODEL_AS_NO_LONGER_NEEDED military_car_type3
					SET_CAR_HEADING military_car 0.0
					LOCK_CAR_DOORS military_car CARLOCK_UNLOCKED

					military_car_been_created_before = 1

				ENDIF

			ENDIF	//	IF HAS_MILITARY_CRANE_COLLECTED_ALL_CARS
			
		ELSE	

			IF create_military_pickups = 1
				GOSUB mission_remove_pickups_military
				create_military_pickups = 0
			ENDIF

			IF IS_PLAYER_PLAYING player

				IF military_car_been_created_before = 1

					IF IS_CAR_DEAD military_car
						military_car_been_created_before = 0
					ELSE
						IF NOT IS_CAR_IN_AREA_2D military_car 1668.6 -685.7 1548.1 -745.5 FALSE
							MARK_CAR_AS_NO_LONGER_NEEDED military_car
							military_car_been_created_before = 0
						ENDIF

						IF NOT IS_PLAYER_IN_ZONE player PORT_E
							MARK_CAR_AS_NO_LONGER_NEEDED military_car
							military_car_been_created_before = 0
						ENDIF
					ENDIF
	
				ENDIF

			ENDIF

		ENDIF	//	IF IS_PLAYER_IN_ZONE player PORT_E

	ENDIF //IS_PLAYER_PLAYING

	GOTO military_crane_loop_inner
}


import2_loop:
{
//	Should be called in mission_import_start

	SCRIPT_NAME IMPORT2

import2_loop_inner:

	WAIT 500

	IF IS_PLAYER_PLAYING Player

//IMPORT EXPORT GARAGE2***************************************************************************************

		IF IS_PLAYER_IN_ZONE player BIG_DAM

			IF NOT suburban_garage_slots_filled = 16

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 1
				AND suburban_slot1 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1106.161 151.191 60.529 sentinet_score_off
					DONT_REMOVE_OBJECT sentinet_score_off
					SET_OBJECT_HEADING sentinet_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot1 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 2
				AND suburban_slot2 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1106.161 151.191 60.332 cheetah_score_off
					DONT_REMOVE_OBJECT cheetah_score_off
					SET_OBJECT_HEADING cheetah_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot2 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 3
				AND suburban_slot3 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1106.161 151.191 60.127 banshee_score_off
					DONT_REMOVE_OBJECT banshee_score_off
					SET_OBJECT_HEADING banshee_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot3 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 4
				AND suburban_slot4 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1106.161 151.191 59.919 idaho_score_off
					DONT_REMOVE_OBJECT idaho_score_off
					SET_OBJECT_HEADING idaho_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot4 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 5
				AND suburban_slot5 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1106.161 151.191 59.697 infernus_score_off
					DONT_REMOVE_OBJECT infernus_score_off
					SET_OBJECT_HEADING infernus_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot5 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 6
				AND suburban_slot6 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1106.161 151.191 59.497 taxi_score_off
					DONT_REMOVE_OBJECT taxi_score_off
					SET_OBJECT_HEADING taxi_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot6 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 7
				AND suburban_slot7 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1106.161 151.191 59.298 kuruma_score_off
					DONT_REMOVE_OBJECT kuruma_score_off
					SET_OBJECT_HEADING kuruma_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot7 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 8
				AND suburban_slot8 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1106.161 151.191 59.079 stretch_score_off
					DONT_REMOVE_OBJECT stretch_score_off
					SET_OBJECT_HEADING stretch_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot8 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 9
				AND suburban_slot9 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1107.042 151.191 60.529 perennial_score_off
					DONT_REMOVE_OBJECT perennial_score_off
					SET_OBJECT_HEADING perennial_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot9 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 10
				AND suburban_slot10 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1107.042 151.191 60.309 stinger_score_off
					DONT_REMOVE_OBJECT stinger_score_off
					SET_OBJECT_HEADING stinger_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot10 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 11
				AND suburban_slot11 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1107.042 151.191 60.098 manana_score_off
					DONT_REMOVE_OBJECT manana_score_off
					SET_OBJECT_HEADING manana_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot11 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 12
				AND suburban_slot12 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1107.042 151.191 59.919 landstalker_score_off
					DONT_REMOVE_OBJECT landstalker_score_off
					SET_OBJECT_HEADING landstalker_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot12 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 13
				AND suburban_slot13 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1107.042 151.191 59.697 stallion_score_off
					DONT_REMOVE_OBJECT stallion_score_off
					SET_OBJECT_HEADING stallion_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot13 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 14
				AND suburban_slot14 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1107.042 151.191 59.497 injection_score_off
					DONT_REMOVE_OBJECT injection_score_off
					SET_OBJECT_HEADING injection_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot14 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 15
				AND suburban_slot15 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1107.042 151.191 59.298 cabbie_score_off
					DONT_REMOVE_OBJECT cabbie_score_off
					SET_OBJECT_HEADING cabbie_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot15 = 1 
				ENDIF

				IF HAS_IMPORT_GARAGE_SLOT_BEEN_FILLED collect_all_cars2 16
				AND suburban_slot16 = 0
					suburban_garage_slots_filled ++
					CREATE_OBJECT_NO_OFFSET line -1107.042 151.191 59.079 esperanto_score_off
					DONT_REMOVE_OBJECT esperanto_score_off
					SET_OBJECT_HEADING esperanto_score_off 180.0
					PLAYER_MADE_PROGRESS 1
					suburban_slot16 = 1 
				ENDIF
			ELSE
		//IF suburban_garage_slots_filled = 16

				IF changed_suburban_garage_before = 0
					CHANGE_GARAGE_TYPE collect_all_cars2 GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE
					changed_suburban_garage_before = 1
				ENDIF

		pick_up_pick_ups2:
				WAIT 0

				IF IS_PLAYER_PLAYING player

					IF IS_PLAYER_IN_AREA_2D player -1117.4 158.1 -1098.0 121.5 FALSE
					
						IF create_car_pickups_suburban = 0
							
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 17 -1115.0 145.5 59.0 sentinet_pickup 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 18 -1115.0 142.0 59.0 cheetah_pickup 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 19 -1115.0 138.5 59.0 banshee_pickup 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 20 -1115.0 135.0 59.0 idaho_pickup 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 21 -1115.0 131.5 59.0 infernus_pickup
							 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 22 -1115.0 128.0 59.0 taxi_pickup 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 23 -1112.0 128.0 59.0 kuruma_pickup 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 24 -1109.0 128.0 59.0 stretch_pickup	 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 25 -1106.0 128.0 59.0 perennial_pickup 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 26 -1103.0 128.0 59.0 stinger_pickup
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 27 -1100.0 128.0 59.0 manana_pickup
						 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 28 -1100.0 131.5 59.0 landstalker_pickup 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 29 -1100.0 135.0 59.0 stallion_pickup 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 30 -1100.0 138.5 59.0 injection_pickup 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 31 -1100.0 142.0 59.0 cabbie_pickup 
							CREATE_PICKUP_WITH_AMMO bonus PICKUP_ONCE 32 -1100.0 145.5 59.0 esperanto_pickup

							WAIT 1000
							OPEN_GARAGE collect_all_cars2
							create_car_pickups_suburban = 1
							
						ENDIF
					
								
						IF import_car_been_created_before2 = 0

							IF HAS_PICKUP_BEEN_COLLECTED sentinet_pickup
								import_car_type2 = 95
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED cheetah_pickup
								import_car_type2 = 105
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED banshee_pickup
								import_car_type2 = 119
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED idaho_pickup
								import_car_type2 = 91
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED infernus_pickup
								import_car_type2 = 101
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED taxi_pickup
								import_car_type2 = 110
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED kuruma_pickup
								import_car_type2 = 111 
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED stretch_pickup
								import_car_type2 = 99 
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED perennial_pickup
								import_car_type2 = 94
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED stinger_pickup
								import_car_type2 = 92
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED manana_pickup
								import_car_type2 = 100
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED landstalker_pickup
								import_car_type2 = 90
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED stallion_pickup
								import_car_type2 = 129
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED injection_pickup
								import_car_type2 = 114
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED cabbie_pickup
								import_car_type2 = 128
								GOTO load_vehicle2
							ENDIF

							IF HAS_PICKUP_BEEN_COLLECTED esperanto_pickup
								import_car_type2 = 109
								GOTO load_vehicle2
							ENDIF

							GOTO pick_up_pick_ups2

				load_vehicle2:

							PRINT_NOW (IMPORT1) 5000 2
							GOSUB mission_remove_pickups_sub

							IF IS_PLAYER_PLAYING player
								WHILE NOT IS_PLAYER_IN_AREA_2D player -1117.4 158.1 -1105.0 150.9 FALSE
									WAIT 0
	 								IF IS_PLAYER_PLAYING player

									ENDIF
								ENDWHILE
							ENDIF

							IF IS_PLAYER_PLAYING player
								SET_PLAYER_CONTROL Player Off
							ENDIF

							CLOSE_GARAGE collect_all_cars2

							WHILE NOT IS_GARAGE_CLOSED collect_all_cars2
								WAIT 0

							ENDWHILE

							REQUEST_MODEL import_car_type2

							WHILE NOT HAS_MODEL_LOADED import_car_type2
								WAIT 0

							ENDWHILE 

							CREATE_CAR import_car_type2 -1112.0 143.2 59.0 imported_car2
							MARK_MODEL_AS_NO_LONGER_NEEDED import_car_type2
							SET_CAR_HEADING imported_car2 0.0
							LOCK_CAR_DOORS imported_car2 CARLOCK_UNLOCKED
							WAIT 1000
							OPEN_GARAGE collect_all_cars2
							IF IS_PLAYER_PLAYING Player
								SET_PLAYER_CONTROL Player On
							ENDIF
							import_car_been_created_before2 = 1

						ENDIF	//	IF import_car_been_created_before2 = 0

					ELSE	//	player not in area (-1117.4 158.1 -1098.0 121.5)

						IF create_car_pickups_suburban = 1
							CLOSE_GARAGE collect_all_cars2
								WHILE NOT IS_GARAGE_CLOSED collect_all_cars2
									WAIT 0

								ENDWHILE

							GOSUB mission_remove_pickups_sub

							IF import_car_been_created_before2 = 1
								IF NOT IS_CAR_DEAD imported_car2
									IF IS_CAR_IN_AREA_2D imported_car2 -1117.4 149.8 -1098.0 121.5 FALSE
										DELETE_CAR imported_car2
		 							ELSE
										MARK_CAR_AS_NO_LONGER_NEEDED imported_car2
									ENDIF
								ENDIF
							ENDIF

							import_car_been_created_before2 = 0
							create_car_pickups_suburban = 0
						ENDIF

					ENDIF //IS_PLAYER_IN_AREA_2D 

				ENDIF //IS_PLAYER_PLAYING

			ENDIF	//	IF NOT suburban_garage_slots_filled = 16

		ENDIF	//	IF IS_PLAYER_IN_ZONE player BIG_DAM

	ENDIF //IS_PLAYER_PLAYING

	GOTO import2_loop_inner
}


check_packages:
{
//	Should be called in mission_import_start

	SCRIPT_NAME PACKAGE

	WAIT 300

	GET_COLLECTABLE1S_COLLECTED	number_of_packages_collected

	WHILE number_of_packages_collected < 10
		WAIT 500
		GET_COLLECTABLE1S_COLLECTED	number_of_packages_collected
	ENDWHILE

	PLAYER_MADE_PROGRESS 1
	ADD_PAGER_MESSAGE ( PAGEB1 ) 140 2 0
	earned_free_pistol = 1

	WHILE number_of_packages_collected < 20
		WAIT 500
		GET_COLLECTABLE1S_COLLECTED	number_of_packages_collected
	ENDWHILE

	PLAYER_MADE_PROGRESS 1
	ADD_PAGER_MESSAGE ( PAGEB2 ) 140 2 0
	earned_free_uzi = 1

	WHILE number_of_packages_collected < 30
		WAIT 500
		GET_COLLECTABLE1S_COLLECTED	number_of_packages_collected
	ENDWHILE

	PLAYER_MADE_PROGRESS 1
	ADD_PAGER_MESSAGE ( PAGEB5 ) 140 2 0
	earned_free_grenades = 1

	WHILE number_of_packages_collected < 40
		WAIT 500
		GET_COLLECTABLE1S_COLLECTED	number_of_packages_collected
	ENDWHILE

	PLAYER_MADE_PROGRESS 1
	ADD_PAGER_MESSAGE ( PAGEB4 ) 140 2 0
	earned_free_shotgun = 1

	WHILE number_of_packages_collected < 50
		WAIT 500
		GET_COLLECTABLE1S_COLLECTED	number_of_packages_collected
	ENDWHILE

	PLAYER_MADE_PROGRESS 1
	ADD_PAGER_MESSAGE ( PAGEB3 ) 140 2 0
	earned_free_armour = 1
	
	WHILE number_of_packages_collected < 60
		WAIT 500
		GET_COLLECTABLE1S_COLLECTED	number_of_packages_collected
	ENDWHILE

	PLAYER_MADE_PROGRESS 1
	ADD_PAGER_MESSAGE ( PAGEB6 ) 140 2 0
	earned_free_molotovs = 1

	WHILE number_of_packages_collected < 70
		WAIT 500
		GET_COLLECTABLE1S_COLLECTED	number_of_packages_collected
	ENDWHILE

	PLAYER_MADE_PROGRESS 1
	ADD_PAGER_MESSAGE ( PAGEB7 ) 140 2 0
	earned_free_ak47 = 1

	WHILE number_of_packages_collected < 80
		WAIT 500
		GET_COLLECTABLE1S_COLLECTED	number_of_packages_collected
	ENDWHILE

	PLAYER_MADE_PROGRESS 1
	ADD_PAGER_MESSAGE ( PAGEB8 ) 140 2 0
	earned_free_sniper = 1

	WHILE number_of_packages_collected < 90
		WAIT 500
		GET_COLLECTABLE1S_COLLECTED	number_of_packages_collected
	ENDWHILE

	PLAYER_MADE_PROGRESS 1
	ADD_PAGER_MESSAGE ( PAGEB9 ) 140 2 0
	earned_free_m16 = 1

	WHILE number_of_packages_collected < 100
		WAIT 500
		GET_COLLECTABLE1S_COLLECTED	number_of_packages_collected
	ENDWHILE

	PLAYER_MADE_PROGRESS 1
	ADD_PAGER_MESSAGE ( PAGEB10 ) 140 2 0
	earned_free_launcher = 1

	TERMINATE_THIS_SCRIPT
}

mission_remove_pickups_ind:
{

	REMOVE_PICKUP securicar_pickup
	REMOVE_PICKUP moonbeam_pickup
	REMOVE_PICKUP coach_pickup
	REMOVE_PICKUP flatbed_pickup 
	REMOVE_PICKUP linerunner_pickup
	REMOVE_PICKUP trashmaster_pickup
	REMOVE_PICKUP patriot_pickup
	REMOVE_PICKUP whoopee_pickup
	REMOVE_PICKUP blista_pickup
	REMOVE_PICKUP mule_pickup
	REMOVE_PICKUP yankee_pickup
	REMOVE_PICKUP bobcat_pickup
	REMOVE_PICKUP dodo_pickup
	REMOVE_PICKUP bus_pickup
	REMOVE_PICKUP rumpo_pickup
	REMOVE_PICKUP pony_pickup

}

RETURN

mission_remove_pickups_sub:
{

	REMOVE_PICKUP sentinet_pickup
	REMOVE_PICKUP cheetah_pickup
	REMOVE_PICKUP banshee_pickup
	REMOVE_PICKUP idaho_pickup
	REMOVE_PICKUP infernus_pickup
	REMOVE_PICKUP taxi_pickup
	REMOVE_PICKUP kuruma_pickup
	REMOVE_PICKUP stretch_pickup
	REMOVE_PICKUP perennial_pickup
	REMOVE_PICKUP stinger_pickup
	REMOVE_PICKUP manana_pickup
	REMOVE_PICKUP landstalker_pickup
	REMOVE_PICKUP stallion_pickup
	REMOVE_PICKUP injection_pickup
	REMOVE_PICKUP cabbie_pickup
	REMOVE_PICKUP esperanto_pickup
}

RETURN


mission_remove_pickups_military:
{

	REMOVE_PICKUP copcar_pickup 
	REMOVE_PICKUP swatvan_pickup 
	REMOVE_PICKUP fbi_pickup
	REMOVE_PICKUP tank_pickup
	REMOVE_PICKUP barracks_pickup
	REMOVE_PICKUP ambulance_pickup
	REMOVE_PICKUP firetruck_pickup
}

RETURN

remove_bonus_pickups:
{

	REMOVE_PICKUP bonus_gun1		
	REMOVE_PICKUP bonus_gun2		
	REMOVE_PICKUP bonus_gun3		
	REMOVE_PICKUP bonus_gun4		
	REMOVE_PICKUP bonus_gun5		
	REMOVE_PICKUP bonus_gun6		
	REMOVE_PICKUP bonus_gun7		
	REMOVE_PICKUP bonus_gun8		
	REMOVE_PICKUP bonus_gun9
	REMOVE_PICKUP bonus_gunflame	
	REMOVE_PICKUP bonus_gun10
	REMOVE_PICKUP bonus_bribe1
	REMOVE_PICKUP bonus_bribe2
	REMOVE_PICKUP bonus_bribe3
	REMOVE_PICKUP bonus_bribe4
	REMOVE_PICKUP bonus_bribe5
	REMOVE_PICKUP bonus_bribe6
	REMOVE_PICKUP bonus_health
	REMOVE_PICKUP bonus_adrenaline
}

RETURN

MISSION_START

VAR_INT rays_cutscene_flag rays_camera_1 rays_camera_2 rays_camera_3
//VAR_INT camera_stuff1 camera_stuff2	camera_stuff3 camera_stuff4
/*
camera_stuff1 = 0
camera_stuff2 = 0
camera_stuff3 = 0
camera_stuff4 = 0
*/
rays_camera_1 = 0
rays_camera_2 = 0
rays_camera_3 = 0
rays_cutscene_flag = 0


SCRIPT_NAME	camera

SET_DEATHARREST_STATE OFF


mission_start_camera:
{
WAIT 70


//INDUSTRIAL******************************************************************************************************
/*
IF IS_PLAYER_PLAYING Player

	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

		IF IS_PLAYER_IN_ZONE player CHINA
			// Fuzz ball camera zoom
			IF IS_PLAYER_IN_AREA_3D player 1004.0 -892.0 14.0 996.9 -885.6 17.0 FALSE
				IF camera_stuff1 = 0
					SET_FIXED_CAMERA_POSITION 1000.120 -880.396 16.6 0.0 0.0 0.0
					POINT_CAMERA_AT_PLAYER player FIXED INTERPOLATION
					//POINT_CAMERA_AT_POINT 1000.1 -881.3 16.5 INTERPOLATION
					//SET_CAMERA_ZOOM CAM_ZOOM_TWO
					camera_stuff1 = 1
				ENDIF
			ELSE
				IF camera_stuff1 = 1
					RESTORE_CAMERA
					SET_CAMERA_IN_FRONT_OF_PLAYER
					camera_stuff1 = 0
				ENDIF
			ENDIF
		ENDIF

	ENDIF //IS_PLAYER_IN_ZONE

ENDIF //IS_PLAYER_PLAYING
*/


//COMMERCIAL*****************************************************************************************************

IF IS_PLAYER_PLAYING Player

	IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL


	//RAYS TOILETS FIXED CAM STUFF //rays_camera_1
		IF rays_cutscene_flag = 0
			IF IS_PLAYER_PLAYING player
				IF IS_PLAYER_IN_ZONE player PARK
					IF IS_PLAYER_IN_AREA_3D player 36.5302 -734.5862 21.67 47.4772 -726.9442 24.457 0
						IF IS_PLAYER_IN_AREA_2D player 36.5302 -729.3754 47.4772 -726.9442 0
							IF rays_camera_1 = 0
								SET_PLAYER_CONTROL player OFF
								SET_FADING_COLOUR 1 1 1
								DO_FADE 200 FADE_OUT
								rays_camera_1 = 1
							ENDIF
							IF rays_camera_1 = 1
								IF NOT GET_FADING_STATUS
									IF rays_camera_2 = 0
										SET_PLAYER_COORDINATES player 38.9775 -727.8468 21.6
										SET_PLAYER_HEADING player 225.0
									ENDIF
									SET_FIXED_CAMERA_POSITION 36.0301 -728.3186 24.2803 0.0 0.0 0.0
									ENABLE_PLAYER_CONTROL_CAMERA
									POINT_CAMERA_AT_POINT 36.9545 -728.3175 23.8989 JUMP_CUT
									DO_FADE 200 FADE_IN
									rays_camera_1 = 2
								ENDIF
							ENDIF
							IF rays_camera_1 = 2
								IF NOT GET_FADING_STATUS
									SET_PLAYER_CONTROL player ON
									rays_camera_1 = 3
									rays_camera_2 = 0
									rays_camera_3 = 0
								ENDIF
							ENDIF
						ENDIF
						IF IS_PLAYER_IN_AREA_2D player 44.2774 -734.5862 47.4772 -729.3754 0
							IF rays_camera_2 = 0
								SET_PLAYER_CONTROL player OFF
								DO_FADE 200 FADE_OUT
								rays_camera_2 = 1
							ENDIF
							IF rays_camera_2 = 1
								IF NOT GET_FADING_STATUS
									SET_FIXED_CAMERA_POSITION 46.7275 -727.1589 22.5274 0.0 0.0 0.0
									ENABLE_PLAYER_CONTROL_CAMERA
									POINT_CAMERA_AT_POINT 46.4612 -728.1208 22.5895 JUMP_CUT
									DO_FADE 200 FADE_IN
									rays_camera_2 = 2
								ENDIF
							ENDIF
							IF rays_camera_2 = 2
								IF NOT GET_FADING_STATUS
									SET_PLAYER_CONTROL player ON
									rays_camera_1 = 0
									rays_camera_2 = 3
									rays_camera_3 = 0
								ENDIF
							ENDIF
						ENDIF
						IF IS_PLAYER_IN_AREA_2D player 36.5302 -734.5862 44.2774 -729.3754 0
							IF rays_camera_3 = 0
								SET_PLAYER_CONTROL player OFF
								DO_FADE 200 FADE_OUT
								rays_camera_3 = 1
							ENDIF
							IF rays_camera_3 = 1
								IF NOT GET_FADING_STATUS
									SET_FIXED_CAMERA_POSITION 46.5875 -733.8959 23.9757 0.0 0.0 0.0
									ENABLE_PLAYER_CONTROL_CAMERA
									POINT_CAMERA_AT_POINT 45.6562 -733.6129 23.7464 JUMP_CUT
									DO_FADE 200 FADE_IN
									rays_camera_3 = 2
								ENDIF
							ENDIF
							IF rays_camera_3 = 2
								IF NOT GET_FADING_STATUS
									SET_PLAYER_CONTROL player ON
									rays_camera_1 = 0
									rays_camera_2 = 0
									rays_camera_3 = 3
								ENDIF
							ENDIF
						ENDIF
					ELSE
						IF rays_camera_1 = 3
							SET_PLAYER_CONTROL player OFF
							DO_FADE 200 FADE_OUT
							rays_camera_1 = 4
						ENDIF
						IF rays_camera_1 = 4
							IF NOT GET_FADING_STATUS
								CLEAR_AREA 38.9115 -726.0132 22.2 2.0 TRUE
								SET_PLAYER_COORDINATES player 38.9115 -726.0132 21.6
								SET_PLAYER_HEADING player 0.0
								RESTORE_CAMERA_JUMPCUT
								SET_CAMERA_IN_FRONT_OF_PLAYER
								DO_FADE 200 FADE_IN
								rays_camera_1 = 5
							ENDIF
						ENDIF
						IF rays_camera_1 = 5
							IF NOT GET_FADING_STATUS
								SET_PLAYER_CONTROL player ON
								rays_camera_1 = 0
								rays_camera_2 = 0
								rays_camera_3 = 0
							ENDIF
						ENDIF
					ENDIF
				ELSE
					IF NOT rays_camera_1 = 0
					OR NOT rays_camera_2 = 0
					OR NOT rays_camera_3 = 0
						SET_CAMERA_IN_FRONT_OF_PLAYER
						RESTORE_CAMERA_JUMPCUT
						rays_camera_1 = 0
						rays_camera_2 = 0
						rays_camera_3 = 0
					ENDIF
				ENDIF		
			ENDIF
		ENDIF
		//END OF RAYS TOILETS FIXED CAM STUFF
		/*
		IF IS_PLAYER_PLAYING Player
			// Police cell wall camera zoom	
			IF IS_PLAYER_IN_AREA_3D player 332.1 -1093.3 24.0 323.3 -1089.1 30.0 FALSE
				IF camera_stuff4 = 0
					SET_FIXED_CAMERA_POSITION 328.2  -1086.4  28.2 0.0 0.0 0.0
					POINT_CAMERA_AT_PLAYER player FIXED INTERPOLATION
					camera_stuff4 = 1
				ENDIF
			ELSE
				IF camera_stuff4 = 1
					RESTORE_CAMERA
					SET_CAMERA_IN_FRONT_OF_PLAYER
					camera_stuff4 = 0
				ENDIF
			ENDIF
		ENDIF
		*/
		/*
		
		IF IS_PLAYER_PLAYING player
			IF IS_PLAYER_IN_ZONE player SHOPING

				// Dojo building camera zoom
				IF IS_PLAYER_IN_AREA_3D player 106.1 -1277.7 24.0 96.3 -1273.0 29.0 FALSE
					IF camera_stuff2 = 0
						SET_FIXED_CAMERA_POSITION 110.634 -1275.475 28.018 0.0 0.0 0.0
						POINT_CAMERA_AT_POINT 109.649 -1275.441 27.842 INTERPOLATION
						camera_stuff2 = 1
					ENDIF
				ELSE
					IF camera_stuff2 = 1
						RESTORE_CAMERA
						SET_CAMERA_IN_FRONT_OF_PLAYER
						camera_stuff2 = 0
					ENDIF
				ENDIF
			
				// Love building door camera zoom
				IF IS_PLAYER_IN_AREA_3D player 87.8 -1545.7 27.0 94.9 -1551.7 30.0 FALSE
					IF camera_stuff3 = 0
						SET_FIXED_CAMERA_POSITION 84.303 -1548.550 30.503 0.0 0.0 0.0
						POINT_CAMERA_AT_POINT 85.271 -1548.602 30.257 INTERPOLATION
						camera_stuff3 = 1
					ENDIF
				ELSE
					IF camera_stuff3 = 1
						RESTORE_CAMERA
						SET_CAMERA_IN_FRONT_OF_PLAYER
						camera_stuff3 = 0
					ENDIF
				ENDIF

			ENDIF //IS_PLAYER_IN_ZONE
		ENDIF //IS_PLAYER_PLAYING
		*/

	ENDIF //IS_PLAYER_IN_ZONE

ENDIF //IS_PLAYER_PLAYING



GOTO mission_start_camera

MISSION_END
}
MISSION_START

VAR_FLOAT objectx, objecty, objectz // Checks for the sliding doors to tell them to close if an object is in the way
VAR_INT gate_sfx1_fish gate_sfx2_fish  not_clunked_yet
VAR_INT	gate_sfx1_meat gate_sfx2_meat  
VAR_INT	gate_sfx1 gate_sfx2 gate2_sfx1 gate2_sfx2
VAR_INT open_phils_gate

gate_sfx1 = 0
gate_sfx2 = 0
gate2_sfx1 = 0
gate2_sfx2 = 0

gate_sfx1_fish = 0
gate_sfx2_fish = 0

gate_sfx1_meat = 0
gate_sfx2_meat = 0

not_clunked_yet = 0

SCRIPT_NAME	gates

SET_DEATHARREST_STATE OFF


mission_start_gates:
{
	START_NEW_SCRIPT fish_factory_gate
	START_NEW_SCRIPT dog_food_factory_gate

	START_NEW_SCRIPT police_gate1
	START_NEW_SCRIPT police_gate2
	START_NEW_SCRIPT colombian_gate
	START_NEW_SCRIPT phils_gate

	START_NEW_SCRIPT colombian_gate2

	MISSION_END
}


// INDUSTRIAL GATES ***********************************************************************************************

fish_factory_gate:
{
//	Should be called in mission_start_gates

	SCRIPT_NAME FSH_GTE

fish_factory_gate_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player

		//IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

			IF IS_PLAYER_IN_ZONE Player PORT_W
			
				// Fish Factory Gate
				IF IS_PLAYER_IN_AREA_3D player 1025.2 -1108.4 12.0 1008.2 -1098.4 16.0 FALSE
					IF IS_PLAYER_IN_MODEL player CAR_BELLYUP
					OR IS_PLAYER_IN_MODEL player CAR_TRASHMASTER
					OR IS_PLAYER_IN_AREA_3D player 1015.6 -1100.5 12.0 1009.2 -1108.1 16.0 FALSE
						IF gate_sfx1_fish = 0
							ADD_ONE_OFF_SOUND 1016.0 -1107.955 12.294 SOUND_GATE_START_CLUNK
							gate_sfx1_fish = 1
						ENDIF
						WHILE NOT SLIDE_OBJECT fish_factory_gate 1016.0 -1099.455 12.294 0.0 0.1 0.0 FALSE
							WAIT 0								 
						ENDWHILE
						IF not_clunked_yet = 1
							gate_sfx2_fish = 0
							not_clunked_yet = 0
						ENDIF
						IF gate_sfx2_fish = 0
							ADD_ONE_OFF_SOUND 1016.0 -1099.455 12.294 SOUND_GATE_STOP_CLUNK
							gate_sfx2_fish = 1	  
						ENDIF
					ENDIF
													
				ELSE
					
					IF gate_sfx1_fish = 1
						ADD_ONE_OFF_SOUND 1016.0 -1099.455 12.294 SOUND_GATE_START_CLUNK
					ENDIF
															 
					WHILE NOT SLIDE_OBJECT fish_factory_gate 1016.0 -1107.955 12.294 0.0 0.1 0.0 TRUE
	//					GET_OBJECT_COORDINATES fish_factory_gate objectx objecty objectz
						WAIT 0
					ENDWHILE

					GET_OBJECT_COORDINATES fish_factory_gate objectx objecty objectz

					IF gate_sfx2_fish = 1
						not_clunked_yet = 1
						IF objectx = 1016.0  
						AND objecty = -1107.955
						AND objectz	= 12.294
							ADD_ONE_OFF_SOUND 1016.0 -1107.955 12.294 SOUND_GATE_STOP_CLUNK
							gate_sfx2_fish = 0	  
							not_clunked_yet = 0
						ENDIF
					ENDIF
							
					gate_sfx1_fish = 0
				ENDIF	//	IF IS_PLAYER_IN_AREA_3D player 1025.2 -1108.4 12.0 1008.2 -1098.4 16.0 FALSE

			ENDIF	//	IF IS_PLAYER_IN_ZONE Player PORT_W

		//ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

	ENDIF	//	IF IS_PLAYER_PLAYING Player

	GOTO fish_factory_gate_inner
}


dog_food_factory_gate:
{
//	Should be called in mission_start_gates

	SCRIPT_NAME DOG_GTE

dog_food_factory_gate_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player

		//IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

			IF IS_PLAYER_IN_ZONE Player PORT_I

				// Dog Food Factory Gate
				IF IS_PLAYER_IN_ANGLED_AREA_3D player 1247.58 -822.0 12.0 1253.94 -815.0 18.0 14.0 FALSE
					IF gate_sfx1_meat = 0
						ADD_ONE_OFF_SOUND 1250.4 -812.0 13.97 SOUND_GATE_START_CLUNK
						gate_sfx1_meat = 1
					ENDIF

					WHILE NOT SLIDE_OBJECT dogfood_factory_gate 1244.4 -818.0 13.97 0.1 0.1 0.0 FALSE
						WAIT 0
					ENDWHILE
					IF not_clunked_yet = 1
						gate_sfx2_meat = 0
						not_clunked_yet = 0
					ENDIF
					IF gate_sfx2_meat = 0
						ADD_ONE_OFF_SOUND 1244.4 -818.0 13.97 SOUND_GATE_STOP_CLUNK
						gate_sfx2_meat = 1
					ENDIF
				ELSE
					IF gate_sfx1_meat = 1
						ADD_ONE_OFF_SOUND 1244.4 -818.0 13.97 SOUND_GATE_START_CLUNK
					ENDIF

					WHILE NOT SLIDE_OBJECT dogfood_factory_gate 1250.4 -812.0 13.97 0.1 0.1 0.0 TRUE
					//GET_OBJECT_COORDINATES dogfood_factory_gate objectx objecty objectz
						WAIT 0
					ENDWHILE
					
					GET_OBJECT_COORDINATES dogfood_factory_gate objectx objecty objectz

					IF gate_sfx2_meat = 1
						not_clunked_yet = 1
						IF objectx = 1250.4  
						AND objecty = -812.0
						AND objectz	= 13.97
							ADD_ONE_OFF_SOUND 1250.4 -812.0 13.97 SOUND_GATE_STOP_CLUNK
							gate_sfx2_meat = 0
							not_clunked_yet = 0
						ENDIF
					ENDIF
					gate_sfx1_meat = 0
				ENDIF	//	IF IS_PLAYER_IN_ANGLED_AREA_3D player 1247.58 -822.0 12.0 1253.94 -815.0 18.0 14.0 FALSE

			ENDIF	//	IF IS_PLAYER_IN_ZONE Player PORT_I

		//ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

	ENDIF	//	IF IS_PLAYER_PLAYING Player

	GOTO dog_food_factory_gate_inner
}

// END OF INDUSTRIAL GATES ****************************************************************************************


// COMMERCIAL GATES ***********************************************************************************************

police_gate1:
{
//	Should be called in mission_start_gates

	SCRIPT_NAME POL_GT1

police_gate1_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player

		//IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL

		 	IF IS_PLAYER_IN_ZONE player YAKUSA
		 			  								 
			// Commercial Police Gate one
				IF IS_PLAYER_IN_AREA_3D player 358.0 -1138.0 18.0 366.0 -1121.0 30.0 FALSE
					IF IS_PLAYER_IN_MODEL player CAR_POLICE
					OR IS_PLAYER_IN_AREA_3D player 365.9 -1128.2 21.9 358.5 -1119.5 26.0 FALSE
						IF gate_sfx1 = 0
							ADD_ONE_OFF_SOUND 366.158 -1128.522 21.941 SOUND_GATE_START_CLUNK
							gate_sfx1 = 1
						ENDIF
						WHILE NOT SLIDE_OBJECT police_door_one 358.158 -1128.522 21.941 0.1 0.0 0.0 FALSE
							WAIT 0
						ENDWHILE
						IF not_clunked_yet = 1
							gate_sfx2 = 0
							not_clunked_yet = 0
						ENDIF
						IF gate_sfx2 = 0
							ADD_ONE_OFF_SOUND 358.158 -1128.522 21.941 SOUND_GATE_STOP_CLUNK
							gate_sfx2 = 1
						ENDIF									
					ENDIF							 
				ELSE	

					IF gate_sfx1 = 1
						ADD_ONE_OFF_SOUND 358.158 -1128.522 21.941 SOUND_GATE_START_CLUNK
					ENDIF
												
					WHILE NOT SLIDE_OBJECT police_door_one 366.158 -1128.522 21.941 0.1 0.0 0.0 TRUE
	//					GET_OBJECT_COORDINATES police_door_one objectx objecty objectz
						WAIT 0
					ENDWHILE

					GET_OBJECT_COORDINATES police_door_one objectx objecty objectz

					IF gate_sfx2 = 1
						not_clunked_yet = 1
						IF objectx = 366.158  
						AND objecty = -1128.522
						AND objectz	= 21.941
							ADD_ONE_OFF_SOUND 366.158 -1128.522 21.941 SOUND_GATE_STOP_CLUNK
							gate_sfx2 = 0
							not_clunked_yet = 0
						ENDIF
					ENDIF
					gate_sfx1 = 0
				ENDIF	//	IF IS_PLAYER_IN_AREA_3D player 358.0 -1138.0 18.0 366.0 -1121.0 30.0 FALSE

			ENDIF	//	IF IS_PLAYER_IN_ZONE player YAKUSA

		//ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
		
	ENDIF	//	IF IS_PLAYER_PLAYING Player

	GOTO police_gate1_inner
}
					

police_gate2:
{
//	Should be called in mission_start_gates

	SCRIPT_NAME POL_GT2

police_gate2_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player

		//IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL

		 	IF IS_PLAYER_IN_ZONE player YAKUSA

				// commercial police gate two
				IF IS_PLAYER_IN_AREA_3D player 317.87 -1136.0 18.0 322.84 -1119.82 30.0 FALSE
					IF IS_PLAYER_IN_MODEL player CAR_POLICE
					OR IS_PLAYER_IN_AREA_3D player 322.7 -1128.1 21.9 318.0 -1119.3 26.0 FALSE
						IF gate2_sfx1 = 0
							ADD_ONE_OFF_SOUND 326.3 -1128.522 21.941 SOUND_GATE_START_CLUNK
							gate2_sfx1 = 1
						ENDIF
								   				
						WHILE NOT SLIDE_OBJECT police_door_two 332.0 -1128.522 21.941 0.1 0.0 0.0 FALSE
							WAIT 0
						ENDWHILE
						IF not_clunked_yet = 1
							gate2_sfx2 = 0
							not_clunked_yet = 0
						ENDIF
						IF gate2_sfx2 = 0
							ADD_ONE_OFF_SOUND 332.0 -1128.522 21.941 SOUND_GATE_STOP_CLUNK
							gate2_sfx2 = 1
						ENDIF	
									
					ENDIF						
				ELSE	

					IF gate2_sfx1 = 1
						ADD_ONE_OFF_SOUND 332.0 -1128.522 21.941 SOUND_GATE_START_CLUNK							
					ENDIF

					WHILE NOT SLIDE_OBJECT police_door_two 326.3 -1128.522 21.941 0.1 0.0 0.0 TRUE
	//					GET_OBJECT_COORDINATES police_door_two objectx objecty objectz
						WAIT 0
					ENDWHILE

					GET_OBJECT_COORDINATES police_door_two objectx objecty objectz

					IF gate2_sfx2 = 1
						not_clunked_yet = 1
						IF objectx = 326.3  
						AND objecty = -1128.522
						AND objectz	= 21.941
							ADD_ONE_OFF_SOUND 326.3 -1128.522 21.941 SOUND_GATE_STOP_CLUNK
							gate2_sfx2 = 0
							not_clunked_yet = 0										
						ENDIF
					ENDIF
					gate2_sfx1 = 0
				ENDIF	//	IF IS_PLAYER_IN_AREA_3D player 317.87 -1136.0 18.0 322.84 -1119.82 30.0 FALSE

			ENDIF	//	IF IS_PLAYER_IN_ZONE player YAKUSA

		//ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
			   
	ENDIF	//	IF IS_PLAYER_PLAYING Player

	GOTO police_gate2_inner
}


colombian_gate:
{
//	Should be called in mission_start_gates

	SCRIPT_NAME COL_GTE

colombian_gate_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player

		//IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL

			IF IS_PLAYER_IN_ZONE player STADIUM

				// Colombian Compound Gate
				IF IS_PLAYER_IN_AREA_3D player 98.6 -337.53 14.0 81.9 -317.56 20.0 FALSE
					IF IS_PLAYER_IN_MODEL player CAR_COLUMB
					OR IS_PLAYER_IN_AREA_3D player 31.0 -317.0 14.0 91.0 -394.0 25.0 FALSE
						IF gate2_sfx1 = 0
							ADD_ONE_OFF_SOUND 91.589 -318.592 15.296 SOUND_GATE_START_CLUNK
							gate2_sfx1 = 1
						ENDIF

						WHILE NOT SLIDE_OBJECT colombian_gate 91.589 -327.365 15.296 0.0 0.1 0.0 FALSE
							WAIT 0
						ENDWHILE
						IF not_clunked_yet = 1
							gate_sfx2 = 0
							not_clunked_yet = 0
						ENDIF
						IF gate2_sfx2 = 0
							ADD_ONE_OFF_SOUND 91.589 -327.365 15.296 SOUND_GATE_STOP_CLUNK
							gate2_sfx2 = 1
						ENDIF
					ENDIF				
				ELSE

					IF gate2_sfx1 = 1
						ADD_ONE_OFF_SOUND 91.589 -327.365 15.296 SOUND_GATE_START_CLUNK
					ENDIF

					WHILE NOT SLIDE_OBJECT colombian_gate 91.589 -318.592 15.296 0.0 0.1 0.0 TRUE
	//					GET_OBJECT_COORDINATES colombian_gate objectx objecty objectz
						WAIT 0
					ENDWHILE

					GET_OBJECT_COORDINATES colombian_gate objectx objecty objectz

					IF gate2_sfx2 = 1
						not_clunked_yet = 1
						IF objectx = 91.589  
						AND objecty = -318.592
						AND objectz	= 15.296
							ADD_ONE_OFF_SOUND 91.589 -318.592 15.296 SOUND_GATE_STOP_CLUNK
							gate2_sfx2 = 0
							not_clunked_yet = 0		
						ENDIF
					ENDIF
					gate2_sfx1 = 0
				ENDIF	//	IF IS_PLAYER_IN_AREA_3D player 98.6 -337.53 14.0 81.9 -317.56 20.0 FALSE

			ENDIF	//	IF IS_PLAYER_IN_ZONE player STADIUM

		//ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
	ENDIF	//	IF IS_PLAYER_PLAYING Player

	GOTO colombian_gate_inner
}


phils_gate:
{
//	Should be called in mission_start_gates

	SCRIPT_NAME PHL_GTE

phils_gate_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player

		//IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL

			IF IS_PLAYER_IN_ZONE player HOSPI_2

			//PHIL'S GATE

				open_phils_gate = FALSE

				IF flag_ray_mission2_passed = 1
					IF IS_PLAYER_IN_AREA_2D player 134.0 198.0 156.0 207.0 FALSE
						open_phils_gate = TRUE
					ENDIF
				ELSE
					IF flag_player_on_phil_mission = 1	//	If player is doing phil mission 
						GOTO phils_gate_inner			//	then this script doesn't move the gate at all.
					ENDIF								//	The phil script should do all gate moving.

					IF IS_PLAYER_IN_AREA_2D player 138.0 198.0 146.0 207.0 FALSE
						open_phils_gate = TRUE
					ENDIF
				ENDIF

				IF open_phils_gate = TRUE

					IF gate2_sfx1 = 0
						ADD_ONE_OFF_SOUND 147.249 207.323 10.599 SOUND_GATE_START_CLUNK
						gate2_sfx1 = 1
					ENDIF

					WHILE NOT SLIDE_OBJECT phils_compnd_gate 147.249 214.523 10.599 0.0 0.1 0.0 FALSE
						WAIT 0
					ENDWHILE

					IF not_clunked_yet = 1
						gate_sfx2 = 0
						not_clunked_yet = 0
					ENDIF

					IF gate2_sfx2 = 0
						ADD_ONE_OFF_SOUND 147.249 214.523 10.599 SOUND_GATE_STOP_CLUNK
						gate2_sfx2 = 1
					ENDIF
				ELSE
					IF gate2_sfx1 = 1
						ADD_ONE_OFF_SOUND 147.249 214.523 10.599 SOUND_GATE_START_CLUNK
					ENDIF

					WHILE NOT SLIDE_OBJECT phils_compnd_gate 147.249 207.323 10.599 0.0 0.1 0.0 TRUE
	//					GET_OBJECT_COORDINATES phils_compnd_gate objectx objecty objectz
						WAIT 0
					ENDWHILE
		
					GET_OBJECT_COORDINATES phils_compnd_gate objectx objecty objectz

					IF gate2_sfx2 = 1
						not_clunked_yet = 1
						IF objectx = 147.249  
						AND objecty = 207.323
						AND objectz	= 10.599
							ADD_ONE_OFF_SOUND 147.249 207.323 10.599 SOUND_GATE_STOP_CLUNK		
							gate2_sfx2 = 0
							not_clunked_yet = 0
						ENDIF
					ENDIF
					gate2_sfx1 = 0

				ENDIF	//	IF open_phils_gate = TRUE

			ENDIF	//	IF IS_PLAYER_IN_ZONE player HOSPI_2

		//ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
	ENDIF	//	IF IS_PLAYER_PLAYING Player

	GOTO phils_gate_inner
}

// END OF COMMERCIAL GATES ****************************************************************************************


// SUBURBAN GATES *************************************************************************************************


colombian_gate2:
{
//	Should be called in mission_start_gates

	SCRIPT_NAME COL2GTE

colombian_gate2_inner:

	WAIT 1000

	IF IS_PLAYER_PLAYING Player

		//IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN	
	 
			IF IS_PLAYER_IN_ZONE player SWANKS
				  								 
				// Columbian gate
				IF IS_PLAYER_IN_AREA_3D player -367.3 241.0 59.0 -358.8 259.6 65.0 FALSE
					IF IS_PLAYER_IN_MODEL player CAR_COLUMB
					OR IS_PLAYER_IN_AREA_3D player -367.3 251.0 59.0 -358.8 259.6 65.0 FALSE
						IF gate_sfx1 = 0
							ADD_ONE_OFF_SOUND -363.05 250.455 61.355 SOUND_GATE_START_CLUNK
							gate_sfx1 = 1
						ENDIF			   						  					
						WHILE NOT SLIDE_OBJECT Columbian_gate2 -370.05 250.455 61.355 0.1 0.0 0.0 FALSE
							WAIT 0
						ENDWHILE
						IF not_clunked_yet = 1
							gate_sfx2 = 0
							not_clunked_yet = 0
						ENDIF
						IF gate_sfx2 = 0
							ADD_ONE_OFF_SOUND -370.05 250.455 61.355 SOUND_GATE_STOP_CLUNK
							gate_sfx2 = 1
						ENDIF									
					ENDIF							 
				ELSE		

					IF gate_sfx1 = 1
						ADD_ONE_OFF_SOUND -370.05 250.455 61.355 SOUND_GATE_START_CLUNK
					ENDIF
						
					WHILE NOT SLIDE_OBJECT Columbian_gate2 -363.05 250.455 61.355 0.1 0.0 0.0 TRUE
	//					GET_OBJECT_COORDINATES Columbian_gate2 objectx objecty objectz
						WAIT 0
					ENDWHILE

					GET_OBJECT_COORDINATES Columbian_gate2 objectx objecty objectz

					IF gate_sfx2 = 1
						not_clunked_yet = 1
						IF objectx = -363.05  
						AND objecty = 250.455
						AND objectz	= 61.355
							ADD_ONE_OFF_SOUND -363.05 250.455 61.355 SOUND_GATE_STOP_CLUNK
							gate_sfx2 = 0
							not_clunked_yet = 0		
						ENDIF
					ENDIF
					gate_sfx1 = 0
				ENDIF	//	IF IS_PLAYER_IN_AREA_3D player -367.3 241.0 59.0 -358.8 259.6 65.0 FALSE

			ENDIF	//	IF IS_PLAYER_IN_ZONE player SWANKS

	   //ENDIF	//	IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	ENDIF	//	IF IS_PLAYER_PLAYING Player

	GOTO colombian_gate2_inner
}

// END OF SUBURBAN GATES ******************************************************************************************

MISSION_START

VAR_INT mission_skip_index god_mode_activated
mission_skip_index = 0
god_mode_activated = 0

VAR_INT mission_barriers_created
mission_barriers_created = 1 // Barriers already exist, so don't respawn them

SCRIPT_NAME mis_skp

SET_DEATHARREST_STATE OFF

mission_start_mission_skip:

WAIT 0

    
IF IS_PLAYER_PLAYING player

	GET_CUTSCENE_TIME mission_skip_index  // Fudged call to return the mission skip index the user selected from the UI to mission_skip.sc.

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	// INDUSTRIAL AREA 
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	IF mission_skip_index > 0

		IF NOT IS_PLAYER_IN_REMOTE_MODE 0 // HACKED - false ONLY when the god mode command is called
			god_mode_activated = 1
		ENDIF

	    FAIL_CURRENT_MISSION

		// dont do this when god mode-ing
		IF god_mode_activated = 0
			SET_TIME_OF_DAY 10 00  // Phone calls have time restrictions, and right now you have to suicide between mission jumps, which changes TOD.
		ENDIF

		// Destroy these so they can be conditionally recreated
		IF DOES_OBJECT_EXIST subway_gate_industrial
			DELETE_OBJECT subway_gate_industrial
		ENDIF

		IF DOES_OBJECT_EXIST tunnel_gate_industrial
			DELETE_OBJECT tunnel_gate_industrial
		ENDIF

		// set visibility/collision of the bridge
		IF mission_skip_index <= 21 
		AND mission_skip_index > 1
			flag_industrial_passed = 0

			//SWAP BRIDGE FROM FIXED TO DAMAGED
			SWAP_NEAREST_BUILDING_MODEL	525.362 -927.066 71.841	20.0 nbbridgcabls01 nbbridgfk2	
			SWAP_NEAREST_BUILDING_MODEL	706.432 -935.82  67.071	20.0 nbbridgcabls01 nbbridgfk2
			SWAP_NEAREST_BUILDING_MODEL	529.023 -920.098 43.504 20.0 nbbridgerdb damgbridgerdb 
			SWAP_NEAREST_BUILDING_MODEL	702.763 -939.963 38.736	20.0 nbbridgerdb damgbridgerdb 
			SWAP_NEAREST_BUILDING_MODEL	529.023 -942.94  43.504	20.0 nbbridgerda damgbbridgerda	
			SWAP_NEAREST_BUILDING_MODEL	702.764 -919.963 38.736	20.0 nbbridgerda damgbbridgerda	

			SWAP_NEAREST_BUILDING_MODEL	525.362 -927.066 71.841	20.0 lodridgcabls01 lodridgfk2	
			SWAP_NEAREST_BUILDING_MODEL	706.432 -935.82  67.071	20.0 lodridgcabls01 lodridgfk2	
			SWAP_NEAREST_BUILDING_MODEL	521.146 -922.94  43.504 20.0 lodridgerdb lodgbridgerdb 
			SWAP_NEAREST_BUILDING_MODEL	702.763 -939.963 38.736	20.0 lodridgerdb lodgbridgerdb 
			SWAP_NEAREST_BUILDING_MODEL	529.023 -940.098 43.504	20.0 lodridgerda lodgbbridgerda	
			SWAP_NEAREST_BUILDING_MODEL	702.764 -919.963 38.736	20.0 lodridgerda lodgbbridgerda

			SWAP_NEAREST_BUILDING_MODEL 1027.26 -933.796 15.042 50.0 LOD_land014 indhelix_barrier
			SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1027.26 -933.796 15.042 50.0 indhelix_barrier TRUE

			CREATE_OBJECT_NO_OFFSET subwaygate 988.963 -471.778 5.2 subway_gate_industrial
			DONT_REMOVE_OBJECT subway_gate_industrial
			SET_OBJECT_HEADING subway_gate_industrial 90.0   

			CREATE_OBJECT_NO_OFFSET tunnelentrance 730.331 172.467 -21.075 tunnel_gate_industrial
			DONT_REMOVE_OBJECT tunnel_gate_industrial

			SWITCH_ROADS_OFF 619.6 -911.5 45.0 834.3 -954.5 32.0 //Industrial to commercial Bridge
			SWITCH_ROADS_OFF 659.6 200.0 -20.0 945.8 147.5 5.0	//Tunnel
			SWITCH_ROADS_OFF 529.6 106.5 -30.0 581.4 65.7 0.0 //tunnel from commercial to intersection for sub and ind
		ELSE
			flag_industrial_passed = 1

			//SWAP BRIDGE FROM DAMAGED TO FIXED
			SWAP_NEAREST_BUILDING_MODEL	525.362 -927.066 71.841	20.0 nbbridgfk2	nbbridgcabls01
			SWAP_NEAREST_BUILDING_MODEL	706.432 -935.82  67.071	20.0 nbbridgfk2	nbbridgcabls01
			SWAP_NEAREST_BUILDING_MODEL	529.023 -920.098 43.504 20.0 damgbridgerdb nbbridgerdb
			SWAP_NEAREST_BUILDING_MODEL	702.763 -939.963 38.736	20.0 damgbridgerdb nbbridgerdb
			SWAP_NEAREST_BUILDING_MODEL	529.023 -942.94  43.504	20.0 damgbbridgerda	nbbridgerda
			SWAP_NEAREST_BUILDING_MODEL	702.764 -919.963 38.736	20.0 damgbbridgerda	nbbridgerda

			SWAP_NEAREST_BUILDING_MODEL	525.362 -927.066 71.841	20.0 lodridgfk2	lodridgcabls01
			SWAP_NEAREST_BUILDING_MODEL	706.432 -935.82  67.071	20.0 lodridgfk2	lodridgcabls01
			SWAP_NEAREST_BUILDING_MODEL	521.146 -922.94  43.504 20.0 lodgbridgerdb lodridgerdb
			SWAP_NEAREST_BUILDING_MODEL	702.763 -939.963 38.736	20.0 lodgbridgerdb lodridgerdb
			SWAP_NEAREST_BUILDING_MODEL	529.023 -940.098 43.504	20.0 lodgbbridgerda	lodridgerda
			SWAP_NEAREST_BUILDING_MODEL	702.764 -919.963 38.736	20.0 lodgbbridgerda	lodridgerda
			
			SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1027.26 -933.796 15.042 50.0 indhelix_barrier FALSE
			SWAP_NEAREST_BUILDING_MODEL 1027.26 -933.796 15.042 50.0 indhelix_barrier LOD_land014

			// switch these roads on!! reduce pathing bugs
			SWITCH_ROADS_ON 619.6 -911.5 45.0 834.3 -954.5 32.0 //Industrial to commercial Bridge
			SWITCH_ROADS_ON 659.6 200.0 -20.0 945.8 147.5 5.0	//Tunnel
			SWITCH_ROADS_ON 529.6 106.5 -30.0 581.4 65.7 0.0 //tunnel from commercial to intersection for sub and ind

		ENDIF

		// open the second bridge
		IF mission_skip_index <= 52
			flag_commercial_passed = 0

			if mission_barriers_created = 0
				CREATE_OBJECT_NO_OFFSET subwaygate -672.0 -760.0 8.3 subway_gate_suburban1
				DONT_REMOVE_OBJECT subway_gate_suburban1
				SET_OBJECT_HEADING subway_gate_suburban1 270.0

				CREATE_OBJECT_NO_OFFSET subwaygate -672.0 -768.9 8.3 subway_gate_suburban2
				DONT_REMOVE_OBJECT subway_gate_suburban2
				SET_OBJECT_HEADING subway_gate_suburban2 270.0

				CREATE_OBJECT_NO_OFFSET tunnelentrance 533.3 97.0 -21.3 tunnel_gate_suburban
				DONT_REMOVE_OBJECT tunnel_gate_suburban
				SET_OBJECT_HEADING tunnel_gate_suburban 45.0

				CREATE_OBJECT_NO_OFFSET helix_barrier -73.137 -630.333 25.932 helix_barrier
				DONT_REMOVE_OBJECT helix_barrier

				mission_barriers_created = 1
			ENDIF

			SWITCH_ROADS_OFF 496.7 75.5 -30.0 484.0 44.2 0.0 //tunnel to suburbia
			SWITCH_ROADS_OFF -46.8 -648.0 39.0 -69.1 -614.0 50.0 //Commercial to Suburbia Bridge
		ELSE
			flag_commercial_passed = 1

			IF DOES_OBJECT_EXIST subway_gate_suburban1
				DELETE_OBJECT subway_gate_suburban1
			ENDIF
			IF DOES_OBJECT_EXIST subway_gate_suburban2
				DELETE_OBJECT subway_gate_suburban2
			ENDIF
			IF DOES_OBJECT_EXIST tunnel_gate_suburban
				DELETE_OBJECT tunnel_gate_suburban
			ENDIF

			IF DOES_OBJECT_EXIST helix_barrier
				DELETE_OBJECT helix_barrier
			ENDIF
			
			SWITCH_ROADS_ON 496.7 75.5 -30.0 484.0 44.2 0.0 //tunnel to suburbia
			SWITCH_ROADS_ON -46.8 -648.0 39.0 -69.1 -614.0 50.0 //Commercial to Suburbia Bridge

			COMMERCIAL_PASSED

			mission_barriers_created = 0
		ENDIF

	ENDIF

	IF god_mode_activated = 1
		mission_skip_index = 0 // dont actually jump
	ENDIF

	IF mission_skip_index = 1  // Give Me Liberty
		GOSUB kill_all_scripts
		flag_eightball_mission_passed = 0
		START_NEW_SCRIPT eightball_mission_loop 
		SET_PLAYER_COORDINATES player 811.90 -939.95 -100.0
	ENDIF
	
	IF mission_skip_index = 2  // Don't Spank My Bitch Up
		GOSUB kill_all_scripts
		flag_luigi_mission2_passed = 0
		START_NEW_SCRIPT luigi_mission2_loop 
		SET_PLAYER_COORDINATES player 905.2 -425.4 13.9
		REMOVE_BLIP	luigi_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT 892.8 -425.8 13.9 RADAR_SPRITE_LUIGI luigi_contact_blip
	ENDIF

	IF mission_skip_index = 3  // Drive Misty For Me
		GOSUB kill_all_scripts
		flag_luigi_mission3_passed = 0
		START_NEW_SCRIPT luigi_mission3_loop 
		SET_PLAYER_COORDINATES player 905.2 -425.4 13.9
	ENDIF

	IF mission_skip_index = 4  // Punp Action Pimp
		GOSUB kill_all_scripts
		flag_luigi_mission4_passed = 0
		START_NEW_SCRIPT luigi_mission4_loop 
		SET_PLAYER_COORDINATES player 905.2 -425.4 13.9
	ENDIF

	IF mission_skip_index = 5  // The Fuzz Ball
		GOSUB kill_all_scripts
		flag_luigi_mission5_passed = 0
		START_NEW_SCRIPT luigi_mission5_loop 
		SET_PLAYER_COORDINATES player 905.2 -425.4 13.9
	ENDIF

	IF mission_skip_index = 6  // Mike Lips Last Lunch
		GOSUB kill_all_scripts
		flag_joey_mission1_passed = 0
		START_NEW_SCRIPT joey_mission1_loop 
		SET_PLAYER_COORDINATES player 1193.0 -872.0 13.9
		REMOVE_BLIP luigi_contact_blip  //REMOVE LUIGIS BLIP
		REMOVE_BLIP	joey_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1191.7 -870.0 -100.0 RADAR_SPRITE_JOEY joey_contact_blip
	ENDIF

	IF mission_skip_index = 7  // Farewell Chunky Lee Chong
		GOSUB kill_all_scripts
		flag_joey_mission2_passed = 0
		START_NEW_SCRIPT joey_mission2_loop 
		SET_PLAYER_COORDINATES player 1193.0 -872.0 13.9
	ENDIF

	IF mission_skip_index = 8  // Van Heist
		GOSUB kill_all_scripts
		flag_joey_mission3_passed = 0
		START_NEW_SCRIPT joey_mission3_loop 
		SET_PLAYER_COORDINATES player 1193.0 -872.0 13.9
	ENDIF

	IF mission_skip_index = 9  // Cipriani's Chauffeer
		GOSUB kill_all_scripts
		flag_joey_mission4_passed = 0
		START_NEW_SCRIPT joey_mission4_loop	
		SET_PLAYER_COORDINATES player 1193.0 -872.0 13.9
	ENDIF

	IF mission_skip_index = 10 // Dead Skunk In The Trunk
		GOSUB kill_all_scripts
		flag_joey_mission5_passed = 0
		START_NEW_SCRIPT joey_mission5_loop	 
		SET_PLAYER_COORDINATES player 1193.0 -872.0 13.9
	ENDIF

	IF mission_skip_index = 11  // The Getaway
		GOSUB kill_all_scripts
		flag_joey_mission6_passed = 0
		START_NEW_SCRIPT joey_mission6_loop	 
		SET_PLAYER_COORDINATES player 1193.0 -872.0 13.9
	ENDIF

	IF mission_skip_index = 12  // Taking Out The laundry
		GOSUB kill_all_scripts
		flag_toni_mission1_passed = 0
		START_NEW_SCRIPT toni_mission1_loop 
		SET_PLAYER_COORDINATES player 1203.0 -320.0 23.9 
		REMOVE_BLIP joey_contact_blip //REMOVE JOEYS BLIP
		REMOVE_BLIP toni_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1219.6 -321.0 26.4 RADAR_SPRITE_TONY toni_contact_blip
	ENDIF

	IF mission_skip_index = 13  // The Pick Up
		GOSUB kill_all_scripts
		flag_toni_mission2_passed = 0
		START_NEW_SCRIPT toni_mission2_loop 
		SET_PLAYER_COORDINATES player 1203.0 -320.0 23.9 
	ENDIF

	IF mission_skip_index = 14  // Salvatore's Called A Meeting
		GOSUB kill_all_scripts
		flag_toni_mission3_passed = 0
		START_NEW_SCRIPT toni_mission3_loop 
		SET_PLAYER_COORDINATES player 1203.0 -320.0 23.9 
	ENDIF

	IF mission_skip_index = 15  // Triads And Tribulations
		GOSUB kill_all_scripts
		flag_toni_mission4_passed = 0
		START_NEW_SCRIPT toni_mission4_loop 
		SET_PLAYER_COORDINATES player 1203.0 -320.0 23.9 
	ENDIF

	IF mission_skip_index = 16  // Blow Fish
		GOSUB kill_all_scripts
		flag_toni_mission5_passed = 0
		START_NEW_SCRIPT toni_mission5_loop 
		SET_PLAYER_COORDINATES player 1203.0 -320.0 23.9 
	ENDIF
	
	IF mission_skip_index = 17  // Chaperone
		GOSUB kill_all_scripts
		flag_frankie_mission1_passed = 0
		flag_frankie_switched_off = 0  // This flag needs to be off to skip here.
		START_NEW_SCRIPT frankie_mission1_loop 
		SET_PLAYER_COORDINATES player 1453.0 -193.0 54.5
		REMOVE_BLIP toni_contact_blip //REMOVE TONIS BLIP
		REMOVE_BLIP	frankie_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1455.7 -187.3 -100.0 RADAR_SPRITE_SAL frankie_contact_blip
	ENDIF

	IF mission_skip_index = 18  // Cutting The Grass
		GOSUB kill_all_scripts
		flag_frankie_mission2_passed = 0
		flag_frankie_switched_off = 0  // This flag needs to be off to skip here.
		START_NEW_SCRIPT frankie_mission2_loop 
	    SET_PLAYER_COORDINATES player 1453.0 -193.0 54.5
	ENDIF

	IF mission_skip_index = 19  // Bomb Da Base Act I
		GOSUB kill_all_scripts
		flag_frankie_mission2.1_passed = 0
		flag_frankie_switched_off = 0  // This flag needs to be off to skip here.
		START_NEW_SCRIPT frankie_mission2.1_loop
		SET_PLAYER_COORDINATES player 1453.0 -193.0 54.5
	ENDIF

	IF mission_skip_index = 20  // Bomb Da Base Act II
		GOSUB kill_all_scripts
		flag_frankie_mission3_passed = 0
		flag_frankie_switched_off = 0  // This flag needs to be off to skip here.
		START_NEW_SCRIPT frankie_mission3_loop 
		SET_PLAYER_COORDINATES player 1270.2 -90.9 13.8
		REMOVE_BLIP frankie_contact_blip //REMOVE FRANKIES BLIP
		REMOVE_BLIP	eightball_contact_blip
		//ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1272.2 -92.9 -100.0 RADAR_SPRITE_EIGHT eightball_contact_blip
	ENDIF

	IF mission_skip_index = 21  // Last Requests
		GOSUB kill_all_scripts
		flag_frankie_mission4_passed = 0
		flag_frankie_switched_off = 0  // This flag needs to be off to skip here.
		START_NEW_SCRIPT frankie_mission4_loop
		SET_PLAYER_COORDINATES player 1453.0 -193.0 54.5
		REMOVE_BLIP eightball_contact_blip //REMOVE 8_BALLS BLIP
		REMOVE_BLIP frankie_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1455.7 -187.3 -100.0 RADAR_SPRITE_SAL frankie_contact_blip
	ENDIF

	IF mission_skip_index = 22  // Turismo
		GOSUB kill_all_scripts
		flag_diablo_mission1_passed = 0
		START_NEW_SCRIPT diablo_mission1_loop
		SET_PLAYER_COORDINATES player 938.6 -235.3 -100.0
		REMOVE_BLIP frankie_contact_blip //REMOVE FRANKIES BLIP
		REMOVE_BLIP	diablo_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT 938.4 -230.5 -100.0 RADAR_SPRITE_EL diablo_contact_blip
	ENDIF

	IF mission_skip_index = 23  // I Scream, You Scream
		GOSUB kill_all_scripts
		flag_diablo_mission2_passed = 0
		START_NEW_SCRIPT diablo_mission2_loop
		SET_PLAYER_COORDINATES player 938.6 -235.3 -100.0
	ENDIF

	IF mission_skip_index = 24  // Trial By Fire
		GOSUB kill_all_scripts
		flag_diablo_mission3_passed = 0
		START_NEW_SCRIPT diablo_mission3_loop
		SET_PLAYER_COORDINATES player 938.6 -235.3 -100.0
	ENDIF

	IF mission_skip_index = 25  // Big N Veiny
		GOSUB kill_all_scripts
		flag_diablo_mission4_passed = 0
		START_NEW_SCRIPT diablo_mission4_loop
		SET_PLAYER_COORDINATES player 938.6 -235.3 -100.0
	ENDIF

	IF mission_skip_index = 26  // The Crook
		GOSUB kill_all_scripts
		flag_meat_mission1_passed = 0
		START_NEW_SCRIPT meat_mission1_loop
		REMOVE_BLIP	diablo_contact_blip
		SET_PLAYER_COORDINATES player 1226.8 -842.3 15.0
	ENDIF

	IF mission_skip_index = 27  // The Thieves
		GOSUB kill_all_scripts
		flag_meat_mission2_passed = 0
		START_NEW_SCRIPT meat_mission2_loop
		SET_PLAYER_COORDINATES player 1226.8 -842.3 15.0
	ENDIF

	IF mission_skip_index = 28  // The Wife
		GOSUB kill_all_scripts
		flag_meat_mission3_passed = 0
		START_NEW_SCRIPT meat_mission3_loop
		SET_PLAYER_COORDINATES player 1226.8 -842.3 15.0
	ENDIF

	IF mission_skip_index = 29  // Her Lover
		GOSUB kill_all_scripts
		flag_meat_mission4_passed = 0
		START_NEW_SCRIPT meat_mission4_loop
		SET_PLAYER_COORDINATES player 1226.8 -842.3 15.0
	ENDIF
	
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	// COMMERCIAL AREA 
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	IF mission_skip_index = 30  // Sayonara Salvatore
		GOSUB kill_all_scripts
		flag_asuka_mission1_passed = 0
		START_NEW_SCRIPT asuka_mission1_loop
		REMOVE_BLIP yardie_contact_blip
		REMOVE_BLIP	asuka_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT 523.7 -643.0 16.1 RADAR_SPRITE_ASUKA asuka_contact_blip
		SET_PLAYER_COORDINATES player 531.5 -648.7 -100.0
	ENDIF
	
	IF mission_skip_index = 31  // Under Surveillance
		GOSUB kill_all_scripts
		flag_asuka_mission2_passed = 0
		START_NEW_SCRIPT asuka_mission2_loop
		SET_PLAYER_COORDINATES player 531.5 -648.7 -100.0
	ENDIF

	IF mission_skip_index = 32  // Paparazzi Purge
		GOSUB kill_all_scripts
		flag_asuka_mission3_passed = 0
		START_NEW_SCRIPT asuka_mission3_loop
		SET_PLAYER_COORDINATES player 531.5 -648.7 -100.0
	ENDIF

	IF mission_skip_index = 33  // Payday For Ray
		GOSUB kill_all_scripts
		flag_asuka_mission4_passed = 0
		START_NEW_SCRIPT asuka_mission4_loop
		SET_PLAYER_COORDINATES player 531.5 -648.7 -100.0
	ENDIF

	IF mission_skip_index = 34  // Two-Faced Tanner
		GOSUB kill_all_scripts
		flag_asuka_mission5_passed = 0
		flag_love_mission4_passed = 0  // Required not to be passed for some reason.
		START_NEW_SCRIPT asuka_mission5_loop
		SET_PLAYER_COORDINATES player 523.7 -639.0 16.1
	ENDIF

	IF mission_skip_index = 35  // Bait
		GOSUB kill_all_scripts
		flag_asuka_suburban_mission1_passed = 0
		START_NEW_SCRIPT asuka_suburban_mission1_loop
		REMOVE_BLIP	asuka_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT 366.939 -328.025 20.268 RADAR_SPRITE_ASUKA asuka_contact_blip
	    SET_PLAYER_COORDINATES player 367.9 -331.2 -100.0
	ENDIF

	IF mission_skip_index = 36  // Espress-2-go
		GOSUB kill_all_scripts
		flag_asuka_suburban_mission2_passed = 0
		START_NEW_SCRIPT asuka_suburban_mission2_loop
	    SET_PLAYER_COORDINATES player 367.9 -331.2 -100.0
	ENDIF

	IF mission_skip_index = 37  // S.A.M.
	OR mission_skip_index = 38  // S.A.M. with bypass to Ransom
		
		GOSUB kill_all_scripts
		flag_asuka_suburban_mission3_passed = 0
		START_NEW_SCRIPT asuka_suburban_mission3_loop
	    SET_PLAYER_COORDINATES player 367.9 -331.2 -100.0
	    
		IF mission_skip_index = 38
		    bypassForMorgan = 1
	    ENDIF
	ENDIF
	
	IF mission_skip_index = 39  // Kanbu Bust-Out
    	GOSUB kill_all_scripts
		flag_kenji_mission1_passed = 0
		flag_love_mission2_passed = 0  // Required not to be passed for some reason. 
    	START_NEW_SCRIPT kenji_mission1_loop
    	REMOVE_BLIP asuka_contact_blip
    	REMOVE_BLIP	kenji_contact_blip
    	ADD_SPRITE_BLIP_FOR_CONTACT_POINT 459.1 -1413.0 26.1 RADAR_SPRITE_KENJI kenji_contact_blip
        SET_PLAYER_COORDINATES player 458.8 -1424.6 26.1
	ENDIF
    
    IF mission_skip_index = 40 // Grand Theft Auto 
    	GOSUB kill_all_scripts
		flag_kenji_mission2_passed = 0
		flag_love_mission2_passed = 0  // Required not to be passed for some reason. 
    	START_NEW_SCRIPT kenji_mission2_loop
		SET_PLAYER_COORDINATES player 458.8 -1424.6 26.1
    ENDIF
    
    IF mission_skip_index = 41  // Deal Steal
    	GOSUB kill_all_scripts
		flag_kenji_mission3_passed = 0
		flag_love_mission2_passed = 0  // Required not to be passed for some reason. 
    	START_NEW_SCRIPT kenji_mission3_loop
		SET_PLAYER_COORDINATES player 458.8 -1424.6 26.1
    ENDIF
    
    IF mission_skip_index = 42  // Shima
    	GOSUB kill_all_scripts
		flag_kenji_mission4_passed = 0
		flag_love_mission2_passed = 0  // Required not to be passed for some reason. 
    	START_NEW_SCRIPT kenji_mission4_loop
		SET_PLAYER_COORDINATES player 458.8 -1424.6 26.1
    ENDIF
    
    IF mission_skip_index = 43  // Smack Down
    	GOSUB kill_all_scripts
		flag_kenji_mission5_passed = 0
		flag_love_mission2_passed = 0  // Required not to be passed for some reason. 
    	START_NEW_SCRIPT kenji_mission5_loop
		SET_PLAYER_COORDINATES player 458.8 -1424.6 26.1
    ENDIF

	IF mission_skip_index = 44  // Silence The Sneak
		GOSUB kill_all_scripts
		flag_ray_mission1_passed = 0
		START_NEW_SCRIPT ray_mission1_loop
		REMOVE_BLIP kenji_contact_blip
		REMOVE_BLIP	ray_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT 38.8 -725.4 -100.0 RADAR_SPRITE_RAY ray_contact_blip
		SET_PLAYER_COORDINATES player 48.6 -724.0 24.9
	ENDIF

	IF mission_skip_index = 45  // Arms Shortage
		GOSUB kill_all_scripts
		flag_ray_mission2_passed = 0
		START_NEW_SCRIPT ray_mission2_loop
		SET_PLAYER_COORDINATES player 48.6 -724.0 24.9
	ENDIF

	IF mission_skip_index = 46  // Evidence Dash
		GOSUB kill_all_scripts
		flag_ray_mission3_passed = 0
		START_NEW_SCRIPT ray_mission3_loop
		SET_PLAYER_COORDINATES player 48.6 -724.0 24.9
	ENDIF

	IF mission_skip_index = 47  // Gone Fishing
		GOSUB kill_all_scripts
		flag_ray_mission4_passed = 0
		START_NEW_SCRIPT ray_mission4_loop
		SET_PLAYER_COORDINATES player 48.6 -724.0 24.9
	ENDIF

	IF mission_skip_index = 48  // Plaster Blaster 
		GOSUB kill_all_scripts
		flag_ray_mission5_passed = 0
		START_NEW_SCRIPT ray_mission5_loop
		SET_PLAYER_COORDINATES player 48.6 -724.0 24.9
	ENDIF
	
	IF mission_skip_index = 49  // Marked Man
		GOSUB kill_all_scripts
		flag_ray_mission6_passed = 0
		START_NEW_SCRIPT ray_mission6_loop
		SET_PLAYER_COORDINATES player 48.6 -724.0 24.9
	ENDIF
	   
	IF mission_skip_index = 50  // Liberator
		GOSUB kill_all_scripts
		flag_love_mission1_passed = 0
		START_NEW_SCRIPT love_mission1_loop
		REMOVE_BLIP ray_contact_blip
		REMOVE_BLIP	love_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT 86.1 -1548.7 28.3 RADAR_SPRITE_DON love_contact_blip
		SET_PLAYER_COORDINATES player 78.9 -1548.4 28.2
	ENDIF

	IF mission_skip_index = 51  // Waska-Gashira Wipeout
	    GOSUB kill_all_scripts
		flag_love_mission2_passed = 0
		START_NEW_SCRIPT love_mission2_loop
		SET_PLAYER_COORDINATES player 78.9 -1548.4 28.2
	ENDIF

	IF mission_skip_index = 52  // A Drop in the Ocean
	    GOSUB kill_all_scripts
		flag_love_mission3_passed = 0
		START_NEW_SCRIPT love_mission3_loop
		SET_PLAYER_COORDINATES player 78.9 -1548.4 28.2
	ENDIF

	IF mission_skip_index = 53  // Grand Theft Aero
	    GOSUB kill_all_scripts
		flag_love_mission4_passed = 0
		flag_asuka_suburban_mission1_passed = 0
		START_NEW_SCRIPT love_mission4_loop
		SET_PLAYER_COORDINATES player 78.9 -1548.4 28.2
	ENDIF

	IF mission_skip_index = 54  // Escort Service
        GOSUB kill_all_scripts	 
		flag_love_mission5_passed = 0
		START_NEW_SCRIPT love_mission5_loop
		SET_PLAYER_COORDINATES player 78.9 -1548.4 28.2
	ENDIF

	IF mission_skip_index = 55  // Decoy
	    GOSUB kill_all_scripts
		flag_love_mission6_passed = 0
		START_NEW_SCRIPT love_mission6_loop
		SET_PLAYER_COORDINATES player 78.9 -1548.4 28.2
	ENDIF

	IF mission_skip_index = 56  // Love's Disappearance
	    GOSUB kill_all_scripts
		flag_love_mission7_passed = 0
		START_NEW_SCRIPT love_mission7_loop
		SET_PLAYER_COORDINATES player 78.9 -1548.4 28.2
	ENDIF
	   
	IF mission_skip_index = 57  // Bling-Bling Scramble
		GOSUB kill_all_scripts
		flag_yardie_mission1_passed = 0
		START_NEW_SCRIPT yardie_mission1_loop   
		REMOVE_BLIP love_contact_blip
		REMOVE_BLIP	yardie_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT 120.7 -272.1 16.1 RADAR_SPRITE_LIZ yardie_contact_blip
		SET_PLAYER_COORDINATES player 118.3 -272.6 -100.0  
	ENDIF

	IF mission_skip_index = 58  // UZI Rider
		GOSUB kill_all_scripts
		flag_yardie_mission2_passed = 0
		START_NEW_SCRIPT yardie_mission2_loop
		SET_PLAYER_COORDINATES player 118.3 -272.6 -100.0  
	ENDIF

	IF mission_skip_index = 59  // GangCar Round-Up
		GOSUB kill_all_scripts
		flag_yardie_mission3_passed = 0
		START_NEW_SCRIPT yardie_mission3_loop
		SET_PLAYER_COORDINATES player 118.3 -272.6 -100.0  
	ENDIF

	IF mission_skip_index = 60  // Kingdom-Come
		GOSUB kill_all_scripts
		flag_yardie_mission4_passed = 0
		START_NEW_SCRIPT yardie_mission4_loop
		SET_PLAYER_COORDINATES player 118.3 -272.6 -100.0  
	ENDIF


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	// SUBURBAN AREA 
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		
	IF mission_skip_index = 61  // UZI Money
		GOSUB kill_all_scripts
		flag_hood_mission1_passed = 0
		START_NEW_SCRIPT hood_mission1_loop
		REMOVE_BLIP	maria_contact_blip
  		REMOVE_BLIP	hood_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT -443.5 -6.1 3.8 RADAR_SPRITE_ICE hood_contact_blip
		SET_PLAYER_COORDINATES player -443.0 -8.9 2.8
	ENDIF

	IF mission_skip_index = 62  // Toyminator
		GOSUB kill_all_scripts
		flag_hood_mission2_passed = 0
		START_NEW_SCRIPT hood_mission2_loop
		SET_PLAYER_COORDINATES player -443.0 -8.9 2.8
	ENDIF

	IF mission_skip_index = 63  // Rigged To Blow
		GOSUB kill_all_scripts

		// this fucking script does not want to die, cycle it a few times. This causes a difficult to debug crash.

		flag_hood_mission3_passed = 1
		flag_hood_mission5_passed = 0

		WAIT 300

		flag_hood_mission3_passed = 0
		START_NEW_SCRIPT hood_mission3_loop
		
		flag_hood_mission3_passed = 1
		flag_hood_mission5_passed = 0

		WAIT 300

		flag_hood_mission3_passed = 0
		START_NEW_SCRIPT hood_mission3_loop
		
		SET_PLAYER_COORDINATES player -443.0 -8.9 2.8
	ENDIF

	IF mission_skip_index = 64  // Bullion Run
		GOSUB kill_all_scripts
		flag_hood_mission4_passed = 0
		START_NEW_SCRIPT hood_mission4_loop
		SET_PLAYER_COORDINATES player -443.0 -8.9 2.8
	ENDIF

	IF mission_skip_index = 65  // Rumble
		GOSUB kill_all_scripts
		flag_hood_mission5_passed = 0
		START_NEW_SCRIPT hood_mission5_loop
		SET_PLAYER_COORDINATES player -443.0 -8.9 2.8
	ENDIF

	IF mission_skip_index = 66  // The Exchange
		GOSUB kill_all_scripts

		flag_cat_mission1_passed = 0
		START_NEW_SCRIPT cat_mission1_loop
		REMOVE_BLIP	hood_contact_blip
		REMOVE_BLIP	maria_contact_blip
		ADD_SPRITE_BLIP_FOR_CONTACT_POINT -362.8 245.9 60.0 RADAR_SPRITE_CAT maria_contact_blip
		SET_PLAYER_COORDINATES player -362.0 240.2 60.5
		ADD_SCORE player 500000
	ENDIF

	// reset
	god_mode_activated = 0
ENDIF


GOTO mission_start_mission_skip

MISSION_END 



// Set them as passed so they will bail out of their loops and terminate.

kill_all_scripts:

    flag_eightball_mission_passed = 1
	flag_luigi_mission2_passed = 1
	flag_luigi_mission3_passed = 1
	flag_luigi_mission4_passed = 1
	flag_luigi_mission5_passed = 1
	flag_joey_mission1_passed = 1
	flag_joey_mission2_passed = 1
	flag_joey_mission3_passed = 1
	flag_joey_mission4_passed = 1
	flag_joey_mission5_passed = 1
	flag_joey_mission6_passed = 1
	flag_toni_mission1_passed = 1
	flag_toni_mission2_passed = 1
	flag_toni_mission3_passed = 1
	flag_toni_mission4_passed = 1
	flag_toni_mission5_passed = 1
	flag_frankie_mission1_passed = 1
	flag_frankie_mission2_passed = 1
	flag_frankie_mission2.1_passed = 1
	flag_frankie_mission3_passed = 1
	flag_frankie_mission4_passed = 1
	flag_diablo_mission1_passed = 1
	flag_diablo_mission2_passed = 1
	flag_diablo_mission3_passed = 1
	flag_diablo_mission4_passed = 1
	flag_meat_mission1_passed = 1
	flag_meat_mission2_passed = 1
	flag_meat_mission3_passed = 1
	flag_meat_mission4_passed = 1

	flag_asuka_mission1_passed = 1
	flag_asuka_mission2_passed = 1
	flag_asuka_mission3_passed = 1
	flag_asuka_mission4_passed = 1
	flag_asuka_mission5_passed = 1
	flag_asuka_suburban_mission1_passed = 1
	flag_asuka_suburban_mission2_passed = 1
	flag_asuka_suburban_mission3_passed = 1
	flag_kenji_mission1_passed = 1
	flag_kenji_mission2_passed = 1
	flag_kenji_mission3_passed = 1
	flag_kenji_mission4_passed = 1
	flag_kenji_mission5_passed = 1
	flag_ray_mission1_passed = 1
	flag_ray_mission2_passed = 1
	flag_ray_mission3_passed = 1
	flag_ray_mission4_passed = 1
	flag_ray_mission5_passed = 1
	flag_ray_mission6_passed = 1
	flag_love_mission1_passed = 1
	flag_love_mission2_passed = 1
	flag_love_mission3_passed = 1
	flag_love_mission4_passed = 1
	flag_love_mission5_passed = 1
	flag_love_mission6_passed = 1
	flag_love_mission7_passed = 1
	flag_yardie_mission1_passed = 1
	flag_yardie_mission2_passed = 1
	flag_yardie_mission3_passed = 1
	flag_yardie_mission4_passed = 1

	flag_hood_mission1_passed = 1
	flag_hood_mission2_passed = 1
	flag_hood_mission3_passed = 1
	flag_hood_mission4_passed = 1
	flag_hood_mission5_passed = 1
	flag_cat_mission1_passed = 1


	flag_player_on_mission = 0 

	WAIT 300
	
	IF IS_PLAYER_PLAYING player  // Stop asserting about checking is the player is dead every frame!
	ENDIF

	// after script termination reset the mission flags so they don't terminate after a mission complete
	flag_eightball_mission_passed = 0
	flag_luigi_mission2_passed = 0
	flag_luigi_mission3_passed = 0
	flag_luigi_mission4_passed = 0
	flag_luigi_mission5_passed = 0
	flag_joey_mission1_passed = 0
	flag_joey_mission2_passed = 0
	flag_joey_mission3_passed = 0
	flag_joey_mission4_passed = 0
	flag_joey_mission5_passed = 0
	flag_joey_mission6_passed = 0
	flag_toni_mission1_passed = 0
	flag_toni_mission2_passed = 0
	flag_toni_mission3_passed = 0
	flag_toni_mission4_passed = 0
	flag_toni_mission5_passed = 0
	flag_frankie_mission1_passed = 0
	flag_frankie_mission2_passed = 0
	flag_frankie_mission2.1_passed = 0
	flag_frankie_mission3_passed = 0
	flag_frankie_mission4_passed = 0
	flag_diablo_mission1_passed = 0
	flag_diablo_mission2_passed = 0
	flag_diablo_mission3_passed = 0
	flag_diablo_mission4_passed = 0
	flag_meat_mission1_passed = 0
	flag_meat_mission2_passed = 0
	flag_meat_mission3_passed = 0
	flag_meat_mission4_passed = 0

	flag_asuka_mission1_passed = 0
	flag_asuka_mission2_passed = 0
	flag_asuka_mission3_passed = 0
	flag_asuka_mission4_passed = 0
	flag_asuka_mission5_passed = 0
	flag_asuka_suburban_mission1_passed = 0
	flag_asuka_suburban_mission2_passed = 0
	flag_asuka_suburban_mission3_passed = 0
	flag_kenji_mission1_passed = 0
	flag_kenji_mission2_passed = 0
	flag_kenji_mission3_passed = 0
	flag_kenji_mission4_passed = 0
	flag_kenji_mission5_passed = 0
	flag_ray_mission1_passed = 0
	flag_ray_mission2_passed = 0
	flag_ray_mission3_passed = 0
	flag_ray_mission4_passed = 0
	flag_ray_mission5_passed = 0
	flag_ray_mission6_passed = 0
	flag_love_mission1_passed = 0
	flag_love_mission2_passed = 0
	flag_love_mission3_passed = 0
	flag_love_mission4_passed = 0
	flag_love_mission5_passed = 0
	flag_love_mission6_passed = 0
	flag_love_mission7_passed = 0
	flag_yardie_mission1_passed = 0
	flag_yardie_mission2_passed = 0
	flag_yardie_mission3_passed = 0
	flag_yardie_mission4_passed = 0

	flag_hood_mission1_passed = 0
	flag_hood_mission2_passed = 0
	flag_hood_mission3_passed = 0
	flag_hood_mission4_passed = 0
	flag_hood_mission5_passed = 0
	flag_cat_mission1_passed = 0

RETURN

	
MISSION_START
// *****************************************************************************************
// ************************************   The Intro    ************************************* 
// *****************************************************************************************

// Mission start stuff

//GOSUB mission_start_intro
//
//GOSUB mission_cleanup_intro
//
//MISSION_END
 
// Variables for mission

VAR_INT cs_cathead cs_robb robber cs_cs_ban cs_loot	cs_colt1 cs_colt2 cs_bankd csbexpos	skip_flag text_fading_flag
VAR_INT cs_colombian1 cs_colombian2 cs_cop1 cs_cop2	damagea damageb	brbomb cs_colombian1head text_alpha

VAR_FLOAT particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z temp_var

// ****************************************Mission Start************************************

mission_start_intro:

flag_player_on_mission = 1
skip_flag = 0

WAIT 0

{
SCRIPT_NAME intro

SET_FADING_COLOUR 0 0 0

DO_FADE 0 FADE_OUT

SET_EVERYONE_IGNORE_PLAYER player TRUE
SET_PLAYER_CONTROL player OFF
SET_PLAYER_VISIBLE player FALSE
SWITCH_STREAMING OFF

//SET_DEATHARREST_STATE OFF

SWITCH_RUBBISH OFF

// **********************************START OF BANK CUTSCENE****************************

MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

SET_INTRO_IS_PLAYING TRUE

LOAD_COLLISION LEVEL_GENERIC
LOAD_SPECIAL_CHARACTER 1 cat
LOAD_SPECIAL_CHARACTER 2 colrob
LOAD_SPECIAL_CHARACTER 3 miguel
LOAD_SPECIAL_CHARACTER 4 playerx
LOAD_SPECIAL_MODEL cut_obj1	cs_ban
LOAD_SPECIAL_MODEL cut_obj2 bankd
LOAD_SPECIAL_MODEL cut_obj3	cs_loot
LOAD_SPECIAL_MODEL cut_obj4	colt1
LOAD_SPECIAL_MODEL cut_obj5	cath

GET_PLAYER_CHAR	player script_controlled_player
IF NOT IS_CHAR_DEAD script_controlled_player
	
	UNDRESS_CHAR script_controlled_player player
	WHILE NOT HAS_MODEL_LOADED PED_PLAYER 
		WAIT 0
		
	ENDWHILE
	
	IF NOT IS_CHAR_DEAD script_controlled_player
		DRESS_CHAR script_controlled_player
	ENDIF
ENDIF

SET_MOTION_BLUR 5
FORCE_WEATHER_NOW WEATHER_FOGGY
SET_TIME_OF_DAY 12 00

SWITCH_WORLD_PROCESSING OFF

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj4
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED cut_obj5
OR NOT HAS_SPECIAL_CHARACTER_LOADED 3
OR NOT HAS_SPECIAL_CHARACTER_LOADED 4
	WAIT 0
ENDWHILE

LOAD_CUTSCENE bet
LOAD_SCENE -559.65 1030.56 40.0

SET_CUTSCENE_OFFSET -537.42 1051.204 36.884

CREATE_CUTSCENE_OBJECT PED_SPECIAL4 cs_player
SET_CUTSCENE_ANIM cs_player playerx

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_cat
SET_CUTSCENE_ANIM cs_cat cat

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_robb
SET_CUTSCENE_ANIM cs_robb colrob

CREATE_CUTSCENE_OBJECT PED_SPECIAL3 cs_miguel
SET_CUTSCENE_ANIM cs_miguel miguel

CREATE_CUTSCENE_HEAD cs_cat cut_obj5 cs_cathead
SET_CUTSCENE_HEAD_ANIM cs_cathead cat

CREATE_CUTSCENE_OBJECT cut_obj1 cs_cs_ban
SET_CUTSCENE_ANIM cs_cs_ban cs_ban

CREATE_CUTSCENE_OBJECT cut_obj2 cs_bankd
SET_CUTSCENE_ANIM cs_bankd bankd

CREATE_CUTSCENE_OBJECT cut_obj3 cs_loot
SET_CUTSCENE_ANIM cs_loot cs_loot

CREATE_CUTSCENE_OBJECT cut_obj4 cs_colt1
SET_CUTSCENE_ANIM cs_colt1 colt1

CREATE_CUTSCENE_OBJECT cut_obj4 cs_colt2
SET_CUTSCENE_ANIM cs_colt2 colt2

SET_OBJECT_DRAW_LAST cs_cs_ban TRUE

SWITCH_STREAMING ON

START_CUTSCENE

WAIT 1000  // WDTOM the camera is not in the right place yet!

DO_FADE 2000 FADE_IN

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 17166//17033
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

SET_MOTION_BLUR 3 //SETS UP THE GREEN SECURITY CAMERA

WHILE cs_time < 18126//18266
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

SET_MUSIC_DOES_FADE FALSE
IF NOT HAS_CUTSCENE_FINISHED
	SET_FADING_COLOUR 255 255 255 //FLASH SCREEN FOR PLAYER SHOOTING CAMERA
	DO_FADE 100 FADE_OUT
	
	particle_x = -537.42 + 1.759
	particle_y = 1051.204 - 0.416
	particle_z = 36.884	+ 1.9891

	particle_target_x =	-537.42	+ 2.08
	particle_target_y =	1051.204 - 0.9842
	particle_target_z =	36.884 + 2.6714

	temp_var = particle_target_x
	particle_target_x =	particle_x - temp_var

	temp_var = particle_target_y
	particle_target_y =	particle_y - temp_var

	temp_var = particle_target_z
	particle_target_z =	particle_z - temp_var

	ADD_MOVING_PARTICLE_EFFECT POBJECT_CATALINAS_SHOTGUNFLASH particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 1.0 0 0 0 0

	WHILE GET_FADING_STATUS
		WAIT 0
		GOSUB skip_intro_button
		IF skip_flag = 2
			GOTO skip_intro_here
		ENDIF
	ENDWHILE
ENDIF

IF NOT HAS_CUTSCENE_FINISHED
	SET_FADING_COLOUR 1 1 1
	DO_FADE 0 FADE_OUT

	//WDCARL - Fades of 0 need to be checked on
	WHILE GET_FADING_STATUS
		WAIT 0
	ENDWHILE

//	WHILE GET_FADING_STATUS
//		WAIT 0
//		GOSUB skip_intro_button
//		IF skip_flag = 2
//			GOTO skip_intro_here
//		ENDIF
//	ENDWHILE
ENDIF

WHILE cs_time < 18733
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

IF NOT HAS_CUTSCENE_FINISHED
	SET_FADING_COLOUR 1 1 1
	DO_FADE 0 FADE_IN
ENDIF

SET_MOTION_BLUR 5

WHILE cs_time < 25249
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW BETRA_A 4000 1 //"Sorry babe."

WHILE cs_time < 26060
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW BETRA_B 5000 1 //"I'm an ambituos girl and you,"

WHILE cs_time < 27000
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

particle_x = -537.42 - 1.3329
particle_y = 1051.204 + 25.8224
particle_z = 36.884	+ 1.367

particle_target_x =	-537.42	- 0.393
particle_target_y =	1051.204 + 25.8211
particle_target_z =	36.884 + 1.4532

temp_var = particle_target_x
particle_target_x =	particle_x - temp_var

temp_var = particle_target_y
particle_target_y =	particle_y - temp_var

temp_var = particle_target_z
particle_target_z =	particle_z - temp_var

ADD_MOVING_PARTICLE_EFFECT POBJECT_CATALINAS_GUNFLASH particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 1.0 0 0 0 0

WHILE cs_time < 27030
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

particle_x = -537.42 - 1.813
particle_y = 1051.204 + 26.0638
particle_z = 36.884	+ 1.369

particle_target_x =	-537.42	- 0.4432
particle_target_y =	1051.204 + 25.9765
particle_target_z =	36.884 + 1.4258

temp_var = particle_target_x
particle_target_x =	particle_x - temp_var

temp_var = particle_target_y
particle_target_y =	particle_y - temp_var

temp_var = particle_target_z
particle_target_z =	particle_z - temp_var

ADD_MOVING_PARTICLE_EFFECT POBJECT_CATALINAS_GUNFLASH particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 1.0 0 0 0 0

WHILE cs_time < 27100
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

SET_MOTION_BLUR 8 //PLAYER IS SHOT MOTION BLUR

IF NOT HAS_CUTSCENE_FINISHED
	SET_FADING_COLOUR 255 255 255
	DO_FADE 100 FADE_OUT
	WHILE GET_FADING_STATUS
		WAIT 0
		GOSUB skip_intro_button
		IF skip_flag = 2
			GOTO skip_intro_here
		ENDIF
	ENDWHILE
ENDIF

IF NOT HAS_CUTSCENE_FINISHED
	DO_FADE 600 FADE_IN
	WHILE GET_FADING_STATUS
		WAIT 0
		GOSUB skip_intro_button
		IF skip_flag = 2
			GOTO skip_intro_here
		ENDIF
	ENDWHILE
ENDIF

SET_FADING_COLOUR 0 0 0

WHILE cs_time < 28710
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW BETRA_C 2282 1 //"you're just small time."

SET_MUSIC_DOES_FADE TRUE

WHILE cs_time < 29200
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

SET_MOTION_BLUR 5

WHILE cs_time < 30800
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

SET_MOTION_BLUR 8 //PLAYER IS SHOT MOTION BLUR

WHILE cs_time < 30992
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS
CLEAR_SMALL_PRINTS

WHILE cs_time < 33333
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

IF NOT HAS_CUTSCENE_FINISHED
	LOAD_SPLASH_SCREEN NEWS  // This creates a transition.
ENDIF

WHILE cs_time < 37000  // Look for the user exit during the wait for the news.
	WAIT 0
	
	GOSUB skip_intro_button
	
	IF skip_flag = 2
		LOAD_SPLASH_SCREEN NEWSEND  // Kill the news transition.
		GOTO skip_intro_here
	ENDIF
	
	GET_CUTSCENE_TIME cs_time

ENDWHILE

SET_FADING_COLOUR 0 0 0

text_alpha = 0
text_fading_flag = 0

USE_TEXT_COMMANDS TRUE

GOSUB draw_intro_text

WHILE GET_FADING_STATUS
	WAIT 0
	GOSUB draw_intro_text
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
ENDWHILE

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
	GOSUB draw_intro_text
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
ENDWHILE

//LOAD_TEXTURE_DICTIONARY INTRO
//LOAD_SPRITE 1 gtalogo
//LOAD_SPRITE 2 gta3bit
//DRAW_SPRITE 1 192.0 96.0 256.0 256.0 255 255 255 text_alpha
//DRAW_SPRITE 2 339.0 224.0 128.0 128.0 255 255 255 text_alpha
//REMOVE_TEXTURE_DICTIONARY

CLEAR_PRINTS
CLEAR_SMALL_PRINTS
CLEAR_CUTSCENE

MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

FORCE_WEATHER_NOW WEATHER_RAINY
FORCE_RAIN TRUE

UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
UNLOAD_SPECIAL_CHARACTER 3
UNLOAD_SPECIAL_CHARACTER 4
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj3
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj4
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj5

// **********************************END OF BANK CUTSCENE******************************

// ******************************START OF JAIL BREAK CUTSCENE**************************

SWITCH_STREAMING OFF

LOAD_COLLISION LEVEL_COMMERCIAL
SET_PLAYER_COORDINATES player 820.9 -941.1 -100.0

SET_FADING_COLOUR 0 0 0
SET_MOTION_BLUR 6

LOAD_SPECIAL_CHARACTER 1 eight
LOAD_SPECIAL_CHARACTER 2 OJG_P
LOAD_SPECIAL_CHARACTER 3 col1
LOAD_SPECIAL_CHARACTER 4 col2
LOAD_SPECIAL_MODEL cut_obj1	CS_TRUK
LOAD_SPECIAL_MODEL cut_obj2	REBEL
LOAD_SPECIAL_MODEL cut_obj3	brbomb
LOAD_SPECIAL_MODEL cut_obj4	COL1H
REQUEST_MODEL bridgefuka
REQUEST_MODEL bridgefukb

SET_TIME_OF_DAY 2 00

REQUEST_MODEL trafficlight1
REQUEST_MODEL rd_SrRoad2A50
REQUEST_MODEL rd_SrRoad2A20
REQUEST_MODEL rd_SrRoad2A10
REQUEST_MODEL rd_CrossRda1rw22
REQUEST_MODEL rd_CrossRoadsa24
REQUEST_MODEL com_cust_roads25
REQUEST_MODEL veg_tree3
REQUEST_MODEL doublestreetlght1
REQUEST_MODEL veg_treea3
REQUEST_MODEL veg_treenew17
REQUEST_MODEL Streetlamp1
REQUEST_MODEL bollardlight
REQUEST_MODEL kb_scrap_5
REQUEST_MODEL policetenkb1
REQUEST_MODEL scraperkb3_nit
REQUEST_MODEL chunk5land
REQUEST_MODEL policeally
REQUEST_MODEL police_com
REQUEST_MODEL rd_CrossRda1w22
REQUEST_MODEL treepatchkb7
REQUEST_MODEL roadplanterkb3
REQUEST_MODEL roadplanterkb1
REQUEST_MODEL rd_Road3A50
REQUEST_MODEL amco_floor

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_SPECIAL_CHARACTER_LOADED 3
OR NOT HAS_SPECIAL_CHARACTER_LOADED 4
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
	WAIT 0
	GOSUB draw_intro_text
ENDWHILE

WHILE NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj4
OR NOT HAS_MODEL_LOADED bridgefuka
OR NOT HAS_MODEL_LOADED bridgefukb
	WAIT 0
	GOSUB draw_intro_text
ENDWHILE

GET_PLAYER_CHAR	player script_controlled_player
IF NOT IS_CHAR_DEAD script_controlled_player
	
	UNDRESS_CHAR script_controlled_player playerp
	WHILE NOT HAS_MODEL_LOADED PED_PLAYER 
		WAIT 0
		GOSUB draw_intro_text
	ENDWHILE
	
	IF NOT IS_CHAR_DEAD script_controlled_player
		DRESS_CHAR script_controlled_player
	ENDIF
ENDIF

LOAD_CUTSCENE JB

SET_CUTSCENE_OFFSET 0.0 0.0 0.0

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player playerp

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_eight
SET_CUTSCENE_ANIM cs_eight eight

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_ojg
SET_CUTSCENE_ANIM cs_ojg ojg_p

CREATE_CUTSCENE_OBJECT PED_SPECIAL3 cs_colombian1
SET_CUTSCENE_ANIM cs_colombian1 col1

CREATE_CUTSCENE_OBJECT PED_SPECIAL4 cs_colombian2
SET_CUTSCENE_ANIM cs_colombian2 col2

CREATE_CUTSCENE_OBJECT PED_COP cs_cop1
SET_CUTSCENE_ANIM cs_cop1 cop

CREATE_CUTSCENE_OBJECT PED_COP cs_cop2
SET_CUTSCENE_ANIM cs_cop2 male01

CREATE_CUTSCENE_HEAD cs_colombian1 cut_obj4 cs_colombian1head
SET_CUTSCENE_HEAD_ANIM cs_colombian1head col1

CREATE_CUTSCENE_OBJECT cut_obj1 cs_colt1
SET_CUTSCENE_ANIM cs_colt1 CS_TRUK

CREATE_CUTSCENE_OBJECT cut_obj2 cs_colt2
SET_CUTSCENE_ANIM cs_colt2 REBEL

CREATE_CUTSCENE_OBJECT cut_obj3 brbomb
SET_CUTSCENE_ANIM brbomb brbomb

SET_OBJECT_DRAW_LAST cs_colt1 TRUE
SET_OBJECT_DRAW_LAST cs_colt2 TRUE

START_CUTSCENE
START_CHASE_SCENE 1.0

CLEAR_PRINTS
CLEAR_SMALL_PRINTS

GET_CUTSCENE_TIME cs_time
					  
REQUEST_MODEL rd_CrossRda1w22
REQUEST_MODEL rd_Road2A20
REQUEST_MODEL broadwaybuild2
REQUEST_MODEL broadwaybuild
REQUEST_MODEL area5build2
REQUEST_MODEL comswcentralbld7
REQUEST_MODEL papermachn01
REQUEST_MODEL comswcentralbld6
REQUEST_MODEL com_21way5
REQUEST_MODEL com_21way50
REQUEST_MODEL com_21way10
REQUEST_MODEL cm1waycrosscom
REQUEST_MODEL com_21way20
REQUEST_MODEL tw@t_cafe
REQUEST_MODEL veg_bush14
REQUEST_MODEL treepatchttwrs
REQUEST_MODEL flatiron1
REQUEST_MODEL veg_tree3
REQUEST_MODEL veg_treenew17
REQUEST_MODEL block4_ground01

WAIT 0
LOAD_SPLASH_SCREEN NEWSEND  // Kill the news transition.

WHILE cs_time < 9500
	WAIT 0
	text_fading_flag = 1
	GOSUB draw_intro_text
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	DRAW_LIGHT 196.077 -1126.984 25.626	235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

MARK_MODEL_AS_NO_LONGER_NEEDED rd_SrRoad2A50
MARK_MODEL_AS_NO_LONGER_NEEDED rd_SrRoad2A20
MARK_MODEL_AS_NO_LONGER_NEEDED rd_SrRoad2A10
MARK_MODEL_AS_NO_LONGER_NEEDED rd_CrossRoadsa24
MARK_MODEL_AS_NO_LONGER_NEEDED com_cust_roads25
MARK_MODEL_AS_NO_LONGER_NEEDED veg_treea3
MARK_MODEL_AS_NO_LONGER_NEEDED Streetlamp1
MARK_MODEL_AS_NO_LONGER_NEEDED bollardlight
MARK_MODEL_AS_NO_LONGER_NEEDED kb_scrap_5
MARK_MODEL_AS_NO_LONGER_NEEDED policetenkb1
MARK_MODEL_AS_NO_LONGER_NEEDED scraperkb3_nit
MARK_MODEL_AS_NO_LONGER_NEEDED chunk5land
MARK_MODEL_AS_NO_LONGER_NEEDED policeally
MARK_MODEL_AS_NO_LONGER_NEEDED police_com
MARK_MODEL_AS_NO_LONGER_NEEDED treepatchkb7
MARK_MODEL_AS_NO_LONGER_NEEDED roadplanterkb3
MARK_MODEL_AS_NO_LONGER_NEEDED roadplanterkb1
MARK_MODEL_AS_NO_LONGER_NEEDED rd_Road3A50
MARK_MODEL_AS_NO_LONGER_NEEDED amco_floor


WHILE cs_time < 13007
	WAIT 0
	GOSUB draw_intro_text
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	DRAW_LIGHT 196.077 -1126.984 25.626	235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

USE_TEXT_COMMANDS FALSE
//PRINT_NOW JAILB_V 10000 1//"Liberty city is in shock today."

WHILE cs_time < 14500
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	DRAW_LIGHT 196.077 -1126.984 25.626	235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_A 10000 1//"As the police and emergency services deal with the aftermath..."

WHILE cs_time < 15933
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	DRAW_LIGHT 196.077 -1126.984 25.626	235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

REQUEST_MODEL planter_short
REQUEST_MODEL com_rvroads52
REQUEST_MODEL road_broadway04
REQUEST_MODEL com_roadsrv
REQUEST_MODEL rd_Road1A20
REQUEST_MODEL rd_CrossRoads11
REQUEST_MODEL doublestreetlght1
REQUEST_MODEL ofis_bildkb_4
REQUEST_MODEL rd_Road1A10
REQUEST_MODEL com_roadkb23
REQUEST_MODEL com_cust_roads57
REQUEST_MODEL com_rvroads52

MARK_MODEL_AS_NO_LONGER_NEEDED rd_CrossRda1w22
MARK_MODEL_AS_NO_LONGER_NEEDED rd_Road2A20
MARK_MODEL_AS_NO_LONGER_NEEDED broadwaybuild2
MARK_MODEL_AS_NO_LONGER_NEEDED broadwaybuild
MARK_MODEL_AS_NO_LONGER_NEEDED area5build2
MARK_MODEL_AS_NO_LONGER_NEEDED papermachn01
MARK_MODEL_AS_NO_LONGER_NEEDED com_21way5
MARK_MODEL_AS_NO_LONGER_NEEDED tw@t_cafe
MARK_MODEL_AS_NO_LONGER_NEEDED treepatchttwrs
MARK_MODEL_AS_NO_LONGER_NEEDED flatiron1
MARK_MODEL_AS_NO_LONGER_NEEDED veg_tree3
MARK_MODEL_AS_NO_LONGER_NEEDED veg_treenew17
MARK_MODEL_AS_NO_LONGER_NEEDED block4_ground01
MARK_MODEL_AS_NO_LONGER_NEEDED comswcentralbld7
MARK_MODEL_AS_NO_LONGER_NEEDED papermachn01

WHILE cs_time < 17514 
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	DRAW_LIGHT 196.077 -1126.984 25.626	235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_B 10000 1//"of a devastating attack on a police convoy this morning."

WHILE cs_time < 18933
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

REQUEST_MODEL com_roadkb23
REQUEST_MODEL com_roadkb22
REQUEST_MODEL kb_underpass
REQUEST_MODEL museum
REQUEST_MODEL nbcom_roadkb01
REQUEST_MODEL bvbridgspprt01
REQUEST_MODEL flatiron1b
REQUEST_MODEL veg_tree3
REQUEST_MODEL nbbridgcabls01
REQUEST_MODEL nbbridgerdb
REQUEST_MODEL nbbridgerda
REQUEST_MODEL nbbridgcabls01
REQUEST_MODEL bvbridgspprt01
REQUEST_MODEL overpass_comse
REQUEST_MODEL com_landnew221b
REQUEST_MODEL nbcom_roadkb01
REQUEST_MODEL com_landnew221
REQUEST_MODEL flatiron1b
REQUEST_MODEL LODtiron1b
REQUEST_MODEL veg_tree3
REQUEST_MODEL ofis_bildkb_4
REQUEST_MODEL kb_ofis1
REQUEST_MODEL comtreepatchprk
REQUEST_MODEL Hotel2
REQUEST_MODEL underground_over7
REQUEST_MODEL rd_Road1A50
REQUEST_MODEL kb_underpass
REQUEST_MODEL kbplanter4
REQUEST_MODEL block4_scraperl0
REQUEST_MODEL com_roadkb12
REQUEST_MODEL planterbtm_1
REQUEST_MODEL LODridgspprt01
REQUEST_MODEL LODom_roadkb01
REQUEST_MODEL LODridgerda
REQUEST_MODEL LODridgerdb
REQUEST_MODEL LODridgcabls01
MARK_MODEL_AS_NO_LONGER_NEEDED com_21way20
MARK_MODEL_AS_NO_LONGER_NEEDED cm1waycrosscom
MARK_MODEL_AS_NO_LONGER_NEEDED com_21way10
MARK_MODEL_AS_NO_LONGER_NEEDED comswcentralbld7
MARK_MODEL_AS_NO_LONGER_NEEDED comswcentralbld6

SET_NEAR_CLIP 2.5

WHILE cs_time < 20667
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_C 10000 1//"No details have been released about the prisoners being transferred in the convoy,"

WHILE cs_time < 22181
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

SET_NEAR_CLIP 4.5

WHILE cs_time < 24522
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_D 10000 1//"And no group, terrorists or otherwise have claimed responsibility."

WHILE cs_time < 27208 
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_E 10000 1//"The convoy left Police head quarters early this morning..."

WHILE cs_time < 29793 
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_F 10000 1//"for a routine transfer to Liberty penitentiary."

WHILE cs_time < 30599 //VERY HIGH SHOT TOWARDS BRIDGE
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

SET_NEAR_CLIP 5.5
REQUEST_MODEL ind_customroad003

MARK_MODEL_AS_NO_LONGER_NEEDED planter_short
MARK_MODEL_AS_NO_LONGER_NEEDED com_rvroads52
MARK_MODEL_AS_NO_LONGER_NEEDED road_broadway04
MARK_MODEL_AS_NO_LONGER_NEEDED com_roadsrv
MARK_MODEL_AS_NO_LONGER_NEEDED rd_Road1A20
MARK_MODEL_AS_NO_LONGER_NEEDED rd_CrossRoads11
MARK_MODEL_AS_NO_LONGER_NEEDED com_21way50
MARK_MODEL_AS_NO_LONGER_NEEDED rd_Road1A10
MARK_MODEL_AS_NO_LONGER_NEEDED com_cust_roads57

WHILE cs_time < 32986
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_G 10000 1//"The attack took place on Callahan bridge,"

WHILE cs_time < 34817
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_H 10000 1//"leaving few witness', several dead officers and bridge itself severely damaged."

WHILE cs_time < 38590
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_I 10000 1//"Some of the convicts are thought to have perished in the explosion..."

WHILE cs_time < 40842
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_J 10000 1//"that followed the initial attack, although police divers are yet to find any remains."

WHILE cs_time < 42066
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

SET_NEAR_CLIP 4.5

REQUEST_MODEL kmricndo01
REQUEST_MODEL kmricndo02
REQUEST_MODEL veg_treenew17
REQUEST_MODEL com_docksaa
REQUEST_MODEL com_pier3
REQUEST_MODEL gRD_overpass19kb
REQUEST_MODEL gRD_overpass19bkb

WHILE cs_time < 42535 
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_W 10000 1//"Revelations as to the professionalism of the attack struck police hours afterward,"

WHILE cs_time < 46683
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_K 10000 1//"When identification of the missing felons was further hampered..."

WHILE cs_time < 49483
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_L 10000 1//"by an attack by computer hackers on police head quarter databases."

WHILE cs_time < 53406
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_O 10000 1//"With the Porter tunnel project falling behind schedule,"

WHILE cs_time < 53666
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

SET_NEAR_CLIP 0.9

WHILE cs_time < 56077
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	GET_CUTSCENE_TIME cs_time
ENDWHILE

//PRINT_NOW JAILB_P 5000 1//"this disaster leaves Portland isolated from the rest of the city."

WHILE cs_time < 64200
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

REMOVE_CAR_FROM_CHASE 2

WHILE cs_time < 64333
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

REMOVE_CAR_FROM_CHASE 1

WHILE cs_time < 64566
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

REQUEST_MODEL com_docksb
REQUEST_MODEL newdockbuilding2
REQUEST_MODEL newdockbuilding
REQUEST_MODEL block4_scraperl0

MARK_MODEL_AS_NO_LONGER_NEEDED com_roadkb22
MARK_MODEL_AS_NO_LONGER_NEEDED com_roadkb23
MARK_MODEL_AS_NO_LONGER_NEEDED nbcom_roadkb01
MARK_MODEL_AS_NO_LONGER_NEEDED com_landnew221
MARK_MODEL_AS_NO_LONGER_NEEDED doublestreetlght1
MARK_MODEL_AS_NO_LONGER_NEEDED museum
MARK_MODEL_AS_NO_LONGER_NEEDED ofis_bildkb_4
MARK_MODEL_AS_NO_LONGER_NEEDED kb_ofis1
MARK_MODEL_AS_NO_LONGER_NEEDED comtreepatchprk
MARK_MODEL_AS_NO_LONGER_NEEDED Hotel2
MARK_MODEL_AS_NO_LONGER_NEEDED underground_over7
MARK_MODEL_AS_NO_LONGER_NEEDED trafficlight1
MARK_MODEL_AS_NO_LONGER_NEEDED rd_Road1A50
MARK_MODEL_AS_NO_LONGER_NEEDED veg_bush14
MARK_MODEL_AS_NO_LONGER_NEEDED kb_underpass
MARK_MODEL_AS_NO_LONGER_NEEDED ofis_bildkb_4
MARK_MODEL_AS_NO_LONGER_NEEDED kbplanter4
MARK_MODEL_AS_NO_LONGER_NEEDED planterbtm_1
MARK_MODEL_AS_NO_LONGER_NEEDED com_rvroads52

WHILE cs_time < 66171
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW JAILB_Q 1200 1//"Come on."

WHILE cs_time < 69378
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW JAILB_R 1600 1//"Señor dickhead."

WHILE cs_time < 71994
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW JAILB_S 2000 1//"It's no problem to kill you."

WHILE cs_time < 75623
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW JAILB_T 1800 1//"You gonna be sorry."

WHILE cs_time < 79633
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

MARK_MODEL_AS_NO_LONGER_NEEDED kmricndo01
MARK_MODEL_AS_NO_LONGER_NEEDED kmricndo02
MARK_MODEL_AS_NO_LONGER_NEEDED veg_tree3
MARK_MODEL_AS_NO_LONGER_NEEDED veg_treenew17
MARK_MODEL_AS_NO_LONGER_NEEDED com_docksaa
MARK_MODEL_AS_NO_LONGER_NEEDED com_pier3
MARK_MODEL_AS_NO_LONGER_NEEDED gRD_overpass19kb
MARK_MODEL_AS_NO_LONGER_NEEDED gRD_overpass19bkb

WHILE cs_time < 86089
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW JAILB_U 1800 1//"A'right, a'right. Get lost."

WHILE cs_time < 87592
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 235 255 250
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS
CLEAR_SMALL_PRINTS

WHILE cs_time < 98766
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 205 255 230
	GET_CUTSCENE_TIME cs_time
ENDWHILE

WHILE cs_time < 101866//102256
	WAIT 0
	GOSUB skip_intro_button
	IF skip_flag = 2
		GOTO skip_intro_here
	ENDIF
	DRAW_LIGHT 780.55 -942.901 39.022 205 255 230
	GET_CUTSCENE_TIME cs_time
ENDWHILE
 								
SET_MUSIC_DOES_FADE FALSE
SET_MOTION_BLUR 7 //THE EXPLOSION

IF NOT HAS_CUTSCENE_FINISHED 
	SET_FADING_COLOUR 255 255 255
	//DO_FADE 100 FADE_OUT
	LOAD_SPLASH_SCREEN WHITE
	CLEAR_PRINTS
	WHILE GET_FADING_STATUS
		WAIT 0
	ENDWHILE

ENDIF

skip_intro_here:

IF skip_flag = 2
	WAIT 0
	USE_TEXT_COMMANDS FALSE
	SET_MUSIC_DOES_FADE TRUE
	SET_FADING_COLOUR 0 0 0 
	DO_FADE 0 FADE_OUT
	//WDCARL - Fades of 0 need to be checked on
	WHILE GET_FADING_STATUS
		WAIT 0
	ENDWHILE
ENDIF

//FADE OUT AFTER EXPLOSION....
//SWAP BRIDGE FROM FIXED TO DAMAGED
MARK_MODEL_AS_NO_LONGER_NEEDED trafficlight1
MARK_MODEL_AS_NO_LONGER_NEEDED rd_SrRoad2A50
MARK_MODEL_AS_NO_LONGER_NEEDED rd_SrRoad2A20
MARK_MODEL_AS_NO_LONGER_NEEDED rd_SrRoad2A10
MARK_MODEL_AS_NO_LONGER_NEEDED rd_CrossRda1rw22
MARK_MODEL_AS_NO_LONGER_NEEDED rd_CrossRoadsa24
MARK_MODEL_AS_NO_LONGER_NEEDED com_cust_roads25
MARK_MODEL_AS_NO_LONGER_NEEDED veg_tree3
MARK_MODEL_AS_NO_LONGER_NEEDED doublestreetlght1
MARK_MODEL_AS_NO_LONGER_NEEDED veg_treea3
MARK_MODEL_AS_NO_LONGER_NEEDED veg_treenew17
MARK_MODEL_AS_NO_LONGER_NEEDED Streetlamp1
MARK_MODEL_AS_NO_LONGER_NEEDED bollardlight
MARK_MODEL_AS_NO_LONGER_NEEDED kb_scrap_5
MARK_MODEL_AS_NO_LONGER_NEEDED policetenkb1
MARK_MODEL_AS_NO_LONGER_NEEDED scraperkb3_nit
MARK_MODEL_AS_NO_LONGER_NEEDED chunk5land
MARK_MODEL_AS_NO_LONGER_NEEDED policeally
MARK_MODEL_AS_NO_LONGER_NEEDED police_com
MARK_MODEL_AS_NO_LONGER_NEEDED rd_CrossRda1w22
MARK_MODEL_AS_NO_LONGER_NEEDED treepatchkb7
MARK_MODEL_AS_NO_LONGER_NEEDED roadplanterkb3
MARK_MODEL_AS_NO_LONGER_NEEDED roadplanterkb1
MARK_MODEL_AS_NO_LONGER_NEEDED rd_Road3A50
MARK_MODEL_AS_NO_LONGER_NEEDED rd_CrossRda1w22
MARK_MODEL_AS_NO_LONGER_NEEDED rd_Road2A20
MARK_MODEL_AS_NO_LONGER_NEEDED broadwaybuild2
MARK_MODEL_AS_NO_LONGER_NEEDED broadwaybuild
MARK_MODEL_AS_NO_LONGER_NEEDED area5build2
MARK_MODEL_AS_NO_LONGER_NEEDED comswcentralbld7
MARK_MODEL_AS_NO_LONGER_NEEDED papermachn01
MARK_MODEL_AS_NO_LONGER_NEEDED comswcentralbld6
MARK_MODEL_AS_NO_LONGER_NEEDED com_21way5
MARK_MODEL_AS_NO_LONGER_NEEDED com_21way50
MARK_MODEL_AS_NO_LONGER_NEEDED com_21way10
MARK_MODEL_AS_NO_LONGER_NEEDED cm1waycrosscom
MARK_MODEL_AS_NO_LONGER_NEEDED com_21way20
MARK_MODEL_AS_NO_LONGER_NEEDED tw@t_cafe
MARK_MODEL_AS_NO_LONGER_NEEDED veg_bush14
MARK_MODEL_AS_NO_LONGER_NEEDED treepatchttwrs
MARK_MODEL_AS_NO_LONGER_NEEDED flatiron1
MARK_MODEL_AS_NO_LONGER_NEEDED veg_tree3
MARK_MODEL_AS_NO_LONGER_NEEDED veg_treenew17
MARK_MODEL_AS_NO_LONGER_NEEDED block4_ground01
MARK_MODEL_AS_NO_LONGER_NEEDED planter_short
MARK_MODEL_AS_NO_LONGER_NEEDED com_rvroads52
MARK_MODEL_AS_NO_LONGER_NEEDED road_broadway04
MARK_MODEL_AS_NO_LONGER_NEEDED com_roadsrv
MARK_MODEL_AS_NO_LONGER_NEEDED rd_Road1A20
MARK_MODEL_AS_NO_LONGER_NEEDED rd_CrossRoads11
MARK_MODEL_AS_NO_LONGER_NEEDED doublestreetlght1
MARK_MODEL_AS_NO_LONGER_NEEDED ofis_bildkb_4
MARK_MODEL_AS_NO_LONGER_NEEDED rd_Road1A10
MARK_MODEL_AS_NO_LONGER_NEEDED com_roadkb23
MARK_MODEL_AS_NO_LONGER_NEEDED com_cust_roads57
MARK_MODEL_AS_NO_LONGER_NEEDED com_rvroads52
MARK_MODEL_AS_NO_LONGER_NEEDED com_roadkb23
MARK_MODEL_AS_NO_LONGER_NEEDED com_roadkb22
MARK_MODEL_AS_NO_LONGER_NEEDED kb_underpass
MARK_MODEL_AS_NO_LONGER_NEEDED museum
MARK_MODEL_AS_NO_LONGER_NEEDED nbcom_roadkb01
MARK_MODEL_AS_NO_LONGER_NEEDED bvbridgspprt01
MARK_MODEL_AS_NO_LONGER_NEEDED flatiron1b
MARK_MODEL_AS_NO_LONGER_NEEDED LODtiron1b
MARK_MODEL_AS_NO_LONGER_NEEDED veg_tree3
MARK_MODEL_AS_NO_LONGER_NEEDED nbbridgcabls01
MARK_MODEL_AS_NO_LONGER_NEEDED nbbridgerdb
MARK_MODEL_AS_NO_LONGER_NEEDED nbbridgerda
MARK_MODEL_AS_NO_LONGER_NEEDED nbbridgcabls01
MARK_MODEL_AS_NO_LONGER_NEEDED bvbridgspprt01
MARK_MODEL_AS_NO_LONGER_NEEDED overpass_comse
MARK_MODEL_AS_NO_LONGER_NEEDED com_landnew221b
MARK_MODEL_AS_NO_LONGER_NEEDED nbcom_roadkb01
MARK_MODEL_AS_NO_LONGER_NEEDED com_landnew221
MARK_MODEL_AS_NO_LONGER_NEEDED flatiron1b
MARK_MODEL_AS_NO_LONGER_NEEDED veg_tree3
MARK_MODEL_AS_NO_LONGER_NEEDED museum
MARK_MODEL_AS_NO_LONGER_NEEDED ofis_bildkb_4
MARK_MODEL_AS_NO_LONGER_NEEDED kb_ofis1
MARK_MODEL_AS_NO_LONGER_NEEDED comtreepatchprk
MARK_MODEL_AS_NO_LONGER_NEEDED Hotel2
MARK_MODEL_AS_NO_LONGER_NEEDED underground_over7
MARK_MODEL_AS_NO_LONGER_NEEDED rd_Road1A50
MARK_MODEL_AS_NO_LONGER_NEEDED kb_underpass
MARK_MODEL_AS_NO_LONGER_NEEDED kbplanter4
MARK_MODEL_AS_NO_LONGER_NEEDED block4_scraperl0
MARK_MODEL_AS_NO_LONGER_NEEDED com_roadkb12
MARK_MODEL_AS_NO_LONGER_NEEDED planterbtm_1
MARK_MODEL_AS_NO_LONGER_NEEDED flatiron1b
MARK_MODEL_AS_NO_LONGER_NEEDED ind_customroad003
MARK_MODEL_AS_NO_LONGER_NEEDED kmricndo01
MARK_MODEL_AS_NO_LONGER_NEEDED kmricndo02
MARK_MODEL_AS_NO_LONGER_NEEDED veg_treenew17
MARK_MODEL_AS_NO_LONGER_NEEDED com_docksaa
MARK_MODEL_AS_NO_LONGER_NEEDED com_pier3
MARK_MODEL_AS_NO_LONGER_NEEDED gRD_overpass19kb
MARK_MODEL_AS_NO_LONGER_NEEDED gRD_overpass19bkb
MARK_MODEL_AS_NO_LONGER_NEEDED com_docksb
MARK_MODEL_AS_NO_LONGER_NEEDED newdockbuilding2
MARK_MODEL_AS_NO_LONGER_NEEDED newdockbuilding
MARK_MODEL_AS_NO_LONGER_NEEDED block4_scraperl0
MARK_MODEL_AS_NO_LONGER_NEEDED LODridgcabls01
SWAP_NEAREST_BUILDING_MODEL	525.362 -927.066 71.841	20.0 nbbridgcabls01 nbbridgfk2	
SWAP_NEAREST_BUILDING_MODEL	706.432 -935.82  67.071	20.0 nbbridgcabls01 nbbridgfk2
SWAP_NEAREST_BUILDING_MODEL	529.023 -920.098 43.504 20.0 nbbridgerdb damgbridgerdb 
SWAP_NEAREST_BUILDING_MODEL	702.763 -939.963 38.736	20.0 nbbridgerdb damgbridgerdb 
SWAP_NEAREST_BUILDING_MODEL	529.023 -942.94  43.504	20.0 nbbridgerda damgbbridgerda	
SWAP_NEAREST_BUILDING_MODEL	702.764 -919.963 38.736	20.0 nbbridgerda damgbbridgerda	

SWAP_NEAREST_BUILDING_MODEL	525.362 -927.066 71.841	20.0 lodridgcabls01 lodridgfk2	
SWAP_NEAREST_BUILDING_MODEL	706.432 -935.82  67.071	20.0 lodridgcabls01 lodridgfk2	
SWAP_NEAREST_BUILDING_MODEL	521.146 -922.94  43.504 20.0 lodridgerdb lodgbridgerdb 
SWAP_NEAREST_BUILDING_MODEL	702.763 -939.963 38.736	20.0 lodridgerdb lodgbridgerdb 
SWAP_NEAREST_BUILDING_MODEL	529.023 -940.098 43.504	20.0 lodridgerda lodgbbridgerda	
SWAP_NEAREST_BUILDING_MODEL	702.764 -919.963 38.736	20.0 lodridgerda lodgbbridgerda

CREATE_OBJECT_NO_OFFSET bridgefuka 715.746 -937.908 40.194 damagea
CREATE_OBJECT_NO_OFFSET bridgefukb 787.835 -939.24 38.971 damageb

SET_PLAYER_COORDINATES player 811.90 -939.95 35.8
SET_PLAYER_HEADING player 180.0

SWITCH_WORLD_PROCESSING ON
SWITCH_STREAMING ON

USE_TEXT_COMMANDS FALSE

//ADD_PARTICLE_EFFECT 4 791.661 -936.916 38.313 TRUE //SMOKE ON CARS
//ADD_PARTICLE_EFFECT 4 788.337 -938.467 38.073 TRUE
//ADD_PARTICLE_EFFECT	4 786.493 -942.398 39.8 TRUE
//
//ADD_PARTICLE_EFFECT 10 783.572 -938.549 38.448 TRUE //FIRE ON CARS
//ADD_PARTICLE_EFFECT 10 790.537 -935.67  38.005 TRUE
//ADD_PARTICLE_EFFECT 10 789.295 -938.882 38.127 TRUE

TIMERA = 6001
GOSUB do_bridge_particles

ADD_CONTINUOUS_SOUND 790.537 -935.67  38.005 SOUND_PRETEND_FIRE_LOOP fire_sound_8ball

USE_TEXT_COMMANDS FALSE

IF NOT skip_flag = 2

	SET_PLAYER_VISIBLE player TRUE
	REQUEST_MODEL CAR_KURUMA
	LOAD_ALL_MODELS_NOW
	WHILE NOT HAS_MODEL_LOADED CAR_KURUMA
		WAIT 0
		GOSUB do_bridge_particles
	ENDWHILE
	CREATE_CAR CAR_KURUMA 812.0131 -945.5528 35.7889 car_eightball
	CHANGE_CAR_COLOUR car_eightball 58 1
	SET_CAR_HEADING car_eightball 262.3871

	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 811.90 -942.47 -100.0 eightball
	SET_ANIM_GROUP_FOR_CHAR eightball ANIM_GANG2_PED
	CLEAR_CHAR_THREAT_SEARCH eightball
	TURN_CHAR_TO_FACE_COORD eightball 811.90 -939.95 35.8
	CHAR_LOOK_AT_PLAYER_ALWAYS eightball player

	STOP_CHASE_SCENE
//	REMOVE_CAR_FROM_CHASE 0
//	REMOVE_CAR_FROM_CHASE 3
//	REMOVE_CAR_FROM_CHASE 4
//	REMOVE_CAR_FROM_CHASE 5
//	REMOVE_CAR_FROM_CHASE 6
//	REMOVE_CAR_FROM_CHASE 7
//	REMOVE_CAR_FROM_CHASE 8
//	REMOVE_CAR_FROM_CHASE 9
//	REMOVE_CAR_FROM_CHASE 10
//	REMOVE_CAR_FROM_CHASE 11
//	REMOVE_CAR_FROM_CHASE 12
//	REMOVE_CAR_FROM_CHASE 13
//	REMOVE_CAR_FROM_CHASE 14
//	REMOVE_CAR_FROM_CHASE 15
//	REMOVE_CAR_FROM_CHASE 16
//	REMOVE_CAR_FROM_CHASE 17
//	REMOVE_CAR_FROM_CHASE 18
//	REMOVE_CAR_FROM_CHASE 19
	MARK_MODEL_AS_NO_LONGER_NEEDED  LODridgspprt01
	MARK_MODEL_AS_NO_LONGER_NEEDED  LODom_roadkb01
	MARK_MODEL_AS_NO_LONGER_NEEDED  LODridgerda
	MARK_MODEL_AS_NO_LONGER_NEEDED  LODridgerdb

	WHILE cs_time < 107172//111172 //103333//3100
		WAIT 0
		GOSUB do_bridge_particles
		GOSUB skip_intro_button
		IF skip_flag = 2
			GOTO skip_intro_here
		ENDIF
		DRAW_LIGHT 780.55 -942.901 39.022 205 255 230
		GET_CUTSCENE_TIME cs_time
	ENDWHILE
 								
	IF NOT HAS_CUTSCENE_FINISHED 
		SET_FADING_COLOUR 255 255 255
		//DO_FADE 6000 FADE_IN
		LOAD_SPLASH_SCREEN WHTEEND
		CLEAR_PRINTS
		WHILE GET_FADING_STATUS
			WAIT 0
		GOSUB do_bridge_particles
		ENDWHILE
	ENDIF
	
	WHILE cs_time < 121666//3650
		WAIT 0
		GOSUB do_bridge_particles
		GOSUB skip_intro_button
		IF skip_flag = 2
			GOTO skip_intro_here
		ENDIF
		DRAW_LIGHT 780.55 -942.901 39.022 205 255 230
		GET_CUTSCENE_TIME cs_time
	ENDWHILE
 								
	IF NOT HAS_CUTSCENE_FINISHED 
		SET_MUSIC_DOES_FADE TRUE
		SET_FADING_COLOUR 0 0 0
		DO_FADE 500 FADE_OUT
		CLEAR_PRINTS
		WHILE GET_FADING_STATUS
			WAIT 0
			GOSUB do_bridge_particles
		ENDWHILE
	ENDIF
	
ENDIF

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
GOSUB do_bridge_particles
ENDWHILE

SET_MUSIC_DOES_FADE TRUE


SET_MOTION_BLUR 0
SET_NEAR_CLIP 0.9
STOP_CHASE_SCENE
CLEAR_CUTSCENE
CLEAR_PRINTS
CLEAR_SMALL_PRINTS

SET_FADING_COLOUR 0 0 0 
DO_FADE 0 FADE_OUT
//WDCARL - Fades of 0 need to be checked on
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON
SWITCH_WORLD_PROCESSING ON
SWITCH_STREAMING ON
SET_EVERYONE_IGNORE_PLAYER player FALSE
SET_PLAYER_CONTROL player ON
SET_PLAYER_VISIBLE player TRUE

LOAD_COLLISION LEVEL_INDUSTRIAL
SET_PLAYER_COORDINATES player 811.90 -939.95 35.8
SET_PLAYER_HEADING player 180.0

GET_PLAYER_CHAR	player script_controlled_player
IF NOT IS_CHAR_DEAD script_controlled_player
	
	UNDRESS_CHAR script_controlled_player playerp
	WHILE NOT HAS_MODEL_LOADED PED_PLAYER 
		WAIT 0
GOSUB do_bridge_particles
		
	ENDWHILE
	
	IF NOT IS_CHAR_DEAD script_controlled_player
		DRESS_CHAR script_controlled_player
	ENDIF
ENDIF

SET_CAMERA_BEHIND_PLAYER

//UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
UNLOAD_SPECIAL_CHARACTER 3
UNLOAD_SPECIAL_CHARACTER 4
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj3
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj4
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj5

// *******************************END OF JAIL BREAK CUTSCENE***************************

SET_INTRO_IS_PLAYING FALSE

SET_MUSIC_DOES_FADE TRUE

FORCE_RAIN FALSE

START_NEW_SCRIPT eightball_mission_loop

flag_player_on_mission = 0
MISSION_HAS_FINISHED
MISSION_END




skip_intro_button://////////////////////////////////////////////////////////
IF skip_flag = 0
	IF NOT IS_BUTTON_PRESSED PAD1 CROSS
	AND NOT IS_BUTTON_PRESSED PAD1 START
		skip_flag = 1
	ENDIF
ENDIF

IF skip_flag = 1
	IF IS_BUTTON_PRESSED PAD1 CROSS
	OR IS_BUTTON_PRESSED PAD1 START
		skip_flag = 2
	ENDIF
ENDIF
RETURN//////////////////////////////////////////////////////////////////////



draw_intro_text://///////////////////////////////////////////////////////

SET_TEXT_CENTRE_SIZE 580.0
SET_TEXT_FONT FONT_BANK//FONT_PAGER//FONT_HEADING
SET_TEXT_CENTRE ON
SET_TEXT_COLOUR 190 190 190 text_alpha
SET_TEXT_SCALE 0.8 1.0//0.5 0.75
SET_TEXT_PROPORTIONAL ON
SET_TEXT_BACKGROUND_COLOUR 0 0 0 text_alpha
SET_TEXT_BACKGROUND ON

//DISPLAY_TEXT 320.0 400.0 PAPER1

IF text_fading_flag	= 0
	text_alpha += 2
	IF text_alpha > 255
		text_alpha = 255
	ENDIF
ELSE
	text_alpha -= 3
	IF text_alpha < 1
		text_alpha = 0
	ENDIF
ENDIF

RETURN//////////////////////////////////////////////////////////////////////



do_bridge_particles:////////////////////////////////////////////////////////
IF TIMERA > 6000
	TIMERA = 0
	ADD_MOVING_PARTICLE_EFFECT 10 791.661 -936.916 38.313 0.0 0.0 0.0 1.0 0 0 0 6000
	ADD_MOVING_PARTICLE_EFFECT 10 788.337 -938.467 38.073 0.0 0.0 0.0 1.0 0 0 0 6000
	ADD_MOVING_PARTICLE_EFFECT 10 786.493 -942.398 39.8 0.0 0.0 0.0 1.0 0 0 0 6000
ENDIF
RETURN//////////////////////////////////////////////////////////////////////
}
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ***************************************HEALTH INFO*************************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB health_info_start
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB health_info_cleanup
ENDIF
GOSUB health_info_cleanup
MISSION_END

// Variables for info script

VAR_INT amb_info medic_info	flag_bottom
VAR_INT health_pickup_info	armour_pickup_info
VAR_INT info_time_lapsed info_time_now info_time_start flag_info


// ****************************************Mission Start************************************

health_info_start:
//REGISTER_MISSION_GIVEN
SCRIPT_NAME health 
flag_player_on_mission = 1

WAIT 0

//Set Variables
info_time_lapsed =0
info_time_now = 0
info_time_start = 0
flag_info = 0
flag_bottom = 0
wanted_level = 0
flag_intro_jump = 0
//Set Coords


//Mission Script 
SET_PLAYER_CONTROL player off

STORE_WANTED_LEVEL player wanted_level
CLEAR_WANTED_LEVEL player
SET_POLICE_IGNORE_PLAYER player on
//SWITCH_WIDESCREEN on 
 
REQUEST_MODEL CAR_AMBULANCE
REQUEST_MODEL PED_MEDIC

WHILE NOT HAS_MODEL_LOADED CAR_AMBULANCE
OR NOT HAS_MODEL_LOADED PED_MEDIC
	WAIT 0
ENDWHILE		
		
SET_FIXED_CAMERA_POSITION 1138.6 -600.0 18.0 0.0 0.0 0.0
POINT_CAMERA_AT_PLAYER player FIXED INTERPOLATION

WHILE flag_info < 8

	WAIT 0
	

	IF flag_info = 0
		GET_GAME_TIMER info_time_start
		/*SET_FADING_COLOUR 0 0 0
		DO_FADE 1500 FADE_OUT
		WAIT 1500*/
		CLEAR_AREA 1141.0 -622.0 14.8 30.0 true
		CLEAR_AREA 1125.77 -594.0 14.8 10.0 true
		SET_CAR_DENSITY_MULTIPLIER 0.0
		SET_PED_DENSITY_MULTIPLIER 0.0
		//CAR_SET_IDLE amb_info 
		/*SET_FADING_COLOUR 0 0 0
		DO_FADE 1500 FADE_IN
		WAIT 1500*/
		PRINT_HELP (HEAL_A)
		FLASH_HUD_OBJECT HUD_FLASH_HEALTH 
		flag_info = 1
	ENDIF
	
	IF flag_intro_jump = 0
		GET_GAME_TIMER info_time_now
		info_time_lapsed = info_time_now - info_time_start
	ENDIF
	
	IF info_time_lapsed > 3000
	AND flag_info < 2
		FLASH_HUD_OBJECT -1
	ENDIF 

	IF info_time_lapsed > 5000
	AND flag_info = 1
		PRINT_HELP (HEAL_B)

		// 3master - move creating the ambulance to after the camera is controlled so you dont see it spawn
		CREATE_CAR CAR_AMBULANCE 1140.2 -621.5 14.8 amb_info
		SET_CAR_HEADING amb_info 90.0
		CREATE_CHAR PEDTYPE_CIVMALE PED_MEDIC 1136.75 -617.8 14.7 medic_info
		SET_CHAR_HEADING medic_info 25.0
		CHAR_SET_IDLE medic_info
		SET_CHAR_STAY_IN_SAME_PLACE	medic_info true

		flag_info = 2
	ENDIF

	IF info_time_lapsed > 11000
	AND flag_info = 2
		IF NOT IS_CAR_DEAD amb_info
		AND NOT IS_CHAR_DEAD medic_info
			SET_FIXED_CAMERA_POSITION 1133.0 -613.5 17.0 0.0 0.0 0.0
			POINT_CAMERA_AT_CAR amb_info FIXED JUMP_CUT
			SET_CHAR_STAY_IN_SAME_PLACE	medic_info false
			SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER medic_info amb_info 
		ENDIF
		PRINT_HELP (HEAL_C)
		flag_info = 3
	ENDIF

	IF info_time_lapsed > 14000
	AND flag_info = 3
		PRINT_HELP (WANT_I)
		flag_info = 4
	ENDIF

	IF info_time_lapsed > 17500
	AND flag_info = 4
		flag_info = 5
	ENDIF
	
	IF info_time_lapsed > 19500
	AND flag_info = 5
		PRINT_HELP (HEAL_E)
		SET_FIXED_CAMERA_POSITION 1138.6 -600.0 18.0 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT 1144.3 -603.5 15.0 JUMP_CUT
		CREATE_PICKUP health PICKUP_ON_STREET_SLOW 1144.3 -603.5 15.0 health_pickup_info
		IF NOT IS_CAR_DEAD amb_info
			CAR_WANDER_RANDOMLY amb_info
		ENDIF
		flag_info = 6
	ENDIF
	
	IF info_time_lapsed > 22500
	AND flag_info = 6
		POINT_CAMERA_AT_POINT 1147.0 -601.1 15.0 INTERPOLATION
		CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 1147.0 -601.1 15.0 armour_pickup_info
		flag_info = 7
	ENDIF
	
	IF info_time_lapsed > 24000
	AND flag_info = 7
		SET_FADING_COLOUR 0 0 0
		DO_FADE 1500 FADE_OUT
		CLEAR_HELP
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		DELETE_CAR amb_info
		DELETE_CHAR medic_info
		REMOVE_PICKUP health_pickup_info
		REMOVE_PICKUP armour_pickup_info
		RESTORE_CAMERA_JUMPCUT
		//SWITCH_WIDESCREEN off
		SET_PLAYER_CONTROL player on
		ALTER_WANTED_LEVEL player wanted_level
		SET_FADING_COLOUR 0 0 0
		DO_FADE 1500 FADE_IN
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		flag_info = 8
	ENDIF
	
	IF info_time_lapsed > 16500
	AND flag_info < 7
		IF NOT IS_CAR_DEAD amb_info
		AND NOT IS_CHAR_DEAD medic_info
			IF IS_CHAR_IN_CAR medic_info amb_info
			AND flag_bottom = 0
				SET_CAR_CRUISE_SPEED amb_info 40.0
				SET_CAR_DRIVING_STYLE  amb_info 2
				SWITCH_CAR_SIREN amb_info ON
				CAR_GOTO_COORDINATES amb_info 1023.0 -480.0 19.7
				flag_bottom = 1
			ENDIF
		ENDIF
	ENDIF

	IF flag_intro_jump = 0
	AND flag_info < 7
		IF IS_BUTTON_PRESSED PAD1 CROSS
			info_time_lapsed = 24001
			flag_info = 7
			flag_intro_jump = 1
		ENDIF
	ENDIF

ENDWHILE

RETURN
		


// mission cleanup

health_info_cleanup:

RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN off
SET_PLAYER_CONTROL player on
SET_POLICE_IGNORE_PLAYER player off

MARK_CAR_AS_NO_LONGER_NEEDED amb_info
MARK_CHAR_AS_NO_LONGER_NEEDED medic_info

MARK_MODEL_AS_NO_LONGER_NEEDED CAR_AMBULANCE
MARK_MODEL_AS_NO_LONGER_NEEDED PED_MEDIC

SET_CAR_DENSITY_MULTIPLIER 1.0
SET_PED_DENSITY_MULTIPLIER 1.0

//REMOVE_PICKUP heal_info
flag_player_on_mission = 0
flag_health_info = 1

MISSION_HAS_FINISHED
RETURN


//----main stuff-------
/*
//health info/wanted info
VAR_INT heal_info wanted_info flag_health_info flag_wanted_info

flag_health_info = 0
flag_wanted_info = 0

CREATE_PICKUP info PICKUP_ONCE 1144.2 -596.9 14.9 heal_info //hospital info cut
START_NEW_SCRIPT hospital_info_loop

hospital_info_loop:
{
WAIT 0

IF IS_PLAYER_PLAYING player
	IF IS_PLAYER_IN_ZONE player S_VIEW
		IF HAS_PICKUP_BEEN_COLLECTED heal_info
			LAUNCH_MISSION health.sc
			TERMINATE_THIS_SCRIPT
		ENDIF
	ENDIF
ENDIF

GOTO hospital_info_loop
} 
*/
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ***************************************WANTED INFO*************************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB wanted_info_start
GOSUB wanted_info_cleanup
MISSION_END

// Variables for info script

VAR_INT copcar_info copcar2_info swatvan_info cop_info cop2_info flag_copcar_progress
VAR_INT swat1_info swat2_info flag_swat_progress bribe_pickup
VAR_INT wanted_level diablocar_info diablo_info
//VAR_INT health_pickup_info	armour_pickup_info
//VAR_INT info_time_lapsed info_time_now info_time_start flag_info

VAR_FLOAT car_x car_y car_z

// ****************************************Mission Start************************************

wanted_info_start:
//REGISTER_MISSION_GIVEN
SCRIPT_NAME wanted 
flag_player_on_mission = 1


WAIT 0

//Set Variables
info_time_lapsed =0
info_time_now = 0
info_time_start = 0
flag_info = 0
flag_copcar_progress = 0
flag_swat_progress = 0
flag_intro_jump = 0
wanted_level = 0


//Set Coords


//Mission Script 

STORE_WANTED_LEVEL player wanted_level
//CLEAR_WANTED_LEVEL player
SET_POLICE_IGNORE_PLAYER player on 
SET_PLAYER_CONTROL player off
//SWITCH_WIDESCREEN on 

SWITCH_STREAMING OFF 

//SET_SWAT_REQUIRED TRUE
REQUEST_MODEL CAR_ENFORCER
//REQUEST_MODEL CAR_RUMPO
REQUEST_MODEL PED_SWAT
REQUEST_MODEL CAR_DIABLOS
REQUEST_MODEL PED_GANG_DIABLO_B

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED CAR_ENFORCER
	WAIT 0
	//PRINT_NOW TEST1 1000 1
ENDWHILE		
WHILE NOT HAS_MODEL_LOADED PED_SWAT
	WAIT 0
	//PRINT_NOW TEST2 1000 1
ENDWHILE

WHILE NOT HAS_MODEL_LOADED PED_GANG_DIABLO_B
	WAIT 0
	//PRINT_NOW TEST3 1000 1
ENDWHILE		
WHILE NOT HAS_MODEL_LOADED CAR_DIABLOS
	WAIT 0
	//PRINT_NOW TEST4 1000 1
ENDWHILE		

SWITCH_STREAMING ON

WHILE flag_info < 13

	WAIT 0
	

	IF flag_info = 0
		GET_GAME_TIMER info_time_start
		//SET_FIXED_CAMERA_POSITION 1135.0 -672.5 15.5 0.0 0.0 0.0
		//POINT_CAMERA_AT_PLAYER player FIXED INTERPOLATION
		/*SET_FADING_COLOUR 0 0 0
		DO_FADE 1500 FADE_OUT
		WAIT 1500*/
		
		CREATE_CAR CAR_POLICE 1110.0 -823.0 15.0 copcar_info
		SET_CAR_HEADING copcar_info 330.0
		CREATE_CHAR_INSIDE_CAR copcar_info PEDTYPE_CIVMALE PED_COP cop_info
		//CAR_SET_IDLE copcar_info
		
		CREATE_CAR CAR_POLICE 1105.0 -828.0 15.0 copcar2_info
		SET_CAR_HEADING copcar2_info 330.0
		CREATE_CHAR_INSIDE_CAR copcar2_info PEDTYPE_CIVMALE PED_COP cop2_info
		//CAR_SET_IDLE copcar2_info

		CREATE_CAR CAR_DIABLOS 1115.0 -818.0 15.0 diablocar_info
		SET_CAR_HEADING diablocar_info 0.0
		CREATE_CHAR_INSIDE_CAR diablocar_info PEDTYPE_GANG_DIABLO PED_GANG_DIABLO_B diablo_info
		//CAR_SET_IDLE diablocar_info
		
		SET_CAR_DENSITY_MULTIPLIER 0.3
		SET_PED_DENSITY_MULTIPLIER 0.0
		/*SET_FADING_COLOUR 0 0 0
		DO_FADE 1500 FADE_IN
		WAIT 1500*/
		PRINT_HELP (WANT_A) 
		flag_info = 1
	ENDIF

	IF flag_intro_jump = 0
		GET_GAME_TIMER info_time_now
		info_time_lapsed = info_time_now - info_time_start
	ENDIF
	
	IF info_time_lapsed > 3500
	AND flag_info = 1
		CLEAR_HELP
		PRINT_HELP (WANT_G)//When you are arrested you will be returned to the nearest police station and you will lose all your weapons
		IF NOT IS_CAR_DEAD copcar_info
		AND NOT IS_CAR_DEAD copcar2_info
		AND NOT IS_CAR_DEAD diablocar_info
			SET_CAR_CRUISE_SPEED copcar2_info 75.0
			SET_CAR_DRIVING_STYLE  copcar2_info 3
			SET_CAR_RAM_CAR copcar2_info diablocar_info
			
			SET_CAR_CRUISE_SPEED copcar_info 70.0
			SET_CAR_DRIVING_STYLE  copcar_info 3
			SET_CAR_RAM_CAR copcar_info diablocar_info
		ENDIF
			
		SET_FIXED_CAMERA_POSITION 1134.0 -695.0 18.0 0.0 0.0 0.0
		
		IF NOT IS_CAR_DEAD diablocar_info
			POINT_CAMERA_AT_CAR diablocar_info FIXED JUMP_CUT
		ENDIF
		
		IF NOT IS_CAR_DEAD diablocar_info
			SET_CAR_CRUISE_SPEED diablocar_info 50.0
			SET_CAR_DRIVING_STYLE  diablocar_info 2
			CAR_GOTO_COORDINATES diablocar_info 982.0 -617.0 15.0
			//GET_CAR_COORDINATES diablocar_info car_x car_y car_z
		ENDIF
		IF NOT IS_CAR_DEAD copcar_info
		AND NOT IS_CAR_DEAD copcar2_info
			SWITCH_CAR_SIREN copcar_info ON
			SWITCH_CAR_SIREN copcar2_info ON
		ENDIF
		flag_info = 2
	ENDIF
	
	IF info_time_lapsed > 5500
	AND flag_copcar_progress = 0
		
		CLEAR_AREA 1142.0 -666.0 14.8 10.0 true

		CREATE_CAR CAR_ENFORCER 1142.0 -666.0 14.8 swatvan_info
		//CREATE_CAR CAR_RUMPO 1142.0 -666.0 14.8 swatvan_info
		SET_CAR_HEADING swatvan_info 90.0
		LOCK_CAR_DOORS swatvan_info CARLOCK_UNLOCKED
		CAR_SET_IDLE swatvan_info
		CREATE_CHAR PEDTYPE_CIVMALE PED_SWAT 1138.0 -671.0 15.0 swat2_info
		CREATE_CHAR PEDTYPE_CIVMALE PED_SWAT 1137.8 -661.3 15.0 swat1_info
		GIVE_WEAPON_TO_CHAR swat1_info WEAPONTYPE_M16 60
		SET_CHAR_HEADING swat2_info 110.0
		SET_CHAR_HEADING swat1_info 80.0
		GIVE_WEAPON_TO_CHAR swat1_info WEAPONTYPE_SHOTGUN 10
		IF NOT IS_CHAR_DEAD	diablo_info
			CHAR_LOOK_AT_CHAR_ALWAYS swat1_info diablo_info
		ENDIF
		IF NOT IS_CHAR_DEAD cop_info
			CHAR_LOOK_AT_CHAR_ALWAYS swat2_info cop_info
		ENDIF 
		
		flag_copcar_progress = 1
	ENDIF

	IF info_time_lapsed > 7500
	AND flag_info = 2
		CLEAR_HELP
		PRINT_HELP (WANT_H)//The cops will take some of your cash as a bribe
		flag_info = 3
	ENDIF

	IF info_time_lapsed > 10500
	AND flag_info = 3
		CLEAR_HELP
		PRINT_HELP (WANT_I)//Any mission you were on will fail.
		flag_info = 4
	ENDIF
	
	IF info_time_lapsed > 12500
	AND flag_info = 4
		CLEAR_HELP
		PRINT_HELP (WANT_B)//your wanted level is represented by the row of stars in the .....
		IF NOT IS_CAR_DEAD swatvan_info
			SET_FIXED_CAMERA_POSITION 1135.8 -673.0 14.8 0.0 0.0 0.0
			POINT_CAMERA_AT_CAR swatvan_info FIXED JUMP_CUT
			DELETE_CAR copcar_info
			DELETE_CAR copcar2_info
			DELETE_CAR diablocar_info
		ENDIF
		flag_info = 5
	ENDIF
	
	IF info_time_lapsed > 13500
	AND flag_info = 5
		IF NOT IS_CAR_DEAD swatvan_info
		AND NOT IS_CHAR_DEAD swat2_info
			STOP_CHAR_LOOKING swat2_info
			SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER swat2_info swatvan_info
		ENDIF
		flag_info = 6
	ENDIF
	
	IF info_time_lapsed > 16000
	AND flag_info = 6
		CLEAR_HELP
		PRINT_HELP (WANT_C)//You now have a wanted level of one....
		WAIT 500
		ALTER_WANTED_LEVEL player 1
		IF NOT IS_CAR_DEAD swatvan_info
		AND NOT IS_CHAR_DEAD swat1_info
			SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER swat1_info swatvan_info
		ENDIF
		flag_info = 7
	ENDIF
	
	
	IF info_time_lapsed > 18000
	AND flag_info = 7
		CLEAR_HELP
		PRINT_HELP (WANT_D)//Two....
		WAIT 500
		ALTER_WANTED_LEVEL player 2
		flag_info = 8
	ENDIF
	
	
	IF info_time_lapsed > 20000
	AND flag_info = 8
		CLEAR_HELP
		PRINT_HELP (WANT_E)//Three....
		WAIT 500
		ALTER_WANTED_LEVEL player 3
		flag_info = 9
	ENDIF
	

	IF info_time_lapsed > 22000
	AND flag_info = 9
		CLEAR_HELP
		PRINT_HELP (WANT_F)//As your wanted level increases you will attract more powerful forms of law enforcement
		flag_info = 10
	ENDIF

	IF info_time_lapsed > 26000
	AND flag_info = 10
		SET_FIXED_CAMERA_POSITION 1135.0 -672.5 15.5 0.0 0.0 0.0
		POINT_CAMERA_AT_PLAYER player FIXED JUMP_CUT
		CLEAR_HELP
		PRINT_HELP (WANT_J)// You will find ways of reducing.......
		CREATE_PICKUP bribe PICKUP_ON_STREET_SLOW 1143.0 -671.0 15.0 bribe_pickup
		POINT_CAMERA_AT_POINT 1143.0 -671.0 15.0 INTERPOLATION
		flag_info = 11
	ENDIF

	
	IF info_time_lapsed > 28000
	AND flag_info = 11
		flag_info = 12
	ENDIF
	
	IF info_time_lapsed > 30000
	AND flag_info = 12
		CLEAR_HELP
		SET_FADING_COLOUR 0 0 0
		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		REMOVE_PICKUP bribe_pickup
		DELETE_CHAR diablo_info
		DELETE_CAR diablocar_info
		DELETE_CHAR cop_info
		DELETE_CAR copcar_info
		DELETE_CHAR cop2_info
		DELETE_CAR copcar2_info
		DELETE_CHAR swat1_info
		DELETE_CHAR swat2_info
		DELETE_CAR swatvan_info
		//REMOVE_PICKUP armour_pickup_info
		RESTORE_CAMERA_JUMPCUT
		//SWITCH_WIDESCREEN off
		SET_PLAYER_CONTROL player on
		ALTER_WANTED_LEVEL player wanted_level
		SET_FADING_COLOUR 0 0 0
		DO_FADE 1500 FADE_IN
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		flag_info = 13
	ENDIF
	/*
	IF NOT IS_CAR_DEAD copcar_info
		IF LOCATE_CAR_2D copcar_info 1132.0 -671.4 4.0 4.0 false 
		AND flag_copcar_progress = 0
			CAR_GOTO_COORDINATES_ACCURATE copcar_info 1124.0 -505.0 19.7
			SET_CAR_CRUISE_SPEED copcar_info 18.0
			SET_CAR_DRIVING_STYLE  copcar_info 2
			SWITCH_CAR_SIREN copcar_info ON
			flag_copcar_progress = 1
		ENDIF
	ENDIF
	
	IF NOT IS_CAR_DEAD copcar_info
	AND flag_copcar_progress = 1
		CAR_GOTO_COORDINATES copcar_info car_x car_y car_z
	ENDIF
	*/
	IF NOT IS_CAR_DEAD swatvan_info
	AND NOT IS_CHAR_DEAD swat1_info
	AND NOT IS_CHAR_DEAD swat2_info
		IF flag_swat_progress = 0
		AND info_time_lapsed > 21000
			IF IS_CHAR_IN_CAR swat1_info swatvan_info
			AND IS_CHAR_IN_CAR swat2_info swatvan_info
				SET_CAR_CRUISE_SPEED swatvan_info 10.0
				SET_CAR_DRIVING_STYLE  swatvan_info 2
				CAR_GOTO_COORDINATES_ACCURATE swatvan_info 1133.0 -669.0 15.0
				flag_swat_progress = 1
			ENDIF
		ENDIF
	ENDIF
				
	IF NOT IS_CAR_DEAD swatvan_info
		IF LOCATE_CAR_2D swatvan_info 1133.0 -669.0 3.0 3.0 false 
		AND	flag_swat_progress = 1
		AND info_time_lapsed > 22000
			CAR_GOTO_COORDINATES swatvan_info 982.0 -617.0 15.0
			SET_CAR_CRUISE_SPEED swatvan_info 30.0
			SET_CAR_DRIVING_STYLE  swatvan_info 3
			SWITCH_CAR_SIREN swatvan_info ON
			flag_swat_progress = 2
		ENDIF
	ENDIF
				
	IF flag_intro_jump = 0
	AND flag_info < 12
		IF IS_BUTTON_PRESSED PAD1 CROSS
			info_time_lapsed = 34001
			flag_info = 12
			flag_intro_jump = 1
		ENDIF
	ENDIF

ENDWHILE

RETURN
		


// mission cleanup

wanted_info_cleanup:

RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN off
SET_PLAYER_CONTROL player on
SET_POLICE_IGNORE_PLAYER player off

IF NOT IS_CAR_DEAD swatvan_info
	CAR_WANDER_RANDOMLY swatvan_info
ENDIF
IF NOT IS_CAR_DEAD copcar_info
	CAR_WANDER_RANDOMLY copcar_info
ENDIF
IF NOT IS_CAR_DEAD diablocar_info
	CAR_WANDER_RANDOMLY diablocar_info
ENDIF

SET_CAR_DENSITY_MULTIPLIER 1.0
SET_PED_DENSITY_MULTIPLIER 1.0

MARK_CAR_AS_NO_LONGER_NEEDED swatvan_info
MARK_CAR_AS_NO_LONGER_NEEDED copcar_info
MARK_CAR_AS_NO_LONGER_NEEDED diablocar_info
MARK_CHAR_AS_NO_LONGER_NEEDED cop_info
MARK_CHAR_AS_NO_LONGER_NEEDED swat1_info
MARK_CHAR_AS_NO_LONGER_NEEDED swat2_info
MARK_CHAR_AS_NO_LONGER_NEEDED diablo_info


MARK_MODEL_AS_NO_LONGER_NEEDED PED_COP
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_DIABLO_B
MARK_MODEL_AS_NO_LONGER_NEEDED PED_SWAT
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_DIABLOS
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_ENFORCER
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_POLICE
SET_SWAT_REQUIRED FALSE
//REMOVE_PICKUP heal_info
flag_player_on_mission = 0
flag_wanted_info = 1

MISSION_HAS_FINISHED
RETURN


//----main stuff-------
/*

CREATE_PICKUP info PICKUP_ONCE 1143.9 -675.2 15.0 wanted_info //police info cut
START_NEW_SCRIPT police_info_loop

police_info_loop:
{
WAIT 0

IF IS_PLAYER_PLAYING player
	IF IS_PLAYER_IN_ZONE player S_VIEW
		IF HAS_PICKUP_BEEN_COLLECTED wanted_info
			LAUNCH_MISSION wanted.sc
			TERMINATE_THIS_SCRIPT
		ENDIF
	ENDIF
ENDIF

GOTO hospital_info_loop 
*/
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// **************************************RC Destruction Derby*********************************
// ***************************************Diablo Demolition***********************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME RC1

// Mission start stuff

GOSUB mission_start_rc1

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_rc1_failed
ENDIF
GOSUB mission_cleanup_rc1

MISSION_END


// Variables for mission


VAR_INT counter_RCDD rc_van
VAR_INT timer_RCDD
VAR_INT reward_RCDD 
VAR_FLOAT cam_x cam_y cam_z
VAR_FLOAT rc_x rc_y rc_z
	
// ***************************************Mission Start*************************************


mission_start_rc1:

flag_player_on_mission = 1

IF flag_rc1_passed = 0
	REGISTER_MISSION_GIVEN
ENDIF

PRINT_BIG ( RC1 ) 15000 2

WAIT 0

counter_RCDD = 0
flag_buggy_help1_hm2 = 0
controlmode = 0
reward_RCDD = 0

cam_x = 1019.0	
cam_y = -113.5
cam_z =	9.0

rc_x = 1026.0
rc_y = -117.0
rc_z = 5.5

timer_RCDD = 120000

RESET_NUM_OF_MODELS_KILLED_BY_PLAYER

SET_POLICE_IGNORE_PLAYER player ON
SET_PLAYER_CONTROL player off
STORE_WANTED_LEVEL player wanted_4x4
CLEAR_WANTED_LEVEL player
STORE_CAR_PLAYER_IS_IN player rc_van
SWITCH_WIDESCREEN on 

//UP GANGCAR NUMBERS AND DENSITY

    SETUP_ZONE_CAR_INFO TOWERS DAY   ( 8) 0 0 200 (0 0 0 0) 20 400 0 0 350 0 0
    SETUP_ZONE_CAR_INFO TOWERS NIGHT ( 6) 0 0 250 (0 0 0 0) 10 540 0 0 200 0 0

SET_FIXED_CAMERA_POSITION cam_x cam_y cam_z 0.0 0.0 0.0
IF NOT IS_CAR_DEAD rc_van
	LOCK_CAR_DOORS rc_van CARLOCK_LOCKED
	POINT_CAMERA_AT_CAR rc_van FIXED JUMP_CUT 
	CLEAR_AREA rc_x rc_y rc_z 5.0 true
ENDIF

PRINT_NOW (RC_1) 4000 1 //You have 4 minutes to blow up as many Diablo Gang Cars as possible!

REQUEST_MODEL car_rcbandit
REQUEST_MODEL car_diablos

WHILE NOT HAS_MODEL_LOADED car_rcbandit
OR NOT HAS_MODEL_LOADED car_diablos
	WAIT 0
ENDWHILE


//GIVE_REMOTE_CONTROLLED_CAR_TO_PLAYER player rc_x rc_y rc_z 180.0
DISPLAY_ONSCREEN_COUNTER_WITH_STRING counter_RCDD COUNTER_DISPLAY_NUMBER KILLS
DISPLAY_ONSCREEN_TIMER timer_RCDD
GET_GAME_TIMER timer_intro_start

WHILE NOT timer_RCDD < 1

	WAIT 0
		
		GET_GAME_TIMER timer_intro_now
		intro_time_lapsed = timer_intro_now - timer_intro_start
		
		IF IS_CAR_DEAD rc_van
			PRINT_NOW ( WRECKED ) 3000 1 //"The vehicle's wrecked!"
			GOTO mission_rc1_failed
		ENDIF
		
	IF IS_PLAYER_PLAYING player	
		CLEAR_WANTED_LEVEL player
		
		IF intro_time_lapsed > 4000
		AND	flag_buggy_help1_hm2 = 0
			
			PRINT_HELP ( RCHELP ) //"Press |, or drive the RC car into a vehicle's wheels to detonate"
			flag_buggy_help1_hm2 = 1

			SWITCH_WIDESCREEN off
			SET_PLAYER_CONTROL player on
			RESTORE_CAMERA

		ENDIF

		IF NOT IS_PLAYER_SITTING_IN_CAR player rc_van
			GOTO mission_rc1_failed
		ENDIF
	ELSE
		GOTO mission_rc1_failed
	ENDIF
	
	GET_NUM_OF_MODELS_KILLED_BY_PLAYER car_diablos counter_RCDD
		
	IF intro_time_lapsed > 4000
		IF NOT IS_PLAYER_IN_REMOTE_MODE player
			GIVE_REMOTE_CONTROLLED_CAR_TO_PLAYER player rc_x rc_y rc_z 180.0
		ENDIF
	ENDIF

ENDWHILE

CLEAR_ONSCREEN_TIMER timer_RCDD
CLEAR_ONSCREEN_COUNTER counter_RCDD

BLOW_UP_RC_BUGGY

{
TIMERA = 0
 
WHILE TIMERA < 1500
 
 WAIT 0
 
ENDWHILE
}

IF counter_RCDD > rec_rc1
	reward_RCDD = counter_RCDD - rec_rc1
	reward_RCDD = reward_RCDD * 1000
	rec_rc1 = counter_RCDD
	GOTO mission_rc1_passed
ENDIF

 

// Mission rc1 failed

mission_rc1_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
PRINT_NOW ( NRECORD ) 5000 1
RETURN


   

// mission rc1 passed

mission_rc1_passed:


//reward_RCDD = counter_RCDD * 1000
PRINT_WITH_NUMBER_BIG ( M_PASS ) reward_RCDD 5000 1 //"Mission Passed!"
PRINT_NOW (RECORD) 3000 1
PLAY_MISSION_PASSED_TUNE 1 
ADD_SCORE player reward_RCDD
IF flag_rc1_passed = 0
	PLAYER_MADE_PROGRESS 1
	flag_rc1_passed = 1 
	REGISTER_MISSION_PASSED	RC1
ENDIF
REGISTER_HIGHEST_SCORE 1 rec_rc1

RETURN
		


// mission cleanup

mission_cleanup_rc1:

flag_player_on_mission = 0
flag_just_done_rc_mission = 1
LOAD_SCENE cam_x cam_y cam_z
MARK_MODEL_AS_NO_LONGER_NEEDED car_rcbandit
SET_POLICE_IGNORE_PLAYER player OFF
SET_PLAYER_CONTROL player ON
RESTORE_CAMERA
SWITCH_WIDESCREEN OFF
ALTER_WANTED_LEVEL player wanted_4x4

CLEAR_ONSCREEN_TIMER timer_RCDD
CLEAR_ONSCREEN_COUNTER counter_RCDD

BLOW_UP_RC_BUGGY

IF NOT IS_CAR_DEAD rc_van
	LOCK_CAR_DOORS rc_van CARLOCK_UNLOCKED
ENDIF

    SETUP_ZONE_CAR_INFO TOWERS DAY   ( 8) 0 0 100 (0 0 0 0) 20 400 0 0 350 0 0
    SETUP_ZONE_CAR_INFO TOWERS NIGHT ( 6) 0 0 150 (0 0 0 0) 10 550 0 0 200 0 0

MARK_MODEL_AS_NO_LONGER_NEEDED car_diablos

MISSION_HAS_FINISHED
RETURN
		

  
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// **************************************RC Destruction Derby*********************************
// ***************************************Diablo Demolition***********************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME RC2

// Mission start stuff

GOSUB mission_start_rc2

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_rc2_failed
ENDIF
GOSUB mission_cleanup_rc2

MISSION_END


// Variables for mission

/*
VAR_INT counter_RCDD rc_van
VAR_INT timer_RCDD
VAR_INT reward_RCDD

VAR_FLOAT cam_x cam_y cam_z
VAR_FLOAT rc_x rc_y rc_z
*/	
// ***************************************Mission Start*************************************


mission_start_rc2:

flag_player_on_mission = 1

IF flag_rc2_passed = 0
	REGISTER_MISSION_GIVEN
ENDIF

PRINT_BIG ( RC2 ) 15000 2

WAIT 0

counter_RCDD = 0
flag_buggy_help1_hm2 = 0
controlmode = 0
reward_RCDD = 0

cam_x = 1159.0	
cam_y = -317.5
cam_z =	24.0

rc_x = 1166.0
rc_y = -310.0
rc_z = 23.5

timer_RCDD = 120000

RESET_NUM_OF_MODELS_KILLED_BY_PLAYER

SET_POLICE_IGNORE_PLAYER player ON
SET_PLAYER_CONTROL player off
STORE_WANTED_LEVEL player wanted_4x4
CLEAR_WANTED_LEVEL player
STORE_CAR_PLAYER_IS_IN player rc_van
SWITCH_WIDESCREEN on 

//UP GANGCAR NUMBERS AND DENSITY

    SETUP_ZONE_CAR_INFO LITTLEI DAY	  (10) 250 0 0 (0 0 0 0) 20 400 0 0 250 50 0
    SETUP_ZONE_CAR_INFO LITTLEI NIGHT ( 8) 250 0 0 (0 0 0 0) 10 550 0 0 150 0  0

SET_FIXED_CAMERA_POSITION cam_x cam_y cam_z 0.0 0.0 0.0
IF NOT IS_CAR_DEAD rc_van
	LOCK_CAR_DOORS rc_van CARLOCK_LOCKED
	POINT_CAMERA_AT_CAR rc_van FIXED JUMP_CUT 
	CLEAR_AREA rc_x rc_y rc_z 5.0 true
ENDIF

PRINT_NOW (RC_2) 4000 1 //You have 4 minutes to blow up as many Diablo Gang Cars as possible!

REQUEST_MODEL car_rcbandit
REQUEST_MODEL car_mafia

WHILE NOT HAS_MODEL_LOADED car_rcbandit
OR NOT HAS_MODEL_LOADED car_mafia
	WAIT 0
ENDWHILE


//GIVE_REMOTE_CONTROLLED_CAR_TO_PLAYER player rc_x rc_y rc_z 180.0
DISPLAY_ONSCREEN_COUNTER_WITH_STRING counter_RCDD COUNTER_DISPLAY_NUMBER KILLS
DISPLAY_ONSCREEN_TIMER timer_RCDD
GET_GAME_TIMER timer_intro_start

WHILE NOT timer_RCDD < 1

	WAIT 0
		
		GET_GAME_TIMER timer_intro_now
		intro_time_lapsed = timer_intro_now - timer_intro_start
		
		IF IS_CAR_DEAD rc_van
			PRINT_NOW ( WRECKED ) 3000 1 //"The vehicle's wrecked!"
			GOTO mission_rc2_failed
		ENDIF
		
	IF IS_PLAYER_PLAYING player	
		CLEAR_WANTED_LEVEL player
		
		IF intro_time_lapsed > 4000
		AND	flag_buggy_help1_hm2 = 0
			
			PRINT_HELP ( RCHELP ) //"Press |, or drive the RC car into a vehicle's wheels to detonate"
			flag_buggy_help1_hm2 = 1
						
			SWITCH_WIDESCREEN off
			SET_PLAYER_CONTROL player on
			RESTORE_CAMERA

		ENDIF

		IF NOT IS_PLAYER_SITTING_IN_CAR player rc_van
			GOTO mission_rc2_failed
		ENDIF
	ELSE
		GOTO mission_rc2_failed
	ENDIF
	
	GET_NUM_OF_MODELS_KILLED_BY_PLAYER CAR_MAFIA counter_RCDD
		
	IF intro_time_lapsed > 4000
		IF NOT IS_PLAYER_IN_REMOTE_MODE player
			GIVE_REMOTE_CONTROLLED_CAR_TO_PLAYER player rc_x rc_y rc_z 180.0
		ENDIF
	ENDIF

ENDWHILE

CLEAR_ONSCREEN_TIMER timer_RCDD
CLEAR_ONSCREEN_COUNTER counter_RCDD

BLOW_UP_RC_BUGGY

{
TIMERA = 0
 
WHILE TIMERA < 1500
 
 WAIT 0
 
ENDWHILE
}

IF counter_RCDD > rec_rc2
	reward_RCDD = counter_RCDD - rec_rc2
	reward_RCDD = reward_RCDD * 1000
	rec_rc2 = counter_RCDD
	GOTO mission_rc2_passed
ENDIF

 

// Mission rc2 failed

mission_rc2_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
PRINT_NOW ( NRECORD ) 5000 1

RETURN


   

// mission rc2 passed

mission_rc2_passed:


//reward_RCDD = counter_RCDD * 1000
PRINT_WITH_NUMBER_BIG ( M_PASS ) reward_RCDD 5000 1 //"Mission Passed!"
PRINT_NOW (RECORD) 3000 1
PLAY_MISSION_PASSED_TUNE 1 
ADD_SCORE player reward_RCDD
IF flag_rc2_passed = 0
	PLAYER_MADE_PROGRESS 1
	flag_rc2_passed = 1 
	REGISTER_MISSION_PASSED	RC2
ENDIF
REGISTER_HIGHEST_SCORE 2 rec_rc2

RETURN
		


// mission cleanup

mission_cleanup_rc2:

flag_player_on_mission = 0
flag_just_done_rc_mission = 1
LOAD_SCENE cam_x cam_y cam_z
MARK_MODEL_AS_NO_LONGER_NEEDED car_rcbandit
SET_POLICE_IGNORE_PLAYER player OFF
SET_PLAYER_CONTROL player ON
RESTORE_CAMERA
SWITCH_WIDESCREEN OFF
ALTER_WANTED_LEVEL player wanted_4x4

CLEAR_ONSCREEN_TIMER timer_RCDD
CLEAR_ONSCREEN_COUNTER counter_RCDD

BLOW_UP_RC_BUGGY

IF NOT IS_CAR_DEAD rc_van
	LOCK_CAR_DOORS rc_van CARLOCK_UNLOCKED
ENDIF

    SETUP_ZONE_CAR_INFO LITTLEI DAY	  (10) 100 0 0 (0 0 0 0) 20 400 0 0 350 50 0
    SETUP_ZONE_CAR_INFO LITTLEI NIGHT ( 8) 150 0 0 (0 0 0 0) 10 550 0 0 150 0  0

MARK_MODEL_AS_NO_LONGER_NEEDED CAR_MAFIA

MISSION_HAS_FINISHED
RETURN
		

  
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// **************************************RC Destruction Derby*********************************
// ***************************************Diablo Demolition***********************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME RC3

// Mission start stuff

GOSUB mission_start_rc3

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_rc3_failed
ENDIF
GOSUB mission_cleanup_rc3

MISSION_END


// Variables for mission

/*
VAR_INT counter_RCDD rc_van
VAR_INT timer_RCDD
VAR_INT reward_RCDD

VAR_FLOAT cam_x cam_y cam_z
VAR_FLOAT rc_x rc_y rc_z
*/	
// ***************************************Mission Start*************************************


mission_start_rc3:

flag_player_on_mission = 1

IF flag_rc3_passed = 0
	REGISTER_MISSION_GIVEN
ENDIF

PRINT_BIG ( RC4 ) 15000 2

WAIT 0

counter_RCDD = 0
flag_buggy_help1_hm2 = 0
controlmode = 0
reward_RCDD = 0

cam_x = -646.0	
cam_y = 62.0
cam_z =	19.0

rc_x = -641.0
rc_y = 60.0
rc_z = 22.0

timer_RCDD = 120000

RESET_NUM_OF_MODELS_KILLED_BY_PLAYER

SET_POLICE_IGNORE_PLAYER player ON
SET_PLAYER_CONTROL player off
STORE_WANTED_LEVEL player wanted_4x4
CLEAR_WANTED_LEVEL player
STORE_CAR_PLAYER_IS_IN player rc_van
SWITCH_WIDESCREEN on 

//UP GANGCAR NUMBERS AND DENSITY

    SETUP_ZONE_CAR_INFO PROJECT DAY   (15) (0 0 0 0) 0 0 300 20 400 50 50 0 0 0
    SETUP_ZONE_CAR_INFO PROJECT NIGHT (10) (0 0 0 0) 0 0 400 10 400 50 50 0 0 0

SET_FIXED_CAMERA_POSITION cam_x cam_y cam_z 0.0 0.0 0.0
IF NOT IS_CAR_DEAD rc_van
	LOCK_CAR_DOORS rc_van CARLOCK_LOCKED
	POINT_CAMERA_AT_CAR rc_van FIXED JUMP_CUT 
	CLEAR_AREA rc_x rc_y rc_z 5.0 true
ENDIF

PRINT_NOW (RC_5) 4000 1 //You have 4 minutes to blow up as many Diablo Gang Cars as possible!

REQUEST_MODEL car_rcbandit
//REQUEST_MODEL car_hoods

WHILE NOT HAS_MODEL_LOADED car_rcbandit
//OR NOT HAS_MODEL_LOADED car_hoods
	WAIT 0
ENDWHILE


//GIVE_REMOTE_CONTROLLED_CAR_TO_PLAYER player rc_x rc_y rc_z 180.0
DISPLAY_ONSCREEN_COUNTER_WITH_STRING counter_RCDD COUNTER_DISPLAY_NUMBER KILLS
DISPLAY_ONSCREEN_TIMER timer_RCDD
GET_GAME_TIMER timer_intro_start

WHILE NOT timer_RCDD < 1

	WAIT 0
		
		GET_GAME_TIMER timer_intro_now
		intro_time_lapsed = timer_intro_now - timer_intro_start
		
		IF IS_CAR_DEAD rc_van
			PRINT_NOW ( WRECKED ) 3000 1 //"The vehicle's wrecked!"
			GOTO mission_rc3_failed
		ENDIF
		
	IF IS_PLAYER_PLAYING player	
		CLEAR_WANTED_LEVEL player
		
		IF intro_time_lapsed > 4000
		AND	flag_buggy_help1_hm2 = 0
			
			PRINT_HELP ( RCHELP ) //"Press |, or drive the RC car into a vehicle's wheels to detonate"
			flag_buggy_help1_hm2 = 1
						
			SWITCH_WIDESCREEN off
			SET_PLAYER_CONTROL player on
			RESTORE_CAMERA

		ENDIF

		IF NOT IS_PLAYER_SITTING_IN_CAR player rc_van
			GOTO mission_rc3_failed
		ENDIF
	ELSE
		GOTO mission_rc3_failed
	ENDIF
	
	GET_NUM_OF_MODELS_KILLED_BY_PLAYER car_hoods counter_RCDD
		
	IF intro_time_lapsed > 4000
		IF NOT IS_PLAYER_IN_REMOTE_MODE player
			GIVE_REMOTE_CONTROLLED_CAR_TO_PLAYER player rc_x rc_y rc_z 60.0
		ENDIF
	ENDIF

ENDWHILE

CLEAR_ONSCREEN_TIMER timer_RCDD
CLEAR_ONSCREEN_COUNTER counter_RCDD

BLOW_UP_RC_BUGGY

{
TIMERA = 0
 
WHILE TIMERA < 1500
 
 WAIT 0
 
ENDWHILE
}

IF counter_RCDD > rec_rc3
	reward_RCDD = counter_RCDD - rec_rc3
	reward_RCDD = reward_RCDD * 1000
	rec_rc3 = counter_RCDD
	GOTO mission_rc3_passed
ENDIF

 

// Mission rc3 failed

mission_rc3_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
PRINT_NOW ( NRECORD ) 5000 1

RETURN


   

// mission rc3 passed

mission_rc3_passed:


//reward_RCDD = counter_RCDD * 1000
PRINT_WITH_NUMBER_BIG ( M_PASS ) reward_RCDD 5000 1 //"Mission Passed!"
PRINT_NOW (RECORD) 3000 1
PLAY_MISSION_PASSED_TUNE 1 
ADD_SCORE player reward_RCDD
IF flag_rc3_passed = 0
	PLAYER_MADE_PROGRESS 1
	flag_rc3_passed = 1 
	REGISTER_MISSION_PASSED RC4
ENDIF
REGISTER_HIGHEST_SCORE 4 rec_rc3

RETURN
		


// mission cleanup

mission_cleanup_rc3:

flag_player_on_mission = 0
flag_just_done_rc_mission = 1
LOAD_SCENE cam_x cam_y cam_z
MARK_MODEL_AS_NO_LONGER_NEEDED car_rcbandit
SET_POLICE_IGNORE_PLAYER player OFF
SET_PLAYER_CONTROL player ON
RESTORE_CAMERA
SWITCH_WIDESCREEN OFF
ALTER_WANTED_LEVEL player wanted_4x4

CLEAR_ONSCREEN_TIMER timer_RCDD
CLEAR_ONSCREEN_COUNTER counter_RCDD

BLOW_UP_RC_BUGGY

IF NOT IS_CAR_DEAD rc_van
	LOCK_CAR_DOORS rc_van CARLOCK_UNLOCKED
ENDIF

    SETUP_ZONE_CAR_INFO PROJECT DAY   (15) (0 0 0 0) 0 0 100 20 400 50 50 0 0 0
    SETUP_ZONE_CAR_INFO PROJECT NIGHT (10) (0 0 0 0) 0 0 150 10 400 50 50 0 0 0

//MARK_MODEL_AS_NO_LONGER_NEEDED car_hoods

MISSION_HAS_FINISHED
RETURN
		

  
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// **************************************RC Destruction Derby*********************************
// ***************************************Diablo Demolition***********************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME RC4

// Mission start stuff

GOSUB mission_start_rc4

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_rc4_failed
ENDIF
GOSUB mission_cleanup_rc4

MISSION_END


// Variables for mission

/*
VAR_INT counter_RCDD rc_van
VAR_INT timer_RCDD
VAR_INT reward_RCDD

VAR_FLOAT cam_x cam_y cam_z
VAR_FLOAT rc_x rc_y rc_z
*/	
// ***************************************Mission Start*************************************


mission_start_rc4:

flag_player_on_mission = 1

IF flag_rc4_passed = 0
	REGISTER_MISSION_GIVEN
ENDIF
PRINT_BIG ( RC3 ) 15000 2

WAIT 0

counter_RCDD = 0
flag_buggy_help1_hm2 = 0
controlmode = 0
reward_RCDD = 0

cam_x = 370.0	
cam_y = -1316.0
cam_z =	29.0

rc_x = 373.0
rc_y = -1317.0
rc_z = 26.5

timer_RCDD = 120000

RESET_NUM_OF_MODELS_KILLED_BY_PLAYER

SET_POLICE_IGNORE_PLAYER player ON
SET_PLAYER_CONTROL player off
STORE_WANTED_LEVEL player wanted_4x4
CLEAR_WANTED_LEVEL player
STORE_CAR_PLAYER_IS_IN player rc_van
SWITCH_WIDESCREEN on 

//UP GANGCAR NUMBERS AND DENSITY

    SETUP_ZONE_CAR_INFO YAKUSA DAY   (20) (0 0 0) 270 0 0 0 10 300 200 200 0 0 0
    SETUP_ZONE_CAR_INFO YAKUSA NIGHT (15) (0 0 0) 290 0 0 0 10 300 200 200 0 0 0

SET_FIXED_CAMERA_POSITION cam_x cam_y cam_z 0.0 0.0 0.0
IF NOT IS_CAR_DEAD rc_van
	LOCK_CAR_DOORS rc_van CARLOCK_LOCKED
	POINT_CAMERA_AT_CAR rc_van FIXED JUMP_CUT 
	CLEAR_AREA rc_x rc_y rc_z 5.0 true
ENDIF

PRINT_NOW (RC_3) 4000 1 //You have 4 minutes to blow up as many Diablo Gang Cars as possible!

REQUEST_MODEL car_rcbandit
//REQUEST_MODEL car_yakuza

WHILE NOT HAS_MODEL_LOADED car_rcbandit
//OR NOT HAS_MODEL_LOADED car_yakuza
	WAIT 0
ENDWHILE


//GIVE_REMOTE_CONTROLLED_CAR_TO_PLAYER player rc_x rc_y rc_z 180.0
DISPLAY_ONSCREEN_COUNTER_WITH_STRING counter_RCDD COUNTER_DISPLAY_NUMBER KILLS
DISPLAY_ONSCREEN_TIMER timer_RCDD
GET_GAME_TIMER timer_intro_start

WHILE NOT timer_RCDD < 1

	WAIT 0
		
		GET_GAME_TIMER timer_intro_now
		intro_time_lapsed = timer_intro_now - timer_intro_start
		
		IF IS_CAR_DEAD rc_van
			PRINT_NOW ( WRECKED ) 3000 1 //"The vehicle's wrecked!"
			GOTO mission_rc4_failed
		ENDIF
		
	IF IS_PLAYER_PLAYING player	
		CLEAR_WANTED_LEVEL player
		
		IF intro_time_lapsed > 4000
		AND	flag_buggy_help1_hm2 = 0
			
			PRINT_HELP ( RCHELP ) //"Press |, or drive the RC car into a vehicle's wheels to detonate"
			flag_buggy_help1_hm2 = 1
						
			SWITCH_WIDESCREEN off
			SET_PLAYER_CONTROL player on
			RESTORE_CAMERA

		ENDIF

		IF NOT IS_PLAYER_SITTING_IN_CAR player rc_van
			GOTO mission_rc4_failed
		ENDIF
	ELSE
		GOTO mission_rc4_failed
	ENDIF
	
	GET_NUM_OF_MODELS_KILLED_BY_PLAYER car_yakuza counter_RCDD
		
	IF intro_time_lapsed > 4000
		IF NOT IS_PLAYER_IN_REMOTE_MODE player
			GIVE_REMOTE_CONTROLLED_CAR_TO_PLAYER player rc_x rc_y rc_z 90.0
		ENDIF
	ENDIF

ENDWHILE

CLEAR_ONSCREEN_TIMER timer_RCDD
CLEAR_ONSCREEN_COUNTER counter_RCDD

BLOW_UP_RC_BUGGY

{
TIMERA = 0
 
WHILE TIMERA < 1500
 
 WAIT 0
 
ENDWHILE
}

IF counter_RCDD > rec_rc4
	reward_RCDD = counter_RCDD - rec_rc4
	reward_RCDD = reward_RCDD * 1000
	rec_rc4 = counter_RCDD
	GOTO mission_rc4_passed
ENDIF

 

// Mission rc4 failed

mission_rc4_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
PRINT_NOW ( NRECORD ) 5000 1

RETURN


   

// mission rc4 passed

mission_rc4_passed:


//reward_RCDD = counter_RCDD * 1000
PRINT_WITH_NUMBER_BIG ( M_PASS ) reward_RCDD 5000 1 //"Mission Passed!"
PRINT_NOW (RECORD) 3000 1
PLAY_MISSION_PASSED_TUNE 1 
ADD_SCORE player reward_RCDD
IF flag_rc4_passed = 0
	PLAYER_MADE_PROGRESS 1
	flag_rc4_passed = 1 
	REGISTER_MISSION_PASSED	RC3
ENDIF
REGISTER_HIGHEST_SCORE 3 rec_rc4

RETURN
		


// mission cleanup

mission_cleanup_rc4:

flag_player_on_mission = 0
flag_just_done_rc_mission = 1
LOAD_SCENE cam_x cam_y cam_z
MARK_MODEL_AS_NO_LONGER_NEEDED car_rcbandit
SET_POLICE_IGNORE_PLAYER player OFF
SET_PLAYER_CONTROL player ON
RESTORE_CAMERA
SWITCH_WIDESCREEN OFF
ALTER_WANTED_LEVEL player wanted_4x4

CLEAR_ONSCREEN_TIMER timer_RCDD
CLEAR_ONSCREEN_COUNTER counter_RCDD

BLOW_UP_RC_BUGGY

IF NOT IS_CAR_DEAD rc_van
	LOCK_CAR_DOORS rc_van CARLOCK_UNLOCKED
ENDIF

    SETUP_ZONE_CAR_INFO YAKUSA DAY   (20) (0 0 0) 100 0 0 0 20 350 200 250 0 0 0
    SETUP_ZONE_CAR_INFO YAKUSA NIGHT (15) (0 0 0) 150 0 0 0 10 350 200 200 0 0 0

//MARK_MODEL_AS_NO_LONGER_NEEDED car_yakuza

MISSION_HAS_FINISHED
RETURN
		

  
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ***************************************4x4 by Far**************************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_4x4one
GOSUB mission_cleanup_4x4one
MISSION_END

// Variables for mission

VAR_INT player_4x4
VAR_INT counter_4x4_pickups timer_4x4
VAR_INT wanted_4x4 flag_timer
VAR_INT intro_time_lapsed timer_intro_now timer_intro_start flag_intro
VAR_INT flag_intro_jump

VAR_INT flag_blip_1 flag_blip_2 flag_blip_3 flag_blip_4 
VAR_INT flag_blip_5 flag_blip_6 flag_blip_7 flag_blip_8 
VAR_INT flag_blip_9 flag_blip_10 flag_blip_11 flag_blip_12
VAR_INT flag_blip_13 flag_blip_14 flag_blip_15 flag_blip_16
VAR_INT flag_blip_17 flag_blip_18 flag_blip_19 flag_blip_20

VAR_INT blip_1 blip_2 blip_3 blip_4 
VAR_INT blip_5 blip_6 blip_7 blip_8 
VAR_INT blip_9 blip_10 blip_11 blip_12
VAR_INT blip_13 blip_14 blip_15 blip_16
VAR_INT blip_17 blip_18 blip_19 blip_20

VAR_FLOAT x_1 y_1 z_1 
VAR_FLOAT x_2 y_2 z_2 
VAR_FLOAT x_3 y_3 z_3 
VAR_FLOAT x_4 y_4 z_4 
VAR_FLOAT x_5 y_5 z_5 
VAR_FLOAT x_6 y_6 z_6 
VAR_FLOAT x_7 y_7 z_7 
VAR_FLOAT x_8 y_8 z_8 
VAR_FLOAT x_9 y_9 z_9 
VAR_FLOAT x_10 y_10 z_10 
VAR_FLOAT x_11 y_11 z_11 
VAR_FLOAT x_12 y_12 z_12 
VAR_FLOAT x_13 y_13 z_13 
VAR_FLOAT x_14 y_14 z_14 
VAR_FLOAT x_15 y_15 z_15 
VAR_FLOAT x_16 y_16 z_16 
VAR_FLOAT x_17 y_17 z_17 
VAR_FLOAT x_18 y_18 z_18 
VAR_FLOAT x_19 y_19 z_19 
VAR_FLOAT x_20 y_20 z_20 


// ****************************************Mission Start************************************

mission_start_4x4one:

REGISTER_MISSION_GIVEN

DISPLAY_RADAR 2 // PATHING OFF // for collecting in any order

SCRIPT_NAME t4x4_1 
flag_player_on_mission = 1
//flag_player_on_4x4_mission = 1

PRINT_BIG (T4X4_1) 5000 2

WAIT 0

//Set Variables

counter_4x4_pickups = 0
timer_4x4 = 0
flag_intro = 0
flag_timer = 0
flag_4x4one_trigger = 1
flag_intro_jump = 0

flag_blip_1 = 0
flag_blip_2 = 0
flag_blip_3 = 0
flag_blip_4 = 0
flag_blip_5 = 0
flag_blip_6 = 0
flag_blip_7 = 0
flag_blip_8 = 0
flag_blip_9 = 0
flag_blip_10 = 0
flag_blip_11 = 0
flag_blip_12 = 0
flag_blip_13 = 0
flag_blip_14 = 0
flag_blip_15 = 0

record_temp = 0

//Set Coords

x_1 = 1391.7
y_1 = -135.0
z_1 = 54.8
x_2 = 1428.7
y_2 = -350.53
z_2 = 39.82
x_3 = 1473.0
y_3 = -602.5
z_3 = 3.2
x_4 = 1508.74
y_4 = -150.43
z_4 = 40.31
x_5 = 1417.4
y_5 = -108.22
z_5 = 46.04
x_6 = 1619.44
y_6 = -263.8
z_6 = 27.49
x_7 = 1414.36
y_7 = -58.32
z_7 = 25.68
x_8 = 1481.34
y_8 = -146.62
z_8 = 26.85
x_9 = 1547.19
y_9 = -196.93
z_9 = 18.45
x_10 = 1557.45
y_10 = -60.88
z_10 = 17.62
x_11 = 1436.13
y_11 = -210.94
z_11 = 31.74
x_12 = 1520.62
y_12 = -293.49
z_12 = 3.03
x_13 = 1417.28
y_13 = -571.96
z_13 = 20.0
x_14 = 1423.66
y_14 = -488.49
z_14 = 36.57
x_15 = 1320.99
y_15 = -541.66
z_15 = 37.82

//Mission Script 

STORE_WANTED_LEVEL player wanted_4x4
CLEAR_WANTED_LEVEL player
STORE_CAR_PLAYER_IS_IN player player_4x4
IF NOT IS_CAR_DEAD player_4x4
	LOCK_CAR_DOORS player_4x4 CARLOCK_LOCKED
ENDIF
SET_PLAYER_CONTROL player off
SWITCH_WIDESCREEN on 
 
		
ADD_BLIP_FOR_COORD x_1 y_1 z_1 blip_1
ADD_BLIP_FOR_COORD x_2 y_2 z_2 blip_2
ADD_BLIP_FOR_COORD x_3 y_3 z_3 blip_3
ADD_BLIP_FOR_COORD x_4 y_4 z_4 blip_4
ADD_BLIP_FOR_COORD x_5 y_5 z_5 blip_5
ADD_BLIP_FOR_COORD x_6 y_6 z_6 blip_6
ADD_BLIP_FOR_COORD x_7 y_7 z_7 blip_7
ADD_BLIP_FOR_COORD x_8 y_8 z_8 blip_8
ADD_BLIP_FOR_COORD x_9 y_9 z_9 blip_9
ADD_BLIP_FOR_COORD x_10 y_10 z_10 blip_10
ADD_BLIP_FOR_COORD x_11 y_11 z_11 blip_11
ADD_BLIP_FOR_COORD x_12 y_12 z_12 blip_12
ADD_BLIP_FOR_COORD x_13 y_13 z_13 blip_13
ADD_BLIP_FOR_COORD x_14 y_14 z_14 blip_14
ADD_BLIP_FOR_COORD x_15 y_15 z_15 blip_15

WHILE counter_4x4_pickups < 15

	WAIT 0
	
	IF counter_4x4_pickups = 1
	AND flag_timer = 0
		DISPLAY_ONSCREEN_TIMER timer_4x4
		flag_timer = 1
	ENDIF


	IF flag_blip_1 = 0
		DRAW_CORONA x_1 y_1 z_1 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_1 y_1 z_1 2.5 2.5 3.5 false
			REMOVE_BLIP blip_1
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_1 y_1 z_1 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_1 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_2 = 0
		DRAW_CORONA x_2 y_2 z_2 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_2 y_2 z_2 2.5 2.5 3.5 false
			REMOVE_BLIP blip_2
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_2 y_2 z_2 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_2 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_3 = 0
		DRAW_CORONA x_3 y_3 z_3 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_3 y_3 z_3 2.5 2.5 3.5 false
			REMOVE_BLIP blip_3
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_3 y_3 z_3 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_3 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_4 = 0
		DRAW_CORONA x_4 y_4 z_4 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_4 y_4 z_4 2.5 2.5 3.5 false
			REMOVE_BLIP blip_4
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_4 y_4 z_4 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_4 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_5 = 0
		DRAW_CORONA x_5 y_5 z_5 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_5 y_5 z_5 2.5 2.5 3.5 false
			REMOVE_BLIP blip_5
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_5 y_5 z_5 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_5 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_6 = 0
		DRAW_CORONA x_6 y_6 z_6 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_6 y_6 z_6 2.5 2.5 3.5 false
			REMOVE_BLIP blip_6
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_6 y_6 z_6 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_6 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_7 = 0
		DRAW_CORONA x_7 y_7 z_7 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_7 y_7 z_7 2.5 2.5 3.5 false
			REMOVE_BLIP blip_7
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_7 y_7 z_7 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_7 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_8 = 0
		DRAW_CORONA x_8 y_8 z_8 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_8 y_8 z_8 2.5 2.5 3.5 false
			REMOVE_BLIP blip_8
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_8 y_8 z_8 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_8 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_9 = 0
		DRAW_CORONA x_9 y_9 z_9 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_9 y_9 z_9 2.5 2.5 3.5 false
			REMOVE_BLIP blip_9
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_9 y_9 z_9 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_9 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_10 = 0
		DRAW_CORONA x_10 y_10 z_10 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_10 y_10 z_10 2.5 2.5 3.5 false
			REMOVE_BLIP blip_10
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_10 y_10 z_10 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_10 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_11 = 0
		DRAW_CORONA x_11 y_11 z_11 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_11 y_11 z_11 2.5 2.5 3.5 false
			REMOVE_BLIP blip_11
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_11 y_11 z_11 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_11 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_12 = 0
		DRAW_CORONA x_12 y_12 z_12 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_12 y_12 z_12 2.5 2.5 3.5 false
			REMOVE_BLIP blip_12
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_12 y_12 z_12 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_12 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_13 = 0
		DRAW_CORONA x_13 y_13 z_13 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_13 y_13 z_13 2.5 2.5 3.5 false
			REMOVE_BLIP blip_13
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_13 y_13 z_13 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_13 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_14 = 0
		DRAW_CORONA x_14 y_14 z_14 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_14 y_14 z_14 2.5 2.5 3.5 false
			REMOVE_BLIP blip_14
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_14 y_14 z_14 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_14 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 

	IF flag_blip_15 = 0
		DRAW_CORONA x_15 y_15 z_15 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_15 y_15 z_15 2.5 2.5 3.5 false
			REMOVE_BLIP blip_15
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_15 y_15 z_15 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 20000
			flag_blip_15 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_1B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 

	IF flag_intro1_before = 1
		IF flag_intro_jump = 0
		AND flag_intro < 5
			IF IS_BUTTON_PRESSED PAD1 CROSS
				intro_time_lapsed = 10501
				flag_intro = 4
				flag_intro_jump = 1
			ENDIF
		ENDIF
	ENDIF

	IF flag_intro = 0
		GET_GAME_TIMER timer_intro_start
		SET_FIXED_CAMERA_POSITION 1458.0 -564.0 28.0 0.0 0.0 0.0
		SET_MUSIC_DOES_FADE FALSE
		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		LOAD_SCENE 1458.0 -564.0 28.0
		POINT_CAMERA_AT_POINT x_3 y_3 z_3 JUMP_CUT
		DO_FADE 1500 FADE_IN
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		PRINT_NOW (T4X4_1A) 5500 1 
		flag_intro = 1
	ENDIF

	IF flag_intro_jump = 0
		GET_GAME_TIMER timer_intro_now
		intro_time_lapsed = timer_intro_now - timer_intro_start
	ENDIF

	IF intro_time_lapsed > 3500
	AND flag_intro = 1
		POINT_CAMERA_AT_POINT x_14 y_14 z_14 INTERPOLATION
		flag_intro = 2
	ENDIF
	
	IF intro_time_lapsed > 6500
	AND flag_intro = 2
	   PRINT_NOW (T4X4_1C) 5500 1
	   flag_intro = 3
	ENDIF

	IF intro_time_lapsed > 7000
	AND flag_intro = 3
		POINT_CAMERA_AT_POINT x_13 y_13 z_13 INTERPOLATION
		//PRINT_NOW (T4X4_1C) 5500 1
		flag_intro = 4
	ENDIF
	
	IF intro_time_lapsed > 10500
	AND flag_intro = 4
		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		CLEAR_PRINTS
		LOAD_SCENE 1301.0 -650.0 12.0
		RESTORE_CAMERA_JUMPCUT
		SWITCH_WIDESCREEN off
		SET_PLAYER_CONTROL player on
		IF NOT IS_CAR_DEAD player_4x4
			LOCK_CAR_DOORS player_4x4 CARLOCK_UNLOCKED
		ENDIF
		ALTER_WANTED_LEVEL player wanted_4x4
		DO_FADE 1500 FADE_IN
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		SET_MUSIC_DOES_FADE TRUE
		flag_intro = 5
		flag_intro1_before = 1
	ENDIF
	
	IF flag_timer = 1
		IF timer_4x4 < 1
			PRINT_NOW (taxi2) 3000 1
			GOTO mission_4x4one_failed
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_MODEL player CAR_PATRIOT
		PRINT_NOW (T4x4_F) 3000 1
		GOTO mission_4x4one_failed
	ENDIF

ENDWHILE

IF counter_4x4_pickups = 15
	GOTO mission_4x4one_passed
ENDIF 

// --------------------------Mission failed-----------------------------------------------

mission_4x4one_failed:


PRINT_BIG ( M_FAIL ) 2000 1


RETURN
   




// -------------------------Mission passed-------------------------------------------------

mission_4x4one_passed:

IF flag_4x4_mission1_passed = 0
	record_4x4_one = 300000 - timer_4x4
	record_4x4_one = record_4x4_one / 1000
ENDIF

IF flag_4x4_mission1_passed = 1
	record_temp = 300000 - timer_4x4
	record_temp = record_temp / 1000
	
	IF record_temp < record_4x4_one
		record_4x4_one = record_temp
	ENDIF
ENDIF


PRINT_WITH_NUMBER_BIG ( M_PASS ) 20000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
CLEAR_WANTED_LEVEL player
ADD_SCORE player 20000
REGISTER_4X4_ONE_TIME record_4x4_one
IF flag_4x4_mission1_passed = 0
	REGISTER_MISSION_PASSED T4X4_1
	flag_4x4_mission1_passed = 1
	PLAYER_MADE_PROGRESS 1 

ENDIF

//START_NEW_SCRIPT t4x4_mission2_loop
//START_NEW_SCRIPT multistorey_mission_loop

RETURN
		


// mission cleanup

mission_cleanup_4x4one:

DISPLAY_RADAR 3 // PATHING ON

REMOVE_BLIP blip_1
REMOVE_BLIP blip_2
REMOVE_BLIP blip_3
REMOVE_BLIP blip_4
REMOVE_BLIP blip_5
REMOVE_BLIP blip_6
REMOVE_BLIP blip_7
REMOVE_BLIP blip_8
REMOVE_BLIP blip_9
REMOVE_BLIP blip_10
REMOVE_BLIP blip_11
REMOVE_BLIP blip_12
REMOVE_BLIP blip_13
REMOVE_BLIP blip_14
REMOVE_BLIP blip_15

RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN off
SET_PLAYER_CONTROL player on

CLEAR_ONSCREEN_TIMER timer_4x4
flag_player_on_mission = 0
//flag_player_on_4x4_mission = 0

MISSION_HAS_FINISHED
RETURN
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ***************************************A ride in the Park******************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_4x4two
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_4x4two_failed
ENDIF
GOSUB mission_cleanup_4x4two
MISSION_END

// Variables for mission

//VAR_INT player_4x4_two
//VAR_INT counter_4x4_pickups timer_4x4 
//VAR_INT wanted_4x4
//VAR_INT intro_time_lapsed timer_intro_now timer_intro_start flag_intro
//VAR_INT flag_timer
/*
VAR_INT blip_1 blip_2 blip_3
VAR_INT blip_4 blip_5 blip_6
VAR_INT blip_7 blip_8 blip_9
VAR_INT blip_10 blip_11 blip_12

VAR_INT flag_blip_1 flag_blip_2 flag_blip_3 flag_blip_4 
VAR_INT flag_blip_5 flag_blip_6 flag_blip_7 flag_blip_8 
VAR_INT flag_blip_9 flag_blip_10 flag_blip_11 flag_blip_12

//variables called in 4x4_1.sc

VAR_FLOAT x_1 y_1 z_1 
VAR_FLOAT x_2 y_2 z_2 
VAR_FLOAT x_3 y_3 z_3 
VAR_FLOAT x_4 y_4 z_4 
VAR_FLOAT x_5 y_5 z_5 
VAR_FLOAT x_6 y_6 z_6 
VAR_FLOAT x_7 y_7 z_7 
VAR_FLOAT x_8 y_8 z_8 
VAR_FLOAT x_9 y_9 z_9 
VAR_FLOAT x_10 y_10 z_10 
VAR_FLOAT x_11 y_11 z_11 
VAR_FLOAT x_12 y_12 z_12 
*/

// ****************************************Mission Start************************************

mission_start_4x4two:
REGISTER_MISSION_GIVEN

DISPLAY_RADAR 2 // PATHING OFF // for collecting in any order

SCRIPT_NAME t4x4_2 
flag_player_on_mission = 1
//flag_player_on_4x4_mission = 1

PRINT_BIG ( T4X4_2 ) 15000 2

WAIT 0

//Set Variables

counter_4x4_pickups = 0
timer_4x4 = 0
flag_intro = 0
flag_4x4two_trigger = 1
flag_timer = 0
flag_intro_jump = 0

flag_blip_1 = 0
flag_blip_2 = 0
flag_blip_3 = 0
flag_blip_4 = 0
flag_blip_5 = 0
flag_blip_6 = 0
flag_blip_7 = 0
flag_blip_8 = 0
flag_blip_9 = 0
flag_blip_10 = 0
flag_blip_11 = 0
flag_blip_12 = 0

record_temp = 0

//Set Coords

x_1 = 6.52
y_1 = -701.37
z_1 = 29.0

x_2 = 6.53
y_2 = -745.1
z_2 = 29.0

x_3 = 51.87
y_3 = -605.19
z_3 = 25.94

x_4 = 52.85
y_4 = -639.2
z_4 = 28.55

x_5 = 53.89
y_5 = -885.37
z_5 = 31.95

x_6 = 81.66
y_6 = -779.26
z_6 = 26.65

x_7 = 64.26
y_7 = -777.5
z_7 = 25.74

x_8 = 90.30
y_8 = -732.48
z_8 = 31.23

x_9 = 83.48
y_9 = -724.55
z_9 = 31.6

x_10 = 39.61
y_10 = -724.42
z_10 = 22.77

x_11 = 11.63
y_11 = -743.12
z_11 = 28.54

x_12 = 68.55
y_12 = -773.13
z_12 = 22.92

//Mission Script 

STORE_WANTED_LEVEL player wanted_4x4
CLEAR_WANTED_LEVEL player
STORE_CAR_PLAYER_IS_IN player player_4x4 
IF NOT IS_CAR_DEAD player_4x4
	LOCK_CAR_DOORS player_4x4 CARLOCK_UNLOCKED
ENDIF
SET_PLAYER_CONTROL player off
SWITCH_WIDESCREEN on 
 
		
ADD_BLIP_FOR_COORD x_1 y_1 z_1 blip_1
ADD_BLIP_FOR_COORD x_2 y_2 z_2 blip_2
ADD_BLIP_FOR_COORD x_3 y_3 z_3 blip_3
ADD_BLIP_FOR_COORD x_4 y_4 z_4 blip_4
ADD_BLIP_FOR_COORD x_5 y_5 z_5 blip_5
ADD_BLIP_FOR_COORD x_6 y_6 z_6 blip_6
ADD_BLIP_FOR_COORD x_7 y_7 z_7 blip_7
ADD_BLIP_FOR_COORD x_8 y_8 z_8 blip_8
ADD_BLIP_FOR_COORD x_9 y_9 z_9 blip_9
ADD_BLIP_FOR_COORD x_10 y_10 z_10 blip_10
ADD_BLIP_FOR_COORD x_11 y_11 z_11 blip_11
ADD_BLIP_FOR_COORD x_12 y_12 z_12 blip_12

WHILE counter_4x4_pickups < 12

	WAIT 0

	IF counter_4x4_pickups = 1
	AND flag_timer = 0
		DISPLAY_ONSCREEN_TIMER timer_4x4
		flag_timer = 1
	ENDIF

	IF flag_blip_1 = 0
		DRAW_CORONA x_1 y_1 z_1 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_1 y_1 z_1 2.5 2.5 3.5 false
			REMOVE_BLIP blip_1
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_1 y_1 z_1 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_1 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_2 = 0
		DRAW_CORONA x_2 y_2 z_2 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_2 y_2 z_2 2.5 2.5 3.5 false
			REMOVE_BLIP blip_2
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_2 y_2 z_2 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_2 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_3 = 0
		DRAW_CORONA x_3 y_3 z_3 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_3 y_3 z_3 2.5 2.5 3.5 false
			REMOVE_BLIP blip_3
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_3 y_3 z_3 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_3 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_4 = 0
		DRAW_CORONA x_4 y_4 z_4 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_4 y_4 z_4 2.5 2.5 3.5 false
			REMOVE_BLIP blip_4
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_4 y_4 z_4 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_4 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_5 = 0
		DRAW_CORONA x_5 y_5 z_5 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_5 y_5 z_5 2.5 2.5 3.5 false
			REMOVE_BLIP blip_5
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_5 y_5 z_5 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_5 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_6 = 0
		DRAW_CORONA x_6 y_6 z_6 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_6 y_6 z_6 2.5 2.5 3.5 false
			REMOVE_BLIP blip_6
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_6 y_6 z_6 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_6 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_7 = 0
		DRAW_CORONA x_7 y_7 z_7 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_7 y_7 z_7 2.5 2.5 3.5 false
			REMOVE_BLIP blip_7
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_7 y_7 z_7 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_7 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_8 = 0
		DRAW_CORONA x_8 y_8 z_8 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_8 y_8 z_8 2.5 2.5 3.5 false
			REMOVE_BLIP blip_8
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_8 y_8 z_8 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_8 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_9 = 0
		DRAW_CORONA x_9 y_9 z_9 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_9 y_9 z_9 2.5 2.5 3.5 false
			REMOVE_BLIP blip_9
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_9 y_9 z_9 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_9 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_10 = 0
		DRAW_CORONA x_10 y_10 z_10 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_10 y_10 z_10 2.5 2.5 3.5 false
			REMOVE_BLIP blip_10
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_10 y_10 z_10 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_10 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_11 = 0
		DRAW_CORONA x_11 y_11 z_11 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_11 y_11 z_11 2.5 2.5 3.5 false
			REMOVE_BLIP blip_11
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_11 y_11 z_11 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_11 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_12 = 0
		DRAW_CORONA x_12 y_12 z_12 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_12 y_12 z_12 2.5 2.5 3.5 false
			REMOVE_BLIP blip_12
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_12 y_12 z_12 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 10000
			flag_blip_12 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_2B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_intro2_before = 1
		IF flag_intro_jump = 0
		AND flag_intro < 5
			IF IS_BUTTON_PRESSED PAD1 CROSS
				intro_time_lapsed = 10501
				flag_intro = 4
				flag_intro_jump = 1
			ENDIF
		ENDIF
	ENDIF

	IF flag_intro = 0
		GET_GAME_TIMER timer_intro_start
		SET_FIXED_CAMERA_POSITION 50.48 -727.5 27.0 0.0 0.0 0.0
		SET_MUSIC_DOES_FADE FALSE
		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		//WAIT 1500
		LOAD_SCENE 50.48 -727.5 27.0
		POINT_CAMERA_AT_POINT x_8 y_8 z_8 JUMP_CUT
		DO_FADE 1500 FADE_IN
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		//WAIT 1500
		PRINT_NOW (T4X4_2A) 5000 1
		flag_intro = 1
	ENDIF

	IF flag_intro_jump = 0
		GET_GAME_TIMER timer_intro_now
		intro_time_lapsed = timer_intro_now - timer_intro_start
	ENDIF
	
	IF intro_time_lapsed > 3500
	AND flag_intro = 1
		POINT_CAMERA_AT_POINT x_9 y_9 z_9 INTERPOLATION
		flag_intro = 2
	ENDIF
	
	IF intro_time_lapsed > 6500
	AND flag_intro = 2
	   PRINT_NOW (T4X4_2C) 5500 1
	   flag_intro = 3
	ENDIF
	
	IF intro_time_lapsed > 7000
	AND flag_intro = 3
		POINT_CAMERA_AT_POINT x_10 y_10 z_10 INTERPOLATION
		flag_intro = 4
	ENDIF
	
	IF intro_time_lapsed > 10500
	AND flag_intro = 4
		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		CLEAR_PRINTS
		LOAD_SCENE 50.0 -930.0 20.0
		RESTORE_CAMERA_JUMPCUT 
		SWITCH_WIDESCREEN off
		SET_PLAYER_CONTROL player on
		IF NOT IS_CAR_DEAD player_4x4
			LOCK_CAR_DOORS player_4x4 CARLOCK_UNLOCKED
		ENDIF
		ALTER_WANTED_LEVEL player wanted_4x4
		DO_FADE 1500 FADE_IN
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		SET_MUSIC_DOES_FADE TRUE
		flag_intro = 5
		flag_intro2_before = 1
	ENDIF
	
	IF flag_timer = 1
		IF timer_4x4 < 1
			PRINT_NOW (taxi2) 3000 1
			GOTO mission_4x4two_failed
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_MODEL player CAR_LANDSTALKER
		PRINT_NOW (T4x4_F) 3000 1
		GOTO mission_4x4two_failed
	ENDIF

ENDWHILE

IF counter_4x4_pickups = 12
	GOTO mission_4x4two_passed
ENDIF 

// --------------------------Mission failed-----------------------------------------------

mission_4x4two_failed:


PRINT_BIG ( M_FAIL ) 2000 1


RETURN
   




// -------------------------Mission passed-------------------------------------------------

mission_4x4two_passed:

IF flag_4x4_mission2_passed = 0
	record_4x4_two = 120000 - timer_4x4
	record_4x4_two = record_4x4_two / 1000
ENDIF

IF flag_4x4_mission2_passed = 1
	record_temp = 120000 - timer_4x4
	record_temp = record_temp / 1000
	
	IF record_temp < record_4x4_two
		record_4x4_two = record_temp
	ENDIF
ENDIF


PRINT_WITH_NUMBER_BIG ( M_PASS ) 30000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
//PRINT_WITH_NUMBER_NOW (Y1_1ST) counter_player_points 4000 1
CLEAR_WANTED_LEVEL player
ADD_SCORE player 30000
REGISTER_4X4_TWO_TIME record_4x4_two

IF flag_4x4_mission2_passed = 0
	REGISTER_MISSION_PASSED T4X4_2
	flag_4x4_mission2_passed = 1
	PLAYER_MADE_PROGRESS 1 
ENDIF
//START_NEW_SCRIPT t4x4_mission3_loop

RETURN
		


// mission cleanup

mission_cleanup_4x4two:

DISPLAY_RADAR 3 // PATHING ON

CLEAR_ONSCREEN_TIMER timer_4x4

RESTORE_CAMERA_JUMPCUT 
SWITCH_WIDESCREEN off
SET_PLAYER_CONTROL player on

REMOVE_BLIP blip_1
REMOVE_BLIP blip_2
REMOVE_BLIP blip_3
REMOVE_BLIP blip_4
REMOVE_BLIP blip_5
REMOVE_BLIP blip_6
REMOVE_BLIP blip_7
REMOVE_BLIP blip_8
REMOVE_BLIP blip_9
REMOVE_BLIP blip_10
REMOVE_BLIP blip_11
REMOVE_BLIP blip_12


flag_player_on_mission = 0
//flag_player_on_4x4_mission = 0


MISSION_HAS_FINISHED
RETURN
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ***************************************GRIPPED, SORTED*********************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_4x4three
GOSUB mission_cleanup_4x4three
MISSION_END

// Variables for mission

//VAR_INT player_4x4_three
//VAR_INT counter_4x4_pickups timer_4x4
//VAR_INT flag_timer_patriot
//VAR_INT intro_time_lapsed timer_intro_now timer_intro_start flag_intro
/*
VAR_INT blip_1 blip_2 blip_3
VAR_INT blip_4 blip_5 blip_6
VAR_INT blip_7 blip_8 blip_9
VAR_INT blip_10 blip_11 blip_12
VAR_INT blip_13 blip_14 blip_15

VAR_INT flag_blip_17 flag_blip_2 flag_blip_3 flag_blip_4 
VAR_INT flag_blip_5 flag_blip_6 flag_blip_7 flag_blip_8 
VAR_INT flag_blip_9 flag_blip_10 flag_blip_11 flag_blip_12
VAR_INT flag_blip_13 flag_blip_14 flag_blip_15 flag_blip_16

VAR_FLOAT x_1 y_1 z_1 
VAR_FLOAT x_2 y_2 z_2 
VAR_FLOAT x_3 y_3 z_3 
VAR_FLOAT x_4 y_4 z_4 
VAR_FLOAT x_5 y_5 z_5 
VAR_FLOAT x_6 y_6 z_6 
VAR_FLOAT x_7 y_7 z_7 
VAR_FLOAT x_8 y_8 z_8 
VAR_FLOAT x_9 y_9 z_9 
VAR_FLOAT x_10 y_10 z_10 
VAR_FLOAT x_11 y_11 z_11 
VAR_FLOAT x_12 y_12 z_12 
VAR_FLOAT x_13 y_13 z_13 
VAR_FLOAT x_14 y_14 z_14 
VAR_FLOAT x_15 y_15 z_15 
VAR_FLOAT x_16 y_16 z_16 
VAR_FLOAT x_17 y_17 z_17 
VAR_FLOAT x_18 y_18 z_18 
VAR_FLOAT x_19 y_19 z_19 
VAR_FLOAT x_20 y_20 z_20 
*/

// ****************************************Mission Start************************************

mission_start_4x4three:
REGISTER_MISSION_GIVEN

DISPLAY_RADAR 2 // PATHING OFF // for collecting in any order

SCRIPT_NAME t4x4_3 
flag_player_on_mission = 1
//flag_player_on_4x4_mission = 1

PRINT_BIG (T4X4_3) 5000 2

WAIT 0

//Set Variables

counter_4x4_pickups = 0
timer_4x4 = 0
flag_intro = 0
flag_timer = 0
flag_4x4three_trigger = 1
flag_intro_jump = 0

flag_blip_1 = 0
flag_blip_2 = 0
flag_blip_3 = 0
flag_blip_4 = 0
flag_blip_5 = 0
flag_blip_6 = 0
flag_blip_7 = 0
flag_blip_8 = 0
flag_blip_9 = 0
flag_blip_10 = 0
flag_blip_11 = 0
flag_blip_12 = 0
flag_blip_13 = 0
flag_blip_14 = 0
flag_blip_15 = 0
flag_blip_16 = 0
flag_blip_17 = 0
flag_blip_18 = 0
flag_blip_19 = 0
flag_blip_20 = 0

record_temp = 0

//Set Coords

x_1 = -236.5
y_1 = 188.8
z_1 = 11.6

x_2 = -288.6
y_2 = 153.7
z_2 = 8.6

x_3 = -346.8
y_3 = 158.0
z_3 = 26.0

x_4 = -399.8
y_4 = 192.6
z_4 = 50.7

x_5 = -389.4 
y_5 = 194.7
z_5 = 50.3

x_6 = -335.9
y_6 = 202.2
z_6 = 54.7

x_7 = -445.3
y_7 = 204.6
z_7 = 63.8

x_8 = -296.9
y_8 = 262.4
z_8 = 66.8

x_9 = -210.2
y_9 = 399.9
z_9 = 96.5

x_10 = -187.6
y_10 = 557.6
z_10 = 140.0

x_11 = -230.1
y_11 = 609.3
z_11 = 138.9

x_12 = -393.5
y_12 = 502.8
z_12 = 150.4

x_13 = -526.5
y_13 = 494.0
z_13 = 163.4

x_14 = -393.2
y_14 = 403.8
z_14 = 132.1

x_15 = -499.4
y_15 = 407.8
z_15 = 116.5

x_16 = -686.6
y_16 = 386.3
z_16 = 103.4


x_17 = -744.4
y_17 = 507.8
z_17 = 160.5

x_18 = -814.9
y_18 = 563.1
z_18 = 121.9

x_19 = -879.9
y_19 = 585.7
z_19 = 94.3

x_20 = -829.3
y_20 = 412.3
z_20 = 93.9

//Mission Script 

STORE_WANTED_LEVEL player wanted_4x4
CLEAR_WANTED_LEVEL player
STORE_CAR_PLAYER_IS_IN player player_4x4
IF NOT IS_CAR_DEAD player_4x4
	LOCK_CAR_DOORS player_4x4 CARLOCK_UNLOCKED
ENDIF

SET_PLAYER_CONTROL player off
SWITCH_WIDESCREEN on 
 
		
ADD_BLIP_FOR_COORD x_1 y_1 z_1 blip_1
ADD_BLIP_FOR_COORD x_2 y_2 z_2 blip_2
ADD_BLIP_FOR_COORD x_3 y_3 z_3 blip_3
ADD_BLIP_FOR_COORD x_4 y_4 z_4 blip_4
ADD_BLIP_FOR_COORD x_5 y_5 z_5 blip_5
ADD_BLIP_FOR_COORD x_6 y_6 z_6 blip_6
ADD_BLIP_FOR_COORD x_7 y_7 z_7 blip_7
ADD_BLIP_FOR_COORD x_8 y_8 z_8 blip_8
ADD_BLIP_FOR_COORD x_9 y_9 z_9 blip_9
ADD_BLIP_FOR_COORD x_10 y_10 z_10 blip_10
ADD_BLIP_FOR_COORD x_11 y_11 z_11 blip_11
ADD_BLIP_FOR_COORD x_12 y_12 z_12 blip_12
ADD_BLIP_FOR_COORD x_13 y_13 z_13 blip_13
ADD_BLIP_FOR_COORD x_14 y_14 z_14 blip_14
ADD_BLIP_FOR_COORD x_15 y_15 z_15 blip_15
ADD_BLIP_FOR_COORD x_16 y_16 z_16 blip_16
ADD_BLIP_FOR_COORD x_17 y_17 z_17 blip_17
ADD_BLIP_FOR_COORD x_18 y_18 z_18 blip_18
ADD_BLIP_FOR_COORD x_19 y_19 z_19 blip_19
ADD_BLIP_FOR_COORD x_20 y_20 z_20 blip_20

WHILE counter_4x4_pickups < 20

	WAIT 0
	
	IF counter_4x4_pickups = 1
	AND flag_timer = 0
		DISPLAY_ONSCREEN_TIMER timer_4x4
		flag_timer = 1
	ENDIF


	IF flag_blip_1 = 0
		DRAW_CORONA x_1 y_1 z_1 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_1 y_1 z_1 2.5 2.5 3.5 false
			REMOVE_BLIP blip_1
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_1 y_1 z_1 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_1 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_2 = 0
		DRAW_CORONA x_2 y_2 z_2 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_2 y_2 z_2 2.5 2.5 3.5 false
			REMOVE_BLIP blip_2
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_2 y_2 z_2 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_2 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_3 = 0
		DRAW_CORONA x_3 y_3 z_3 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_3 y_3 z_3 2.5 2.5 3.5 false
			REMOVE_BLIP blip_3
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_3 y_3 z_3 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_3 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_4 = 0
		DRAW_CORONA x_4 y_4 z_4 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_4 y_4 z_4 2.5 2.5 3.5 false
			REMOVE_BLIP blip_4
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_4 y_4 z_4 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_4 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_5 = 0
		DRAW_CORONA x_5 y_5 z_5 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_5 y_5 z_5 2.5 2.5 3.5 false
			REMOVE_BLIP blip_5
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_12 y_12 z_12 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_5 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_6 = 0
		DRAW_CORONA x_6 y_6 z_6 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_6 y_6 z_6 2.5 2.5 3.5 false
			REMOVE_BLIP blip_6
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_6 y_6 z_6 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_6 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_7 = 0
		DRAW_CORONA x_7 y_7 z_7 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_7 y_7 z_7 2.5 2.5 3.5 false
			REMOVE_BLIP blip_7
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_7 y_7 z_7 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_7 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_8 = 0
		DRAW_CORONA x_8 y_8 z_8 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_8 y_8 z_8 2.5 2.5 3.5 false
			REMOVE_BLIP blip_8
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_8 y_8 z_8 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_8 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_9 = 0
		DRAW_CORONA x_9 y_9 z_9 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_9 y_9 z_9 2.5 2.5 3.5 false
			REMOVE_BLIP blip_9
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_9 y_9 z_9 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_9 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_10 = 0
		DRAW_CORONA x_10 y_10 z_10 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_10 y_10 z_10 2.5 2.5 3.5 false
			REMOVE_BLIP blip_10
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_10 y_10 z_10 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_10 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_11 = 0
		DRAW_CORONA x_11 y_11 z_11 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_11 y_11 z_11 2.5 2.5 3.5 false
			REMOVE_BLIP blip_11
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_11 y_11 z_11 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_11 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_12 = 0
		DRAW_CORONA x_12 y_12 z_12 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_12 y_12 z_12 2.5 2.5 3.5 false
			REMOVE_BLIP blip_12
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_12 y_12 z_12 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_12 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_13 = 0
		DRAW_CORONA x_13 y_13 z_13 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_13 y_13 z_13 2.5 2.5 3.5 false
			REMOVE_BLIP blip_13
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_13 y_13 z_13 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_13 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_14 = 0
		DRAW_CORONA x_14 y_14 z_14 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_14 y_14 z_14 2.5 2.5 3.5 false
			REMOVE_BLIP blip_14
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_14 y_14 z_14 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_14 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 

	IF flag_blip_15 = 0
		DRAW_CORONA x_15 y_15 z_15 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_15 y_15 z_15 2.5 2.5 3.5 false
			REMOVE_BLIP blip_15
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_15 y_15 z_15 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_15 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 

	IF flag_blip_16 = 0
		DRAW_CORONA x_16 y_16 z_16 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_16 y_16 z_16 2.5 2.5 3.5 false
			REMOVE_BLIP blip_16
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_16 y_16 z_16 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_16 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_17 = 0
		DRAW_CORONA x_17 y_17 z_17 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_17 y_17 z_17 2.5 2.5 3.5 false
			REMOVE_BLIP blip_17
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_17 y_17 z_17 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_17 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_18 = 0
		DRAW_CORONA x_18 y_18 z_18 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_18 y_18 z_18 2.5 2.5 3.5 false
			REMOVE_BLIP blip_18
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_18 y_18 z_18 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_18 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_19 = 0
		DRAW_CORONA x_19 y_19 z_19 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_19 y_19 z_19 2.5 2.5 3.5 false
			REMOVE_BLIP blip_19
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_19 y_19 z_19 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_19 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_20 = 0
		DRAW_CORONA x_20 y_20 z_20 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_20 y_20 z_20 2.5 2.5 3.5 false
			REMOVE_BLIP blip_20
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_20 y_20 z_20 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 15000
			flag_blip_20 = 1
			PRINT_WITH_NUMBER_NOW (T4X4_3C) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_intro3_before = 1
		IF flag_intro_jump = 0
		AND flag_intro < 4
			IF IS_BUTTON_PRESSED PAD1 CROSS
				intro_time_lapsed = 8501
				flag_intro = 3
				flag_intro_jump = 1
			ENDIF
		ENDIF
	ENDIF

	IF flag_intro = 0
		GET_GAME_TIMER timer_intro_start
		SET_FIXED_CAMERA_POSITION -328.0 132.0 25.0 0.0 0.0 0.0
		SET_MUSIC_DOES_FADE FALSE
		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		LOAD_SCENE -328.0 132.0 25.0
		POINT_CAMERA_AT_POINT x_2 y_2 z_2 JUMP_CUT
		DO_FADE 1500 FADE_IN
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		PRINT_NOW (T4X4_3A) 5000 1 
		flag_intro = 1
	ENDIF

	IF flag_intro_jump = 0
		GET_GAME_TIMER timer_intro_now
		intro_time_lapsed = timer_intro_now - timer_intro_start
	ENDIF
	
	IF intro_time_lapsed > 4500
	AND flag_intro = 1
		POINT_CAMERA_AT_POINT x_3 y_3 z_3 INTERPOLATION
		flag_intro = 2
	ENDIF
	
	IF intro_time_lapsed > 6000
	AND flag_intro = 2
		POINT_CAMERA_AT_POINT x_4 y_4 z_4 INTERPOLATION
		PRINT_NOW (T4X4_3B) 5000 1
		flag_intro = 3
	ENDIF
	
	IF intro_time_lapsed > 8500
	AND flag_intro = 3
		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		CLEAR_PRINTS
		LOAD_SCENE -230.0 270.0 20.0
		RESTORE_CAMERA_JUMPCUT
		SWITCH_WIDESCREEN off
		SET_PLAYER_CONTROL player on
		IF NOT IS_CAR_DEAD player_4x4
			LOCK_CAR_DOORS player_4x4 CARLOCK_UNLOCKED
		ENDIF
		ALTER_WANTED_LEVEL player wanted_4x4
		DO_FADE 1500 FADE_IN
		WHILE GET_FADING_STATUS
			WAIT 0
		ENDWHILE
		SET_MUSIC_DOES_FADE TRUE
		flag_intro = 4
		flag_intro3_before = 1
	ENDIF
	
	IF flag_timer = 1
		IF timer_4x4 < 1
			PRINT_NOW (taxi2) 3000 1
			GOTO mission_4x4three_failed
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_MODEL player CAR_PATRIOT
		PRINT_NOW (T4x4_F) 3000 1
		GOTO mission_4x4three_failed
	ENDIF

ENDWHILE

IF counter_4x4_pickups = 20
	GOTO mission_4x4three_passed
ENDIF 

// --------------------------Mission failed-----------------------------------------------

mission_4x4three_failed:


PRINT_BIG ( M_FAIL ) 2000 1


RETURN
   




// -------------------------Mission passed-------------------------------------------------

mission_4x4three_passed:

IF flag_4x4_mission3_passed = 0
	record_4x4_three = 300000 - timer_4x4
	record_4x4_three = record_4x4_three / 1000
ENDIF

IF flag_4x4_mission3_passed = 1
	record_temp = 300000 - timer_4x4
	record_temp = record_temp / 1000
	
	IF record_temp < record_4x4_three
		record_4x4_three = record_temp
	ENDIF
ENDIF


PRINT_WITH_NUMBER_BIG ( M_PASS ) 40000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 40000
REGISTER_4X4_THREE_TIME record_4x4_three

IF flag_4x4_mission3_passed = 0
	REGISTER_MISSION_PASSED T4X4_3
	flag_4x4_mission3_passed = 1
	PLAYER_MADE_PROGRESS 1 
ENDIF

//START_NEW_SCRIPT t4x4_mission2_loop
//START_NEW_SCRIPT multistorey_mission_loop

RETURN
		


// mission cleanup

mission_cleanup_4x4three:

DISPLAY_RADAR 3 // PATHING ON

RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN off
SET_PLAYER_CONTROL player on

REMOVE_BLIP blip_1
REMOVE_BLIP blip_2
REMOVE_BLIP blip_3
REMOVE_BLIP blip_4
REMOVE_BLIP blip_5
REMOVE_BLIP blip_6
REMOVE_BLIP blip_7
REMOVE_BLIP blip_8
REMOVE_BLIP blip_9
REMOVE_BLIP blip_10
REMOVE_BLIP blip_11
REMOVE_BLIP blip_12
REMOVE_BLIP blip_13
REMOVE_BLIP blip_14
REMOVE_BLIP blip_15
REMOVE_BLIP blip_16
REMOVE_BLIP blip_17
REMOVE_BLIP blip_18
REMOVE_BLIP blip_19
REMOVE_BLIP blip_20

CLEAR_ONSCREEN_TIMER timer_4x4
flag_player_on_mission = 0
//flag_player_on_4x4_mission = 0

MISSION_HAS_FINISHED
RETURN
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ***************************************Multi-storey Mayhem******************************* 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_mayhem
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_mayhem_failed
ENDIF
GOSUB mission_cleanup_mayhem
MISSION_END

// Variables for mission
/* variables called in T4x4_1.sc
VAR_INT player_carpark
VAR_INT counter_4x4_pickups timer_4x4
VAR_INT wanted_4x4
VAR_INT intro_time_lapsed timer_intro_now timer_intro_start flag_intro
VAR_INT record_mayhem

VAR_INT flag_blip_1 flag_blip_2 flag_blip_3 flag_blip_4 
VAR_INT flag_blip_5 flag_blip_6 flag_blip_7 flag_blip_8 
VAR_INT flag_blip_9 flag_blip_10 flag_blip_11 flag_blip_12
VAR_INT flag_blip_13 flag_blip_14 flag_blip_15 flag_blip_16
VAR_INT flag_blip_17 flag_blip_18 flag_blip_19 flag_blip_20

VAR_INT blip_1 blip_2 blip_3 blip_4 
VAR_INT blip_5 blip_6 blip_7 blip_8 
VAR_INT blip_9 blip_10 blip_11 blip_12
VAR_INT blip_13 blip_14 blip_15 blip_16
VAR_INT blip_17 blip_18 blip_19 blip_20

VAR_FLOAT x_1 y_1 z_1 
VAR_FLOAT x_2 y_2 z_2 
VAR_FLOAT x_3 y_3 z_3 
VAR_FLOAT x_4 y_4 z_4 
VAR_FLOAT x_5 y_5 z_5 
VAR_FLOAT x_6 y_6 z_6 
VAR_FLOAT x_7 y_7 z_7 
VAR_FLOAT x_8 y_8 z_8 
VAR_FLOAT x_9 y_9 z_9 
VAR_FLOAT x_10 y_10 z_10 
VAR_FLOAT x_11 y_11 z_11 
VAR_FLOAT x_12 y_12 z_12 
*/

// ****************************************Mission Start************************************

mission_start_mayhem:
REGISTER_MISSION_GIVEN
SCRIPT_NAME mayhem 
flag_player_on_mission = 1
//flag_player_on_carpark_mission = 1

DISPLAY_RADAR 2 // PATHING OFF // can sometimes get pathing onto the street, dont want that

PRINT_BIG ( MM_1 ) 15000 2

WAIT 0

//Set Variables

counter_4x4_pickups = 0
timer_4x4 = 20000
flag_intro = 0
flag_mayhem_trigger = 1
record_temp = 0
flag_intro_jump = 0

flag_blip_1 = 0
flag_blip_2 = 0
flag_blip_3 = 0
flag_blip_4 = 0
flag_blip_5 = 0
flag_blip_6 = 0
flag_blip_7 = 0
flag_blip_8 = 0
flag_blip_9 = 0
flag_blip_10 = 0
flag_blip_11 = 0
flag_blip_12 = 0
flag_blip_13 = 0
flag_blip_14 = 0
flag_blip_15 = 0
flag_blip_16 = 0
flag_blip_17 = 0
flag_blip_18 = 0
flag_blip_19 = 0
flag_blip_20 = 0

//Set Coords

x_1 = 286.0//ground floor
y_1 = -519.0
z_1 = 26.2

x_2 = 302.0
y_2 = -532.0
z_2 = 26.2

x_3 = 271.0
y_3 = -547.0
z_3 = 26.2

x_4 = 303.0
y_4 = -577.0
z_4 = 26.2


x_5 = 327.5//first tier
y_5 = -583.0
z_5 = 29.2

x_6 = 324.5
y_6 = -536.5
z_6 = 29.2

x_7 = 340.0
y_7 = -492.0
z_7 = 29.2

x_8 = 311.0
y_8	= -510.0
z_8 = 29.2


x_9 = 293.0//2nd tier
y_9 = -484.0
z_9 = 31.6

x_10 = 302.0
y_10 = -511.0
z_10 = 31.6

x_11 = 301.0
y_11 = -560.0
z_11 = 31.6

x_12 = 301.0
y_12 = -606.0
z_12 = 31.6


x_13 = 314.5//3rd tier
y_13 = -595.0
z_13 = 33.9

x_14 = 338.0
y_14 = -565.0
z_14 = 33.9

x_15 = 317.0
y_15 = -545.0
z_15 = 33.9

x_16 = 337.0
y_16 = -523.0
z_16 = 33.9


x_17 = 302.0//4th tier
y_17 = -606.5
z_17 = 36.3

x_18 = 304.0
y_18 = -544.5
z_18 = 36.3

x_19 = 266.24
y_19 = -627.00
z_19 = 40.5

x_20 = 272.0
y_20 = -537.0
z_20 = 36.3

//Mission Script 

STORE_WANTED_LEVEL player wanted_4x4
CLEAR_WANTED_LEVEL player
STORE_CAR_PLAYER_IS_IN player player_4x4

SET_PLAYER_CONTROL player off
SWITCH_WIDESCREEN on 

IF NOT IS_CAR_DEAD player_4x4
	LOCK_CAR_DOORS player_4x4 CARLOCK_LOCKED 
ENDIF

ADD_BLIP_FOR_COORD x_1 y_1 z_1 blip_1
ADD_BLIP_FOR_COORD x_2 y_2 z_2 blip_2
ADD_BLIP_FOR_COORD x_3 y_3 z_3 blip_3
ADD_BLIP_FOR_COORD x_4 y_4 z_4 blip_4
ADD_BLIP_FOR_COORD x_5 y_5 z_5 blip_5
ADD_BLIP_FOR_COORD x_6 y_6 z_6 blip_6
ADD_BLIP_FOR_COORD x_7 y_7 z_7 blip_7
ADD_BLIP_FOR_COORD x_8 y_8 z_8 blip_8
ADD_BLIP_FOR_COORD x_9 y_9 z_9 blip_9
ADD_BLIP_FOR_COORD x_10 y_10 z_10 blip_10
ADD_BLIP_FOR_COORD x_11 y_11 z_11 blip_11
ADD_BLIP_FOR_COORD x_12 y_12 z_12 blip_12
ADD_BLIP_FOR_COORD x_13 y_13 z_13 blip_13
ADD_BLIP_FOR_COORD x_14 y_14 z_14 blip_14
ADD_BLIP_FOR_COORD x_15 y_15 z_15 blip_15
ADD_BLIP_FOR_COORD x_16 y_16 z_16 blip_16
ADD_BLIP_FOR_COORD x_17 y_17 z_17 blip_17
ADD_BLIP_FOR_COORD x_18 y_18 z_18 blip_18
ADD_BLIP_FOR_COORD x_19 y_19 z_19 blip_19
ADD_BLIP_FOR_COORD x_20 y_20 z_20 blip_20
					  

		
WHILE counter_4x4_pickups < 20

	WAIT 0


	IF flag_blip_1 = 0
		DRAW_CORONA x_1 y_1 z_1 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_1 y_1 z_1 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_1 y_1 z_1 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_1
			flag_blip_1 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_2 = 0
		DRAW_CORONA x_2 y_2 z_2 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_2 y_2 z_2 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_2 y_2 z_2 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_2
			flag_blip_2 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_3 = 0
		DRAW_CORONA x_3 y_3 z_3 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_3 y_3 z_3 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_3 y_3 z_3 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_3
			flag_blip_3 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_4 = 0
		DRAW_CORONA x_4 y_4 z_4 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_4 y_4 z_4 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_4 y_4 z_4 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_4
			flag_blip_4 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_5 = 0
		DRAW_CORONA x_5 y_5 z_5 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_5 y_5 z_5 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_5 y_5 z_5 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_5
			flag_blip_5 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_6 = 0
		DRAW_CORONA x_6 y_6 z_6 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_6 y_6 z_6 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_6 y_6 z_6 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_6
			flag_blip_6 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_7 = 0
		DRAW_CORONA x_7 y_7 z_7 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_7 y_7 z_7 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_7 y_7 z_7 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_7
			flag_blip_7 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_8 = 0
		DRAW_CORONA x_8 y_8 z_8 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_8 y_8 z_8 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_8 y_8 z_8 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_8
			flag_blip_8 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_9 = 0
		DRAW_CORONA x_9 y_9 z_9 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_9 y_9 z_9 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_9 y_9 z_9 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_9
			flag_blip_9 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_10 = 0
		DRAW_CORONA x_10 y_10 z_10 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_10 y_10 z_10 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_10 y_10 z_10 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_10
			flag_blip_10 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_11 = 0
		DRAW_CORONA x_11 y_11 z_11 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_11 y_11 z_11 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_11 y_11 z_11 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_11
			flag_blip_11 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_12 = 0
		DRAW_CORONA x_12 y_12 z_12 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_12 y_12 z_12 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_12 y_12 z_12 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_12
			flag_blip_12 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_13 = 0
		DRAW_CORONA x_13 y_13 z_13 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_13 y_13 z_13 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_13 y_13 z_13 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_13
			flag_blip_13 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_14 = 0
		DRAW_CORONA x_14 y_14 z_14 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_14 y_14 z_14 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_14 y_14 z_14 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_14
			flag_blip_14 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_15 = 0
		DRAW_CORONA x_15 y_15 z_15 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_15 y_15 z_15 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_15 y_15 z_15 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_15
			flag_blip_15 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_16 = 0
		DRAW_CORONA x_16 y_16 z_16 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_16 y_16 z_16 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_16 y_16 z_16 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_16
			flag_blip_16 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_17 = 0
		DRAW_CORONA x_17 y_17 z_17 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_17 y_17 z_17 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_17 y_17 z_17 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_17
			flag_blip_17 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_18 = 0
		DRAW_CORONA x_18 y_18 z_18 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_18 y_18 z_18 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_18 y_18 z_18 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_18
			flag_blip_18 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_19 = 0
		DRAW_CORONA x_19 y_19 z_19 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_19 y_19 z_19 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_19 y_19 z_19 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_19
			flag_blip_19 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_blip_20 = 0
		DRAW_CORONA x_20 y_20 z_20 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		IF LOCATE_PLAYER_IN_CAR_3D player x_20 y_20 z_20 2.0 2.0 2.0 false
			++ counter_4x4_pickups
			ADD_ONE_OFF_SOUND x_20 y_20 z_20 SOUND_PART_MISSION_COMPLETE
			timer_4x4 = timer_4x4 + 5000
			REMOVE_BLIP blip_20
			flag_blip_20 = 1
			PRINT_WITH_NUMBER_NOW (MM_1_B) counter_4x4_pickups 3000 1
		ENDIF
	ENDIF 
	
	IF flag_intro_mayhem_before = 1
		IF flag_intro_jump = 0
		AND flag_intro < 5
			IF IS_BUTTON_PRESSED PAD1 CROSS
				intro_time_lapsed = 10501
				flag_intro = 4
				flag_intro_jump = 1
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_intro = 0
		GET_GAME_TIMER timer_intro_start
		SET_FIXED_CAMERA_POSITION 281.48 -526.25 26.4 0.0 0.0 0.0
		SET_MUSIC_DOES_FADE FALSE
		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0

			// adding subroutines is still borked, only show the three the camera is pointing at
			DRAW_CORONA x_1 y_1 z_1 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
			DRAW_CORONA x_2 y_2 z_2 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
			DRAW_CORONA x_3 y_3 z_3 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		ENDWHILE
		POINT_CAMERA_AT_POINT x_1 y_1 z_1 JUMP_CUT 
		DO_FADE 1500 FADE_IN
		WHILE GET_FADING_STATUS
			WAIT 0

			// adding subroutines is still borked, only show the three the camera is pointing at
			DRAW_CORONA x_1 y_1 z_1 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
			DRAW_CORONA x_2 y_2 z_2 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
			DRAW_CORONA x_3 y_3 z_3 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		ENDWHILE
		PRINT_NOW (MM_1_A) 5500 1 
		flag_intro = 1
	ENDIF

	IF flag_intro_jump = 0
		GET_GAME_TIMER timer_intro_now
		intro_time_lapsed = timer_intro_now - timer_intro_start
	ENDIF
	
	IF intro_time_lapsed > 3500
	AND flag_intro = 1
		POINT_CAMERA_AT_POINT x_2 y_2 z_2 INTERPOLATION
		flag_intro = 2
	ENDIF
	
	IF intro_time_lapsed > 5500
	AND flag_intro = 2
		PRINT_NOW (MM_1_C) 5000 1
		flag_intro = 3
	ENDIF

	IF intro_time_lapsed > 7000
	AND flag_intro = 3
		POINT_CAMERA_AT_POINT x_3 y_3 z_3 INTERPOLATION
		flag_intro = 4
	ENDIF
	
	IF intro_time_lapsed > 10500
	AND flag_intro = 4
		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0

			// adding subroutines is still borked, only show the three the camera is pointing at
			DRAW_CORONA x_1 y_1 z_1 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
			DRAW_CORONA x_2 y_2 z_2 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
			DRAW_CORONA x_3 y_3 z_3 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		ENDWHILE
		CLEAR_PRINTS
		RESTORE_CAMERA_JUMPCUT
		SWITCH_WIDESCREEN off
		SET_PLAYER_CONTROL player on
		ALTER_WANTED_LEVEL player wanted_4x4
		IF NOT IS_CAR_DEAD player_4x4
			LOCK_CAR_DOORS player_4x4 CARLOCK_UNLOCKED 
		ENDIF
		DO_FADE 1500 FADE_IN
		WHILE GET_FADING_STATUS
			WAIT 0

			// adding subroutines is still borked, only show the three the camera is pointing at
			DRAW_CORONA x_1 y_1 z_1 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
			DRAW_CORONA x_2 y_2 z_2 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
			DRAW_CORONA x_3 y_3 z_3 1.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200
		ENDWHILE
		DISPLAY_ONSCREEN_TIMER timer_4x4
		SET_MUSIC_DOES_FADE TRUE
		flag_intro = 5
		flag_intro_mayhem_before = 1
	ENDIF
	
	IF timer_4x4 < 1
		PRINT_NOW (taxi2) 3000 1
		GOTO mission_mayhem_failed
	ENDIF
	
	IF NOT IS_PLAYER_IN_MODEL player CAR_STALLION
		PRINT_NOW (T4x4_F) 3000 1
		GOTO mission_mayhem_failed
	ENDIF

ENDWHILE

IF counter_4x4_pickups = 20
	GOTO mission_mayhem_passed
ENDIF 

// --------------------------Mission failed-----------------------------------------------

mission_mayhem_failed:


PRINT_BIG ( M_FAIL ) 2000 1

RETURN
   


// -------------------------Mission passed-------------------------------------------------

mission_mayhem_passed:

IF flag_mayhem_mission1_passed = 0
	record_mayhem = 120000 - timer_4x4
	record_mayhem = record_mayhem / 1000
ENDIF

IF flag_mayhem_mission1_passed = 1
	record_temp = 120000 - timer_4x4
	record_temp = record_temp / 1000
	
	IF record_temp < record_mayhem
		record_mayhem = record_temp
	ENDIF
ENDIF


PRINT_WITH_NUMBER_BIG ( M_PASS ) 30000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
//PRINT_WITH_NUMBER_NOW (Y1_1ST) counter_player_points 4000 1
CLEAR_WANTED_LEVEL player
ADD_SCORE player 30000
REGISTER_4X4_MAYHEM_TIME record_mayhem
IF flag_mayhem_mission1_passed = 0
	REGISTER_MISSION_PASSED MM_1 
	flag_mayhem_mission1_passed = 1
	PLAYER_MADE_PROGRESS 1 
ENDIF
//START_NEW_SCRIPT carpark_mission2_loop

RETURN
		


// mission cleanup

mission_cleanup_mayhem:

DISPLAY_RADAR 3 // PATHING ON

SET_PLAYER_CONTROL player on
CLEAR_ONSCREEN_TIMER timer_4x4
RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN off

REMOVE_BLIP blip_1
REMOVE_BLIP blip_2
REMOVE_BLIP blip_3
REMOVE_BLIP blip_4
REMOVE_BLIP blip_5
REMOVE_BLIP blip_6
REMOVE_BLIP blip_7
REMOVE_BLIP blip_8
REMOVE_BLIP blip_9
REMOVE_BLIP blip_10
REMOVE_BLIP blip_11
REMOVE_BLIP blip_12
REMOVE_BLIP blip_13
REMOVE_BLIP blip_14
REMOVE_BLIP blip_15
REMOVE_BLIP blip_16
REMOVE_BLIP blip_17
REMOVE_BLIP blip_18
REMOVE_BLIP blip_19
REMOVE_BLIP blip_20

flag_player_on_mission = 0
//flag_player_on_carpark_mission = 0


MISSION_HAS_FINISHED
RETURN
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *********************************** Ambulance missions ********************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_ambulance

GOSUB ambulance_failed

MISSION_END
 
// Variables for mission

VAR_INT	ped_time_limit players_ambulance flag_got_range_message	ped_time_limit_temp	ped_counter	number_of_injured_peds brackets_var
VAR_INT ambulance_health_last ambulance_health_now time_drop max_peds_in_car peds_in_car player_in_range_flag score_am bonus_time_flag
VAR_INT saved_peds	hospital_blip first_rescue_flag	time_chunk first_chunk_flag	ambulance_level	time_chunk_in_secs car_full_flag paramedic_location
VAR_INT drop_off_time_bonus	hospital_blip_flag random_scream mission_end_button_ambulance ped_sex_flag players_ambulance_health	saved_peds_this_go
VAR_INT injured_ped_1 injured_ped_1_blip injured_ped_1_flag
VAR_INT injured_ped_2 injured_ped_2_blip injured_ped_2_flag
VAR_INT injured_ped_3 injured_ped_3_blip injured_ped_3_flag
VAR_INT injured_ped_4 injured_ped_4_blip injured_ped_4_flag
VAR_INT injured_ped_5 injured_ped_5_blip injured_ped_5_flag
VAR_INT injured_ped_6 injured_ped_6_blip injured_ped_6_flag
VAR_INT injured_ped_7 injured_ped_7_blip injured_ped_7_flag
VAR_INT injured_ped_8 injured_ped_8_blip injured_ped_8_flag
VAR_INT injured_ped_9 injured_ped_9_blip injured_ped_9_flag
VAR_INT injured_ped_10 injured_ped_10_blip injured_ped_10_flag
VAR_INT injured_ped_11 injured_ped_11_blip injured_ped_11_flag
VAR_INT injured_ped_12 injured_ped_12_blip injured_ped_12_flag
//VAR_INT injured_ped_13 injured_ped_13_blip injured_ped_13_flag
//VAR_INT injured_ped_14 injured_ped_14_blip injured_ped_14_flag
//VAR_INT injured_ped_15 injured_ped_15_blip injured_ped_15_flag
VAR_INT ambu_hospital_blip_active amb_calc_inj

VAR_FLOAT random_x random_y	hospital_x hospital_y hospital_z
VAR_FLOAT player1_a_x	player1_a_y player1_a_z	hospital_door_x	hospital_door_y
VAR_FLOAT ped_coord_x ped_coord_y	ped_coord_z	sound_x sound_y sound_z
VAR_FLOAT difference_x_float_a difference_y_float_a	sum_difference_a_xy	
VAR_FLOAT players_distance_from_ped peds_distance_from_hospital ped_time_limit_float random_ped_heading	time_chunk_divider


// ****************************************Mission Start************************************

mission_start_ambulance:

// do this hack so the compiler knows the type of the hospital blip
ADD_BLIP_FOR_COORD hospital_x hospital_y hospital_z hospital_blip
REMOVE_BLIP hospital_blip

flag_player_on_mission = 1
flag_player_on_ambulance_mission = 1

WAIT 0

SCRIPT_NAME ambulan

ped_time_limit 			= 0
players_ambulance  		= 0
flag_got_range_message 	= 0
ambulance_health_last  	= 0
ambulance_health_now  	= 0
time_drop  				= 0
max_peds_in_car  		= 0
peds_in_car  			= 0
player_in_range_flag 	= 0
number_of_injured_peds	= 1
ped_counter 			= 0
injured_ped_1_flag		= 0
injured_ped_2_flag		= 0
injured_ped_3_flag		= 0
injured_ped_4_flag		= 0
injured_ped_5_flag		= 0
injured_ped_6_flag		= 0
injured_ped_7_flag		= 0
injured_ped_8_flag		= 0
injured_ped_9_flag		= 0
injured_ped_10_flag		= 0
injured_ped_11_flag		= 0
injured_ped_12_flag		= 0
//injured_ped_13_flag		= 0
//injured_ped_14_flag		= 0
//injured_ped_15_flag		= 0
saved_peds				= 0
first_rescue_flag		= 0
first_chunk_flag		= 0
time_chunk_divider		= 11.0
ambulance_level			= 1
time_chunk				= 0 
time_chunk_in_secs 		= 0
score_am				= 0
bonus_time_flag			= 0
drop_off_time_bonus		= 0
hospital_blip_flag		= 0
mission_end_button_ambulance = 0
car_full_flag = 0
saved_peds_this_go = 0
paramedic_location = 0
ambu_hospital_blip_active = 0

PRINT_NOW ATUTOR2 3000 1 // Take the injured people to the Hospital

WAIT 3000

SET_WANTED_MULTIPLIER 0.5

mission_root:

// 3master - ALL VIGILANTE MISSIONS SHOULD HAVE NO PATHING
// new new design! oddjobs with one target should still have pathing
//DISPLAY_RADAR 2 // PATHING OFF /////////////////////////
//////////////////////////////////////////////////////////

PRINT_WITH_NUMBER_NOW ALEVEL ambulance_level 5000 4 // Ambulance Mission Level ~1~

CLEAR_ONSCREEN_TIMER ped_time_limit

ped_time_limit = 0

CLEAR_HELP

IF got_siren_help_before = 0
	PRINT_HELP SIREN_1 //"To turn on this vehicles sirens tap the ~h~L1 button~w~."
	got_siren_help_before = 1
ENDIF

WHILE number_of_injured_peds > ped_counter
	GOSUB generate_random_coord
	GOSUB create_random_injured_ped
	GOSUB generate_timelimit
	++ ped_counter
ENDWHILE

IF number_of_injured_peds > 3
	bonus_time_flag = 1
ELSE
	bonus_time_flag = 0
ENDIF

time_chunk = ped_time_limit / number_of_injured_peds
time_chunk /= 2
brackets_var = number_of_injured_peds + 1
time_chunk *= brackets_var
ped_time_limit += time_chunk
ped_time_limit = ped_time_limit / number_of_injured_peds
time_chunk = ped_time_limit
time_chunk /= 2

DISPLAY_ONSCREEN_TIMER ped_time_limit

IF flag_player_on_mission = 0
	// now alternate depending on whether there are passengers
	//ADD_BLIP_FOR_COORD hospital_x hospital_y hospital_z hospital_blip
ENDIF

GOTO ambulance_loop

////////////////

create_random_injured_ped:

IF number_of_injured_peds > 0
AND injured_ped_1_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_1
	injured_ped_1_flag = 1
	SET_CHAR_BLEEDING injured_ped_1 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_1 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_1 random_ped_heading
	SET_CHAR_RUNNING injured_ped_1 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_1
	ADD_BLIP_FOR_CHAR injured_ped_1 injured_ped_1_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_1
	RETURN
ENDIF

IF number_of_injured_peds > 1
AND injured_ped_2_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_2
	injured_ped_2_flag = 1
	SET_CHAR_BLEEDING injured_ped_2 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_2 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_2 random_ped_heading
	SET_CHAR_RUNNING injured_ped_2 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_2
	ADD_BLIP_FOR_CHAR injured_ped_2 injured_ped_2_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_2
	RETURN
ENDIF

IF number_of_injured_peds > 2
AND injured_ped_3_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_3
	injured_ped_3_flag = 1
	SET_CHAR_BLEEDING injured_ped_3 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_3 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_3 random_ped_heading
	SET_CHAR_RUNNING injured_ped_3 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_3
	ADD_BLIP_FOR_CHAR injured_ped_3 injured_ped_3_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_3
	RETURN
ENDIF

IF number_of_injured_peds > 3
AND injured_ped_4_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_4
	injured_ped_4_flag = 1
	SET_CHAR_BLEEDING injured_ped_4 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_4 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_4 random_ped_heading
	SET_CHAR_RUNNING injured_ped_4 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_4
	ADD_BLIP_FOR_CHAR injured_ped_4 injured_ped_4_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_4
	RETURN
ENDIF

IF number_of_injured_peds > 4
AND injured_ped_5_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_5
	injured_ped_5_flag = 1
	SET_CHAR_BLEEDING injured_ped_5 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_5 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_5 random_ped_heading
	SET_CHAR_RUNNING injured_ped_5 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_5
	ADD_BLIP_FOR_CHAR injured_ped_5 injured_ped_5_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_5
	RETURN
ENDIF

IF number_of_injured_peds > 5
AND injured_ped_6_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_6
	injured_ped_6_flag = 1
	SET_CHAR_BLEEDING injured_ped_6 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_6 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_6 random_ped_heading
	SET_CHAR_RUNNING injured_ped_6 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_6
	ADD_BLIP_FOR_CHAR injured_ped_6 injured_ped_6_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_6
	RETURN
ENDIF

IF number_of_injured_peds > 6
AND injured_ped_7_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_7
	injured_ped_7_flag = 1
	SET_CHAR_BLEEDING injured_ped_7 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_7 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_7 random_ped_heading
	SET_CHAR_RUNNING injured_ped_7 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_7
	ADD_BLIP_FOR_CHAR injured_ped_7 injured_ped_7_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_7
	RETURN
ENDIF

IF number_of_injured_peds > 7
AND injured_ped_8_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_8
	injured_ped_8_flag = 1
	SET_CHAR_BLEEDING injured_ped_8 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_8 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_8 random_ped_heading
	SET_CHAR_RUNNING injured_ped_8 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_8
	ADD_BLIP_FOR_CHAR injured_ped_8 injured_ped_8_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_8
	RETURN
ENDIF

IF number_of_injured_peds > 8
AND injured_ped_9_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_9
	injured_ped_9_flag = 1
	SET_CHAR_BLEEDING injured_ped_9 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_9 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_9 random_ped_heading
	SET_CHAR_RUNNING injured_ped_9 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_9
	ADD_BLIP_FOR_CHAR injured_ped_9 injured_ped_9_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_9
	RETURN
ENDIF

IF number_of_injured_peds > 9
AND injured_ped_10_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_10
	injured_ped_10_flag = 1
	SET_CHAR_BLEEDING injured_ped_10 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_10 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_10 random_ped_heading
	SET_CHAR_RUNNING injured_ped_10 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_10
	ADD_BLIP_FOR_CHAR injured_ped_10 injured_ped_10_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_10
	RETURN
ENDIF

IF number_of_injured_peds > 10
AND injured_ped_11_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_11
	injured_ped_11_flag = 1
	SET_CHAR_BLEEDING injured_ped_11 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_11 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_11 random_ped_heading
	SET_CHAR_RUNNING injured_ped_11 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_11
	ADD_BLIP_FOR_CHAR injured_ped_11 injured_ped_11_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_11
	RETURN
ENDIF

IF number_of_injured_peds > 11
AND injured_ped_12_flag = 0
	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_12
	injured_ped_12_flag = 1
	SET_CHAR_BLEEDING injured_ped_12 TRUE
	SET_CHAR_ONLY_DAMAGED_BY_PLAYER	injured_ped_12 TRUE
	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
	SET_CHAR_HEADING injured_ped_12 random_ped_heading
	SET_CHAR_RUNNING injured_ped_12 TRUE
	CLEAR_CHAR_THREAT_SEARCH injured_ped_12
	ADD_BLIP_FOR_CHAR injured_ped_12 injured_ped_12_blip
	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_12
	RETURN
ENDIF

//IF number_of_injured_peds > 12
//AND injured_ped_13_flag = 0
//	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_13
//	injured_ped_13_flag = 1
//	SET_CHAR_BLEEDING injured_ped_13 TRUE
//	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
//	SET_CHAR_HEADING injured_ped_13 random_ped_heading
//	SET_CHAR_RUNNING injured_ped_13 TRUE
//	CLEAR_CHAR_THREAT_SEARCH injured_ped_13
//	ADD_BLIP_FOR_CHAR injured_ped_13 injured_ped_13_blip
//	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_13
//	RETURN
//ENDIF
//
//IF number_of_injured_peds > 13
//AND injured_ped_14_flag = 0
//	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_14
//	injured_ped_14_flag = 1
//	SET_CHAR_BLEEDING injured_ped_14 TRUE
//	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
//	SET_CHAR_HEADING injured_ped_14 random_ped_heading
//	SET_CHAR_RUNNING injured_ped_14 TRUE
//	CLEAR_CHAR_THREAT_SEARCH injured_ped_14
//	ADD_BLIP_FOR_CHAR injured_ped_14 injured_ped_14_blip
//	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_14
//	RETURN
//ENDIF
//
//IF number_of_injured_peds > 14
//AND injured_ped_15_flag = 0
//	CREATE_RANDOM_CHAR ped_coord_x ped_coord_y ped_coord_z injured_ped_15
//	injured_ped_15_flag = 1
//	SET_CHAR_BLEEDING injured_ped_15 TRUE
//	GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_ped_heading
//	SET_CHAR_HEADING injured_ped_15 random_ped_heading
//	SET_CHAR_RUNNING injured_ped_15 TRUE
//	CLEAR_CHAR_THREAT_SEARCH injured_ped_15
//	ADD_BLIP_FOR_CHAR injured_ped_15 injured_ped_15_blip
//	SET_CHAR_OBJ_WAIT_ON_FOOT injured_ped_15
//	RETURN
//ENDIF

RETURN

////////////////

generate_random_coord:

WAIT 0

GET_PLAYER_COORDINATES player player1_a_x player1_a_y player1_a_z

IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
	GENERATE_RANDOM_FLOAT_IN_RANGE 778.0 1540.0 random_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1110.0 0.0 random_y
	hospital_x = 1141.5 
	hospital_y = -595.2402
	hospital_z = 13.9
	hospital_door_x = 1149.1873
	hospital_door_y = -597.3521
	flag_got_range_message = 0
	player_in_range_flag = 1
	paramedic_location = 1
ENDIF

IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
	GENERATE_RANDOM_FLOAT_IN_RANGE -192.0 545.0 random_x  
	GENERATE_RANDOM_FLOAT_IN_RANGE -1626.0 98.0 random_y
	hospital_x = 178.5
	hospital_y = -23.6
	hospital_z = 15.2
	hospital_door_x = 182.75
	hospital_door_y = -15.8
	flag_got_range_message = 0
	player_in_range_flag = 1
	paramedic_location = 2
ENDIF

IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	GENERATE_RANDOM_FLOAT_IN_RANGE -1300.0 -414.0 random_x   
	GENERATE_RANDOM_FLOAT_IN_RANGE -608.8 380.0 random_y   
	hospital_x = -1255.5 										  
	hospital_y = -144.4254
	hospital_z = 57.8										  
	hospital_door_x = -1246.7969 									  
	hospital_door_y = -139.1016									  
	flag_got_range_message = 0							  
	player_in_range_flag = 1
	paramedic_location = 3							  
ENDIF

IF player_in_range_flag = 0
AND flag_got_range_message = 0
	IF flag_got_range_message = 0
		PRINT_NOW A_RANGE 5000 1 //"The ambulance radio is out of range, get closer to a hospital."
		flag_got_range_message = 1
	ENDIF
	GOTO ambulance_failed
ENDIF													  

IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
	mission_end_button_ambulance = 1
ENDIF

IF mission_end_button_ambulance = 1
	
	IF NOT IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
		PRINT_NOW A_CANC 3000 1//"~r~Ambulance mission cancelled!"
		GOTO ambulance_failed
	ENDIF
	
ENDIF

IF NOT IS_PLAYER_IN_MODEL player CAR_AMBULANCE
	PRINT_NOW A_CANC 3000 1//"~r~Ambulance mission cancelled!"
	GOTO ambulance_failed
ENDIF

//GET_CLOSEST_CHAR_NODE random_x random_y player1_a_z ped_coord_x ped_coord_y ped_coord_z

// 3master - different approach here, we want to pick a car node, then get the closest ped node. that should alleviate the speed of spawning peds, and possibly spawning down alleyways
VAR_FLOAT amb_node_x amb_node_y amb_node_z
GET_CLOSEST_CAR_NODE random_x random_y player1_a_z amb_node_x amb_node_y amb_node_z
GET_CLOSEST_CHAR_NODE amb_node_x amb_node_y amb_node_z ped_coord_x ped_coord_y ped_coord_z

IF ped_coord_x > 1398.0	 //MIN_X // COLOMBIAN BOAT
AND ped_coord_x	< 1615.0 //MAX_X
AND ped_coord_y	> -965.0 //MIN_Y
AND ped_coord_y	< -902.0 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x > 879.0	 //MIN_X // BACK OF LUIGI'S
AND ped_coord_x	< 892.0  //MAX_X
AND ped_coord_y	> -427.0 //MIN_Y
AND ped_coord_y	< -407.0 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x > 944.8	  //MIN_X // FISH FACTORY
AND ped_coord_x	< 1017.1  //MAX_X
AND ped_coord_y	> -1148.8 //MIN_Y
AND ped_coord_y	< -1076.6 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x > 920.8	 //MIN_X // CHINATOWN MARKET
AND ped_coord_x	< 1004.0 //MAX_X
AND ped_coord_y	> -754.2 //MIN_Y
AND ped_coord_y	< -670.0 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x > 670.0	 //MIN_X // CALAHAN BRIDGE
AND ped_coord_x	< 1035.0 //MAX_X
AND ped_coord_y	> -953.0 //MIN_Y
AND ped_coord_y	< -912.0 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x > 1364.0	  //MIN_X // DOCKS INDUSTRIAL
AND ped_coord_x	< 1641.0  //MAX_X
AND ped_coord_y	> -1165.0 //MIN_Y
AND ped_coord_y	< -617.0  //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x > 649.0	 //MIN_X // TUNNEL ENTRANCE INDUSTRIAL
AND ped_coord_x	< 1066.0 //MAX_X
AND ped_coord_y	> 25.0   //MIN_Y
AND ped_coord_y	< 217.0  //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x 	> -1611.5 //MIN_X // AIRPORT SUBURBAN
AND ped_coord_x	< -745.3  //MAX_X
AND ped_coord_y	> -1001.9 //MIN_Y
AND ped_coord_y	< -371.2  //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x 	> 939.8  //MIN_X // OLD SCHOOL HALL AND PARK AREA
AND ped_coord_x	< 1035.6 //MAX_X
AND ped_coord_y	> -901.3 //MIN_Y
AND ped_coord_y	< -828.2 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x 	> 1215.3 //MIN_X // DOG FOOD FACTORY
AND ped_coord_x	< 1223.7 //MAX_X
AND ped_coord_y	> -839.4 //MIN_Y
AND ped_coord_y	< -763.6 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x 	> 845.3  //MIN_X // INDUSTRIAL SAFEHOUSE
AND ped_coord_x	< 899.6  //MAX_X
AND ped_coord_y	> -312.6 //MIN_Y
AND ped_coord_y	< -295.7 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x 	> 113.3   //MIN_X // DOJO COMMERCIAL
AND ped_coord_x	< 99.7    //MAX_X
AND ped_coord_y	> -1284.8 //MIN_Y
AND ped_coord_y	< -1273.0 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x 	> 18.33   //MIN_X // COLOMBIAN OJG COMPOUND
AND ped_coord_x	< 92.06   //MAX_X
AND ped_coord_y	> -388.7  //MIN_Y
AND ped_coord_y	< -312.38 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x 	> -1255.4 //MIN_X // BAIT WAREHOUSE CARPARK SUBURBIA
AND ped_coord_x	< -1187.9 //MAX_X
AND ped_coord_y	> 80.6    //MIN_Y
AND ped_coord_y	< 123.4   //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x 	> 1386.4 //MIN_X // FRANKIES HOUSE
AND ped_coord_x	< 1475.8 //MAX_X
AND ped_coord_y	> -292.1 //MIN_Y
AND ped_coord_y	< -168.0 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x 	> 766.7  //MIN_X // FOOT BRIDGE CHINATOWN
AND ped_coord_x	< 851.8  //MAX_X
AND ped_coord_y	> -604.1 //MIN_Y
AND ped_coord_y	< -558.2 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF ped_coord_x 	> 400.4  //MIN_X // COVERED WAY STAUTON ISLAND
AND ped_coord_x	< 445.6  //MAX_X
AND ped_coord_y	> -391.9 //MIN_Y
AND ped_coord_y	< -130.1 //MAX_Y
	GOTO generate_random_coord
ENDIF

IF paramedic_location = 1
	IF NOT ped_coord_x 	> 778.0 //MIN_X // INDUSTRIAL
	OR NOT ped_coord_x	< 1540.0 //MAX_X
	OR NOT ped_coord_y	> -1110.0 //MIN_Y
	OR NOT ped_coord_y	< 190.0 //MAX_Y
		GOTO generate_random_coord
	ENDIF
ENDIF

IF paramedic_location = 2
	IF NOT ped_coord_x 	> -192.0 //MIN_X // COMMERCIAL
	OR NOT ped_coord_x	< 545.0 //MAX_X
	OR NOT ped_coord_y	> -1626.0 //MIN_Y
	OR NOT ped_coord_y	< 98.0 //MAX_Y
		GOTO generate_random_coord
	ENDIF
ENDIF

IF paramedic_location = 3
	IF NOT ped_coord_x 	> -1300.0 //MIN_X // SUBURBIA
	OR NOT ped_coord_x	< -414.0 //MAX_X
	OR NOT ped_coord_y	> -608.8 //MIN_Y
	OR NOT ped_coord_y	< 380.0 //MAX_Y
		GOTO generate_random_coord
	ENDIF
ENDIF

IF ped_coord_z < -1.0
	GOTO generate_random_coord
ENDIF

difference_x_float_a = player1_a_x - ped_coord_x
difference_y_float_a = player1_a_y - ped_coord_y
difference_x_float_a = difference_x_float_a * difference_x_float_a
difference_y_float_a = difference_y_float_a * difference_y_float_a
sum_difference_a_xy = difference_x_float_a + difference_y_float_a
SQRT sum_difference_a_xy players_distance_from_ped

IF players_distance_from_ped < 120.0
	GOTO generate_random_coord
ENDIF

difference_x_float_a = hospital_x - ped_coord_x
difference_y_float_a = hospital_y - ped_coord_y
difference_x_float_a = difference_x_float_a * difference_x_float_a
difference_y_float_a = difference_y_float_a * difference_y_float_a
sum_difference_a_xy = difference_x_float_a + difference_y_float_a
SQRT sum_difference_a_xy peds_distance_from_hospital

IF peds_distance_from_hospital < 100.0
	GOTO generate_random_coord
ENDIF

IF injured_ped_1_flag > 0
	IF NOT IS_CHAR_DEAD injured_ped_1
		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_1 ped_coord_x ped_coord_y 25.0 25.0 0
			GOTO generate_random_coord
		ENDIF
	ENDIF
ENDIF

IF injured_ped_2_flag > 0
	IF NOT IS_CHAR_DEAD injured_ped_2
		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_2 ped_coord_x ped_coord_y 25.0 25.0 0
			GOTO generate_random_coord
		ENDIF
	ENDIF
ENDIF

IF injured_ped_3_flag > 0
	IF NOT IS_CHAR_DEAD injured_ped_3
		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_3 ped_coord_x ped_coord_y 25.0 25.0 0
			GOTO generate_random_coord
		ENDIF
	ENDIF
ENDIF

IF injured_ped_4_flag > 0
	IF NOT IS_CHAR_DEAD injured_ped_4
		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_4 ped_coord_x ped_coord_y 25.0 25.0 0
			GOTO generate_random_coord
		ENDIF
	ENDIF
ENDIF

IF injured_ped_5_flag > 0
	IF NOT IS_CHAR_DEAD injured_ped_5
		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_5 ped_coord_x ped_coord_y 25.0 25.0 0
			GOTO generate_random_coord
		ENDIF
	ENDIF
ENDIF

IF injured_ped_6_flag > 0
	IF NOT IS_CHAR_DEAD injured_ped_6
		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_6 ped_coord_x ped_coord_y 25.0 25.0 0
			GOTO generate_random_coord
		ENDIF
	ENDIF
ENDIF

IF injured_ped_7_flag > 0
	IF NOT IS_CHAR_DEAD injured_ped_7
		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_7 ped_coord_x ped_coord_y 25.0 25.0 0
			GOTO generate_random_coord
		ENDIF
	ENDIF
ENDIF

IF injured_ped_8_flag > 0
	IF NOT IS_CHAR_DEAD injured_ped_8
		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_8 ped_coord_x ped_coord_y 25.0 25.0 0
			GOTO generate_random_coord
		ENDIF
	ENDIF
ENDIF

IF injured_ped_9_flag > 0
	IF NOT IS_CHAR_DEAD injured_ped_9
		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_9 ped_coord_x ped_coord_y 25.0 25.0 0
			GOTO generate_random_coord
		ENDIF
	ENDIF
ENDIF

IF injured_ped_10_flag > 0
	IF NOT IS_CHAR_DEAD injured_ped_10
		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_10 ped_coord_x ped_coord_y 25.0 25.0 0
			GOTO generate_random_coord
		ENDIF
	ENDIF
ENDIF

IF injured_ped_11_flag > 0
	IF NOT IS_CHAR_DEAD injured_ped_11
		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_11 ped_coord_x ped_coord_y 25.0 25.0 0
			GOTO generate_random_coord
		ENDIF
	ENDIF
ENDIF

//IF injured_ped_12_flag > 0
//	IF NOT IS_CHAR_DEAD injured_ped_12
//		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_12 ped_coord_x ped_coord_y 25.0 25.0 0
//			GOTO generate_random_coord
//		ENDIF
//	ENDIF
//ENDIF
//
//IF injured_ped_13_flag > 0
//	IF NOT IS_CHAR_DEAD injured_ped_13
//		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_13 ped_coord_x ped_coord_y 25.0 25.0 0
//			GOTO generate_random_coord
//		ENDIF
//	ENDIF
//ENDIF
//
//IF injured_ped_14_flag > 0
//	IF NOT IS_CHAR_DEAD injured_ped_14
//		IF LOCATE_CHAR_ANY_MEANS_2D injured_ped_14 ped_coord_x ped_coord_y 25.0 25.0 0
//			GOTO generate_random_coord
//		ENDIF
//	ENDIF
//ENDIF

// increase a bit, peds can get stuck in the ground
ped_coord_z += 1.0

RETURN

////////////////

generate_timelimit:

IF paramedic_location = 3
	time_chunk_divider = 10.0
ENDIF

ped_time_limit_float = peds_distance_from_hospital / time_chunk_divider
ped_time_limit_float = ped_time_limit_float * 1000.0
ped_time_limit_temp =# ped_time_limit_float
ped_time_limit += ped_time_limit_temp

RETURN

///////////////

ambulance_loop:

WAIT 0

IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
	mission_end_button_ambulance = 1
ENDIF

IF mission_end_button_ambulance = 1
	
	IF NOT IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
		PRINT_NOW A_CANC 3000 1//"~r~Ambulance mission cancelled!"
		GOTO ambulance_failed
	ENDIF
	
ENDIF

IF NOT IS_PLAYER_IN_MODEL player CAR_AMBULANCE
	PRINT_NOW A_CANC 3000 1//"~r~Ambulance mission cancelled!"
	GOTO ambulance_failed
ELSE
	STORE_CAR_PLAYER_IS_IN player players_ambulance

	GET_NUMBER_OF_PASSENGERS players_ambulance peds_in_car
ENDIF

IF number_of_injured_peds > 6
AND	bonus_time_flag = 2
AND drop_off_time_bonus = 0
	bonus_time_flag = 1
	++ drop_off_time_bonus
ENDIF

IF number_of_injured_peds > 9
AND	bonus_time_flag = 2
AND drop_off_time_bonus = 1
	bonus_time_flag = 1
	++ drop_off_time_bonus
ENDIF

IF number_of_injured_peds > 12
AND	bonus_time_flag = 2
AND drop_off_time_bonus = 2
	bonus_time_flag = 1
	++ drop_off_time_bonus
ENDIF

IF ambulance_pager_flag = 0
	IF total_saved_peds > 35
		ADD_PAGER_MESSAGE PAGEB13 140 100 1	//"Health delivered to hideout"
		GOSUB progress_counter1
		ambulance_pager_flag = 1
	ENDIF
ENDIF
IF ambulance_pager_flag = 1
	IF total_saved_peds > 74 // Set to legacy value
		ADD_PAGER_MESSAGE PAGEB14 140 100 1	//"Adrenaline delivered to hideout"
		GOSUB progress_counter2
		ambulance_pager_flag = 2
	ENDIF
ENDIF

IF injured_ped_1_flag > 0
	IF IS_CHAR_DEAD injured_ped_1
		PRINT_NOW A_FAIL3 3000 1//The patient is dead
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_1
		REMOVE_CHAR_ELEGANTLY injured_ped_1
		PRINT_NOW A_FAIL2 3000 1//"Your too late"
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_1_flag = 3
		IF IS_CHAR_MALE injured_ped_1
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_1 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_1_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_1 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_1 players_ambulance
				injured_ped_1_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_1_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_1 25.0 25.0 0
			injured_ped_1_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_1_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_1 
			REMOVE_BLIP injured_ped_1_blip
			GOSUB chunk3_ambulance
			injured_ped_1_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_1_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_1 players_ambulance
			injured_ped_1_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_1_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_1	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_1 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_1
			GOSUB chunk4_ambulance
			injured_ped_1_flag = 0
		ENDIF
	ENDIF
ENDIF

/////////////////

IF injured_ped_2_flag > 0
	IF IS_CHAR_DEAD injured_ped_2
		PRINT_NOW A_FAIL3 3000 1
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_2
		REMOVE_CHAR_ELEGANTLY injured_ped_2
		PRINT_NOW A_FAIL2 3000 1
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_2_flag = 3
		IF IS_CHAR_MALE injured_ped_2
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_2 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_2_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_2 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_2 players_ambulance
				injured_ped_2_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_2_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_2 25.0 25.0 0
			injured_ped_2_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_2_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_2 
			REMOVE_BLIP injured_ped_2_blip
			GOSUB chunk3_ambulance
			injured_ped_2_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_2_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_2 players_ambulance
			injured_ped_2_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_2_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_2	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_2 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_2
			GOSUB chunk4_ambulance
			injured_ped_2_flag = 0
		ENDIF
	ENDIF
ENDIF

//////////////////

IF injured_ped_3_flag > 0
	IF IS_CHAR_DEAD injured_ped_3
		PRINT_NOW A_FAIL3 3000 1
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_3
		REMOVE_CHAR_ELEGANTLY injured_ped_3
		PRINT_NOW A_FAIL2 3000 1
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_3_flag = 3
		IF IS_CHAR_MALE injured_ped_3
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_3 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_3_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_3 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_3 players_ambulance
				injured_ped_3_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_3_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_3 25.0 25.0 0
			injured_ped_3_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_3_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_3 
			REMOVE_BLIP injured_ped_3_blip
			GOSUB chunk3_ambulance
			injured_ped_3_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_3_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_3 players_ambulance
			injured_ped_3_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_3_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_3	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_3 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_3
			GOSUB chunk4_ambulance
			injured_ped_3_flag = 0
		ENDIF
	ENDIF
ENDIF

////////////////

IF injured_ped_4_flag > 0
	IF IS_CHAR_DEAD injured_ped_4
		PRINT_NOW A_FAIL3 3000 1
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_4
		REMOVE_CHAR_ELEGANTLY injured_ped_4
		PRINT_NOW A_FAIL2 3000 1
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_4_flag = 3
		IF IS_CHAR_MALE injured_ped_4
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_4 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_4_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_4 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_4 players_ambulance
				injured_ped_4_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_4_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_4 25.0 25.0 0
			injured_ped_4_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_4_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_4 
			REMOVE_BLIP injured_ped_4_blip
			GOSUB chunk3_ambulance
			injured_ped_4_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_4_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_4 players_ambulance
			injured_ped_4_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_4_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_4	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_4 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_4
			GOSUB chunk4_ambulance
			injured_ped_4_flag = 0
		ENDIF
	ENDIF
ENDIF

////////////////

IF injured_ped_5_flag > 0
	IF IS_CHAR_DEAD injured_ped_5
		PRINT_NOW A_FAIL3 3000 1
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_5
		REMOVE_CHAR_ELEGANTLY injured_ped_5
		PRINT_NOW A_FAIL2 3000 1
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_5_flag = 3
		IF IS_CHAR_MALE injured_ped_5
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_5 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_5_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_5 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_5 players_ambulance
				injured_ped_5_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_5_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_5 25.0 25.0 0
			injured_ped_5_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_5_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_5 
			REMOVE_BLIP injured_ped_5_blip
			GOSUB chunk3_ambulance
			injured_ped_5_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_5_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_5 players_ambulance
			injured_ped_5_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_5_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_5	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_5 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_5
			GOSUB chunk4_ambulance
			injured_ped_5_flag = 0
		ENDIF
	ENDIF
ENDIF

////////////////

IF injured_ped_6_flag > 0
	IF IS_CHAR_DEAD injured_ped_6
		PRINT_NOW A_FAIL3 3000 1
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_6
		REMOVE_CHAR_ELEGANTLY injured_ped_6
		PRINT_NOW A_FAIL2 3000 1
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_6_flag = 3
		IF IS_CHAR_MALE injured_ped_6
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_6 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_6_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_6 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_6 players_ambulance
				injured_ped_6_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_6_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_6 25.0 25.0 0
			injured_ped_6_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_6_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_6 
			REMOVE_BLIP injured_ped_6_blip
			GOSUB chunk3_ambulance
			injured_ped_6_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_6_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_6 players_ambulance
			injured_ped_6_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_6_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_6	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_6 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_6
			GOSUB chunk4_ambulance
			injured_ped_6_flag = 0
		ENDIF
	ENDIF
ENDIF

////////////////

IF injured_ped_7_flag > 0
	IF IS_CHAR_DEAD injured_ped_7
		PRINT_NOW A_FAIL3 3000 1
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_7
		REMOVE_CHAR_ELEGANTLY injured_ped_7
		PRINT_NOW A_FAIL2 3000 1
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_7_flag = 3
		IF IS_CHAR_MALE injured_ped_7
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_7 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_7_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_7 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_7 players_ambulance
				injured_ped_7_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_7_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_7 25.0 25.0 0
			injured_ped_7_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_7_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_7 
			REMOVE_BLIP injured_ped_7_blip
			GOSUB chunk3_ambulance
			injured_ped_7_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_7_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_7 players_ambulance
			injured_ped_7_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_7_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_7	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_7 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_7
			GOSUB chunk4_ambulance
			injured_ped_7_flag = 0
		ENDIF
	ENDIF
ENDIF

////////////////

IF injured_ped_8_flag > 0
	IF IS_CHAR_DEAD injured_ped_8
		PRINT_NOW A_FAIL3 3000 1
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_8
		REMOVE_CHAR_ELEGANTLY injured_ped_8
		PRINT_NOW A_FAIL2 3000 1
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_8_flag = 3
		IF IS_CHAR_MALE injured_ped_8
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_8 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_8_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_8 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_8 players_ambulance
				injured_ped_8_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_8_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_8 25.0 25.0 0
			injured_ped_8_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_8_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_8 
			REMOVE_BLIP injured_ped_8_blip
			GOSUB chunk3_ambulance
			injured_ped_8_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_8_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_8 players_ambulance
			injured_ped_8_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_8_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_8	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_8 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_8
			GOSUB chunk4_ambulance
			injured_ped_8_flag = 0
		ENDIF
	ENDIF
ENDIF

////////////////

IF injured_ped_9_flag > 0
	IF IS_CHAR_DEAD injured_ped_9
		PRINT_NOW A_FAIL3 3000 1
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_9
		REMOVE_CHAR_ELEGANTLY injured_ped_9
		PRINT_NOW A_FAIL2 3000 1
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_9_flag = 3
		IF IS_CHAR_MALE injured_ped_9
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_9 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_9_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_9 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_9 players_ambulance
				injured_ped_9_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_9_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_9 25.0 25.0 0
			injured_ped_9_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_9_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_9 
			REMOVE_BLIP injured_ped_9_blip
			GOSUB chunk3_ambulance
			injured_ped_9_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_9_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_9 players_ambulance
			injured_ped_9_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_9_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_9	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_9 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_9
			GOSUB chunk4_ambulance
			injured_ped_9_flag = 0
		ENDIF
	ENDIF
ENDIF

////////////////

IF injured_ped_10_flag > 0
	IF IS_CHAR_DEAD injured_ped_10
		PRINT_NOW A_FAIL3 3000 1
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_10
		REMOVE_CHAR_ELEGANTLY injured_ped_10
		PRINT_NOW A_FAIL2 3000 1
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_10_flag = 3
		IF IS_CHAR_MALE injured_ped_10
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_10 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_10_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_10 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_10 players_ambulance
				injured_ped_10_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_10_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_10 25.0 25.0 0
			injured_ped_10_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_10_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_10 
			REMOVE_BLIP injured_ped_10_blip
			GOSUB chunk3_ambulance
			injured_ped_10_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_10_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_10 players_ambulance
			injured_ped_10_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_10_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_10	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_10 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_10
			GOSUB chunk4_ambulance
			injured_ped_10_flag = 0
		ENDIF
	ENDIF
ENDIF

////////////////

IF injured_ped_11_flag > 0
	IF IS_CHAR_DEAD injured_ped_11
		PRINT_NOW A_FAIL3 3000 1
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_11
		REMOVE_CHAR_ELEGANTLY injured_ped_11
		PRINT_NOW A_FAIL2 3000 1
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_11_flag = 3
		IF IS_CHAR_MALE injured_ped_11
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_11 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_11_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_11 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_11 players_ambulance
				injured_ped_11_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_11_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_11 25.0 25.0 0
			injured_ped_11_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_11_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_11 
			REMOVE_BLIP injured_ped_11_blip
			GOSUB chunk3_ambulance
			injured_ped_11_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_11_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_11 players_ambulance
			injured_ped_11_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_11_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_11	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_11 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_11
			GOSUB chunk4_ambulance
			injured_ped_11_flag = 0
		ENDIF
	ENDIF
ENDIF

////////////////

IF injured_ped_12_flag > 0
	IF IS_CHAR_DEAD injured_ped_12
		PRINT_NOW A_FAIL3 3000 1
		GOTO ambulance_failed
	ENDIF
		
	IF ped_time_limit = 0
		EXPLODE_CHAR_HEAD injured_ped_12
		REMOVE_CHAR_ELEGANTLY injured_ped_12
		PRINT_NOW A_FAIL2 3000 1
		GOTO ambulance_failed
	ENDIF

	IF injured_ped_12_flag = 3
		IF IS_CHAR_MALE injured_ped_12
			ped_sex_flag = 0
		ELSE
			ped_sex_flag = 1
		ENDIF
		GET_CHAR_COORDINATES injured_ped_12 sound_x sound_y sound_z
		GOSUB chunk1_ambulance
	ENDIF

	IF injured_ped_12_flag = 1
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_12 10.0 10.0 2.0 0
			GOSUB chunk2_ambulance
			IF car_full_flag = 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_12 players_ambulance
				injured_ped_12_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF injured_ped_12_flag = 2
		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_12 25.0 25.0 0
			injured_ped_12_flag = 1
		ENDIF
	ENDIF	

	IF injured_ped_12_flag = 2
		IF IS_CHAR_IN_ANY_CAR injured_ped_12 
			REMOVE_BLIP injured_ped_12_blip
			GOSUB chunk3_ambulance
			injured_ped_12_flag = 3
		ENDIF
	ENDIF

	IF injured_ped_12_flag = 3
		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
			SET_CHAR_OBJ_LEAVE_CAR injured_ped_12 players_ambulance
			injured_ped_12_flag = 4
		ENDIF	
	ENDIF

	IF injured_ped_12_flag = 4
		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_12	
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_12 hospital_door_x hospital_door_y
			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_12
			GOSUB chunk4_ambulance
			injured_ped_12_flag = 0
		ENDIF
	ENDIF
ENDIF

////////////////

//IF injured_ped_13_flag > 0
//	IF IS_CHAR_DEAD injured_ped_13
//		PRINT_NOW A_FAIL3 3000 1
//		GOTO ambulance_failed
//	ENDIF
//		
//	IF ped_time_limit = 0
//		EXPLODE_CHAR_HEAD injured_ped_13
//		REMOVE_CHAR_ELEGANTLY injured_ped_13
//		PRINT_NOW A_FAIL2 3000 1
//		GOTO ambulance_failed
//	ENDIF
//
//	IF injured_ped_13_flag = 3
//		IF IS_CHAR_MALE injured_ped_13
//			ped_sex_flag = 0
//		ELSE
//			ped_sex_flag = 1
//		ENDIF
//		GET_CHAR_COORDINATES injured_ped_13 sound_x sound_y sound_z
//		GOSUB chunk1_ambulance
//	ENDIF
//
//	IF injured_ped_13_flag = 1
//		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_13 10.0 10.0 2.0 0
//			GOSUB chunk2_ambulance
//			IF car_full_flag = 0
//				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_13 players_ambulance
//				injured_ped_13_flag = 2
//			ENDIF
//		ENDIF
//	ENDIF
//
//	IF injured_ped_13_flag = 2
//		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_13 25.0 25.0 0
//			injured_ped_13_flag = 1
//		ENDIF
//	ENDIF	
//
//	IF injured_ped_13_flag = 2
//		IF IS_CHAR_IN_ANY_CAR injured_ped_13 
//			REMOVE_BLIP injured_ped_13_blip
//			GOSUB chunk3_ambulance
//			injured_ped_13_flag = 3
//		ENDIF
//	ENDIF
//
//	IF injured_ped_13_flag = 3
//		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
//			SET_CHAR_OBJ_LEAVE_CAR injured_ped_13 players_ambulance
//			injured_ped_13_flag = 4
//		ENDIF	
//	ENDIF
//
//	IF injured_ped_13_flag = 4
//		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_13	
//			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_13 hospital_door_x hospital_door_y
//			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_13
//			GOSUB chunk4_ambulance
//			injured_ped_13_flag = 0
//		ENDIF
//	ENDIF
//ENDIF

////////////////

//IF injured_ped_14_flag > 0
//	IF IS_CHAR_DEAD injured_ped_14
//		PRINT_NOW A_FAIL3 3000 1
//		GOTO ambulance_failed
//	ENDIF
//		
//	IF ped_time_limit = 0
//		EXPLODE_CHAR_HEAD injured_ped_14
//		REMOVE_CHAR_ELEGANTLY injured_ped_14
//		PRINT_NOW A_FAIL2 3000 1
//		GOTO ambulance_failed
//	ENDIF
//
//	IF injured_ped_14_flag = 3
//		IF IS_CHAR_MALE injured_ped_14
//			ped_sex_flag = 0
//		ELSE
//			ped_sex_flag = 1
//		ENDIF
//		GET_CHAR_COORDINATES injured_ped_14 sound_x sound_y sound_z
//		GOSUB chunk1_ambulance
//	ENDIF
//
//	IF injured_ped_14_flag = 1
//		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_14 10.0 10.0 2.0 0
//			GOSUB chunk2_ambulance
//			IF car_full_flag = 0
//				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_14 players_ambulance
//				injured_ped_14_flag = 2
//			ENDIF
//		ENDIF
//	ENDIF
//
//	IF injured_ped_14_flag = 2
//		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_14 25.0 25.0 0
//			injured_ped_14_flag = 1
//		ENDIF
//	ENDIF	
//
//	IF injured_ped_14_flag = 2
//		IF IS_CHAR_IN_ANY_CAR injured_ped_14 
//			REMOVE_BLIP injured_ped_14_blip
//			GOSUB chunk3_ambulance
//			injured_ped_14_flag = 3
//		ENDIF
//	ENDIF
//
//	IF injured_ped_14_flag = 3
//		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
//			SET_CHAR_OBJ_LEAVE_CAR injured_ped_14 players_ambulance
//			injured_ped_14_flag = 4
//		ENDIF	
//	ENDIF
//
//	IF injured_ped_14_flag = 4
//		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_14	
//			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_14 hospital_door_x hospital_door_y
//			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_14
//			GOSUB chunk4_ambulance
//			injured_ped_14_flag = 0
//		ENDIF
//	ENDIF
//ENDIF

////////////////

//IF injured_ped_15_flag > 0
//	IF IS_CHAR_DEAD injured_ped_15
//		PRINT_NOW A_FAIL3 3000 1
//		GOTO ambulance_failed
//	ENDIF
//		
//	IF ped_time_limit = 0
//		EXPLODE_CHAR_HEAD injured_ped_15
//		REMOVE_CHAR_ELEGANTLY injured_ped_15
//		PRINT_NOW A_FAIL2 3000 1
//		GOTO ambulance_failed
//	ENDIF
//
//	IF injured_ped_15_flag = 3
//		IF IS_CHAR_MALE injured_ped_15
//			ped_sex_flag = 0
//		ELSE
//			ped_sex_flag = 1
//		ENDIF
//		GET_CHAR_COORDINATES injured_ped_15 sound_x sound_y sound_z
//		GOSUB chunk1_ambulance
//	ENDIF
//
//	IF injured_ped_15_flag = 1
//		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player injured_ped_15 10.0 10.0 2.0 0
//			GOSUB chunk2_ambulance
//			IF car_full_flag = 0
//				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER injured_ped_15 players_ambulance
//				injured_ped_15_flag = 2
//			ENDIF
//		ENDIF
//	ENDIF
//
//	IF injured_ped_15_flag = 2
//		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player injured_ped_15 25.0 25.0 0
//			injured_ped_15_flag = 1
//		ENDIF
//	ENDIF	
//
//	IF injured_ped_15_flag = 2
//		IF IS_CHAR_IN_ANY_CAR injured_ped_15 
//			REMOVE_BLIP injured_ped_15_blip
//			GOSUB chunk3_ambulance
//			injured_ped_15_flag = 3
//		ENDIF
//	ENDIF
//
//	IF injured_ped_15_flag = 3
//		IF LOCATE_STOPPED_PLAYER_IN_CAR_3D player hospital_x hospital_y hospital_z 6.0 6.0 2.0 1
//			SET_CHAR_OBJ_LEAVE_CAR injured_ped_15 players_ambulance
//			injured_ped_15_flag = 4
//		ENDIF	
//	ENDIF
//
//	IF injured_ped_15_flag = 4
//		IF NOT IS_CHAR_IN_ANY_CAR injured_ped_15	
//			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT injured_ped_15 hospital_door_x hospital_door_y
//			MARK_CHAR_AS_NO_LONGER_NEEDED injured_ped_15
//			GOSUB chunk4_ambulance
//			injured_ped_15_flag = 0
//		ENDIF
//	ENDIF
//ENDIF

/////////////////

IF saved_peds = number_of_injured_peds
	score_am = saved_peds * ambulance_level
	score_am *= 100
	PRINT_WITH_NUMBER_BIG REWARD score_am 6000 6
	//total_saved_peds += saved_peds
	IF ambulance_pager_flag = 0
		IF total_saved_peds > 35
			ADD_PAGER_MESSAGE PAGEB13 140 100 1	//"Health delivered to hideout"
			GOSUB progress_counter1
			ambulance_pager_flag = 1
		ENDIF
	ENDIF
	IF ambulance_pager_flag = 1
		IF total_saved_peds > 74
			ADD_PAGER_MESSAGE PAGEB14 140 100 1	//"Adrenaline delivered to hideout"
			GOSUB progress_counter2
			ambulance_pager_flag = 2
		ENDIF
	ENDIF
	saved_peds_this_go += saved_peds
	++ number_of_injured_peds
	saved_peds = 0
	ped_counter = 0
	ADD_SCORE player score_am
	hospital_blip_flag = 0
	REMOVE_BLIP hospital_blip
	REMOVE_BLIP injured_ped_1_blip
	REMOVE_BLIP injured_ped_2_blip
	REMOVE_BLIP injured_ped_3_blip
	REMOVE_BLIP injured_ped_4_blip
	REMOVE_BLIP injured_ped_5_blip
	REMOVE_BLIP injured_ped_6_blip
	REMOVE_BLIP injured_ped_7_blip
	REMOVE_BLIP injured_ped_8_blip
	REMOVE_BLIP injured_ped_9_blip
	REMOVE_BLIP injured_ped_10_blip
	REMOVE_BLIP injured_ped_11_blip
	REMOVE_BLIP injured_ped_12_blip
//	REMOVE_BLIP injured_ped_13_blip
//	REMOVE_BLIP injured_ped_14_blip
//	REMOVE_BLIP injured_ped_15_blip
	REGISTER_AMBULANCE_LEVEL ambulance_level
	++ ambulance_level
	IF ambulance_level = 13
		PRINT_BIG A_COMP1 5000 5 //"Ambulance missions complete!"
		PRINT_BIG A_COMP2 6000 6 //"You will never get tired!"
		ADD_PAGER_MESSAGE A_COMP3 140 100 1	//"Ambulance missions complete! You will never get tired when running!"
		PLAY_MISSION_PASSED_TUNE 1
		SET_PLAYER_NEVER_GETS_TIRED player TRUE
		PLAYER_MADE_PROGRESS 1
		RETURN
	ENDIF
	GOTO mission_root
ENDIF

GOTO ambulance_loop


ambulance_failed:

DISPLAY_RADAR 3 // PATHING ON

CLEAR_ONSCREEN_TIMER ped_time_limit
CLEAR_HELP
IF NOT ambulance_level = 13    //Don't print "fail" text when completing the ambulance oddjob
	PRINT_BIG A_FAIL1 5000 5
ENDIF
PRINT_WITH_NUMBER_BIG A_SAVES saved_peds_this_go 6000 6//PEOPLE SAVED: ~1~

hospital_blip_flag = 0
REMOVE_BLIP hospital_blip
REMOVE_BLIP injured_ped_1_blip
REMOVE_BLIP injured_ped_2_blip
REMOVE_BLIP injured_ped_3_blip
REMOVE_BLIP injured_ped_4_blip
REMOVE_BLIP injured_ped_5_blip
REMOVE_BLIP injured_ped_6_blip
REMOVE_BLIP injured_ped_7_blip
REMOVE_BLIP injured_ped_8_blip
REMOVE_BLIP injured_ped_9_blip
REMOVE_BLIP injured_ped_10_blip
REMOVE_BLIP injured_ped_11_blip
REMOVE_BLIP injured_ped_12_blip
//REMOVE_BLIP injured_ped_13_blip
//REMOVE_BLIP injured_ped_14_blip
//REMOVE_BLIP injured_ped_15_blip

SET_WANTED_MULTIPLIER 1.0

flag_player_on_mission = 0
flag_player_on_ambulance_mission = 0
MISSION_HAS_FINISHED
RETURN



//////////////////////////////////////////////////////////////////////
chunk1_ambulance:
	   		
GET_CAR_HEALTH players_ambulance ambulance_health_now
IF ambulance_health_now < ambulance_health_last
	time_drop = ambulance_health_last - ambulance_health_now
	time_drop = time_drop * 50
	ped_time_limit = ped_time_limit - time_drop
	GENERATE_RANDOM_INT_IN_RANGE 0 2 random_scream
	IF ped_sex_flag = 0
		IF random_scream = 0
			ADD_ONE_OFF_SOUND sound_x sound_y sound_z SOUND_INJURED_PED_MALE_OUCH_S
		ELSE
			ADD_ONE_OFF_SOUND sound_x sound_y sound_z SOUND_INJURED_PED_MALE_OUCH_L
		ENDIF
	ELSE
		IF random_scream = 0
			ADD_ONE_OFF_SOUND sound_x sound_y sound_z SOUND_INJURED_PED_FEMALE_OUCH_S
		ELSE
			ADD_ONE_OFF_SOUND sound_x sound_y sound_z SOUND_INJURED_PED_FEMALE_OUCH_L
		ENDIF
	ENDIF
	IF ped_time_limit < 0
		ped_time_limit = 0
	ENDIF		
	ambulance_health_last = ambulance_health_now
ENDIF

RETURN
//////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////
chunk2_ambulance:

GET_NUMBER_OF_PASSENGERS players_ambulance peds_in_car
GET_MAXIMUM_NUMBER_OF_PASSENGERS players_ambulance max_peds_in_car

IF peds_in_car = max_peds_in_car
	PRINT_NOW A_FULL 5000 1 //"I'm not getting in there, its full of injured people."
	car_full_flag = 1
ELSE
	car_full_flag = 0
ENDIF

GET_CAR_HEALTH players_ambulance ambulance_health_last

RETURN
//////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////
chunk3_ambulance:

IF hospital_blip_flag = 0
	// only route to the hospital when the amb is full or all the peds in the level are picked up
	GET_NUMBER_OF_PASSENGERS players_ambulance peds_in_car
	GET_MAXIMUM_NUMBER_OF_PASSENGERS players_ambulance max_peds_in_car
	amb_calc_inj = saved_peds + peds_in_car

	IF peds_in_car >= max_peds_in_car
	OR number_of_injured_peds = amb_calc_inj
		ADD_BLIP_FOR_COORD hospital_x hospital_y hospital_z hospital_blip
		hospital_blip_flag = 1
	ENDIF
ENDIF

time_chunk_in_secs = time_chunk / 1000
PRINT_WITH_NUMBER_BIG A_TIME time_chunk_in_secs 6000 6	//+~1~ Seconds
ped_time_limit += time_chunk

RETURN	
//////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////
chunk4_ambulance:

PRINT_BIG A_PASS 3000 5
IF bonus_time_flag = 1
	time_chunk_in_secs = time_chunk / 1000
	PRINT_WITH_NUMBER_BIG A_TIME time_chunk_in_secs 6000 6	//+~1~ Seconds
	STORE_CAR_PLAYER_IS_IN player players_ambulance
	GET_CAR_HEALTH players_ambulance players_ambulance_health
	players_ambulance_health += 110
	SET_CAR_HEALTH players_ambulance players_ambulance_health
	ped_time_limit += time_chunk
	++ bonus_time_flag
ENDIF
ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_PART_MISSION_COMPLETE
++ saved_peds
++ total_saved_peds
REGISTER_LIFE_SAVED

REMOVE_BLIP hospital_blip
hospital_blip_flag = 0

RETURN
//////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////
progress_counter1:
	PLAYER_MADE_PROGRESS 1
RETURN
//////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////
progress_counter2:
	PLAYER_MADE_PROGRESS 1
RETURN
//////////////////////////////////////////////////////////////////////

MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *************************************** Fire missions *********************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_fire

GOSUB failed

MISSION_END
 
// Variables for mission

VAR_INT	fire_time_limit	fire_to_extinguish fire_to_extinguish_blip car_on_fire random_car_model	fires_extinguished
VAR_INT car_on_fire_created	player_in_range_fire flag_got_range_mssg intermediate_int score_ft displayed_timer 
VAR_INT total_score displayed_counter first_fire_flag mission_end_button_ft	fire_location dummy_ped_for_zone
VAR_INT players_firetruck players_firetruck_health car_on_fire_health 

VAR_FLOAT random_fire_x random_fire_y time_divider time_divider_divider
VAR_FLOAT player1_x	player1_y player1_z
VAR_FLOAT fire_coord_x fire_coord_y	fire_coord_z
VAR_FLOAT fire_diff_x fire_diff_y fire_diff_z
VAR_FLOAT current_fire_coord_x current_fire_coord_y current_fire_coord_z
VAR_FLOAT difference_x_float difference_y_float	sum_difference_xy
VAR_FLOAT players_distance_from_fire fire_time_limit_float random_car_heading


// ****************************************Mission Start************************************

mission_start_fire:

flag_player_on_mission = 1
flag_player_on_fire_mission = 1

SCRIPT_NAME firetru

WAIT 0

fire_time_limit			= 0
fire_to_extinguish  	= 0
fire_to_extinguish_blip = 0
car_on_fire 			= 0
random_car_model 		= 0
car_on_fire_created		= 0
player_in_range_fire 	= 0
flag_got_range_mssg		= 0
score_ft				= 250
displayed_timer			= 0
fires_extinguished		= 0
displayed_counter		= 0
total_score				= 0
first_fire_flag			= 0
mission_end_button_ft	= 0
fire_location			= 0
time_divider_divider	= 2.0


next_fire:

// 3master - ALL VIGILANTE MISSIONS SHOULD HAVE NO PATHING
// new new design! oddjobs with one target should still have pathing
//DISPLAY_RADAR 2 // PATHING OFF /////////////////////////
//////////////////////////////////////////////////////////

// the radar will path all over the place if we dont stop it at the road
DISPLAY_RADAR 4 // HACKED RADAR STOP AT ROAD

WAIT 0

SET_WANTED_MULTIPLIER 0.5

GET_PLAYER_COORDINATES player player1_x player1_y player1_z

IF NOT IS_PLAYER_IN_MODEL player CAR_FIRETRUCK
	PRINT_NOW F_CANC 3000 1//"Fire truck mission cancelled!"
	GOTO failed
ENDIF

IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
	mission_end_button_ft = 1
ENDIF

IF mission_end_button_ft = 1
	
	IF NOT IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
		PRINT_NOW F_CANC 3000 1//"Fire truck mission cancelled!"
		GOTO failed
	ENDIF
	
ENDIF

//IF IS_PLAYER_IN_AREA_2D player 778.0 -1110.0 1540.0 190.0 0	 //INDUSTRIAL
IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
	GENERATE_RANDOM_FLOAT_IN_RANGE 778.0 1540.0 random_fire_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1110.0 190.0 random_fire_y
	flag_got_range_mssg = 0
	player_in_range_fire = 1
	fire_location = 1
	time_divider = 13.0
ENDIF

//IF IS_PLAYER_IN_AREA_2D player -192.0 -1626.0 545.0 98.0 0  //COMMERCIAL
IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
	GENERATE_RANDOM_FLOAT_IN_RANGE -192.0 545.0 random_fire_x  
	GENERATE_RANDOM_FLOAT_IN_RANGE -1626.0 98.0 random_fire_y
	flag_got_range_mssg = 0
	player_in_range_fire = 1
	fire_location = 2
	time_divider = 14.0
ENDIF

//IF IS_PLAYER_IN_AREA_2D player -1300.0 -608.8 -265.0 380.0 0  //SUBURBIA
IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	GENERATE_RANDOM_FLOAT_IN_RANGE -1300.0 -414.0 random_fire_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -608.8 380.0 random_fire_y
	flag_got_range_mssg = 0
	player_in_range_fire = 1
	fire_location = 3
	time_divider = 11.0
ENDIF

IF player_in_range_fire = 0
AND flag_got_range_mssg = 0
	IF flag_got_range_mssg = 0
		PRINT_NOW F_RANGE 5000 1 //"The radio is out of range, get closer."
		flag_got_range_mssg = 1
	ENDIF
	GOTO failed
ENDIF													  

GET_CLOSEST_CAR_NODE random_fire_x random_fire_y player1_z fire_coord_x fire_coord_y fire_coord_z

IF fire_coord_x 	> 670.0	 //MIN_X // CALAHAN BRIDGE
AND fire_coord_x	< 1035.0 //MAX_X
AND fire_coord_y	> -953.0 //MIN_Y
AND fire_coord_y	< -912.0 //MAX_Y
	GOTO next_fire
ENDIF

IF fire_coord_x 	> 649.0	 //MIN_X // TUNNEL ENTRANCE INDUSTRIAL
AND fire_coord_x	< 1066.0 //MAX_X
AND fire_coord_y	> 25.0   //MIN_Y
AND fire_coord_y	< 217.0  //MAX_Y
	GOTO next_fire
ENDIF

IF fire_coord_x 	> -1611.5 //MIN_X // AIRPORT SUBURBAN
AND fire_coord_x	< -745.3  //MAX_X
AND fire_coord_y	> -1001.9 //MIN_Y
AND fire_coord_y	< -371.2  //MAX_Y
	GOTO next_fire
ENDIF

IF fire_coord_x 	> -1255.4 //MIN_X // BAIT WAREHOUSE CARPARK SUBURBIA
AND fire_coord_x	< -1187.9 //MAX_X
AND fire_coord_y	> 80.6    //MIN_Y
AND fire_coord_y	< 123.4   //MAX_Y
	GOTO next_fire
ENDIF

IF fire_coord_x 	> 1386.4 //MIN_X // FRANKIES HOUSE
AND fire_coord_x	< 1475.8 //MAX_X
AND fire_coord_y	> -292.1 //MIN_Y
AND fire_coord_y	< -168.0 //MAX_Y
	GOTO next_fire
ENDIF

IF fire_location = 1
	IF NOT fire_coord_x > 778.0 //MIN_X // INDUSTRIAL
	OR NOT fire_coord_x	< 1540.0 //MAX_X
	OR NOT fire_coord_y	> -1110.0 //MIN_Y
	OR NOT fire_coord_y	< 190.0 //MAX_Y
		GOTO next_fire
	ENDIF
ENDIF

IF fire_location = 2
	IF NOT fire_coord_x > -192.0 //MIN_X // COMMERCIAL
	OR NOT fire_coord_x	< 545.0 //MAX_X
	OR NOT fire_coord_y	> -1626.0 //MIN_Y
	OR NOT fire_coord_y	< 98.0 //MAX_Y
		GOTO next_fire
	ENDIF
ENDIF

IF fire_location = 3
	IF NOT fire_coord_x > -1300.0 //MIN_X // SUBURBIA
	OR NOT fire_coord_x	< -414.0 //MAX_X
	OR NOT fire_coord_y	> -608.8 //MIN_Y
	OR NOT fire_coord_y	< 380.0 //MAX_Y
		GOTO next_fire
	ENDIF
ENDIF

IF fire_coord_z < -1.0
	GOTO next_fire
ENDIF

difference_x_float = player1_x - fire_coord_x
difference_y_float = player1_y - fire_coord_y
difference_x_float = difference_x_float * difference_x_float
difference_y_float = difference_y_float * difference_y_float
sum_difference_xy = difference_x_float + difference_y_float
SQRT sum_difference_xy players_distance_from_fire

IF players_distance_from_fire < 200.0
	GOTO next_fire
ENDIF

fire_time_limit_float = players_distance_from_fire / time_divider

time_divider += time_divider_divider
time_divider_divider += 2.0

fire_time_limit_float = fire_time_limit_float * 1000.0
intermediate_int =#	fire_time_limit_float
fire_time_limit += intermediate_int

IF fires_extinguished = 0
	IF fire_time_limit < 50000
		fire_time_limit = 50000
	ENDIF
ENDIF

generate_model:

GENERATE_RANDOM_INT_IN_RANGE 90 140 random_car_model //INC 90 NOT INC 140

IF random_car_model > 113  // CAR_BUGGY CAR_CORPSE CAR_POLICE CAR_ENFORCER CAR_SECURICAR CAR_BANSHEE BOAT_PREDATOR CAR_BUS	
AND random_car_model < 128 // CAR_RHINO CAR_BARRACKS TRAIN_SUBWAY HELI_POLICE PLANE_DODO CAR_COACH
	GOTO generate_model
ENDIF

IF random_car_model = 92	// CAR_BOXTER
OR random_car_model = 97	// CAR_FIRETRUCK
OR random_car_model = 101	// CAR_INFERNUS
OR random_car_model = 105	// CAR_CHEETAH
	GOTO generate_model
ENDIF

IF random_car_model = 106	// CAR_AMBULANCE
OR random_car_model = 107	// CAR_FBI
OR random_car_model = 131	// CAR_RCBANDIT
OR random_car_model = 140	// PLANE_AIRTRAIN
	GOTO generate_model
ENDIF

REQUEST_MODEL random_car_model
{
IF first_fire_flag = 1
	TIMERA = 0
ELSE
	TIMERA = 3001
	first_fire_flag = 1
ENDIF

WHILE NOT HAS_MODEL_LOADED random_car_model
OR NOT TIMERA > 3000
	WAIT 0
	
	IF fire_time_limit < 1
		PRINT_NOW F_FAIL2 5000 1
		GOTO failed
	ENDIF
		
	IF NOT IS_PLAYER_IN_MODEL player CAR_FIRETRUCK
		PRINT_NOW F_CANC 3000 1//"Fire truck mission cancelled!"
		GOTO failed
	ENDIF

	IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
		mission_end_button_ft = 1
	ENDIF
	
	IF mission_end_button_ft = 1
		
		IF NOT IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
			PRINT_NOW F_CANC 3000 1//"Fire truck mission cancelled!"
			GOTO failed
		ENDIF
		
	ENDIF
	
ENDWHILE
}
GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 random_car_heading


fire_coord_z += 1.0 // GS-SC: Ensure that the spawned cars don't clip into the road


IF car_on_fire_created = 0	
	CREATE_CAR random_car_model fire_coord_x fire_coord_y fire_coord_z car_on_fire
	car_on_fire_created = 1
ENDIF

CREATE_CHAR_INSIDE_CAR car_on_fire PEDTYPE_CIVMALE PED_MALE1 dummy_ped_for_zone
MARK_MODEL_AS_NO_LONGER_NEEDED random_car_model
SET_CAR_HEADING car_on_fire random_car_heading  
START_CAR_FIRE car_on_fire fire_to_extinguish
ADD_BLIP_FOR_CAR car_on_fire fire_to_extinguish_blip
CAR_SET_IDLE car_on_fire
CHAR_SET_IDLE dummy_ped_for_zone
SET_CAR_CRUISE_SPEED car_on_fire 0.0
SET_CAR_ONLY_DAMAGED_BY_PLAYER car_on_fire TRUE

//PRINT_NOW F_START 3000 1

IF IS_CHAR_IN_ZONE dummy_ped_for_zone PORT_W
	PRINT_STRING_IN_STRING_NOW F_START PORT_W 5000 1 // The suspect is in the Callahan Point area.
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone PORT_S
	PRINT_STRING_IN_STRING_NOW F_START PORT_S 5000 1 // The suspect is in the Atlantic Quays area.
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone PORT_E
	PRINT_STRING_IN_STRING_NOW F_START PORT_E 5000 1 // The suspect is in the Portland Harbour area.
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone PORT_I
	PRINT_STRING_IN_STRING_NOW F_START PORT_I 5000 1 // The suspect is in the Trenton area.
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone S_VIEW
	PRINT_STRING_IN_STRING_NOW F_START S_VIEW 5000 1 // The suspect is in the Portland View area.
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone CHINA
	PRINT_STRING_IN_STRING_NOW F_START CHINA 5000 1 // The dummy_ped_for_zone is proceeding south in Chinatown
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone EASTBAY
	PRINT_STRING_IN_STRING_NOW F_START EASTBAY 5000 1 // The dummy_ped_for_zone is proceeding south in Portland Beach
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone LITTLEI
	PRINT_STRING_IN_STRING_NOW F_START LITTLEI 5000 1 // The dummy_ped_for_zone is proceeding south in Saint Mark's
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone REDLIGH
	PRINT_STRING_IN_STRING_NOW F_START REDLIGH 5000 1 // The dummy_ped_for_zone is proceeding south in Red Light District
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone TOWERS
	PRINT_STRING_IN_STRING_NOW F_START TOWERS 5000 1 // The dummy_ped_for_zone is proceeding south in Hepburn Heights
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone HARWOOD
	PRINT_STRING_IN_STRING_NOW F_START HARWOOD 5000 1 // The dummy_ped_for_zone is proceeding south in Harwood
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone ROADBR1
	PRINT_STRING_IN_STRING_NOW F_START ROADBR1 5000 1 // The dummy_ped_for_zone is proceeding south in Callahan Bridge
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone ROADBR2
	PRINT_STRING_IN_STRING_NOW F_START ROADBR2 5000 1 // The dummy_ped_for_zone is proceeding south in Callahan Bridge
ENDIF

//IF IS_CHAR_IN_ZONE dummy_ped_for_zone TUNNELP
//	PRINT_STRING_IN_STRING_NOW F_START TUNNELP 5000 1 // The dummy_ped_for_zone is proceeding south in Porter Tunnel
//ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone STADIUM
	PRINT_STRING_IN_STRING_NOW F_START STADIUM 5000 1 // The dummy_ped_for_zone is proceeding south in Aspatria
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone HOSPI_2
	PRINT_STRING_IN_STRING_NOW F_START HOSPI_2 5000 1 // The dummy_ped_for_zone is proceeding south in Rockford
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone UNIVERS
	PRINT_STRING_IN_STRING_NOW F_START UNIVERS 5000 1 // The dummy_ped_for_zone is proceeding south in Liberty Campus
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone CONSTRU
	PRINT_STRING_IN_STRING_NOW F_START CONSTRU 5000 1 // The dummy_ped_for_zone is proceeding south in Fort Staunton
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone PARK
	PRINT_STRING_IN_STRING_NOW F_START PARK 5000 1 // The dummy_ped_for_zone is proceeding south in Belleville Park
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone COM_EAS
	PRINT_STRING_IN_STRING_NOW F_START COM_EAS 5000 1 // The dummy_ped_for_zone is proceeding south in Newport
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone SHOPING
	PRINT_STRING_IN_STRING_NOW F_START SHOPING 5000 1 // The dummy_ped_for_zone is proceeding south in Bedford Point
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone YAKUSA
	PRINT_STRING_IN_STRING_NOW F_START YAKUSA 5000 1 // The dummy_ped_for_zone is proceeding south in Torrington
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone AIRPORT
	PRINT_STRING_IN_STRING_NOW F_START AIRPORT 5000 1 // The dummy_ped_for_zone is proceeding south in Francis International Airport
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone PROJECT
	PRINT_STRING_IN_STRING_NOW F_START PROJECT 5000 1 // The dummy_ped_for_zone is proceeding south in Wichita Gardens
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone SUB_IND
	PRINT_STRING_IN_STRING_NOW F_START SUB_IND 5000 1 // The dummy_ped_for_zone is proceeding south in Pike Creek
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone SWANKS
	PRINT_STRING_IN_STRING_NOW F_START SWANKS 5000 1 // The dummy_ped_for_zone is proceeding south in Cedar Grove
ENDIF

IF IS_CHAR_IN_ZONE dummy_ped_for_zone BIG_DAM
	PRINT_STRING_IN_STRING_NOW F_START BIG_DAM 5000 1 // The dummy_ped_for_zone is proceeding south in Cochrane Dam
ENDIF

DELETE_CHAR dummy_ped_for_zone

IF displayed_timer = 0
	DISPLAY_ONSCREEN_TIMER fire_time_limit
	displayed_timer = 1
ENDIF

CLEAR_HELP

IF got_siren_help_before = 1
	PRINT_HELP SIREN_1 //"To turn on this vehicles sirens tap the ~h~L1 button~w~."
	got_siren_help_before = 2
ENDIF

IF got_siren_help_before = 0
	PRINT_HELP SPRAY_1 //"To turn on this vehicles sirens tap the ~h~L1 button~w~."
	got_siren_help_before = 1
ENDIF

WHILE NOT IS_SCRIPT_FIRE_EXTINGUISHED fire_to_extinguish
	WAIT 0
	GET_CAR_COORDINATES car_on_fire current_fire_coord_x current_fire_coord_y current_fire_coord_z

	fire_diff_x = fire_coord_x - current_fire_coord_x
	fire_diff_y = fire_coord_y - current_fire_coord_y
	fire_diff_z = fire_coord_z - current_fire_coord_z
	IF fire_diff_x > 5.0
	OR fire_diff_y > 5.0
	OR fire_diff_z > 5.0
		fire_coord_x = current_fire_coord_x
		fire_coord_y = current_fire_coord_y
		fire_coord_z = current_fire_coord_z
		REMOVE_SCRIPT_FIRE fire_to_extinguish
		START_CAR_FIRE car_on_fire fire_to_extinguish
	ENDIF
	IF IS_CAR_DEAD car_on_fire
		PRINT_NOW F_FAIL2 5000 1
		GOTO failed
	ENDIF
	
	IF fire_time_limit < 1
		PRINT_NOW F_FAIL2 5000 1
		GOTO failed
	ENDIF
	
	IF NOT IS_PLAYER_IN_MODEL player CAR_FIRETRUCK
		PRINT_NOW F_CANC 3000 1//"Fire truck mission cancelled!"
		GOTO failed
	ENDIF

	GET_CAR_HEALTH car_on_fire car_on_fire_health
	
	IF car_on_fire_health < 900
		EXPLODE_CAR car_on_fire
	ENDIF

	IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
		mission_end_button_ft = 1
	ENDIF
		
	IF mission_end_button_ft = 1
		
		IF NOT IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
			PRINT_NOW F_CANC 3000 1//"Fire truck mission cancelled!"
			GOTO failed
		ENDIF
		
	ENDIF

ENDWHILE

GOTO passed


/////////////////////////////////////////////////
passed://////////////////////////////////////////
/////////////////////////////////////////////////

++ fires_extinguished

IF fires_extinguished = 15
	USE_TEXT_COMMANDS 113 // HACKED achievement unlock // SPLISH_SPLASH
ENDIF

IF fires_extinguished = 20
	USE_TEXT_COMMANDS 133 // HACKED achievement unlock // RELIEF_PITCHER
ENDIF	

PRINT_BIG F_PASS1 5000 5
PRINT_WITH_NUMBER_BIG REWARD score_ft 6000 6
REGISTER_FIRE_EXTINGUISHED

IF fire_location = 1
	++ ind_fires_exting
ENDIF

IF fire_location = 2
	++ com_fires_exting
ENDIF

IF fire_location = 3
	++ sub_fires_exting
ENDIF

IF earned_free_flamethrower = 0
	IF ind_fires_exting > 19
	AND com_fires_exting > 19
	AND sub_fires_exting > 19
		ADD_PAGER_MESSAGE PAGEB11 140 100 1	//"Flamethrower delivered to hideout"
		PLAYER_MADE_PROGRESS 1
		earned_free_flamethrower = 1
	ENDIF
ENDIF

ADD_SCORE player score_ft
total_score += score_ft
score_ft += 250
REMOVE_ALL_SCRIPT_FIRES
REMOVE_BLIP fire_to_extinguish_blip
ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_PART_MISSION_COMPLETE

IF IS_PLAYER_IN_ANY_CAR	player
	STORE_CAR_PLAYER_IS_IN player players_firetruck
	GET_CAR_HEALTH players_firetruck players_firetruck_health
	players_firetruck_health += 150
	SET_CAR_HEALTH players_firetruck players_firetruck_health
ENDIF

//earned_free_flamethrower PAGEB11

IF displayed_counter = 0
	DISPLAY_ONSCREEN_COUNTER_WITH_STRING fires_extinguished	COUNTER_DISPLAY_NUMBER F_EXTIN
	displayed_counter = 1
ENDIF

IF car_on_fire_created = 1
	MARK_CAR_AS_NO_LONGER_NEEDED car_on_fire
	IF NOT IS_CAR_DEAD car_on_fire
		SET_CAR_ONLY_DAMAGED_BY_PLAYER car_on_fire FALSE
	ENDIF
	car_on_fire_created = 0
ENDIF

MARK_MODEL_AS_NO_LONGER_NEEDED random_car_model

GOTO next_fire


/////////////////////////////////////////////////
failed://////////////////////////////////////////
/////////////////////////////////////////////////

// reset radar mode
DISPLAY_RADAR 3 // HACKED RADAR ON

CLEAR_ONSCREEN_TIMER fire_time_limit
CLEAR_ONSCREEN_COUNTER fires_extinguished
PRINT_BIG F_FAIL1 5000 5
PRINT_WITH_NUMBER_BIG TSCORE total_score 6000 6
REMOVE_ALL_SCRIPT_FIRES
REMOVE_BLIP fire_to_extinguish_blip
CLEAR_HELP
SET_WANTED_MULTIPLIER 1.0

IF car_on_fire_created = 1
	IF NOT IS_CAR_DEAD car_on_fire
		SET_CAR_ONLY_DAMAGED_BY_PLAYER car_on_fire FALSE
		EXPLODE_CAR car_on_fire
	ENDIF
	MARK_CAR_AS_NO_LONGER_NEEDED car_on_fire
	car_on_fire_created = 0
ENDIF
MARK_MODEL_AS_NO_LONGER_NEEDED random_car_model

flag_player_on_mission = 0
flag_player_on_fire_mission	= 0
MISSION_HAS_FINISHED
RETURN

	   		
	
		


MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *********************************** Cop Car Mission ************************************* 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_cop_car

GOSUB cop_car_failed

MISSION_END
 
// Variables for mission

VAR_INT	got_range_message	player_in_range	car_model criminal_car	range_int mission_end_button total_criminals_killed players_cop_car_health
VAR_INT criminal_created_flag criminal criminal_blip random_gun	cop_time_limit got_car_crim_is_in timer_reset_flag vigilante_bonus_kills location got_cop_breif
VAR_INT game_time_flag game_timer_start	copcar_timer game_time_present game_time_difference	timer_in_secs players_cop_car vigilante	vigilante_score copcar_cancelled_flag

VAR_FLOAT player_c_x player_c_y	player_c_z random_crim_x random_crim_y criminal_coord_x criminal_coord_y criminal_coord_z 
VAR_FLOAT diff_x_float diff_y_float sum_of_diff_xy players_distance_from_criminal cop_time_limit_float criminal_heading	warp_heading_cop

// ****************************************Mission Start************************************

mission_start_cop_car:

flag_player_on_mission 		= 1
flag_player_on_cop_mission 	= 1
vigilante_bonus_kills = 5

SCRIPT_NAME copcar

total_criminals_killed = 0
got_cop_breif 		  = 0

WAIT 0

next_cop_car:

// 3master - ALL VIGILANTE MISSIONS SHOULD HAVE NO PATHING
// new new design! oddjobs with one target should still have pathing
//DISPLAY_RADAR 2 // PATHING OFF /////////////////////////
//////////////////////////////////////////////////////////

got_range_message 	  = 0
player_in_range 	  = 0
car_model 			  = 0
criminal_car 		  = 0
criminal_created_flag = 0
criminal 			  = 0
criminal_blip 		  = 0
random_gun 			  = 0
cop_time_limit 		  = 0
got_car_crim_is_in 	  = 0
timer_reset_flag 	  = 0
game_time_flag		  = 0
mission_end_button	  = 0
location			  = 0
copcar_cancelled_flag = 0

player_c_x 		 = 0.0 
player_c_y 		 = 0.0	
player_c_z 		 = 0.0 
random_crim_x 	 = 0.0 
random_crim_y 	 = 0.0 
criminal_coord_x = 0.0 
criminal_coord_y = 0.0 
criminal_coord_z = 0.0
diff_x_float 	 = 0.0 
diff_y_float 	 = 0.0 
sum_of_diff_xy 	 = 0.0 
players_distance_from_criminal = 0.0 
cop_time_limit_float = 0.0 
criminal_heading 	 = 0.0

GET_PLAYER_COORDINATES player player_c_x player_c_y player_c_z
REQUEST_MODEL CAR_SENTINEL
{
criminal_in_car://////////////////////////////////////////////////////////////////////////////////////////////////////

WAIT 0

IF got_cop_breif = 0
	PRINT_NOW LEGAL 3000 1
	TIMERB = 0
	got_cop_breif = 1
ELSE
	TIMERB = 3000
ENDIF

IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
	GENERATE_RANDOM_FLOAT_IN_RANGE 778.0 1540.0 random_crim_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1110.0 190.0 random_crim_y
	got_range_message = 0
	player_in_range = 1
	location = 1
ENDIF

IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
	GENERATE_RANDOM_FLOAT_IN_RANGE -192.0 545.0 random_crim_x  
	GENERATE_RANDOM_FLOAT_IN_RANGE -1626.0 98.0 random_crim_y
	got_range_message = 0
	player_in_range = 1
	location = 2
ENDIF

IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	GENERATE_RANDOM_FLOAT_IN_RANGE -1300.0 -414.0 random_crim_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -608.8 380.0 random_crim_y
	got_range_message = 0
	player_in_range = 1
	location = 3
ENDIF

IF player_in_range = 0
	IF got_range_message = 0
		PRINT_NOW C_RANGE 5000 1 //"The radio is out of range, get closer to a police station!"
		got_range_message = 1
	ENDIF
	GOTO cop_car_failed
ENDIF													  

GOSUB copcar_cancelled_checks
IF copcar_cancelled_flag = 1
	GOTO cop_car_failed
ENDIF

GET_CLOSEST_CAR_NODE random_crim_x random_crim_y player_c_z criminal_coord_x criminal_coord_y criminal_coord_z


// 3master - make sure the car node is next to a sidewalk or something, so they dont spawn somewhere crazy
LVAR_FLOAT test_ped_node_x test_ped_node_y test_ped_node_z test_ped_node_dist
GET_CLOSEST_CHAR_NODE random_crim_x random_crim_y player_c_z test_ped_node_x test_ped_node_y test_ped_node_z
GET_DISTANCE_BETWEEN_COORDS_3D criminal_coord_x criminal_coord_y criminal_coord_z test_ped_node_x test_ped_node_y test_ped_node_z test_ped_node_dist

IF test_ped_node_dist > 10.0
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 1398.0 //MIN_X // COLOMBIAN BOAT
AND criminal_coord_x	< 1615.0 //MAX_X
AND criminal_coord_y	> -965.0 //MIN_Y
AND criminal_coord_y	< -902.0 //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 879.0	 //MIN_X // BACK OF LUIGI'S
AND criminal_coord_x	< 892.0  //MAX_X
AND criminal_coord_y	> -427.0 //MIN_Y
AND criminal_coord_y	< -407.0 //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 944.8	  //MIN_X // FISH FACTORY
AND criminal_coord_x	< 1017.1  //MAX_X
AND criminal_coord_y	> -1148.8 //MIN_Y
AND criminal_coord_y	< -1076.6 //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 920.8	 //MIN_X // CHINATOWN MARKET
AND criminal_coord_x	< 1004.0 //MAX_X
AND criminal_coord_y	> -754.2 //MIN_Y
AND criminal_coord_y	< -670.0 //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 670.0	 //MIN_X // CALAHAN BRIDGE
AND criminal_coord_x	< 1035.0 //MAX_X
AND criminal_coord_y	> -953.0 //MIN_Y
AND criminal_coord_y	< -912.0 //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 1364.0  //MIN_X // DOCKS INDUSTRIAL
AND criminal_coord_x	< 1641.0  //MAX_X
AND criminal_coord_y	> -1165.0 //MIN_Y
AND criminal_coord_y	< -617.0  //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 649.0	 //MIN_X // TUNNEL ENTRANCE INDUSTRIAL
AND criminal_coord_x	< 1066.0 //MAX_X
AND criminal_coord_y	> 25.0   //MIN_Y
AND criminal_coord_y	< 217.0  //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> -1611.5 //MIN_X // AIRPORT SUBURBAN
AND criminal_coord_x	< -745.3  //MAX_X
AND criminal_coord_y	> -1001.9 //MIN_Y
AND criminal_coord_y	< -371.2  //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 939.8  //MIN_X // OLD SCHOOL HALL AND PARK AREA
AND criminal_coord_x	< 1035.6 //MAX_X
AND criminal_coord_y	> -901.3 //MIN_Y
AND criminal_coord_y	< -828.2 //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 1215.3 //MIN_X // DOG FOOD FACTORY
AND criminal_coord_x	< 1223.7 //MAX_X
AND criminal_coord_y	> -839.4 //MIN_Y
AND criminal_coord_y	< -763.6 //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 845.3  //MIN_X // INDUSTRIAL SAFEHOUSE
AND criminal_coord_x	< 899.6  //MAX_X
AND criminal_coord_y	> -312.6 //MIN_Y
AND criminal_coord_y	< -295.7 //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 113.3   //MIN_X // DOJO COMMERCIAL
AND criminal_coord_x	< 99.7    //MAX_X
AND criminal_coord_y	> -1284.8 //MIN_Y
AND criminal_coord_y	< -1273.0 //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 18.33   //MIN_X // COLOMBIAN OJG COMPOUND
AND criminal_coord_x	< 92.06   //MAX_X
AND criminal_coord_y	> -388.7  //MIN_Y
AND criminal_coord_y	< -312.38 //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> -1255.4 //MIN_X // BAIT WAREHOUSE CARPARK SUBURBIA
AND criminal_coord_x	< -1187.9 //MAX_X
AND criminal_coord_y	> 80.6    //MIN_Y
AND criminal_coord_y	< 123.4   //MAX_Y
	GOTO criminal_in_car
ENDIF

IF criminal_coord_x 	> 1386.4 //MIN_X // FRANKIES HOUSE
AND criminal_coord_x	< 1475.8 //MAX_X
AND criminal_coord_y	> -292.1 //MIN_Y
AND criminal_coord_y	< -168.0 //MAX_Y
	GOTO criminal_in_car
ENDIF

IF location = 1
	IF NOT criminal_coord_x > 778.0 //MIN_X // INDUSTRIAL
	OR NOT criminal_coord_x	< 1540.0 //MAX_X
	OR NOT criminal_coord_y	> -1110.0 //MIN_Y
	OR NOT criminal_coord_y	< 190.0 //MAX_Y
		GOTO criminal_in_car
	ENDIF
ENDIF

IF location = 2
	IF NOT criminal_coord_x > -192.0 //MIN_X // COMMERCIAL
	OR NOT criminal_coord_x	< 545.0 //MAX_X
	OR NOT criminal_coord_y	> -1626.0 //MIN_Y
	OR NOT criminal_coord_y	< 98.0 //MAX_Y
		GOTO criminal_in_car
	ENDIF
ENDIF

IF location = 3
	IF NOT criminal_coord_x > -1300.0 //MIN_X // SUBURBIA
	OR NOT criminal_coord_x	< -414.0 //MAX_X
	OR NOT criminal_coord_y	> -608.8 //MIN_Y
	OR NOT criminal_coord_y	< 380.0 //MAX_Y
		GOTO criminal_in_car
	ENDIF
ENDIF

IF criminal_coord_z < -1.0
	GOTO criminal_in_car
ENDIF

diff_x_float = player_c_x - criminal_coord_x
diff_y_float = player_c_y - criminal_coord_y
diff_x_float = diff_x_float * diff_x_float
diff_y_float = diff_y_float * diff_y_float
sum_of_diff_xy = diff_x_float + diff_y_float
SQRT sum_of_diff_xy players_distance_from_criminal

IF players_distance_from_criminal < 150.0
	GOTO criminal_in_car
ENDIF

cop_time_limit_float = players_distance_from_criminal / 4.0
cop_time_limit_float = cop_time_limit_float * 1000.0
cop_time_limit =# cop_time_limit_float

IF cop_time_limit < 120000
	cop_time_limit = 120000
ENDIF

generate_car_model:

GENERATE_RANDOM_INT_IN_RANGE 90 140 car_model

IF car_model > 113  // CAR_BUGGY CAR_CORPSE CAR_POLICE CAR_ENFORCER CAR_SECURICAR CAR_BANSHEE BOAT_PREDATOR CAR_BUS	
AND car_model < 128 // CAR_RHINO CAR_BARRACKS TRAIN_SUBWAY HELI_POLICE PLANE_DODO CAR_COACH
	GOTO generate_car_model
ENDIF

IF car_model = 97	// CAR_FIRETRUCK
	GOTO generate_car_model
ENDIF

IF car_model = 106	// CAR_AMBULANCE
OR car_model = 107	// CAR_FBI
OR car_model = 131	// CAR_RCBANDIT
OR car_model = 140	// PLANE_AIRTRAIN
	GOTO generate_car_model
ENDIF

REQUEST_MODEL car_model

WHILE NOT HAS_MODEL_LOADED car_model
	WAIT 0

	GOSUB copcar_cancelled_checks
	IF copcar_cancelled_flag = 1
		GOTO cop_car_failed
	ENDIF

ENDWHILE

GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 criminal_heading

WHILE NOT TIMERB > 3000
	WAIT 0
	
	GOSUB copcar_cancelled_checks
	IF copcar_cancelled_flag = 1
		GOTO cop_car_failed
	ENDIF

ENDWHILE

criminal_coord_z += 1.0 // GS-SC: Ensure that the car doesn't spawn clipping into the street

CREATE_CAR car_model criminal_coord_x criminal_coord_y criminal_coord_z criminal_car
SET_CAR_AVOID_LEVEL_TRANSITIONS criminal_car TRUE
SET_CAR_HEALTH criminal_car 800
MARK_MODEL_AS_NO_LONGER_NEEDED car_model
SET_CAR_HEADING criminal_car criminal_heading

GET_CLOSEST_CHAR_NODE criminal_coord_x criminal_coord_y criminal_coord_z criminal_coord_x criminal_coord_y criminal_coord_z
CREATE_RANDOM_CHAR criminal_coord_x criminal_coord_y criminal_coord_z criminal
SET_CHAR_IS_CHRIS_CRIMINAL criminal TRUE
//SET_CHAR_AVOID_LEVEL_TRANSITIONS criminal TRUE
WARP_CHAR_INTO_CAR criminal criminal_car
SET_CHAR_RUNNING criminal TRUE
SET_CHAR_ONLY_DAMAGED_BY_PLAYER criminal TRUE

CLEAR_CHAR_THREAT_SEARCH criminal

SET_CHAR_PERSONALITY criminal PEDSTAT_TOUGH_GUY

SET_CHAR_THREAT_SEARCH criminal THREAT_PLAYER1
SET_CHAR_THREAT_SEARCH criminal THREAT_PLAYER2
SET_CHAR_THREAT_SEARCH criminal THREAT_PLAYER3
SET_CHAR_THREAT_SEARCH criminal THREAT_PLAYER4
SET_CHAR_THREAT_SEARCH criminal THREAT_CIVMALE
SET_CHAR_THREAT_SEARCH criminal THREAT_CIVFEMALE
SET_CHAR_THREAT_SEARCH criminal THREAT_COP	
SET_CHAR_THREAT_SEARCH criminal THREAT_GANG_MAFIA	
SET_CHAR_THREAT_SEARCH criminal THREAT_GANG_DIABLO	
SET_CHAR_THREAT_SEARCH criminal THREAT_GANG_TRIAD	
SET_CHAR_THREAT_SEARCH criminal THREAT_GANG_YARDIE	
SET_CHAR_THREAT_SEARCH criminal THREAT_GANG_COLOMBIAN	
SET_CHAR_THREAT_SEARCH criminal THREAT_GANG_HOOD	
SET_CHAR_THREAT_SEARCH criminal THREAT_GANG_YAKUZA	
SET_CHAR_THREAT_SEARCH criminal THREAT_EMERGENCY
SET_CHAR_THREAT_SEARCH criminal THREAT_PROSTITUTE
SET_CHAR_THREAT_SEARCH criminal THREAT_CRIMINAL
SET_CHAR_THREAT_SEARCH criminal THREAT_GUN	
SET_CHAR_THREAT_SEARCH criminal THREAT_COP_CAR
SET_CHAR_THREAT_SEARCH criminal THREAT_FAST_CAR
SET_CHAR_THREAT_SEARCH criminal THREAT_FIREMAN

SET_CHAR_HEED_THREATS criminal TRUE

MARK_CAR_AS_NO_LONGER_NEEDED criminal_car  

IF flag_industrial_passed = 0
	GENERATE_RANDOM_INT_IN_RANGE 0 5 random_gun
ENDIF

IF flag_industrial_passed = 1
	GENERATE_RANDOM_INT_IN_RANGE 2 6 random_gun
ENDIF

IF flag_commercial_passed = 1
	GENERATE_RANDOM_INT_IN_RANGE 3 10 random_gun
ENDIF

GIVE_WEAPON_TO_CHAR criminal random_gun 1000

ADD_BLIP_FOR_CHAR criminal criminal_blip

CLEAR_HELP


IF NOT IS_PLAYER_IN_MODEL player CAR_RHINO
IF got_siren_help_before = 0
	PRINT_HELP SIREN_1 //"To turn on this vehicles sirens tap the ~h~L1 button~w~."
	got_siren_help_before = 1
ENDIF
ENDIF


IF IS_CHAR_IN_ZONE criminal PORT_W
	PRINT_STRING_IN_STRING_NOW C_BREIF PORT_W 5000 1 // The suspect is in the Callahan Point area.
ENDIF

IF IS_CHAR_IN_ZONE criminal PORT_S
	PRINT_STRING_IN_STRING_NOW C_BREIF PORT_S 5000 1 // The suspect is in the Atlantic Quays area.
ENDIF

IF IS_CHAR_IN_ZONE criminal PORT_E
	PRINT_STRING_IN_STRING_NOW C_BREIF PORT_E 5000 1 // The suspect is in the Portland Harbour area.
ENDIF

IF IS_CHAR_IN_ZONE criminal PORT_I
	PRINT_STRING_IN_STRING_NOW C_BREIF PORT_I 5000 1 // The suspect is in the Trenton area.
ENDIF

IF IS_CHAR_IN_ZONE criminal S_VIEW
	PRINT_STRING_IN_STRING_NOW C_BREIF S_VIEW 5000 1 // The suspect is in the Portland View area.
ENDIF

IF IS_CHAR_IN_ZONE criminal CHINA
	PRINT_STRING_IN_STRING_NOW C_BREIF CHINA 5000 1 // The criminal is proceeding south in Chinatown
ENDIF

IF IS_CHAR_IN_ZONE criminal EASTBAY
	PRINT_STRING_IN_STRING_NOW C_BREIF EASTBAY 5000 1 // The criminal is proceeding south in Portland Beach
ENDIF

IF IS_CHAR_IN_ZONE criminal LITTLEI
	PRINT_STRING_IN_STRING_NOW C_BREIF LITTLEI 5000 1 // The criminal is proceeding south in Saint Mark's
ENDIF

IF IS_CHAR_IN_ZONE criminal REDLIGH
	PRINT_STRING_IN_STRING_NOW C_BREIF REDLIGH 5000 1 // The criminal is proceeding south in Red Light District
ENDIF

IF IS_CHAR_IN_ZONE criminal TOWERS
	PRINT_STRING_IN_STRING_NOW C_BREIF TOWERS 5000 1 // The criminal is proceeding south in Hepburn Heights
ENDIF

IF IS_CHAR_IN_ZONE criminal HARWOOD
	PRINT_STRING_IN_STRING_NOW C_BREIF HARWOOD 5000 1 // The criminal is proceeding south in Harwood
ENDIF

IF IS_CHAR_IN_ZONE criminal ROADBR1
	PRINT_STRING_IN_STRING_NOW C_BREIF ROADBR1 5000 1 // The criminal is proceeding south in Callahan Bridge
ENDIF

IF IS_CHAR_IN_ZONE criminal ROADBR2
	PRINT_STRING_IN_STRING_NOW C_BREIF ROADBR2 5000 1 // The criminal is proceeding south in Callahan Bridge
ENDIF

//IF IS_CHAR_IN_ZONE criminal TUNNELP
//	PRINT_STRING_IN_STRING_NOW C_BREIF TUNNELP 5000 1 // The criminal is proceeding south in Porter Tunnel
//ENDIF

IF IS_CHAR_IN_ZONE criminal STADIUM
	PRINT_STRING_IN_STRING_NOW C_BREIF STADIUM 5000 1 // The criminal is proceeding south in Aspatria
ENDIF

IF IS_CHAR_IN_ZONE criminal HOSPI_2
	PRINT_STRING_IN_STRING_NOW C_BREIF HOSPI_2 5000 1 // The criminal is proceeding south in Rockford
ENDIF

IF IS_CHAR_IN_ZONE criminal UNIVERS
	PRINT_STRING_IN_STRING_NOW C_BREIF UNIVERS 5000 1 // The criminal is proceeding south in Liberty Campus
ENDIF

IF IS_CHAR_IN_ZONE criminal CONSTRU
	PRINT_STRING_IN_STRING_NOW C_BREIF CONSTRU 5000 1 // The criminal is proceeding south in Fort Staunton
ENDIF

IF IS_CHAR_IN_ZONE criminal PARK
	PRINT_STRING_IN_STRING_NOW C_BREIF PARK 5000 1 // The criminal is proceeding south in Belleville Park
ENDIF

IF IS_CHAR_IN_ZONE criminal COM_EAS
	PRINT_STRING_IN_STRING_NOW C_BREIF COM_EAS 5000 1 // The criminal is proceeding south in Newport
ENDIF

IF IS_CHAR_IN_ZONE criminal SHOPING
	PRINT_STRING_IN_STRING_NOW C_BREIF SHOPING 5000 1 // The criminal is proceeding south in Bedford Point
ENDIF

IF IS_CHAR_IN_ZONE criminal YAKUSA
	PRINT_STRING_IN_STRING_NOW C_BREIF YAKUSA 5000 1 // The criminal is proceeding south in Torrington
ENDIF

IF IS_CHAR_IN_ZONE criminal AIRPORT
	PRINT_STRING_IN_STRING_NOW C_BREIF AIRPORT 5000 1 // The criminal is proceeding south in Francis International Airport
ENDIF

IF IS_CHAR_IN_ZONE criminal PROJECT
	PRINT_STRING_IN_STRING_NOW C_BREIF PROJECT 5000 1 // The criminal is proceeding south in Wichita Gardens
ENDIF

IF IS_CHAR_IN_ZONE criminal SUB_IND
	PRINT_STRING_IN_STRING_NOW C_BREIF SUB_IND 5000 1 // The criminal is proceeding south in Pike Creek
ENDIF

IF IS_CHAR_IN_ZONE criminal SWANKS
	PRINT_STRING_IN_STRING_NOW C_BREIF SWANKS 5000 1 // The criminal is proceeding south in Cedar Grove
ENDIF

IF IS_CHAR_IN_ZONE criminal BIG_DAM
	PRINT_STRING_IN_STRING_NOW C_BREIF BIG_DAM 5000 1 // The criminal is proceeding south in Cochrane Dam
ENDIF

GET_CHAR_COORDINATES criminal criminal_coord_x criminal_coord_y criminal_coord_z
POLICE_RADIO_MESSAGE criminal_coord_x criminal_coord_y criminal_coord_z

TIMERB = 0

DISPLAY_ONSCREEN_TIMER cop_time_limit

WHILE NOT IS_CHAR_DEAD criminal

	IF cop_time_limit < 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player criminal 100.0 100.0 0
			REMOVE_BLIP	criminal_blip
			DELETE_CHAR	criminal
			criminal_created_flag = 0
			PRINT_NOW C_ESCP 3000 1//"The suspect has escaped!"
		ELSE
			PRINT_NOW C_TIME 3000 1//"Your time as a law enforcer is over!"
		ENDIF
		GOTO cop_car_failed
	ENDIF

	GOSUB copcar_cancelled_checks
	IF copcar_cancelled_flag = 1
		GOTO cop_car_failed
	ENDIF

	IF got_car_crim_is_in = 0
		IF NOT IS_CHAR_HEALTH_GREATER criminal 70
			SET_CHAR_OBJ_STEAL_ANY_CAR criminal
		ENDIF
	ENDIF
		
	IF IS_CHAR_IN_ANY_CAR criminal
	AND got_car_crim_is_in = 0
		MARK_CAR_AS_NO_LONGER_NEEDED criminal_car
		STORE_CAR_CHAR_IS_IN criminal criminal_car
		SET_UPSIDEDOWN_CAR_NOT_DAMAGED criminal_car TRUE
		SET_CAR_DRIVING_STYLE criminal_car 2
		SET_CAR_CRUISE_SPEED criminal_car 42.0
		CAR_WANDER_RANDOMLY criminal_car
		SET_CAR_AVOID_LEVEL_TRANSITIONS criminal_car TRUE
		got_car_crim_is_in = 1
	ENDIF
		
	IF got_car_crim_is_in = 1
		IF NOT IS_CHAR_IN_ANY_CAR criminal
			GENERATE_RANDOM_INT_IN_RANGE 0 5 range_int
			IF range_int = 0
				SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_TILL_SAFE criminal player
			ENDIF
			IF range_int = 1
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player criminal 150.0 150.0 0
					SET_CHAR_OBJ_STEAL_ANY_CAR criminal
				ELSE
					IF HAS_MODEL_LOADED CAR_SENTINEL
						GET_CHAR_COORDINATES criminal criminal_coord_x criminal_coord_y criminal_coord_z
						GET_CLOSEST_CAR_NODE_WITH_HEADING criminal_coord_x criminal_coord_y criminal_coord_z criminal_coord_x criminal_coord_y criminal_coord_z warp_heading_cop
						MARK_CAR_AS_NO_LONGER_NEEDED criminal_car
						CREATE_CAR CAR_SENTINEL	criminal_coord_x criminal_coord_y criminal_coord_z criminal_car
						SET_CAR_HEADING	criminal_car warp_heading_cop
						SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER criminal criminal_car
					ELSE
						SET_CHAR_OBJ_STEAL_ANY_CAR criminal
					ENDIF
				ENDIF
			ENDIF
			IF range_int = 2
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS criminal player
			ENDIF
			IF range_int = 3
				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player players_cop_car
					SET_CHAR_OBJ_DESTROY_CAR criminal players_cop_car
				ELSE
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS criminal player
				ENDIF
			ENDIF
			IF range_int = 4
				GENERATE_RANDOM_INT_IN_RANGE 0 8 range_int
				CHAR_WANDER_DIR criminal -1//range_int//
			ENDIF
			got_car_crim_is_in = 0
		ENDIF
	ENDIF
	
	IF got_car_crim_is_in = 1

		IF NOT IS_CAR_DEAD criminal_car

			IF TIMERB > 1000
				TIMERB = 0
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player criminal 20.0 20.0 0
					SET_CAR_CRUISE_SPEED criminal_car 46.0
				ELSE
					IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player criminal 50.0 50.0 0
						SET_CAR_CRUISE_SPEED criminal_car 39.0
					ELSE
						IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player criminal 90.0 90.0 0
							SET_CAR_CRUISE_SPEED criminal_car 32.0
						ELSE
							IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player criminal 130.0 130.0 0
								SET_CAR_CRUISE_SPEED criminal_car 26.0
							ELSE
								SET_CAR_CRUISE_SPEED criminal_car 18.0
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		
			IF IS_CAR_STOPPED criminal_car
				IF timer_reset_flag = 0
					TIMERA = 0
					timer_reset_flag = 1
				ENDIF

				IF TIMERA > 8000
				AND timer_reset_flag = 1
					IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player criminal 90.0 90.0 0
						SET_CHAR_OBJ_LEAVE_CAR criminal criminal_car
						timer_reset_flag = 0
					ELSE
						IF NOT IS_CAR_ON_SCREEN criminal_car
							GET_CAR_COORDINATES criminal_car criminal_coord_x criminal_coord_y criminal_coord_z
							GET_CLOSEST_CAR_NODE_WITH_HEADING criminal_coord_x criminal_coord_y criminal_coord_z criminal_coord_x criminal_coord_y criminal_coord_z warp_heading_cop
							IF NOT IS_POINT_ON_SCREEN criminal_coord_x criminal_coord_y criminal_coord_z 4.0
								SET_CAR_COORDINATES criminal_car criminal_coord_x criminal_coord_y criminal_coord_z
								SET_CAR_HEADING	criminal_car warp_heading_cop
								timer_reset_flag = 0
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
					
			IF IS_CAR_UPSIDEDOWN criminal_car
			AND IS_CAR_STOPPED criminal_car
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player criminal 90.0 90.0 0
					SET_CHAR_OBJ_LEAVE_CAR criminal criminal_car
					SET_UPSIDEDOWN_CAR_NOT_DAMAGED criminal_car FALSE
				ELSE
					IF NOT IS_CAR_ON_SCREEN criminal_car
						GET_CAR_COORDINATES criminal_car criminal_coord_x criminal_coord_y criminal_coord_z
						GET_CLOSEST_CAR_NODE_WITH_HEADING criminal_coord_x criminal_coord_y criminal_coord_z criminal_coord_x criminal_coord_y criminal_coord_z warp_heading_cop
						IF NOT IS_POINT_ON_SCREEN criminal_coord_x criminal_coord_y criminal_coord_z 4.0
							SET_CAR_COORDINATES criminal_car criminal_coord_x criminal_coord_y criminal_coord_z
							SET_CAR_HEADING	criminal_car warp_heading_cop
						ENDIF
					ENDIF
				ENDIF
			ENDIF

			IF NOT IS_CAR_HEALTH_GREATER criminal_car 250
				SET_CHAR_OBJ_LEAVE_CAR criminal criminal_car
			ENDIF
		
		ENDIF

	ENDIF

	WAIT 0

ENDWHILE
}

MARK_CHAR_AS_NO_LONGER_NEEDED criminal
MARK_CAR_AS_NO_LONGER_NEEDED criminal_car

++ total_criminals_killed
REGISTER_CRIMINAL_CAUGHT
ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_PART_MISSION_COMPLETE
IF total_criminals_killed = 1
	DISPLAY_ONSCREEN_COUNTER_WITH_STRING total_criminals_killed COUNTER_DISPLAY_NUMBER KILLS
ENDIF

REMOVE_BLIP criminal_blip
vigilante_score	= total_criminals_killed * 500
PRINT_BIG C_PASS 5000 5
PRINT_WITH_NUMBER_BIG REWARD vigilante_score 5000 6
ADD_SCORE player vigilante_score

IF total_criminals_killed = vigilante_bonus_kills
	vigilante = total_criminals_killed * 2
	vigilante *= 500
	PRINT_BIG_Q C_VIGIL 5000 5
	PRINT_WITH_NUMBER_BIG_Q REWARD vigilante 6000 6
	ADD_SCORE player vigilante
	//FLASH_HUD_OBJECT OnscreenCounter
	IF vigilante_bonus_kills = 10
		//ADD_PAGER_MESSAGE PAGEB12 140 100 1	//"Get out of jail free!"
		SET_GET_OUT_OF_JAIL_FREE player TRUE
	ENDIF
	vigilante_bonus_kills += 5
ENDIF

IF location = 1
	++ ind_copcar_kills
ENDIF

IF location = 2
	++ com_copcar_kills
ENDIF

IF location = 3
	++ sub_copcar_kills
ENDIF

IF play_pager_message1 = 0
	IF ind_copcar_kills = 10
		ADD_PAGER_MESSAGE PAGEB12 140 100 1	//"Police Bribe delivered to hideout"
		PLAYER_MADE_PROGRESS 1
		play_pager_message1 = 1
	ENDIF
ENDIF

IF play_pager_message1 = 1
	IF ind_copcar_kills = 20
		ADD_PAGER_MESSAGE PAGEB12 140 100 1	//"Police Bribe delivered to hideout"
		PLAYER_MADE_PROGRESS 1
		play_pager_message1 = 2
	ENDIF
ENDIF

IF play_pager_message2 = 0
	IF com_copcar_kills = 10
		ADD_PAGER_MESSAGE PAGEB12 140 100 1	//"Police Bribe delivered to hideout"
		PLAYER_MADE_PROGRESS 1
		play_pager_message2 = 1
	ENDIF
ENDIF

IF play_pager_message2 = 1
	IF com_copcar_kills = 20
		ADD_PAGER_MESSAGE PAGEB12 140 100 1	//"Police Bribe delivered to hideout"
		PLAYER_MADE_PROGRESS 1
		play_pager_message2 = 2
	ENDIF
ENDIF

IF play_pager_message3 = 0
	IF sub_copcar_kills = 10
		ADD_PAGER_MESSAGE PAGEB12 140 100 1	//"Police Bribe delivered to hideout"
		PLAYER_MADE_PROGRESS 1
		play_pager_message3 = 1
	ENDIF
ENDIF

IF play_pager_message3 = 1
	IF sub_copcar_kills = 20
		ADD_PAGER_MESSAGE PAGEB12 140 100 1	//"Police Bribe delivered to hideout"
		PLAYER_MADE_PROGRESS 1
		play_pager_message3 = 2
	ENDIF
ENDIF

WHILE NOT IS_PLAYER_IN_MODEL player CAR_POLICE
AND NOT IS_PLAYER_IN_MODEL player CAR_ENFORCER
AND NOT IS_PLAYER_IN_MODEL player CAR_RHINO
AND NOT IS_PLAYER_IN_MODEL player CAR_FBI
	IF game_time_flag = 0
		GET_GAME_TIMER game_timer_start
		IF cop_time_limit > 60000 
			copcar_timer = 60000
		ELSE
			copcar_timer = cop_time_limit
		ENDIF 
		game_time_flag = 1
	ENDIF
	GET_GAME_TIMER game_time_present
	game_time_difference = game_time_present - game_timer_start
	copcar_timer -= game_time_difference
	game_timer_start = game_time_present
	timer_in_secs = copcar_timer / 1000
	PRINT_WITH_NUMBER_NOW COPCART timer_in_secs 200 1	//You have ~1~ seconds to return to the car before the mission ends.
	IF timer_in_secs < 1 
		PRINT_NOW C_TIME 3000 1//"Your time as a law enforcer is over!"
		GOTO cop_car_failed
	ENDIF

	WAIT 0

ENDWHILE

IF IS_PLAYER_IN_ANY_CAR player
	STORE_CAR_PLAYER_IS_IN player players_cop_car
	GET_CAR_HEALTH players_cop_car players_cop_car_health
	players_cop_car_health += 100
	SET_CAR_HEALTH players_cop_car players_cop_car_health
ENDIF

GOTO cop_car_passed


/////////////////////////////////////////////////////////////
cop_car_passed://////////////////////////////////////////////
/////////////////////////////////////////////////////////////

CLEAR_ONSCREEN_TIMER cop_time_limit
REMOVE_BLIP criminal_blip

IF criminal_created_flag = 1
	MARK_CHAR_AS_NO_LONGER_NEEDED criminal
	criminal_created_flag = 0
ENDIF

GOTO next_cop_car


/////////////////////////////////////////////////////////////
cop_car_failed://////////////////////////////////////////////
/////////////////////////////////////////////////////////////

DISPLAY_RADAR 3 // PATHING ON

IF total_criminals_killed > 14
	USE_TEXT_COMMANDS 115 // HACKED achievement unlock // GOING_ROGUE
ENDIF

PRINT_BIG C_FAIL 5000 5
PRINT_WITH_NUMBER_BIG C_KILLS total_criminals_killed 6000 6
CLEAR_ONSCREEN_TIMER cop_time_limit
CLEAR_ONSCREEN_COUNTER total_criminals_killed
REMOVE_BLIP criminal_blip
CLEAR_HELP
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SENTINEL
MARK_MODEL_AS_NO_LONGER_NEEDED car_model

IF criminal_created_flag = 1
	MARK_CHAR_AS_NO_LONGER_NEEDED criminal
	criminal_created_flag = 0
ENDIF

flag_player_on_mission = 0
flag_player_on_cop_mission = 0
MISSION_HAS_FINISHED
RETURN

	   		
	
copcar_cancelled_checks:////////////////////////////////////////////////////////////////

IF NOT IS_PLAYER_IN_MODEL player CAR_POLICE
AND NOT IS_PLAYER_IN_MODEL player CAR_ENFORCER
AND NOT IS_PLAYER_IN_MODEL player CAR_RHINO
AND NOT IS_PLAYER_IN_MODEL player CAR_FBI
	IF game_time_flag = 0
		GET_GAME_TIMER game_timer_start
		IF cop_time_limit > 60000 
			copcar_timer = 60000
		ELSE
			copcar_timer = cop_time_limit
		ENDIF 
		game_time_flag = 1
	ENDIF
	GET_GAME_TIMER game_time_present
	game_time_difference = game_time_present - game_timer_start
	copcar_timer -= game_time_difference
	game_timer_start = game_time_present
	timer_in_secs = copcar_timer / 1000
	PRINT_WITH_NUMBER_NOW COPCART timer_in_secs 200 1	//You have ~1~ seconds to return to a squad car before the mission ends.
	IF timer_in_secs < 1 
		PRINT_NOW C_TIME 3000 1//"Your time as a law enforcer is over!"
		copcar_cancelled_flag = 1
		RETURN
	ENDIF
ENDIF

IF IS_PLAYER_IN_MODEL player CAR_POLICE
OR IS_PLAYER_IN_MODEL player CAR_ENFORCER
OR IS_PLAYER_IN_MODEL player CAR_RHINO
OR IS_PLAYER_IN_MODEL player CAR_FBI
	
	IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
		mission_end_button = 1
	ENDIF
	
	game_time_flag = 0
ENDIF

IF mission_end_button = 1
	
	IF NOT IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
		PRINT_NOW C_CANC 3000 1//"Police mission cancelled!"
		copcar_cancelled_flag = 1
		RETURN
	ENDIF
	
ENDIF

RETURN///////////////////////////////////////////////////////////////////////////////////

		


MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************CRRRRRAZY TAXI****************************************
// *******************************LETS MAKE SOME CRRRRRAZY MONEY!*****************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff

GOSUB mission_start_taxi1

GOSUB mission_cleanup_taxi1

MISSION_END


// Variables for mission

VAR_INT blip1_ct1 blip2_ct1 spray_blip_onscreen  

VAR_INT taxi_car1 taxi_countdown_already_started

VAR_INT taxi_ped1 taxi_passed_this_shot taxi_fucked_flag

//VAR_INT special_ped1 

VAR_INT taxi_countdown taxi_score taxi_distance_int taxi_distance_int_old

VAR_INT taxi_finish_time taxi_start_time total_taxi_time_taken 

VAR_FLOAT taxi_destx1 taxi_desty1 taxi_destz1
VAR_FLOAT taxi_destx2 taxi_desty2 taxi_destz2
VAR_FLOAT taxi_blipx taxi_blipy taxi_blipz 

VAR_FLOAT taxi_ped_x taxi_ped_y taxi_ped_z
VAR_FLOAT x_diff y_diff x_diff_sq y_diff_sq taxi_distance_sq taxi_distance 
VAR_INT score_for_this_fare	speedbonus in_a_row_cash in_a_row_number
VAR_INT previous_taxi_dropoff_ped

// ***************************************Mission Start*************************************

mission_start_taxi1:

SCRIPT_NAME	TAXI

SET_DEATHARREST_STATE OFF // GSW - does deatharrest have to be switched off?  YES! well maybe...

flag_player_on_mission = 1
taxi_countdown_already_started = 0
taxi_countdown = 0
taxi_passed_this_shot = 0
taxi_score = 0
taxi_ped1 = -1
spray_blip_onscreen = 0
taxi_fucked_flag = 0
in_a_row_number = 5
in_a_row_cash = 2000
previous_taxi_dropoff_ped = -1

WAIT 0

DISPLAY_ONSCREEN_COUNTER_WITH_STRING taxi_passed_this_shot COUNTER_DISPLAY_NUMBER (FARES) //TEST STUFF!!!!!!!!!!!!!

IF NOT IS_PLAYER_PLAYING player
	GOTO mission_taxi1_failed
ENDIF

IF IS_PLAYER_IN_ANY_CAR player
	STORE_CAR_PLAYER_IS_IN player taxi_car1
ELSE
	GOTO mission_taxi1_failed
ENDIF

//SWITCH_TAXI_TIMER ON
SET_TAXI_LIGHTS taxi_car1 On
PRINT_NOW ( TAXI1 ) 1500 1 //Pick up a fare
//WAIT 1500

// the radar will path all over the place if we dont stop it at the road
//DISPLAY_RADAR 4 // HACKED RADAR STOP AT ROAD

WAIT 0

Start_taxi_mission:

// 3master - ALL VIGILANTE MISSIONS SHOULD HAVE NO PATHING
DISPLAY_RADAR 2 // PATHING OFF ///////////////////////////
//////////////////////////////////////////////////////////

IF done_taxi_help = 0
	PRINT_HELP ( TAXIH1 )
	done_taxi_help = 1
ENDIF

score_for_this_fare = 0

IF NOT IS_PLAYER_PLAYING player
	GOTO mission_taxi1_failed
ENDIF

IF IS_CAR_DEAD taxi_car1
	GOTO mission_taxi1_failed
ENDIF

IF NOT IS_PLAYER_IN_CAR player taxi_car1
	GOTO mission_taxi1_failed
ENDIF

/*
IF taxi_passed = 0	   				//SPECIAL MISSIONS???
AND IS_PLAYER_IN_ZONE player REDLIGH
	GOTO special_ped_mission1
ENDIF
*/


	IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
	AND flag_player_on_mission = 1
		GOTO taxi_fail_button_pressed
	ENDIF
		
	IF taxi_countdown_already_started = 1
	AND taxi_countdown = 0
		//PRINT_NOW ( TAXI2 ) 5000 2 //You SUCK!
		GOTO mission_taxi1_failed
	ENDIF
random_ped_grabber:

IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL 
	GET_RANDOM_CHAR_IN_ZONE IND_ZON taxi_ped1
	IF NOT IS_CHAR_DEAD taxi_ped1
		IF IS_CHAR_IN_AREA_2D taxi_ped1 914.0 -750.0 1005.0 -674.00 FALSE // GS-SC: Prevent ped from being identified in inaccessible car area in Chinatown
		OR IS_CHAR_IN_AREA_2D taxi_ped1 1160.0 -114.0 1190.0 -98.00 FALSE // Same fix to top of AM Fuel Station in Portland
		OR IS_CHAR_IN_AREA_2D taxi_ped1 909.0 -908.0 989.0 -829.0 FALSE // Chinatown Park
		OR IS_CHAR_IN_AREA_2D taxi_ped1 1065.0 -414.0 1116.0 -404.0 FALSE // Footpath next to Ammo Nation in Portland
		OR IS_CHAR_IN_AREA_2D taxi_ped1 1006.0 -345.0 1036.0 -180.0 FALSE // Long park across from Ammo Nation in Portland
			GOTO random_ped_grabber
		ENDIF
	ENDIF
ENDIF
   
IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL 
	GET_RANDOM_CHAR_IN_ZONE COM_ZON taxi_ped1

	IF NOT IS_CHAR_DEAD taxi_ped1
		IF IS_CHAR_IN_AREA_2D taxi_ped1 914.0 -750.0 1005.0 -674.00 FALSE 
		OR IS_CHAR_IN_AREA_2D taxi_ped1 1160.0 -114.0 1190.0 -98.00 FALSE
		OR IS_CHAR_IN_AREA_2D taxi_ped1 909.0 -908.0 989.0 -829.0 FALSE // Chinatown Park
		OR IS_CHAR_IN_AREA_2D taxi_ped1 1065.0 -414.0 1116.0 -404.0 FALSE // Footpath next to Ammo Nation in Portland
		OR IS_CHAR_IN_AREA_2D taxi_ped1 1006.0 -345.0 1036.0 -180.0 FALSE // Long park across from Ammo Nation in Portland
			GOTO random_ped_grabber
		ENDIF
	ENDIF
ENDIF

IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN 
	GET_RANDOM_CHAR_IN_ZONE SUB_ZON taxi_ped1

	IF NOT IS_CHAR_DEAD taxi_ped1
		IF IS_CHAR_IN_AREA_2D taxi_ped1 914.0 -750.0 1005.0 -674.00 FALSE
		OR IS_CHAR_IN_AREA_2D taxi_ped1 1160.0 -114.0 1190.0 -98.00 FALSE
		OR IS_CHAR_IN_AREA_2D taxi_ped1 909.0 -908.0 989.0 -829.0 FALSE // Chinatown Park
		OR IS_CHAR_IN_AREA_2D taxi_ped1 1065.0 -414.0 1116.0 -404.0 FALSE // Footpath next to Ammo Nation in Portland
		OR IS_CHAR_IN_AREA_2D taxi_ped1 1006.0 -345.0 1036.0 -180.0 FALSE // Long park across from Ammo Nation in Portland
			GOTO random_ped_grabber
		ENDIF
	ENDIF
ENDIF
//IF IS_PLAYER_IN_ZONE player SUB_ZON 
//	GET_RANDOM_CHAR_IN_ZONE IND_ZON taxi_ped1
//ENDIF

// make sure we dont immediately choose the guy we just dropped off
IF taxi_ped1 = previous_taxi_dropoff_ped
	WAIT 0
	GOTO Start_taxi_mission		//	random_ped_grabber
ENDIF

IF taxi_ped1 = -1
	WAIT 0
	GOTO Start_taxi_mission		//	random_ped_grabber
ENDIF

											   
//been_in_taxi1_before = 7

// START OF TAXI MISSION
	
	CHAR_SET_IDLE taxi_ped1
	CLEAR_CHAR_THREAT_SEARCH taxi_ped1
	SET_CHAR_HEED_THREATS taxi_ped1 False
	ADD_BLIP_FOR_CHAR taxi_ped1 blip1_ct1
	SET_CHAR_OBJ_HAIL_TAXI taxi_ped1

	//PRINT_NOW ( TAXI1 ) 2000 2 //Pick up a fare

ped_get_in_taxi:

WHILE NOT LOCATE_PLAYER_IN_CAR_CHAR_3D Player taxi_ped1 7.0 7.0 2.0 FALSE //IF CLOSE TO THE CHAR
OR NOT IS_CAR_STOPPED taxi_car1
//	OR NOT IS_PLAYER_IN_CAR player taxi_car1 

 WAIT 0

	IF NOT IS_PLAYER_PLAYING player	// ok to fail if player is arrested?
		GOTO mission_taxi1_failed
	ENDIF

	IF IS_CAR_DEAD taxi_car1
		GOTO mission_taxi1_failed
	ENDIF

	IF IS_CHAR_DEAD taxi_ped1
		GOTO mission_taxi1_passed
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player taxi_car1	    
		GOTO mission_taxi1_failed				
	ENDIF
	
	IF NOT LOCATE_PLAYER_IN_CAR_CHAR_3D Player taxi_ped1 90.0 90.0 20.0 FALSE
		GOTO mission_taxi1_passed
	ENDIF 

	IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
	AND flag_player_on_mission = 1
		GOTO taxi_fail_button_pressed
	ENDIF
	
	IF taxi_countdown_already_started = 1
	AND taxi_countdown = 0
		//PRINT_NOW ( TAXI2 ) 5000 2 //You SUCK!
		GOTO mission_taxi1_failed
	ENDIF

	IF IS_CAR_HEALTH_GREATER taxi_car1 500
	AND spray_blip_onscreen = 1
		REMOVE_BLIP spray_taxi
		spray_blip_onscreen = 0
		taxi_fucked_flag = 0
	ENDIF

	IF NOT IS_CHAR_DEAD taxi_ped1
		TURN_CHAR_TO_FACE_PLAYER taxi_ped1 Player
	ENDIF

ENDWHILE


IF NOT IS_CAR_HEALTH_GREATER taxi_car1 500
	PRINT_NOW ( TAXI7 ) 4000 1 //I ain't getting in that heap of shit!!
	IF spray_blip_onscreen = 0
		REMOVE_BLIP spray_taxi
		IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL 
			ADD_SPRITE_BLIP_FOR_COORD 925.0 -359.5 -100.0 RADAR_SPRITE_SPRAY spray_taxi
		ENDIF
		IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
			ADD_SPRITE_BLIP_FOR_COORD 379.0 -493.8 -100.0 RADAR_SPRITE_SPRAY spray_taxi
		ENDIF
		IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
			ADD_SPRITE_BLIP_FOR_COORD -1128.0 32.5.8 -100.0 RADAR_SPRITE_SPRAY spray_taxi
		ENDIF
		spray_blip_onscreen = 1
		taxi_fucked_flag = 1
	ENDIF
	GOTO mission_taxi1_passed
ENDIF

SET_CHAR_RUNNING taxi_ped1 TRUE
SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER taxi_ped1 taxi_car1	
	

WHILE NOT IS_CHAR_IN_CAR taxi_ped1 taxi_car1 
	WAIT 0

		IF NOT IS_PLAYER_PLAYING player
			GOTO mission_taxi1_failed
		ENDIF

		IF IS_CAR_DEAD taxi_car1
			GOTO mission_taxi1_failed
		ENDIF

	 	IF IS_CHAR_DEAD taxi_ped1
			GOTO mission_taxi1_passed
		ENDIF

		IF NOT IS_PLAYER_IN_CAR player taxi_car1	    
			GOTO mission_taxi1_failed				
		ENDIF

		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_3D Player taxi_ped1 90.0 90.0 20.0 FALSE
			GOTO mission_taxi1_passed
		ENDIF

		IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
		AND flag_player_on_mission = 1
			GOTO taxi_fail_button_pressed
		ENDIF
		
		IF taxi_countdown_already_started = 1
		AND taxi_countdown = 0
			//PRINT_NOW ( TAXI2 ) 5000 2 //You SUCK!
			GOTO mission_taxi1_failed
		ENDIF

		IF IS_CAR_HEALTH_GREATER taxi_car1 500
		AND spray_blip_onscreen = 1
			REMOVE_BLIP spray_taxi
			spray_blip_onscreen = 0
		ENDIF

		IF NOT LOCATE_PLAYER_IN_CAR_CHAR_3D Player taxi_ped1 7.0 7.0 2.0 FALSE
			GOTO ped_get_in_taxi
		ENDIF		

ENDWHILE

GET_CHAR_COORDINATES taxi_ped1 taxi_ped_x taxi_ped_y taxi_ped_z

REMOVE_BLIP blip1_ct1
SET_TAXI_LIGHTS taxi_car1 Off

//GET_GAME_TIMER taxi_start_time

passenger_destination:

WAIT 0

	IF NOT IS_PLAYER_PLAYING player
		GOTO mission_taxi1_failed
	ENDIF

	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL //INDUSTRIAL*******************************************
	//OR IS_PLAYER_IN_ZONE player SUB_ZON

		GENERATE_RANDOM_INT_IN_RANGE 1 11 been_in_taxi1_before
		
		IF NOT IS_PLAYER_PLAYING player
			GOTO mission_taxi1_failed
		ENDIF

		IF been_in_taxi1_before = 1
				IF IS_PLAYER_IN_ZONE player REDLIGH
					GOTO passenger_destination
				ENDIF	
			PRINT_NOW ( FARE1 ) 5000 1 //Take me to Meeouch Sex Kitten Club

			taxi_destx1 = 936.3
			taxi_desty1 = -462.6
			taxi_destz1 = 14.4

			taxi_destx2 = 913.7
			taxi_desty2 = -456.0
			taxi_destz2 = 16.4
		ENDIF

		IF been_in_taxi1_before = 2
				IF IS_PLAYER_IN_ZONE player S_VIEW				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE2 ) 5000 1 //Take me to Supa Save

			taxi_destx1 = 1268.5
			taxi_desty1 = -616.4
			taxi_destz1 = 11.7

			taxi_destx2 = 1288.3
			taxi_desty2 = -627.6
			taxi_destz2 = 13.7
		ENDIF

		IF been_in_taxi1_before = 3
				IF IS_PLAYER_IN_ZONE player CHINA				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE3 ) 5000 1 //Take me to the old School hall

			taxi_destx1 = 1008.9
			taxi_desty1 = -871.9
			taxi_destz1 = 14.4

			taxi_destx2 = 995.3
			taxi_desty2 = -881.9
			taxi_destz2 = 16.4
		ENDIF

		IF been_in_taxi1_before = 4
				IF IS_PLAYER_IN_ZONE player PORT_W				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE4 ) 5000 1 //Take me to greasy Joes

			taxi_destx1 = 849.3
			taxi_desty1 = -990.1
			taxi_destz1 = 4.5

			taxi_destx2 = 869.4
			taxi_desty2 = -1002.6
			taxi_destz2 = 6.5
		ENDIF

		IF been_in_taxi1_before = 5
				IF IS_PLAYER_IN_ZONE player REDLIGH				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE5 ) 5000 1 //Take me to Ammo Nation

			taxi_destx1 = 1065.4
			taxi_desty1 = -394.1
			taxi_destz1 = 14.3

			taxi_destx2 = 1057.9
			taxi_desty2 = -408.9
			taxi_destz2 = 16.3
		ENDIF

		IF been_in_taxi1_before = 6
				IF IS_PLAYER_IN_ZONE player LITTLEI				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE6 ) 5000 1 //Take me to Easy Credit Autos

			taxi_destx1 = 1207.0
			taxi_desty1 = -122.0
			taxi_destz1 = 14.0

			taxi_destx2 = 1224.0
			taxi_desty2 = -108.0
			taxi_destz2 = 16.0
		ENDIF							   

		IF been_in_taxi1_before = 7
				IF IS_PLAYER_IN_ZONE player REDLIGH				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE7 ) 5000 1 //Take us to Woodys topless bar

			taxi_destx1 = 912.9
			taxi_desty1 = -419.0
			taxi_destz1 = 14.0

			taxi_destx2 = 919.5
			taxi_desty2 = -401.3
			taxi_destz2 = 16.0
		ENDIF

		IF been_in_taxi1_before = 8
				IF IS_PLAYER_IN_ZONE player LITTLEI				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE8 ) 5000 1 //Take me to The Bistro

			taxi_destx1 = 1345.8
			taxi_desty1 = -461.8
			taxi_destz1 = 49.4

			taxi_destx2 = 1334.7
			taxi_desty2 = -447.0
			taxi_destz2 = 51.4
		ENDIF

		IF been_in_taxi1_before = 9
				IF IS_PLAYER_IN_ZONE player PORT_E				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE9 ) 5000 1 //Take me to the Import/Export garage

			taxi_destx1 = 1475.0
			taxi_desty1 = -686.0
			taxi_destz1 = 11.3

			taxi_destx2 = 1485.3
			taxi_desty2 = -667.5
			taxi_destz2 = 13.3
		ENDIF

		IF been_in_taxi1_before = 10
				IF IS_PLAYER_IN_ZONE player CHINA				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE10 ) 5000 1 //Take me to the 'Punk Noodles'

			taxi_destx1 = 1039.1
			taxi_desty1 = -660.1
			taxi_destz1 = 14.4

			taxi_destx2 = 1043.9
			taxi_desty2 = -647.9
			taxi_destz2 = 16.4
		ENDIF
	ENDIF 


	IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL //COMERCIAL*******************************************
	//OR IS_PLAYER_IN_ZONE player SUB_ZON

		GENERATE_RANDOM_INT_IN_RANGE 11 21 been_in_taxi1_before

		IF NOT IS_PLAYER_PLAYING player
			GOTO mission_taxi1_failed
		ENDIF

		IF been_in_taxi1_before = 11
				IF IS_PLAYER_IN_ZONE player CONSTRU
					GOTO passenger_destination
				ENDIF	
			PRINT_NOW ( FARE11 ) 5000 1 //Take me to the constuction site

			taxi_destx1 = 441.86	   
			taxi_desty1 = -193.00
			taxi_destz1 = 20.36

			taxi_destx2 = 447.42 
			taxi_desty2 = -201.93 
			taxi_destz2 = 22.21
		ENDIF

		IF been_in_taxi1_before = 12
				IF IS_PLAYER_IN_ZONE player STADIUM				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE12 ) 5000 1 //Take me to the stadium 

			taxi_destx1 = -27.05   
			taxi_desty1 = -269.61 
			taxi_destz1 = 14.95

			taxi_destx2 = -11.73 
			taxi_desty2 = -278.88 
			taxi_destz2 = 16.93
		ENDIF

		IF been_in_taxi1_before = 13
				IF IS_PLAYER_IN_ZONE player SHOPING				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE13 ) 5000 1 //Take me to the Church 

			taxi_destx1 = 22.07   
			taxi_desty1 = -1136.95 
			taxi_destz1 = 25.14

			taxi_destx2 = 28.95 
			taxi_desty2 = -1125.66 
			taxi_destz2 = 27.12
		ENDIF

		IF been_in_taxi1_before = 14
				IF IS_PLAYER_IN_ZONE player YAKUSA				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE14 ) 5000 1 //Casino  

			taxi_destx1 = 421.42   
			taxi_desty1 = -1390.83 
			taxi_destz1 = 24.95

			taxi_destx2 = 415.45 
			taxi_desty2 = -1401.24 
			taxi_destz2 = 26.92
		ENDIF

		IF been_in_taxi1_before = 15
				IF IS_PLAYER_IN_ZONE player UNIVERS				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE15 ) 5000 1 //Uni 

			taxi_destx1 = 183.15   
			taxi_desty1 = -215.50 
			taxi_destz1 = 17.02

			taxi_destx2 = 167.21 
			taxi_desty2 = -221.22 
			taxi_destz2 = 19.29
		ENDIF

		IF been_in_taxi1_before = 16
				IF IS_PLAYER_IN_ZONE player PARK				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE16 ) 5000 1 //Shopping Mall 

			taxi_destx1 = 193.77   
			taxi_desty1 = -626.22 
			taxi_destz1 = 25.12

			taxi_destx2 = 180.83 
			taxi_desty2 = -616.51 
			taxi_destz2 = 27.12
		ENDIF							   

		IF been_in_taxi1_before = 17
				IF IS_PLAYER_IN_ZONE player COM_EAS				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE17 ) 5000 1 //Museum 

			taxi_destx1 = 326.1   
			taxi_desty1 = -1001.7 
			taxi_destz1 = 29.05

			taxi_destx2 = 316.3 
			taxi_desty2 = -1012.4 
			taxi_destz2 = 24.44
		ENDIF

		IF been_in_taxi1_before = 18
				IF IS_PLAYER_IN_ZONE player YAKUSA				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE18 ) 5000 1 //(AMco) 

			taxi_destx1 = 246.20 
			taxi_desty1 = -1192.75   
			taxi_destz1 = 24.71

			taxi_destx2 = 256.67 
			taxi_desty2 = -1184.17 
			taxi_destz2 = 26.71
		ENDIF

		IF been_in_taxi1_before = 19
				IF IS_PLAYER_IN_ZONE player SHOPING				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE19 ) 5000 1 //Bolt Burgers 

			taxi_destx1 = 28.69  
			taxi_desty1 = -1066.66 
			taxi_destz1 = 26.72

			taxi_destx2 = 34.07 
			taxi_desty2 = -1078.96 
			taxi_destz2 = 24.97
		ENDIF

		IF been_in_taxi1_before = 20
				IF IS_PLAYER_IN_ZONE player PARK				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE20 ) 5000 1 //Take me to the park  

			taxi_destx1 = 27.56  
			taxi_desty1 = -776.42 
			taxi_destz1 = 26.26

			taxi_destx2 = 38.79 
			taxi_desty2 = -765.06 
			taxi_destz2 = 28.57
		ENDIF
	ENDIF 


	IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN //SUBURBIA*******************************************

		GENERATE_RANDOM_INT_IN_RANGE 21 27  been_in_taxi1_before

		IF NOT IS_PLAYER_PLAYING player
			GOTO mission_taxi1_failed
		ENDIF

		IF been_in_taxi1_before = 21
				IF IS_PLAYER_IN_ZONE player AIRPORT
					GOTO passenger_destination
				ENDIF	
			PRINT_NOW ( FARE21 ) 5000 1 //Take me to the Airport

			taxi_destx1 = -744.5	   
			taxi_desty1 = -598.6
			taxi_destz1 = 8.0

			taxi_destx2 = -752.0 
			taxi_desty2 = -617.2 
			taxi_destz2 = 15.0
		ENDIF
		
		IF been_in_taxi1_before = 22
				IF IS_PLAYER_IN_ZONE player BIG_DAM				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE22 ) 5000 1 //Take me to the DAM 

			taxi_destx1 = -1111.3   
			taxi_desty1 = 522.9 
			taxi_destz1 = 65.0

			taxi_destx2 = -1101.0 
			taxi_desty2 = 516.7 
			taxi_destz2 = 70.0
		ENDIF

		IF been_in_taxi1_before = 23
				IF IS_PLAYER_IN_ZONE player SUB_IND				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE23 ) 5000 1 //Take me to the Import/Export garage 

			taxi_destx1 = -1107.9   
			taxi_desty1 = 163.5 
			taxi_destz1 = 50.0

			taxi_destx2 = -1115.4 
			taxi_desty2 = 155.6 
			taxi_destz2 = 68.0
		ENDIF
		
		IF been_in_taxi1_before = 24
				IF IS_PLAYER_IN_ZONE player SUB_IND				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE24 ) 5000 1 //Take me to the Hospital 

			taxi_destx1 = -1253.0   
			taxi_desty1 = -136.6 
			taxi_destz1 = 55.0

			taxi_destx2 = -1260.3 
			taxi_desty2 = -148.4 
			taxi_destz2 = 62.0
		ENDIF
		
		IF been_in_taxi1_before = 25
				IF IS_PLAYER_IN_ZONE player SUB_ZO2
				OR IS_PLAYER_IN_ZONE player SUB_ZO3				
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE25 ) 5000 1 //Park 

			taxi_destx1 = -230.1   
			taxi_desty1 = 311.5 
			taxi_destz1 = 0.0

			taxi_destx2 = -220.2 
			taxi_desty2 = 322.5 
			taxi_destz2 = 10.0
		ENDIF

		IF been_in_taxi1_before = 26
				IF IS_PLAYER_IN_ZONE player PROJECT
				OR IS_PLAYER_IN_ZONE player SWANKS
					GOTO passenger_destination
				ENDIF
			PRINT_NOW ( FARE26 ) 5000 1 //Projects 

			taxi_destx1 = -682.5   
			taxi_desty1 = 95.3 
			taxi_destz1 = 10.0

			taxi_destx2 = -673.0 
			taxi_desty2 = 88.4 
			taxi_destz2 = 25.0
		ENDIF


	ENDIF
	 

	taxi_blipx = taxi_destx1 + taxi_destx2
	taxi_blipx /= 2.0

	taxi_blipy = taxi_desty1 + taxi_desty2
	taxi_blipy /= 2.0

	ADD_BLIP_FOR_COORD taxi_blipx taxi_blipy -100.0 blip2_ct1
	CHANGE_BLIP_DISPLAY blip2_ct1 BLIP_ONLY


IF IS_CAR_DEAD taxi_car1
	GOTO mission_taxi1_failed
ENDIF

x_diff = taxi_ped_x - taxi_blipx
y_diff = taxi_ped_y - taxi_blipy

x_diff_sq = x_diff * x_diff
y_diff_sq = y_diff * y_diff

taxi_distance_sq = x_diff_sq + y_diff_sq
SQRT taxi_distance_sq taxi_distance
taxi_distance_int =# taxi_distance
taxi_distance_int_old = taxi_distance_int 


IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
	IF taxi_passed_this_shot = 0
		taxi_distance_int = taxi_distance_int * 100
	ENDIF
ENDIF

IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
	IF taxi_passed_this_shot = 0
		taxi_distance_int = taxi_distance_int * 95
	ENDIF
ENDIF

IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	IF taxi_passed_this_shot = 0
		taxi_distance_int = taxi_distance_int * 115
	ENDIF
ENDIF

	IF taxi_passed_this_shot = 1
		taxi_distance_int = taxi_distance_int * 90
	ENDIF

	IF taxi_passed_this_shot = 2
		taxi_distance_int = taxi_distance_int * 85
	ENDIF

	IF taxi_passed_this_shot = 3
		taxi_distance_int = taxi_distance_int * 84
	ENDIF

	IF taxi_passed_this_shot = 4
		taxi_distance_int = taxi_distance_int * 83
	ENDIF

	IF taxi_passed_this_shot = 5
		taxi_distance_int = taxi_distance_int * 82
	ENDIF

	IF taxi_passed_this_shot > 5
	AND	taxi_passed_this_shot <= 10
	   taxi_distance_int = taxi_distance_int * 80
	ENDIF

	IF taxi_passed_this_shot > 11
	AND	taxi_passed_this_shot <= 20
	   taxi_distance_int = taxi_distance_int * 75
	ENDIF

	IF taxi_passed_this_shot > 20
	AND	taxi_passed_this_shot <= 50
	   taxi_distance_int = taxi_distance_int * 70
	ENDIF

	IF taxi_passed_this_shot > 50
	   taxi_distance_int = taxi_distance_int * 60
	ENDIF

taxi_countdown = taxi_countdown + taxi_distance_int

speedbonus = taxi_distance_int
speedbonus = speedbonus / 100
speedbonus = speedbonus * 65
{ 
TIMERB = 0

IF taxi_countdown_already_started = 0
	DISPLAY_ONSCREEN_TIMER taxi_countdown
	taxi_countdown_already_started = 1
ENDIF


IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN //SUBURBIA*******************************************
	IF taxi_passed_this_shot = 0
		taxi_countdown = taxi_countdown + 15000
	ENDIF
ELSE
	IF taxi_passed_this_shot = 0
		taxi_countdown = taxi_countdown + 10000
	ENDIF
ENDIF

WHILE NOT IS_CAR_STOPPED_IN_AREA_3D taxi_car1 taxi_destx1 taxi_desty1 taxi_destz1 taxi_destx2 taxi_desty2 taxi_destz2 TRUE
	WAIT 0 

		IF NOT IS_PLAYER_PLAYING player
			GOTO mission_taxi1_failed
		ENDIF

		IF IS_CAR_DEAD taxi_car1
			GOTO mission_taxi1_failed
		ENDIF

		IF NOT IS_PLAYER_IN_CAR player taxi_car1	    
			GOTO mission_taxi1_failed				
		ENDIF

		IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
		AND flag_player_on_mission = 1
			GOTO taxi_fail_button_pressed
		ENDIF
		
		IF taxi_countdown = 0
			GOTO taxi_out_of_time
		ENDIF

		IF NOT IS_CAR_HEALTH_GREATER taxi_car1 500
			IF spray_blip_onscreen = 0
				REMOVE_BLIP spray_taxi
				IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL 
					ADD_SPRITE_BLIP_FOR_COORD 925.0 -359.5 -100.0 RADAR_SPRITE_SPRAY spray_taxi
				ENDIF
				IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
					ADD_SPRITE_BLIP_FOR_COORD 379.0 -493.8 -100.0 RADAR_SPRITE_SPRAY spray_taxi
				ENDIF
				IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
					ADD_SPRITE_BLIP_FOR_COORD -1128.0 32.5.8 -100.0 RADAR_SPRITE_SPRAY spray_taxi
				ENDIF
				spray_blip_onscreen = 1
				GOSUB taxi_fucked
				GOTO mission_taxi1_passed 
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD taxi_car1
			IF IS_CAR_HEALTH_GREATER taxi_car1 500
			AND spray_blip_onscreen = 1
				REMOVE_BLIP spray_taxi
				spray_blip_onscreen = 0
				taxi_fucked_flag = 0
			ENDIF
		ENDIF

		IF IS_CAR_UPSIDEDOWN taxi_car1
		AND IS_CAR_STOPPED taxi_car1
			GOTO taxi_fucked
		ENDIF

ENDWHILE


score: 

IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN //SUBURBIA*******************************************
							  
	IF TIMERB > speedbonus
		score_for_this_fare = taxi_distance_int_old 
		PRINT_BIG ( TAXI4 ) 5000 5 //Fare delivered
	ELSE
		score_for_this_fare = taxi_distance_int_old	* 2
		PRINT_BIG ( TAXI5 ) 5000 5 //Speed Bonus!!
	ENDIF

ELSE

	IF TIMERB > speedbonus
		score_for_this_fare = taxi_distance_int_old / 2
		PRINT_BIG ( TAXI4 ) 5000 5 //Fare delivered
	ELSE
		score_for_this_fare = taxi_distance_int_old
		PRINT_BIG ( TAXI5 ) 5000 5 //Speed Bonus!!
	ENDIF

ENDIF

}
//score_for_this_fare = taxi_distance_int_old

	
	ADD_SCORE player score_for_this_fare
	PRINT_WITH_NUMBER_BIG ( TSCORE2 ) score_for_this_fare 6000 6 //Your score is...
	ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_PART_MISSION_COMPLETE
	taxi_score = taxi_score + score_for_this_fare

	taxi_passed ++
	REGISTER_PASSENGER_DROPPED_OFF_TAXI
	taxi_passed_this_shot ++
					   
	//CREATE NEW TAXI AFTER COMPLETING 100 TAXI MISSIONS 
	IF new_taxi_created_before = 0
	AND taxi_passed = 100
		ADD_PAGER_MESSAGE ( NEW_TAX ) 140 2 0
  		SWITCH_CAR_GENERATOR swank_taxi 101
		PLAYER_MADE_PROGRESS 1
  		new_taxi_created_before = 1 							
	ENDIF

	taxi_countdown = taxi_countdown + 10000

	GOSUB mission_taxi1_failed

	IF taxi_passed_this_shot = in_a_row_number
		PRINT_WITH_2_NUMBERS_BIG ( IN_ROW ) taxi_passed_this_shot in_a_row_cash 5000 6 //Bonus!
		ADD_SCORE player in_a_row_cash
		taxi_score = taxi_score + in_a_row_cash
		in_a_row_number = in_a_row_number + 5
		in_a_row_cash = in_a_row_cash + 2000
	ENDIF

	/*
	IF taxi_passed_this_shot = 10
		PRINT_WITH_2_NUMBERS_BIG  ( IN_ROW ) taxi_passed_this_shot 2000 6000 6 //Bonus!
		taxi_score = taxi_score + 2000
		ADD_SCORE player 1000
	ENDIF

	IF taxi_passed_this_shot = 15
		PRINT_WITH_2_NUMBERS_BIG  ( IN_ROW ) taxi_passed_this_shot 4000 6000 6 //Bonus!
		taxi_score = taxi_score + 4000
		ADD_SCORE player 2000
	ENDIF

	IF taxi_passed_this_shot = 20
		PRINT_WITH_2_NUMBERS_BIG  ( IN_ROW ) taxi_passed_this_shot 8000 6000 6 //Bonus!
		taxi_score = taxi_score + 8000
		ADD_SCORE player 4000
	ENDIF

	IF taxi_passed_this_shot = 25
		PRINT_WITH_2_NUMBERS_BIG  ( IN_ROW ) taxi_passed_this_shot 16000 6000 6 //Bonus!
		taxi_score = taxi_score + 16000
		ADD_SCORE player 8000
	ENDIF

 	IF taxi_passed_this_shot = 30
		PRINT_WITH_2_NUMBERS_BIG  ( IN_ROW ) taxi_passed_this_shot 32000 6000 6 //Bonus!
		taxi_score = taxi_score + 32000
		ADD_SCORE player 16000
	ENDIF
	*/
	GOTO mission_taxi1_passed


//Taxi_fail_conditions

taxi_out_of_time:

	PRINT_NOW ( TAXI2 ) 5000 1 //Out of time

	GOTO mission_taxi1_failed

taxi_fucked:

	WAIT 0

	PRINT_NOW ( TAXI3 ) 5000 1 //Taxi is trashed

		IF NOT IS_CHAR_DEAD	taxi_ped1
			//SET_CHAR_PERSONALITY taxi_ped1 PEDSTAT_TOURIST
			SET_CHAR_OBJ_FLEE_ON_FOOT_TILL_SAFE taxi_ped1
			//SET_CHAR_THREAT_SEARCH taxi_ped1 THREAT_PLAYER1
		ENDIF
		taxi_fucked_flag = 1

	GOTO mission_taxi1_failed


taxi_fail_button_pressed:
	
	WHILE IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
		WAIT 0
		IF NOT IS_PLAYER_PLAYING player	// ok to fail if player is arrested?
			GOTO mission_taxi1_failed
		ENDIF
	ENDWHILE
	
	GOTO mission_taxi1_failed


// Mission taxi1 failed
/*
mission_taxi1_failed: 

GOSUB taxi_ped_leave

RETURN
*/
// mission taxi1 passed

mission_taxi1_passed:

	REMOVE_BLIP blip1_ct1
	REMOVE_BLIP blip2_ct1
	MARK_CHAR_AS_NO_LONGER_NEEDED taxi_ped1

	previous_taxi_dropoff_ped = taxi_ped1

	IF NOT IS_CAR_DEAD taxi_car1
		SET_TAXI_LIGHTS taxi_car1 On
	ENDIF

	//WAIT 1000
	WAIT 0
	PRINT_SOON ( TAXI1 ) 1500 1 //Pick up a fare
		
	GOTO Start_taxi_mission
RETURN
		
mission_taxi1_failed: //taxi_ped_leave:

	IF NOT IS_CHAR_DEAD taxi_ped1
		IF NOT IS_CAR_DEAD taxi_car1
			IF IS_CHAR_IN_CAR taxi_ped1 taxi_car1
				SET_CHAR_OBJ_LEAVE_CAR taxi_ped1 taxi_car1

				previous_taxi_dropoff_ped = taxi_ped1

				IF IS_PLAYER_PLAYING player
					SET_PLAYER_CONTROL Player OFF
				ENDIF

				WHILE IS_CHAR_IN_CAR taxi_ped1 taxi_car1
			 		WAIT 0

					IF IS_CHAR_DEAD taxi_ped1
					OR IS_CAR_DEAD taxi_car1
						GOTO taxi_ped_leave2
					ENDIF
						
					IF NOT IS_PLAYER_PLAYING player
						GOTO taxi_ped_leave2
					ENDIF

					IF NOT IS_PLAYER_IN_CAR player taxi_car1	    
						GOTO taxi_ped_leave2				
					ENDIF

					IF IS_BUTTON_PRESSED PAD1 RIGHTSHOCK
					AND flag_player_on_mission = 1
						GOTO taxi_ped_leave2
					ENDIF
					
				ENDWHILE

			ENDIF
		ENDIF
	ENDIF

IF IS_PLAYER_PLAYING player
	SET_PLAYER_CONTROL Player ON
ENDIF

IF taxi_fucked_flag = 1
	RETURN
ENDIF

taxi_ped_leave2:

	WAIT 0

	IF NOT IS_CHAR_DEAD taxi_ped1
		IF NOT IS_CAR_DEAD taxi_car1
			IF NOT IS_CHAR_IN_CAR taxi_ped1 taxi_car1
				CHAR_WANDER_DIR taxi_ped1 0
				MARK_CHAR_AS_NO_LONGER_NEEDED taxi_ped1
			ENDIF
		ENDIF
	ENDIF
	
	IF IS_PLAYER_PLAYING player
		SET_PLAYER_CONTROL Player ON
	ENDIF
	
RETURN

// mission cleanup

mission_cleanup_taxi1:

// reset radar mode
DISPLAY_RADAR 3 // HACKED RADAR ON

CLEAR_ONSCREEN_TIMER taxi_countdown
CLEAR_ONSCREEN_COUNTER taxi_passed_this_shot //TEST STUFF!!!!!!!!
IF NOT IS_CAR_DEAD taxi_car1
	SET_TAXI_LIGHTS taxi_car1 Off
ENDIF
//SWITCH_TAXI_TIMER OFF
REMOVE_BLIP blip1_ct1
REMOVE_BLIP blip2_ct1
REMOVE_BLIP spray_taxi
MARK_CHAR_AS_NO_LONGER_NEEDED taxi_ped1
PRINT_BIG ( TAXI6 ) 5000 5 //Taxi mission over
PRINT_WITH_NUMBER_BIG ( TSCORE ) taxi_score 6000 6 //Your score is...
REGISTER_MONEY_MADE_TAXI taxi_score
SET_DEATHARREST_STATE on
flag_player_on_mission = 0
flag_taxi1_mission_launched = 0
IF IS_PLAYER_PLAYING player
	SET_PLAYER_CONTROL Player ON
ENDIF
CLEAR_HELP
MISSION_HAS_FINISHED
RETURN

MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************
// ***********************************Meat Factory Mission 1**********************************
// *************************************"The Bank Manager"************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME meat1

// Mission Start Stuff

GOSUB mission_start_meat1

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_failed_meat1
	ENDIF

GOSUB mission_cleanup_meat1

MISSION_END


// Variable for mission

VAR_INT car_meat1

VAR_INT bankmanager_meat1

VAR_INT radar_blip_car_meat1

VAR_INT radar_blip_ped1_meat1

VAR_INT radar_blip_coord3_meat1

VAR_INT flag_player_had_car_message_meat1

VAR_INT radar_blip_coord2_meat1

VAR_INT flag_bankmanager_in_area

VAR_INT flag_car_crushed_meat1

VAR_INT flag_car_in_area_meat1

VAR_INT flag_leave_car_message_meat1

VAR_INT flag_dont_do_car_check_meat1

VAR_INT flag_player_had_crusher_help_hm5

VAR_INT flag_bankman_moved_meat1

// ****************************************Mission Start************************************

mission_start_meat1:

flag_player_on_mission = 1

flag_player_on_meat_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_player_had_car_message_meat1 = 0

flag_bankmanager_in_area = 0

flag_car_crushed_meat1 = 0

flag_car_in_area_meat1 = 0

flag_leave_car_message_meat1 = 0

flag_dont_do_car_check_meat1 = 0

blob_flag = 1

flag_player_had_crusher_help_hm5 = 0

flag_bankman_moved_meat1 = 0
{

// ******************************************START OF CUTSCENE******************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_failed_meat1
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( MEA1 ) 15000 2 //"THE CROOK"	 

SWITCH_STREAMING OFF

//LOAD_SPECIAL_MODEL cut_obj1 PLAYERH

WHILE GET_FADING_STATUS
					  
	WAIT 0

ENDWHILE
*/

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS 1164.25 -888.87 10.0 1291.76 -811.71 20.0

//LOAD_ALL_MODELS_NOW

//WHILE NOT HAS_MODEL_LOADED cut_obj1
//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE mt_ph1 
SET_CUTSCENE_OFFSET 1223.88 -839.414 13.95
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player


DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( MEA1_B ) 10000 1 //"The names Marty..." 

WHILE cs_time < 4424
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA1_C ) 10000 1  //"I run the..." 

WHILE cs_time < 7668
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA1_D ) 10000 1  //"I got money..." 

WHILE cs_time < 9604
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA1_E ) 10000 1 //"I'm meeting...." 

WHILE cs_time < 12652
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA1_F ) 10000 1 //"He's a crooked..." 

WHILE cs_time < 17740
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA1_G ) 10000 1  //Take my car..." 

WHILE cs_time < 21290
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA1_H ) 10000 1  //"I've got a..."

WHILE cs_time < 24535
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( MEA1_H ) 

WHILE cs_time < 25666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

WAIT 500

DO_FADE 1500 FADE_IN

//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

SET_PED_DENSITY_MULTIPLIER 1.0

// ******************************************END OF CUTSCENE********************************

REQUEST_MODEL PED_B_MAN1

REQUEST_MODEL CAR_PERENNIAL

LOAD_MISSION_AUDIO MF1_A

WHILE NOT HAS_MODEL_LOADED PED_B_MAN1
OR NOT HAS_MODEL_LOADED CAR_PERENNIAL
OR NOT HAS_MISSION_AUDIO_LOADED 

	WAIT 0

ENDWHILE

CREATE_CAR CAR_PERENNIAL 1190.0 -796.0 13.8 car_meat1

SET_CAR_HEADING car_meat1 300.0

ADD_BLIP_FOR_CAR car_meat1 radar_blip_car_meat1

// waiting for the player to get into the car

WHILE NOT IS_PLAYER_IN_CAR player car_meat1

	WAIT 0
		
	IF IS_CAR_DEAD car_meat1
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF
	
ENDWHILE

REMOVE_BLIP radar_blip_car_meat1

PRINT_NOW ( MEA1_B3 ) 7000 1 //"Go and meet the Bank Manager."

CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN1 1039.0 -695.0 13.9 bankmanager_meat1

CLEAR_CHAR_THREAT_SEARCH bankmanager_meat1

TURN_CHAR_TO_FACE_COORD bankmanager_meat1 1042.0 -695.0 -100.0

ADD_BLIP_FOR_CHAR bankmanager_meat1 radar_blip_ped1_meat1

SET_CHAR_CANT_BE_DRAGGED_OUT bankmanager_meat1 TRUE

// waiting for the player and the Bank manager to be in the same area

WHILE NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player bankmanager_meat1 8.0 8.0 FALSE
OR NOT IS_PLAYER_IN_CAR player car_meat1

	WAIT 0
			
	IF IS_CAR_DEAD car_meat1
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF
	
	IF IS_CHAR_DEAD bankmanager_meat1
		PRINT_NOW ( MEA1_1 ) 5000 1 //The Bank Managers dead!"
		GOTO mission_failed_meat1
	ENDIF
      
	IF NOT IS_PLAYER_IN_CAR player car_meat1
	AND flag_player_had_car_message_meat1 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat1 radar_blip_car_meat1
		REMOVE_BLIP radar_blip_ped1_meat1
		flag_player_had_car_message_meat1 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat1
	AND flag_player_had_car_message_meat1 = 1
		REMOVE_BLIP radar_blip_car_meat1
		ADD_BLIP_FOR_CHAR bankmanager_meat1 radar_blip_ped1_meat1
		flag_player_had_car_message_meat1 = 0
		blob_flag = 1
	ENDIF
	
ENDWHILE
 
// player is at the bank manager

SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER bankmanager_meat1 car_meat1

// waiting for them both to be in the car 

WHILE NOT IS_CHAR_IN_CAR bankmanager_meat1 car_meat1
OR NOT IS_PLAYER_IN_CAR player car_meat1

	WAIT 0
		
	IF IS_CAR_DEAD car_meat1

		IF IS_CHAR_DEAD bankmanager_meat1
			PRINT_NOW ( MEA1_1 ) 5000 1 //The Bank Managers dead!"
			GOTO mission_failed_meat1
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat1
		ENDIF

	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF
	
	IF IS_CHAR_DEAD bankmanager_meat1
		PRINT_NOW ( MEA1_1 ) 5000 1 //The Bank Managers dead!"
		GOTO mission_failed_meat1
	ELSE

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player bankmanager_meat1 30.0 30.0 30.0 FALSE
			PRINT_NOW ( MEA1_4 ) 5000 1 //You have left the Bank Manager behind!"
			GOTO mission_failed_meat1
		ENDIF

	ENDIF
		   
	IF NOT IS_PLAYER_IN_CAR player car_meat1
	AND flag_player_had_car_message_meat1 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat1 radar_blip_car_meat1
		REMOVE_BLIP radar_blip_ped1_meat1
		flag_player_had_car_message_meat1 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat1
	AND flag_player_had_car_message_meat1 = 1
		REMOVE_BLIP radar_blip_car_meat1
	   	ADD_BLIP_FOR_CHAR bankmanager_meat1 radar_blip_ped1_meat1
		flag_player_had_car_message_meat1 = 0
		blob_flag = 1
	ENDIF
      
ENDWHILE

REMOVE_BLIP radar_blip_ped1_meat1

PLAY_MISSION_AUDIO

PRINT_NOW ( MEA1_B4 ) 7000 1 //"Mr. Chonks sent you? Ok, take me to see him."

ADD_BLIP_FOR_COORD 1205.7 -789.2 -100.0 radar_blip_coord2_meat1

IF HAS_MISSION_AUDIO_FINISHED 
	CLEAR_THIS_PRINT ( MEA1_B4 )
ENDIF

blob_flag = 1

//waiting for them to be at the Dogfood factory

WHILE NOT LOCATE_STOPPED_CHAR_IN_CAR_3D	bankmanager_meat1 1205.7 -789.2 14.8 4.0 4.0 6.0 blob_flag
OR NOT IS_CHAR_IN_CAR bankmanager_meat1 car_meat1

	WAIT 0

	IF HAS_MISSION_AUDIO_FINISHED 
		CLEAR_THIS_PRINT ( MEA1_B4 )
	ENDIF
      	
	IF IS_CAR_DEAD car_meat1

		IF IS_CHAR_DEAD bankmanager_meat1
			CLEAR_MISSION_AUDIO
			PRINT_NOW ( MEA1_1 ) 5000 1 //The Bank Managers dead!"
			GOTO mission_failed_meat1
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat1
		ENDIF

	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF
	
	IF IS_CHAR_DEAD bankmanager_meat1
		CLEAR_MISSION_AUDIO
		PRINT_NOW ( MEA1_1 ) 5000 1 //The Bank Managers dead!"
		GOTO mission_failed_meat1
	ELSE

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player bankmanager_meat1 30.0 30.0 30.0 FALSE
			PRINT_NOW ( MEA1_4 ) 5000 1 //You have left the Bank Manager behind!"
			GOTO mission_failed_meat1
		ENDIF

	ENDIF
      
	IF NOT IS_PLAYER_IN_CAR player car_meat1
	AND flag_player_had_car_message_meat1 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat1 radar_blip_car_meat1
		REMOVE_BLIP radar_blip_coord2_meat1
		flag_player_had_car_message_meat1 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat1
	AND flag_player_had_car_message_meat1 = 1
		REMOVE_BLIP radar_blip_car_meat1
		ADD_BLIP_FOR_COORD 1205.7 -789.2 -100.0 radar_blip_coord2_meat1
		flag_player_had_car_message_meat1 = 0
		blob_flag = 1
	ENDIF
	
ENDWHILE

REMOVE_BLIP radar_blip_coord2_meat1

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

CLEAR_AREA 1201.8 -799.7 13.8 5.0 TRUE

SET_POLICE_IGNORE_PLAYER player ON

SET_CHAR_CANT_BE_DRAGGED_OUT bankmanager_meat1 FALSE

SET_CHAR_OBJ_LEAVE_CAR bankmanager_meat1 car_meat1

WHILE IS_CHAR_IN_CAR bankmanager_meat1 car_meat1

	WAIT 0
		
	IF IS_CAR_DEAD car_meat1

		IF IS_CHAR_DEAD bankmanager_meat1
			PRINT_NOW ( MEA1_1 ) 5000 1 //The Bank Managers dead!"
			GOTO mission_failed_meat1
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat1
		ENDIF

	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF
	
	IF IS_CHAR_DEAD bankmanager_meat1
		PRINT_NOW ( MEA1_1 ) 5000 1 //The Bank Managers dead!"
		GOTO mission_failed_meat1
	ENDIF
   
ENDWHILE

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT bankmanager_meat1 1204.2 -801.9

SET_FIXED_CAMERA_POSITION 1201.8 -784.7 17.0 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 1204.4 -802.7 15.0 JUMP_CUT

CLEAR_AREA 1200.8 -799.3 14.0 10.0 TRUE

// Waiting for the blokes to get to the meat grinding area

timerb = 0

WHILE NOT flag_bankmanager_in_area = 1

	WAIT 0
  			
	IF IS_CHAR_DEAD bankmanager_meat1
		PRINT_NOW ( MEA1_1 ) 5000 1 //The Bank Managers dead!"
		GOTO mission_failed_meat1
	ENDIF

	IF IS_CAR_DEAD car_meat1
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF
		
	IF flag_bankmanager_in_area = 0

		IF LOCATE_CHAR_ON_FOOT_2D bankmanager_meat1 1204.2 -801.9 0.5 0.5 FALSE
			flag_bankmanager_in_area = 1
		ENDIF

	ENDIF

	IF flag_bankman_moved_meat1 = 0
		
		IF timerb >= 20000
			SET_CHAR_COORDINATES bankmanager_meat1 1204.2 -801.9 13.7 
			flag_bankman_moved_meat1 = 1
		ENDIF

	ENDIF
      
ENDWHILE

// opens the door

WHILE NOT ROTATE_OBJECT doggy_door 135.0 5.0 FALSE

	WAIT 0

	IF IS_CHAR_DEAD bankmanager_meat1
		PRINT_NOW ( MEA1_1 ) 5000 1 //The Bank Managers dead!"
		GOTO mission_failed_meat1
	ENDIF

	IF IS_CAR_DEAD car_meat1
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF

ENDWHILE

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT bankmanager_meat1 1205.9 -805.8

timerb = 0

WHILE NOT LOCATE_CHAR_ON_FOOT_3D bankmanager_meat1 1205.9 -805.8 14.0 1.0 1.0 1.0 FALSE

	WAIT 0
	
	IF IS_CHAR_DEAD bankmanager_meat1
		PRINT_NOW ( MEA1_1 ) 5000 1 //The Bank Managers dead!"
		GOTO mission_failed_meat1
	ENDIF

	IF IS_CAR_DEAD car_meat1
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat1
	ENDIF

	IF timerb >= 20000

		IF NOT LOCATE_CHAR_ON_FOOT_3D bankmanager_meat1 1205.9 -805.8 14.0 1.0 1.0 1.0 FALSE
			REMOVE_CHAR_ELEGANTLY bankmanager_meat1
			GOTO bloke_got_stuck_meat1
		ENDIF

	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF

ENDWHILE

// Shuts the door

bloke_got_stuck_meat1:

LOAD_MISSION_AUDIO MF4_A
PRINT_NOW (MEA1_Z1) 2000 1 //"get your hands off me arm!"

WHILE NOT ROTATE_OBJECT doggy_door 45.0 5.0 FALSE
OR NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0

	IF IS_CHAR_DEAD bankmanager_meat1
		PRINT_NOW ( MEA1_1 ) 5000 1 //The Bank Managers dead!"
		GOTO mission_failed_meat1
	ENDIF

	IF IS_CAR_DEAD car_meat1
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF

ENDWHILE

RESTORE_CAMERA_JUMPCUT

REMOVE_CHAR_ELEGANTLY bankmanager_meat1

PLAY_MISSION_AUDIO

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CAR_DEAD car_meat1
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF
	
ENDWHILE	

SWITCH_WIDESCREEN OFF

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

PRINT_SOON ( MEA1_B6 ) 5000 1 //"Take the car to the crusher to get rid of evidence, get out of the car and the crane will pick it up."

ADD_BLIP_FOR_COORD 1138.0 52.0 -100.0 radar_blip_coord3_meat1

// waiting for the car to get to the area to be crushed

blob_flag = 1

WHILE NOT IS_CAR_STOPPED_IN_AREA_3D car_meat1 1135.8 55.5 -1.0 1149.8 46.3 9.0 blob_flag

	WAIT 0
	         	
	IF IS_CAR_DEAD car_meat1
		PRINT_NOW ( MEA1_2 ) 5000 1 //" You idiot! The cops will find the evidence in the car."
		GOTO mission_failed_meat1
	ELSE

		IF IS_CAR_STOPPED_IN_AREA_3D car_meat1 1135.8 55.5 -1.0 1149.8 46.3 9.0 FALSE

			flag_dont_do_car_check_meat1 = 1
		
			IF flag_leave_car_message_meat1 = 0
				PRINT_NOW ( MEA1_3 ) 5000 1 //"Get out of the car!"
				flag_leave_car_message_meat1 = 1
			ENDIF

		ELSE
			flag_leave_car_message_meat1 = 0
			flag_dont_do_car_check_meat1 = 0
		ENDIF

	ENDIF

	IF flag_dont_do_car_check_meat1 = 0
			      
		IF NOT IS_PLAYER_IN_CAR player car_meat1
		AND flag_player_had_car_message_meat1 = 0
			PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
			ADD_BLIP_FOR_CAR car_meat1 radar_blip_car_meat1
			REMOVE_BLIP radar_blip_coord3_meat1
			flag_player_had_car_message_meat1 = 1
			blob_flag = 0
		ENDIF

		IF IS_PLAYER_IN_CAR player car_meat1
		AND flag_player_had_car_message_meat1 = 1
			REMOVE_BLIP radar_blip_car_meat1
			ADD_BLIP_FOR_COORD 1138.0 52.0 -100.0 radar_blip_coord3_meat1
			flag_player_had_car_message_meat1 = 0
			blob_flag = 1
		ENDIF

	ENDIF

	IF flag_player_had_crusher_help_hm5 = 0
	
		IF LOCATE_PLAYER_ANY_MEANS_2D player 1140.3 50.1 20.0 20.0 FALSE
		AND IS_PLAYER_IN_CAR player car_meat1
			PRINT_HELP ( CRUSH ) //"To crush the car..."
			flag_player_had_crusher_help_hm5 = 1
		ENDIF

	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF

ENDWHILE

// waiting for the crane to pick up the car

blob_flag = 1

WHILE NOT IS_CRANE_LIFTING_CAR 1120.0 46.0 car_meat1

	WAIT 0
	   	   	
	IF IS_CAR_DEAD car_meat1
		PRINT_NOW ( MEA1_2 ) 5000 1 //" You idiot! The cops will find the evidence in the car."
		GOTO mission_failed_meat1
	ENDIF

	IF IS_CAR_STOPPED_IN_AREA_3D car_meat1 1135.8 55.5 -1.0 1149.8 46.3 20.0 blob_flag
		flag_car_in_area_meat1 = 1
	ELSE
		flag_car_in_area_meat1 = 0
	ENDIF

	IF flag_car_in_area_meat1 = 0
		      
		IF NOT IS_PLAYER_IN_CAR player car_meat1
		AND flag_player_had_car_message_meat1 = 0
			PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
			ADD_BLIP_FOR_CAR car_meat1 radar_blip_car_meat1
			REMOVE_BLIP radar_blip_coord3_meat1
			flag_player_had_car_message_meat1 = 1
			blob_flag = 0
		ENDIF

		IF IS_PLAYER_IN_CAR player car_meat1
		AND flag_player_had_car_message_meat1 = 1
			REMOVE_BLIP radar_blip_car_meat1
			ADD_BLIP_FOR_COORD 1138.0 52.0 -100.0 radar_blip_coord3_meat1
			flag_player_had_car_message_meat1 = 0
			blob_flag = 1
		ENDIF

	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat1
	AND IS_CAR_STOPPED car_meat1
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat1
	ENDIF
	
ENDWHILE

REMOVE_BLIP radar_blip_coord3_meat1


// waiting for the car to be crushed

WHILE flag_car_crushed_meat1 = 0

	WAIT 0
		
	IF IS_CAR_CRUSHED car_meat1
		flag_car_crushed_meat1 = 1
		GOTO mission_passed_meat1
	ELSE
	
		IF IS_CAR_DEAD car_meat1
			PRINT_NOW ( MEA1_2 ) 5000 1 //"You idiot! The cops will find the evidence in the car."
			GOTO mission_failed_meat1
		ENDIF

	ENDIF
		
ENDWHILE

}

// Mission Failed

mission_failed_meat1:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN


		
// Mission Passed
	
mission_passed_meat1:

PRINT_WITH_NUMBER_BIG ( m_pass ) 1000 5000 1 //"Mission Passed!"
REGISTER_MISSION_PASSED ( MEA1 )
PLAYER_MADE_PROGRESS 1
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 1000
flag_meat_mission1_passed = 1
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT meat_mission2_loop

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN


// Mission Cleanup

mission_cleanup_meat1:

flag_player_on_mission = 0
flag_player_on_meat_mission = 0
REMOVE_CHAR_ELEGANTLY bankmanager_meat1
MARK_MODEL_AS_NO_LONGER_NEEDED PED_B_MAN1
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_PERENNIAL
REMOVE_BLIP radar_blip_ped1_meat1
REMOVE_BLIP radar_blip_car_meat1
REMOVE_BLIP radar_blip_coord2_meat1
REMOVE_BLIP radar_blip_coord3_meat1
MISSION_HAS_FINISHED
RETURN
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************
// ***********************************Meat Factory Mission 2**********************************
// *****************************************"The Thieves"*************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME meat2

// Mission Start Stuff

GOSUB mission_start_meat2

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_failed_meat2
	ENDIF

GOSUB mission_cleanup_meat2

MISSION_END


// Variable for mission

VAR_INT car_meat2

VAR_INT victim1_meat2

VAR_INT victim2_meat2

VAR_INT radar_blip_car_meat2

VAR_INT radar_blip_ped1_meat2

VAR_INT radar_blip_ped2_meat2

VAR_INT flag_player_had_car_message_meat2

VAR_INT radar_blip_coord2_meat2

VAR_INT flag_victim1_in_area

VAR_INT flag_victim2_in_area

VAR_INT radar_blip_coord3_meat2

VAR_INT flag_car_in_area_meat2

VAR_FLOAT doorx

VAR_FLOAT doory

VAR_FLOAT doorz

VAR_INT flag_remove_blip1_meat2

VAR_INT flag_remove_blip2_meat2

VAR_INT flag_car_in_zone2_meat2

VAR_INT radar_blip_coord4_meat2

VAR_INT flag_player_had_out_car_message_meat2

// ****************************************Mission Start************************************

mission_start_meat2:

flag_player_on_mission = 1

flag_player_on_meat_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_player_had_car_message_meat2 = 0

flag_victim1_in_area = 0

flag_victim2_in_area = 0

flag_car_in_area_meat2 = 0

blob_flag = 1

flag_remove_blip1_meat2 = 0

flag_remove_blip2_meat2 = 0

flag_car_in_zone2_meat2 = 0

flag_player_had_out_car_message_meat2 = 0

{

// *******************************START OF CUTSCENE*****************************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_failed_meat2
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( MEA2 ) 15000 2 //"THE THIEVES"

SWITCH_STREAMING OFF

//LOAD_SPECIAL_MODEL cut_obj1 PLAYERH	 

WHILE GET_FADING_STATUS
					  
	WAIT 0

ENDWHILE
*/


SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS 1164.25 -888.87 10.0 1291.76 -811.71 20.0

//LOAD_ALL_MODELS_NOW

//WHILE NOT HAS_MODEL_LOADED cut_obj1

//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE mt_ph2 
SET_CUTSCENE_OFFSET 1223.88 -839.414 13.95
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player


DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( MEA2_A ) 10000 1 //"I hired some..." 

WHILE cs_time < 4424
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA2_B ) 10000 1  //"and steal some..." 

WHILE cs_time < 8124
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA2_C ) 10000 1  //"The thieveing bastards..." 

WHILE cs_time < 10996
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA2_D ) 10000 1 //"IF I don't...." 

WHILE cs_time < 12362
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA2_E ) 10000 1 //"Can you believe..." 

WHILE cs_time < 13728
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA2_F ) 10000 1  //I've left a car..." 

WHILE cs_time < 16082
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA2_G ) 10000 1  //"Use it to..." 

WHILE cs_time < 19591
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA2_H ) 10000 1  //"Them bring 'em..."

WHILE cs_time < 24155
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( MEA2_H )

WHILE cs_time < 25233
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

WAIT 500

DO_FADE 1500 FADE_IN

//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

SET_PED_DENSITY_MULTIPLIER 1.0

// **************************************END OF CUTSCENE************************************


REQUEST_MODEL PED_CRIMINAL1

REQUEST_MODEL PED_CRIMINAL2

REQUEST_MODEL CAR_SENTINEL


WHILE NOT HAS_MODEL_LOADED PED_CRIMINAL1
OR NOT HAS_MODEL_LOADED PED_CRIMINAL2
OR NOT HAS_MODEL_LOADED CAR_SENTINEL

	WAIT 0

ENDWHILE

//PRINT_BIG ( MEA2 ) 15000 2 //"The Thieves"

//WAIT 1000

CREATE_CAR CAR_SENTINEL 1190.0 -796.0 13.8 car_meat2

SET_CAR_HEADING car_meat2 300.0

ADD_BLIP_FOR_CAR car_meat2 radar_blip_car_meat2

// waiting for the player to get into the car

WHILE NOT IS_PLAYER_IN_CAR player car_meat2

	WAIT 0
		
	IF IS_CAR_DEAD car_meat2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat2
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat2
	AND IS_CAR_STOPPED car_meat2
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat2
	ENDIF
	
ENDWHILE

REMOVE_BLIP radar_blip_car_meat2

PRINT_NOW ( MEA2_B3 ) 7000 1 //"Go and meet the creditors."

CREATE_CHAR PEDTYPE_CIVMALE PED_CRIMINAL1 869.0 -611.0 -100.0 victim1_meat2

CLEAR_CHAR_THREAT_SEARCH victim1_meat2

TURN_CHAR_TO_FACE_COORD victim1_meat2 869.0 -615.0 -100.0

SET_CHAR_CANT_BE_DRAGGED_OUT victim1_meat2 TRUE

ADD_BLIP_FOR_CHAR victim1_meat2 radar_blip_ped1_meat2

CREATE_CHAR PEDTYPE_CIVMALE PED_CRIMINAL2 871.0 -612.0 -100.0 victim2_meat2

CLEAR_CHAR_THREAT_SEARCH victim2_meat2

TURN_CHAR_TO_FACE_COORD victim2_meat2 869.0 -615.0 -100.0

SET_CHAR_CANT_BE_DRAGGED_OUT victim2_meat2 TRUE

ADD_BLIP_FOR_CHAR victim2_meat2 radar_blip_ped2_meat2

// waiting for the player to get to the creditors

WHILE NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player victim1_meat2 8.0 8.0 FALSE
OR NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player victim2_meat2 8.0 8.0 FALSE 
OR NOT IS_PLAYER_IN_CAR player car_meat2

	WAIT 0
		
	IF IS_CAR_DEAD car_meat2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat2
	ENDIF
	
	IF IS_CHAR_DEAD victim1_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ENDIF
	
	IF IS_CHAR_DEAD victim2_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ENDIF
   	
	IF NOT IS_PLAYER_IN_CAR player car_meat2
	AND flag_player_had_car_message_meat2 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat2 radar_blip_car_meat2
		REMOVE_BLIP radar_blip_ped1_meat2
		REMOVE_BLIP radar_blip_ped2_meat2
		flag_player_had_car_message_meat2 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat2
	AND flag_player_had_car_message_meat2 = 1
		REMOVE_BLIP radar_blip_car_meat2
		ADD_BLIP_FOR_CHAR victim1_meat2 radar_blip_ped1_meat2
		ADD_BLIP_FOR_CHAR victim2_meat2 radar_blip_ped2_meat2
		flag_player_had_car_message_meat2 = 0
		blob_flag = 1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat2
	AND IS_CAR_STOPPED car_meat2
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat2
	ENDIF
	
ENDWHILE

// tells the two thieves to get into the car

SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER victim1_meat2 car_meat2

SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER victim2_meat2 car_meat2 
		 				 
WHILE NOT IS_CHAR_IN_CAR victim1_meat2 car_meat2
OR NOT IS_CHAR_IN_CAR victim2_meat2 car_meat2
OR NOT IS_PLAYER_IN_CAR player car_meat2
   
	WAIT 0
      	
	IF IS_CAR_DEAD car_meat2

		IF IS_CHAR_DEAD victim1_meat2
		OR IS_CHAR_DEAD victim2_meat2
			PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
			GOTO mission_failed_meat2
		ELSE 
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat2
		ENDIF

	ENDIF

	IF IS_CHAR_DEAD victim1_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ELSE

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player victim1_meat2 30.0 30.0 30.0 FALSE
			PRINT_NOW ( MEA2_4 ) 5000 1 //"You have left a creditor behind!"
			GOTO mission_failed_meat2
		ENDIF

	ENDIF
	
	IF IS_CHAR_DEAD victim2_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ELSE

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player victim2_meat2 30.0 30.0 30.0 FALSE
			PRINT_NOW ( MEA2_4 ) 5000 1 //"You have left a creditor behind!"
			GOTO mission_failed_meat2
		ENDIF

	ENDIF
	
	IF NOT IS_PLAYER_IN_CAR player car_meat2
	AND flag_player_had_car_message_meat2 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat2 radar_blip_car_meat2
		REMOVE_BLIP radar_blip_ped1_meat2
		REMOVE_BLIP radar_blip_ped2_meat2
		flag_player_had_car_message_meat2 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat2
	AND flag_player_had_car_message_meat2 = 1
		REMOVE_BLIP radar_blip_car_meat2
		ADD_BLIP_FOR_CHAR victim1_meat2 radar_blip_ped1_meat2
		ADD_BLIP_FOR_CHAR victim2_meat2 radar_blip_ped2_meat2
		flag_player_had_car_message_meat2 = 0
		blob_flag = 1
	ENDIF

    IF IS_CHAR_IN_CAR victim1_meat2 car_meat2
	AND flag_remove_blip1_meat2 = 0
	   REMOVE_BLIP radar_blip_ped1_meat2
	   flag_remove_blip1_meat2 = 1
	ENDIF
	
	IF IS_CHAR_IN_CAR victim2_meat2 car_meat2
	AND flag_remove_blip2_meat2 = 0
	   REMOVE_BLIP radar_blip_ped2_meat2
	   flag_remove_blip2_meat2 = 1
	ENDIF
	
	IF IS_CAR_UPSIDEDOWN car_meat2
	AND IS_CAR_STOPPED car_meat2
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat2
	ENDIF 
      
ENDWHILE

REMOVE_BLIP radar_blip_ped1_meat2

REMOVE_BLIP radar_blip_ped2_meat2

PRINT_NOW ( MEA2_B4 ) 7000 1 //"Take us to the Bitch'n Dog Food Factory"

ADD_BLIP_FOR_COORD 1205.7 -789.2 -100.0 radar_blip_coord2_meat2

blob_flag = 1

WHILE NOT LOCATE_STOPPED_CHAR_IN_CAR_3D	victim1_meat2 1205.7 -789.2 13.9 4.0 4.0 6.0 blob_flag
OR NOT LOCATE_STOPPED_CHAR_IN_CAR_3D victim2_meat2 1205.7 -789.2 13.9 4.0 4.0 6.0 FALSE
OR NOT IS_CHAR_IN_CAR victim1_meat2 car_meat2
OR NOT IS_CHAR_IN_CAR victim2_meat2 car_meat2

	WAIT 0
			
	IF IS_CAR_DEAD car_meat2

		IF IS_CHAR_DEAD victim1_meat2
		OR IS_CHAR_DEAD victim2_meat2
			PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
			GOTO mission_failed_meat2
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat2
		ENDIF
		
	ENDIF
	
	IF IS_CHAR_DEAD victim1_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ELSE

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player victim1_meat2 30.0 30.0 30.0 FALSE
			PRINT_NOW ( MEA2_4 ) 5000 1 //"You have left a creditor behind!"
			GOTO mission_failed_meat2
		ENDIF

	ENDIF
	
	IF IS_CHAR_DEAD victim2_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ELSE

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player victim2_meat2 30.0 30.0 30.0 FALSE
			PRINT_NOW ( MEA2_4 ) 5000 1 //"You have left a creditor behind!"
			GOTO mission_failed_meat2
		ENDIF

	ENDIF
	
   	IF NOT IS_PLAYER_IN_CAR player car_meat2
	AND flag_player_had_car_message_meat2 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat2 radar_blip_car_meat2
		REMOVE_BLIP radar_blip_coord2_meat2
		flag_player_had_car_message_meat2 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat2
	AND flag_player_had_car_message_meat2 = 1
		REMOVE_BLIP radar_blip_car_meat2
		ADD_BLIP_FOR_COORD 1205.7 -789.2 -100.0 radar_blip_coord2_meat2
		flag_player_had_car_message_meat2 = 0
		blob_flag = 1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat2
	AND IS_CAR_STOPPED car_meat2
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat2
	ENDIF

ENDWHILE

REMOVE_BLIP radar_blip_coord2_meat2

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

SET_POLICE_IGNORE_PLAYER player ON

SET_CHAR_CANT_BE_DRAGGED_OUT victim1_meat2 FALSE

SET_CHAR_OBJ_LEAVE_CAR victim1_meat2 car_meat2

SET_CHAR_CANT_BE_DRAGGED_OUT victim2_meat2 FALSE

SET_CHAR_OBJ_LEAVE_CAR victim2_meat2 car_meat2

WHILE IS_CHAR_IN_CAR victim1_meat2 car_meat2
AND IS_CHAR_IN_CAR victim2_meat2 car_meat2 
	
	WAIT 0
      	
	IF IS_CAR_DEAD car_meat2

		IF IS_CHAR_DEAD victim1_meat2
		OR IS_CHAR_DEAD victim2_meat2
			PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
			GOTO mission_failed_meat2
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat2
		ENDIF
		
	ENDIF
	
	IF IS_CHAR_DEAD victim1_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ENDIF
	
	IF IS_CHAR_DEAD victim2_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat2
	AND IS_CAR_STOPPED car_meat2
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat2
	ENDIF

ENDWHILE

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT victim1_meat2 1203.3 -801.7

WAIT 500

IF IS_CHAR_DEAD victim2_meat2
	PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
	GOTO mission_failed_meat2
ENDIF

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT victim2_meat2 1202.4 -800.0

SET_FIXED_CAMERA_POSITION 1201.8 -784.7 17.0 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 1204.4 -802.7 15.0 JUMP_CUT

CLEAR_AREA 1201.8 -799.7 13.8 10.0 TRUE

timerb = 0

// Waiting for the blokes to get to the meat grinding area

WHILE NOT flag_victim1_in_area = 2
OR NOT flag_victim2_in_area = 2

	WAIT 0
	
	IF NOT ROTATE_OBJECT doggy_door 135.0 5.0 FALSE					   				   
		GET_OBJECT_COORDINATES doggy_door doorx doory doorz					   						 
	ENDIF

	IF IS_CAR_DEAD car_meat2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat2
	ENDIF
	   			
	IF IS_CHAR_DEAD victim1_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ENDIF
	
	IF IS_CHAR_DEAD victim2_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ENDIF
	
   	IF flag_victim1_in_area = 0

		IF LOCATE_CHAR_ON_FOOT_2D victim1_meat2 1203.3 -801.7 0.5 0.5 FALSE
			flag_victim1_in_area = 1
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT victim1_meat2 1209.4 -807.2
		ENDIF

	ENDIF

	IF flag_victim1_in_area = 1

		IF LOCATE_CHAR_ON_FOOT_3D victim1_meat2 1209.4 -807.2 14.0 4.0 4.0 4.0 FALSE
			flag_victim1_in_area = 2
		ENDIF

	ENDIF
		
	
	IF flag_victim2_in_area = 0

		IF LOCATE_CHAR_ON_FOOT_2D victim2_meat2 1202.4 -800.0 0.5 0.5 FALSE
			flag_victim2_in_area = 1
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT victim2_meat2 1209.4 -807.2
		ENDIF
	
	ENDIF

	IF flag_victim2_in_area = 1

		IF LOCATE_CHAR_ON_FOOT_3D victim2_meat2 1209.4 -807.2 14.0 4.0 4.0 4.0 FALSE
			flag_victim2_in_area = 2
		ENDIF
	
	ENDIF

	IF timerb >= 30000

		IF NOT flag_victim1_in_area = 2
		OR NOT flag_victim2_in_area = 2
			REMOVE_CHAR_ELEGANTLY victim1_meat2
			REMOVE_CHAR_ELEGANTLY victim2_meat2
			GOTO mission_bloke_stuck 
		ENDIF
		
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat2
	AND IS_CAR_STOPPED car_meat2
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat2
	ENDIF

ENDWHILE

mission_bloke_stuck:

LOAD_MISSION_AUDIO MF4_B

// Shuts the door

WHILE NOT ROTATE_OBJECT doggy_door 45.0 5.0 FALSE
OR NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0

	IF IS_CAR_DEAD car_meat2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat2
	ENDIF
	   			
	IF IS_CHAR_DEAD victim1_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ENDIF
	
	IF IS_CHAR_DEAD victim2_meat2
		PRINT_NOW ( MEA2_2 ) 5000 1 //"A creditor's dead!"
		GOTO mission_failed_meat2
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat2
	AND IS_CAR_STOPPED car_meat2
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat2
	ENDIF
	
ENDWHILE

RESTORE_CAMERA_JUMPCUT

REMOVE_CHAR_ELEGANTLY victim1_meat2

REMOVE_CHAR_ELEGANTLY victim2_meat2

PLAY_MISSION_AUDIO

WHILE NOT HAS_MISSION_AUDIO_FINISHED 

	WAIT 0

	IF IS_CAR_DEAD car_meat2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat2
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat2
	AND IS_CAR_STOPPED car_meat2
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat2
	ENDIF

ENDWHILE

SWITCH_WIDESCREEN OFF

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

PRINT_SOON ( MEA2_B6 ) 5000 1 //"Take the car to the crusher to get rid of evidence, get out of the car and the crane will pick it up."

ADD_SPRITE_BLIP_FOR_COORD 924.0 -361.0 10.0 RADAR_SPRITE_SPRAY radar_blip_coord3_meat2 

HAS_RESPRAY_HAPPENED sprayshop1

// waiting for the player to respray the car

WHILE NOT HAS_RESPRAY_HAPPENED sprayshop1
OR NOT IS_PLAYER_IN_CAR player car_meat2
OR NOT IS_PLAYER_STOPPED_IN_AREA_2D player 922.6 -366.1 928.6 -354.3 FALSE

	WAIT 0

	IF IS_CAR_DEAD car_meat2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat2
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player car_meat2
	AND flag_player_had_car_message_meat2 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat2 radar_blip_car_meat2
		REMOVE_BLIP radar_blip_coord3_meat2
		flag_player_had_car_message_meat2 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat2
	AND flag_player_had_car_message_meat2 = 1
		REMOVE_BLIP radar_blip_car_meat2
		ADD_SPRITE_BLIP_FOR_COORD 924.0 -361.0 10.0 RADAR_SPRITE_SPRAY radar_blip_coord3_meat2
		flag_player_had_car_message_meat2 = 0
		blob_flag = 1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat2
	AND IS_CAR_STOPPED car_meat2
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat2
	ENDIF

ENDWHILE

REMOVE_BLIP radar_blip_coord3_meat2

PRINT_NOW ( MEA2_3 ) 5000 1 //"Dump the car by the road bridge in Chinatown."

ADD_BLIP_FOR_COORD 1195.6 -805.0 13.7 radar_blip_coord4_meat2

blob_flag = 1

WHILE NOT LOCATE_STOPPED_CAR_3D car_meat2 1195.6 -805.0 13.7 4.0 4.0 4.0 blob_flag
OR IS_PLAYER_IN_CAR player car_meat2

	WAIT 0

	IF IS_CAR_DEAD car_meat2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat2
	ENDIF

	IF LOCATE_STOPPED_CAR_3D car_meat2 1195.6 -805.0 13.7 4.0 4.0 4.0 FALSE
		
		IF flag_player_had_out_car_message_meat2 = 0
			PRINT_NOW ( OUT_VEH ) 5000 1 //"Get out of the vehicle!"
			flag_player_had_out_car_message_meat2 = 1
		ENDIF
		flag_car_in_zone2_meat2 = 1
	ELSE
		flag_car_in_zone2_meat2 = 0
		flag_player_had_out_car_message_meat2 = 0
	ENDIF

	IF flag_car_in_zone2_meat2 = 0

		IF NOT IS_PLAYER_IN_CAR player car_meat2
		AND flag_player_had_car_message_meat2 = 0
			PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
			ADD_BLIP_FOR_CAR car_meat2 radar_blip_car_meat2
			REMOVE_BLIP radar_blip_coord4_meat2
			flag_player_had_car_message_meat2 = 1
			blob_flag = 0
		ENDIF

		IF IS_PLAYER_IN_CAR player car_meat2
		AND flag_player_had_car_message_meat2 = 1
			REMOVE_BLIP radar_blip_car_meat2
			ADD_BLIP_FOR_COORD 1195.6 -805.0 13.7 radar_blip_coord4_meat2
			flag_player_had_car_message_meat2 = 0
			blob_flag = 1
		ENDIF

	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat2
	AND IS_CAR_STOPPED car_meat2
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat2
	ENDIF
	
ENDWHILE

IF NOT IS_CAR_DEAD car_meat2
	CHANGE_CAR_LOCK car_meat2 CARLOCK_LOCKED
ENDIF

REMOVE_BLIP radar_blip_coord4_meat2

}

GOTO mission_passed_meat2

// Mission Failed

mission_failed_meat2:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN


		
// Mission Passed
	
mission_passed_meat2:

PRINT_WITH_NUMBER_BIG ( m_pass ) 2000 5000 1 //"Mission Passed!"
REGISTER_MISSION_PASSED ( MEA2 )
PLAYER_MADE_PROGRESS 1
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 2000
flag_meat_mission2_passed = 1
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT meat_mission3_loop

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN


// Mission Cleanup

mission_cleanup_meat2:

flag_player_on_mission = 0
flag_player_on_meat_mission = 0
REMOVE_CHAR_ELEGANTLY victim1_meat2
REMOVE_CHAR_ELEGANTLY victim2_meat2
MARK_MODEL_AS_NO_LONGER_NEEDED PED_CRIMINAL1
MARK_MODEL_AS_NO_LONGER_NEEDED PED_CRIMINAL2
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SENTINEL
REMOVE_BLIP radar_blip_ped1_meat2
REMOVE_BLIP radar_blip_ped2_meat2
REMOVE_BLIP radar_blip_car_meat2
REMOVE_BLIP radar_blip_coord2_meat2
REMOVE_BLIP radar_blip_coord3_meat2
REMOVE_BLIP radar_blip_coord4_meat2
MISSION_HAS_FINISHED
RETURN
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************
// ***********************************Meat Factory Mission 3**********************************
// *****************************************"The Wife"****************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME meat3

// Mission Start Stuff

GOSUB mission_start_meat3

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_failed_meat3
	ENDIF

GOSUB mission_cleanup_meat3

MISSION_END


// Variable for mission

VAR_INT car_meat3

VAR_INT wife_meat3

VAR_INT radar_blip_car_meat3

VAR_INT radar_blip_ped1_meat3

VAR_INT flag_player_had_car_message_meat3

VAR_INT radar_blip_coord2_meat3

VAR_INT flag_wife_in_area

// ****************************************Mission Start************************************

mission_start_meat3:

flag_player_on_mission = 1

flag_player_on_meat_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_player_had_car_message_meat3 = 0

flag_wife_in_area = 0

blob_flag = 1

{

// *****************************************START OF CUTSCENE*******************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_failed_meat3
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( MEA3 ) 15000 2 //"THE WIFE"	

SWITCH_STREAMING OFF

//LOAD_SPECIAL_MODEL cut_obj1 PLAYERH 

WHILE GET_FADING_STATUS
					  
	WAIT 0

ENDWHILE
*/


SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS 1164.25 -888.87 10.0 1291.76 -811.71 20.0

//LOAD_ALL_MODELS_NOW

//WHILE NOT HAS_MODEL_LOADED cut_obj1

//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE mt_ph3 
SET_CUTSCENE_OFFSET 1223.88 -839.414 13.95
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player


DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( MEA3_A ) 10000 1 //"The business..." 

WHILE cs_time < 6470
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA3_B ) 10000 1  //"My wife has..." 

WHILE cs_time < 11321
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA3_C ) 10000 1  //"I've left a car..." 

WHILE cs_time < 13506
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA3_D ) 10000 1 //"Go and pick her...."

WHILE cs_time < 17471
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( MEA3_D ) 

WHILE cs_time < 18333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

WAIT 500

DO_FADE 1500 FADE_IN

//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

SET_PED_DENSITY_MULTIPLIER 1.0

// *****************************************END OF CUTSCENE*********************************

REQUEST_MODEL PED_FEMALE2

REQUEST_MODEL CAR_ESPERANTO

LOAD_MISSION_AUDIO MF2_A

WHILE NOT HAS_MODEL_LOADED PED_FEMALE2
OR NOT HAS_MODEL_LOADED CAR_ESPERANTO
OR NOT HAS_MISSION_AUDIO_LOADED 

	WAIT 0

ENDWHILE

CREATE_CAR CAR_ESPERANTO 1190.0 -796.0 13.8 car_meat3

SET_CAR_HEADING car_meat3 300.0

ADD_BLIP_FOR_CAR car_meat3 radar_blip_car_meat3

// waiting for the player to get into the car

WHILE NOT IS_PLAYER_IN_CAR player car_meat3

	WAIT 0
	    	
	IF IS_CAR_DEAD car_meat3
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat3
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat3
	AND IS_CAR_STOPPED car_meat3
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat3
	ENDIF
      	
ENDWHILE

REMOVE_BLIP radar_blip_car_meat3

PRINT_NOW ( MEA3_B3 ) 7000 1 //"Get the wife, press the horn to get her into the car!"

CREATE_CHAR PEDTYPE_CIVFEMALE PED_FEMALE2 1064.0 -378.0 13.9 wife_meat3

CLEAR_CHAR_THREAT_SEARCH wife_meat3

TURN_CHAR_TO_FACE_COORD wife_meat3 1059.0 -378.0 100.0

ADD_BLIP_FOR_CHAR wife_meat3 radar_blip_ped1_meat3

SET_CHAR_CANT_BE_DRAGGED_OUT wife_meat3 TRUE

// Waiting for the player to be in the area

WHILE NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player wife_meat3 8.0 8.0 FALSE
OR NOT IS_PLAYER_IN_CAR player car_meat3

	WAIT 0
  	
	IF IS_CAR_DEAD car_meat3
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat3
	ENDIF
	
	IF IS_CHAR_DEAD wife_meat3
		PRINT_NOW ( MEA3_1 ) 5000 1 //"The wife's dead!"
		GOTO mission_failed_meat3
	ENDIF
	
   	IF NOT IS_PLAYER_IN_CAR player car_meat3
	AND flag_player_had_car_message_meat3 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat3 radar_blip_car_meat3
		REMOVE_BLIP radar_blip_ped1_meat3
		flag_player_had_car_message_meat3 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat3
	AND flag_player_had_car_message_meat3 = 1
		REMOVE_BLIP radar_blip_car_meat3
		ADD_BLIP_FOR_CHAR wife_meat3 radar_blip_ped1_meat3
		flag_player_had_car_message_meat3 = 0
		blob_flag = 1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat3
	AND IS_CAR_STOPPED car_meat3
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat3
	ENDIF
	
ENDWHILE

// tells the wife to get into players car

SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER wife_meat3 car_meat3

WHILE NOT IS_CHAR_IN_CAR wife_meat3 car_meat3
OR NOT IS_PLAYER_IN_CAR player car_meat3

	WAIT 0
	
	IF IS_CAR_DEAD car_meat3

		IF IS_CHAR_DEAD wife_meat3
			PRINT_NOW ( MEA3_1 ) 5000 1 //"The wife's dead!"
			GOTO mission_failed_meat3
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat3
		ENDIF

	ENDIF

	IF IS_CHAR_DEAD wife_meat3
		PRINT_NOW ( MEA3_1 ) 5000 1 //"The wife's dead!"
		GOTO mission_failed_meat3
	ELSE

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player wife_meat3 30.0 30.0 30.0 FALSE
			PRINT_NOW ( MEA3_3 ) 5000 1 //"You have left his wife behind"
			GOTO mission_failed_meat3
		ENDIF
	
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player car_meat3
	AND flag_player_had_car_message_meat3 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat3 radar_blip_car_meat3
		REMOVE_BLIP radar_blip_ped1_meat3
		flag_player_had_car_message_meat3 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat3
	AND flag_player_had_car_message_meat3 = 1
		REMOVE_BLIP radar_blip_car_meat3
		ADD_BLIP_FOR_CHAR wife_meat3 radar_blip_ped1_meat3
		flag_player_had_car_message_meat3 = 0
		blob_flag = 1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat3
	AND IS_CAR_STOPPED car_meat3
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat3
	ENDIF
			
ENDWHILE 

REMOVE_BLIP radar_blip_ped1_meat3

PLAY_MISSION_AUDIO

PRINT_NOW ( MEA3_B4 ) 7000 1 //"Marty wants to see me? Well it better be quick because I have a slot booked at the gym, and a hair appointment after that."

ADD_BLIP_FOR_COORD 1205.7 -789.2 -100.0 radar_blip_coord2_meat3

IF HAS_MISSION_AUDIO_FINISHED
	CLEAR_THIS_PRINT ( MEA3_B4 )
ENDIF

blob_flag = 1

// waiting for the wife to be at the factory

WHILE NOT LOCATE_STOPPED_CHAR_IN_CAR_3D	wife_meat3 1205.7 -789.2 13.9 4.0 4.0 6.0 blob_flag
OR NOT IS_CHAR_IN_CAR wife_meat3 car_meat3
	
	WAIT 0

	IF HAS_MISSION_AUDIO_FINISHED
		CLEAR_THIS_PRINT ( MEA3_B4 )
	ENDIF
		
	IF IS_CAR_DEAD car_meat3

		IF IS_CHAR_DEAD wife_meat3
			PRINT_NOW ( MEA3_1 ) 5000 1 //"The wife's dead!"
			GOTO mission_failed_meat3
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat3
		ENDIF

	ENDIF
	
	IF IS_CHAR_DEAD wife_meat3
		PRINT_NOW ( MEA3_1 ) 5000 1 //"The wife's dead!"
		GOTO mission_failed_meat3
	ELSE

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player wife_meat3 30.0 30.0 30.0 FALSE
			PRINT_NOW ( MEA3_3 ) 5000 1 //"You have left his wife behind"
			GOTO mission_failed_meat3
		ENDIF
	
	ENDIF	
      
	IF NOT IS_PLAYER_IN_CAR player car_meat3
	AND flag_player_had_car_message_meat3 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat3 radar_blip_car_meat3
		REMOVE_BLIP radar_blip_coord2_meat3
		flag_player_had_car_message_meat3 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat3
	AND flag_player_had_car_message_meat3 = 1
		REMOVE_BLIP radar_blip_car_meat3
		ADD_BLIP_FOR_COORD 1205.7 -789.2 -100.0 radar_blip_coord2_meat3
		flag_player_had_car_message_meat3 = 0
		blob_flag = 1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat3
	AND IS_CAR_STOPPED car_meat3
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat3
	ENDIF

ENDWHILE

REMOVE_BLIP radar_blip_coord2_meat3

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

SET_POLICE_IGNORE_PLAYER player ON

SET_CHAR_CANT_BE_DRAGGED_OUT wife_meat3 FALSE

SET_CHAR_OBJ_LEAVE_CAR wife_meat3 car_meat3

WHILE IS_CHAR_IN_CAR wife_meat3 car_meat3

	WAIT 0
    	
	IF IS_CAR_DEAD car_meat3

		IF IS_CHAR_DEAD wife_meat3
			PRINT_NOW ( MEA3_1 ) 5000 1 //"The wife's dead!"
			GOTO mission_failed_meat3
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat3
		ENDIF

	ENDIF
	
	IF IS_CHAR_DEAD wife_meat3
		PRINT_NOW ( MEA3_1 ) 5000 1 //"The wife's dead!"
		GOTO mission_failed_meat3
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat3
	AND IS_CAR_STOPPED car_meat3
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat3
	ENDIF
      
ENDWHILE

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT wife_meat3 1204.2 -801.9

SET_FIXED_CAMERA_POSITION 1201.8 -784.7 17.0 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 1204.4 -802.7 15.0 JUMP_CUT

CLEAR_AREA 1200.8 -799.3 14.0 10.0 TRUE

timerb = 0

// Waiting for the wifes to get to the meat grinding area

WHILE NOT flag_wife_in_area = 1

	WAIT 0
      
	IF IS_CAR_DEAD car_meat3
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat3
	ENDIF
			
	IF IS_CHAR_DEAD wife_meat3
		PRINT_NOW ( MEA3_1 ) 5000 1 //"The wife's dead!"
		GOTO mission_failed_meat3
	ENDIF
         
	IF flag_wife_in_area = 0

		IF LOCATE_CHAR_ON_FOOT_2D wife_meat3 1204.2 -801.9 0.5 0.5 FALSE
			flag_wife_in_area = 1
		ENDIF

	ENDIF

	IF timerb >= 25000

		IF NOT flag_wife_in_area = 1
			SET_CHAR_COORDINATES wife_meat3 1204.2 -801.9 13.7
			GOTO wife_stuck1
		ENDIF
		
	ENDIF
	
	IF IS_CAR_UPSIDEDOWN car_meat3
	AND IS_CAR_STOPPED car_meat3
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat3
	ENDIF 
		      
ENDWHILE

wife_stuck1:

// opens the door

WHILE NOT ROTATE_OBJECT doggy_door 135.0 5.0 FALSE

	WAIT 0

	IF IS_CAR_DEAD car_meat3
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat3
	ENDIF
			
	IF IS_CHAR_DEAD wife_meat3
		PRINT_NOW ( MEA3_1 ) 5000 1 //"The wife's dead!"
		GOTO mission_failed_meat3
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat3
	AND IS_CAR_STOPPED car_meat3
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat3
	ENDIF

ENDWHILE

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT wife_meat3 1205.9 -805.8

timerb = 0

WHILE NOT LOCATE_CHAR_ON_FOOT_3D wife_meat3 1205.9 -805.8 14.0 1.0 1.0 1.0 FALSE

	WAIT 0
	
	IF IS_CAR_DEAD car_meat3
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat3
	ENDIF
			
	IF IS_CHAR_DEAD wife_meat3
		PRINT_NOW ( MEA3_1 ) 5000 1 //"The wife's dead!"
		GOTO mission_failed_meat3
	ENDIF

	IF timerb >= 25000
		
		IF NOT LOCATE_CHAR_ON_FOOT_3D wife_meat3 1205.9 -805.8 14.0 1.0 1.0 1.0 FALSE
			REMOVE_CHAR_ELEGANTLY wife_meat3
			GOTO mission_bloke_stuck_meat3
		ENDIF
		
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat3
	AND IS_CAR_STOPPED car_meat3
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat3
	ENDIF

ENDWHILE

// Shuts the door

mission_bloke_stuck_meat3:

LOAD_MISSION_AUDIO MF4_C

WHILE NOT ROTATE_OBJECT doggy_door 45.0 5.0 FALSE
OR NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0

	IF IS_CAR_DEAD car_meat3
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat3
	ENDIF
			
	IF IS_CHAR_DEAD wife_meat3
		PRINT_NOW ( MEA3_1 ) 5000 1 //"The wife's dead!"
		GOTO mission_failed_meat3
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat3
	AND IS_CAR_STOPPED car_meat3
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat3
	ENDIF

ENDWHILE

RESTORE_CAMERA_JUMPCUT	

REMOVE_CHAR_ELEGANTLY wife_meat3

PLAY_MISSION_AUDIO

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CAR_DEAD car_meat3
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat3
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat3
	AND IS_CAR_STOPPED car_meat3
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat3
	ENDIF

ENDWHILE

SWITCH_WIDESCREEN OFF

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

PRINT_NOW ( MEA3_B6 ) 5000 1 //"Take the car and dump it into the sea, this will get rid of any evidence."

IF IS_CAR_DEAD car_meat3
	PRINT_NOW ( MEA3_2 ) 5000 1 //"You were told to dump the vehicle in the sea!"
	GOTO mission_failed_meat3
ENDIF

IF IS_CAR_UPSIDEDOWN car_meat3
AND IS_CAR_STOPPED car_meat3
	PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
	GOTO mission_failed_meat3
ENDIF

// waiting for the car to be dumped in the water

WHILE NOT IS_CAR_IN_WATER car_meat3

	WAIT 0

	IF IS_CAR_DEAD car_meat3
		
		IF NOT IS_CAR_IN_WATER car_meat3 
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat3
		ENDIF

	ELSE

		IF NOT IS_PLAYER_IN_CAR player car_meat3
		AND flag_player_had_car_message_meat3 = 0
			ADD_BLIP_FOR_CAR car_meat3 radar_blip_car_meat3
			flag_player_had_car_message_meat3 = 1
		ENDIF

		IF IS_PLAYER_IN_CAR player car_meat3
		AND flag_player_had_car_message_meat3 = 1
			REMOVE_BLIP radar_blip_car_meat3
			PRINT_NOW ( MEA3_B6 ) 5000 1 //"Dump the vehicle in the sea!"
			flag_player_had_car_message_meat3 = 0
		ENDIF

	ENDIF
			
ENDWHILE

} 			   
GOTO mission_passed_meat3



// Mission Failed

mission_failed_meat3:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN


		
// Mission Passed
	
mission_passed_meat3:

PRINT_WITH_NUMBER_BIG ( m_pass ) 2000 5000 1 //"Mission Passed!"
REGISTER_MISSION_PASSED ( MEA3 )
PLAYER_MADE_PROGRESS 1
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 3000
flag_meat_mission3_passed = 1
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT meat_mission4_loop

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN


// Mission Cleanup

mission_cleanup_meat3:

flag_player_on_mission = 0
flag_player_on_meat_mission = 0
REMOVE_CHAR_ELEGANTLY wife_meat3 
MARK_MODEL_AS_NO_LONGER_NEEDED PED_FEMALE2
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_ESPERANTO
REMOVE_BLIP radar_blip_ped1_meat3
REMOVE_BLIP radar_blip_car_meat3
REMOVE_BLIP radar_blip_coord2_meat3
MISSION_HAS_FINISHED
RETURN

MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************
// ***********************************Meat Factory Mission 4**********************************
// **************************************"The Loan Shark"*************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME meat4

// Mission Start Stuff

GOSUB mission_start_meat4

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_failed_meat4
	ENDIF

GOSUB mission_cleanup_meat4

MISSION_END


// Variable for mission

VAR_INT car_meat4

VAR_INT loanshark_meat4

VAR_INT owner_meat4

VAR_INT radar_blip_car_meat4

VAR_INT radar_blip_ped1_meat4

VAR_INT flag_player_had_car_message_meat4

VAR_INT radar_blip_coord2_meat4

VAR_INT flag_owner_dead_meat4

VAR_INT flag_loanshark_in_area

// ****************************************Mission Start************************************

mission_start_meat4:

flag_player_on_mission = 1

flag_player_on_meat_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_player_had_car_message_meat4 = 0

flag_loanshark_in_area = 0

flag_owner_dead_meat4 = 0

blob_flag = 1

{

// ********************************START OF CUTSCENE****************************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_failed_meat4
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( MEA4 ) 15000 2 //"HER LOVER"

SWITCH_STREAMING OFF

//LOAD_SPECIAL_MODEL cut_obj1 PLAYERH	 

WHILE GET_FADING_STATUS
					  
	WAIT 0

ENDWHILE
*/


SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS 1164.25 -888.87 10.0 1291.76 -811.71 20.0

//LOAD_ALL_MODELS_NOW

//WHILE NOT HAS_MODEL_LOADED cut_obj1

//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE mt_ph4 
SET_CUTSCENE_OFFSET 1223.88 -839.414 13.95
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player


DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2096
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( MEA4_A ) 10000 1 //"Damn I'm in trouble..." 

WHILE cs_time < 3885
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA4_B ) 10000 1  //"Turns out my wife..." 

WHILE cs_time < 7252
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA4_C ) 10000 1  //"He's got real..." 

WHILE cs_time < 10502
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA4_D ) 10000 1 //"I've agreed to see him...." 

WHILE cs_time < 11844
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA4_E ) 10000 1 //"He thinks that..." 

WHILE cs_time < 13374
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA4_F ) 10000 1  //but my guess..." 

WHILE cs_time < 14622
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( MEA4_G ) 10000 1  //"Liberty's dogs..."

WHILE cs_time < 17623
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( MEA4_G ) 

WHILE cs_time < 18233
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

WAIT 500

DO_FADE 1500 FADE_IN

//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

SET_PED_DENSITY_MULTIPLIER 1.0

// ********************************END OF CUTSCENE******************************************

REQUEST_MODEL PED_FAN_MAN2

REQUEST_MODEL PED_B_MAN2

REQUEST_MODEL CAR_STALLION

LOAD_MISSION_AUDIO MF3_A

WHILE NOT HAS_MODEL_LOADED PED_FAN_MAN2
OR NOT HAS_MODEL_LOADED PED_B_MAN2
OR NOT HAS_MODEL_LOADED CAR_STALLION
OR NOT HAS_MISSION_AUDIO_LOADED 

	WAIT 0

ENDWHILE


CREATE_CAR CAR_STALLION 1190.0 -796.0 13.8 car_meat4

SET_CAR_HEADING car_meat4 300.0

ADD_BLIP_FOR_CAR car_meat4 radar_blip_car_meat4

// waiting for the player to get into the car

WHILE NOT IS_PLAYER_IN_CAR player car_meat4

	WAIT 0
			
	IF IS_CAR_DEAD car_meat4
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat4
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat4
	AND IS_CAR_STOPPED car_meat4
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat4
	ENDIF
	
ENDWHILE

REMOVE_BLIP radar_blip_car_meat4

PRINT_NOW ( MEA4_B3 ) 7000 1 //"Pick up the Loan Shark, press the horn to get him into the car!"

CREATE_CHAR PEDTYPE_CIVMALE PED_FAN_MAN2 897.0 -476.0 14.6 loanshark_meat4

SET_CHAR_PERSONALITY loanshark_meat4 PEDSTAT_TOUGH_GUY

CLEAR_CHAR_THREAT_SEARCH loanshark_meat4

TURN_CHAR_TO_FACE_COORD loanshark_meat4 895.0 -486.0 -100.0

ADD_BLIP_FOR_CHAR loanshark_meat4 radar_blip_ped1_meat4

SET_CHAR_CANT_BE_DRAGGED_OUT loanshark_meat4 TRUE

// player is in area

//WHILE NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player loanshark_meat4 8.0 8.0 FALSE
WHILE NOT LOCATE_PLAYER_IN_CAR_2D player 897.25 -487.28 8.0 25.0 FALSE
OR NOT IS_PLAYER_IN_CAR player car_meat4

	WAIT 0
		
	IF IS_CAR_DEAD car_meat4
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_failed_meat4
	ENDIF
	
	IF IS_CHAR_DEAD loanshark_meat4
		PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
		GOTO mission_failed_meat4
	ENDIF
      
	IF NOT IS_PLAYER_IN_CAR player car_meat4
	AND flag_player_had_car_message_meat4 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat4 radar_blip_car_meat4
		REMOVE_BLIP radar_blip_ped1_meat4
		flag_player_had_car_message_meat4 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat4
	AND flag_player_had_car_message_meat4 = 1
		REMOVE_BLIP radar_blip_car_meat4
		ADD_BLIP_FOR_CHAR loanshark_meat4 radar_blip_ped1_meat4
		flag_player_had_car_message_meat4 = 0
		blob_flag = 1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat4
	AND IS_CAR_STOPPED car_meat4
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat4
	ENDIF
	
ENDWHILE

// tells the bloke to get into the players car

SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER loanshark_meat4 car_meat4

WHILE NOT IS_CHAR_IN_CAR loanshark_meat4 car_meat4
OR NOT IS_PLAYER_IN_CAR player car_meat4

	WAIT 0
			
	IF IS_CAR_DEAD car_meat4

		IF IS_CHAR_DEAD loanshark_meat4
			PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
			GOTO mission_failed_meat4
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat4
		ENDIF

	ENDIF
	
	IF IS_CHAR_DEAD loanshark_meat4
		PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
		GOTO mission_failed_meat4
	ELSE

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player loanshark_meat4 30.0 30.0 30.0 FALSE
			PRINT_NOW ( MEA4_3 ) 5000 1 //"You left the Loan Shark behind"
			GOTO mission_failed_meat4
		ENDIF

	ENDIF
			

	IF NOT IS_PLAYER_IN_CAR player car_meat4
	AND flag_player_had_car_message_meat4 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat4 radar_blip_car_meat4
		REMOVE_BLIP radar_blip_ped1_meat4
		flag_player_had_car_message_meat4 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat4
	AND flag_player_had_car_message_meat4 = 1
		REMOVE_BLIP radar_blip_car_meat4
		ADD_BLIP_FOR_CHAR loanshark_meat4 radar_blip_ped1_meat4
		flag_player_had_car_message_meat4 = 0
		blob_flag = 1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat4
	AND IS_CAR_STOPPED car_meat4
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat4
	ENDIF
	
ENDWHILE

REMOVE_BLIP radar_blip_ped1_meat4

PLAY_MISSION_AUDIO 

PRINT_NOW ( MEA4_B4 ) 10000 1 //"This little "Spank" junkie better have my money, get me to the factory"

IF HAS_MISSION_AUDIO_FINISHED
	CLEAR_THIS_PRINT ( MEA4_B4 )
ENDIF

ADD_BLIP_FOR_COORD 1217.0 -794.0 -100.0 radar_blip_coord2_meat4

CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN2 1208.0 -789.0 13.9 owner_meat4

CLEAR_CHAR_THREAT_SEARCH owner_meat4

TURN_CHAR_TO_FACE_COORD owner_meat4 1210.0 -791.0 -100.0

blob_flag = 1

WHILE NOT LOCATE_STOPPED_CHAR_IN_CAR_3D	loanshark_meat4 1217.0 -794.0 13.9 4.0 4.0 6.0 blob_flag
OR NOT IS_CHAR_IN_CAR loanshark_meat4 car_meat4

	WAIT 0

	IF HAS_MISSION_AUDIO_FINISHED
		CLEAR_THIS_PRINT ( MEA4_B4 )
	ENDIF
		
	IF IS_CAR_DEAD car_meat4

		IF IS_CHAR_DEAD loanshark_meat4
			PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
			GOTO mission_failed_meat4
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat4
		ENDIF

	ENDIF
	
	IF IS_CHAR_DEAD loanshark_meat4
		PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
		GOTO mission_failed_meat4
	ELSE

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player loanshark_meat4 30.0 30.0 30.0 FALSE
			PRINT_NOW ( MEA4_3 ) 5000 1 //"You left the Loan Shark behind"
			GOTO mission_failed_meat4
		ENDIF

	ENDIF

	IF IS_CHAR_DEAD owner_meat4
		PRINT_NOW ( MEA4_2 ) 5000 1 //"The factory owners dead!"
		GOTO mission_failed_meat4
	ENDIF
    
	IF NOT IS_PLAYER_IN_CAR player car_meat4
	AND flag_player_had_car_message_meat4 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission!"
		ADD_BLIP_FOR_CAR car_meat4 radar_blip_car_meat4
		REMOVE_BLIP radar_blip_coord2_meat4
		flag_player_had_car_message_meat4 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_CAR player car_meat4
	AND flag_player_had_car_message_meat4 = 1
		REMOVE_BLIP radar_blip_car_meat4
		ADD_BLIP_FOR_COORD 1217.0 -794.0 -100.0 radar_blip_coord2_meat4
		flag_player_had_car_message_meat4 = 0
		blob_flag = 1
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat4
	AND IS_CAR_STOPPED car_meat4
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat4
	ENDIF

ENDWHILE

REMOVE_BLIP radar_blip_coord2_meat4

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

SET_POLICE_IGNORE_PLAYER player ON

LEAVE_GROUP loanshark_meat4

SET_CHAR_CANT_BE_DRAGGED_OUT loanshark_meat4 FALSE

SET_CHAR_OBJ_LEAVE_CAR loanshark_meat4 car_meat4

WHILE IS_CHAR_IN_CAR loanshark_meat4 car_meat4

	WAIT 0
			
	IF IS_CAR_DEAD car_meat4

		IF IS_CHAR_DEAD loanshark_meat4
			PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
			GOTO mission_failed_meat4
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_failed_meat4
		ENDIF

	ENDIF
	
	IF IS_CHAR_DEAD loanshark_meat4
		PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
		GOTO mission_failed_meat4
	ENDIF

	IF IS_CHAR_DEAD owner_meat4
		PRINT_NOW ( MEA4_2 ) 5000 1 //"The factory owners dead!"
		GOTO mission_failed_meat4
	ENDIF

	IF IS_CAR_UPSIDEDOWN car_meat4
	AND IS_CAR_STOPPED car_meat4
		PRINT_NOW ( UPSIDE ) 5000 1 //"The vehicle's upsidedown!"
		GOTO mission_failed_meat4
	ENDIF
	
ENDWHILE

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT loanshark_meat4 1209.6 -791.0

SET_FIXED_CAMERA_POSITION 1218.1 -795.0 16.0 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 1204.6 -785.7 13.9 JUMP_CUT

CLEAR_AREA 1212.0 -792.0 14.0 10.0 TRUE

LOAD_MISSION_AUDIO MF3_B

// Waiting for the blokes to get to the meat grinding area

timerb = 0

WHILE NOT flag_loanshark_in_area = 1
OR NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0
					
	IF IS_CHAR_DEAD loanshark_meat4
		PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
		GOTO mission_failed_meat4
	ENDIF

	IF IS_CHAR_DEAD owner_meat4
		PRINT_NOW ( MEA4_2 ) 5000 1 //"The factory owners dead!"
		GOTO mission_failed_meat4
	ENDIF
	   
	IF flag_loanshark_in_area = 0

		IF LOCATE_CHAR_ON_FOOT_2D loanshark_meat4 1209.6 -791.0 0.5 0.5 FALSE
			flag_loanshark_in_area = 1
		ENDIF

	ENDIF

	IF timerb >= 25000

		IF NOT flag_loanshark_in_area = 1
			SET_CHAR_COORDINATES loanshark_meat4 1209.6 -791.0 13.7  
			GOTO loanshark_got_stuck
		ENDIF

	ENDIF
		
ENDWHILE

loanshark_got_stuck:

CHAR_SET_IDLE loanshark_meat4

TURN_CHAR_TO_FACE_CHAR loanshark_meat4 owner_meat4  	

PLAY_MISSION_AUDIO

PRINT_NOW ( MEA4_B5 ) 10000 1 //"Emm hi, I need more time to get the money."

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CHAR_DEAD loanshark_meat4
		PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
		GOTO mission_failed_meat4
	ENDIF

	IF IS_CHAR_DEAD owner_meat4
		PRINT_NOW ( MEA4_2 ) 5000 1 //"The factory owners dead!"
		GOTO mission_failed_meat4
	ENDIF

ENDWHILE

CLEAR_THIS_PRINT ( MEA4_B5 )

LOAD_MISSION_AUDIO MF3_B1

TURN_CHAR_TO_FACE_CHAR loanshark_meat4 owner_meat4

WHILE NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0

	IF IS_CHAR_DEAD loanshark_meat4
		PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
		GOTO mission_failed_meat4
	ENDIF

	IF IS_CHAR_DEAD owner_meat4
		PRINT_NOW ( MEA4_2 ) 5000 1 //"The factory owners dead!"
		GOTO mission_failed_meat4
	ENDIF

ENDWHILE

TURN_CHAR_TO_FACE_CHAR loanshark_meat4 owner_meat4

PLAY_MISSION_AUDIO

PRINT_NOW ( MEA4_B7 ) 20000 1 //"But if you just step into my office I could..."

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CHAR_DEAD loanshark_meat4
		PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
		GOTO mission_failed_meat4
	ENDIF

	IF IS_CHAR_DEAD owner_meat4
		PRINT_NOW ( MEA4_2 ) 5000 1 //"The factory owners dead!"
		GOTO mission_failed_meat4
	ENDIF

ENDWHILE

TURN_CHAR_TO_FACE_CHAR loanshark_meat4 owner_meat4

CLEAR_THIS_PRINT ( MEA4_B7 )

LOAD_MISSION_AUDIO MF3_C

WHILE NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0

	IF IS_CHAR_DEAD loanshark_meat4
		PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
		GOTO mission_failed_meat4
	ENDIF

	IF IS_CHAR_DEAD owner_meat4
		PRINT_NOW ( MEA4_2 ) 5000 1 //"The factory owners dead!"
		GOTO mission_failed_meat4
	ENDIF

ENDWHILE

TURN_CHAR_TO_FACE_CHAR loanshark_meat4 owner_meat4

PLAY_MISSION_AUDIO

PRINT_NOW ( MEA4_B6 ) 10000 1 //"I warned you about defaulting on a payment!"

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CHAR_DEAD loanshark_meat4
		PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
		GOTO mission_failed_meat4
	ENDIF

	IF IS_CHAR_DEAD owner_meat4
		PRINT_NOW ( MEA4_2 ) 5000 1 //"The factory owners dead!"
		GOTO mission_failed_meat4
	ENDIF

ENDWHILE

CLEAR_THIS_PRINT ( MEA4_B6 )

GIVE_WEAPON_TO_CHAR loanshark_meat4 WEAPONTYPE_SHOTGUN 2

SET_CHAR_OBJ_KILL_CHAR_ON_FOOT loanshark_meat4 owner_meat4

// Waiting for the owner to be killed

timera = 0

WHILE NOT flag_owner_dead_meat4 = 1

	WAIT 0

	IF HAS_MISSION_AUDIO_FINISHED
		CLEAR_THIS_PRINT ( MEA4_B6 )
	ENDIF

	IF IS_CHAR_DEAD owner_meat4
		flag_owner_dead_meat4 = 1
	ENDIF
					
	IF IS_CHAR_DEAD loanshark_meat4
		PRINT_NOW ( MEA4_1 ) 5000 1 //"The Loan Sharks dead!"
		GOTO mission_failed_meat4
	ENDIF

	IF timera > 10000
		
		IF NOT IS_CHAR_DEAD owner_meat4
			flag_owner_dead_meat4 = 1
		ENDIF
		
	ENDIF	

ENDWHILE

IF HAS_MISSION_AUDIO_FINISHED
	CLEAR_THIS_PRINT ( MEA4_B6 )
ENDIF

SWITCH_WIDESCREEN OFF

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

RESTORE_CAMERA_JUMPCUT

}
 			   
GOTO mission_passed_meat4



// Mission Failed

mission_failed_meat4:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

IF NOT IS_CHAR_DEAD owner_meat4
	REMOVE_CHAR_ELEGANTLY owner_meat4
ENDIF

IF NOT IS_CHAR_DEAD loanshark_meat4
	REMOVE_CHAR_ELEGANTLY loanshark_meat4
ENDIF

RETURN


		
// Mission Passed
	
mission_passed_meat4:

PRINT_WITH_NUMBER_BIG ( m_pass ) 4000 5000 1 //"Mission Passed!"
REGISTER_MISSION_PASSED ( MEA4 )
PLAYER_MADE_PROGRESS 1
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 4000
flag_meat_mission4_passed = 1
CLEAR_WANTED_LEVEL player

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN


// Mission Cleanup

mission_cleanup_meat4:

flag_player_on_mission = 0
flag_player_on_meat_mission = 0
MARK_MODEL_AS_NO_LONGER_NEEDED PED_FAN_MAN2
MARK_MODEL_AS_NO_LONGER_NEEDED PED_B_MAN2
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STALLION
REMOVE_BLIP radar_blip_ped1_meat4
REMOVE_BLIP radar_blip_car_meat4
REMOVE_BLIP radar_blip_coord2_meat4
MISSION_HAS_FINISHED
RETURN

MISSION_START 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// **************************************8Ball Mission**************************************
// **************************************Luigi's Girls**************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME eight


// Mission start stuff

GOSUB mission_start_eightball

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_eightball_failed
ENDIF

GOSUB mission_cleanup_eightball

MISSION_END


// Variables for mission


VAR_INT radar_blip_car1_eightball

VAR_INT radar_blip_coord1_eightball

VAR_INT radar_blip_coord2_eightball

VAR_INT eightball 	

VAR_INT car_eightball  //Any car the player might get into

VAR_INT van_8ball //Car that I create

VAR_INT flag_blip_on_eightball

VAR_INT flag_player_got_cops_message_eightball

VAR_INT flag_player_got_car_message1_eightball

VAR_INT radar_blip_ped1_eightball

VAR_INT flag_player_in_area

VAR_INT flag_eightball_in_area


// Luigi variables for missions

VAR_INT radar_blip_coord1_lm1

VAR_INT radar_blip_ped1_lm1

VAR_INT radar_blip_ped2_lm1

VAR_INT girl1_lm1

VAR_INT car_lm1

VAR_INT flag_player_had_car_message_lm1

VAR_INT flag_player_not_in_car_message_lm1

VAR_INT no_of_passengers_car_lm1

VAR_INT flag_girl1_in_car_lm1

VAR_INT passenger_count_lm1

VAR_INT total_space_in_car_lm1

VAR_INT flag_blip_on_girl1_lm1

VAR_INT flag_coord_blip_on

VAR_INT flag_luigi_coord1_blip_created

VAR_INT flag_luigi_ped1_blip_created

VAR_INT flag_girl1_in_group_lm1

VAR_INT flag_player_had_vehicle_message_lm1

VAR_INT flag_player_in_area_lm1

VAR_INT flag_eightball_in_area_lm1

VAR_INT flag_help_8ball1

VAR_INT flag_help_8ball2

// car variables for restart

VAR_FLOAT car_8ball_x

VAR_FLOAT car_8ball_y

VAR_FLOAT car_8ball_z

VAR_FLOAT car_8ball_heading

VAR_INT flag_car_message_8ball

VAR_INT cop_car1_8ball

VAR_INT cop_car2_8ball

VAR_INT cop1_8ball

VAR_INT cop2_8ball

VAR_INT flag_brake_message  // Brake message

VAR_INT flag_hbrake_message  // Handbrake message

VAR_INT flag_look2_8ball  // Look right message

VAR_INT flag_look3_8ball // Look behind message

VAR_INT flag_misty_stop  // Misty message to tell player to stop and let her in the car

VAR_INT flag_player_had_camera_message_8ball // Tells player how to change camera modes

VAR_INT car_colour1_8ball

VAR_INT	car_colour2_8ball

VAR_INT flag_girl_in_group_lm1

VAR_INT radar_blip_car1_lm1

VAR_INT flag_timer_stopped_flashing_8ball  // Stops the radar flashing

VAR_INT fire_sound_8ball 

// ***************************************Mission Start*************************************

mission_start_eightball:

flag_player_on_mission = 1

flag_player_on_eightball_mission = 1

REGISTER_MISSION_GIVEN

DISPLAY_RADAR 5 // HACKED PATHING ENABLE SWITCHED OFF

FORCE_WEATHER_NOW WEATHER_CLOUDY

SET_TIME_OF_DAY 4 0 

LOAD_SCENE 807.0 -937.0 36.6  // THIS MIGHT HAVE TO COME OUT!!!!!!!!!!!!!!!!!!!!!!!!!!!

WAIT 0

flag_blip_on_eightball = 0

flag_player_got_cops_message_eightball = 0

flag_player_got_car_message1_eightball = 0

flag_player_in_area = 0 

flag_eightball_in_area = 0

// luigi variables

flag_player_had_car_message_lm1 = 0

flag_player_not_in_car_message_lm1 = 0

no_of_passengers_car_lm1 = 0

flag_girl1_in_car_lm1 = 0

passenger_count_lm1 = 0

total_space_in_car_lm1 = 0

flag_blip_on_girl1_lm1 = 0

flag_coord_blip_on = 0

blob_flag = 1

// luigi blip stuff

flag_luigi_coord1_blip_created = 0
flag_luigi_ped1_blip_created = 0
flag_girl1_in_group_lm1 = 0
flag_player_had_vehicle_message_lm1 = 0

flag_player_in_area_lm1 = 0

flag_eightball_in_area_lm1 = 0

flag_help_8ball1 = 0

flag_help_8ball2 = 0

flag_car_message_8ball = 0

flag_brake_message = 0

flag_hbrake_message = 0

flag_look2_8ball = 0

flag_look3_8ball = 0

flag_misty_stop = 0

flag_player_had_camera_message_8ball = 0

flag_girl_in_group_lm1 = 0

flag_timer_stopped_flashing_8ball = 0

{	
IF flag_reached_hideout = 0

	REQUEST_MODEL CAR_KURUMA

	LOAD_SPECIAL_CHARACTER 1 eight
	
	LOAD_ALL_MODELS_NOW

	car_8ball_x = 0.0

	car_8ball_y = 0.0

	car_8ball_z = 0.0

	car_8ball_heading = 0.0

	car_colour1_8ball = 0

	car_colour2_8ball = 0
				
ELSE
	
	GOTO hideout_reached

ENDIF

IF flag_bridge_created_8ball = 0
	CREATE_OBJECT_NO_OFFSET bridgefuka 715.746 -937.908 40.194 damagea
	DONT_REMOVE_OBJECT damagea

	CREATE_OBJECT_NO_OFFSET bridgefukb 787.835 -939.24 38.971 damageb
	DONT_REMOVE_OBJECT damageb
	flag_bridge_created_8ball = 1
ENDIF

SET_PLAYER_HEADING player 180.0

CREATE_CAR CAR_KURUMA 812.0131 -945.5528 35.7889 car_eightball  // new Aaron position

CHANGE_CAR_COLOUR car_eightball 58 1

SET_CAR_HEADING car_eightball 262.3871

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 811.90 -942.47 -100.0 eightball  // New Aaron position

SET_ANIM_GROUP_FOR_CHAR eightball ANIM_GANG2_PED

CLEAR_CHAR_THREAT_SEARCH eightball

TURN_CHAR_TO_FACE_COORD eightball 811.90 -939.95 35.8  // New Aaron position

CHAR_LOOK_AT_PLAYER_ALWAYS eightball player

OVERRIDE_NEXT_RESTART 811.90 -939.95 35.8 180.0 //Restarts at the bridge

SET_OBJECT_HEADING playersdoor 0.0

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

ADD_PARTICLE_EFFECT 4 791.661 -936.916 38.313 FALSE //SMOKE ON CARS
ADD_PARTICLE_EFFECT 4 788.337 -938.467 38.073 FALSE
ADD_PARTICLE_EFFECT 4 786.493 -942.398 39.8   FALSE

ADD_PARTICLE_EFFECT 10 783.572 -938.549 38.448 FALSE //FIRE ON CARS
ADD_PARTICLE_EFFECT 10 790.537 -935.67  38.005 FALSE
ADD_PARTICLE_EFFECT 10 789.295 -938.882 38.127 FALSE

REMOVE_SOUND fire_sound_8ball

ADD_CONTINUOUS_SOUND 790.537 -935.67  38.005 SOUND_PRETEND_FIRE_LOOP fire_sound_8ball

SET_POLICE_IGNORE_PLAYER player ON

SET_FIXED_CAMERA_POSITION 785.0 -936.77 39.75 0.0 0.0 0.0 // New position

POINT_CAMERA_AT_CHAR eightball fixed jump_cut

LOAD_MISSION_AUDIO LIB_A1

SET_FADING_COLOUR 0 0 0

DO_FADE 1000 FADE_IN

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
	
SET_FADING_COLOUR 0 0 0

WHILE NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ENDIF

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF

ENDWHILE

WAIT 2000

IF IS_CHAR_DEAD eightball
	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	GOTO mission_eightball_failed
ENDIF

IF IS_CAR_DEAD car_eightball

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ELSE
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   		GOTO mission_eightball_failed
   	ENDIF

ELSE

	IF IS_CAR_UPSIDEDOWN car_eightball
	AND IS_CAR_STOPPED car_eightball 
		PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
		GOTO mission_eightball_failed
   	ENDIF

ENDIF

SET_FIXED_CAMERA_POSITION 804.5746 -933.048 39.9828 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 805.1921 -933.7454 39.6193 JUMP_CUT

PRINT_BIG ( EBAL ) 15000 2 //"Give me Liberty"

PLAY_MISSION_AUDIO

PRINT_NOW ( EBAL_A ) 5000 1 //"I know a place on the edge of the Red Light District where we can lay low,

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ENDIF

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF

ENDWHILE

CLEAR_THIS_PRINT ( EBAL_A )

LOAD_MISSION_AUDIO LIB_A2

WHILE NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ENDIF

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF

ENDWHILE

PLAY_MISSION_AUDIO

PRINT_NOW ( EBAL_A1 ) 5000 1 //"but my hands are badly burned so you'll have to drive.""

IF HAS_MISSION_AUDIO_FINISHED
	CLEAR_THIS_PRINT ( EBAL_A1 )
ENDIF

IF IS_CHAR_DEAD eightball
	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	GOTO mission_eightball_failed
ENDIF

IF IS_CAR_DEAD car_eightball

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ELSE
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   		GOTO mission_eightball_failed
   	ENDIF

ELSE

	IF IS_CAR_UPSIDEDOWN car_eightball
	AND IS_CAR_STOPPED car_eightball 
		PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
		GOTO mission_eightball_failed
   	ENDIF

ENDIF

STOP_CHAR_LOOKING eightball

SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER eightball car_eightball

WHILE NOT IS_CHAR_IN_CAR eightball car_eightball

	WAIT 0

	IF HAS_MISSION_AUDIO_FINISHED
		CLEAR_THIS_PRINT ( EBAL_A1 )
	ENDIF

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ENDIF

   	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF
      	
ENDWHILE

IF HAS_MISSION_AUDIO_FINISHED
	CLEAR_THIS_PRINT ( EBAL_A1 )
ENDIF

// This will tune the radio to HEAD RADIO

IF flag_done_radio_8ball = 0
	SET_RADIO_CHANNEL HEAD_RADIO 0
	flag_done_radio_8ball = 1
ELSE
   SET_RADIO_CHANNEL HEAD_RADIO -1
ENDIF

SET_CHAR_CANT_BE_DRAGGED_OUT eightball TRUE

SWITCH_WIDESCREEN OFF

RESTORE_CAMERA

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

ADD_BLIP_FOR_CAR car_eightball radar_blip_car1_eightball

GOSUB car_gen_start_8ball  // This turns on all the car generators in the level

WAIT 500

IF HAS_MISSION_AUDIO_FINISHED
	CLEAR_THIS_PRINT ( EBAL_A1 )
ENDIF

IF IS_CHAR_DEAD eightball
	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	GOTO mission_eightball_failed
ENDIF

IF IS_CAR_DEAD car_eightball

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ELSE
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   		GOTO mission_eightball_failed
   	ENDIF

ELSE

	IF IS_CAR_UPSIDEDOWN car_eightball
	AND IS_CAR_STOPPED car_eightball 
		PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
		GOTO mission_eightball_failed
   	ENDIF

ENDIF

// gives the player the help message for entering cars

PRINT_HELP ( EBAL_1 ) //"Press Triangle to enter a vehicle." 

timerb = 0 // Timer for police wanted level stuff

WAIT 3000

IF IS_CHAR_DEAD eightball
	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	GOTO mission_eightball_failed
ENDIF

IF IS_CAR_DEAD car_eightball

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ELSE
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   		GOTO mission_eightball_failed
   	ENDIF

ELSE

	IF IS_CAR_UPSIDEDOWN car_eightball
	AND IS_CAR_STOPPED car_eightball 
		PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
		GOTO mission_eightball_failed
   	ENDIF

ENDIF
		
// Waiting for the player to get into the car

WHILE NOT IS_PLAYER_IN_CAR player car_eightball
OR NOT IS_CHAR_IN_CAR eightball car_eightball

	WAIT 0

	IF timerb < 120000  // 2 mins
		CLEAR_WANTED_LEVEL player
	ENDIF

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	    GOTO mission_eightball_failed
	ENDIF
								
ENDWHILE

// creates two cops cars that drive onto the bridge

CREATE_CAR car_police 1083.2 -945.0 13.8 cop_car1_8ball

CREATE_CHAR_INSIDE_CAR cop_car1_8ball PEDTYPE_CIVMALE PED_COP cop1_8ball

CLEAR_CHAR_THREAT_SEARCH cop1_8ball

SET_CAR_HEADING cop_car1_8ball 90.0

SWITCH_CAR_SIREN cop_car1_8ball ON

SET_CAR_DRIVING_STYLE cop_car1_8ball 2

SET_CAR_CRUISE_SPEED  cop_car1_8ball 20.0

CAR_GOTO_COORDINATES cop_car1_8ball 713.9 -916.7 42.0

CREATE_CAR car_police 1074.1 -946.7 13.8 cop_car2_8ball

CREATE_CHAR_INSIDE_CAR cop_car2_8ball PEDTYPE_CIVMALE PED_COP cop2_8ball

CLEAR_CHAR_THREAT_SEARCH cop2_8ball

SET_CAR_HEADING cop_car2_8ball 90.0

SWITCH_CAR_SIREN cop_car2_8ball ON

SET_CAR_DRIVING_STYLE cop_car2_8ball 2

SET_CAR_CRUISE_SPEED cop_car2_8ball 20.0

CAR_GOTO_COORDINATES cop_car2_8ball 718.7 -922.2 42.0 

REMOVE_BLIP radar_blip_car1_eightball

// Accelertation help messages

WAIT 500

IF timerb < 120000  // 2 mins
	CLEAR_WANTED_LEVEL player
ENDIF

IF IS_CAR_DEAD car_eightball

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ELSE
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   		GOTO mission_eightball_failed
   	ENDIF

ELSE

	IF IS_CAR_UPSIDEDOWN car_eightball
	AND IS_CAR_STOPPED car_eightball 
		PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
		GOTO mission_eightball_failed
   	ENDIF

ENDIF

IF IS_CHAR_DEAD eightball
	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	GOTO mission_eightball_failed
ENDIF

PRINT_HELP ( HELP4_A ) //"Press the / button to accelerate."

ADD_BLIP_FOR_COORD 875.0 -309.0 -100.0 radar_blip_coord1_eightball

timera = 0

blob_flag = 1

IF timerb < 120000  // 2 mins
	CLEAR_WANTED_LEVEL player
ENDIF

LOAD_MISSION_AUDIO LIB_A


timera = 0

WHILE timera < 10000

	WAIT 0

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	    GOTO mission_eightball_failed
	ENDIF
		   	   	
	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

		IF NOT IS_PLAYER_IN_CAR player car_eightball

			blob_flag = 0
			
			IF flag_car_message_8ball = 0
				PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the car and get on with the mission!"
				REMOVE_BLIP radar_blip_coord1_eightball
				ADD_BLIP_FOR_CAR car_eightball radar_blip_car1_eightball
				flag_car_message_8ball = 1
			ENDIF
			
		ELSE

			blob_flag = 1
		
			IF flag_car_message_8ball = 1
				REMOVE_BLIP radar_blip_car1_eightball
				ADD_BLIP_FOR_COORD 875.0 -309.0 -100.0 radar_blip_coord1_eightball
				flag_car_message_8ball = 0
			ENDIF
			
		ENDIF
		
	ENDIF   
	
	IF LOCATE_PLAYER_IN_CAR_2D player 875.0 -309.0 20.0 20.0 FALSE
	AND IS_PLAYER_IN_CAR player car_eightball
	AND flag_help_8ball1 = 0
		PRINT_HELP ( HELP1 ) //Stop in the centre of the red dome."
		flag_help_8ball1 = 1
	ENDIF
	
ENDWHILE

PRINT_HELP ( EBAL_3 )  // "This is the ~h~radar~w~. Use it to navigate the city. Follow the ~h~GPS route~w~ on the ~h~radar~w~ to find the hideout." );

FLASH_HUD_OBJECT HUD_FLASH_RADAR

timera = 0

// waiting for the player to get to Luigi's

WHILE NOT IS_PLAYER_STOPPED_IN_AREA_IN_CAR_3D player 879.4 -303.4 7.3 870.1 -311.7 10.0 blob_flag
OR NOT IS_CHAR_STOPPED_IN_AREA_IN_CAR_3D eightball 879.4 -303.4 7.3 870.1 -311.7 10.0 FALSE
OR NOT IS_PLAYER_SITTING_IN_CAR player car_eightball
OR NOT IS_CHAR_SITTING_IN_CAR eightball car_eightball
OR NOT HAS_MISSION_AUDIO_LOADED 

 	WAIT 0

	IF timerb < 120000  // 2 mins
		CLEAR_WANTED_LEVEL player
	ENDIF

	IF flag_timer_stopped_flashing_8ball = 0

		IF timera > 4000
			FLASH_HUD_OBJECT -1
			flag_timer_stopped_flashing_8ball = 1
		ENDIF

	ENDIF
	
	IF flag_brake_message = 0

		IF timera >= 10000
						
			PRINT_HELP ( HELP5_A ) //"Press the ^ button to brake, when stopped this will make the vehicle reverse."

			flag_brake_message = 1
			timera = 0

		ENDIF

	ENDIF

	IF timera > 10000
			  		 
		IF flag_hbrake_message = 0
			PRINT_HELP ( HELP6_A ) //"Press the R1 button to apply the vehicle's handbrake."
			flag_hbrake_message = 1
		ENDIF
					
	ENDIF
		
	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	    GOTO mission_eightball_failed
	ENDIF
		   	   	
	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

		IF NOT IS_PLAYER_IN_CAR player car_eightball

			blob_flag = 0
			
			IF flag_car_message_8ball = 0
				PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the car and get on with the mission!"
				REMOVE_BLIP radar_blip_coord1_eightball
				ADD_BLIP_FOR_CAR car_eightball radar_blip_car1_eightball
				flag_car_message_8ball = 1
			ENDIF
			
		ELSE

			blob_flag = 1
		
			IF flag_car_message_8ball = 1
				REMOVE_BLIP radar_blip_car1_eightball
				ADD_BLIP_FOR_COORD 875.0 -309.0 -100.0 radar_blip_coord1_eightball
				flag_car_message_8ball = 0
			ENDIF
			
		ENDIF
		
	ENDIF   
	
	IF LOCATE_PLAYER_IN_CAR_2D player 875.0 -309.0 20.0 20.0 FALSE
	AND IS_PLAYER_IN_CAR player car_eightball
	AND flag_help_8ball1 = 0
		PRINT_HELP ( HELP1 ) //Stop in the centre of the red dome."
		flag_help_8ball1 = 1
	ENDIF
            	 	   
ENDWHILE

CLEAR_HELP

REMOVE_BLIP radar_blip_coord1_eightball

// ******************************Player and 8ball are at base scripted cutscene*************

SWITCH_WIDESCREEN ON

CLEAR_WANTED_LEVEL player

SET_POLICE_IGNORE_PLAYER player ON

SET_PLAYER_CONTROL player OFF

IF NOT IS_CAR_DEAD cop_car1_8ball
	DELETE_CAR cop_car1_8ball
ENDIF

IF NOT IS_CAR_DEAD cop_car2_8ball
	DELETE_CAR cop_car2_8ball
ENDIF


CLEAR_AREA 886.8 -310.1 -100.0 2.0 TRUE

GET_CAR_COORDINATES car_eightball car_8ball_x car_8ball_y car_8ball_z

GET_CAR_HEADING car_eightball car_8ball_heading

GET_CAR_COLOURS car_eightball car_colour1_8ball car_colour2_8ball 

WHILE NOT ROTATE_OBJECT playersdoor 210.0 10.0 FALSE

	WAIT 0

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF
			
	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	    GOTO mission_eightball_failed
	ENDIF

ENDWHILE

CLEAR_AREA 889.7 -308.2 8.6 3.0 TRUE  // This should remove any stuff that is in the way for the cut-scene 

GET_PLAYER_CHAR player script_controlled_player

CLEAR_CHAR_THREAT_SEARCH script_controlled_player
	 	  
SET_CHAR_OBJ_LEAVE_CAR eightball car_eightball

WHILE IS_CHAR_IN_CAR eightball car_eightball 

	WAIT 0

	IF IS_CHAR_DEAD eightball
	  	 PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	  	 GOTO mission_eightball_failed
	ENDIF

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF
	   
ENDWHILE

PLAY_MISSION_AUDIO

PRINT_NOW ( EBAL_B ) 3000 1 //"This is the place! Let's get off the street and find a change of clothes!"

SET_CHAR_OBJ_RUN_TO_COORD eightball 892.7 -308.6

IF HAS_MISSION_AUDIO_FINISHED
	CLEAR_THIS_PRINT ( EBAL_B )
ENDIF

WAIT 1000

IF HAS_MISSION_AUDIO_FINISHED
	CLEAR_THIS_PRINT ( EBAL_B )
ENDIF

IF IS_CHAR_DEAD eightball
	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	GOTO mission_eightball_failed
ENDIF

IF IS_CAR_DEAD car_eightball

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ELSE
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   		GOTO mission_eightball_failed
   	ENDIF

ELSE

	IF IS_CAR_UPSIDEDOWN car_eightball
	AND IS_CAR_STOPPED car_eightball 
		PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
		GOTO mission_eightball_failed
   	ENDIF

ENDIF

IF HAS_MISSION_AUDIO_FINISHED
	CLEAR_THIS_PRINT ( EBAL_B )
ENDIF
 
SET_CHAR_OBJ_LEAVE_CAR script_controlled_player car_eightball
							
CLEAR_AREA 868.63 -311.7 8.3 1.0 TRUE

IF IS_AREA_OCCUPIED 870.4 -309.9 6.0 865.2 -314.7 12.0 FALSE TRUE TRUE TRUE TRUE
	SET_FIXED_CAMERA_POSITION 848.265 -295.26 19.136 0.0 0.0 0.0  //high camera that points to the water tower
	POINT_CAMERA_AT_POINT 849.11 -295.79 19.18 jump_cut
ELSE 
	SET_FIXED_CAMERA_POSITION 868.63 -311.7 8.3 0.0 0.0 0.0  //low new camera that points to the save house
	POINT_CAMERA_AT_POINT 869.59 -311.53 8.53 jump_cut
ENDIF

WHILE IS_CHAR_IN_CAR script_controlled_player car_eightball
			
	WAIT 0

	IF HAS_MISSION_AUDIO_FINISHED
    	CLEAR_THIS_PRINT ( EBAL_B )
    ENDIF

	IF IS_CHAR_DEAD eightball
	  	 PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	  	 GOTO mission_eightball_failed
	ENDIF

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF
	   
ENDWHILE

//Make player walk into the doors and get a change of clothes

SET_CHAR_OBJ_RUN_TO_COORD script_controlled_player 892.4 -308.5

timerb = 0

WHILE NOT flag_player_in_area = 2 
OR NOT flag_eightball_in_area = 2

	WAIT 0
	
	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF
	
	IF IS_CHAR_DEAD eightball
	  	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	  	GOTO mission_eightball_failed
	ENDIF
			
	IF flag_player_in_area = 0

		IF LOCATE_CHAR_ON_FOOT_2D script_controlled_player 892.4 -308.5 0.5 0.5 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD script_controlled_player 892.4 -305.6
			flag_player_in_area = 1
		ENDIF

	ENDIF
	

	IF flag_eightball_in_area = 0

		IF LOCATE_CHAR_ON_FOOT_2D eightball 892.7 -308.6 0.5 0.5 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD eightball 894.2 -304.3
			flag_eightball_in_area = 1
		ENDIF
	
	ENDIF
	
	IF flag_player_in_area = 1

		IF LOCATE_CHAR_ON_FOOT_2D script_controlled_player 892.4 -305.6 0.5 0.5 FALSE
			flag_player_in_area = 2
		ENDIF
	
	ENDIF

	IF flag_eightball_in_area = 1

		IF LOCATE_CHAR_ON_FOOT_2D eightball 894.2 -304.3 0.5 0.5 FALSE
			flag_eightball_in_area = 2
		ENDIF
	
	ENDIF

	IF timerb >= 10000

		IF NOT flag_player_in_area = 2
		OR NOT flag_eightball_in_area = 2
			SET_PLAYER_COORDINATES player 892.4 -305.6 7.7
			CHAR_SET_IDLE script_controlled_player
			SET_CHAR_COORDINATES eightball 894.2 -304.3 7.7
			CHAR_SET_IDLE eightball
			GOTO mission_bloke_stuck_8ball
		ENDIF
		
	ENDIF
				  	
ENDWHILE

mission_bloke_stuck_8ball:

SET_FIXED_CAMERA_POSITION 886.8 -310.1 9.9 0.0 0.0 0.0 

POINT_CAMERA_AT_POINT 887.7 -309.8 9.8 JUMP_CUT

CHAR_SET_IDLE eightball

SET_CHAR_OBJ_NO_OBJ script_controlled_player

PRINT_HELP ( S_PROMP ) //"When not on a mission you can save your game here, this will also advance time six hours."

WAIT 4000

IF IS_CAR_DEAD car_eightball

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ELSE
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   		GOTO mission_eightball_failed
   	ENDIF

ELSE

	IF IS_CAR_UPSIDEDOWN car_eightball
	AND IS_CAR_STOPPED car_eightball 
		PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
		GOTO mission_eightball_failed
   	ENDIF

ENDIF
	
IF IS_CHAR_DEAD eightball
	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	GOTO mission_eightball_failed
ENDIF


PRINT_HELP ( S_PROM2 ) //"The garage next door can store one car."

POINT_CAMERA_AT_POINT 887.8 -310.5 9.7 interpolation

SET_PLAYER_COORDINATES player 895.9 -311.4 7.7

SET_CHAR_COORDINATES eightball 884.3 -309.2 7.6

// Clothes change

//8-BAll change
		   
IF NOT IS_CHAR_DEAD eightball
	
	UNDRESS_CHAR eightball eight2
	WHILE NOT HAS_MODEL_LOADED PED_SPECIAL1 
	
		WAIT 0

		IF IS_CAR_DEAD car_eightball
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ELSE

			IF IS_CAR_UPSIDEDOWN car_eightball
			AND IS_CAR_STOPPED car_eightball 
				PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
				GOTO mission_eightball_failed
   			ENDIF

		ENDIF
				
	ENDWHILE
	
	IF NOT IS_CHAR_DEAD eightball
		DRESS_CHAR eightball
	ENDIF

ENDIF

//Player change

IF NOT IS_CHAR_DEAD script_controlled_player
	
	UNDRESS_CHAR script_controlled_player player
	WHILE NOT HAS_MODEL_LOADED PED_PLAYER 
	
		WAIT 0

		IF IS_CAR_DEAD car_eightball
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ELSE

			IF IS_CAR_UPSIDEDOWN car_eightball
			AND IS_CAR_STOPPED car_eightball 
				PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
				GOTO mission_eightball_failed
   			ENDIF

		ENDIF
		
	ENDWHILE
	
	IF NOT IS_CHAR_DEAD script_controlled_player
		DRESS_CHAR script_controlled_player
	ENDIF
ENDIF

WAIT 3000

IF IS_CAR_DEAD car_eightball

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ELSE
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   		GOTO mission_eightball_failed
   	ENDIF

ELSE

	IF IS_CAR_UPSIDEDOWN car_eightball
	AND IS_CAR_STOPPED car_eightball 
		PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
		GOTO mission_eightball_failed
   	ENDIF

ENDIF
	
IF IS_CHAR_DEAD eightball
	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	GOTO mission_eightball_failed
ENDIF

SET_PLAYER_COORDINATES player 883.5 -308.2 7.6

RELEASE_WEATHER
 
SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER eightball car_eightball

WAIT 1500

IF IS_CHAR_DEAD eightball
	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	GOTO mission_eightball_failed
ENDIF

IF IS_CAR_DEAD car_eightball

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
		GOTO mission_eightball_failed
	ELSE
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   		GOTO mission_eightball_failed
   	ENDIF

ELSE

	IF IS_CAR_UPSIDEDOWN car_eightball
	AND IS_CAR_STOPPED car_eightball 
		PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
		GOTO mission_eightball_failed
   	ENDIF

ENDIF

SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER script_controlled_player car_eightball

CLEAR_AREA 868.63 -311.7 8.3 1.0 TRUE 

IF IS_AREA_OCCUPIED 870.4 -309.9 6.0 865.2 -314.7 12.0 FALSE TRUE TRUE TRUE TRUE
	SET_FIXED_CAMERA_POSITION 848.265 -295.26 19.136 0.0 0.0 0.0  //high camera that points to the water tower
	POINT_CAMERA_AT_POINT 849.11 -295.79 19.18 jump_cut
ELSE 
	SET_FIXED_CAMERA_POSITION 868.63 -311.7 8.3 0.0 0.0 0.0  //low new camera that points to the save house
	POINT_CAMERA_AT_POINT 869.59 -311.53 8.53 jump_cut
ENDIF

CLEAR_HELP

WHILE NOT IS_PLAYER_IN_CAR player car_eightball
OR NOT IS_CHAR_IN_CAR eightball car_eightball

	WAIT 0

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

	  	IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF

	IF IS_CHAR_DEAD eightball
	  	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	  	GOTO mission_eightball_failed
	ENDIF

ENDWHILE

WHILE NOT ROTATE_OBJECT playersdoor 0.0 10.0 FALSE

	WAIT 0

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF
	
	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	    GOTO mission_eightball_failed
	ENDIF

ENDWHILE

RESTORE_CAMERA_JUMPCUT

SET_CAMERA_IN_FRONT_OF_PLAYER

SWITCH_WIDESCREEN OFF

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

//ADD_BLIP_FOR_COORD 906.2 -426.0 -100.0 radar_blip_coord2_eightball

blob_flag = 1

// *************Restart function for 8ball and the player at players hideout***************

hideout_reached:

IF flag_reached_hideout = 1

	SWITCH_WIDESCREEN ON

	SET_PLAYER_CONTROL player OFF

	SET_POLICE_IGNORE_PLAYER player ON
	
	SET_PLAYER_HEADING player 90.0
	
	CLEAR_AREA 868.63 -311.7 8.3 1.0 TRUE 

	IF IS_AREA_OCCUPIED 870.4 -309.9 6.0 865.2 -314.7 12.0 FALSE TRUE TRUE TRUE TRUE
		SET_FIXED_CAMERA_POSITION 848.265 -295.26 19.136 0.0 0.0 0.0  //high camera that points to the water tower
		POINT_CAMERA_AT_POINT 849.11 -295.79 19.18 jump_cut
	ELSE 
		SET_FIXED_CAMERA_POSITION 868.63 -311.7 8.3 0.0 0.0 0.0  //low new camera that points to the save house
		POINT_CAMERA_AT_POINT 869.59 -311.53 8.53 jump_cut
	ENDIF
	
	SET_OBJECT_HEADING playersdoor 0.0

	LOAD_SPECIAL_CHARACTER 1 eight2
	
	REQUEST_MODEL CAR_KURUMA

	LOAD_ALL_MODELS_NOW
        		
	//CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 887.2 -308.4 7.6 eightball

	 CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 884.3 -309.2 7.6 eightball

   	SET_ANIM_GROUP_FOR_CHAR eightball ANIM_GANG2_PED
	
	SET_CHAR_HEADING eightball 90.0

	CLEAR_CHAR_THREAT_SEARCH eightball
	
	CREATE_CAR CAR_KURUMA car_8ball_x car_8ball_y car_8ball_z car_eightball

	SET_CAR_HEADING car_eightball car_8ball_heading

	CHANGE_CAR_COLOUR car_eightball car_colour1_8ball car_colour2_8ball
	
	RELEASE_WEATHER 
	
	SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER script_controlled_player car_eightball

	SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER eightball car_eightball

	WHILE NOT IS_PLAYER_IN_CAR player car_eightball
	OR NOT IS_CHAR_IN_CAR eightball car_eightball

		WAIT 0

		IF IS_CAR_DEAD car_eightball

			IF IS_CHAR_DEAD eightball
				PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
				GOTO mission_eightball_failed
			ELSE
				PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   				GOTO mission_eightball_failed
   			ENDIF

		ELSE

			IF IS_CAR_UPSIDEDOWN car_eightball
			AND IS_CAR_STOPPED car_eightball 
				PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
				GOTO mission_eightball_failed
   			ENDIF

		ENDIF

		IF IS_CHAR_DEAD eightball
	  		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	  		GOTO mission_eightball_failed
		ENDIF

	ENDWHILE

	SET_CHAR_CANT_BE_DRAGGED_OUT eightball TRUE

	RESTORE_CAMERA_JUMPCUT

	SET_CAMERA_IN_FRONT_OF_PLAYER

	SWITCH_WIDESCREEN OFF

	SET_PLAYER_CONTROL player ON

	SET_POLICE_IGNORE_PLAYER player OFF
		
ENDIF

// **************************************end of the restart stuff***************************

IF flag_reached_hideout = 0
	REMOVE_PARTICLE_EFFECTS_IN_AREA 804.02 -948.03 30.0 765.15 -924.32 50.0
	REMOVE_SOUND fire_sound_8ball
	DELETE_OBJECT damagea
	DELETE_OBJECT damageb
   	SWAP_NEAREST_BUILDING_MODEL 1027.26 -933.796 15.042 50.0 LOD_land014 indhelix_barrier	
	SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1027.26 -933.796 15.042 50.0 indhelix_barrier TRUE
ENDIF 
flag_reached_hideout = 1

OVERRIDE_NEXT_RESTART 883.5 -308.2 7.6 90.0  // Players hideout

IF IS_CHAR_DEAD eightball
	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	GOTO mission_eightball_failed
ENDIF

ADD_BLIP_FOR_COORD 906.2 -426.0 -100.0 radar_blip_coord2_eightball  //Luigis blip

LOAD_MISSION_AUDIO LIB_B

WHILE NOT HAS_MISSION_AUDIO_LOADED 

	WAIT 0
						   	   	
	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

		IF NOT IS_PLAYER_IN_CAR player car_eightball

			blob_flag = 0
			
			IF flag_car_message_8ball = 0
				PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the car and get on with the mission!"
				REMOVE_BLIP radar_blip_coord2_eightball
				ADD_BLIP_FOR_CAR car_eightball radar_blip_car1_eightball
				flag_car_message_8ball = 1
			ENDIF
			
		ELSE

			blob_flag = 1
		
			IF flag_car_message_8ball = 1
				REMOVE_BLIP radar_blip_car1_eightball
			   	ADD_BLIP_FOR_COORD 906.2 -426.0 -100.0 radar_blip_coord2_eightball //Luigis
				flag_car_message_8ball = 0
			ENDIF
			
		ENDIF
		
	ENDIF   

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	    GOTO mission_eightball_failed
	ENDIF
	
ENDWHILE

PLAY_MISSION_AUDIO

PRINT_NOW ( EBAL_D ) 7000 1 //"I know a guy, he's connected, Names Luigi.

WAIT 3000

IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

		IF NOT IS_PLAYER_IN_CAR player car_eightball

			blob_flag = 0
			
			IF flag_car_message_8ball = 0
				PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the car and get on with the mission!"
				REMOVE_BLIP radar_blip_coord2_eightball
				ADD_BLIP_FOR_CAR car_eightball radar_blip_car1_eightball
				flag_car_message_8ball = 1
			ENDIF
			
		ELSE

			blob_flag = 1
		
			IF flag_car_message_8ball = 1
				REMOVE_BLIP radar_blip_car1_eightball
			   	ADD_BLIP_FOR_COORD 906.2 -426.0 -100.0 radar_blip_coord2_eightball //Luigis
				flag_car_message_8ball = 0
			ENDIF
			
		ENDIF
		
	ENDIF   

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	    GOTO mission_eightball_failed
	ENDIF


PRINT_NOW ( EBAL_D1 ) 7000 1 //"Me an' him go back so I could probably get you some work."

//waiting for the player to got to Luigi's

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

		IF NOT IS_PLAYER_IN_CAR player car_eightball

			blob_flag = 0
			
			IF flag_car_message_8ball = 0
				PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the car and get on with the mission!"
			   	REMOVE_BLIP radar_blip_coord2_eightball
				ADD_BLIP_FOR_CAR car_eightball radar_blip_car1_eightball
				flag_car_message_8ball = 1
			ENDIF
			
		ELSE

			blob_flag = 1
		
			IF flag_car_message_8ball = 1
				REMOVE_BLIP radar_blip_car1_eightball
				ADD_BLIP_FOR_COORD 906.2 -426.0 -100.0 radar_blip_coord2_eightball //Luigis
				flag_car_message_8ball = 0
			ENDIF
			
		ENDIF
		
	ENDIF   

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	    GOTO mission_eightball_failed
	ENDIF
	
ENDWHILE

CLEAR_THIS_PRINT ( EBAL_D )

CLEAR_THIS_PRINT ( EBAL_D1 )

// waiting for the player to get to luigi's
   
LOAD_MISSION_AUDIO LIB_C

WHILE NOT IS_PLAYER_STOPPED_IN_AREA_IN_CAR_3D player 903.8 -420.2 14.0 908.3 -431.1 18.0 blob_flag 
OR NOT IS_CHAR_STOPPED_IN_AREA_IN_CAR_3D eightball 903.8 -420.2 14.0 908.3 -431.1 18.0 FALSE
OR NOT IS_PLAYER_IN_CAR player car_eightball
OR NOT IS_CHAR_IN_CAR eightball car_eightball
OR NOT HAS_MISSION_AUDIO_LOADED 

	WAIT 0
				   	   	
	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

		IF NOT IS_PLAYER_IN_CAR player car_eightball

			blob_flag = 0
			
			IF flag_car_message_8ball = 0
				PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the car and get on with the mission!"
				REMOVE_BLIP radar_blip_coord2_eightball
				ADD_BLIP_FOR_CAR car_eightball radar_blip_car1_eightball
				flag_car_message_8ball = 1
			ENDIF
			
		ELSE

			blob_flag = 1
		
			IF flag_car_message_8ball = 1
				REMOVE_BLIP radar_blip_car1_eightball
				ADD_BLIP_FOR_COORD 906.2 -426.0 -100.0 radar_blip_coord2_eightball //Luigis
				flag_car_message_8ball = 0
			ENDIF
			
		ENDIF
		
	ENDIF   

	IF IS_CHAR_DEAD eightball
		PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	    GOTO mission_eightball_failed
	ENDIF

	IF LOCATE_PLAYER_IN_CAR_2D player 902.8 -425.6 15.0 15.0 FALSE
	AND IS_PLAYER_IN_CAR player car_eightball
	AND flag_help_8ball2 = 0
		PRINT_HELP ( HELP1 ) //Stop in the centre of the red dome."
		flag_help_8ball2 = 1
	ENDIF
	      		
ENDWHILE

CLEAR_HELP

REMOVE_BLIP radar_blip_coord2_eightball

SWITCH_WIDESCREEN ON

CLEAR_WANTED_LEVEL player

SET_POLICE_IGNORE_PLAYER player ON

SET_EVERYONE_IGNORE_PLAYER player ON

SET_PLAYER_CONTROL player OFF

CLEAR_AREA 887.4 -417.3 13.9 10.0 TRUE // This should get rid of any stuff for the cut-scene

GET_PLAYER_CHAR player script_controlled_player

CLEAR_CHAR_THREAT_SEARCH script_controlled_player

SET_CHAR_OBJ_LEAVE_CAR script_controlled_player car_eightball
 
SET_CHAR_OBJ_LEAVE_CAR eightball car_eightball

PLAY_MISSION_AUDIO

PRINT_NOW ( EBAL_G ) 7000 1 //"Here's Luigi's club. c'mon lets go round the back and use the service door."


WHILE IS_CHAR_IN_CAR script_controlled_player car_eightball
			
	WAIT 0

	IF IS_CHAR_DEAD eightball
	  	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	  	 GOTO mission_eightball_failed
	ENDIF

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF

	IF HAS_MISSION_AUDIO_FINISHED
	   CLEAR_THIS_PRINT ( EBAL_G )
	ENDIF	
	   
ENDWHILE

IF IS_CHAR_DEAD eightball
	PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	GOTO mission_eightball_failed
ENDIF

WHILE IS_CHAR_IN_CAR eightball car_eightball

	WAIT 0

	IF IS_CAR_DEAD car_eightball

		IF IS_CHAR_DEAD eightball
			PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
   			GOTO mission_eightball_failed
   		ENDIF

	ELSE

		IF IS_CAR_UPSIDEDOWN car_eightball
		AND IS_CAR_STOPPED car_eightball 
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_eightball_failed
   		ENDIF

	ENDIF

	IF IS_CHAR_DEAD eightball
	  	 PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	  	 GOTO mission_eightball_failed
	ENDIF

	IF HAS_MISSION_AUDIO_FINISHED
	   CLEAR_THIS_PRINT ( EBAL_G )
	ENDIF
	   
ENDWHILE

MARK_CAR_AS_NO_LONGER_NEEDED car_eightball

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT script_controlled_player 897.1 -426.3

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT eightball 897.3 -424.6


WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CHAR_DEAD eightball
	  	 PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	  	 GOTO mission_eightball_failed
	ENDIF

ENDWHILE

CLEAR_THIS_PRINT ( EBAL_G )

SET_EVERYONE_IGNORE_PLAYER player OFF

SET_POLICE_IGNORE_PLAYER player OFF

SET_CHAR_CANT_BE_DRAGGED_OUT eightball FALSE

CLEAR_HELP

// ****************************Player and eightball cut-scene at luigi's********************

GET_GAME_TIMER breakout_timer_start

breakout_diff = 0

WHILE NOT CAN_PLAYER_START_MISSION Player
AND breakout_diff < 5000	//	if player is not in control after 5 secs do the cutscene anyway

	WAIT 0

	IF IS_CHAR_DEAD eightball
	  	 PRINT_NOW ( EBAL_4 ) 5000 1 //"8-Balls dead!
	  	 GOTO mission_eightball_failed
	ENDIF

	GET_GAME_TIMER breakout_timer

	breakout_diff = breakout_timer - breakout_timer_start
	
ENDWHILE

MAKE_PLAYER_SAFE_FOR_CUTSCENE player

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

PRINT_BIG ( LM1 ) 15000 2 //"Luigi's Girls"

REQUEST_MODEL indhibuild3
REQUEST_MODEL luigiclubout
REQUEST_MODEL luigiineerclub

LOAD_SPECIAL_CHARACTER 2 MICKY
LOAD_SPECIAL_CHARACTER 3 LUIGI

LOAD_SPECIAL_MODEL cut_obj1 LUDOOR
LOAD_SPECIAL_MODEL cut_obj2 MICKYH
LOAD_SPECIAL_MODEL cut_obj3 EIGHTH
LOAD_SPECIAL_MODEL cut_obj4	LUIGIH
LOAD_SPECIAL_MODEL cut_obj5	PLAYERH

WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE

LOAD_ALL_MODELS_NOW

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS 926.54 -471.72 1.0 830.76 -257.96 25.0

IF NOT IS_CHAR_DEAD eightball 
	SET_CHAR_OBJ_WAIT_ON_FOOT eightball
ENDIF

SET_CHAR_OBJ_WAIT_ON_FOOT script_controlled_player
	
// Cutscene stuff

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_SPECIAL_CHARACTER_LOADED 3
OR NOT HAS_MODEL_LOADED cut_obj1 
OR NOT HAS_MODEL_LOADED cut_obj2

	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj4
OR NOT HAS_MODEL_LOADED cut_obj5
OR NOT HAS_MODEL_LOADED indhibuild3
OR NOT HAS_MODEL_LOADED luigiclubout
OR NOT HAS_MODEL_LOADED luigiineerclub

	WAIT 0

ENDWHILE

DELETE_CHAR eightball

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor FALSE

LOAD_CUTSCENE l1_lg

SET_CUTSCENE_OFFSET 900.782 -427.523 13.829

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_micky

SET_CUTSCENE_ANIM cs_micky micky

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_eight

SET_CUTSCENE_ANIM cs_eight eight2

CREATE_CUTSCENE_OBJECT PED_SPECIAL3 cs_luigi

SET_CUTSCENE_ANIM cs_luigi luigi

CREATE_CUTSCENE_HEAD cs_micky CUT_OBJ2 cs_mickyhead

SET_CUTSCENE_HEAD_ANIM cs_mickyhead micky

CREATE_CUTSCENE_HEAD cs_eight CUT_OBJ3 cs_eighthead

SET_CUTSCENE_HEAD_ANIM cs_eighthead eight

CREATE_CUTSCENE_HEAD cs_luigi CUT_OBJ4 cs_luigihead

SET_CUTSCENE_HEAD_ANIM cs_luigihead luigi

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ5 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj1 cs_ludoor

SET_CUTSCENE_ANIM cs_ludoor LUDOOR

CLEAR_AREA 896.6 -426.2 13.9 1.0 TRUE
SET_PLAYER_COORDINATES player 896.6 -426.2 13.9

SET_PLAYER_HEADING player 270.0

TIMERA = 0

WHILE TIMERA < 3500

	WAIT 0

ENDWHILE

DO_FADE 1500 FADE_IN

CLEAR_AREA 887.4 -417.3 13.9 10.0 TRUE  // This should get rid of anything in the alleway

CLEAR_AREA 892.8 -425.5 13.9 3.0 TRUE

CLEAR_AREA 896.3 -425.6 13.8 3.0 TRUE

CLEAR_AREA 899.7 -425.7 14.0 0.5 TRUE


SWITCH_RUBBISH OFF

START_CUTSCENE

GET_CUTSCENE_TIME cs_time

SET_PLAYER_VISIBLE player OFF

// Displays cutscene text

WHILE cs_time < 11165
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( EBAL_H ) 10000 1 //"Wait here while I go in and talk to Luigi."

WHILE cs_time < 13416
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( EBAL_H )

//PRINT_NOW ( EBAL_I ) 10000 1 //"Da boss will be out to see you shortly..."

WHILE cs_time < 30834
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( EBAL_J ) 10000 1 //"8-Ball's got some business up stairs."

WHILE cs_time < 33186
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( EBAL_K ) 10000 1 //"Maybe you can do me a favor."

WHILE cs_time < 35235
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( EBAL_L ) 10000 1 //"One of my girls needs a ride so grab a car and pick up Misty from the clinic. Then bring her back here"

WHILE cs_time < 41551
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( EBAL_M ) 10000 1//"Remember no one messes with my girls"

WHILE cs_time < 45634
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( EBAL_N ) 10000 1//"So keep your hands on the wheel!"

WHILE cs_time < 47560
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( EBAL_O ) 10000 1 //"If you don't mess this up there might be more work for you."

WHILE cs_time < 51911
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( EBAL_O )

WHILE cs_time < 52500
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SET_CAMERA_BEHIND_PLAYER

WAIT 500

SWITCH_STREAMING ON

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH ON

LOAD_SCENE 920.3 -425.4 15.0

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE

UNLOAD_SPECIAL_CHARACTER 1

UNLOAD_SPECIAL_CHARACTER 2

UNLOAD_SPECIAL_CHARACTER 3

MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1

MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2

MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj3

MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj4

MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj5

MARK_MODEL_AS_NO_LONGER_NEEDED indhibuild3

MARK_MODEL_AS_NO_LONGER_NEEDED luigiclubout

MARK_MODEL_AS_NO_LONGER_NEEDED luigiineerclub

SET_PLAYER_CONTROL player ON

SET_PED_DENSITY_MULTIPLIER 1.0

// ************************************************END OF CUT_SCENE*************************


// *****************************************LUIGI'S GIRLS***********************************

LOAD_SPECIAL_CHARACTER 2 MISTY

PRINT_NOW ( EBAL_5 ) 5000 1 //"Get a vehicle!"

// Waiting for the player to be in a car

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 2

	WAIT 0
				
ENDWHILE

// Creates the first girl

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 1144.6 -592.8 13.9 girl1_lm1

CLEAR_CHAR_THREAT_SEARCH girl1_lm1

SET_CHAR_HEADING girl1_lm1 90.0

SET_ANIM_GROUP_FOR_CHAR girl1_lm1 ANIM_SEXY_WOMANPED

ADD_BLIP_FOR_CHAR girl1_lm1 radar_blip_ped1_lm1

flag_blip_on_girl1_lm1 = 1

LOAD_MISSION_AUDIO LIB_D

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

PRINT_HELP NEW_H1

WHILE NOT IS_PLAYER_IN_ANY_CAR player
OR NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0

	IF IS_CHAR_DEAD girl1_lm1
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
		GOTO mission_eightball_failed
	ENDIF

	IF IS_PLAYER_IN_ANY_CAR player
		STORE_CAR_PLAYER_IS_IN player car_lm1
	ENDIF

ENDWHILE

CLEAR_HELP
PRINT_HELP ( RADIO_A ) //"Press the L1 button to cycle through the radio stations."

PRINT_NOW ( EBAL_6 ) 5000 1 //"Pick up Misty!"

// Waiting for the player and the girls all to be in the one car

WHILE flag_girl1_in_car_lm1 = 0

	WAIT 0

IF flag_girl_in_group_lm1 = 0 

	IF IS_CHAR_DEAD girl1_lm1
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
		GOTO mission_eightball_failed
	ENDIF

	IF flag_misty_stop = 0

		IF LOCATE_PLAYER_IN_CAR_CHAR_2D player girl1_lm1 20.0 20.0 FALSE
			PRINT_HELP ( LM1_7 ) //"Stop the vehicle next to Misty and allow her to enter it."
			flag_misty_stop = 1
		ENDIF
				
	ENDIF
	
	IF NOT IS_PLAYER_IN_ANY_CAR player

		IF flag_player_had_vehicle_message_lm1 = 0
			PRINT_NOW ( IN_VEH2 ) 5000 1 //"Get a vehicle and get on with the mission!"

			IF flag_blip_on_girl1_lm1 = 1
				REMOVE_BLIP radar_blip_ped1_lm1 
				flag_blip_on_girl1_lm1 = 0
			ENDIF

			flag_player_had_vehicle_message_lm1 = 1
		ENDIF

	ELSE
		
		STORE_CAR_PLAYER_IS_IN player car_lm1

		IF flag_player_had_vehicle_message_lm1 = 1
			PRINT_NOW ( EBAL_6 ) 5000 1 //"Pick up Misty!"

			IF flag_blip_on_girl1_lm1 = 0
				ADD_BLIP_FOR_CHAR girl1_lm1 radar_blip_ped1_lm1
				flag_blip_on_girl1_lm1 = 1
			ENDIF

			flag_player_had_vehicle_message_lm1 = 0
		ENDIF
		
	ENDIF
	 
	   	IF IS_PLAYER_IN_ANY_CAR player
			STORE_CAR_PLAYER_IS_IN player car_lm1

			IF LOCATE_PLAYER_IN_CAR_CHAR_2D player girl1_lm1 8.0 8.0 FALSE

				IF IS_PLAYER_STOPPED player
									   				
					SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER girl1_lm1 car_lm1
					
						WHILE NOT IS_CHAR_IN_CAR girl1_lm1 car_lm1
						OR NOT IS_PLAYER_IN_CAR player car_lm1

							WAIT 0

							IF IS_CHAR_DEAD girl1_lm1
								PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
								GOTO mission_eightball_failed
							ENDIF

							IF IS_CAR_DEAD car_lm1
								
								IF IS_CHAR_DEAD girl1_lm1
									PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
									GOTO mission_eightball_failed
								ELSE
									PRINT_NOW ( WRECKED ) 5000 1 //"The Vehicles wrecked"
									GOTO mission_eightball_failed
								ENDIF

							ENDIF
								
							IF IS_CHAR_IN_CAR girl1_lm1 car_lm1
								SET_CHAR_CANT_BE_DRAGGED_OUT girl1_lm1 TRUE
							ENDIF 
														
							IF NOT IS_PLAYER_IN_CAR player car_lm1

								IF flag_player_had_vehicle_message_lm1 = 0
									PRINT_NOW ( IN_VEH ) 5000 1 //"Get a vehicle and get on with the mission!"
										
										IF flag_blip_on_girl1_lm1 = 1
											REMOVE_BLIP radar_blip_ped1_lm1
											ADD_BLIP_FOR_CAR car_lm1 radar_blip_car1_lm1 
											flag_blip_on_girl1_lm1 = 0
										ENDIF

									flag_player_had_vehicle_message_lm1 = 1
								ENDIF

							ELSE

								IF flag_player_had_vehicle_message_lm1 = 1

									PRINT_NOW ( EBAL_6 ) 5000 1 //"Pick up Misty!"

									IF flag_blip_on_girl1_lm1 = 0
										ADD_BLIP_FOR_CHAR girl1_lm1 radar_blip_ped1_lm1
										REMOVE_BLIP radar_blip_car1_lm1
										flag_blip_on_girl1_lm1 = 1
									ENDIF
																		
									flag_player_had_vehicle_message_lm1 = 0
								ENDIF
		
							ENDIF
							
						ENDWHILE
						REMOVE_BLIP radar_blip_ped1_lm1
						REMOVE_BLIP radar_blip_car1_lm1
						flag_blip_on_girl1_lm1 = 0
						flag_girl_in_group_lm1 = 1
				ENDIF

			ENDIF

		ENDIF

ENDIF

	IF flag_girl_in_group_lm1 = 1

		IF IS_CHAR_DEAD girl1_lm1
			PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
			GOTO mission_eightball_failed
		ENDIF

		IF IS_CAR_DEAD car_lm1
								
			IF IS_CHAR_DEAD girl1_lm1
				PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
				GOTO mission_eightball_failed
			ELSE
				PRINT_NOW ( WRECKED ) 5000 1 //"The Vehicles wrecked"
				GOTO mission_eightball_failed
			ENDIF

		ENDIF

		IF NOT IS_PLAYER_IN_CAR player car_lm1

			IF flag_player_had_car_message_lm1 = 0
				PRINT_NOW ( IN_VEH ) 5000 1 //Get into the car and get on with the mission"
				ADD_BLIP_FOR_CAR car_lm1 radar_blip_car1_lm1
				flag_player_had_car_message_lm1 = 1
			ENDIF

		ENDIF

		IF IS_PLAYER_IN_CAR player car_lm1

			IF IS_CHAR_IN_CAR girl1_lm1 car_lm1
				PRINT_NOW ( LM1_9 ) 10000 1 //"Hey I'm Misty!"
				PLAY_MISSION_AUDIO
				SET_CHAR_CANT_BE_DRAGGED_OUT girl1_lm1 FALSE
				flag_girl1_in_car_lm1 = 1 
			ENDIF
		
			IF flag_player_had_car_message_lm1 = 1
				REMOVE_BLIP radar_blip_car1_lm1
				flag_player_had_car_message_lm1 = 0
			ENDIF
			
		ENDIF 
		
	ENDIF
	     
ENDWHILE

REMOVE_BLIP radar_blip_ped1_lm1

SET_PLAYER_AS_LEADER girl1_lm1 player

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CHAR_DEAD girl1_lm1
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
		GOTO mission_eightball_failed
	ELSE
		
		IF NOT IS_CHAR_IN_PLAYERS_GROUP girl1_lm1 player
		AND flag_blip_on_girl1_lm1 = 0
			PRINT_NOW ( HEY4 ) 5000 1 //"You have left Misty behind go and get her!"
			ADD_BLIP_FOR_CHAR girl1_lm1 radar_blip_ped1_lm1
	   		flag_blip_on_girl1_lm1 = 1
		ENDIF
		
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player girl1_lm1 8.0 8.0 FALSE
		AND flag_blip_on_girl1_lm1 = 1
			SET_PLAYER_AS_LEADER girl1_lm1 player
			//PRINT_NOW ( LM1_2 ) 7000 1 //"Hi take us to the Red Light District please, we'll be ever so 'grateful'!"
			REMOVE_BLIP radar_blip_ped1_lm1
			flag_blip_on_girl1_lm1 = 0
		ENDIF

	ENDIF

	IF IS_CAR_DEAD car_lm1
								
		IF IS_CHAR_DEAD girl1_lm1
			PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
			GOTO mission_eightball_failed
		ELSE
			PRINT_NOW ( WRECKED ) 5000 1 //"The Vehicles wrecked"
			GOTO mission_eightball_failed
		ENDIF

	ENDIF

ENDWHILE

CLEAR_THIS_PRINT ( LM1_9 )
	
PRINT_NOW ( LM1_2 ) 7000 1 //"Hi take us to the Red Light District please, we'll be ever so 'grateful'!"

ADD_BLIP_FOR_COORD 906.2 -426.0 -100.0 radar_blip_coord1_lm1

blob_flag = 1

PRINT_HELP ( LOOK_A ) //"Press and hold the ~h~L2 button to look left~w~ while in a vehicle." 

timera = 0

// waiting for the player to get to luigi's

WHILE NOT IS_CHAR_STOPPED_IN_AREA_3D girl1_lm1 903.8 -420.2 14.0 908.3 -431.1 18.0 blob_flag
OR NOT IS_PLAYER_STOPPED_IN_AREA_3D player 903.8 -420.2 14.0 908.3 -431.1 18.0 FALSE   
	   
	WAIT 0

	IF flag_player_had_camera_message_8ball = 0
		
		IF timera > 10000
			PRINT_HELP ( CAM_A ) //"Press the ~h~SELECT button~w~ to change ~h~camera ~w~modes when on foot or in a vehicle."
			flag_player_had_camera_message_8ball = 1
		ENDIF

	ENDIF
	
	IF IS_CHAR_DEAD girl1_lm1
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
		GOTO mission_eightball_failed
	ELSE
		
		IF NOT IS_CHAR_IN_PLAYERS_GROUP girl1_lm1 player
		AND flag_blip_on_girl1_lm1 = 0
			PRINT_NOW ( HEY4 ) 5000 1 //"You have left Misty behind go and get her!"
			ADD_BLIP_FOR_CHAR girl1_lm1 radar_blip_ped1_lm1
	   		REMOVE_BLIP radar_blip_coord1_lm1
			blob_flag = 0
			flag_blip_on_girl1_lm1 = 1
		ENDIF
		
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player girl1_lm1 8.0 8.0 FALSE
		AND flag_blip_on_girl1_lm1 = 1
			SET_PLAYER_AS_LEADER girl1_lm1 player
			PRINT_NOW ( LM1_2 ) 7000 1 //"Hi take us to the Red Light District please, we'll be ever so 'grateful'!"
			ADD_BLIP_FOR_COORD 906.2 -426.0 -100.0 radar_blip_coord1_lm1
			REMOVE_BLIP radar_blip_ped1_lm1
			blob_flag = 1
			flag_blip_on_girl1_lm1 = 0
		ENDIF

	ENDIF
    
ENDWHILE

REMOVE_BLIP radar_blip_coord1_lm1

LEAVE_GROUP girl1_lm1

// *********************************MISTY CUT AT END****************************************

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

CLEAR_WANTED_LEVEL player

SET_POLICE_IGNORE_PLAYER player ON

SET_EVERYONE_IGNORE_PLAYER player ON

CLEAR_AREA 887.4 -417.3 13.9 10.0 TRUE // This should get rid of any stuff for the cut-scene

REQUEST_MODEL indhibuild3
REQUEST_MODEL luigiclubout
REQUEST_MODEL luigiineerclub

IF IS_CHAR_IN_ANY_CAR girl1_lm1
	
	SET_CHAR_CANT_BE_DRAGGED_OUT girl1_lm1 FALSE

	STORE_CAR_CHAR_IS_IN girl1_lm1 car_lm1

	SET_CHAR_OBJ_LEAVE_CAR girl1_lm1 car_lm1

	WHILE IS_CHAR_IN_ANY_CAR girl1_lm1
			
		WAIT 0

		IF IS_CHAR_DEAD girl1_lm1
			PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
			GOTO mission_eightball_failed
		ENDIF
	 
	ENDWHILE

ENDIF

WHILE NOT HAS_MODEL_LOADED indhibuild3
OR NOT HAS_MODEL_LOADED	luigiclubout
OR NOT HAS_MODEL_LOADED	luigiineerclub

	WAIT 0

	IF IS_CHAR_DEAD girl1_lm1
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
		GOTO mission_eightball_failed
	ENDIF

ENDWHILE

// Misty walks to the top of the alleyway

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT girl1_lm1 900.17 -425.4 

timerb = 0

WHILE timerb < 1000

	WAIT 0
	
	IF IS_CHAR_DEAD girl1_lm1
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
		GOTO mission_eightball_failed
	ENDIF

ENDWHILE

IF IS_CHAR_DEAD girl1_lm1
	PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!
	GOTO mission_eightball_failed
ENDIF

SET_CHAR_COORDINATES girl1_lm1 898.9 -425.8 13.9 
SET_CHAR_HEADING girl1_lm1 90.0

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT girl1_lm1 887.1 -425.22

SWITCH_WIDESCREEN ON
SET_FIXED_CAMERA_POSITION 882.6 -425.6 14.4 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 890.2 -421.1 15.0 jump_cut 

PRINT_WITH_NUMBER_BIG ( M_PASS ) 1500 5000 1 //"Mission Passed!"
ADD_SCORE player 1500 
PLAY_MISSION_PASSED_TUNE 1 //plays the mission complete tune

timerb = 0

WHILE timerb < 5000

	WAIT 0
		   
ENDWHILE

SET_FADING_COLOUR 0 0 0

DO_FADE 1000 FADE_OUT

WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE

WAIT 0

SET_CAMERA_BEHIND_PLAYER

WAIT 0

SWITCH_WIDESCREEN OFF

WAIT 0

RESTORE_CAMERA_JUMPCUT

WAIT 750

DO_FADE 250 FADE_IN

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

SET_EVERYONE_IGNORE_PLAYER player OFF

GOTO mission_eightball_passed



// Mission 8ball failed

mission_eightball_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

flag_eightball_mission_launched = 0

IF flag_reached_hideout = 0
	RESTART_CRITICAL_MISSION 811.90 -939.95 35.8 180.0 // New bridge restart	
ELSE
	RESTART_CRITICAL_MISSION 883.5 -308.2 7.6 90.0  // Player hideout
ENDIF

MISSION_HAS_FINISHED	//	marks models as no longer needed so that they can be deleted before the player is teleported

WHILE NOT IS_PLAYER_PLAYING player

	WAIT 0
    		
ENDWHILE

RETURN


// mission eightball passed

mission_eightball_passed:

USE_TEXT_COMMANDS 93 // HACKED achievement unlock // FIRST_DAY_ON_THE_JOB

CANCEL_OVERRIDE_RESTART
flag_eightball_mission_passed = 1
REGISTER_MISSION_PASSED ( LM1 )
PLAYER_MADE_PROGRESS 1
flag_luigi_mission1_passed = 1
CLEAR_WANTED_LEVEL player
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 892.8 -425.8 13.9 RADAR_SPRITE_LUIGI luigi_contact_blip  // New blip down alleyway
START_NEW_SCRIPT luigi_mission2_loop
START_NEW_SCRIPT blob_help_loop
START_NEW_SCRIPT luigi_message
RETURN
}

// mission cleanup

mission_cleanup_eightball:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_eightball_mission = 0
REMOVE_PARTICLE_EFFECTS_IN_AREA 804.02 -948.03 30.0 765.15 -924.32 50.0
REMOVE_SOUND fire_sound_8ball
SET_FADING_COLOUR 0 0 0
MARK_MODEL_AS_NO_LONGER_NEEDED indhibuild3
MARK_MODEL_AS_NO_LONGER_NEEDED luigiclubout
MARK_MODEL_AS_NO_LONGER_NEEDED luigiineerclub
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_KURUMA
REMOVE_BLIP radar_blip_coord1_eightball
REMOVE_BLIP radar_blip_coord2_eightball
REMOVE_BLIP radar_blip_car1_eightball
DELETE_CHAR eightball
DELETE_CHAR girl1_lm1
REMOVE_BLIP radar_blip_coord1_lm1
REMOVE_BLIP radar_blip_ped1_lm1
REMOVE_BLIP radar_blip_car1_lm1
FLASH_HUD_OBJECT -1

IF NOT IS_CAR_DEAD cop_car1_8ball 
	MARK_CAR_AS_NO_LONGER_NEEDED cop_car1_8ball
ENDIF

IF NOT IS_CAR_DEAD cop_car2_8ball 
	MARK_CAR_AS_NO_LONGER_NEEDED cop_car2_8ball
ENDIF

IF NOT IS_CHAR_DEAD girl1_lm1
	SET_CHAR_CANT_BE_DRAGGED_OUT girl1_lm1 FALSE
ENDIF

MISSION_HAS_FINISHED
RETURN
		
  
car_gen_start_8ball:

// Switches on the car generators from Greasy Joes and Fish Factory

SWITCH_CAR_GENERATOR gen_car44 101

SWITCH_CAR_GENERATOR gen_car45 101

SWITCH_CAR_GENERATOR gen_car46 101

SWITCH_CAR_GENERATOR gen_car47 101

SWITCH_CAR_GENERATOR gen_car48 101

SWITCH_CAR_GENERATOR gen_car49 101

// switches on the car generators from the fuzz ball

SWITCH_CAR_GENERATOR gen_car28 101

SWITCH_CAR_GENERATOR gen_car29 101

SWITCH_CAR_GENERATOR gen_car1 101

SWITCH_CAR_GENERATOR gen_car2 101

SWITCH_CAR_GENERATOR gen_car3 101 
	 
SWITCH_CAR_GENERATOR gen_car4 101

SWITCH_CAR_GENERATOR gen_car5 101 

SWITCH_CAR_GENERATOR gen_car6 101

SWITCH_CAR_GENERATOR gen_car6 101

SWITCH_CAR_GENERATOR gen_car9 101

SWITCH_CAR_GENERATOR gen_car10 101

SWITCH_CAR_GENERATOR gen_car11 101

SWITCH_CAR_GENERATOR gen_car12 101

SWITCH_CAR_GENERATOR gen_car13 101

SWITCH_CAR_GENERATOR gen_car15 101

SWITCH_CAR_GENERATOR gen_car16 101

SWITCH_CAR_GENERATOR gen_car17 101

SWITCH_CAR_GENERATOR gen_car18 101

SWITCH_CAR_GENERATOR gen_car57 101

SWITCH_CAR_GENERATOR gen_car58 101

SWITCH_CAR_GENERATOR gen_car19 101

SWITCH_CAR_GENERATOR gen_car20 101

SWITCH_CAR_GENERATOR gen_car21 101

SWITCH_CAR_GENERATOR gen_car22 101

SWITCH_CAR_GENERATOR gen_car24 101

SWITCH_CAR_GENERATOR gen_car25 101

SWITCH_CAR_GENERATOR gen_car59 101

SWITCH_CAR_GENERATOR gen_car23 101

SWITCH_CAR_GENERATOR gen_car30 101

SWITCH_CAR_GENERATOR gen_car31 101

SWITCH_CAR_GENERATOR gen_car53 101

SWITCH_CAR_GENERATOR gen_car8 101

SWITCH_CAR_GENERATOR gen_car32 101

SWITCH_CAR_GENERATOR gen_car34 101

SWITCH_CAR_GENERATOR gen_car36 101

SWITCH_CAR_GENERATOR gen_car37 101

SWITCH_CAR_GENERATOR gen_car38 101

SWITCH_CAR_GENERATOR gen_car40 101	

SWITCH_CAR_GENERATOR gen_car41 101

SWITCH_CAR_GENERATOR gen_car42 101

SWITCH_CAR_GENERATOR gen_car43 101

SWITCH_CAR_GENERATOR gen_car54 101

SWITCH_CAR_GENERATOR gen_car55 101

SWITCH_CAR_GENERATOR gen_car56 101

SWITCH_CAR_GENERATOR gen_car33 101
	 
SWITCH_CAR_GENERATOR gen_car51 101 								   

SWITCH_CAR_GENERATOR gen_car52 101

SWITCH_CAR_GENERATOR gen_car64 101

SWITCH_CAR_GENERATOR com_car1 101

SWITCH_CAR_GENERATOR com_car2 101

SWITCH_CAR_GENERATOR com_car25 101

SWITCH_CAR_GENERATOR com_car26 101

SWITCH_CAR_GENERATOR com_car3 101

SWITCH_CAR_GENERATOR com_car4 101

SWITCH_CAR_GENERATOR com_car5 101

SWITCH_CAR_GENERATOR com_car6 101

SWITCH_CAR_GENERATOR com_car7 101

SWITCH_CAR_GENERATOR com_car8 101

SWITCH_CAR_GENERATOR com_car9 101

SWITCH_CAR_GENERATOR com_car10 101

SWITCH_CAR_GENERATOR com_car11 101

SWITCH_CAR_GENERATOR com_car12 101

SWITCH_CAR_GENERATOR com_car20 101

SWITCH_CAR_GENERATOR com_car21 101

SWITCH_CAR_GENERATOR com_car27 101

SWITCH_CAR_GENERATOR com_car28 101

SWITCH_CAR_GENERATOR com_car29 101

SWITCH_CAR_GENERATOR com_car30 101

SWITCH_CAR_GENERATOR com_car31 101

SWITCH_CAR_GENERATOR com_car32 101

SWITCH_CAR_GENERATOR com_car33 101

SWITCH_CAR_GENERATOR com_car34 101

SWITCH_CAR_GENERATOR com_car35 101

SWITCH_CAR_GENERATOR com_car36 101

SWITCH_CAR_GENERATOR com_car37 101

//SWITCH_CAR_GENERATOR com_car38 101

SWITCH_CAR_GENERATOR com_car39 101

SWITCH_CAR_GENERATOR com_car40 101

SWITCH_CAR_GENERATOR gen_car60 0

SWITCH_CAR_GENERATOR gen_car61 0

SWITCH_CAR_GENERATOR gen_car62 0

SWITCH_CAR_GENERATOR com_car41 101

SWITCH_CAR_GENERATOR com_car42 101

SWITCH_CAR_GENERATOR com_car43 101

SWITCH_CAR_GENERATOR com_car44 101

SWITCH_CAR_GENERATOR com_car45 101

SWITCH_CAR_GENERATOR gen_car35 101

SWITCH_CAR_GENERATOR com_car15 101

SWITCH_CAR_GENERATOR com_car16 101

SWITCH_CAR_GENERATOR com_car17 101

SWITCH_CAR_GENERATOR com_car19 101

SWITCH_CAR_GENERATOR com_car24 101

SWITCH_CAR_GENERATOR com_car13 101

SWITCH_CAR_GENERATOR com_car23 0

SWITCH_CAR_GENERATOR com_car14 101

SWITCH_CAR_GENERATOR com_car22 101

SWITCH_CAR_GENERATOR phil_car 101

SWITCH_CAR_GENERATOR com_car46 101

SWITCH_CAR_GENERATOR com_car47 101

SWITCH_CAR_GENERATOR com_car48 101

SWITCH_CAR_GENERATOR com_car49 101

SWITCH_CAR_GENERATOR special_tank 0
 
SWITCH_CAR_GENERATOR sub_car1 101

SWITCH_CAR_GENERATOR sub_car2 101

SWITCH_CAR_GENERATOR sub_car3 101

SWITCH_CAR_GENERATOR sub_car4 101

SWITCH_CAR_GENERATOR sub_car5 101

SWITCH_CAR_GENERATOR sub_car6 101

SWITCH_CAR_GENERATOR sub_car7 101

SWITCH_CAR_GENERATOR sub_car25 101	  

SWITCH_CAR_GENERATOR gen_car63 0

SWITCH_CAR_GENERATOR sub_car40 101

SWITCH_CAR_GENERATOR sub_car41 101

SWITCH_CAR_GENERATOR sub_car42 101

SWITCH_CAR_GENERATOR sub_car43 101

SWITCH_CAR_GENERATOR sub_car44 101

SWITCH_CAR_GENERATOR sub_car45 101

SWITCH_CAR_GENERATOR sub_car46 101

SWITCH_CAR_GENERATOR sub_car8 101	  

SWITCH_CAR_GENERATOR sub_car9 101	  

SWITCH_CAR_GENERATOR sub_car10 101	  

SWITCH_CAR_GENERATOR sub_car11 101	  

SWITCH_CAR_GENERATOR sub_car12 101	  

SWITCH_CAR_GENERATOR sub_car13 101	  

SWITCH_CAR_GENERATOR sub_car14 101	  

SWITCH_CAR_GENERATOR sub_car15 101	  

SWITCH_CAR_GENERATOR sub_car16 101	  

SWITCH_CAR_GENERATOR sub_car19 101	  

SWITCH_CAR_GENERATOR sub_car20 101	  

SWITCH_CAR_GENERATOR sub_car17 101	  

SWITCH_CAR_GENERATOR sub_car18 101	  

SWITCH_CAR_GENERATOR sub_car21 101	  

SWITCH_CAR_GENERATOR sub_car22 101	  

SWITCH_CAR_GENERATOR sub_car23 101	  

SWITCH_CAR_GENERATOR sub_car24 101	  

SWITCH_CAR_GENERATOR sub_car30 101

SWITCH_CAR_GENERATOR sub_car31 101

SWITCH_CAR_GENERATOR rc_van1 101

SWITCH_CAR_GENERATOR rc_van2 101

SWITCH_CAR_GENERATOR rc_van3 101

SWITCH_CAR_GENERATOR rc_van4 101

RETURN







MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ***********************************Luigi Mission 2***************************************
// *******************************Donna' "Spank" Ma Bitch Up********************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME luigi2

// Mission start stuff

GOSUB mission_start_luigi2

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_luigi2_failed
	ENDIF

GOSUB mission_cleanup_luigi2

MISSION_END


// Variables for mission

VAR_INT radar_blip_ped1_lm2
 
VAR_INT victim_ped_lm2

VAR_INT flag_player_got_help_message_lm2

VAR_INT flag_victim_ped_lm2_changed

VAR_INT car_lm2

VAR_INT radar_blip_car1_lm2

VAR_INT radar_blip_coord1_lm2

VAR_INT radar_blip_coord2_lm2

VAR_INT flag_victim_dead_lm2

VAR_INT flag_player_had_car_message_lm2

VAR_INT flag_car_in_garage_lm2

VAR_INT flag_player_had_garage_message_lm2

VAR_INT flag_blip1_on_lm2

VAR_INT flag_blip2_on_lm2

VAR_INT buyer1_lm2

VAR_INT buyer2_lm2

VAR_INT flag_buyer1_dead_lm2

VAR_INT flag_buyer2_dead_lm2

VAR_INT flag_done_looking_bit_lm2

VAR_INT bat_lm2

VAR_INT sphere1_lm2

VAR_INT sphere2_lm2

VAR_INT flag_had_spray_help

VAR_INT flag_player_had_bat_message_lm2

VAR_INT bat_blip_lm2

VAR_INT flag_had_path_message_lm2

VAR_INT flag_lockup_message_lm2

VAR_INT flag_girl1_running_lm2

VAR_INT flag_girl2_running_lm2

VAR_INT flag_player_in_area_lm2

VAR_INT flag_player_in_car_lm2

// ********************************************Mission Start********************************    

mission_start_luigi2:

flag_player_on_mission = 1

flag_player_on_luigi_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_player_got_help_message_lm2 = 0

flag_victim_ped_lm2_changed = 0

flag_victim_dead_lm2 = 0

flag_car_in_garage_lm2 = 0

flag_player_had_car_message_lm2 = 0

flag_player_had_garage_message_lm2 = 0

flag_buyer1_dead_lm2 = 0

flag_buyer2_dead_lm2 = 0

flag_done_looking_bit_lm2 = 0

flag_had_spray_help = 0

flag_player_had_bat_message_lm2 = 0

flag_had_path_message_lm2 = 0

flag_lockup_message_lm2 = 0

flag_girl1_running_lm2 = 0

flag_girl2_running_lm2 = 0

flag_player_in_area_lm2 = 0

flag_player_in_car_lm2 = 0

{

REQUEST_MODEL PED_DOCKER2

REQUEST_MODEL PED_PROSTITUTE

REQUEST_MODEL PED_PROSTITUTE2

REQUEST_MODEL CAR_STALLION

CLEAR_HELP

// ****************************************START OF CUTSCENE********************************

/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_luigi2_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

PRINT_BIG ( LM2 ) 15000 2 //"Don'a SPANK ma bitch up"
*/

REQUEST_MODEL indhibuild3

REQUEST_MODEL luigiclubout

REQUEST_MODEL luigiineerclub

LOAD_SPECIAL_CHARACTER 1 MICKY

LOAD_SPECIAL_MODEL cut_obj1 LUDOOR
LOAD_SPECIAL_MODEL cut_obj2 MICKYH
LOAD_SPECIAL_MODEL cut_obj3 PLAYERH
LOAD_SPECIAL_MODEL cut_obj4 NOTE

/*
WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE
*/

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS 926.54 -471.72 1.0 830.76 -257.96 25.0

LOAD_ALL_MODELS_NOW
	
// Cutscene stuff

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj4

	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED indhibuild3
OR NOT HAS_MODEL_LOADED luigiclubout
OR NOT HAS_MODEL_LOADED luigiineerclub

	WAIT 0
	
ENDWHILE 

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor FALSE	

LOAD_CUTSCENE l2_dsb

SET_CUTSCENE_OFFSET 900.782 -427.523 13.829

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_micky

SET_CUTSCENE_ANIM cs_micky micky

CREATE_CUTSCENE_HEAD cs_micky CUT_OBJ2 cs_mickyhead

SET_CUTSCENE_HEAD_ANIM cs_mickyhead micky

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ3 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj1 cs_ludoor

SET_CUTSCENE_ANIM cs_ludoor LUDOOR

CREATE_CUTSCENE_OBJECT cut_obj4 cs_note

SET_CUTSCENE_ANIM cs_note NOTE

CLEAR_AREA 896.6 -426.2 13.9 1.0 TRUE
SET_PLAYER_COORDINATES player 896.6 -426.2 13.9

SET_PLAYER_HEADING player 270.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 5634
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM2_C ) 10000 1 //"Luigi said to give you this so..."

WHILE cs_time < 7989
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM2_D ) 10000 1 //"So here, here take it"

WHILE cs_time < 12078
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM2_A ) 10000 1 //"There's a new high on the street goes by the name of SPANK."

WHILE cs_time < 15287
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM2_E ) 10000 1 //"Some wiseguy's been introducing this trash to my girls down Portland Harbour."

WHILE cs_time < 19558
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM2_B ) 10000 1//"Go and introduce a bat to his face!

WHILE cs_time < 23042
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM2_F ) 10000 1//"Then take his car, respray it and bring it back here."

WHILE cs_time < 25852
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM2_G ) 10000 1//"I want compensation for this insult!"

WHILE cs_time < 28632
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( LM2_G )

WHILE cs_time < 31000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_STREAMING ON

SWITCH_RUBBISH ON

LOAD_SCENE 920.3 -425.4 15.0

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

SET_CAMERA_BEHIND_PLAYER

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ4

MARK_MODEL_AS_NO_LONGER_NEEDED indhibuild3

MARK_MODEL_AS_NO_LONGER_NEEDED luigiclubout

MARK_MODEL_AS_NO_LONGER_NEEDED luigiineerclub

SET_PED_DENSITY_MULTIPLIER 1.0

// ******************************************END OF CUTSCENE********************************

SWITCH_PED_ROADS_OFF 1609.8 -615.2 9.0 1557.8 -673.4 20.0

CREATE_PICKUP WEAPON_BAT PICKUP_ONCE 917.2 -425.3 14.5 bat_lm2

ADD_BLIP_FOR_PICKUP bat_lm2 bat_blip_lm2

WHILE NOT HAS_MODEL_LOADED CAR_STALLION
OR NOT HAS_MODEL_LOADED PED_DOCKER2
OR NOT HAS_MODEL_LOADED PED_PROSTITUTE
OR NOT HAS_MODEL_LOADED PED_PROSTITUTE2
 
	WAIT 0

ENDWHILE

WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE

SET_PLAYER_CONTROL player ON

PRINT_NOW ( BAT1 ) 5000 1 //"Pick up the bat!"

PRINT_HELP ( HELP14 ) //"To pick up weapons walk through them. These cannot be collected while in a vehicle"

// creates the dealer

CREATE_CHAR PEDTYPE_CIVFEMALE PED_DOCKER2 1399.64 -833.72 -100.0 victim_ped_lm2

TURN_CHAR_TO_FACE_COORD victim_ped_lm2 1397.46 -835.52 10.8 

CLEAR_CHAR_THREAT_SEARCH victim_ped_lm2

SET_CHAR_SUFFERS_CRITICAL_HITS victim_ped_lm2 TRUE  // This script command was unused and has been hijacked to set targeting priority!

// creates prostitute one

CREATE_CHAR PEDTYPE_PROSTITUTE PED_PROSTITUTE 1397.21 -832.86 -100.0 buyer1_lm2  //proper one

CLEAR_CHAR_THREAT_SEARCH buyer1_lm2

TURN_CHAR_TO_FACE_COORD buyer1_lm2 1399.64 -833.72 10.8 

// creates prostitute two

CREATE_CHAR PEDTYPE_PROSTITUTE PED_PROSTITUTE2 1397.28 -834.43 -100.0 buyer2_lm2

CLEAR_CHAR_THREAT_SEARCH buyer2_lm2

TURN_CHAR_TO_FACE_COORD buyer2_lm2 1399.64 -833.72 10.8 

// dealers car

CREATE_CAR CAR_STALLION 1396.67 -837.69 -100.0 car_lm2

SET_CAR_HEADING car_lm2 301.0

CHANGE_CAR_LOCK car_lm2 CARLOCK_LOCKED

ADD_BLIP_FOR_CHAR victim_ped_lm2 radar_blip_ped1_lm2


IF NOT IS_CHAR_DEAD victim_ped_lm2
		
	IF NOT IS_CHAR_DEAD buyer1_lm2  
		SET_CHARS_CHATTING victim_ped_lm2 buyer1_lm2 -1  // try -1 when this has been fixed
	ENDIF
	
ENDIF

WAIT 0

timerb = 0

WHILE NOT IS_CHAR_DEAD victim_ped_lm2

	GOSUB girls_running
	
	IF flag_player_had_bat_message_lm2 = 0

		IF HAS_PICKUP_BEEN_COLLECTED bat_lm2 
		   	PRINT_HELP ( GUN_1A )
		   	REMOVE_BLIP bat_blip_lm2
		   	CLEAR_THIS_PRINT ( BAT1 ) 
			flag_player_had_bat_message_lm2 = 1
		ENDIF

	ENDIF

	IF flag_had_path_message_lm2 = 0

		IF timerb >= 30000
			PRINT_HELP ( HELP13 ) //"Sometimes you may need to use pathways not shown on the radar."
			flag_had_path_message_lm2 = 1
		ENDIF

	ENDIF

/*   	
// Camera point at dealer stuff

IF flag_done_looking_bit_lm2 = 0

	IF IS_PLAYER_IN_AREA_3D player 1535.2 -615.1 10.0 1610.5 -681.0 20.0 FALSE
		
		IF IS_PLAYER_IN_ANY_CAR player
			APPLY_BRAKES_TO_PLAYERS_CAR player ON
		ENDIF

		SWITCH_WIDESCREEN ON
		CLEAR_WANTED_LEVEL player
		SET_POLICE_IGNORE_PLAYER player ON
		SET_PLAYER_CONTROL player OFF
		
		IF LOCATE_PLAYER_ANY_MEANS_3D player 1589.1 -641.4 11.1 1.0 1.0 1.0 FALSE
			SET_FIXED_CAMERA_POSITION 1587.8 -651.7 18.3 0.0 0.0 0.0
			POINT_CAMERA_AT_POINT 1587.5 -651.0 17.6 JUMP_CUT
		ELSE
			SET_FIXED_CAMERA_POSITION 1589.1 -641.4 11.1 0.0 0.0 0.0
			POINT_CAMERA_AT_POINT 1588.3 -642.0 11.3 JUMP_CUT
		ENDIF	
		

		WAIT 4500

		IF IS_CHAR_DEAD victim_ped_lm2
			REMOVE_BLIP radar_blip_ped1_lm2
			flag_victim_dead_lm2 = 1
		ENDIF

		IF IS_CAR_DEAD car_lm2
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_luigi2_failed
		ELSE
			
			IF IS_CAR_UPSIDEDOWN car_lm2
			AND IS_CAR_STOPPED car_lm2
				PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
				GOTO mission_luigi2_failed
			ENDIF

		ENDIF

		IF IS_PLAYER_IN_ANY_CAR player
			APPLY_BRAKES_TO_PLAYERS_CAR player FALSE
		ENDIF

		SWITCH_WIDESCREEN OFF
		RESTORE_CAMERA_JUMPCUT
		SET_POLICE_IGNORE_PLAYER player OFF
		SET_PLAYER_CONTROL player ON
		flag_done_looking_bit_lm2 = 1
	ENDIF

	
ENDIF
*/

   
	IF IS_CHAR_DEAD victim_ped_lm2
		REMOVE_BLIP radar_blip_ped1_lm2
		flag_victim_dead_lm2 = 1
	ENDIF

	IF IS_CAR_DEAD car_lm2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_luigi2_failed
	ELSE

		IF IS_CAR_UPSIDEDOWN car_lm2
		AND IS_CAR_STOPPED car_lm2
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_luigi2_failed
		ENDIF

	ENDIF

IF flag_done_looking_bit_lm2 = 1
OR IS_PLAYER_IN_AREA_3D player 1430.75 -807.0 9.0 1355.2 -883.2 20.0 FALSE
	flag_done_looking_bit_lm2 = 1  // set this here also to stop bloke going for player once he has got out of his car
	flag_player_in_area_lm2 = 1

	IF flag_victim_dead_lm2 = 0
		
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D player victim_ped_lm2 10.0 10.0 10.0 FALSE
		AND flag_victim_ped_lm2_changed = 0
			TURN_CHAR_TO_FACE_PLAYER victim_ped_lm2 player
			SET_CHAR_THREAT_SEARCH victim_ped_lm2 THREAT_PLAYER1
			SET_CHAR_PERSONALITY victim_ped_lm2 PEDSTAT_TOUGH_GUY
			SET_CHAR_HEED_THREATS victim_ped_lm2 TRUE
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT victim_ped_lm2 player 
			flag_victim_ped_lm2_changed = 1
		ENDIF

		IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D player victim_ped_lm2 6.0 6.0 15.0 FALSE
		AND flag_player_got_help_message_lm2 = 0

			PRINT_HELP ( LM2_2A ) //"Use the circle button to punch and kick!"
			flag_player_got_help_message_lm2 = 1
						
		ENDIF

	ENDIF

ENDIF
	
	WAIT 0
										
ENDWHILE

IF NOT HAS_PICKUP_BEEN_COLLECTED bat_lm2 
	REMOVE_BLIP bat_blip_lm2
	REMOVE_PICKUP bat_lm2
	flag_player_had_bat_message_lm2 = 1
ENDIF

REMOVE_BLIP radar_blip_ped1_lm2

IF IS_CAR_DEAD car_lm2
	PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
	GOTO mission_luigi2_failed
ELSE

	IF IS_CAR_UPSIDEDOWN car_lm2
	AND IS_CAR_STOPPED car_lm2
		PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
		GOTO mission_luigi2_failed
	ENDIF

ENDIF

CHANGE_CAR_LOCK car_lm2 CARLOCK_UNLOCKED

ADD_BLIP_FOR_CAR car_lm2 radar_blip_car1_lm2

PRINT_NOW ( LM2_1 ) 7000 1 //"Take the car and get it resprayed."

// waiting for the player to get into the car

WHILE NOT IS_PLAYER_IN_CAR player car_lm2

	WAIT 0

	GOSUB girls_running

	IF IS_CAR_DEAD car_lm2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_luigi2_failed
	ELSE

		IF IS_CAR_UPSIDEDOWN car_lm2
		AND IS_CAR_STOPPED car_lm2
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_luigi2_failed
		ENDIF

	ENDIF
			
ENDWHILE

flag_player_in_car_lm2 = 1

SET_FREE_RESPRAYS ON

REMOVE_BLIP radar_blip_car1_lm2

ADD_SPRITE_BLIP_FOR_COORD 924.0 -361.0 10.0 RADAR_SPRITE_SPRAY radar_blip_coord1_lm2

ADD_SPHERE 925.1 -350.5 9.3 2.5 sphere1_lm2 

HAS_RESPRAY_HAPPENED sprayshop1

// waiting for the player to respray the car

WHILE NOT HAS_RESPRAY_HAPPENED sprayshop1
OR NOT IS_PLAYER_IN_CAR player car_lm2
OR NOT IS_PLAYER_STOPPED_IN_AREA_2D player 922.6 -366.1 928.6 -354.3 FALSE
	
 	WAIT 0

 	IF IS_CAR_DEAD car_lm2
 		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
 		GOTO mission_luigi2_failed
 	ELSE

		IF IS_CAR_UPSIDEDOWN car_lm2
		AND IS_CAR_STOPPED car_lm2
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_luigi2_failed
		ENDIF

	ENDIF

 	IF NOT IS_PLAYER_IN_CAR player car_lm2
 	AND flag_player_had_car_message_lm2 = 0
 		PRINT_NOW ( IN_VEH ) 7000 1 //"Get back into the car and get on with the mission!"
 		REMOVE_BLIP radar_blip_coord1_lm2
		REMOVE_SPHERE sphere1_lm2
 		ADD_BLIP_FOR_CAR car_lm2 radar_blip_car1_lm2
 		flag_player_had_car_message_lm2 = 1
 	ENDIF

	IF IS_PLAYER_IN_CAR player car_lm2
	AND flag_player_had_car_message_lm2 = 1
		REMOVE_BLIP radar_blip_car1_lm2
		ADD_SPRITE_BLIP_FOR_COORD 924.0 -361.0 10.0 RADAR_SPRITE_SPRAY radar_blip_coord1_lm2

			IF flag_had_spray_help = 0 
				ADD_SPHERE 925.1 -350.5 9.3 2.5 sphere1_lm2
			ENDIF

		flag_player_had_car_message_lm2 = 0
	ENDIF

	IF LOCATE_PLAYER_IN_CAR_3D player 925.1 -350.5 9.3 2.5 2.5 2.5 FALSE
	AND IS_PLAYER_IN_CAR player car_lm2
		
		IF flag_had_spray_help = 0
			PRINT_HELP ( SPRAY1 )
			REMOVE_SPHERE sphere1_lm2 
			flag_had_spray_help = 1
		ENDIF
		
	ENDIF 

ENDWHILE

REMOVE_SPHERE sphere1_lm2

REMOVE_BLIP radar_blip_coord1_lm2

ADD_BLIP_FOR_COORD 1087.0 -574.0 -100.0 radar_blip_coord2_lm2

ADD_SPHERE 1088.4 -574.4 13.7 2.5 sphere2_lm2

flag_blip2_on_lm2 = 1

SET_TARGET_CAR_FOR_MISSION_GARAGE garage_lm2 car_lm2

//PRINT_NOW ( LM2_3 ) 7000 1 //"Good now get the car to the lockup!"

timerb = 0

// Waiting for the player to get back to luigi's

WHILE NOT IS_CAR_IN_MISSION_GARAGE garage_lm2
	
	WAIT 0	

	IF flag_lockup_message_lm2 = 0
	
		IF timerb >= 3000
			PRINT_NOW ( LM2_3 ) 7000 1 //"Good now get the car to the lockup!"
			flag_lockup_message_lm2 = 1
		ENDIF

	ENDIF
		
IF flag_car_in_garage_lm2 = 0

	IF IS_CAR_DEAD car_lm2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_luigi2_failed
	ELSE

		IF IS_CAR_UPSIDEDOWN car_lm2
		AND IS_CAR_STOPPED car_lm2
			PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
			GOTO mission_luigi2_failed
		ENDIF

	ENDIF
   
	IF NOT IS_PLAYER_IN_CAR player car_lm2
	AND flag_player_had_car_message_lm2 = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //" Get back in the car and get on with the mission!"
		REMOVE_SPHERE sphere2_lm2
		ADD_BLIP_FOR_CAR car_lm2 radar_blip_car1_lm2
		REMOVE_BLIP radar_blip_coord2_lm2
		flag_player_had_car_message_lm2 = 1
	ENDIF
	
	IF IS_PLAYER_IN_CAR player car_lm2
	AND flag_player_had_car_message_lm2 = 1
		REMOVE_BLIP radar_blip_car1_lm2 
		ADD_BLIP_FOR_COORD 1087.0 -574.0 -100.0 radar_blip_coord2_lm2

		IF flag_player_had_garage_message_lm2 = 0 
			ADD_SPHERE 1088.4 -574.4 13.7 2.5 sphere2_lm2
		ENDIF

		flag_player_had_car_message_lm2 = 0
	ENDIF

	IF flag_player_had_garage_message_lm2 = 0
			
		IF LOCATE_PLAYER_IN_CAR_3D player 1088.4 -574.4 13.7 2.5 2.5 2.5 FALSE
	 	AND IS_PLAYER_IN_CAR player car_lm2
			PRINT_HELP ( GARAGE ) //"Drive the car into the garage, get out of the car and walk outside of the garage"
			REMOVE_SPHERE sphere2_lm2
 			flag_player_had_garage_message_lm2 = 1
		ENDIF

	ENDIF
	
	IF NOT LOCATE_PLAYER_IN_CAR_3D player 1088.4 -574.4 13.7 2.5 2.5 2.5 FALSE
	AND flag_player_had_garage_message_lm2 = 1
		flag_player_had_garage_message_lm2 = 0
	ENDIF

ENDIF

IF NOT IS_CAR_DEAD car_lm2 

	//	IF IS_CAR_STOPPED_IN_AREA_2D car_lm2 1074.0 -578.0 1085.0 -568.0 FALSE
	IF DOES_GARAGE_CONTAIN_CAR garage_lm2 car_lm2
		flag_car_in_garage_lm2 = 1
	ELSE
		flag_car_in_garage_lm2 = 0
	ENDIF

ENDIF
		
ENDWHILE

REMOVE_BLIP radar_blip_coord2_lm2

REMOVE_SPHERE sphere2_lm2

}
		
GOTO mission_luigi2_passed
		

// Mission luigi1 failed

mission_luigi2_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN
		

// mission Luigi1 passed

mission_luigi2_passed:

flag_luigi_mission2_passed = 1
REGISTER_MISSION_PASSED ( LM2 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 4000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 4000
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT luigi_mission3_loop   
RETURN

// mission cleanup

mission_cleanup_luigi2:

flag_player_on_mission = 0
flag_player_on_luigi_mission = 0

IF flag_player_had_bat_message_lm2 = 0
	REMOVE_BLIP bat_blip_lm2
	REMOVE_PICKUP bat_lm2
ENDIF

IF NOT IS_CAR_DEAD car_lm2
	CHANGE_CAR_LOCK car_lm2 CARLOCK_UNLOCKED
ENDIF

SET_TARGET_CAR_FOR_MISSION_GARAGE garage_lm2 -1
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STALLION
MARK_MODEL_AS_NO_LONGER_NEEDED PED_DOCKER2
MARK_MODEL_AS_NO_LONGER_NEEDED PED_PROSTITUTE
MARK_MODEL_AS_NO_LONGER_NEEDED PED_PROSTITUTE2
REMOVE_BLIP radar_blip_ped1_lm2
REMOVE_BLIP radar_blip_car1_lm2
REMOVE_BLIP radar_blip_coord1_lm2
REMOVE_BLIP radar_blip_coord2_lm2
REMOVE_BLIP bat_blip_lm2
REMOVE_SPHERE sphere1_lm2
REMOVE_SPHERE sphere2_lm2
SET_FREE_RESPRAYS OFF
SWITCH_PED_ROADS_ON 1609.8 -615.2 9.0 1557.8 -673.4 20.0
MISSION_HAS_FINISHED
RETURN


girls_running:

// checks for girl1

IF flag_player_in_car_lm2 = 0

	IF flag_player_in_area_lm2 = 1

		IF flag_victim_ped_lm2_changed = 1

			IF flag_buyer1_dead_lm2 = 0

				IF IS_CHAR_DEAD buyer1_lm2
					flag_buyer1_dead_lm2 = 1
				ELSE

					IF flag_girl1_running_lm2 = 0
						SET_CHAR_OBJ_RUN_TO_COORD buyer1_lm2 1387.21 -837.38
						flag_girl1_running_lm2 = 1
					ENDIF

					IF flag_girl1_running_lm2 = 1

						IF LOCATE_CHAR_ON_FOOT_3D buyer1_lm2 1387.21 -837.38 10.8 4.0 4.0 4.0 FALSE
							SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS buyer1_lm2 player
							flag_girl1_running_lm2 = 2   
						ENDIF

					ENDIF

				ENDIF 
					
			ENDIF
   
// checks for girl2

			IF flag_buyer2_dead_lm2 = 0

				IF IS_CHAR_DEAD buyer2_lm2
					flag_buyer2_dead_lm2 = 1
				ELSE

					IF flag_girl2_running_lm2 = 0
						SET_CHAR_OBJ_RUN_TO_COORD buyer2_lm2 1385.98 -839.30
						flag_girl2_running_lm2 = 1
					ENDIF

					IF flag_girl2_running_lm2 = 1

						IF LOCATE_CHAR_ON_FOOT_3D buyer2_lm2 1385.98 -839.30 10.8 4.0 4.0 4.0 FALSE
							SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS buyer2_lm2 player
							flag_girl2_running_lm2 = 2
						ENDIF
									
					ENDIF
															  
				ENDIF

			ENDIF

		ENDIF

	ENDIF

ENDIF

RETURN
MISSION_START

// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************Luigi mission 3*********************************
// ***************************************"Drive Misty For Me"****************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME luigi3

// Mission Start Stuff

GOSUB mission_start_luigi3

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_luigi3_failed
	ENDIF

GOSUB mission_cleanup_luigi3

MISSION_END

// Variable for mission

VAR_INT radar_blip_coord1_lm3

VAR_INT radar_blip_coord2_lm3

VAR_INT misty_lm3

VAR_INT car_lm3

VAR_INT flag_player_got_message_lm3

VAR_INT flag_player_got_cops_message_lm3

VAR_INT flag_player_not_in_zone_lm3

VAR_FLOAT door1_position_lm3

VAR_FLOAT door2_position_lm3

VAR_FLOAT difference_in_heading_door1_lm3

VAR_FLOAT difference_in_heading_door2_lm3

VAR_INT flag_blip_on_misty_lm3

VAR_INT radar_blip_ped1_lm3

VAR_INT flag_had_bus_message_lm3

VAR_INT flag_camera_mode_lm3

VAR_INT cut_car_lm3

VAR_INT cut_car2_lm3

VAR_INT cut_car3_lm3

// ****************************************Mission Start************************************

mission_start_luigi3:

flag_player_on_mission = 1

flag_player_on_luigi_mission = 1

REGISTER_MISSION_GIVEN

DISPLAY_RADAR 4 // HACKED RADAR STOP AT STREET

WAIT 0

flag_player_got_message_lm3 = 0

flag_player_got_cops_message_lm3 = 0

flag_player_not_in_zone_lm3 = 0

door1_position_lm3 = 0.0

door2_position_lm3 = 0.0

difference_in_heading_door1_lm3 = 0.0

difference_in_heading_door2_lm3 = 0.0

flag_blip_on_misty_lm3 = 0

blob_flag = 1

flag_had_bus_message_lm3 = 0

flag_camera_mode_lm3 = 0


// *****************************************START OF CUT_SCENE******************************
{
/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_luigi3_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

PRINT_BIG ( LM3 ) 15000 2 //"Drive Misty For Me."
*/

LOAD_SPECIAL_CHARACTER 1 LUIGI
LOAD_SPECIAL_CHARACTER 2 MICKY

REQUEST_MODEL indhibuild3

REQUEST_MODEL luigiclubout

REQUEST_MODEL luigiineerclub

LOAD_SPECIAL_MODEL cut_obj1 LUDOOR
LOAD_SPECIAL_MODEL cut_obj2 LUIGIH
LOAD_SPECIAL_MODEL cut_obj3 PLAYERH
LOAD_SPECIAL_MODEL cut_obj4 MICKYH

/*
WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE
*/

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS 926.54 -471.72 1.0 830.76 -257.96 25.0

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj4

	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED indhibuild3
OR NOT HAS_MODEL_LOADED luigiclubout
OR NOT HAS_MODEL_LOADED luigiineerclub

	WAIT 0
	
ENDWHILE  

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor FALSE	

LOAD_CUTSCENE l3_dm

SET_CUTSCENE_OFFSET 900.782 -427.523 13.829

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_luigi

SET_CUTSCENE_ANIM cs_luigi luigi

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_micky

SET_CUTSCENE_ANIM cs_micky micky

CREATE_CUTSCENE_HEAD cs_luigi CUT_OBJ2 cs_luigihead

SET_CUTSCENE_HEAD_ANIM cs_luigihead luigi

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ3 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_micky CUT_OBJ4 cs_mickyhead

SET_CUTSCENE_HEAD_ANIM cs_mickyhead micky

CREATE_CUTSCENE_OBJECT cut_obj1 cs_ludoor

SET_CUTSCENE_ANIM cs_ludoor LUDOOR

CLEAR_AREA 896.6 -426.2 13.9 1.0 TRUE
SET_PLAYER_COORDINATES player 896.6 -426.2 13.9

SET_PLAYER_HEADING player 270.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2433
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_A ) 10000 1 //"Hey I've gotta talk to you... All right Mick I talk to yah later"

WHILE cs_time < 5504
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( LM3_A )

WHILE cs_time < 8333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_B ) 10000 1 //"How yah doing kid?

WHILE cs_time < 9667
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_C ) 10000 1 //"The Don's son, Joey Leone, he wants some action from his regular girl Misty"

WHILE cs_time < 13833
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_D ) 10000 1 //"Go pick her up at Hepburn Heights..."

WHILE cs_time < 15467
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_E ) 10000 1 //"but watch yourself that's Diablo turf."

WHILE cs_time < 18233
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_F ) 10000 1 //"Then run her over to his garage in Trenton and make it quick,"

WHILE cs_time < 21100
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_G ) 10000 1 //"Joey ain't the kinda you keep waiting, remember, this is your foot in the door..."

WHILE cs_time < 25333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_H ) 10000 1 //"so keep your eyes on the road and off Misty!"

WHILE cs_time < 27701
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( LM3_H )

WHILE cs_time < 29666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_STREAMING ON

SWITCH_RUBBISH ON

LOAD_SCENE 920.3 -425.4 15.0

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE

UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ4

MARK_MODEL_AS_NO_LONGER_NEEDED indhibuild3

MARK_MODEL_AS_NO_LONGER_NEEDED luigiclubout

MARK_MODEL_AS_NO_LONGER_NEEDED luigiineerclub

SET_PED_DENSITY_MULTIPLIER 1.0

// *****************************************END OF CUTSCENE*********************************

LOAD_SPECIAL_CHARACTER 2 misty

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 2
 
	WAIT 0

ENDWHILE

WHILE GET_FADING_STATUS

    WAIT 0

ENDWHILE

PRINT_NOW ( LM3_10 ) 5000 1 //Get a vehicle!"

PRINT_HELP ( HELP15 ) //"Press the...."

// waiting for the player to get into a car

WHILE NOT IS_PLAYER_IN_ANY_CAR player

	WAIT 0
  
ENDWHILE

STORE_CAR_PLAYER_IS_IN player car_lm3

PRINT_NOW ( LM3_4 ) 7000 1 //"Now Pick up Misty!"

LOAD_MISSION_AUDIO L2_A

ADD_BLIP_FOR_COORD 937.9 -259.8 -100.0 radar_blip_coord1_lm3

// waiting for the player to get to Misty's flat

blob_flag = 1

WHILE NOT LOCATE_STOPPED_PLAYER_IN_CAR_2D player 937.9 -259.8 3.0 3.0 blob_flag
OR NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0
         	    	 
	IF NOT IS_PLAYER_IN_ANY_CAR player
	AND flag_player_got_message_lm3 = 0
		PRINT_NOW ( IN_VEH2 ) 5000 1 //"Get a vehicle and get on with the mission!"
		REMOVE_BLIP radar_blip_coord1_lm3
		flag_player_got_message_lm3 = 1
		blob_flag = 0
	ENDIF
	
	IF IS_PLAYER_IN_ANY_CAR player
	AND flag_player_got_message_lm3 = 1
	   	ADD_BLIP_FOR_COORD 937.9 -259.8 -100.0 radar_blip_coord1_lm3
		STORE_CAR_PLAYER_IS_IN player car_lm3
		flag_player_got_message_lm3 = 0
		blob_flag = 1
	ENDIF

ENDWHILE

PRINT_HELP ( LM3_1A ) //"Press the~h~ L3 button~w~ to activate the ~h~horn~w~ and let Misty know you are here."

blob_flag = 1

WHILE NOT IS_PLAYER_PRESSING_HORN player
OR NOT LOCATE_STOPPED_PLAYER_IN_CAR_2D player 937.9 -259.8 3.0 3.0 blob_flag
OR NOT IS_PLAYER_SITTING_IN_ANY_CAR player
		
	WAIT 0
	
	IF NOT IS_PLAYER_IN_ANY_CAR player
	AND flag_player_got_message_lm3 = 0
		PRINT_NOW ( IN_VEH2 ) 5000 1 //"Get a vehicle and get on with the mission!"
		REMOVE_BLIP radar_blip_coord1_lm3
		flag_player_got_message_lm3 = 1
		blob_flag = 0
	ENDIF
	
	IF IS_PLAYER_IN_ANY_CAR player
	AND flag_player_got_message_lm3 = 1
		ADD_BLIP_FOR_COORD 937.9 -259.8 -100.0 radar_blip_coord1_lm3
		STORE_CAR_PLAYER_IS_IN player car_lm3
		flag_player_got_message_lm3 = 0
		blob_flag = 1
	ENDIF
	
ENDWHILE

CLEAR_HELP

GET_PLAYER_CHAR player script_controlled_player

SET_CHAR_CANT_BE_DRAGGED_OUT script_controlled_player TRUE

/*
IF IS_PLAYER_IN_ANY_CAR player

	STORE_CAR_PLAYER_IS_IN player car_lm3

	IF NOT IS_CAR_DEAD car_lm3
		LOCK_CAR_DOORS car_lm3 CARLOCK_LOCKED_PLAYER_INSIDE
	ENDIF

ENDIF
*/


WAIT 500

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

/*
IF IS_PLAYER_IN_ANY_CAR player

	STORE_CAR_PLAYER_IS_IN player car_lm3

	IF NOT IS_CAR_DEAD car_lm3
		LOCK_CAR_DOORS car_lm3 CARLOCK_LOCKED_PLAYER_INSIDE
	ENDIF

ENDIF
*/

CLEAR_AREA 936.2 -263.9 5.0 1.0 TRUE

IF LOCATE_PLAYER_IN_CAR_2D player 937.9 -259.8 3.0 3.0 FALSE

   	IF IS_PLAYER_IN_MODEL player CAR_BUS
	OR IS_PLAYER_IN_MODEL player CAR_COACH
	OR IS_PLAYER_IN_MODEL player CAR_FLATBED
	OR IS_PLAYER_IN_MODEL player CAR_FIRETRUCK
	OR IS_PLAYER_IN_MODEL player CAR_LANDSTALKER
	OR IS_PLAYER_IN_MODEL player CAR_LINERUNNER
		flag_camera_mode_lm3 = 1
	ENDIF
	
	IF IS_PLAYER_IN_MODEL player CAR_TRASHMASTER
	OR IS_PLAYER_IN_MODEL player CAR_PONY
	OR IS_PLAYER_IN_MODEL player CAR_MULE
	OR IS_PLAYER_IN_MODEL player CAR_AMBULANCE
	OR IS_PLAYER_IN_MODEL player CAR_MRWHOOPEE
	OR IS_PLAYER_IN_MODEL player CAR_ENFORCER
		flag_camera_mode_lm3 = 1
	ENDIF
		
	IF IS_PLAYER_IN_MODEL player CAR_RUMPO
	OR IS_PLAYER_IN_MODEL player CAR_BELLYUP
	OR IS_PLAYER_IN_MODEL player CAR_MRWONGS
	OR IS_PLAYER_IN_MODEL player CAR_YANKEE
	OR IS_PLAYER_IN_MODEL player CAR_SECURICAR
		flag_camera_mode_lm3 = 1
	ENDIF

ENDIF

IF flag_camera_mode_lm3 = 1
	CLEAR_AREA 930.112 -264.972 7.336 4.0 TRUE 
	SET_FIXED_CAMERA_POSITION 930.112 -264.972 7.336 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT 930.959 -265.474 7.164 JUMP_CUT 
ELSE
	CLEAR_AREA 928.169 -267.549 4.0 4.0 TRUE
	SET_FIXED_CAMERA_POSITION 928.169 -267.549 5.623 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT 929.162 -267.43 5.656 JUMP_CUT
ENDIF

SET_POLICE_IGNORE_PLAYER player ON

SET_EVERYONE_IGNORE_PLAYER player ON

//CLEAR_AREA 943.8 -271.5 4.0 4.0 TRUE // This should get rid of any stuff to block the cut-scene area

CLEAR_AREA 941.7 -269.2 4.0 1.0 TRUE // Location misty is going to run to 

REMOVE_BLIP radar_blip_coord1_lm3

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 946.47 -275.50 3.9 misty_lm3

TURN_CHAR_TO_FACE_COORD misty_lm3 942.0 -268.0 -100.0

CLEAR_CHAR_THREAT_SEARCH misty_lm3

SET_ANIM_GROUP_FOR_CHAR misty_lm3 ANIM_SEXY_WOMANPED

// opens the doors

GET_OBJECT_HEADING misty_door1 door1_position_lm3

WHILE NOT door1_position_lm3 = 90.0

	WAIT 0

	IF IS_CHAR_DEAD misty_lm3
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
		GOTO mission_luigi3_failed
	ENDIF

	difference_in_heading_door1_lm3 = 90.0 - door1_position_lm3

		IF difference_in_heading_door1_lm3 < 10.0
			door1_position_lm3 = 90.0
		ELSE
			door1_position_lm3 += 10.0
		ENDIF

	SET_OBJECT_HEADING misty_door1 door1_position_lm3

ENDWHILE

WAIT 0

IF IS_CHAR_DEAD misty_lm3
	PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
	GOTO mission_luigi3_failed
ENDIF

CLEAR_AREA 944.1 -270.7 4.0 2.0 TRUE 

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT misty_lm3 944.1 -270.7

//POINT_CAMERA_AT_CHAR misty_lm3 FIXED JUMP_CUT

timerb = 0 

WHILE NOT IS_CHAR_OBJECTIVE_PASSED misty_lm3  // Try this one to see if it passes ok

	WAIT 0
	     
	IF IS_PLAYER_IN_ANY_CAR player

		STORE_CAR_PLAYER_IS_IN player car_lm3
	
		IF IS_CAR_DEAD car_lm3
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!" 
			GOTO mission_luigi3_failed
		ENDIF

	ENDIF
		 				
	IF IS_CHAR_DEAD misty_lm3
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
		GOTO mission_luigi3_failed
	ENDIF

	IF timerb >= 10000

		IF NOT IS_CHAR_OBJECTIVE_PASSED misty_lm3
			SET_CHAR_COORDINATES misty_lm3 944.1 -270.7 3.9
		ENDIF
	
	ENDIF 

ENDWHILE

CLEAR_AREA 941.0 -264.0 -100.0 4.0 TRUE


/*
// Close the door

WHILE NOT door1_position_lm3 = 0.0

	WAIT 0
			  				
	IF IS_PLAYER_IN_ANY_CAR player

		STORE_CAR_PLAYER_IS_IN player car_lm3
	
		IF IS_CAR_DEAD car_lm3
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!" 
			GOTO mission_luigi3_failed
		ENDIF

	ENDIF
 				
	IF IS_CHAR_DEAD misty_lm3
		PRINT_NOW ( MISTY1 ) 5000 1  //"Misty's dead!" 
		GOTO mission_luigi3_failed
	ENDIF

	difference_in_heading_door1_lm3 = door1_position_lm3

	IF difference_in_heading_door1_lm3 < 10.0
		door1_position_lm3 = 0.0
	ELSE
		door1_position_lm3 -= 10.0
	ENDIF

	SET_OBJECT_HEADING misty_door1 door1_position_lm3

ENDWHILE

*/
SET_FIXED_CAMERA_POSITION 934.2 -265.8 5.9 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 934.7 -264.9 5.7 JUMP_CUT

SET_OBJECT_HEADING misty_door1 0.0

IF NOT IS_CHAR_DEAD misty_lm3

	IF NOT IS_AREA_OCCUPIED 934.10 -266.46 2.0 935.08 -268.90 10.0 FALSE TRUE TRUE TRUE TRUE
		CLEAR_AREA 934.79 -267.47 3.9 1.0 TRUE 
		SET_CHAR_COORDINATES misty_lm3 934.79 -267.47 3.9
	ENDIF

ENDIF

IF IS_PLAYER_IN_ANY_CAR player
	
	STORE_CAR_PLAYER_IS_IN player car_lm3

	SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER misty_lm3 car_lm3
	   
   //	IF NOT IS_CAR_DEAD car_lm3
   //		LOCK_CAR_DOORS car_lm3 CARLOCK_UNLOCKED
   //	ENDIF					  

	IF IS_CAR_DEAD car_lm3
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!" 
		GOTO mission_luigi3_failed
	ENDIF

	// waiting for Misty to get into the car 
	
	WHILE NOT IS_CHAR_IN_CAR misty_lm3 car_lm3
		  
		WAIT 0

		IF IS_CAR_DEAD car_lm3
			
			IF IS_CHAR_DEAD misty_lm3
				PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
				GOTO mission_luigi3_failed
			ELSE
				PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!" 
				GOTO mission_luigi3_failed
			ENDIF

		ENDIF
	   			 				
		IF IS_CHAR_DEAD misty_lm3
			PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
			GOTO mission_luigi3_failed
		ENDIF
		     
	ENDWHILE

ELSE

	SET_CHAR_OBJ_GOTO_PLAYER_ON_FOOT misty_lm3 player

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED misty_lm3

		WAIT 0
			
		IF IS_PLAYER_IN_ANY_CAR player

			STORE_CAR_PLAYER_IS_IN player car_lm3
	
			IF IS_CAR_DEAD car_lm3
				PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!" 
				GOTO mission_luigi3_failed
			ENDIF

		ENDIF
 				
		IF IS_CHAR_DEAD misty_lm3
			PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
			GOTO mission_luigi3_failed
		ENDIF

	ENDWHILE

ENDIF

SET_PLAYER_AS_LEADER misty_lm3 player

SWITCH_WIDESCREEN OFF

RESTORE_CAMERA

SET_CHAR_CANT_BE_DRAGGED_OUT script_controlled_player FALSE

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

SET_EVERYONE_IGNORE_PLAYER player OFF

PLAY_MISSION_AUDIO

PRINT_NOW ( LM3_5 ) 7000 1 //"You working for Luigi regular huh? It's about time he got a driver we can trust!"

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CHAR_DEAD misty_lm3
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
		GOTO mission_luigi3_failed
	ENDIF
  
	IF NOT IS_CHAR_IN_PLAYERS_GROUP misty_lm3 player
	AND flag_blip_on_misty_lm3 = 0
		PRINT_NOW ( HEY4 ) 5000 1 //"You have left Misty behind go and get her!"
		ADD_BLIP_FOR_CHAR misty_lm3 radar_blip_ped1_lm3
		//REMOVE_BLIP radar_blip_coord2_lm3
		flag_blip_on_misty_lm3 = 1
		blob_flag = 0
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player misty_lm3 8.0 8.0 FALSE
	AND flag_blip_on_misty_lm3 = 1
		SET_PLAYER_AS_LEADER misty_lm3 player
		//PRINT_NOW ( LM3_2 ) 5000 1 //"Take Misty to see Joey Leone."
		REMOVE_BLIP radar_blip_ped1_lm3
	  	//ADD_BLIP_FOR_COORD 1196.0 -874.0 -100.0 radar_blip_coord2_lm3
		flag_blip_on_misty_lm3 = 0
		blob_flag = 1
	ENDIF
	
ENDWHILE

CLEAR_THIS_PRINT ( LM3_5 )

PRINT_NOW ( LM3_2 ) 5000 1 //"Take Misty to see Joey Leone."

ADD_BLIP_FOR_COORD 1196.0 -874.0 -100.0 radar_blip_coord2_lm3

blob_flag = 1

WHILE NOT LOCATE_STOPPED_PLAYER_ANY_MEANS_2D player 1196.0 -874.0 3.0 4.0 blob_flag
OR NOT LOCATE_STOPPED_CHAR_ANY_MEANS_2D misty_lm3 1196.0 -874.0 3.0 4.0 FALSE

	WAIT 0
		
	IF IS_CHAR_DEAD misty_lm3
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
		GOTO mission_luigi3_failed
	ENDIF
    	
	IF NOT IS_CHAR_IN_PLAYERS_GROUP misty_lm3 player
	AND flag_blip_on_misty_lm3 = 0
		PRINT_NOW ( HEY4 ) 5000 1 //"You have left Misty behind go and get her!"
		ADD_BLIP_FOR_CHAR misty_lm3 radar_blip_ped1_lm3
		REMOVE_BLIP radar_blip_coord2_lm3
		flag_blip_on_misty_lm3 = 1
		blob_flag = 0
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player misty_lm3 8.0 8.0 FALSE
	AND flag_blip_on_misty_lm3 = 1
		SET_PLAYER_AS_LEADER misty_lm3 player
		PRINT_NOW ( LM3_2 ) 5000 1 //"Take Misty to see Joey Leone."
		REMOVE_BLIP radar_blip_ped1_lm3
	  	ADD_BLIP_FOR_COORD 1196.0 -874.0 -100.0 radar_blip_coord2_lm3
		flag_blip_on_misty_lm3 = 0
		blob_flag = 1
	ENDIF 
		
ENDWHILE

REMOVE_BLIP radar_blip_coord2_lm3

SET_FIXED_CAMERA_POSITION 1211.85 -882.40 19.42 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 1210.99 -881.90 19.34 JUMP_CUT

IF IS_CHAR_DEAD misty_lm3
	PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
	GOTO mission_luigi3_failed
ENDIF

LEAVE_GROUP misty_lm3

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

CLEAR_WANTED_LEVEL player

CLEAR_AREA 1190.6 -869.1 -100.0 6.0 TRUE // This should get rid of any stuff to block the cut-scene area

SET_POLICE_IGNORE_PLAYER player ON

GET_PLAYER_CHAR player script_controlled_player

IF IS_CHAR_IN_ANY_CAR misty_lm3
	STORE_CAR_CHAR_IS_IN misty_lm3 car_lm3   
	SET_CHAR_OBJ_LEAVE_CAR misty_lm3 car_lm3
ENDIF

WHILE IS_CHAR_IN_ANY_CAR misty_lm3

	WAIT 0

	IF IS_CHAR_DEAD misty_lm3
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
		GOTO mission_luigi3_failed
	ENDIF
   	 	
ENDWHILE

IF IS_CHAR_IN_ANY_CAR script_controlled_player
	STORE_CAR_CHAR_IS_IN script_controlled_player car_lm3
	SET_CHAR_OBJ_LEAVE_CAR script_controlled_player car_lm3
ENDIF

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT misty_lm3 1193.1 -868.3

WHILE IS_CHAR_IN_ANY_CAR script_controlled_player

	WAIT 0

	IF IS_CHAR_DEAD misty_lm3
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
		GOTO mission_luigi3_failed
	ENDIF
  	 	
ENDWHILE

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT script_controlled_player 1193.1 -868.3

WAIT 500

IF IS_CHAR_DEAD misty_lm3
	PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
	GOTO mission_luigi3_failed
ENDIF

MARK_CAR_AS_NO_LONGER_NEEDED car_lm3   

// ********************************START OF CUT-SCENE PART TWO******************************

GET_GAME_TIMER breakout_timer_start

breakout_diff = 0

WHILE NOT CAN_PLAYER_START_MISSION Player
AND breakout_diff < 5000	//	if player is not in control after 5 secs do the cutscene anyway

	WAIT 0

	IF IS_CHAR_DEAD misty_lm3
		PRINT_NOW ( MISTY1 ) 5000 1 //"Misty's dead!" 
		GOTO mission_luigi3_failed
	ENDIF
	
	GET_GAME_TIMER breakout_timer

	breakout_diff = breakout_timer - breakout_timer_start
	
ENDWHILE

MAKE_PLAYER_SAFE_FOR_CUTSCENE player

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

LOAD_SPECIAL_CHARACTER 1 joey
LOAD_SPECIAL_MODEL cut_obj1 JOEDOOR
LOAD_SPECIAL_MODEL cut_obj2 JOEYH
LOAD_SPECIAL_MODEL cut_obj3 PLAYERH
LOAD_SPECIAL_MODEL cut_obj4 MISTYH
REQUEST_MODEL CAR_MAFIA
REQUEST_MODEL CAR_IDAHO
REQUEST_MODEL CAR_STALLION
REQUEST_MODEL jogarageext
REQUEST_MODEL jogarageint


WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE

CHAR_SET_IDLE script_controlled_player

IF NOT IS_CHAR_DEAD misty_lm3
	CHAR_SET_IDLE misty_lm3
ENDIF

LOAD_ALL_MODELS_NOW
	
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED CAR_IDAHO
OR NOT HAS_MODEL_LOADED CAR_MAFIA
OR NOT HAS_MODEL_LOADED CAR_STALLION

	WAIT 0

ENDWHILE
	
WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj4
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED jogarageext
OR NOT HAS_MODEL_LOADED jogarageint
	
	WAIT 0

ENDWHILE

LOAD_CUTSCENE j0_dm2

SET_CUTSCENE_OFFSET 1190.079 -869.861 13.977

CREATE_CAR CAR_MAFIA 1189.1 -858.8 14.0 cut_car_lm3

SET_CAR_HEADING cut_car_lm3 76.0

CREATE_CAR CAR_IDAHO 1182.5 -857.0 14.1 cut_car2_lm3

SET_CAR_HEADING cut_car2_lm3 291.2

CREATE_CAR CAR_STALLION 1192.9 -860.8 14.0 cut_car3_lm3

SET_CAR_HEADING cut_car3_lm3 150.0

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_joey
SET_CUTSCENE_ANIM cs_joey joey

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_misty
SET_CUTSCENE_ANIM cs_misty misty

CREATE_CUTSCENE_HEAD cs_joey CUT_OBJ2 cs_joeyhead
SET_CUTSCENE_HEAD_ANIM cs_joeyhead joey

CREATE_CUTSCENE_HEAD cs_misty CUT_OBJ4 cs_mistyhead
SET_CUTSCENE_HEAD_ANIM cs_mistyhead misty

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ3 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj1 cs_joedoor
SET_CUTSCENE_ANIM cs_joedoor JOEDOOR

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door1 FALSE

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door2 FALSE

CLEAR_AREA 1194.0 -872.5 14.0 2.0 TRUE

SET_PLAYER_COORDINATES player 1194.0 -872.5 -100.0

SET_PLAYER_HEADING player 230.0

DELETE_CHAR misty_lm3

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 10538
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_6 ) 10000 1 //"Joey..."

WHILE cs_time < 11896
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( LM3_6 )

WHILE cs_time < 14353
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_6A ) 10000 1 //"Am I goin' to play with our big end again?"

WHILE cs_time < 16869
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_7 ) 10000 1 //"I'll be with you In a minute spark plug."

WHILE cs_time < 20173
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_8 ) 10000 1 //"Hey, I'm Joey."

WHILE cs_time < 21116
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_9 ) 10000 1 //"Luigi said you were reliable so come back later,"

WHILE cs_time < 23397
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_9A ) 10000 1 //"There might be some work for you."

WHILE cs_time < 25088
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM3_9B ) 10000 1 //"Alright."

WHILE cs_time < 25723
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( LM3_9B )

WHILE cs_time < 26666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SWITCH_STREAMING ON

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door1 TRUE
SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door2 TRUE

UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ4
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_MAFIA
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_IDAHO
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STALLION
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageext
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageint

DELETE_CAR cut_car_lm3

DELETE_CAR cut_car2_lm3

DELETE_CAR cut_car3_lm3

// **********************************END OF CUT-SCENE PART TWO***********************************

} 

GOTO mission_luigi3_passed
	   		


// Mission Luigi1 failed

mission_luigi3_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN

// mission Luigi1 passed

mission_luigi3_passed:

flag_luigi_mission3_passed = 1
REGISTER_MISSION_PASSED ( LM3 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( m_pass ) 1000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 1000
CLEAR_WANTED_LEVEL player
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1191.7 -870.0 -100.0 RADAR_SPRITE_JOEY joey_contact_blip
START_NEW_SCRIPT luigi_mission4_loop
START_NEW_SCRIPT joey_mission1_loop
START_NEW_SCRIPT meat_mission1_loop
RETURN
		


// mission cleanup

mission_cleanup_luigi3:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_luigi_mission = 0
/*
IF NOT IS_CAR_DEAD car_lm3
	LOCK_CAR_DOORS car_lm3 CARLOCK_UNLOCKED
ENDIF
*/
REMOVE_CHAR_ELEGANTLY misty_lm3 
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_MAFIA
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_IDAHO
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STALLION
REMOVE_BLIP radar_blip_coord1_lm3
REMOVE_BLIP radar_blip_coord2_lm3
MISSION_HAS_FINISHED
RETURN
		


MISSION_START

// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************Luigi mission 4*********************************
// *****************************************Pump Action Pimp******************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME luigi4

// Mission Start Stuff

GOSUB mission_start_luigi4

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_luigi4_failed
	ENDIF

GOSUB mission_cleanup_luigi4

MISSION_END


// Variable for mission

VAR_INT radar_blip_ped1_lm4

VAR_INT radar_blip_coord1_lm4

VAR_INT radar_blip_car1_lm4

VAR_INT rival_pimp_to_kill

VAR_INT car_lm4

VAR_INT flag_player_got_message_luigi4

VAR_INT car_health_lm4

VAR_INT flag_car_dead_lm4

VAR_INT flag_pimp_dead_lm4

VAR_INT gun_lm4

VAR_FLOAT car_lm4_x

VAR_FLOAT car_lm4_y

VAR_FLOAT car_lm4_z

VAR_INT flag_collected_gun_lm4

VAR_INT flag_gun_message_lm4

VAR_INT flag_pimp2_dead_lm4

VAR_INT pimp_lm4

VAR_INT flag_pimp_kill_player_luigi4

VAR_INT radar_blip_ped2_lm4

VAR_INT	flag_ped1_not_in_car

VAR_INT flag_ped2_not_in_car

VAR_INT flag_player_had_shop_audio_lm4

VAR_INT flag_player_had_message1_lm4

VAR_INT flag_player_had_message2_lm4

VAR_INT flag_blokes_get_out_of_car_lm4

VAR_INT flag_car_blip_on_lm4

VAR_INT flag_done_camera_lm4

VAR_INT flag_set_car_driving_lm4

// **********************************************Mission Start******************************

mission_start_luigi4:

flag_player_on_mission = 1

flag_player_on_luigi_mission = 1

REGISTER_MISSION_GIVEN

// we dont need pathing on this mission since we're mainly following someone
DISPLAY_RADAR 2 // PATHING OFF

WAIT 0

flag_player_got_message_luigi4 = 0

car_health_lm4 = 0

flag_car_dead_lm4 = 0

flag_pimp_dead_lm4 = 0

car_lm4_x = 0.0

car_lm4_y = 0.0

car_lm4_z = 0.0

flag_collected_gun_lm4 = 0

flag_gun_message_lm4 = 0

flag_pimp2_dead_lm4 = 0

flag_pimp_kill_player_luigi4 = 0

flag_ped1_not_in_car = 0

flag_ped2_not_in_car = 0

flag_player_had_shop_audio_lm4 = 0

flag_player_had_message1_lm4 = 0

flag_player_had_message2_lm4 = 0

flag_blokes_get_out_of_car_lm4 = 0

flag_car_blip_on_lm4 = 0

flag_done_camera_lm4 = 0

flag_set_car_driving_lm4 = 0

// ***************************************START OF CUTSCENE*********************************
{
/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_luigi4_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( LM4 ) 15000 2 //"Pump Action Pimp"

SWITCH_STREAMING OFF
*/

LOAD_SPECIAL_CHARACTER 1 LUIGI

LOAD_SPECIAL_MODEL cut_obj1 LUDOOR

LOAD_SPECIAL_MODEL cut_obj2 LUIGIH

LOAD_SPECIAL_MODEL cut_obj3 PLAYERH

REQUEST_MODEL indhibuild3

REQUEST_MODEL luigiclubout

REQUEST_MODEL luigiineerclub

REQUEST_MODEL CAR_DIABLOS
REQUEST_MODEL PED_GANG_DIABLO_A
REQUEST_MODEL PED_PIMP

/*
WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE
*/

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS 926.54 -471.72 1.0 830.76 -257.96 25.0

LOAD_ALL_MODELS_NOW
	
// Cutscene stuff

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3

	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED indhibuild3
OR NOT HAS_MODEL_LOADED luigiclubout
OR NOT HAS_MODEL_LOADED luigiineerclub
OR NOT HAS_MODEL_LOADED CAR_DIABLOS
OR NOT HAS_MODEL_LOADED PED_GANG_DIABLO_A
OR NOT HAS_MODEL_LOADED PED_PIMP

	WAIT 0
	
ENDWHILE  

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor FALSE	

LOAD_CUTSCENE l4_pap

SET_CUTSCENE_OFFSET 900.782 -427.523 13.829

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_luigi

SET_CUTSCENE_ANIM cs_luigi luigi

CREATE_CUTSCENE_HEAD cs_luigi CUT_OBJ2 cs_luigihead

SET_CUTSCENE_HEAD_ANIM cs_luigihead luigi

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ3 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj1 cs_ludoor

SET_CUTSCENE_ANIM cs_ludoor LUDOOR

//CLEAR_AREA 902.2 -425.8 13.9 1.0 TRUE
//SET_PLAYER_COORDINATES player 902.2 -425.8 13.9

CLEAR_AREA 896.6 -426.2 13.9 1.0 TRUE
SET_PLAYER_COORDINATES player 896.6 -426.2 13.9

SET_PLAYER_HEADING player 270.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 8775
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM4_A ) 10000 1 //"Some Diablo skumball has been pimping his skuzzy bitches in my backyard."

WHILE cs_time < 12872
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM4_B ) 10000 1 //"Go and take care of things for me."

WHILE cs_time < 14886
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM4_C ) 10000 1  // If you need a piece, go around back of AmmuNation opposite the subway.

WHILE cs_time < 18506
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( LM4_C )  // If you need a piece, go around back of AmmuNation opposite the subway.

WHILE cs_time < 19333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SWITCH_STREAMING ON

LOAD_SCENE 920.3 -425.4 15.0

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE

UNLOAD_SPECIAL_CHARACTER 1

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3

MARK_MODEL_AS_NO_LONGER_NEEDED indhibuild3

MARK_MODEL_AS_NO_LONGER_NEEDED luigiclubout

MARK_MODEL_AS_NO_LONGER_NEEDED luigiineerclub

SET_PED_DENSITY_MULTIPLIER 1.0

// ******************************************END OF CUT_SCENE*******************************

REQUEST_MODEL CAR_DIABLOS
REQUEST_MODEL PED_GANG_DIABLO_A
REQUEST_MODEL PED_PIMP

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED CAR_DIABLOS
OR NOT HAS_MODEL_LOADED PED_GANG_DIABLO_A
OR NOT HAS_MODEL_LOADED PED_PIMP
 
	WAIT 0

ENDWHILE

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

SET_POLICE_IGNORE_PLAYER player ON

SET_EVERYONE_IGNORE_PLAYER player ON

CREATE_CAR CAR_DIABLOS 1058.5 -421.0 -100.0 car_lm4

LOCK_CAR_DOORS car_lm4 CARLOCK_LOCKOUT_PLAYER_ONLY

SET_CAR_HEADING car_lm4 360.0

SET_CAR_ONLY_DAMAGED_BY_PLAYER car_lm4 TRUE

SET_CAR_WATERTIGHT car_lm4 TRUE 

CREATE_CHAR_INSIDE_CAR car_lm4 PEDTYPE_CIVMALE PED_GANG_DIABLO_A rival_pimp_to_kill

CLEAR_CHAR_THREAT_SEARCH rival_pimp_to_kill

GIVE_WEAPON_TO_CHAR rival_pimp_to_kill WEAPONTYPE_UZI 30000  // sets weapon to infinate ammo

CREATE_CHAR_AS_PASSENGER car_lm4 PEDTYPE_CIVMALE PED_PIMP 0 pimp_lm4

CLEAR_CHAR_THREAT_SEARCH pimp_lm4

GIVE_WEAPON_TO_CHAR pimp_lm4 WEAPONTYPE_SHOTGUN 30000  // sets weapon to infinate ammo

SET_CAR_MISSION car_lm4 MISSION_STOP_FOREVER

ADD_BLIP_FOR_CAR car_lm4 radar_blip_car1_lm4

flag_car_blip_on_lm4 = 1

LOAD_SCENE 1065.1 -398.6 14.97

SET_FIXED_CAMERA_POSITION 1048.1 -398.3 15.5 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 1049.1 -398.3 15.5 JUMP_CUT

CREATE_PICKUP_WITH_AMMO WEAPON_COLT45 pickup_once 45 1080.5 -396.0 14.5 gun_lm4

ADD_SPRITE_BLIP_FOR_PICKUP gun_lm4 RADAR_SPRITE_WEAPON radar_blip_coord1_lm4


timerb = 0

WHILE timerb < 8400

	WAIT 0

	
	IF flag_set_car_driving_lm4 = 0
		
		IF timerb >= 2000
					
			IF NOT IS_CAR_DEAD car_lm4
				SET_CAR_MISSION car_lm4 MISSION_CRUISE
				SET_CAR_CRUISE_SPEED car_lm4 20.0
				flag_set_car_driving_lm4 = 1
			ENDIF

		ENDIF

	ENDIF

	IF flag_done_camera_lm4 = 0

		IF NOT IS_CAR_DEAD car_lm4

			IF LOCATE_CAR_2D car_lm4 1058.5 -398.5 6.0 6.0 FALSE
				POINT_CAMERA_AT_POINT 1048.6 -397.4 15.5 INTERPOLATION
				flag_done_camera_lm4 = 1
			ENDIF

		ENDIF

	ENDIF

	GOSUB car_check_lm4

	GOSUB ped_death_check_lm4
	
	GOSUB help_text_check_lm4
		
	IF flag_collected_gun_lm4 = 0
	 
		IF HAS_PICKUP_BEEN_COLLECTED gun_lm4
		 	REMOVE_BLIP radar_blip_coord1_lm4
			flag_collected_gun_lm4 = 1
		ENDIF

			
		IF flag_player_had_shop_audio_lm4 = 0
	
			IF IS_PLAYER_IN_AREA_3D player 1066.6 -403.5 14.0 1072.8 -394.0 18.0 FALSE

				IF camera_ammu1 = 1

					GOSUB audio_load_lm4

				ENDIF
		
			ENDIF
		
		ENDIF
		
	ENDIF   
	
	
	IF flag_ped2_not_in_car = 1
	AND flag_ped1_not_in_car = 1
		IF flag_car_blip_on_lm4 = 1
			REMOVE_BLIP radar_blip_car1_lm4
			flag_car_blip_on_lm4 = 0
		ENDIF
	ENDIF		 	
			 

ENDWHILE

LOAD_SCENE 920.3 -425.4 15.0

RESTORE_CAMERA_JUMPCUT

SWITCH_WIDESCREEN OFF

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

SET_EVERYONE_IGNORE_PLAYER player OFF

PRINT_HELP ( HELP4X )  // "Press and hold ::SPRINT:: to sprint."


WHILE flag_pimp_dead_lm4 = 0
OR flag_pimp2_dead_lm4 = 0

	WAIT 0

	GOSUB car_check_lm4

	GOSUB ped_death_check_lm4
	
	GOSUB help_text_check_lm4 
	
	IF flag_collected_gun_lm4 = 0
	 
		IF HAS_PICKUP_BEEN_COLLECTED gun_lm4
		 	REMOVE_BLIP radar_blip_coord1_lm4
			flag_collected_gun_lm4 = 1
		ENDIF

			
		IF flag_player_had_shop_audio_lm4 = 0
	
			IF IS_PLAYER_IN_AREA_3D player 1066.6 -403.5 14.0 1072.8 -394.0 18.0 FALSE
				GOSUB audio_load_lm4
			ENDIF
		
		ENDIF
		
	ENDIF   
		
	IF flag_ped2_not_in_car = 1
	AND flag_ped1_not_in_car = 1
		IF flag_car_blip_on_lm4 = 1
			REMOVE_BLIP radar_blip_car1_lm4
			flag_car_blip_on_lm4 = 0
		ENDIF
	ENDIF		 	
							   	   							   	 		 		   	   
ENDWHILE

REMOVE_BLIP radar_blip_coord1_lm4

//timera = 0

//WHILE timera < 3000

//	WAIT 0

//ENDWHILE
		
GOTO mission_luigi4_passed
	   		

// Mission Luigi1 failed

mission_luigi4_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

IF NOT IS_CHAR_DEAD rival_pimp_to_kill
	REMOVE_CHAR_ELEGANTLY rival_pimp_to_kill
ENDIF

IF IS_CHAR_DEAD pimp_lm4 
	REMOVE_CHAR_ELEGANTLY pimp_lm4
ENDIF

RETURN

		
// mission Luigi1 passed

mission_luigi4_passed:

flag_luigi_mission4_passed = 1
REGISTER_MISSION_PASSED ( LM4 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( m_pass ) 4000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 4000
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT luigi_mission5_loop

IF out_of_stock_pistol = 0
	START_NEW_SCRIPT pistol_message
ENDIF

RETURN
		


// mission cleanup

mission_cleanup_luigi4:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_luigi_mission = 0
special_ammu_audio = 0

IF flag_car_dead_lm4 = 0

	IF NOT IS_CAR_DEAD car_lm4
		SET_CAR_ONLY_DAMAGED_BY_PLAYER car_lm4 FALSE
		LOCK_CAR_DOORS car_lm4 CARLOCK_UNLOCKED
		SET_CAR_WATERTIGHT car_lm4 FALSE
	ENDIF

ENDIF

REMOVE_PICKUP gun_lm4
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_DIABLOS
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_DIABLO_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_PIMP
IF flag_collected_gun_lm4 = 0
	REMOVE_PICKUP gun_lm4 
ENDIF
GOSUB shite_complier_bit
MISSION_HAS_FINISHED
RETURN


// *************************PED GOSUB HAS TO GO HERE FOR STUPID COMPILER********************

ped_death_check_lm4:

// Checks for the Diablo

	IF flag_pimp_dead_lm4 = 0

		IF NOT IS_CHAR_DEAD rival_pimp_to_kill

			IF flag_blokes_get_out_of_car_lm4 = 1
			OR NOT IS_CHAR_IN_CAR rival_pimp_to_kill car_lm4
					
				IF flag_player_got_message_luigi4 = 0
	 				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS rival_pimp_to_kill player
					SET_CHAR_THREAT_SEARCH rival_pimp_to_kill THREAT_PLAYER1
					SET_CHAR_PERSONALITY rival_pimp_to_kill PEDSTAT_TOUGH_GUY
					flag_player_got_message_luigi4 = 1
				ENDIF

			ENDIF

			IF flag_ped1_not_in_car = 0

				IF NOT IS_CHAR_IN_CAR rival_pimp_to_kill car_lm4
					ADD_BLIP_FOR_CHAR rival_pimp_to_kill radar_blip_ped1_lm4
					flag_ped1_not_in_car = 1
				ENDIF
						
			ENDIF
						
		ENDIF

		IF IS_CHAR_DEAD rival_pimp_to_kill 
			REMOVE_BLIP radar_blip_ped1_lm4
			flag_pimp_dead_lm4 = 1
		ENDIF

	ENDIF
  
// Checks for the pimp model
	
	IF flag_pimp2_dead_lm4 = 0
	
		IF NOT IS_CHAR_DEAD pimp_lm4

			IF flag_blokes_get_out_of_car_lm4 = 1
			OR NOT IS_CHAR_IN_CAR pimp_lm4 car_lm4
					
				IF flag_pimp_kill_player_luigi4 = 0
	 				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS pimp_lm4 player
					SET_CHAR_THREAT_SEARCH pimp_lm4 THREAT_PLAYER1
					SET_CHAR_PERSONALITY pimp_lm4 PEDSTAT_TOUGH_GUY
					flag_pimp_kill_player_luigi4 = 1
				ENDIF

			ENDIF

			IF flag_ped2_not_in_car = 0
					
				IF NOT IS_CHAR_IN_CAR pimp_lm4 car_lm4
					ADD_BLIP_FOR_CHAR pimp_lm4 radar_blip_ped2_lm4
					flag_ped2_not_in_car = 1
				ENDIF

			ENDIF
						
		ENDIF

		IF IS_CHAR_DEAD pimp_lm4
			REMOVE_BLIP radar_blip_ped2_lm4
		 	flag_pimp2_dead_lm4 = 1
		ENDIF
					   
	ENDIF

RETURN


// **************************************************END OF PED GOSUB******************************

audio_load_lm4:

 IF IS_PLAYER_IN_AREA_3D player 1066.6 -403.5 14.0 1072.8 -394.0 18.0 FALSE

	special_ammu_audio = 1

	IF camera_ammu1 = 1

 		IF NOT IS_CHAR_DEAD ammu_shop_bloke1
				
			IF flag_player_had_message1_lm4 = 0
				LOAD_MISSION_AUDIO AMMU_A
				flag_player_had_message1_lm4 = 1
			ENDIF

			IF flag_player_had_message1_lm4 = 1 
		 		
 	   			IF HAS_MISSION_AUDIO_LOADED
		  			PLAY_MISSION_AUDIO
 					PRINT_NOW ( AMMU_A ) 5000 1 //"Luigi said..."
					flag_player_had_message1_lm4 = 2
	   			ENDIF

			ENDIF

			IF flag_player_had_message1_lm4 = 2
			 			
 				IF HAS_MISSION_AUDIO_FINISHED
 					CLEAR_THIS_PRINT ( AMMU_A )
					flag_player_had_message1_lm4 = 3
				ENDIF

			ENDIF
		
			IF flag_player_had_message1_lm4 = 3
			AND flag_player_had_message2_lm4  = 0 
				LOAD_MISSION_AUDIO AMMU_C
				flag_player_had_message2_lm4 = 1
			ENDIF

			IF flag_player_had_message2_lm4  = 1
 		
 				IF HAS_MISSION_AUDIO_LOADED
 		 			PLAY_MISSION_AUDIO
 					PRINT_NOW ( AMMU_C ) 5000 1 //"Go round the back..."	
 					flag_player_had_message2_lm4  = 2		
				ENDIF

 			ENDIF

			IF flag_player_had_message2_lm4  = 2
 			 			
 				IF HAS_MISSION_AUDIO_FINISHED
 					CLEAR_THIS_PRINT ( AMMU_C )
 					flag_player_had_shop_audio_lm4 = 1
					special_ammu_audio = 0
					flag_player_had_message2_lm4  = 3
 				ENDIF
 	   			
			ENDIF

		ELSE
			CLEAR_MISSION_AUDIO
			special_ammu_audio = 0
		ENDIF

	ENDIF

ELSE
	CLEAR_MISSION_AUDIO
	special_ammu_audio = 0
ENDIF

RETURN


car_check_lm4:

	IF flag_car_dead_lm4 = 0
		
		IF IS_CAR_DEAD car_lm4

			IF flag_car_blip_on_lm4 = 1
				REMOVE_BLIP radar_blip_car1_lm4
				flag_car_blip_on_lm4 = 0
			ENDIF

			flag_car_dead_lm4 = 1
		ELSE

			IF IS_CAR_IN_WATER car_lm4
						
				IF IS_CAR_ON_SCREEN car_lm4
					SET_CAR_WATERTIGHT car_lm4 FALSE
					
				ELSE
					GET_CAR_COORDINATES car_lm4 car_lm4_x car_lm4_y car_lm4_z
					GET_CLOSEST_CAR_NODE car_lm4_x car_lm4_y car_lm4_z car_lm4_x car_lm4_y car_lm4_z
				ENDIF

				IF NOT IS_POINT_ON_SCREEN car_lm4_x car_lm4_y car_lm4_z 5.0
					SET_CAR_COORDINATES car_lm4 car_lm4_x car_lm4_y car_lm4_z
				ENDIF
									
			ENDIF
			
			GET_CAR_HEALTH car_lm4 car_health_lm4
									
			IF car_health_lm4 < 999
				flag_blokes_get_out_of_car_lm4 = 1
			ELSE
				flag_blokes_get_out_of_car_lm4 = 0
			ENDIF

		ENDIF

	ENDIF
	
RETURN


help_text_check_lm4:

IF flag_player_had_gun_message = 0

		IF IS_PLAYER_IN_AREA_ON_FOOT_3D player 1075.2 -384.8 14.0 1086.2 -403.3 17.0 FALSE
		
			IF flag_gun_message_lm4 = 0 
				PRINT_HELP ( GUN_1A ) //"Use R2 and L2 to cycle through your weapons."
				timerb = 0
				flag_gun_message_lm4 = 1
			ENDIF

			IF flag_gun_message_lm4 = 1

				IF timerb > 10000
					
					//WDTOM this is not accurate at all any more...
					//PRINT_HELP ( GUN_2A ) //"Hold R1 to auto-target, press circle to fire!"
					
					timerb = 0
					flag_gun_message_lm4 = 2
				ENDIF

			ENDIF

			IF flag_gun_message_lm4 = 2

				IF timerb > 10000
					PRINT_HELP ( GUN_3A ) //"While holding the ~h~R1 button,~w~ press the ~h~L2 button~w~ or the ~h~R2 button to switch target."
					timerb = 0
					flag_gun_message_lm4 = 3
				ENDIF

			ENDIF

			IF flag_gun_message_lm4 = 3

				IF timerb > 10000
					PRINT_HELP ( GUN_4A ) //"While holding the ~h~R1 button~w~ you can walk or run while remaining locked onto a target."
					timerb = 0
					flag_gun_message_lm4 = 4
				ENDIF

			ENDIF

			IF flag_gun_message_lm4 = 4

				IF timerb > 10000
					PRINT_HELP ( GUN_5 ) //"You can practice targeting and shooting on these paper targets, when you are finished resume the mission."
					flag_gun_message_lm4 = 5
					flag_player_had_gun_message = 1
				ENDIF

			ENDIF
            
		ENDIF

	ENDIF

RETURN


shite_complier_bit:

REMOVE_BLIP radar_blip_ped1_lm4
REMOVE_BLIP radar_blip_ped2_lm4
REMOVE_BLIP radar_blip_coord1_lm4
REMOVE_BLIP radar_blip_car1_lm4

RETURN

}
MISSION_START

// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************Luigi mission 5********************************* 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME luigi5

// Mission Start Stuff

GOSUB mission_start_luigi5

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_luigi5_failed
	ENDIF

GOSUB mission_cleanup_luigi5

MISSION_END

// Vehicles for mission

VAR_INT vehicle_lm5

// radar_blips

VAR_INT flag_blip_on_prossie1_lm5

VAR_INT flag_blip_on_prossie2_lm5

VAR_INT flag_blip_on_prossie3_lm5

VAR_INT flag_blip_on_prossie4_lm5

VAR_INT flag_blip_on_prossie5_lm5

VAR_INT flag_blip_on_prossie6_lm5

VAR_INT flag_blip_on_prossie7_lm5

VAR_INT flag_blip_on_prossie8_lm5


VAR_INT radar_blip_coord1_lm5  //location of the fuzz ball

VAR_INT radarped_prossie1_lm5 //blip for real char

VAR_INT	radarped_prossie2_lm5 //blip for real char

VAR_INT radarped_prossie3_lm5 //blip for real char

VAR_INT	radarped_prossie4_lm5 //blip for real char

VAR_INT radarped_prossie5_lm5 //blip for real char

VAR_INT	radarped_prossie6_lm5 //blip for real char

VAR_INT radarped_prossie7_lm5 //blip for real char

VAR_INT	radarped_prossie8_lm5 //blip for real char

// timers

VAR_INT timer_lm5

// Characters for mission

VAR_INT prossie1_lm5

VAR_INT prossie2_lm5

VAR_INT prossie3_lm5

VAR_INT prossie4_lm5

VAR_INT prossie5_lm5

VAR_INT prossie6_lm5

VAR_INT prossie7_lm5

VAR_INT prossie8_lm5


//Character created and at ball flags

VAR_INT flag_prossie1_at_ball

VAR_INT flag_prossie2_at_ball

VAR_INT flag_prossie3_at_ball

VAR_INT flag_prossie4_at_ball

VAR_INT flag_prossie5_at_ball

VAR_INT flag_prossie6_at_ball

VAR_INT flag_prossie7_at_ball

VAR_INT flag_prossie8_at_ball


// girls in car flag

VAR_INT flag_prossie1_lm5_in_car

VAR_INT flag_prossie2_lm5_in_car

VAR_INT flag_prossie3_lm5_in_car

VAR_INT flag_prossie4_lm5_in_car

VAR_INT flag_prossie5_lm5_in_car

VAR_INT flag_prossie6_lm5_in_car

VAR_INT flag_prossie7_lm5_in_car

VAR_INT flag_prossie8_lm5_in_car

VAR_INT flag_prossie8_blip_set

// no of passenger stuff

VAR_INT max_no_of_passengers_lm5

VAR_INT room_left_in_car_lm5

VAR_INT no_of_passengers_lm5

VAR_INT flag_had_room_message_lm5


// Scoreing stuff

VAR_INT counter_no_of_girls_at_the_ball

VAR_INT score_lm5


// PEds in to the building stuff

VAR_INT flag_prossie2_in_car_park
		
VAR_INT flag_prossie2_told_to_go_into_ball

VAR_INT flag_prossie1_in_car_park
		
VAR_INT flag_prossie1_told_to_go_into_ball

VAR_INT flag_prossie3_in_car_park
		
VAR_INT flag_prossie3_told_to_go_into_ball

VAR_INT flag_prossie4_in_car_park
		
VAR_INT flag_prossie4_told_to_go_into_ball

VAR_INT flag_prossie5_in_car_park
		
VAR_INT flag_prossie5_told_to_go_into_ball

VAR_INT flag_prossie6_in_car_park
		
VAR_INT flag_prossie6_told_to_go_into_ball

VAR_INT flag_prossie7_in_car_park
		
VAR_INT flag_prossie7_told_to_go_into_ball

VAR_INT flag_prossie8_in_car_park
		
VAR_INT flag_prossie8_told_to_go_into_ball

VAR_INT fuzzball_sign

VAR_INT number_of_dead_prossies

VAR_INT ball_sounds

// Door Stuff

VAR_INT flag_moved_door1_lm5

VAR_INT flag_moved_door2_lm5

// Message from girl to tell player to get a car

VAR_INT flag_had_car_message1_lm5

VAR_INT flag_had_car_message2_lm5

VAR_INT flag_had_car_message3_lm5

VAR_INT flag_had_car_message4_lm5

VAR_INT flag_had_car_message5_lm5

VAR_INT flag_had_car_message6_lm5

VAR_INT flag_had_car_message7_lm5

VAR_INT flag_had_car_message8_lm5

VAR_INT sphere_lm5

VAR_INT cop_car1_lm5

VAR_INT cop_car2_lm5

VAR_INT counter_girls_trying_to_get_to_ball

VAR_INT flag_timer_prossie1_lm5 // If the girls get stuck

VAR_INT flag_timer_prossie2_lm5 // If the girls get stuck

VAR_INT flag_timer_prossie3_lm5 // If the girls get stuck

VAR_INT flag_timer_prossie4_lm5	// If the girls get stuck

VAR_INT flag_timer_prossie5_lm5 // If the girls get stuck

VAR_INT flag_timer_prossie6_lm5 // If the girls get stuck

VAR_INT flag_timer_prossie7_lm5	// If the girls get stuck

VAR_INT flag_timer_prossie8_lm5	// If the girls get stuck


// ******************************************Mission Start**********************************

mission_start_luigi5:

flag_player_on_mission = 1

flag_player_on_luigi_mission = 1

REGISTER_MISSION_GIVEN

DISPLAY_RADAR 4 // HACKED RADAR STOP AT STREET

WAIT 0

flag_prossie8_blip_set = 0

max_no_of_passengers_lm5 = 0

flag_prossie1_at_ball = 0

flag_prossie2_at_ball = 0

flag_prossie3_at_ball = 0

flag_prossie4_at_ball = 0

flag_prossie5_at_ball = 0

flag_prossie6_at_ball = 0

flag_prossie7_at_ball = 0

flag_prossie8_at_ball = 0

room_left_in_car_lm5 = 0

no_of_passengers_lm5 = 0

flag_had_room_message_lm5 = 0

counter_no_of_girls_at_the_ball = 0

score_lm5 = 0

flag_prossie2_in_car_park = 0
		
flag_prossie2_told_to_go_into_ball = 0

flag_prossie1_in_car_park = 0

flag_prossie1_told_to_go_into_ball = 0

timer_lm5 = 301000  // 5 mins

flag_blip_on_prossie1_lm5 = 0

flag_blip_on_prossie2_lm5 = 0

flag_blip_on_prossie3_lm5 = 0

flag_blip_on_prossie4_lm5 = 0

flag_blip_on_prossie5_lm5 = 0

flag_blip_on_prossie6_lm5 = 0

flag_blip_on_prossie7_lm5 = 0

flag_blip_on_prossie8_lm5 = 0

flag_prossie1_lm5_in_car = 0

flag_prossie2_lm5_in_car = 0

flag_prossie3_lm5_in_car = 0

flag_prossie4_lm5_in_car = 0

flag_prossie5_lm5_in_car = 0

flag_prossie6_lm5_in_car = 0

flag_prossie7_lm5_in_car = 0

flag_prossie8_lm5_in_car = 0

flag_prossie3_in_car_park = 0

flag_prossie3_told_to_go_into_ball = 0

flag_prossie4_in_car_park = 0

flag_prossie4_told_to_go_into_ball = 0

flag_prossie5_in_car_park = 0

flag_prossie5_told_to_go_into_ball = 0

flag_prossie6_in_car_park = 0

flag_prossie6_told_to_go_into_ball = 0

flag_prossie7_in_car_park = 0

flag_prossie7_told_to_go_into_ball = 0

flag_prossie8_in_car_park = 0

flag_prossie8_told_to_go_into_ball = 0

number_of_dead_prossies = 0

flag_moved_door1_lm5 = 0

flag_moved_door2_lm5 = 0

flag_had_car_message1_lm5 = 0

flag_had_car_message2_lm5 = 0

flag_had_car_message3_lm5 = 0

flag_had_car_message4_lm5 = 0

flag_had_car_message5_lm5 = 0

flag_had_car_message6_lm5 = 0

flag_had_car_message7_lm5 = 0

flag_had_car_message8_lm5 = 0

counter_girls_trying_to_get_to_ball = 0

flag_timer_prossie1_lm5 = 0  // If the girls get stuck

flag_timer_prossie2_lm5 = 0 // If the girls get stuck

flag_timer_prossie3_lm5 = 0 // If the girls get stuck

flag_timer_prossie4_lm5 = 0	// If the girls get stuck

flag_timer_prossie5_lm5 = 0 // If the girls get stuck

flag_timer_prossie6_lm5 = 0 // If the girls get stuck

flag_timer_prossie7_lm5 = 0	// If the girls get stuck

flag_timer_prossie8_lm5 = 0	// If the girls get stuck


// *****************************************START OF CUTSCENE*******************************
{

/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_luigi5_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( LM5 ) 15000 2 //"Fuzz Ball"

SWITCH_STREAMING OFF
*/

LOAD_SPECIAL_CHARACTER 1 LUIGI
LOAD_SPECIAL_CHARACTER 2 MICKY

LOAD_SPECIAL_MODEL cut_obj1 LUDOOR
LOAD_SPECIAL_MODEL cut_obj2 LUIGIH
LOAD_SPECIAL_MODEL cut_obj3 PLAYERH
LOAD_SPECIAL_MODEL cut_obj4 MICKYH
REQUEST_MODEL indhibuild3
REQUEST_MODEL luigiclubout
REQUEST_MODEL luigiineerclub

/*
WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE
*/

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS 926.54 -471.72 1.0 830.76 -257.96 25.0

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj4

	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED indhibuild3
OR NOT HAS_MODEL_LOADED luigiclubout
OR NOT HAS_MODEL_LOADED	luigiineerclub

	WAIT 0

ENDWHILE

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor FALSE	

LOAD_CUTSCENE l5_tfb

SET_CUTSCENE_OFFSET 900.782 -427.523 13.829

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_luigi

SET_CUTSCENE_ANIM cs_luigi luigi

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_micky

SET_CUTSCENE_ANIM cs_micky micky

CREATE_CUTSCENE_HEAD cs_luigi CUT_OBJ2 cs_luigihead

SET_CUTSCENE_HEAD_ANIM cs_luigihead luigi

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ3 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_micky CUT_OBJ4 cs_mickyhead

SET_CUTSCENE_HEAD_ANIM cs_mickyhead micky

CREATE_CUTSCENE_OBJECT cut_obj1 cs_ludoor

SET_CUTSCENE_ANIM cs_ludoor LUDOOR

//CLEAR_AREA 902.2 -425.8 13.9 1.0 TRUE
//SET_PLAYER_COORDINATES player 902.2 -425.8 13.9

CLEAR_AREA 896.6 -426.2 13.9 1.0 TRUE
SET_PLAYER_COORDINATES player 896.6 -426.2 13.9

SET_PLAYER_HEADING player 270.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 11950
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM5_A ) 10000 1 //"The Policeman's Ball is being held at the old school hall near the Callahan Bridge"

WHILE cs_time < 15702
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM5_B ) 10000 1 //"and they'll be looking for some "old school action."

WHILE cs_time < 17617
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM5_C ) 10000 1 //"Now I got girls all over town walking the streets."

WHILE cs_time < 20281
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM5_D ) 10000 1 //"Get 'em to the ball they'll make a bundle"

WHILE cs_time < 22295
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LM5_E ) 10000 1 //"Get as many of them there as you can before those cops have drunk away their green."

WHILE cs_time < 25606
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( LM5_E )

WHILE cs_time < 26000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SWITCH_STREAMING ON

LOAD_SCENE 920.3 -425.4 15.0

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE

UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ4

MARK_MODEL_AS_NO_LONGER_NEEDED indhibuild3

MARK_MODEL_AS_NO_LONGER_NEEDED luigiclubout

MARK_MODEL_AS_NO_LONGER_NEEDED luigiineerclub

SET_PED_DENSITY_MULTIPLIER 1.0

// *****************************************END OF CUTSCENE*********************************
SWITCH_CAR_GENERATOR gen_car28 0

ADD_SPHERE 999.9 -879.3 14.0 4.0 sphere_lm5

REQUEST_MODEL PED_PROSTITUTE

REQUEST_MODEL PED_PROSTITUTE2

WHILE NOT HAS_MODEL_LOADED PED_PROSTITUTE
OR NOT HAS_MODEL_LOADED PED_PROSTITUTE2
 
	WAIT 0

ENDWHILE

WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE

CREATE_CAR CAR_POLICE 1027.7 -873.1 13.9 cop_car1_lm5

SET_CAR_HEADING cop_car1_lm5 90.0

LOCK_CAR_DOORS cop_car1_lm5 CARLOCK_UNLOCKED

CREATE_CAR CAR_POLICE 998.68 -860.80 14.5 cop_car2_lm5

SET_CAR_HEADING cop_car2_lm5 90.0

LOCK_CAR_DOORS cop_car2_lm5 CARLOCK_UNLOCKED

CREATE_OBJECT_NO_OFFSET policeballsigns 1010.74 -896.46 24.161 fuzzball_sign

ADD_CONTINUOUS_SOUND 999.9 -892.4 16.0 SOUND_POLICE_BALL_LOOP_L ball_sounds

SET_OBJECT_HEADING fuzz_door1 270.0

SET_OBJECT_HEADING fuzz_door2 270.0 

DISPLAY_ONSCREEN_TIMER timer_lm5

//ADD_BLIP_FOR_COORD 999.9 -879.3 -100.0 radar_blip_coord1_lm5

// creates prossie 1

CREATE_CHAR PEDTYPE_PROSTITUTE PED_PROSTITUTE2 870.0 -482.0 -100.0 prossie1_lm5

SET_CHAR_HEADING prossie1_lm5 180.0

CLEAR_CHAR_THREAT_SEARCH prossie1_lm5

ADD_BLIP_FOR_CHAR prossie1_lm5 radarped_prossie1_lm5

flag_blip_on_prossie1_lm5 = 1

SET_CHAR_RUNNING prossie1_lm5 TRUE


// creates prossie 2

CREATE_CHAR PEDTYPE_PROSTITUTE PED_PROSTITUTE 916.0 -90.0 -100.0 prossie2_lm5

SET_CHAR_HEADING prossie2_lm5 180.0 
		
CLEAR_CHAR_THREAT_SEARCH prossie2_lm5

ADD_BLIP_FOR_CHAR prossie2_lm5 radarped_prossie2_lm5

flag_blip_on_prossie2_lm5 = 1

SET_CHAR_RUNNING prossie2_lm5 TRUE

// creates prossie 3

CREATE_CHAR PEDTYPE_PROSTITUTE PED_PROSTITUTE2 1203.0 23.0 -100.0 prossie3_lm5

CLEAR_CHAR_THREAT_SEARCH prossie3_lm5

ADD_BLIP_FOR_CHAR prossie3_lm5 radarped_prossie3_lm5

flag_blip_on_prossie3_lm5 = 1

SET_CHAR_RUNNING prossie3_lm5 TRUE

// creates prossie 4

CREATE_CHAR PEDTYPE_PROSTITUTE PED_PROSTITUTE 1240.0 -336.0 -100.0 prossie4_lm5

SET_CHAR_HEADING prossie4_lm5 180.0 

CLEAR_CHAR_THREAT_SEARCH prossie4_lm5

ADD_BLIP_FOR_CHAR prossie4_lm5 radarped_prossie4_lm5

flag_blip_on_prossie4_lm5 = 1

SET_CHAR_RUNNING prossie4_lm5 TRUE

// creates prossie 5

CREATE_CHAR PEDTYPE_PROSTITUTE PED_PROSTITUTE2 1231.0 -511.0 -100.0 prossie5_lm5

CLEAR_CHAR_THREAT_SEARCH prossie5_lm5

ADD_BLIP_FOR_CHAR prossie5_lm5 radarped_prossie5_lm5

flag_blip_on_prossie5_lm5 = 1

SET_CHAR_RUNNING prossie5_lm5 TRUE

// creates prossie 6

CREATE_CHAR PEDTYPE_PROSTITUTE PED_PROSTITUTE 1360.0 -798.0 -100.0 prossie6_lm5

CLEAR_CHAR_THREAT_SEARCH prossie6_lm5

ADD_BLIP_FOR_CHAR prossie6_lm5 radarped_prossie6_lm5

flag_blip_on_prossie6_lm5 = 1

SET_CHAR_RUNNING prossie6_lm5 TRUE

// creates prossie 7

CREATE_CHAR PEDTYPE_PROSTITUTE PED_PROSTITUTE2 1093.0 -973.0 -100.0 prossie7_lm5

CLEAR_CHAR_THREAT_SEARCH prossie7_lm5

ADD_BLIP_FOR_CHAR prossie7_lm5 radarped_prossie7_lm5

flag_blip_on_prossie7_lm5 = 1

SET_CHAR_RUNNING prossie7_lm5 TRUE

// creates prossie 8

CREATE_CHAR PEDTYPE_PROSTITUTE PED_PROSTITUTE 975.0 -754.0 -100.0 prossie8_lm5

SET_CHAR_HEADING prossie8_lm5 180.0

CLEAR_CHAR_THREAT_SEARCH prossie8_lm5

ADD_BLIP_FOR_CHAR prossie8_lm5 radarped_prossie8_lm5

flag_blip_on_prossie8_lm5 = 1

SET_CHAR_RUNNING prossie8_lm5 TRUE

IF timer_help_message_displayed = 0
	PRINT_HELP ( TIMER ) //"This is a timed mission, you must complete it before the timer runs out."
	timer_help_message_displayed = 1
ENDIF

PRINT_NOW ( LM5_7 ) 7000 1 //"You need to get a minimum of four girls to the ball!"

DISPLAY_ONSCREEN_COUNTER_WITH_STRING counter_no_of_girls_at_the_ball COUNTER_DISPLAY_NUMBER ( LM5_9 )

// checking to see how many girls the player get to the ball

prossie_checks:

WHILE timer_lm5 > 0
		
	WAIT 0

	CLEAR_AREA 1000.4 -886.7 14.4 6.0 FALSE // This should clear the area

	GOSUB check_for_dead_prossies

	IF number_of_dead_prossies > 0
		PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
		GOTO mission_luigi5_failed
	ENDIF
		
	IF counter_no_of_girls_at_the_ball = 8
		GOTO mission_luigi5_passed
	ENDIF
	
	IF IS_PLAYER_IN_ANY_CAR player
		STORE_CAR_PLAYER_IS_IN player vehicle_lm5
		GET_MAXIMUM_NUMBER_OF_PASSENGERS vehicle_lm5 max_no_of_passengers_lm5
		GET_NUMBER_OF_PASSENGERS vehicle_lm5 no_of_passengers_lm5 

		IF no_of_passengers_lm5 > 0
		AND flag_prossie8_blip_set = 0
			flag_prossie8_blip_set = 1
			ADD_BLIP_FOR_COORD 999.9 -879.3 -100.0 radar_blip_coord1_lm5
		ELSE
			IF no_of_passengers_lm5 = 0
				flag_prossie8_blip_set = 0
				REMOVE_BLIP radar_blip_coord1_lm5
			ENDIF
		ENDIF
	ENDIF

	room_left_in_car_lm5 = max_no_of_passengers_lm5 - no_of_passengers_lm5
		
//starts checking for prossie1
		
IF flag_prossie1_at_ball = 0
		   
	IF flag_prossie1_lm5_in_car = 0

		IF LOCATE_PLAYER_ON_FOOT_CHAR_3D player prossie1_lm5 8.0 8.0 2.0 FALSE
		AND flag_had_car_message1_lm5 = 0
			PRINT_NOW ( LM5_3 ) 5000 1 //"You need a car!"
			flag_had_car_message1_lm5 = 1
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player prossie1_lm5 8.0 8.0 2.0 FALSE
			flag_had_car_message1_lm5 = 0
		ENDIF
		
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player prossie1_lm5 8.0 8.0 2.0 FALSE

			IF flag_prossie1_lm5_in_car = 0
				TURN_CHAR_TO_FACE_PLAYER prossie1_lm5 player
			ENDIF
			
			IF IS_PLAYER_STOPPED player

				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player vehicle_lm5
					GET_MAXIMUM_NUMBER_OF_PASSENGERS vehicle_lm5 max_no_of_passengers_lm5
					GET_NUMBER_OF_PASSENGERS vehicle_lm5 no_of_passengers_lm5
					room_left_in_car_lm5 = max_no_of_passengers_lm5 - no_of_passengers_lm5 
				ENDIF

				IF room_left_in_car_lm5 > 0
									
					SET_PLAYER_AS_LEADER prossie1_lm5 player
					REMOVE_BLIP radarped_prossie1_lm5
					flag_blip_on_prossie1_lm5 = 0
											   					
						WHILE NOT IS_CHAR_IN_CAR prossie1_lm5 vehicle_lm5

							WAIT 0
								
							GOSUB check_for_dead_prossies

							IF number_of_dead_prossies > 0
								PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
								GOTO mission_luigi5_failed
							ENDIF

							IF IS_CAR_DEAD vehicle_lm5
								PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle is wrecked!"
								GOTO mission_luigi5_failed
							ENDIF
														
							IF flag_prossie1_at_ball = 0 
							
								IF IS_CHAR_DEAD prossie1_lm5
									PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
									GOTO mission_luigi5_failed
								ELSE
									
									IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie1_lm5 player
									AND flag_blip_on_prossie1_lm5 = 0
										PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
										ADD_BLIP_FOR_CHAR prossie1_lm5 radarped_prossie1_lm5
										flag_blip_on_prossie1_lm5 = 1
										GOTO prossie_checks 
									ENDIF
	
									IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie1_lm5 8.0 8.0 FALSE
									AND flag_blip_on_prossie1_lm5 = 1
										SET_PLAYER_AS_LEADER prossie1_lm5 player
										REMOVE_BLIP radarped_prossie1_lm5 
										flag_blip_on_prossie1_lm5 = 0
									ENDIF

								ENDIF	
								
							ENDIF
						    						   							
						ENDWHILE
					   	flag_prossie1_lm5_in_car = 1
		 				SET_CHAR_RUNNING prossie1_lm5 FALSE
		 
				ELSE
					IF flag_had_room_message_lm5 = 0
						PRINT_NOW ( LM5_1 ) 7000 1 //"Get a bigger car!"
						flag_had_room_message_lm5 = 1
					ENDIF //room message
				ENDIF //room left in car
			ENDIF  //stopped
		ELSE
			flag_had_room_message_lm5 = 0
		ENDIF  // locate
	ENDIF
	
	   	   
		IF flag_prossie1_lm5_in_car = 1

			IF flag_prossie1_in_car_park = 0
				
				IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie1_lm5 player
				AND flag_blip_on_prossie1_lm5 = 0
					PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
					ADD_BLIP_FOR_CHAR prossie1_lm5 radarped_prossie1_lm5
					flag_blip_on_prossie1_lm5 = 1
					flag_prossie1_lm5_in_car = 0
				ENDIF
	
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie1_lm5 8.0 8.0 FALSE
				AND flag_blip_on_prossie1_lm5 = 1
					SET_PLAYER_AS_LEADER prossie1_lm5 player
					REMOVE_BLIP radarped_prossie1_lm5 
					flag_blip_on_prossie1_lm5 = 0
				ENDIF

			ENDIF

			IF IS_CHAR_STOPPED_IN_AREA_3D prossie1_lm5 1003.5 -883.0 13.9 996.8 -876.4 18.0 FALSE
			AND flag_prossie1_at_ball = 0
			AND flag_prossie1_in_car_park = 0
				WAIT 0

					IF flag_prossie1_at_ball = 0 
							
						IF IS_CHAR_DEAD prossie1_lm5
							PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
							GOTO mission_luigi5_failed
						ENDIF

					ENDIF

				GOSUB check_for_luigi5_achievement

				LEAVE_GROUP prossie1_lm5

				IF IS_CHAR_IN_ANY_CAR prossie1_lm5
					STORE_CAR_CHAR_IS_IN prossie1_lm5 vehicle_lm5
					SET_CHAR_OBJ_LEAVE_CAR prossie1_lm5 vehicle_lm5
				ENDIF
				flag_prossie1_in_car_park = 1				
			ENDIF
		
		ENDIF

		IF flag_prossie1_in_car_park = 1
	
			IF NOT IS_CHAR_IN_ANY_CAR prossie1_lm5
			AND flag_prossie1_told_to_go_into_ball = 0
				WAIT 0

				IF flag_prossie1_at_ball = 0 
							
					IF IS_CHAR_DEAD prossie1_lm5
						PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
						GOTO mission_luigi5_failed
					ENDIF

				ENDIF

				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie1_lm5 999.0 -891.0
				++ counter_no_of_girls_at_the_ball
				ADD_ONE_OFF_SOUND 999.9 -879.3 15.0 SOUND_PART_MISSION_COMPLETE
				//PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				CLEAR_WANTED_LEVEL player
				flag_prossie1_told_to_go_into_ball = 1

			ENDIF

			IF LOCATE_CHAR_ON_FOOT_2D prossie1_lm5 999.0 -891.0 1.0 1.0 FALSE
				CHAR_SET_IDLE prossie1_lm5
				REMOVE_CHAR_ELEGANTLY prossie1_lm5
				//++ counter_no_of_girls_at_the_ball
				//PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				flag_prossie1_at_ball = 1
			ENDIF

			IF flag_prossie1_told_to_go_into_ball = 1
			
				IF flag_prossie1_at_ball = 0

					IF flag_timer_prossie1_lm5 = 0
						timerb = 0
						flag_timer_prossie1_lm5 = 1
					ENDIF

					IF timerb > 20000
						SET_CHAR_COORDINATES prossie1_lm5 999.0 -891.0 14.3
					ENDIF
					
				ENDIF
				
			ENDIF

		ENDIF

ENDIF



//starts checking for prossie2
		
IF flag_prossie2_at_ball = 0

		IF IS_CHAR_DEAD prossie2_lm5
			PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
			GOTO mission_luigi5_failed
		ENDIF

	IF flag_prossie2_lm5_in_car = 0

		IF LOCATE_PLAYER_ON_FOOT_CHAR_3D player prossie2_lm5 8.0 8.0 2.0 FALSE
		AND flag_had_car_message2_lm5 = 0
			PRINT_NOW ( LM5_3 ) 5000 1 //"You need a car!"
			flag_had_car_message2_lm5 = 1
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player prossie2_lm5 8.0 8.0 2.0 FALSE
			flag_had_car_message2_lm5 = 0
		ENDIF	
		
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player prossie2_lm5 8.0 8.0 2.0 FALSE

			IF flag_prossie2_lm5_in_car = 0
				TURN_CHAR_TO_FACE_PLAYER prossie2_lm5 player
			ENDIF

			IF IS_PLAYER_STOPPED player

				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player vehicle_lm5
					GET_MAXIMUM_NUMBER_OF_PASSENGERS vehicle_lm5 max_no_of_passengers_lm5
					GET_NUMBER_OF_PASSENGERS vehicle_lm5 no_of_passengers_lm5
					room_left_in_car_lm5 = max_no_of_passengers_lm5 - no_of_passengers_lm5 
				ENDIF
				
				IF room_left_in_car_lm5 > 0

						SET_PLAYER_AS_LEADER prossie2_lm5 player
						REMOVE_BLIP radarped_prossie2_lm5
						flag_blip_on_prossie2_lm5 = 0
											
						WHILE NOT IS_CHAR_IN_CAR prossie2_lm5 vehicle_lm5

							WAIT 0

							GOSUB check_for_dead_prossies

							IF number_of_dead_prossies > 0
								PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
								GOTO mission_luigi5_failed
							ENDIF

							IF IS_CAR_DEAD vehicle_lm5
								PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle is wrecked!"
								GOTO mission_luigi5_failed
							ENDIF
							
							
							IF flag_prossie2_at_ball = 0

								IF IS_CHAR_DEAD prossie2_lm5
									PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
									GOTO mission_luigi5_failed
								ELSE

									IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie2_lm5 player
									AND flag_blip_on_prossie2_lm5 = 0
										PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
										ADD_BLIP_FOR_CHAR prossie2_lm5 radarped_prossie2_lm5
										flag_blip_on_prossie2_lm5 = 1
										GOTO prossie_checks
									ENDIF
	
									IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie2_lm5 8.0 8.0 FALSE
									AND flag_blip_on_prossie2_lm5 = 1
										SET_PLAYER_AS_LEADER prossie2_lm5 player
										REMOVE_BLIP radarped_prossie2_lm5 
										flag_blip_on_prossie2_lm5 = 0
									ENDIF

								ENDIF

							ENDIF
						  						  							
						ENDWHILE
						flag_prossie2_lm5_in_car = 1
						SET_CHAR_RUNNING prossie2_lm5 FALSE
				ELSE
					IF flag_had_room_message_lm5 = 0
						PRINT_NOW ( LM5_1 ) 7000 1 //"Get a bigger car!"
						flag_had_room_message_lm5 = 1
					ENDIF //room message
				ENDIF //room left in car
			ENDIF  //stopped
		ELSE
			flag_had_room_message_lm5 = 0
		ENDIF  // locate
	ENDIF
	


	   	   
		IF flag_prossie2_lm5_in_car = 1

			IF flag_prossie2_in_car_park = 0
				
				IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie2_lm5 player
				AND flag_blip_on_prossie2_lm5 = 0
					PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
					ADD_BLIP_FOR_CHAR prossie2_lm5 radarped_prossie2_lm5
					flag_blip_on_prossie2_lm5 = 1
					flag_prossie2_lm5_in_car = 0
				ENDIF
	
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie2_lm5 8.0 8.0 FALSE
				AND flag_blip_on_prossie2_lm5 = 1
					SET_PLAYER_AS_LEADER prossie2_lm5 player
					REMOVE_BLIP radarped_prossie2_lm5 
					flag_blip_on_prossie2_lm5 = 0
				ENDIF

			ENDIF

			IF IS_CHAR_STOPPED_IN_AREA_3D prossie2_lm5 1003.5 -883.0 13.9 996.8 -876.4 18.0 FALSE
			AND flag_prossie2_at_ball = 0
			AND flag_prossie2_in_car_park = 0
				WAIT 0

					IF flag_prossie2_at_ball = 0 
							
						IF IS_CHAR_DEAD prossie2_lm5
							PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
							GOTO mission_luigi5_failed
						ENDIF

					ENDIF

				GOSUB check_for_luigi5_achievement

				LEAVE_GROUP prossie2_lm5
				
				IF IS_CHAR_IN_ANY_CAR prossie2_lm5
					STORE_CAR_CHAR_IS_IN prossie2_lm5 vehicle_lm5
					SET_CHAR_OBJ_LEAVE_CAR prossie2_lm5 vehicle_lm5
				ENDIF
				flag_prossie2_in_car_park = 1				
			ENDIF
		
		ENDIF

		IF flag_prossie2_in_car_park = 1
	
			IF NOT IS_CHAR_IN_ANY_CAR prossie2_lm5
			AND flag_prossie2_told_to_go_into_ball = 0
				WAIT 0

				IF flag_prossie2_at_ball = 0 
							
					IF IS_CHAR_DEAD prossie2_lm5
						PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
						GOTO mission_luigi5_failed
					ENDIF

				ENDIF

				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie2_lm5 999.0 -891.0
				++ counter_no_of_girls_at_the_ball
				ADD_ONE_OFF_SOUND 999.9 -879.3 15.0 SOUND_PART_MISSION_COMPLETE
			   	//PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				CLEAR_WANTED_LEVEL player
				flag_prossie2_told_to_go_into_ball = 1
			ENDIF

			IF LOCATE_CHAR_ON_FOOT_2D prossie2_lm5 999.0 -891.0 1.0 1.0 FALSE
				CHAR_SET_IDLE prossie2_lm5
				REMOVE_CHAR_ELEGANTLY prossie2_lm5
				//++ counter_no_of_girls_at_the_ball
			   //	PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				flag_prossie2_at_ball = 1
			ENDIF

			IF flag_prossie2_told_to_go_into_ball = 1
			
				IF flag_prossie2_at_ball = 0

					IF flag_timer_prossie2_lm5 = 0
						timerb = 0
						flag_timer_prossie2_lm5 = 1
					ENDIF

					IF timerb > 20000
						SET_CHAR_COORDINATES prossie2_lm5 999.0 -891.0 14.3
					ENDIF
					
				ENDIF
				
			ENDIF

		ENDIF

ENDIF
  	


// starts check for prossie 3

IF flag_prossie3_at_ball = 0

		IF IS_CHAR_DEAD prossie3_lm5
			PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
			GOTO mission_luigi5_failed
		ENDIF

	IF flag_prossie3_lm5_in_car = 0

		IF LOCATE_PLAYER_ON_FOOT_CHAR_3D player prossie3_lm5 8.0 8.0 2.0 FALSE
		AND flag_had_car_message3_lm5 = 0
			PRINT_NOW ( LM5_3 ) 5000 1 //"You need a car!"
			flag_had_car_message3_lm5 = 1
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player prossie3_lm5 8.0 8.0 2.0 FALSE
			flag_had_car_message3_lm5 = 0
		ENDIF
		
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player prossie3_lm5 8.0 8.0 2.0 FALSE

			IF flag_prossie3_lm5_in_car = 0
				TURN_CHAR_TO_FACE_PLAYER prossie3_lm5 player
			ENDIF

			IF IS_PLAYER_STOPPED player

				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player vehicle_lm5
					GET_MAXIMUM_NUMBER_OF_PASSENGERS vehicle_lm5 max_no_of_passengers_lm5
					GET_NUMBER_OF_PASSENGERS vehicle_lm5 no_of_passengers_lm5 
					room_left_in_car_lm5 = max_no_of_passengers_lm5 - no_of_passengers_lm5
				ENDIF

				IF room_left_in_car_lm5 > 0
					
						SET_PLAYER_AS_LEADER prossie3_lm5 player
						REMOVE_BLIP radarped_prossie3_lm5
						flag_blip_on_prossie3_lm5 = 0 
					
						WHILE NOT IS_CHAR_IN_CAR prossie3_lm5 vehicle_lm5

							WAIT 0

							IF IS_CAR_DEAD vehicle_lm5
								PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle has been wrecked!"
								GOTO mission_luigi5_failed
							ENDIF

							GOSUB check_for_dead_prossies

							IF number_of_dead_prossies > 0
								PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
								GOTO mission_luigi5_failed
							ENDIF
													
														
							IF flag_prossie3_at_ball = 0
								
								IF IS_CHAR_DEAD prossie3_lm5
									PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
									GOTO mission_luigi5_failed
								ELSE

									IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie3_lm5 player
									AND flag_blip_on_prossie3_lm5 = 0
										PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
										ADD_BLIP_FOR_CHAR prossie3_lm5 radarped_prossie3_lm5
										flag_blip_on_prossie3_lm5 = 1
										GOTO prossie_checks
									ENDIF
	
									IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie3_lm5 8.0 8.0 FALSE
									AND flag_blip_on_prossie3_lm5 = 1
										SET_PLAYER_AS_LEADER prossie3_lm5 player
										REMOVE_BLIP radarped_prossie3_lm5 
										flag_blip_on_prossie3_lm5 = 0
									ENDIF

								ENDIF
									
							ENDIF

	  					ENDWHILE
						flag_prossie3_lm5_in_car = 1
						SET_CHAR_RUNNING prossie3_lm5 FALSE
				ELSE
					IF flag_had_room_message_lm5 = 0
						PRINT_NOW ( LM5_1 ) 7000 1 //"Get a bigger car!"
						flag_had_room_message_lm5 = 1
					ENDIF //room message
				ENDIF //room left in car
			ENDIF  //stopped
		ELSE
			flag_had_room_message_lm5 = 0
		ENDIF  // locate
	ENDIF
	
	   	   
		IF flag_prossie3_lm5_in_car = 1

			IF flag_prossie3_in_car_park = 0
							

				IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie3_lm5 player
				AND flag_blip_on_prossie3_lm5 = 0
					PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
					ADD_BLIP_FOR_CHAR prossie3_lm5 radarped_prossie3_lm5
					flag_blip_on_prossie3_lm5 = 1
					flag_prossie3_lm5_in_car = 0
				ENDIF
	
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie3_lm5 8.0 8.0 FALSE
				AND flag_blip_on_prossie3_lm5 = 1
					SET_PLAYER_AS_LEADER prossie3_lm5 player
					REMOVE_BLIP radarped_prossie3_lm5 
					flag_blip_on_prossie3_lm5 = 0
				ENDIF

			ENDIF

			IF IS_CHAR_STOPPED_IN_AREA_3D prossie3_lm5 1003.5 -883.0 13.9 996.8 -876.4 18.0 FALSE
			AND flag_prossie3_at_ball = 0
			AND flag_prossie3_in_car_park = 0
				WAIT 0

					IF flag_prossie3_at_ball = 0 
							
						IF IS_CHAR_DEAD prossie3_lm5
							PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
							GOTO mission_luigi5_failed
						ENDIF

					ENDIF

				GOSUB check_for_luigi5_achievement

				LEAVE_GROUP prossie3_lm5
				
				IF IS_CHAR_IN_ANY_CAR prossie3_lm5
					STORE_CAR_CHAR_IS_IN prossie3_lm5 vehicle_lm5
					SET_CHAR_OBJ_LEAVE_CAR prossie3_lm5 vehicle_lm5
				ENDIF
				flag_prossie3_in_car_park = 1				
			ENDIF
		
		ENDIF
		
		IF flag_prossie3_in_car_park = 1
	
			IF NOT IS_CHAR_IN_ANY_CAR prossie3_lm5
			AND flag_prossie3_told_to_go_into_ball = 0
				WAIT 0

				IF flag_prossie3_at_ball = 0 
							
					IF IS_CHAR_DEAD prossie3_lm5
						PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
						GOTO mission_luigi5_failed
					ENDIF

				ENDIF

				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie3_lm5 999.0 -891.0
				++ counter_no_of_girls_at_the_ball
				ADD_ONE_OFF_SOUND 999.9 -879.3 15.0 SOUND_PART_MISSION_COMPLETE
				//PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				CLEAR_WANTED_LEVEL player
				flag_prossie3_told_to_go_into_ball = 1
			ENDIF

			IF LOCATE_CHAR_ON_FOOT_2D prossie3_lm5 999.0 -891.0 1.0 1.0 FALSE
				CHAR_SET_IDLE prossie3_lm5
				REMOVE_CHAR_ELEGANTLY prossie3_lm5
				//++ counter_no_of_girls_at_the_ball
				//PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				flag_prossie3_at_ball = 1
			ENDIF

			IF flag_prossie3_told_to_go_into_ball = 1
			
				IF flag_prossie3_at_ball = 0

					IF flag_timer_prossie3_lm5 = 0
						timerb = 0
						flag_timer_prossie3_lm5 = 1
					ENDIF

					IF timerb > 20000
						SET_CHAR_COORDINATES prossie3_lm5 999.0 -891.0 14.3
					ENDIF
					
				ENDIF
				
			ENDIF

		ENDIF

ENDIF
  	
  
 
// checks for prossie 4

IF flag_prossie4_at_ball = 0

		IF IS_CHAR_DEAD prossie4_lm5
			PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
			GOTO mission_luigi5_failed
		ENDIF

	IF flag_prossie4_lm5_in_car = 0

		IF LOCATE_PLAYER_ON_FOOT_CHAR_3D player prossie4_lm5 8.0 8.0 2.0 FALSE
		AND flag_had_car_message4_lm5 = 0
			PRINT_NOW ( LM5_3 ) 5000 1 //"You need a car!"
			flag_had_car_message4_lm5 = 1
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player prossie4_lm5 8.0 8.0 2.0 FALSE
			flag_had_car_message4_lm5 = 0
		ENDIF
		
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player prossie4_lm5 8.0 8.0 2.0 FALSE

			IF flag_prossie4_lm5_in_car = 0
				TURN_CHAR_TO_FACE_PLAYER prossie4_lm5 player
			ENDIF

			IF IS_PLAYER_STOPPED player

				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player vehicle_lm5
					GET_MAXIMUM_NUMBER_OF_PASSENGERS vehicle_lm5 max_no_of_passengers_lm5
					GET_NUMBER_OF_PASSENGERS vehicle_lm5 no_of_passengers_lm5 
					room_left_in_car_lm5 = max_no_of_passengers_lm5 - no_of_passengers_lm5
				ENDIF

				IF room_left_in_car_lm5 > 0
					
						SET_PLAYER_AS_LEADER prossie4_lm5 player
						REMOVE_BLIP radarped_prossie4_lm5
						flag_blip_on_prossie4_lm5 = 0
											
						WHILE NOT IS_CHAR_IN_CAR prossie4_lm5 vehicle_lm5

							WAIT 0

							GOSUB check_for_dead_prossies

							IF number_of_dead_prossies > 0
								PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
								GOTO mission_luigi5_failed
							ENDIF


							IF IS_CAR_DEAD vehicle_lm5
								PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle is wrecked!"
								GOTO mission_luigi5_failed
							ENDIF
						   						

							IF flag_prossie4_at_ball = 0

								IF IS_CHAR_DEAD prossie4_lm5
									PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
									GOTO mission_luigi5_failed
								ELSE

									IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie4_lm5 player
									AND flag_blip_on_prossie4_lm5 = 0
										PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
										ADD_BLIP_FOR_CHAR prossie4_lm5 radarped_prossie4_lm5
										flag_blip_on_prossie4_lm5 = 1
										GOTO prossie_checks
									ENDIF
	
									IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie4_lm5 8.0 8.0 FALSE
									AND flag_blip_on_prossie4_lm5 = 1
										SET_PLAYER_AS_LEADER prossie4_lm5 player
										REMOVE_BLIP radarped_prossie4_lm5 
										flag_blip_on_prossie4_lm5 = 0
									ENDIF

								ENDIF

							ENDIF

														
						ENDWHILE
						flag_prossie4_lm5_in_car = 1
						SET_CHAR_RUNNING prossie4_lm5 FALSE
				ELSE
					IF flag_had_room_message_lm5 = 0
						PRINT_NOW ( LM5_1 ) 7000 1 //"Get a bigger car!"
						flag_had_room_message_lm5 = 1
					ENDIF //room message
				ENDIF //room left in car
			ENDIF  //stopped
		ELSE
			flag_had_room_message_lm5 = 0
		ENDIF  // locate
	ENDIF
	
 
 	   	   
		IF flag_prossie4_lm5_in_car = 1

			IF flag_prossie4_in_car_park = 0
								
				IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie4_lm5 player
				AND flag_blip_on_prossie4_lm5 = 0
					PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
					ADD_BLIP_FOR_CHAR prossie4_lm5 radarped_prossie4_lm5
					flag_blip_on_prossie4_lm5 = 1
					flag_prossie4_lm5_in_car = 0
				ENDIF
	
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie4_lm5 8.0 8.0 FALSE
				AND flag_blip_on_prossie4_lm5 = 1
					SET_PLAYER_AS_LEADER prossie4_lm5 player
					REMOVE_BLIP radarped_prossie4_lm5 
					flag_blip_on_prossie4_lm5 = 0
				ENDIF

			ENDIF

			IF IS_CHAR_STOPPED_IN_AREA_3D prossie4_lm5 1003.5 -883.0 13.9 996.8 -876.4 18.0 FALSE
			AND flag_prossie4_at_ball = 0
			AND flag_prossie4_in_car_park = 0
				WAIT 0

					IF flag_prossie4_at_ball = 0 
							
						IF IS_CHAR_DEAD prossie4_lm5
							PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
							GOTO mission_luigi5_failed
						ENDIF

					ENDIF

				GOSUB check_for_luigi5_achievement

				LEAVE_GROUP prossie4_lm5
				
				IF IS_CHAR_IN_ANY_CAR prossie4_lm5
					STORE_CAR_CHAR_IS_IN prossie4_lm5 vehicle_lm5
					SET_CHAR_OBJ_LEAVE_CAR prossie4_lm5 vehicle_lm5
				ENDIF
				flag_prossie4_in_car_park = 1				
			ENDIF
		
		ENDIF

		IF flag_prossie4_in_car_park = 1
	
			IF NOT IS_CHAR_IN_ANY_CAR prossie4_lm5
			AND flag_prossie4_told_to_go_into_ball = 0
				WAIT 0

				IF flag_prossie4_at_ball = 0 
							
					IF IS_CHAR_DEAD prossie4_lm5
						PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
						GOTO mission_luigi5_failed
					ENDIF

				ENDIF

				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie4_lm5 999.0 -891.0
				++ counter_no_of_girls_at_the_ball
				ADD_ONE_OFF_SOUND 999.9 -879.3 15.0 SOUND_PART_MISSION_COMPLETE
			   //	PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				CLEAR_WANTED_LEVEL player
				flag_prossie4_told_to_go_into_ball = 1
			ENDIF

			IF LOCATE_CHAR_ON_FOOT_2D prossie4_lm5 999.0 -891.0 1.0 1.0 FALSE
				CHAR_SET_IDLE prossie4_lm5
				REMOVE_CHAR_ELEGANTLY prossie4_lm5
				//++ counter_no_of_girls_at_the_ball
				//PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				flag_prossie4_at_ball = 1
			ENDIF

			IF flag_prossie4_told_to_go_into_ball = 1
			
				IF flag_prossie4_at_ball = 0

					IF flag_timer_prossie4_lm5 = 0
						timerb = 0
						flag_timer_prossie4_lm5 = 1
					ENDIF

					IF timerb > 20000
						SET_CHAR_COORDINATES prossie4_lm5 999.0 -891.0 14.3
					ENDIF
					
				ENDIF
				
			ENDIF

		ENDIF

ENDIF
 

 
  	
// checks for prossie 5

IF flag_prossie5_at_ball = 0

		IF IS_CHAR_DEAD prossie5_lm5
			PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
			GOTO mission_luigi5_failed
		ENDIF

	IF flag_prossie5_lm5_in_car = 0

		IF LOCATE_PLAYER_ON_FOOT_CHAR_3D player prossie5_lm5 8.0 8.0 2.0 FALSE
		AND flag_had_car_message5_lm5 = 0
			PRINT_NOW ( LM5_3 ) 5000 1 //"You need a car!"
			flag_had_car_message5_lm5 = 1
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player prossie5_lm5 8.0 8.0 2.0 FALSE
			flag_had_car_message5_lm5 = 0
		ENDIF
		
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player prossie5_lm5 8.0 8.0 2.0 FALSE

			IF flag_prossie5_lm5_in_car = 0
				TURN_CHAR_TO_FACE_PLAYER prossie5_lm5 player
			ENDIF

			IF IS_PLAYER_STOPPED player

				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player vehicle_lm5
					GET_MAXIMUM_NUMBER_OF_PASSENGERS vehicle_lm5 max_no_of_passengers_lm5
					GET_NUMBER_OF_PASSENGERS vehicle_lm5 no_of_passengers_lm5 
					room_left_in_car_lm5 = max_no_of_passengers_lm5 - no_of_passengers_lm5
				ENDIF
				
				IF room_left_in_car_lm5 > 0
										
						SET_PLAYER_AS_LEADER prossie5_lm5 player
						REMOVE_BLIP radarped_prossie5_lm5
						flag_blip_on_prossie5_lm5 = 0
					
						WHILE NOT IS_CHAR_IN_CAR prossie5_lm5 vehicle_lm5

							WAIT 0

							GOSUB check_for_dead_prossies

							IF number_of_dead_prossies > 0
								PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
								GOTO mission_luigi5_failed
							ENDIF

							IF IS_CAR_DEAD vehicle_lm5
								PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle is wrecked!"
								GOTO mission_luigi5_failed
							ENDIF
								
						   	IF flag_prossie5_at_ball = 0
							
								IF IS_CHAR_DEAD prossie5_lm5
									PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
									GOTO mission_luigi5_failed
								ELSE

									IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie5_lm5 player
									AND flag_blip_on_prossie5_lm5 = 0
										PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
										ADD_BLIP_FOR_CHAR prossie5_lm5 radarped_prossie5_lm5
										flag_blip_on_prossie5_lm5 = 1
										GOTO prossie_checks
									ENDIF
	
									IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie5_lm5 8.0 8.0 FALSE
									AND flag_blip_on_prossie5_lm5 = 1
										SET_PLAYER_AS_LEADER prossie5_lm5 player
										REMOVE_BLIP radarped_prossie5_lm5 
										flag_blip_on_prossie5_lm5 = 0
									ENDIF

								ENDIF

							ENDIF

												   							
						ENDWHILE
						flag_prossie5_lm5_in_car = 1
						SET_CHAR_RUNNING prossie5_lm5 FALSE
				ELSE
					IF flag_had_room_message_lm5 = 0
						PRINT_NOW ( LM5_1 ) 7000 1 //"Get a bigger car!"
						flag_had_room_message_lm5 = 1
					ENDIF //room message
				ENDIF //room left in car
			ENDIF  //stopped
		ELSE
			flag_had_room_message_lm5 = 0
		ENDIF  // locate
	ENDIF
	

	   	   
		IF flag_prossie5_lm5_in_car = 1

			IF flag_prossie5_in_car_park = 0
				
				IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie5_lm5 player
				AND flag_blip_on_prossie5_lm5 = 0
					PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
					ADD_BLIP_FOR_CHAR prossie5_lm5 radarped_prossie5_lm5
					flag_blip_on_prossie5_lm5 = 1
					flag_prossie5_lm5_in_car = 0
				ENDIF
	
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie5_lm5 8.0 8.0 FALSE
				AND flag_blip_on_prossie5_lm5 = 1
					SET_PLAYER_AS_LEADER prossie5_lm5 player
					REMOVE_BLIP radarped_prossie5_lm5 
					flag_blip_on_prossie5_lm5 = 0
				ENDIF

			ENDIF

			IF IS_CHAR_STOPPED_IN_AREA_3D prossie5_lm5 1003.5 -883.0 13.9 996.8 -876.4 18.0 FALSE
			AND flag_prossie5_at_ball = 0
			AND flag_prossie5_in_car_park = 0
				WAIT 0

					IF flag_prossie5_at_ball = 0 
							
						IF IS_CHAR_DEAD prossie5_lm5
							PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
							GOTO mission_luigi5_failed
						ENDIF

					ENDIF

				GOSUB check_for_luigi5_achievement

				LEAVE_GROUP prossie5_lm5
				
				IF IS_CHAR_IN_ANY_CAR prossie5_lm5
					STORE_CAR_CHAR_IS_IN prossie5_lm5 vehicle_lm5
					SET_CHAR_OBJ_LEAVE_CAR prossie5_lm5 vehicle_lm5
				ENDIF
				flag_prossie5_in_car_park = 1				
			ENDIF
		
		ENDIF

		IF flag_prossie5_in_car_park = 1
	
			IF NOT IS_CHAR_IN_ANY_CAR prossie5_lm5
			AND flag_prossie5_told_to_go_into_ball = 0
				WAIT 0

				IF flag_prossie5_at_ball = 0 
							
					IF IS_CHAR_DEAD prossie5_lm5
						PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
						GOTO mission_luigi5_failed
					ENDIF

				ENDIF

				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie5_lm5 999.0 -891.0
				++ counter_no_of_girls_at_the_ball
			   //	PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				CLEAR_WANTED_LEVEL player
				flag_prossie5_told_to_go_into_ball = 1
			ENDIF

			IF LOCATE_CHAR_ON_FOOT_2D prossie5_lm5 999.0 -891.0 1.0 1.0 FALSE
				CHAR_SET_IDLE prossie5_lm5
				REMOVE_CHAR_ELEGANTLY prossie5_lm5
				//++ counter_no_of_girls_at_the_ball
				//PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				flag_prossie5_at_ball = 1
			ENDIF

			IF flag_prossie5_told_to_go_into_ball = 1
			
				IF flag_prossie5_at_ball = 0

					IF flag_timer_prossie5_lm5 = 0
						timerb = 0
						flag_timer_prossie5_lm5 = 1
					ENDIF

					IF timerb > 20000
						SET_CHAR_COORDINATES prossie5_lm5 999.0 -891.0 14.3
					ENDIF
					
				ENDIF
				
			ENDIF

		ENDIF

ENDIF

 
// checks for prossie 6

IF flag_prossie6_at_ball = 0

		IF IS_CHAR_DEAD prossie6_lm5
			PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
			GOTO mission_luigi5_failed
		ENDIF

	IF flag_prossie6_lm5_in_car = 0

		IF LOCATE_PLAYER_ON_FOOT_CHAR_3D player prossie6_lm5 8.0 8.0 2.0 FALSE
		AND flag_had_car_message6_lm5 = 0
			PRINT_NOW ( LM5_3 ) 5000 1 //"You need a car!"
			flag_had_car_message6_lm5 = 1
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player prossie6_lm5 8.0 8.0 2.0 FALSE
			flag_had_car_message6_lm5 = 0
		ENDIF
		
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player prossie6_lm5 8.0 8.0 2.0 FALSE

			IF flag_prossie6_lm5_in_car = 0
				TURN_CHAR_TO_FACE_PLAYER prossie6_lm5 player
			ENDIF

			IF IS_PLAYER_STOPPED player

				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player vehicle_lm5
					GET_MAXIMUM_NUMBER_OF_PASSENGERS vehicle_lm5 max_no_of_passengers_lm5
					GET_NUMBER_OF_PASSENGERS vehicle_lm5 no_of_passengers_lm5 
					room_left_in_car_lm5 = max_no_of_passengers_lm5 - no_of_passengers_lm5
				ENDIF

				IF room_left_in_car_lm5 > 0
										
						SET_PLAYER_AS_LEADER prossie6_lm5 player
						REMOVE_BLIP radarped_prossie6_lm5
						flag_blip_on_prossie6_lm5 = 0
											
						WHILE NOT IS_CHAR_IN_CAR prossie6_lm5 vehicle_lm5

							WAIT 0
								
							GOSUB check_for_dead_prossies

							IF number_of_dead_prossies > 0
								PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
								GOTO mission_luigi5_failed
							ENDIF

							IF IS_CAR_DEAD vehicle_lm5
								PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle is wrecked!"
								GOTO mission_luigi5_failed
							ENDIF
											   							
						   
							IF flag_prossie6_at_ball = 0

								IF IS_CHAR_DEAD prossie6_lm5
									PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
									GOTO mission_luigi5_failed
								ELSE

									IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie6_lm5 player
									AND flag_blip_on_prossie6_lm5 = 0
										PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
										ADD_BLIP_FOR_CHAR prossie6_lm5 radarped_prossie6_lm5
										flag_blip_on_prossie6_lm5 = 1
										GOTO prossie_checks
									ENDIF
	
									IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie6_lm5 8.0 8.0 FALSE
									AND flag_blip_on_prossie6_lm5 = 1
										SET_PLAYER_AS_LEADER prossie6_lm5 player
										REMOVE_BLIP radarped_prossie6_lm5 
										flag_blip_on_prossie6_lm5 = 0
									ENDIF

								ENDIF

							ENDIF

						   							
						ENDWHILE
						
						flag_prossie6_lm5_in_car = 1
						
						SET_CHAR_RUNNING prossie6_lm5 FALSE
				ELSE
					IF flag_had_room_message_lm5 = 0
						PRINT_NOW ( LM5_1 ) 7000 1 //"Get a bigger car!"
						flag_had_room_message_lm5 = 1
					ENDIF //room message
				ENDIF //room left in car
			ENDIF  //stopped
		ELSE
			flag_had_room_message_lm5 = 0
		ENDIF  // locate
	ENDIF
	

	   	   
		IF flag_prossie6_lm5_in_car = 1

			IF flag_prossie6_in_car_park = 0

				
				IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie6_lm5 player
				AND flag_blip_on_prossie6_lm5 = 0
					PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
					ADD_BLIP_FOR_CHAR prossie6_lm5 radarped_prossie6_lm5
					flag_blip_on_prossie6_lm5 = 1
					flag_prossie6_lm5_in_car = 0
				ENDIF
	
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie6_lm5 8.0 8.0 FALSE
				AND flag_blip_on_prossie6_lm5 = 1
					SET_PLAYER_AS_LEADER prossie6_lm5 player
					REMOVE_BLIP radarped_prossie6_lm5 
					flag_blip_on_prossie6_lm5 = 0
				ENDIF

			ENDIF

			IF IS_CHAR_STOPPED_IN_AREA_3D prossie6_lm5 1003.5 -883.0 13.9 996.8 -876.4 18.0 FALSE
			AND flag_prossie6_at_ball = 0
			AND flag_prossie6_in_car_park = 0
				WAIT 0

					IF flag_prossie6_at_ball = 0 
							
						IF IS_CHAR_DEAD prossie6_lm5
							PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
							GOTO mission_luigi5_failed
						ENDIF

					ENDIF

				GOSUB check_for_luigi5_achievement

				LEAVE_GROUP prossie6_lm5
				
				IF IS_CHAR_IN_ANY_CAR prossie6_lm5
					STORE_CAR_CHAR_IS_IN prossie6_lm5 vehicle_lm5
					SET_CHAR_OBJ_LEAVE_CAR prossie6_lm5 vehicle_lm5
				ENDIF
				flag_prossie6_in_car_park = 1				
			ENDIF
		
		ENDIF

		IF flag_prossie6_in_car_park = 1
	
			IF NOT IS_CHAR_IN_ANY_CAR prossie6_lm5
			AND flag_prossie6_told_to_go_into_ball = 0
				WAIT 0

				IF flag_prossie6_at_ball = 0 
							
					IF IS_CHAR_DEAD prossie6_lm5
						PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
						GOTO mission_luigi5_failed
					ENDIF

				ENDIF

				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie6_lm5 999.0 -891.0
				++ counter_no_of_girls_at_the_ball
				ADD_ONE_OFF_SOUND 999.9 -879.3 15.0 SOUND_PART_MISSION_COMPLETE
			   //	PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				CLEAR_WANTED_LEVEL player
				flag_prossie6_told_to_go_into_ball = 1
			ENDIF

			IF LOCATE_CHAR_ON_FOOT_2D prossie6_lm5 999.0 -891.0 1.0 1.0 FALSE
				CHAR_SET_IDLE prossie6_lm5
				REMOVE_CHAR_ELEGANTLY prossie6_lm5
				//++ counter_no_of_girls_at_the_ball
				//PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				flag_prossie6_at_ball = 1
			ENDIF

			IF flag_prossie6_told_to_go_into_ball = 1
			
				IF flag_prossie6_at_ball = 0

					IF flag_timer_prossie6_lm5 = 0
						timerb = 0
						flag_timer_prossie6_lm5 = 1
					ENDIF

					IF timerb > 20000
						SET_CHAR_COORDINATES prossie6_lm5 999.0 -891.0 14.3
					ENDIF
					
				ENDIF
				
			ENDIF

		ENDIF

ENDIF

  	
// checks for prossie 7

IF flag_prossie7_at_ball = 0

		IF IS_CHAR_DEAD prossie7_lm5
			PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
			GOTO mission_luigi5_failed
		ENDIF

	IF flag_prossie7_lm5_in_car = 0

		IF LOCATE_PLAYER_ON_FOOT_CHAR_3D player prossie7_lm5 8.0 8.0 2.0 FALSE
		AND flag_had_car_message7_lm5 = 0
			PRINT_NOW ( LM5_3 ) 5000 1 //"You need a car!"
			flag_had_car_message7_lm5 = 1
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player prossie7_lm5 8.0 8.0 2.0 FALSE
			flag_had_car_message7_lm5 = 0
		ENDIF
		
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player prossie7_lm5 8.0 8.0 2.0 FALSE

			IF flag_prossie7_lm5_in_car = 0
				TURN_CHAR_TO_FACE_PLAYER prossie7_lm5 player
			ENDIF

			IF IS_PLAYER_STOPPED player

				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player vehicle_lm5
					GET_MAXIMUM_NUMBER_OF_PASSENGERS vehicle_lm5 max_no_of_passengers_lm5
					GET_NUMBER_OF_PASSENGERS vehicle_lm5 no_of_passengers_lm5 
					room_left_in_car_lm5 = max_no_of_passengers_lm5 - no_of_passengers_lm5
				ENDIF

				IF room_left_in_car_lm5 > 0
																	
						SET_PLAYER_AS_LEADER prossie7_lm5 player
						REMOVE_BLIP radarped_prossie7_lm5
						flag_blip_on_prossie7_lm5 = 0
					
						WHILE NOT IS_CHAR_IN_CAR prossie7_lm5 vehicle_lm5

							WAIT 0

							GOSUB check_for_dead_prossies

							IF number_of_dead_prossies > 0
								PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
								GOTO mission_luigi5_failed
							ENDIF

							IF IS_CAR_DEAD vehicle_lm5
								PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle is wrecked!"
								GOTO mission_luigi5_failed
							ENDIF
													   
							IF flag_prossie7_at_ball = 0

								IF IS_CHAR_DEAD prossie7_lm5
									PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
									GOTO mission_luigi5_failed
								ELSE

									IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie7_lm5 player
									AND flag_blip_on_prossie7_lm5 = 0
										PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
										ADD_BLIP_FOR_CHAR prossie7_lm5 radarped_prossie7_lm5
										flag_blip_on_prossie7_lm5 = 1
										GOTO prossie_checks
									ENDIF
	
									IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie7_lm5 8.0 8.0 FALSE
									AND flag_blip_on_prossie7_lm5 = 1
										SET_PLAYER_AS_LEADER prossie7_lm5 player
										REMOVE_BLIP radarped_prossie7_lm5 
										flag_blip_on_prossie7_lm5 = 0
									ENDIF

								ENDIF

							ENDIF

														
						ENDWHILE
						flag_prossie7_lm5_in_car = 1
						SET_CHAR_RUNNING prossie7_lm5 FALSE
				ELSE
					IF flag_had_room_message_lm5 = 0
						PRINT_NOW ( LM5_1 ) 7000 1 //"Get a bigger car!"
						flag_had_room_message_lm5 = 1
					ENDIF //room message
				ENDIF //room left in car
			ENDIF  //stopped
		ELSE
			flag_had_room_message_lm5 = 0
		ENDIF  // locate
	ENDIF
	
 
 	   	   
		IF flag_prossie7_lm5_in_car = 1

			IF flag_prossie7_in_car_park = 0

				
				IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie7_lm5 player
				AND flag_blip_on_prossie7_lm5 = 0
					PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
					ADD_BLIP_FOR_CHAR prossie7_lm5 radarped_prossie7_lm5
					flag_blip_on_prossie7_lm5 = 1
					flag_prossie7_lm5_in_car = 0
				ENDIF
	
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie7_lm5 8.0 8.0 FALSE
				AND flag_blip_on_prossie7_lm5 = 1
					SET_PLAYER_AS_LEADER prossie7_lm5 player
					REMOVE_BLIP radarped_prossie7_lm5 
					flag_blip_on_prossie7_lm5 = 0
				ENDIF

			ENDIF

			IF IS_CHAR_STOPPED_IN_AREA_3D prossie7_lm5 1003.5 -883.0 13.9 996.8 -876.4 18.0 FALSE
			AND flag_prossie7_at_ball = 0
			AND flag_prossie7_in_car_park = 0
				WAIT 0

					IF flag_prossie7_at_ball = 0 
							
						IF IS_CHAR_DEAD prossie7_lm5
							PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
							GOTO mission_luigi5_failed
						ENDIF

					ENDIF

				GOSUB check_for_luigi5_achievement

				LEAVE_GROUP prossie7_lm5
				
				IF IS_CHAR_IN_ANY_CAR prossie7_lm5
					STORE_CAR_CHAR_IS_IN prossie7_lm5 vehicle_lm5
					SET_CHAR_OBJ_LEAVE_CAR prossie7_lm5 vehicle_lm5
				ENDIF
				flag_prossie7_in_car_park = 1				
			ENDIF
		
		ENDIF

		IF flag_prossie7_in_car_park = 1
	
			IF NOT IS_CHAR_IN_ANY_CAR prossie7_lm5
			AND flag_prossie7_told_to_go_into_ball = 0
				WAIT 0

				IF flag_prossie7_at_ball = 0 
							
					IF IS_CHAR_DEAD prossie7_lm5
						PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
						GOTO mission_luigi5_failed
					ENDIF

				ENDIF

				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie7_lm5 999.0 -891.0
				++ counter_no_of_girls_at_the_ball
				ADD_ONE_OFF_SOUND 999.9 -879.3 15.0 SOUND_PART_MISSION_COMPLETE
			   //	PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				CLEAR_WANTED_LEVEL player
				flag_prossie7_told_to_go_into_ball = 1
			ENDIF

			IF LOCATE_CHAR_ON_FOOT_2D prossie7_lm5 999.0 -891.0 1.0 1.0 FALSE
				CHAR_SET_IDLE prossie7_lm5
				REMOVE_CHAR_ELEGANTLY prossie7_lm5
				//++ counter_no_of_girls_at_the_ball
				//PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				flag_prossie7_at_ball = 1
			ENDIF

			IF flag_prossie7_told_to_go_into_ball = 1
			
				IF flag_prossie7_at_ball = 0

					IF flag_timer_prossie7_lm5 = 0
						timerb = 0
						flag_timer_prossie7_lm5 = 1
					ENDIF

					IF timerb > 20000
						SET_CHAR_COORDINATES prossie7_lm5 999.0 -891.0 14.3
					ENDIF
					
				ENDIF
				
			ENDIF

		ENDIF

ENDIF


// checks for prossie 8

IF flag_prossie8_at_ball = 0

		IF IS_CHAR_DEAD prossie8_lm5
			PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
			GOTO mission_luigi5_failed
		ENDIF

	IF flag_prossie8_lm5_in_car = 0

		IF LOCATE_PLAYER_ON_FOOT_CHAR_3D player prossie8_lm5 8.0 8.0 2.0 FALSE
		AND flag_had_car_message8_lm5 = 0
			PRINT_NOW ( LM5_3 ) 5000 1 //"You need a car!"
			flag_had_car_message8_lm5 = 1
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player prossie8_lm5 8.0 8.0 2.0 FALSE
			flag_had_car_message8_lm5 = 0
		ENDIF
		
		IF LOCATE_PLAYER_IN_CAR_CHAR_3D player prossie8_lm5 8.0 8.0 2.0 FALSE

			IF flag_prossie8_lm5_in_car = 0
				TURN_CHAR_TO_FACE_PLAYER prossie8_lm5 player
			ENDIF

			IF IS_PLAYER_STOPPED player

				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player vehicle_lm5
					GET_MAXIMUM_NUMBER_OF_PASSENGERS vehicle_lm5 max_no_of_passengers_lm5
					GET_NUMBER_OF_PASSENGERS vehicle_lm5 no_of_passengers_lm5 
					room_left_in_car_lm5 = max_no_of_passengers_lm5 - no_of_passengers_lm5
				ENDIF
				
				IF room_left_in_car_lm5 > 0
										
						SET_PLAYER_AS_LEADER prossie8_lm5 player
						REMOVE_BLIP radarped_prossie8_lm5
						flag_blip_on_prossie8_lm5 = 0
					
						WHILE NOT IS_CHAR_IN_CAR prossie8_lm5 vehicle_lm5

							WAIT 0

							GOSUB check_for_dead_prossies

							IF number_of_dead_prossies > 0
								PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
								GOTO mission_luigi5_failed
							ENDIF

							IF IS_CAR_DEAD vehicle_lm5
								PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle is wrecked!"
								GOTO mission_luigi5_failed
							ENDIF
													  
							IF flag_prossie8_at_ball = 0

								IF IS_CHAR_DEAD prossie8_lm5
									PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
									GOTO mission_luigi5_failed
								ELSE

									IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie8_lm5 player
									AND flag_blip_on_prossie8_lm5 = 0
										PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
										ADD_BLIP_FOR_CHAR prossie8_lm5 radarped_prossie8_lm5
										flag_blip_on_prossie8_lm5 = 1
										GOTO prossie_checks
									ENDIF
	
									IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie8_lm5 8.0 8.0 FALSE
									AND flag_blip_on_prossie8_lm5 = 1
										SET_PLAYER_AS_LEADER prossie8_lm5 player
										REMOVE_BLIP radarped_prossie8_lm5 
										flag_blip_on_prossie8_lm5 = 0
									ENDIF
																	
								ENDIF

							ENDIF
							
						ENDWHILE
						flag_prossie8_lm5_in_car = 1
						SET_CHAR_RUNNING prossie8_lm5 FALSE
				ELSE
					IF flag_had_room_message_lm5 = 0
						PRINT_NOW ( LM5_1 ) 7000 1 //"Get a bigger car!"
						flag_had_room_message_lm5 = 1
					ENDIF //room message
				ENDIF //room left in car
			ENDIF  //stopped
		ELSE
			flag_had_room_message_lm5 = 0
		ENDIF  // locate
	ENDIF

	
	   	   
		IF flag_prossie8_lm5_in_car = 1

			IF flag_prossie8_in_car_park = 0

				
				IF NOT IS_CHAR_IN_PLAYERS_GROUP prossie8_lm5 player
				AND flag_blip_on_prossie8_lm5 = 0
					PRINT_NOW ( HEY5 ) 5000 1 //"You have left one of the girls behind go and get her!"
					ADD_BLIP_FOR_CHAR prossie8_lm5 radarped_prossie8_lm5
					flag_blip_on_prossie8_lm5 = 1
					flag_prossie8_lm5_in_car = 0
				ENDIF
	
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player prossie8_lm5 8.0 8.0 FALSE
				AND flag_blip_on_prossie8_lm5 = 1
					SET_PLAYER_AS_LEADER prossie8_lm5 player
					REMOVE_BLIP radarped_prossie8_lm5 
					flag_blip_on_prossie8_lm5 = 0
				ENDIF

			ENDIF

			IF IS_CHAR_STOPPED_IN_AREA_3D prossie8_lm5 1003.5 -883.0 13.9 996.8 -876.4 18.0 FALSE
			AND flag_prossie8_at_ball = 0
			AND flag_prossie8_in_car_park = 0
				WAIT 0

					IF flag_prossie8_at_ball = 0 
							
						IF IS_CHAR_DEAD prossie8_lm5
							PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
							GOTO mission_luigi5_failed
						ENDIF

					ENDIF

				GOSUB check_for_luigi5_achievement

				LEAVE_GROUP prossie8_lm5
				
				IF IS_CHAR_IN_ANY_CAR prossie8_lm5
					STORE_CAR_CHAR_IS_IN prossie8_lm5 vehicle_lm5
					SET_CHAR_OBJ_LEAVE_CAR prossie8_lm5 vehicle_lm5
				ENDIF
				flag_prossie8_in_car_park = 1				
			ENDIF
		
		ENDIF

		IF flag_prossie8_in_car_park = 1
	
			IF NOT IS_CHAR_IN_ANY_CAR prossie8_lm5
			AND flag_prossie8_told_to_go_into_ball = 0
				WAIT 0

				IF flag_prossie8_at_ball = 0 
							
					IF IS_CHAR_DEAD prossie8_lm5
						PRINT_NOW ( LM5_2 ) 5000 1 //"A girl has died!"
						GOTO mission_luigi5_failed
					ENDIF

				ENDIF

				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie8_lm5 999.0 -891.0
				++ counter_no_of_girls_at_the_ball
				ADD_ONE_OFF_SOUND 999.9 -879.3 15.0 SOUND_PART_MISSION_COMPLETE
			   //	PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				CLEAR_WANTED_LEVEL player
				flag_prossie8_told_to_go_into_ball = 1
			ENDIF

			IF LOCATE_CHAR_ON_FOOT_2D prossie8_lm5 999.0 -891.0 1.0 1.0 FALSE
				CHAR_SET_IDLE prossie8_lm5
				REMOVE_CHAR_ELEGANTLY prossie8_lm5
				//++ counter_no_of_girls_at_the_ball
				//PRINT_WITH_NUMBER_NOW ( LM5_8 ) counter_no_of_girls_at_the_ball 5000 1 // Girls at ball
				flag_prossie8_at_ball = 1
			ENDIF

			IF flag_prossie8_told_to_go_into_ball = 1
			
				IF flag_prossie8_at_ball = 0

					IF flag_timer_prossie8_lm5 = 0
						timerb = 0
						flag_timer_prossie8_lm5 = 1
					ENDIF

					IF timerb > 20000
						SET_CHAR_COORDINATES prossie8_lm5 999.0 -891.0 14.3
					ENDIF
					
				ENDIF
				
			ENDIF  

		ENDIF

ENDIF

	      		
ENDWHILE

// pass or fail checks

IF  counter_no_of_girls_at_the_ball < 4
	PRINT_NOW ( OUTTIME ) 5000 1 //"You ran out of time!"
	GOTO mission_luigi5_failed
ELSE
	GOTO mission_luigi5_passed
ENDIF
	   		


// Mission Luigi1 failed

mission_luigi5_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN
		
		
// mission Luigi1 passed

mission_luigi5_passed:

FREEZE_ONSCREEN_TIMER TRUE

GOSUB mission_end_cutscene

IF counter_girls_trying_to_get_to_ball > 0
	REMOVE_SPHERE sphere_lm5
	SWITCH_WIDESCREEN ON
	SET_PLAYER_CONTROL player OFF
	SET_POLICE_IGNORE_PLAYER player ON
	SET_EVERYONE_IGNORE_PLAYER player ON
	CLEAR_AREA 1006.845 -885.5 14.7 2.0 TRUE 
	SET_FIXED_CAMERA_POSITION 1006.845 -885.5 14.7 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT 1005.9 -885.0 14.6 JUMP_CUT
	GOSUB mission_end_cutscene2
	SWITCH_WIDESCREEN OFF
	RESTORE_CAMERA_JUMPCUT
	SET_PLAYER_CONTROL player ON
	SET_POLICE_IGNORE_PLAYER player OFF
	SET_EVERYONE_IGNORE_PLAYER player OFF
ENDIF 

flag_luigi_mission5_passed = 1
flag_all_luigi_missions_passed = 1
REGISTER_MISSION_PASSED ( LM5 )
PLAYER_MADE_PROGRESS 1
PLAY_MISSION_PASSED_TUNE 1												 
score_lm5 = counter_no_of_girls_at_the_ball * 500
PRINT_WITH_NUMBER_BIG ( M_PASS ) score_lm5 10000 1 //"Mission Passed!"
ADD_SCORE player score_lm5
CLEAR_WANTED_LEVEL player
IF counter_no_of_girls_at_the_ball = 8
	PRINT_WITH_NUMBER_NOW ( BONUS ) 2000 5000 1 //"Bonus of $2000!" 
	ADD_SCORE player 2000
ENDIF
REMOVE_BLIP luigi_contact_blip
RETURN		
		


// mission cleanup

mission_cleanup_luigi5:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_luigi_mission = 0
SWITCH_CAR_GENERATOR gen_car28 101
REMOVE_SOUND ball_sounds
REMOVE_SPHERE sphere_lm5
MARK_OBJECT_AS_NO_LONGER_NEEDED fuzzball_sign 
MARK_MODEL_AS_NO_LONGER_NEEDED PED_PROSTITUTE
MARK_MODEL_AS_NO_LONGER_NEEDED PED_PROSTITUTE2
CLEAR_ONSCREEN_TIMER timer_lm5
FREEZE_ONSCREEN_TIMER FALSE
CLEAR_ONSCREEN_COUNTER counter_no_of_girls_at_the_ball 
REMOVE_BLIP radar_blip_coord1_lm5
REMOVE_BLIP radarped_prossie1_lm5
REMOVE_BLIP radarped_prossie2_lm5
REMOVE_BLIP radarped_prossie3_lm5
REMOVE_BLIP radarped_prossie4_lm5
REMOVE_BLIP radarped_prossie5_lm5
REMOVE_BLIP radarped_prossie6_lm5
REMOVE_BLIP radarped_prossie7_lm5
REMOVE_BLIP radarped_prossie8_lm5
MISSION_HAS_FINISHED


START_NEW_SCRIPT close_fuzz_doors	

RETURN

check_for_dead_prossies:


number_of_dead_prossies = 0

	IF flag_prossie1_at_ball = 0 
		IF IS_CHAR_DEAD prossie1_lm5
			number_of_dead_prossies++
		ENDIF
	ENDIF

	IF flag_prossie2_at_ball = 0
		IF IS_CHAR_DEAD prossie2_lm5
			number_of_dead_prossies++
		ENDIF
	ENDIF
	
	IF flag_prossie3_at_ball = 0
		IF IS_CHAR_DEAD prossie3_lm5
			number_of_dead_prossies++
		ENDIF
	ENDIF

	IF flag_prossie4_at_ball = 0
		IF IS_CHAR_DEAD prossie4_lm5
			number_of_dead_prossies++
		ENDIF
	ENDIF


	IF flag_prossie5_at_ball = 0
		IF IS_CHAR_DEAD prossie5_lm5
			number_of_dead_prossies++
		ENDIF
	ENDIF

	IF flag_prossie6_at_ball = 0
		IF IS_CHAR_DEAD prossie6_lm5
			number_of_dead_prossies++
		ENDIF
	ENDIF

	IF flag_prossie7_at_ball = 0
		IF IS_CHAR_DEAD prossie7_lm5
			number_of_dead_prossies++
		ENDIF
	ENDIF

	IF flag_prossie8_at_ball = 0
		IF IS_CHAR_DEAD prossie8_lm5
			number_of_dead_prossies++
		ENDIF
	ENDIF

RETURN

check_for_luigi5_achievement:
	IF NOT IS_CAR_DEAD vehicle_lm5
		GET_NUMBER_OF_PASSENGERS vehicle_lm5 no_of_passengers_lm5
		IF no_of_passengers_lm5 = 8
			USE_TEXT_COMMANDS 100 // HACKED achievement unlock // GOT_THIS_FIGURED_OUT
		ENDIF
	ENDIF
RETURN

mission_end_cutscene:

	IF flag_prossie1_at_ball = 0

		IF flag_prossie1_in_car_park = 1

			IF NOT IS_CHAR_DEAD prossie1_lm5 
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie1_lm5 999.0 -891.0
				++ counter_girls_trying_to_get_to_ball
			ENDIF

		ENDIF

	ENDIF

	IF flag_prossie2_at_ball = 0
		
		 IF flag_prossie2_in_car_park = 1

			IF NOT IS_CHAR_DEAD prossie2_lm5 
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie2_lm5 999.0 -891.0
				++ counter_girls_trying_to_get_to_ball
			ENDIF

		ENDIF

	ENDIF

	IF flag_prossie3_at_ball = 0

		IF flag_prossie3_in_car_park = 1

			IF NOT IS_CHAR_DEAD prossie3_lm5 
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie3_lm5 999.0 -891.0
				++ counter_girls_trying_to_get_to_ball
			ENDIF

		ENDIF

	ENDIF

	IF flag_prossie4_at_ball = 0

		IF flag_prossie4_in_car_park = 1

			IF NOT IS_CHAR_DEAD prossie4_lm5 
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie4_lm5 999.0 -891.0
				++ counter_girls_trying_to_get_to_ball
			ENDIF

		ENDIF

	ENDIF

	IF flag_prossie5_at_ball = 0

		IF flag_prossie5_in_car_park = 1

			IF NOT IS_CHAR_DEAD prossie5_lm5 
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie5_lm5 999.0 -891.0
				++ counter_girls_trying_to_get_to_ball
			ENDIF

		ENDIF

	ENDIF

	IF flag_prossie6_at_ball = 0

		IF flag_prossie6_in_car_park = 1

			IF NOT IS_CHAR_DEAD prossie6_lm5 
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie6_lm5 999.0 -891.0
				++ counter_girls_trying_to_get_to_ball
			ENDIF

		ENDIF

	ENDIF

	IF flag_prossie7_at_ball = 0

		IF flag_prossie7_in_car_park = 1

			IF NOT IS_CHAR_DEAD prossie7_lm5 
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie7_lm5 999.0 -891.0
				++ counter_girls_trying_to_get_to_ball
			ENDIF

		ENDIF

	ENDIF

	IF flag_prossie8_at_ball = 0

		IF flag_prossie8_in_car_park = 1

			IF NOT IS_CHAR_DEAD prossie8_lm5 
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT prossie8_lm5 999.0 -891.0
				++ counter_girls_trying_to_get_to_ball
			ENDIF

		ENDIF

	ENDIF


RETURN


mission_end_cutscene2:

timerb = 0

WHILE counter_girls_trying_to_get_to_ball > 0

	WAIT 0

	CLEAR_AREA 1000.4 -886.7 14.4 6.0 FALSE // This should clear the area
	
	IF flag_prossie1_at_ball = 0

			IF NOT IS_CHAR_DEAD prossie1_lm5
						
				IF timerb > 20000
					SET_CHAR_COORDINATES prossie1_lm5 999.0 -891.0 14.3
				ENDIF   
		
				IF LOCATE_CHAR_ON_FOOT_2D prossie1_lm5 999.0 -891.0 1.0 1.0 FALSE
					CHAR_SET_IDLE prossie1_lm5
					REMOVE_CHAR_ELEGANTLY prossie1_lm5
					-- counter_girls_trying_to_get_to_ball
					flag_prossie1_at_ball = 1
				ENDIF

			ELSE
				-- counter_girls_trying_to_get_to_ball
				flag_prossie1_at_ball = 1
			ENDIF
				
		ENDIF

		IF flag_prossie2_at_ball = 0

			IF NOT IS_CHAR_DEAD prossie2_lm5
			
				IF timerb > 20000
					SET_CHAR_COORDINATES prossie2_lm5 999.0 -891.0 14.3
				ENDIF 
		
				IF LOCATE_CHAR_ON_FOOT_2D prossie2_lm5 999.0 -891.0 1.0 1.0 FALSE
					CHAR_SET_IDLE prossie2_lm5
					REMOVE_CHAR_ELEGANTLY prossie2_lm5
					-- counter_girls_trying_to_get_to_ball
					flag_prossie2_at_ball = 1
				ENDIF

			ELSE
				-- counter_girls_trying_to_get_to_ball
				flag_prossie2_at_ball = 1
			ENDIF
				
		ENDIF

		IF flag_prossie3_at_ball = 0

			IF NOT IS_CHAR_DEAD prossie3_lm5
			
				IF timerb > 20000
					SET_CHAR_COORDINATES prossie3_lm5 999.0 -891.0 14.3
				ENDIF 
		
				IF LOCATE_CHAR_ON_FOOT_2D prossie3_lm5 999.0 -891.0 1.0 1.0 FALSE
					CHAR_SET_IDLE prossie3_lm5
					REMOVE_CHAR_ELEGANTLY prossie3_lm5
					-- counter_girls_trying_to_get_to_ball
					flag_prossie3_at_ball = 1
				ENDIF

			ELSE
				-- counter_girls_trying_to_get_to_ball
				flag_prossie3_at_ball = 1
			ENDIF
				
		ENDIF

		IF flag_prossie4_at_ball = 0

			IF NOT IS_CHAR_DEAD prossie4_lm5
			
				IF timerb > 20000
					SET_CHAR_COORDINATES prossie4_lm5 999.0 -891.0 14.3
				ENDIF 
		
				IF LOCATE_CHAR_ON_FOOT_2D prossie4_lm5 999.0 -891.0 1.0 1.0 FALSE
					CHAR_SET_IDLE prossie4_lm5
					REMOVE_CHAR_ELEGANTLY prossie4_lm5
					-- counter_girls_trying_to_get_to_ball
					flag_prossie4_at_ball = 1
				ENDIF

			ELSE
				-- counter_girls_trying_to_get_to_ball
				flag_prossie4_at_ball = 1
			ENDIF
				
		ENDIF

		IF flag_prossie5_at_ball = 0

			IF NOT IS_CHAR_DEAD prossie5_lm5
			
				IF timerb > 20000
					SET_CHAR_COORDINATES prossie5_lm5 999.0 -891.0 14.3
				ENDIF 
		
				IF LOCATE_CHAR_ON_FOOT_2D prossie5_lm5 999.0 -891.0 1.0 1.0 FALSE
					CHAR_SET_IDLE prossie5_lm5
					REMOVE_CHAR_ELEGANTLY prossie5_lm5
					-- counter_girls_trying_to_get_to_ball
					flag_prossie5_at_ball = 1
				ENDIF

			ELSE
				-- counter_girls_trying_to_get_to_ball
				flag_prossie5_at_ball = 1
			ENDIF
				
		ENDIF

		IF flag_prossie6_at_ball = 0

			IF NOT IS_CHAR_DEAD prossie6_lm5
			
				IF timerb > 20000
					SET_CHAR_COORDINATES prossie6_lm5 999.0 -891.0 14.3
				ENDIF 
		
				IF LOCATE_CHAR_ON_FOOT_2D prossie6_lm5 999.0 -891.0 1.0 1.0 FALSE
					CHAR_SET_IDLE prossie6_lm5
					REMOVE_CHAR_ELEGANTLY prossie6_lm5
					-- counter_girls_trying_to_get_to_ball
					flag_prossie6_at_ball = 1
				ENDIF

			ELSE
				-- counter_girls_trying_to_get_to_ball
				flag_prossie6_at_ball = 1
			ENDIF
				
		ENDIF

		IF flag_prossie7_at_ball = 0

			IF NOT IS_CHAR_DEAD prossie7_lm5
			
				IF timerb > 20000
					SET_CHAR_COORDINATES prossie7_lm5 999.0 -891.0 14.3
				ENDIF 
		
				IF LOCATE_CHAR_ON_FOOT_2D prossie7_lm5 999.0 -891.0 1.0 1.0 FALSE
					CHAR_SET_IDLE prossie7_lm5
					REMOVE_CHAR_ELEGANTLY prossie7_lm5
					-- counter_girls_trying_to_get_to_ball
					flag_prossie7_at_ball = 1
				ENDIF

			ELSE
				-- counter_girls_trying_to_get_to_ball
				flag_prossie7_at_ball = 1
			ENDIF
				
		ENDIF

		IF flag_prossie8_at_ball = 0

			IF NOT IS_CHAR_DEAD prossie8_lm5
			
				IF timerb > 20000
					SET_CHAR_COORDINATES prossie8_lm5 999.0 -891.0 14.3
				ENDIF 
		
				IF LOCATE_CHAR_ON_FOOT_2D prossie8_lm5 999.0 -891.0 1.0 1.0 FALSE
					CHAR_SET_IDLE prossie8_lm5
					REMOVE_CHAR_ELEGANTLY prossie8_lm5
					-- counter_girls_trying_to_get_to_ball
					flag_prossie8_at_ball = 1
				ENDIF

			ELSE
				-- counter_girls_trying_to_get_to_ball
				flag_prossie8_at_ball = 1
			ENDIF
				
		ENDIF

ENDWHILE

RETURN

}
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Joey mission 1****************************************
// ************************************Kill Mike Lips*****************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff

GOSUB mission_start_joey1

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_joey1_failed
ENDIF

GOSUB mission_cleanup_joey1

MISSION_END


// Variables for mission

VAR_INT mike_car // mission specific ped

VAR_FLOAT mikes_car_heading	

VAR_INT blip1_jm1 blip2_jm1 blip3_jm1 blip4_jm1

VAR_INT flag_player_got_joey1_message flag_car_blip_displayed_jm1

VAR_INT flag_displayed_wanted_message_jm1

VAR_INT countdown_jm1 mission_passed_for_lips_finished
VAR_INT joey1_first_time_played joey1_car_was_damaged
joey1_first_time_played = 1
joey1_car_was_damaged = 0

// ***************************************Mission Start*************************************

mission_start_joey1:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_joey_mission = 1
mission_passed_for_lips_finished = 0
SCRIPT_NAME joey1
WAIT 0

flag_displayed_wanted_message_jm1 = 0

{

LOAD_SPECIAL_CHARACTER 1 joey
LOAD_SPECIAL_CHARACTER 2 misty
LOAD_SPECIAL_MODEL cut_obj1 JOEDOOR
LOAD_SPECIAL_MODEL cut_obj2 JOEYH
LOAD_SPECIAL_MODEL cut_obj3 PLAYERH
LOAD_SPECIAL_MODEL cut_obj4 MISTYH
REQUEST_MODEL CAR_IDAHO
REQUEST_MODEL jogarageext
REQUEST_MODEL jogarageint


LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED jogarageext 
OR NOT HAS_MODEL_LOADED jogarageint
	WAIT 0
ENDWHILE

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED CAR_IDAHO
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj4
	WAIT 0

ENDWHILE

LOAD_CUTSCENE J1_LFL
SET_CUTSCENE_OFFSET 1190.079 -869.861 13.977

CREATE_CAR CAR_IDAHO 1182.5 -857.0 14.1 cut_car2_lm3
SET_CAR_HEADING cut_car2_lm3 291.2

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_joey
SET_CUTSCENE_ANIM cs_joey joey

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_misty
SET_CUTSCENE_ANIM cs_misty misty

CREATE_CUTSCENE_HEAD cs_joey CUT_OBJ2 cs_joeyhead
SET_CUTSCENE_HEAD_ANIM cs_joeyhead joey

CREATE_CUTSCENE_HEAD cs_misty CUT_OBJ4 cs_mistyhead
SET_CUTSCENE_HEAD_ANIM cs_mistyhead misty

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ3 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj1 cs_joedoor
SET_CUTSCENE_ANIM cs_joedoor JOEDOOR
									   	
SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door1 FALSE
SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door2 FALSE

CLEAR_AREA 1191.9 -870.4 15.0 1.0 TRUE
SET_PLAYER_COORDINATES player 1191.9 -870.4 -100.0

SET_PLAYER_HEADING player 230.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time


WHILE cs_time < 433
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM1_A ) 10000 2 // Mission brief

WHILE cs_time < 2739
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM1_B ) 10000 2 // Mission brief

WHILE cs_time < 6344
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM1_C ) 10000 2 // Mission brief

WHILE cs_time < 8362
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM1_D ) 10000 2 // Mission brief

WHILE cs_time < 10700
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM1_E ) 10000 2 // Mission brief

WHILE cs_time < 12688
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM1_F ) 10000 2 // Mission brief

WHILE cs_time < 15858
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM1_G ) 10000 2 // Mission brief

WHILE cs_time < 19969
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM1_H ) 10000 2 // Mission brief

WHILE cs_time < 21519
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM1_I ) 3000 2 // Mission brief

WHILE cs_time < 24979
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM1_J ) 10000 2 // Mission brief

WHILE cs_time < 27466
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM1_K ) 10000 2 // Mission brief

WHILE cs_time < 29204
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 30000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door1 TRUE
SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door2 TRUE
SET_CAMERA_IN_FRONT_OF_PLAYER

ADD_SPRITE_BLIP_FOR_COORD 1282.0 -104.0 -100.0 RADAR_SPRITE_BOMB blip2_jm1
ADD_SPRITE_BLIP_FOR_COORD 925.0 -359.5 -100.0 RADAR_SPRITE_SPRAY blip4_jm1
ADD_BLIP_FOR_COORD 1335.0 -455.0 -100.0 blip3_jm1
REMOVE_BLIP	blip2_jm1
REMOVE_BLIP	blip3_jm1
REMOVE_BLIP	blip4_jm1

WAIT 500

DO_FADE 1500 FADE_IN


UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ4
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_IDAHO
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageext 
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageint

DELETE_CAR cut_car2_lm3
	

// START OF MISSION

LOAD_SPECIAL_CHARACTER 3 lips
REQUEST_MODEL CAR_IDAHO

	WHILE NOT HAS_MODEL_LOADED CAR_IDAHO
	OR NOT HAS_SPECIAL_CHARACTER_LOADED 3
		WAIT 0

	ENDWHILE

IF timer_help_message_displayed	= 0
	PRINT_HELP ( TIMER )
	timer_help_message_displayed = 1
ENDIF

CREATE_CAR CAR_IDAHO 1336.2 -460.8 -100.0 mike_car
MAKE_CRAIGS_CAR_A_BIT_STRONGER mike_car TRUE
LOCK_CAR_DOORS mike_car CARLOCK_FORCE_SHUT_DOORS
SET_CAR_HEADING mike_car 90.0
SET_CAN_RESPRAY_CAR mike_car OFF
ADD_BLIP_FOR_CAR mike_car blip1_jm1
countdown_jm1 = 361000
DISPLAY_ONSCREEN_TIMER countdown_jm1


	IF IS_CAR_DEAD mike_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey1_failed
	ENDIF


WHILE NOT IS_PLAYER_IN_CAR player mike_car
	WAIT 0

	IF IS_CAR_DEAD mike_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey1_failed
	ENDIF
   
	IF IS_CAR_UPSIDEDOWN mike_car
	AND IS_CAR_STOPPED mike_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey1_failed
	ENDIF
		
	IF countdown_jm1 = 0
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_joey1_failed
	ENDIF

ENDWHILE 


PRINT_NOW ( JM1_1 ) 5000 1 //"Go to 8 Balls"

SET_FREE_BOMBS On


Go_to_8Balls:

flag_car_blip_displayed_jm1 = TRUE

WHILE NOT IS_CAR_ARMED_WITH_BOMB mike_car CARBOMB_ONIGNITION
AND NOT IS_CAR_ARMED_WITH_BOMB mike_car CARBOMB_ONIGNITIONACTIVE
	WAIT 0

	IF IS_CAR_DEAD mike_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey1_failed
	ENDIF
   
	IF IS_CAR_UPSIDEDOWN mike_car
	AND IS_CAR_STOPPED mike_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey1_failed
	ENDIF
		
	IF countdown_jm1 = 0
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_joey1_failed
	ENDIF
   
	IF IS_PLAYER_IN_CAR player mike_car
		IF flag_car_blip_displayed_jm1 = TRUE
			IF NOT IS_CAR_ARMED_WITH_BOMB mike_car CARBOMB_ONIGNITIONACTIVE
			OR NOT IS_CAR_ARMED_WITH_BOMB mike_car CARBOMB_ONIGNITION
				REMOVE_BLIP blip2_jm1
				ADD_SPRITE_BLIP_FOR_COORD 1282.0 -104.0 -100.0 RADAR_SPRITE_BOMB blip2_jm1
				REMOVE_BLIP blip1_jm1
			ENDIF
		flag_car_blip_displayed_jm1 = FALSE
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player mike_car
		IF flag_car_blip_displayed_jm1 = FALSE
		ADD_BLIP_FOR_CAR mike_car blip1_jm1
		REMOVE_BLIP blip2_jm1
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the car!"
		flag_car_blip_displayed_jm1 = TRUE
		ENDIF
	ENDIF
	
	IF NOT IS_CAR_HEALTH_GREATER mike_car 700
	OR IS_CAR_VISIBLY_DAMAGED mike_car
		joey1_car_was_damaged = 1

		
		DISPLAY_RADAR 6 // PATHING PAY N SPRAY

		PRINT_SOON ( JM1_4 ) 5000 2 //Repair the car!
			REMOVE_BLIP blip1_jm1
			ADD_BLIP_FOR_CAR mike_car blip1_jm1
			CHANGE_BLIP_DISPLAY blip1_jm1 BLIP_ONLY
			flag_car_blip_displayed_jm1 = TRUE

				WHILE IS_CAR_VISIBLY_DAMAGED mike_car
					WAIT 0 

					IF IS_CAR_DEAD mike_car
						PRINT_NOW ( WRECKED ) 5000 1
						GOTO mission_joey1_failed
					ENDIF
				   
					IF IS_CAR_ARMED_WITH_BOMB mike_car CARBOMB_ONIGNITIONACTIVE
					OR IS_CAR_ARMED_WITH_BOMB mike_car CARBOMB_ONIGNITION
						REMOVE_BLIP blip2_jm1
					ENDIF

					IF IS_CAR_UPSIDEDOWN mike_car
					AND IS_CAR_STOPPED mike_car
						PRINT_NOW ( WRECKED ) 5000 1
						GOTO mission_joey1_failed
					ENDIF
						
					IF countdown_jm1 = 0
						PRINT_NOW ( OUTTIME ) 5000 1
						GOTO mission_joey1_failed
					ENDIF

					IF IS_PLAYER_IN_CAR player mike_car
						IF flag_car_blip_displayed_jm1 = TRUE
							REMOVE_BLIP blip2_jm1
							REMOVE_BLIP	blip4_jm1
							ADD_SPRITE_BLIP_FOR_COORD 925.0 -359.5 -100.0 RADAR_SPRITE_SPRAY blip4_jm1
							REMOVE_BLIP blip1_jm1
						flag_car_blip_displayed_jm1 = FALSE
						ENDIF
					ENDIF

					IF NOT IS_PLAYER_IN_CAR player mike_car
						IF flag_car_blip_displayed_jm1 = FALSE
						ADD_BLIP_FOR_CAR mike_car blip1_jm1
						REMOVE_BLIP blip4_jm1
						PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the car!"
						flag_car_blip_displayed_jm1 = TRUE
						ENDIF
					ENDIF

				ENDWHILE

			ADD_SPRITE_BLIP_FOR_COORD 1282.0 -104.0 -100.0 RADAR_SPRITE_BOMB blip2_jm1
			REMOVE_BLIP blip4_jm1
			GOTO Go_to_8Balls
	ELSE
		DISPLAY_RADAR 3 // PATHING ON
	ENDIF

ENDWHILE

	WAIT 4000

	PRINT_NOW ( jm1_2 ) 5000 2 // Car rigged
	REMOVE_BLIP blip1_jm1
	REMOVE_BLIP blip2_jm1
	REMOVE_BLIP blip4_jm1

one_before_joey_label1:

	SET_FREE_BOMBS Off

joey_label1: //Drop the car back at the bistro

WAIT 0
flag_car_blip_displayed_jm1 = TRUE

	IF IS_CAR_DEAD mike_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey1_failed
	ENDIF

blob_flag = 1

WHILE NOT IS_CAR_STOPPED_IN_AREA_3D mike_car 1339.6 -459.5 49.0 1332.8 -462.8 53.0 blob_flag
OR IS_WANTED_LEVEL_GREATER Player 0
//OR IS_CAR_VISIBLY_DAMAGED mike_car
	WAIT 0

	IF IS_CAR_DEAD mike_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey1_failed
	ENDIF
   
	IF IS_CAR_UPSIDEDOWN mike_car
	AND IS_CAR_STOPPED mike_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey1_failed
	ENDIF
		
	IF countdown_jm1 = 0
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_joey1_failed
	ENDIF

	IF IS_PLAYER_IN_CAR player mike_car
		IF flag_car_blip_displayed_jm1 = TRUE
			REMOVE_BLIP	blip3_jm1
			ADD_BLIP_FOR_COORD 1336.15 -461.12 -100.0 blip3_jm1
			REMOVE_BLIP blip1_jm1
			blob_flag = 1
		flag_car_blip_displayed_jm1 = FALSE
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player mike_car
		IF flag_car_blip_displayed_jm1 = FALSE
		ADD_BLIP_FOR_CAR mike_car blip1_jm1
		REMOVE_BLIP blip3_jm1
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the car!"
		blob_flag = 0
		flag_car_blip_displayed_jm1 = TRUE
		ENDIF
	ENDIF

	IF NOT IS_CAR_HEALTH_GREATER mike_car 700
	OR IS_CAR_VISIBLY_DAMAGED mike_car
		joey1_car_was_damaged = 1

		DISPLAY_RADAR 6 // PATHING PAY N SPRAY

		PRINT_SOON ( JM1_4 ) 5000 2 //Repair the car!
		REMOVE_BLIP blip3_jm1
		REMOVE_BLIP blip1_jm1
		ADD_BLIP_FOR_CAR mike_car blip1_jm1
		CHANGE_BLIP_DISPLAY blip1_jm1 BLIP_ONLY
		flag_car_blip_displayed_jm1 = TRUE

			WHILE IS_CAR_VISIBLY_DAMAGED mike_car
				WAIT 0 

				IF IS_CAR_DEAD mike_car
					PRINT_NOW ( WRECKED ) 5000 1
					GOTO mission_joey1_failed
				ENDIF
			   
				IF IS_CAR_UPSIDEDOWN mike_car
				AND IS_CAR_STOPPED mike_car
					PRINT_NOW ( WRECKED ) 5000 1
					GOTO mission_joey1_failed
				ENDIF
					
				IF countdown_jm1 = 0
					PRINT_NOW ( OUTTIME ) 5000 1
					GOTO mission_joey1_failed
				ENDIF

				IF IS_PLAYER_IN_CAR player mike_car
					IF flag_car_blip_displayed_jm1 = TRUE
						REMOVE_BLIP	blip4_jm1
						ADD_SPRITE_BLIP_FOR_COORD 925.0 -359.5 -100.0 RADAR_SPRITE_SPRAY blip4_jm1
						REMOVE_BLIP blip1_jm1
						blob_flag = 1
					flag_car_blip_displayed_jm1 = FALSE
					ENDIF
				ENDIF

				IF NOT IS_PLAYER_IN_CAR player mike_car
					IF flag_car_blip_displayed_jm1 = FALSE
					ADD_BLIP_FOR_CAR mike_car blip1_jm1
					REMOVE_BLIP blip4_jm1
					PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the car!"
					blob_flag = 0
					flag_car_blip_displayed_jm1 = TRUE
					ENDIF
				ENDIF

			ENDWHILE

		REMOVE_BLIP blip4_jm1
		GOTO joey_label1
	ELSE
		DISPLAY_RADAR 3 // PATHING ON
	ENDIF

	IF IS_PLAYER_IN_AREA_IN_CAR_3D player 1339.6 -459.5 49.0 1332.8 -462.8 53.0 FALSE
		IF IS_WANTED_LEVEL_GREATER player 0
			IF flag_displayed_wanted_message_jm1 = 0
				PRINT_NOW ( WANTED1 ) 4000 1
				flag_displayed_wanted_message_jm1 = 1
			ENDIF
		ENDIF
	ELSE
		IF NOT IS_PLAYER_IN_AREA_3D player 1339.6 -459.5 49.0 1332.8 -462.8 53.0 FALSE
			flag_displayed_wanted_message_jm1 = 0
		ENDIF
	ENDIF

ENDWHILE


REMOVE_BLIP blip1_jm1
REMOVE_BLIP blip2_jm1
REMOVE_BLIP blip3_jm1
REMOVE_BLIP blip4_jm1

IF countdown_jm1 = 0
	PRINT_NOW ( OUTTIME ) 5000 1
	GOTO mission_joey1_failed
ENDIF

IF NOT IS_CAR_DEAD mike_car

	GET_CAR_HEADING mike_car mikes_car_heading
	IF mikes_car_heading > 100.0
	OR mikes_car_heading < 80.0
		PRINT_NOW ( JM1_6 ) 5000 1 //Put the car back in the correct position
		GOTO joey_label1
	ELSE
		IF IS_PLAYER_IN_CAR	player mike_car
			PRINT_NOW ( JM1_3 ) 5000 2 //Activate the car bomb then get out of there!
		ENDIF
	ENDIF 
ENDIF

cars_rigged:
WAIT 0

	IF IS_CAR_DEAD mike_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey1_failed
	ENDIF


WHILE NOT IS_CAR_STOPPED_IN_AREA_3D mike_car 1339.6 -459.5 49.0 1332.8 -462.8 53.0 TRUE
OR IS_PLAYER_IN_AREA_3D player 1306.0 -482.0 49.0 1350.0 -444.0 59.0 FALSE
OR NOT IS_PLAYER_IN_AREA_3D player 1306.0 -484.0 49.0 1370.0 -434.0 69.0 FALSE 

	WAIT 0

	IF IS_CAR_DEAD mike_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey1_failed
	ENDIF
   
	IF IS_CAR_UPSIDEDOWN mike_car
	AND IS_CAR_STOPPED mike_car		
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey1_failed
	ENDIF
		
	IF countdown_jm1 = 0
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_joey1_failed
	ENDIF

	IF NOT IS_CAR_IN_AREA_3D mike_car 1339.6 -459.5 49.0 1332.8 -462.8 53.0 FALSE
		PRINT_NOW ( JM1_6 ) 5000 1
		GOTO joey_label1
	ENDIF

	GET_CAR_HEADING mike_car mikes_car_heading
	IF mikes_car_heading > 100.0
	OR mikes_car_heading < 80.0
		PRINT_NOW ( JM1_6 ) 5000 1
		GOTO joey_label1
	ENDIF 

	IF NOT IS_CAR_HEALTH_GREATER mike_car 700
	OR IS_CAR_VISIBLY_DAMAGED mike_car
		GOTO joey_label1
	ENDIF

ENDWHILE


	IF countdown_jm1 = 0
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_joey1_failed
	ENDIF

	IF NOT IS_CAR_ARMED_WITH_BOMB mike_car CARBOMB_ONIGNITIONACTIVE
 		PRINT_NOW ( JM1_5 ) 5000 1 // The vehicle bomb's not set!
		GOTO cars_rigged
	ENDIF
	


//LIPS CUT_SCENE

CLEAR_AREA 1325.5 -452.5 54.0 4.0 TRUE
CLEAR_AREA 1328.4 -453.0 54.0 4.0 TRUE
CLEAR_AREA 1330.0 -466.1 49.0 4.0 TRUE
CLEAR_AREA 1333.6 -465.3 49.0 4.0 TRUE

CLEAR_ONSCREEN_TIMER countdown_jm1
SET_POLICE_IGNORE_PLAYER Player On
SET_PLAYER_CONTROL Player Off
SWITCH_WIDESCREEN ON


CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL3 1325.5 -452.5 -100.0 lips
SET_CHAR_HEADING lips 270.0
 
SET_FIXED_CAMERA_POSITION 1337.814 -468.631 49.774 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 1337.053 -468.016 49.982 JUMP_CUT

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT lips 1328.4 -453.0

IF IS_CHAR_DEAD lips
	GOTO mission_joey1_passed
ENDIF

TIMERB = 0

IF NOT IS_CHAR_DEAD lips

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED lips
		WAIT 0
		
			IF IS_CAR_DEAD mike_car
				PRINT_NOW ( WRECKED ) 5000 1
				GOTO mission_joey1_failed
			ENDIF
		   
			IF IS_CAR_UPSIDEDOWN mike_car
			AND IS_CAR_STOPPED mike_car
				PRINT_NOW ( WRECKED ) 5000 1
				GOTO mission_joey1_failed
			ENDIF

			IF IS_CHAR_DEAD lips
				GOTO mission_joey1_passed
			ENDIF
	
			IF TIMERB > 10000
				IF NOT IS_CHAR_DEAD	lips
					SET_CHAR_COORDINATES lips 1328.4 -453.0 -100.0
				ENDIF
			ENDIF

	ENDWHILE

ENDIF


TIMERB = 0

IF NOT IS_CHAR_DEAD lips
	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT lips 1330.0 -466.1
ENDIF

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED lips
		WAIT 0
		
			IF IS_CAR_DEAD mike_car
				PRINT_NOW ( WRECKED ) 5000 1
				GOTO mission_joey1_failed
			ENDIF
		   
			IF IS_CAR_UPSIDEDOWN mike_car
			AND IS_CAR_STOPPED mike_car
				PRINT_NOW ( WRECKED ) 5000 1
				GOTO mission_joey1_failed
			ENDIF

			IF IS_CHAR_DEAD lips
				GOTO mission_joey1_passed
			ENDIF

			IF TIMERB > 10000
				IF NOT IS_CHAR_DEAD	lips
					SET_CHAR_COORDINATES lips 1330.0 -466.1 -100.0
				ENDIF
			ENDIF
				
	ENDWHILE


TIMERB = 0

IF NOT IS_CHAR_DEAD lips
	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT lips 1333.6 -465.3
ENDIF

SET_FIXED_CAMERA_POSITION 1344.8 -471.2 54.0 0.0 0.0 0.0

	IF NOT IS_CAR_DEAD mike_car
		POINT_CAMERA_AT_CAR mike_car FIXED JUMP_CUT	
	ENDIF

IF NOT IS_CHAR_DEAD lips

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED lips
		WAIT 0
		
			IF IS_CAR_DEAD mike_car
				PRINT_NOW ( WRECKED ) 5000 1
				GOTO mission_joey1_failed
			ENDIF
		   
			IF IS_CAR_UPSIDEDOWN mike_car
			AND IS_CAR_STOPPED mike_car
				PRINT_NOW ( WRECKED ) 5000 1
				GOTO mission_joey1_failed
			ENDIF

			IF IS_CHAR_DEAD lips
				GOTO mission_joey1_passed
			ENDIF

			IF TIMERB > 10000
				IF NOT IS_CHAR_DEAD	lips
					SET_CHAR_COORDINATES lips 1333.6 -465.3 -100.0
				ENDIF
			ENDIF
	
	ENDWHILE

ENDIF

IF NOT IS_CHAR_DEAD lips
AND	NOT IS_CAR_DEAD mike_car
	SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER lips mike_car
ENDIF

	WHILE NOT IS_CHAR_IN_CAR lips mike_car
		WAIT 0

			IF IS_CAR_DEAD mike_car
				PRINT_NOW ( WRECKED ) 5000 1
				GOTO mission_joey1_failed
			ENDIF
		   
			IF IS_CAR_UPSIDEDOWN mike_car
			AND IS_CAR_STOPPED mike_car
				PRINT_NOW ( WRECKED ) 5000 1
				GOTO mission_joey1_failed
			ENDIF

			IF IS_CHAR_DEAD lips
				GOTO mission_joey1_passed
			ENDIF

	ENDWHILE

SET_ALL_CARS_CAN_BE_DAMAGED TRUE

WAIT 2500
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
ADD_SCORE player 10000
mission_passed_for_lips_finished = 1
WAIT 5000

SET_PLAYER_CONTROL Player On
SWITCH_WIDESCREEN OFF
SET_POLICE_IGNORE_PLAYER Player Off

}

GOTO mission_joey1_passed

IF joey1_car_was_damaged = 0
AND joey1_first_time_played = 1
	USE_TEXT_COMMANDS 94 // HACKED achievement unlock // WITHOUT_A_SCRATCH
ENDIF

 // Mission joey1 failed

mission_joey1_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
DISPLAY_RADAR 3 // PATHING ON
RETURN

   

// mission joey1 passed

mission_joey1_passed:

flag_joey_mission1_passed = 1

IF mission_passed_for_lips_finished	= 0
	PLAY_MISSION_PASSED_TUNE 1
	PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
	ADD_SCORE player 10000
	mission_passed_for_lips_finished = 1
ENDIF

REGISTER_MISSION_PASSED JM1
PLAYER_MADE_PROGRESS 1
REMOVE_CHAR_ELEGANTLY lips
START_NEW_SCRIPT joey_mission2_loop
RETURN
		


// mission cleanup

mission_cleanup_joey1:

DISPLAY_RADAR 3 // PATHING ON

joey1_first_time_played = 0

flag_player_on_mission = 0
flag_player_on_joey_mission = 0
REMOVE_BLIP blip1_jm1
REMOVE_BLIP blip2_jm1
REMOVE_BLIP blip3_jm1
REMOVE_BLIP blip4_jm1
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_IDAHO
UNLOAD_SPECIAL_CHARACTER 3
CLEAR_ONSCREEN_TIMER countdown_jm1
IF NOT IS_CAR_DEAD mike_car
	SET_CAN_RESPRAY_CAR mike_car ON
	LOCK_CAR_DOORS mike_car CARLOCK_UNLOCKED
	MAKE_CRAIGS_CAR_A_BIT_STRONGER mike_car FALSE
ENDIF
SET_FREE_BOMBS Off
MISSION_HAS_FINISHED
RETURN

MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Joey mission 2****************************************
// ************************************Kill Chunky Dave***************************************
// Farewell 'Chunky' Lee Chong
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff

GOSUB mission_start_joey2

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_joey2_failed
ENDIF

GOSUB mission_cleanup_joey2

MISSION_END


// Variables for mission


VAR_INT chunkys_car chunkys_car2// mission specific ped

VAR_INT blip1_jm2 blip2_jm2 //blip3_jm2 

VAR_INT chunky_mate1 chunky_mate2 chunky_mate3 

VAR_INT mate1health mate2health mate3health chunkyhealth

VAR_INT been_in_shop_before noodle_stand gun_chunky

VAR_INT flag_gun_message_jm2 has_audio_been_activated

//VAR_INT test_car_health_counter

//VAR_INT flag_player_got_joey2_message

VAR_INT joey2_armed_with_carbomb joey2_killed_by_carbomb


// ***************************************Mission Start*************************************

mission_start_joey2:

REGISTER_MISSION_GIVEN

// only objective is kill a ped, dont need pathing here
DISPLAY_RADAR 2 // PATHING OFF

flag_player_on_mission = 1
flag_player_on_joey_mission = 1
joey2_killed_by_carbomb = 0
joey2_armed_with_carbomb = 0
SCRIPT_NAME joey2
WAIT 0

flag_gun_message_jm2 = 0
has_audio_been_activated = 0

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_joey2_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

PRINT_BIG ( JM2 ) 15000 2 //"Joey Mission 2"
*/

{

LOAD_SPECIAL_CHARACTER 1 joey
LOAD_SPECIAL_MODEL cut_obj1 JOEYH
LOAD_SPECIAL_MODEL cut_obj2 PLAYERH
LOAD_SPECIAL_MODEL cut_obj3 TROLL
REQUEST_MODEL jogarageext
REQUEST_MODEL jogarageint

/*
WHILE GET_FADING_STATUS
	WAIT 0

ENDWHILE
*/

//LOAD_SCENE 1190.07 -869.86 13.97

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED	cut_obj3
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED jogarageext 
OR NOT HAS_MODEL_LOADED jogarageint
	WAIT 0
ENDWHILE

LOAD_CUTSCENE J2_KCL
SET_CUTSCENE_OFFSET 1190.079 -869.861 13.977

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_joey
SET_CUTSCENE_ANIM cs_joey joey

CREATE_CUTSCENE_HEAD cs_joey CUT_OBJ1 cs_joeyhead
SET_CUTSCENE_HEAD_ANIM cs_joeyhead joey

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT CUT_OBJ3 cs_troll
SET_CUTSCENE_ANIM cs_troll TROLL
									   	
//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door1 FALSE
//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door2 FALSE

CLEAR_AREA 1191.9 -870.4 15.0 1.0 TRUE
SET_PLAYER_COORDINATES player 1191.9 -870.4 -100.0

SET_PLAYER_HEADING player 230.0

DO_FADE 1500 FADE_IN

//SWITCH_WORLD_PROCESSING OFF
SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time


WHILE cs_time < 5118
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM2_A ) 10000 2 // Mission brief

WHILE cs_time < 10669
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM2_B ) 10000 2 // Mission brief

WHILE cs_time < 13048
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM2_C ) 10000 2 // Mission brief

WHILE cs_time < 15427
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM2_D ) 10000 2 // Mission brief

WHILE cs_time < 17662
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM2_E ) 10000 2 // Mission brief

WHILE cs_time < 18887
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM2_F ) 10000 2  // If you need a piece, go around back of AmmuNation opposite the subway.

WHILE cs_time < 22708
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM2_G ) 10000 2 // Mission brief

WHILE cs_time < 25159
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM2_H ) 10000 2 // Mission brief

WHILE cs_time < 28982
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 31000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

//SWITCH_WORLD_PROCESSING ON
SWITCH_RUBBISH ON
CLEAR_CUTSCENE
//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door1 TRUE
//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door2 TRUE
SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageext 
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageint

LOAD_SPECIAL_CHARACTER 2 chunky
REQUEST_MODEL PED_GANG_TRIAD_A
REQUEST_MODEL CAR_PERENNIAL

	WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 2
	OR NOT HAS_MODEL_LOADED PED_GANG_TRIAD_A
	OR NOT HAS_MODEL_LOADED CAR_PERENNIAL
		WAIT 0
	ENDWHILE

//ADD_BLIP_FOR_COORD 1080.0 -397.0 -100.0 blip2_jm2

CREATE_PICKUP_WITH_AMMO WEAPON_COLT45 PICKUP_ONCE 45 1080.5 -396.0 -100.0 gun_chunky
ADD_SPRITE_BLIP_FOR_PICKUP gun_chunky RADAR_SPRITE_WEAPON blip2_jm2

CREATE_OBJECT noodlesbox 975.0 -720.0 14.53 noodle_stand  


// START OF MISSION

CREATE_CAR CAR_PERENNIAL 1007.1 -756.4 14.5 chunkys_car
SET_CAR_HEADING chunkys_car 120.0
//LOCK_CAR_DOORS chunkys_car CARLOCK_LOCKOUT_PLAYER_ONLY

CREATE_CAR CAR_PERENNIAL 912.3 -686.1 14.5 chunkys_car2
SET_CAR_HEADING chunkys_car2 90.0
//LOCK_CAR_DOORS chunkys_car2 CARLOCK_LOCKOUT_PLAYER_ONLY

CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 976.1 -715.3 14.2 chunky_mate1
SET_CHAR_HEADING chunky_mate1 346.0
GIVE_WEAPON_TO_CHAR chunky_mate1 WEAPONTYPE_BASEBALLBAT 0
SET_CHAR_OBJ_GUARD_SPOT chunky_mate1 976.1 -715.3 14.2
SET_CHAR_PERSONALITY chunky_mate1 PEDSTAT_TOUGH_GUY

CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 975.7 -724.7 14.2 chunky_mate2
SET_CHAR_HEADING chunky_mate2 222.0
GIVE_WEAPON_TO_CHAR chunky_mate2 WEAPONTYPE_BASEBALLBAT 0
SET_CHAR_OBJ_GUARD_SPOT chunky_mate2 975.7 -724.7 14.2
SET_CHAR_PERSONALITY chunky_mate2 PEDSTAT_TOUGH_GUY

CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 984.0 -727.7 14.2 chunky_mate3
SET_CHAR_HEADING chunky_mate3 243.0
GIVE_WEAPON_TO_CHAR chunky_mate3 WEAPONTYPE_PISTOL 100
SET_CHAR_OBJ_GUARD_SPOT chunky_mate3 984.0 -727.7 14.2
SET_CHAR_PERSONALITY chunky_mate3 PEDSTAT_TOUGH_GUY

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 976.57 -720.3 14.2 chunky //GS-SC: Moving chong into the Punk Noodle stall
SET_CHAR_HEADING chunky 270.0
ADD_BLIP_FOR_CHAR chunky blip1_jm2
SET_CHAR_OBJ_WAIT_ON_FOOT chunky
SET_CHAR_PERSONALITY chunky PEDSTAT_GEEK_GUY
SET_CHAR_RUNNING chunky TRUE
//SET_CHAR_HEALTH chunky 100
ADD_ARMOUR_TO_CHAR chunky 100
CHANGE_BLIP_DISPLAY blip1_jm2 BLIP_ONLY
SET_ANIM_GROUP_FOR_CHAR chunky ANIM_PANIC_CHUNKYPED 

WHILE NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D Player chunky 25.0 26.0 4.0 FALSE
	WAIT 0
	
		IF NOT HAS_PICKUP_BEEN_COLLECTED gun_chunky
			GOSUB Ammu_bloke_audio
		ENDIF

		GOSUB controller_modes

		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF
		
		IF HAS_PICKUP_BEEN_COLLECTED gun_chunky  
		AND been_in_shop_before = 0 
			REMOVE_BLIP blip2_jm2
			been_in_shop_before = 1	
		ENDIF

		IF NOT IS_CHAR_DEAD chunky
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky True
			GET_CHAR_HEALTH	chunky chunkyhealth
		ENDIF
		IF NOT IS_CHAR_DEAD chunky_mate1
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky_mate1 True
			GET_CHAR_HEALTH chunky_mate1 mate1health
		ENDIF
		IF NOT IS_CHAR_DEAD	chunky_mate2
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky_mate2 True
			GET_CHAR_HEALTH chunky_mate2 mate2health
		ENDIF
		IF NOT IS_CHAR_DEAD	chunky_mate3
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky_mate3 True
			GET_CHAR_HEALTH chunky_mate3 mate3health
		ENDIF
		
		IF mate1health < 99
		OR mate2health < 99
		OR mate3health < 99
		OR chunkyhealth < 99
			GOTO kill_and_run
		ENDIF
	   	
	   	IF IS_CHAR_DEAD chunky_mate1
		OR IS_CHAR_DEAD chunky_mate2
		OR IS_CHAR_DEAD chunky_mate3
			GOTO kill_and_run
		ENDIF

ENDWHILE

SET_POLICE_IGNORE_PLAYER Player ON
SET_PLAYER_CONTROL Player OFF
SWITCH_WIDESCREEN ON
SET_PED_DENSITY_MULTIPLIER 0.0

//SET_FIXED_CAMERA_POSITION 977.756 -719.673 16.206 0.0 0.0 0.0
SET_FIXED_CAMERA_POSITION 984.819 -704.6 21.468 0.0 0.0 0.0 
POINT_CAMERA_AT_POINT 984.279 -705.429 21.202 JUMP_CUT

//IF NOT IS_CHAR_DEAD	chunky
//	POINT_CAMERA_AT_CHAR chunky FIXED JUMP_CUT
//ENDIF

WAIT 3000

SET_FIXED_CAMERA_POSITION 978.135 -718.497 15.642 0.0 0.0 0.0 
POINT_CAMERA_AT_POINT 977.293 -719.016 15.794 JUMP_CUT

//SET_FIXED_CAMERA_POSITION 984.1 -714.9 17.4 0.0 0.0 0.0 
//IF NOT IS_CHAR_DEAD	chunky
//	POINT_CAMERA_AT_CHAR chunky FIXED INTERPOLATION
//ENDIF

WAIT 3000

SET_PED_DENSITY_MULTIPLIER 1.0
SET_POLICE_IGNORE_PLAYER Player OFF
SET_PLAYER_CONTROL Player ON
SWITCH_WIDESCREEN OFF
RESTORE_CAMERA_JUMPCUT
//REMOVE_BLIP blip3_jm2

	IF IS_CHAR_DEAD chunky
		GOTO mission_joey2_passed
	ENDIF

WHILE NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D Player chunky 20.0 18.0 4.0 FALSE

	WAIT 0
	
		IF NOT HAS_PICKUP_BEEN_COLLECTED gun_chunky
			GOSUB Ammu_bloke_audio
		ENDIF

		GOSUB controller_modes

		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

		IF HAS_PICKUP_BEEN_COLLECTED gun_chunky  
		AND been_in_shop_before = 0 
			REMOVE_BLIP blip2_jm2
			been_in_shop_before = 1	
		ENDIF

		IF NOT IS_CHAR_DEAD chunky
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky True
			GET_CHAR_HEALTH	chunky chunkyhealth
		ENDIF
		IF NOT IS_CHAR_DEAD chunky_mate1
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky_mate1 True
			GET_CHAR_HEALTH chunky_mate1 mate1health
		ENDIF
		IF NOT IS_CHAR_DEAD	chunky_mate2
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky_mate2 True
			GET_CHAR_HEALTH chunky_mate2 mate2health
		ENDIF
		IF NOT IS_CHAR_DEAD	chunky_mate3
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky_mate3 True
			GET_CHAR_HEALTH chunky_mate3 mate3health
		ENDIF
		
		IF mate1health < 99
		OR mate2health < 99
		OR mate3health < 99
		OR chunkyhealth < 99
			GOTO kill_and_run
		ENDIF
 
		IF IS_CHAR_DEAD chunky_mate1
		OR IS_CHAR_DEAD chunky_mate2
		OR IS_CHAR_DEAD chunky_mate3
			GOTO kill_and_run
		ENDIF

ENDWHILE

kill_and_run:

//REMOVE_BLIP blip3_jm2

CHANGE_BLIP_DISPLAY blip1_jm2 BOTH

	IF NOT IS_CHAR_DEAD chunky_mate1
		SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT chunky_mate1 Player
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky_mate1 false
		SET_CHAR_THREAT_SEARCH chunky_mate1 THREAT_PLAYER1	
	ENDIF

	IF NOT IS_CHAR_DEAD chunky_mate2
		SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT chunky_mate2 Player
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky_mate2 false
		SET_CHAR_THREAT_SEARCH chunky_mate2 THREAT_PLAYER1
	ENDIF

	IF NOT IS_CHAR_DEAD chunky_mate3
		SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT chunky_mate3 Player
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky_mate3 false
		SET_CHAR_THREAT_SEARCH chunky_mate3 THREAT_PLAYER1
	ENDIF

	IF NOT IS_CHAR_DEAD chunky	
		SET_CHAR_HEED_THREATS chunky False
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER chunky false
	ENDIF

SET_CHAR_OBJ_RUN_TO_COORD chunky 975.5 -722.9

TIMERB = 0

WHILE NOT IS_CHAR_OBJECTIVE_PASSED chunky
	WAIT 0

		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

		GOSUB pickup_and_audio

ENDWHILE


IF IS_PLAYER_IN_AREA_2D	player 974.2 -727.5	1003.4 -748.8 FALSE
	GOTO run_the_other_way
ENDIF


SET_CHAR_OBJ_RUN_TO_COORD chunky 985.1 -733.9

WHILE NOT IS_CHAR_OBJECTIVE_PASSED chunky
	WAIT 0

		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

		GOSUB pickup_and_audio

ENDWHILE

SET_CHAR_OBJ_RUN_TO_COORD chunky 1004.2 -736.9

WHILE NOT IS_CHAR_OBJECTIVE_PASSED chunky
	WAIT 0

		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

		GOSUB pickup_and_audio

ENDWHILE

SET_CHAR_OBJ_RUN_TO_COORD chunky 1006.3 -753.2

WHILE NOT IS_CHAR_OBJECTIVE_PASSED chunky
	WAIT 0

		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

		GOSUB pickup_and_audio

ENDWHILE

	IF IS_CHAR_DEAD chunky
		GOTO mission_joey2_passed
	ENDIF

	IF IS_CAR_DEAD chunkys_car
		GOTO fuckin_run_for_it
	ELSE
		IF NOT IS_CAR_IN_AREA_2D chunkys_car 1004.0 -738.0 1012.0 -763.0 FALSE
		OR NOT IS_CAR_HEALTH_GREATER chunkys_car 300
			GOTO fuckin_run_for_it
		ENDIF
	ENDIF
			
SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER chunky chunkys_car

WHILE NOT IS_CHAR_IN_CAR chunky chunkys_car
	WAIT 0

		IF IS_CAR_DEAD chunkys_car
			GOTO fuckin_run_for_it
		ELSE

			IF NOT IS_CAR_IN_AREA_2D chunkys_car 1004.0 -738.0 1012.0 -763.0 FALSE
			OR NOT IS_CAR_HEALTH_GREATER chunkys_car 300
				GOTO fuckin_run_for_it
			ENDIF
		ENDIF
			
		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

		IF HAS_PICKUP_BEEN_COLLECTED gun_chunky  
		AND been_in_shop_before = 0 
			REMOVE_BLIP blip2_jm2
			been_in_shop_before = 1	
		ENDIF

ENDWHILE

	IF NOT IS_CAR_DEAD chunkys_car
		CAR_WANDER_RANDOMLY chunkys_car
		SET_CAR_DRIVING_STYLE chunkys_car 2
		SET_CAR_CRUISE_SPEED chunkys_car 20.0
		//LOCK_CAR_DOORS chunkys_car CARLOCK_UNLOCKED
	ENDIF

//DISPLAY_ONSCREEN_COUNTER test_car_health_counter //TEST STUFF!!!!!!!!!!!!!

WHILE IS_CAR_HEALTH_GREATER chunkys_car 300
	WAIT 0 

		GOSUB controller_modes

		IF NOT HAS_PICKUP_BEEN_COLLECTED gun_chunky
			GOSUB Ammu_bloke_audio
		ENDIF

		IF IS_CAR_DEAD chunkys_car
			GOTO mission_joey2_passed
		ENDIF

		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player chunky 160.0 160.0 FALSE
			PRINT_NOW ( AWAY ) 5000 2 // Mission brief
			GOTO mission_joey2_failed
		ENDIF

		IF NOT IS_CHAR_IN_CAR chunky chunkys_car
			GOTO fuckin_run_for_it	
		ENDIF 

		IF IS_CAR_UPSIDEDOWN chunkys_car
		AND IS_CAR_STOPPED chunkys_car
			SET_CHAR_OBJ_LEAVE_CAR chunky chunkys_car
			GOTO fuckin_run_for_it
		ENDIF

		IF HAS_PICKUP_BEEN_COLLECTED gun_chunky  
		AND been_in_shop_before = 0 
			REMOVE_BLIP blip2_jm2
			been_in_shop_before = 1	
		ENDIF

ENDWHILE


	IF IS_CHAR_DEAD chunky
		GOTO mission_joey2_passed
	ENDIF

SET_CHAR_OBJ_LEAVE_CAR chunky chunkys_car

WHILE IS_CHAR_IN_CAR chunky chunkys_car
	WAIT 0

		GOSUB controller_modes

		IF NOT HAS_PICKUP_BEEN_COLLECTED gun_chunky
			GOSUB Ammu_bloke_audio
		ENDIF

		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player chunky 160.0 160.0 FALSE
			PRINT_NOW ( AWAY ) 5000 2 // Mission brief
			GOTO mission_joey2_failed
		ENDIF

		IF IS_CAR_DEAD chunkys_car
			GOTO mission_joey2_passed
		ENDIF

		IF HAS_PICKUP_BEEN_COLLECTED gun_chunky  
		AND been_in_shop_before = 0 
			REMOVE_BLIP blip2_jm2
			been_in_shop_before = 1	
		ENDIF
		
ENDWHILE

GOTO fuckin_run_for_it


run_the_other_way:

SET_CHAR_OBJ_RUN_TO_COORD chunky 979.1 -720.8

WHILE NOT IS_CHAR_OBJECTIVE_PASSED chunky
	WAIT 0

	IF IS_CHAR_DEAD chunky
		GOTO mission_joey2_passed
	ENDIF

	GOSUB pickup_and_audio

ENDWHILE

SET_CHAR_OBJ_RUN_TO_COORD chunky 976.7 -687.0

WHILE NOT IS_CHAR_OBJECTIVE_PASSED chunky
	WAIT 0

	IF IS_CHAR_DEAD chunky
		GOTO mission_joey2_passed
	ENDIF

	GOSUB pickup_and_audio

ENDWHILE

SET_CHAR_OBJ_RUN_TO_COORD chunky 943.5 -679.2

WHILE NOT IS_CHAR_OBJECTIVE_PASSED chunky
	WAIT 0

	IF IS_CHAR_DEAD chunky
		GOTO mission_joey2_passed
	ENDIF

	GOSUB pickup_and_audio

ENDWHILE

SET_CHAR_OBJ_RUN_TO_COORD chunky 920.3 -681.5

WHILE NOT IS_CHAR_OBJECTIVE_PASSED chunky
	WAIT 0

	IF IS_CHAR_DEAD chunky
		GOTO mission_joey2_passed
	ENDIF

	GOSUB pickup_and_audio

ENDWHILE

	IF IS_CHAR_DEAD chunky
		GOTO mission_joey2_passed
	ENDIF

	IF IS_CAR_DEAD chunkys_car2
		GOTO fuckin_run_for_it
	ELSE
		IF NOT IS_CAR_IN_AREA_2D chunkys_car2 922.7 -673.9 906.6 -698.0 FALSE
		OR NOT IS_CAR_HEALTH_GREATER chunkys_car2 300
			GOTO fuckin_run_for_it
		ENDIF
	ENDIF
 		
SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER chunky chunkys_car2

// check for any type of car bomb
IF IS_CAR_ARMED_WITH_BOMB chunkys_car2 1
OR IS_CAR_ARMED_WITH_BOMB chunkys_car2 2
OR IS_CAR_ARMED_WITH_BOMB chunkys_car2 3
OR IS_CAR_ARMED_WITH_BOMB chunkys_car2 4
OR IS_CAR_ARMED_WITH_BOMB chunkys_car2 5
	joey2_armed_with_carbomb = 1
ENDIF

	WHILE NOT IS_CHAR_IN_CAR chunky chunkys_car2
		WAIT 0

		IF IS_CAR_DEAD chunkys_car2
			GOTO fuckin_run_for_it
		ELSE
			IF NOT IS_CAR_IN_AREA_2D chunkys_car2 922.7 -673.9 906.6 -698.0 FALSE
			OR NOT IS_CAR_HEALTH_GREATER chunkys_car2 300
				GOTO fuckin_run_for_it
			ENDIF
		ENDIF
		
		IF HAS_PICKUP_BEEN_COLLECTED gun_chunky  
		AND been_in_shop_before = 0 
			REMOVE_BLIP blip2_jm2
			been_in_shop_before = 1	
		ENDIF
				
		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

	ENDWHILE

	IF joey2_armed_with_carbomb = 1
		// chunky is in the vehicle at this point, waiting to be exploded
		joey2_killed_by_carbomb = 1
	ENDIF

	IF NOT IS_CAR_DEAD chunkys_car2
		CAR_WANDER_RANDOMLY chunkys_car2
		SET_CAR_DRIVING_STYLE chunkys_car2 2
		SET_CAR_CRUISE_SPEED chunkys_car2 20.0
		//LOCK_CAR_DOORS chunkys_car2 CARLOCK_UNLOCKED
	ENDIF

//DISPLAY_ONSCREEN_COUNTER test_car_health_counter //TEST STUFF!!!!!!!!!!!!!

	WHILE IS_CAR_HEALTH_GREATER chunkys_car2 300
		WAIT 0 

		GOSUB controller_modes

		IF NOT HAS_PICKUP_BEEN_COLLECTED gun_chunky
			GOSUB Ammu_bloke_audio
		ENDIF

		IF IS_CAR_DEAD chunkys_car2
			GOTO mission_joey2_passed
		ENDIF

		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player chunky 160.0 160.0 FALSE
			PRINT_NOW ( AWAY ) 5000 2 // Mission brief
			GOTO mission_joey2_failed
		ENDIF

		IF NOT IS_CHAR_IN_CAR chunky chunkys_car2
			GOTO fuckin_run_for_it	
		ENDIF 

		IF IS_CAR_UPSIDEDOWN chunkys_car2
		AND IS_CAR_STOPPED chunkys_car2
			SET_CHAR_OBJ_LEAVE_CAR chunky chunkys_car2
			GOTO fuckin_run_for_it
		ENDIF

		IF HAS_PICKUP_BEEN_COLLECTED gun_chunky  
		AND been_in_shop_before = 0 
			REMOVE_BLIP blip2_jm2
			been_in_shop_before = 1	
		ENDIF

		
	ENDWHILE


	IF IS_CHAR_DEAD chunky
		GOTO mission_joey2_passed
	ENDIF

SET_CHAR_OBJ_LEAVE_CAR chunky chunkys_car2

WHILE IS_CHAR_IN_CAR chunky chunkys_car2
	WAIT 0

		GOSUB controller_modes

		IF NOT HAS_PICKUP_BEEN_COLLECTED gun_chunky
			GOSUB Ammu_bloke_audio
		ENDIF

		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player chunky 160.0 160.0 FALSE
			PRINT_NOW ( AWAY ) 5000 2 // Mission brief
			GOTO mission_joey2_failed
		ENDIF

		IF IS_CAR_DEAD chunkys_car2
			GOTO mission_joey2_passed
		ENDIF

		IF HAS_PICKUP_BEEN_COLLECTED gun_chunky  
		AND been_in_shop_before = 0 
			REMOVE_BLIP blip2_jm2
			been_in_shop_before = 1	
		ENDIF
		
ENDWHILE


fuckin_run_for_it:

IF NOT IS_CHAR_DEAD chunky
	SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS chunky Player
ENDIF

//CHANGE_BLIP_DISPLAY blip1_jm2 BOTH

WHILE NOT IS_CHAR_DEAD chunky
	WAIT 0

		IF IS_CHAR_DEAD chunky
			GOTO mission_joey2_passed
		ENDIF

		GOSUB controller_modes

		GOSUB pickup_and_audio

		IF NOT HAS_PICKUP_BEEN_COLLECTED gun_chunky
			GOSUB Ammu_bloke_audio
		ENDIF

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player chunky 160.0 160.0 FALSE
			PRINT_NOW ( AWAY ) 5000 2 // Mission brief
			GOTO mission_joey2_failed
		ENDIF

ENDWHILE
   
}
GOTO mission_joey2_passed


 // Mission joey2 failed

mission_joey2_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission joey2 passed

mission_joey2_passed:

IF joey2_killed_by_carbomb = 1
	USE_TEXT_COMMANDS 99 // HACKED achievement unlock // PLANNED_AHEAD
ENDIF

flag_joey_mission2_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 10000
REGISTER_MISSION_PASSED	JM2
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT joey_mission3_loop
IF out_of_stock_pistol = 0
   	START_NEW_SCRIPT pistol_message
ENDIF
RETURN
		
// mission cleanup

mission_cleanup_joey2:

DISPLAY_RADAR 3 // HACKED RADAR ON

flag_player_on_mission = 0
flag_player_on_joey_mission = 0
special_ammu_audio = 0		 
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_A
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_PERENNIAL
UNLOAD_SPECIAL_CHARACTER 2
REMOVE_BLIP blip1_jm2
REMOVE_BLIP blip2_jm2
REMOVE_PICKUP gun_chunky
IF NOT IS_CHAR_DEAD	chunky
	REMOVE_CHAR_ELEGANTLY chunky
ENDIF
MISSION_HAS_FINISHED
RETURN




controller_modes:
{
	IF flag_player_had_gun_message = 0

		IF IS_PLAYER_IN_AREA_ON_FOOT_3D player 1075.2 -384.8 14.0 1086.2 -403.3 17.0 FALSE
		
			IF flag_gun_message_jm2 = 0 
				PRINT_HELP ( GUN_1A ) //"Use R2 and L2 to cycle through your weapons."
				timerb = 0
				flag_gun_message_jm2 = 1
			ENDIF

			IF flag_gun_message_jm2 = 1
				IF timerb > 10000
					
					//WDTOM this is not accurate at all any more...
					//PRINT_HELP ( GUN_2A ) //"Hold R1 to auto-target, press circle to fire!"
					
					timerb = 0
					flag_gun_message_jm2 = 2
				ENDIF
			ENDIF

			IF flag_gun_message_jm2 = 2
				IF timerb > 10000
					PRINT_HELP ( GUN_3A ) //"While holding the ~h~R1 button,~w~ press the ~h~L2 button~w~ or the ~h~R2 button to switch target."
					timerb = 0
					flag_gun_message_jm2 = 3
				ENDIF
			ENDIF

			IF flag_gun_message_jm2 = 3
				IF timerb > 10000
					PRINT_HELP ( GUN_4A ) //"While holding the ~h~R1 button~w~ you can walk or run while remaining locked onto a target."
					timerb = 0
					flag_gun_message_jm2 = 4
				ENDIF
			ENDIF

			IF flag_gun_message_jm2 = 4
				IF timerb > 10000
					PRINT_HELP ( GUN_5 ) //"You can practice targeting and shooting on these paper targets, when you are finished resume the mission."
					flag_gun_message_jm2 = 5
					flag_player_had_gun_message = 1
				ENDIF
			ENDIF
	
		ENDIF

	ENDIF

RETURN
}



Ammu_bloke_audio:
{

	IF has_audio_been_activated = 0

		IF IS_PLAYER_IN_AREA_3D player 1066.6 -403.5 14.0 1072.8 -394.0 18.0 FALSE 

		 	special_ammu_audio = 1

			LOAD_MISSION_AUDIO AMMU_B //AMMU_B

			IF camera_ammu1 = 1

				IF NOT IS_CHAR_DEAD ammu_shop_bloke1
					
					WHILE NOT HAS_MISSION_AUDIO_LOADED
						WAIT 0

						IF IS_CHAR_DEAD ammu_shop_bloke1
						OR IS_PLAYER_SHOOTING player
							GOTO clear_audio   
						ENDIF

					ENDWHILE

					PLAY_MISSION_AUDIO
					PRINT_NOW ( AMMU_B ) 5000 2 // Mission brief
					
					WHILE NOT HAS_MISSION_AUDIO_FINISHED
						WAIT 0

						IF IS_CHAR_DEAD ammu_shop_bloke1
						OR IS_PLAYER_SHOOTING player
							GOTO clear_audio   
						ENDIF

					ENDWHILE
					
					LOAD_MISSION_AUDIO AMMU_C //AMMU_C
		
					WHILE NOT HAS_MISSION_AUDIO_LOADED
						WAIT 0

						IF IS_CHAR_DEAD ammu_shop_bloke1
						OR IS_PLAYER_SHOOTING player
							GOTO clear_audio   
						ENDIF

					ENDWHILE

					PLAY_MISSION_AUDIO
					PRINT_NOW ( AMMU_C ) 5000 2 // Mission brief

					clear_audio:
					has_audio_been_activated = 1
					//CLEAR_MISSION_AUDIO 
					special_ammu_audio = 0
				ELSE
					special_ammu_audio = 0
					CLEAR_MISSION_AUDIO	
				ENDIF

			ENDIF

		ELSE
			special_ammu_audio = 0
			CLEAR_MISSION_AUDIO
		ENDIF

	ENDIF
		

RETURN
}


pickup_and_audio:

{
	IF HAS_PICKUP_BEEN_COLLECTED gun_chunky  
	AND been_in_shop_before = 0 
		REMOVE_BLIP blip2_jm2
		been_in_shop_before = 1	
	ENDIF

	IF NOT IS_CHAR_DEAD chunky
		IF TIMERB > 2500
			TIMERB = 0
			SET_CHAR_SAY chunky	SOUND_CHUNKY_RUN_SHOUT
		ENDIF
	ENDIF

RETURN
}
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Joey mission 3****************************************
// ***************************************Van heist*******************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff

GOSUB mission_start_joey3

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_joey3_failed
ENDIF

GOSUB mission_cleanup_joey3

MISSION_END


// Variables for mission

VAR_INT van_jm3 in_the_locate_joey3

VAR_INT blip1_jm3 blip2_jm3 

VAR_INT	flag_car_blip_displayed_jm3

VAR_INT van_man1_jm3 van_man2_jm3 old_van_health 

VAR_INT test_van_health_counter	test_van_health_counter2

// ***************************************Mission Start*************************************

mission_start_joey3:

REGISTER_MISSION_GIVEN

// only objective is to follow the van, dont need pathing
DISPLAY_RADAR 2 // PATHING OFF

flag_player_on_mission = 1
flag_player_on_joey_mission = 1
SCRIPT_NAME joey3
WAIT 0

in_the_locate_joey3 = 0


{

LOAD_SPECIAL_CHARACTER 1 joey
LOAD_SPECIAL_MODEL cut_obj1 JOEYH
LOAD_SPECIAL_MODEL cut_obj2 PLAYERH
LOAD_SPECIAL_MODEL cut_obj3 TROLL
REQUEST_MODEL jogarageext
REQUEST_MODEL jogarageint


LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED	cut_obj3
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED jogarageext 
OR NOT HAS_MODEL_LOADED jogarageint
	WAIT 0
ENDWHILE


LOAD_CUTSCENE J3_VH
SET_CUTSCENE_OFFSET 1190.079 -869.861 13.977 

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_joey
SET_CUTSCENE_ANIM cs_joey joey

CREATE_CUTSCENE_HEAD cs_joey CUT_OBJ1 cs_joeyhead
SET_CUTSCENE_HEAD_ANIM cs_joeyhead joey

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT CUT_OBJ3 cs_troll
SET_CUTSCENE_ANIM cs_troll TROLL
									   	
CLEAR_AREA 1191.9 -870.4 15.0 1.0 TRUE
SET_PLAYER_COORDINATES player 1191.9 -870.4 -100.0

SET_PLAYER_HEADING player 230.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time


WHILE cs_time < 5515
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM3_A ) 10000 2 // Mission brief

WHILE cs_time < 7894
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM3_B ) 10000 2 // Mission brief

WHILE cs_time < 10381
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM3_C ) 10000 2 // Mission brief

WHILE cs_time < 14589
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM3_D ) 10000 2 // Mission brief

WHILE cs_time < 17518
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM3_E ) 10000 2 // Mission brief

WHILE cs_time < 21627
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM3_F ) 10000 2 // Mission brief

WHILE cs_time < 24675
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 27333 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageext 
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageint

LOAD_SPECIAL_CHARACTER 2 S_GUARD
REQUEST_MODEL CAR_SECURICAR

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED CAR_SECURICAR 
	WAIT 0
ENDWHILE


// START OF MISSION

CREATE_CAR CAR_SECURICAR 1063.0 -805.0 14.6 van_jm3
LOCK_CAR_DOORS van_jm3 CARLOCK_LOCKOUT_PLAYER_ONLY
SET_CAR_ONLY_DAMAGED_BY_PLAYER van_jm3 TRUE
SET_CAR_PROOFS van_jm3 TRUE TRUE FALSE FALSE TRUE
SET_CAR_CRUISE_SPEED  van_jm3 14.0
SET_CAR_DRIVING_STYLE  van_jm3 0
ADD_BLIP_FOR_CAR van_jm3 blip1_jm3

CREATE_CHAR_INSIDE_CAR van_jm3 PEDTYPE_SPECIAL PED_SPECIAL2 van_man1_jm3
SET_CHAR_PERSONALITY van_man1_jm3 PEDSTAT_GEEK_GUY

CREATE_CHAR_AS_PASSENGER van_jm3 PEDTYPE_SPECIAL PED_SPECIAL2 0 van_man2_jm3
SET_CHAR_PERSONALITY van_man2_jm3 PEDSTAT_GEEK_GUY

GET_CAR_HEALTH van_jm3 test_van_health_counter
DISPLAY_ONSCREEN_COUNTER_WITH_STRING test_van_health_counter COUNTER_DISPLAY_BAR (DAM) //TEST STUFF!!!!!!!!!!!!!

GET_CAR_HEALTH van_jm3 test_van_health_counter 
	test_van_health_counter2 = 1000 - test_van_health_counter

	IF test_van_health_counter2 > 400
		test_van_health_counter2 = 400
	ENDIF

	test_van_health_counter = test_van_health_counter2 / 4


WHILE IS_CAR_HEALTH_GREATER van_jm3 999
	WAIT 0
	   
	IF IS_CAR_DEAD van_jm3
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey3_failed
	ENDIF  
	
	IF IS_CAR_UPSIDEDOWN van_jm3
	AND IS_CAR_STOPPED van_jm3
		GOTO mission_joey3_failed
	ENDIF

	GET_CAR_HEALTH van_jm3 test_van_health_counter 
		test_van_health_counter2 = 1000 - test_van_health_counter

	IF test_van_health_counter2 > 400
		test_van_health_counter2 = 400
	ENDIF

	test_van_health_counter = test_van_health_counter2 / 4

ENDWHILE

	IF NOT IS_CAR_DEAD van_jm3
		SET_CAR_DRIVING_STYLE van_jm3 2
		SET_CAR_CRUISE_SPEED van_jm3 20.0
		ALTER_WANTED_LEVEL_NO_DROP Player 1
		SET_CAR_ONLY_DAMAGED_BY_PLAYER van_jm3 FALSE
		GET_CAR_HEALTH van_jm3 old_van_health
	ENDIF

WHILE IS_CAR_HEALTH_GREATER van_jm3 750
	WAIT 0
	   
	IF IS_CAR_DEAD van_jm3
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey3_failed
	ENDIF  

	IF IS_CAR_UPSIDEDOWN van_jm3
	AND IS_CAR_STOPPED van_jm3
		GOTO mission_joey3_failed
	ENDIF

	IF NOT IS_CAR_DEAD van_jm3
		GET_CAR_HEALTH van_jm3 test_van_health_counter

		IF test_van_health_counter < old_van_health
			ALTER_WANTED_LEVEL_NO_DROP Player 1
		ENDIF	

		old_van_health = test_van_health_counter
	 
		test_van_health_counter2 = 1000 - test_van_health_counter

		IF test_van_health_counter2 > 400
			test_van_health_counter2 = 400
		ENDIF

		test_van_health_counter = test_van_health_counter2 / 4
	ENDIF
						
ENDWHILE

WHILE IS_CAR_HEALTH_GREATER van_jm3 600
	WAIT 0
	   
	IF IS_CAR_DEAD van_jm3
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey3_failed
	ENDIF  

	IF IS_CAR_UPSIDEDOWN van_jm3
	AND IS_CAR_STOPPED van_jm3
		GOTO mission_joey3_failed
	ENDIF

	IF NOT IS_CAR_DEAD van_jm3
		GET_CAR_HEALTH van_jm3 test_van_health_counter

		IF test_van_health_counter < old_van_health
			ALTER_WANTED_LEVEL_NO_DROP Player 2
		ENDIF	

		old_van_health = test_van_health_counter
	 
		test_van_health_counter2 = 1000 - test_van_health_counter

		IF test_van_health_counter2 > 400
			test_van_health_counter2 = 400
		ENDIF

		test_van_health_counter = test_van_health_counter2 / 4
	ENDIF
						
ENDWHILE


	IF NOT IS_CAR_DEAD van_jm3
		LOCK_CAR_DOORS van_jm3 CARLOCK_UNLOCKED
		CLEAR_ONSCREEN_COUNTER test_van_health_counter

		IF NOT IS_CHAR_DEAD van_man1_jm3
			SET_CHAR_OBJ_LEAVE_CAR van_man1_jm3 van_jm3
		ENDIF

		IF NOT IS_CHAR_DEAD van_man2_jm3
			SET_CHAR_OBJ_LEAVE_CAR van_man2_jm3 van_jm3
		ENDIF
	ENDIF

	IF IS_CAR_DEAD van_jm3
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey3_failed
	ENDIF

WHILE NOT IS_CHAR_IN_CAR van_man1_jm3 van_jm3
OR NOT IS_CHAR_IN_CAR van_man2_jm3 van_jm3 
	WAIT 0

	IF IS_CAR_DEAD van_jm3
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey3_failed
	ENDIF 

	IF IS_CHAR_DEAD van_man1_jm3
	OR IS_CHAR_DEAD van_man2_jm3
	ENDIF
	 
	IF IS_CAR_UPSIDEDOWN van_jm3
	AND IS_CAR_STOPPED van_jm3
		GOTO mission_joey3_failed
	ENDIF

ENDWHILE
	
	WAIT 1600

	IF IS_CAR_DEAD van_jm3
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey3_failed
	ENDIF

	IF NOT IS_CHAR_DEAD van_man1_jm3
	AND NOT IS_CHAR_DEAD van_man2_jm3
		SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS van_man1_jm3 player
		SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS van_man2_jm3 player
		SET_CHAR_SAY van_man2_jm3 SOUND_SECURITY_GUARD_RUN_AWAY_SHOUT
	ENDIF

	IF NOT IS_CAR_DEAD van_jm3
		SET_TARGET_CAR_FOR_MISSION_GARAGE Garage_bank van_jm3
	ENDIF

	flag_car_blip_displayed_jm3 = TRUE

	garage_stop:

	TIMERB = 0

WHILE NOT IS_CAR_STOPPED_IN_AREA_3D van_jm3 1440.7 -805.6 10.9 1449.8 -782.1 15.9 FALSE
OR NOT IS_PLAYER_IN_CAR player van_jm3
	WAIT 0

	IF IS_CAR_DEAD van_jm3
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey3_failed
	ENDIF
   
	IF IS_PLAYER_IN_CAR player van_jm3
		IF flag_car_blip_displayed_jm3 = TRUE
			ADD_BLIP_FOR_COORD 1445.0 -811.5 -100.0 blip2_jm3
			CHANGE_BLIP_DISPLAY blip2_jm3 BLIP_ONLY
			REMOVE_BLIP blip1_jm3
			PRINT_NOW ( jm3_1 ) 5000 1
		flag_car_blip_displayed_jm3 = FALSE
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player van_jm3									
		IF flag_car_blip_displayed_jm3 = FALSE
		ADD_BLIP_FOR_CAR van_jm3 blip1_jm3
		REMOVE_BLIP blip2_jm3
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the Van!"
		flag_car_blip_displayed_jm3 = TRUE
		ENDIF
	ENDIF

	IF IS_CAR_UPSIDEDOWN van_jm3
	AND IS_CAR_STOPPED van_jm3
		GOTO mission_joey3_failed
	ENDIF

	IF NOT IS_CHAR_DEAD	van_man2_jm3
		IF TIMERB > 4000
			TIMERB = 0
			SET_CHAR_SAY van_man2_jm3 SOUND_SECURITY_GUARD_RUN_AWAY_SHOUT
		ENDIF
	ENDIF
		
	IF in_the_locate_joey3 = 0
		IF LOCATE_PLAYER_IN_CAR_3D player 1445.0 -811.5 11.8 4.0 6.0 4.0 TRUE
			CLEAR_WANTED_LEVEL player
			in_the_locate_joey3 = 1
		ENDIF
	ENDIF

	IF in_the_locate_joey3 = 1
		IF NOT IS_CAR_IN_AREA_3D van_jm3 1440.7 -805.6 10.9 1449.8 -782.1 15.9 FALSE
		AND NOT LOCATE_PLAYER_IN_CAR_3D player 1445.0 -811.5 11.8 4.0 6.0 4.0 FALSE
			in_the_locate_joey3 = 0
		ENDIF
	ENDIF

ENDWHILE


	PRINT_NOW ( OUT_VEH ) 5000 2 //Get out of the van

WHILE NOT IS_CAR_IN_MISSION_GARAGE Garage_bank
		
	IF IS_CAR_DEAD van_jm3
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey3_failed
	ENDIF
	 
	IF NOT IS_CAR_IN_AREA_3D van_jm3 1440.7 -805.6 10.9 1449.8 -782.1 15.9 FALSE
		GOTO garage_stop
	ENDIF 

	IF IS_CAR_UPSIDEDOWN van_jm3
	AND IS_CAR_STOPPED van_jm3
		GOTO mission_joey3_failed
	ENDIF

	WAIT 0
ENDWHILE


REMOVE_BLIP blip2_jm3

}

GOTO mission_joey3_passed


 // Mission joey3 failed

mission_joey3_failed:
PRINT_BIG ( m_fail ) 2000 1
RETURN

   

// mission joey3 passed

mission_joey3_passed:

flag_joey_mission3_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 20000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 20000
REGISTER_MISSION_PASSED	JM3
PLAYER_MADE_PROGRESS 1
CHANGE_GARAGE_TYPE_WITH_CAR_MODEL Garage_bank GARAGE_COLLECTSPECIFICCARS CAR_SECURICAR
START_NEW_SCRIPT joey_mission4_loop
START_NEW_SCRIPT diablo_phone_start
START_NEW_SCRIPT van_heist_garage_pager
RETURN
		


// mission cleanup

mission_cleanup_joey3:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_joey_mission = 0
REMOVE_BLIP blip1_jm3
REMOVE_BLIP blip2_jm3
UNLOAD_SPECIAL_CHARACTER 2
SET_TARGET_CAR_FOR_MISSION_GARAGE Garage_bank -1
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SECURICAR
CLEAR_ONSCREEN_COUNTER test_van_health_counter
MISSION_HAS_FINISHED
RETURN
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// **************************************Joey Mission 4***************************************
// ***************************************pick up Toni****************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************


// Mission start stuff

GOSUB mission_start_joey4

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_joey4_failed
ENDIF

GOSUB mission_cleanup_joey4

MISSION_END


// Variables for mission

VAR_INT blip1_jm4 blip2_jm4 blip3_jm4 flag_car_blip_displayed_jm4 triads_ojective_passed 	

VAR_INT ojective_triad1_done_before ojective_triad2_done_before

VAR_INT Toni_abuse1_done_before	tonis_car_created_before played_tune_before

VAR_INT flag_displayed_wanted_message_jm4 flag_displayed_horn_message_jm4

VAR_INT tonis_ride is_char1_dead_jm4 is_char2_dead_jm4 is_char3_dead_jm4 is_char4_dead_jm4

VAR_INT triad1_jm4 triad2_jm4 triad3_jm4 triad4_jm4 tonis_audio_all_finished

VAR_FLOAT door1_position_jm4 door2_position_jm4 

// ***************************************Mission Start*************************************


mission_start_joey4:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_joey_mission = 1
SCRIPT_NAME joey4
WAIT 0

IF tonis_car_created_before = 1
	GOSUB delete_tonis_car
ENDIF

flag_displayed_wanted_message_jm4 = 0
flag_displayed_horn_message_jm4 = 0
Toni_abuse1_done_before = 0
ojective_triad1_done_before	= 0
ojective_triad2_done_before	= 0
triads_ojective_passed = 0
tonis_audio_all_finished = 0
played_tune_before = 0

SET_CAR_DENSITY_MULTIPLIER 0.0 //TURN ALL THE CARS OFF

{

LOAD_SPECIAL_CHARACTER 1 joey
LOAD_SPECIAL_CHARACTER 2 tony
LOAD_SPECIAL_MODEL cut_obj1 JOEDOOR
LOAD_SPECIAL_MODEL cut_obj2 JOEYH
LOAD_SPECIAL_MODEL cut_obj3 PLAYERH
LOAD_SPECIAL_MODEL cut_obj4 TONYH
REQUEST_MODEL CAR_MAFIA
REQUEST_MODEL CAR_IDAHO
REQUEST_MODEL CAR_STALLION
REQUEST_MODEL jogarageext
REQUEST_MODEL jogarageint

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED CAR_MAFIA 
OR NOT HAS_MODEL_LOADED CAR_IDAHO
OR NOT HAS_MODEL_LOADED CAR_STALLION
	WAIT 0
ENDWHILE

CREATE_CAR CAR_MAFIA 1189.72 -864.28 14.1 tonis_ride
tonis_car_created_before = 1
SET_CAR_HEADING tonis_ride -142.0
SET_RADIO_CHANNEL 1 -1

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2	
	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj4
	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED jogarageext 
OR NOT HAS_MODEL_LOADED jogarageint
	WAIT 0
ENDWHILE

//LOAD_SCENE 1190.07 -869.86 13.97

LOAD_CUTSCENE J4_ETH
SET_CUTSCENE_OFFSET 1190.079 -869.861 13.977

CREATE_CAR CAR_IDAHO 1182.5 -857.0 14.1 cut_car2_lm3
SET_CAR_HEADING cut_car2_lm3 291.2

CREATE_CAR CAR_STALLION 1192.9 -860.8 14.0 cut_car3_lm3
SET_CAR_HEADING cut_car3_lm3 150.0

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_joey
SET_CUTSCENE_ANIM cs_joey joey

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_tony
SET_CUTSCENE_ANIM cs_tony tony

CREATE_CUTSCENE_HEAD cs_joey CUT_OBJ2 cs_joeyhead
SET_CUTSCENE_HEAD_ANIM cs_joeyhead joey

CREATE_CUTSCENE_HEAD cs_tony CUT_OBJ4 cs_tonyhead
SET_CUTSCENE_HEAD_ANIM cs_tonyhead tony

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ3 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj1 cs_joedoor
SET_CUTSCENE_ANIM cs_joedoor JOEDOOR

CLEAR_AREA 1195.0 -870.3 15.0 10.0 TRUE

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door1 FALSE
SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door2 FALSE

//MOVE GARAGE UP
GET_OBJECT_COORDINATES joeys_garage_door2 joeydoor2_X joeydoor2_Y joeydoor2_Z
GET_OBJECT_COORDINATES joeys_garage_door3 joeydoor3_X joeydoor3_Y joeydoor3_Z

joeydoor2_Z = joeydoor2_Z + 3.0
joeydoor3_Z = joeydoor3_Z + 3.0

	WHILE NOT SLIDE_OBJECT joeys_garage_door2 joeydoor2_X joeydoor2_Y joeydoor2_Z 0.1 0.1 100.0 FALSE
	OR NOT SLIDE_OBJECT joeys_garage_door3 joeydoor3_X joeydoor3_Y joeydoor3_Z 0.1 0.1 100.0 FALSE
		WAIT 0								  

			IF IS_CAR_DEAD tonis_ride
				PRINT_NOW ( JM4_8 ) 5000 1
				GOTO mission_joey4_failed	
			ENDIF

			IF IS_CAR_UPSIDEDOWN tonis_ride
			AND IS_CAR_STOPPED tonis_ride
				PRINT_NOW ( WRECKED ) 5000 1
				GOTO mission_joey4_failed
			ENDIF

	ENDWHILE

DO_FADE 1800 FADE_IN

//SWITCH_WORLD_PROCESSING OFF
SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time


WHILE cs_time < 1
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM4_A ) 10000 1 //"Go to X, wait for Toni"

WHILE cs_time < 4000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM4_B ) 10000 1 //"Go to X, wait for Toni"

WHILE cs_time < 6180
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM4_C ) 10000 1 //"Go to X, wait for Toni"

WHILE cs_time < 10230
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM4_D ) 10000 1 //"Go to X, wait for Toni"

WHILE cs_time < 13040
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM4_E ) 10000 1 //"Go to X, wait for Toni"

WHILE cs_time < 15110
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM4_F ) 10000 1 //"Go to X, wait for Toni"

WHILE cs_time < 18080
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM4_G ) 10000 1 //"Go to X, wait for Toni"
				
WHILE cs_time < 23511
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 23833
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1000 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

//WHILE NOT HAS_CUTSCENE_FINISHED
//	WAIT 0
//ENDWHILE

//SWITCH_WORLD_PROCESSING ON
SWITCH_RUBBISH ON
CLEAR_PRINTS
CLEAR_CUTSCENE

IF NOT IS_CAR_DEAD tonis_ride
	CREATE_CHAR_AS_PASSENGER tonis_ride PEDTYPE_SPECIAL PED_SPECIAL2 0 toni
	CLEAR_CHAR_THREAT_SEARCH toni
	SET_CHAR_CANT_BE_DRAGGED_OUT toni TRUE
	ADD_ARMOUR_TO_CHAR toni 100
	WARP_PLAYER_INTO_CAR Player tonis_ride
ENDIF

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door1 TRUE
SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1192.23 -867.252 14.124 6.0 joey_door2 TRUE

CLEAR_AREA 1198.5 -871.4 15.0 10.0 TRUE
//SET_FIXED_CAMERA_POSITION 1206.0 -864.6 15.4 0.0 0.0 0.0
//POINT_CAMERA_AT_PLAYER player FIXED JUMP_CUT
SET_FIXED_CAMERA_POSITION 1200.831 -869.373 15.001 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 1199.887 -869.701 15.025 JUMP_CUT

WAIT 0
SWITCH_WIDESCREEN ON
SET_POLICE_IGNORE_PLAYER Player ON
SET_PLAYER_CONTROL Player OFF

//WAIT 500

DO_FADE 1000 FADE_IN

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ4
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_IDAHO
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STALLION
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageext 
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageint

DELETE_CAR cut_car2_lm3
DELETE_CAR cut_car3_lm3
	
	LOAD_MISSION_AUDIO J4T_1
	
	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE

	PLAY_MISSION_AUDIO
	PRINT_NOW ( JM4_10 ) 5000 1 //"Go to X, wait for Toni"
	
//CAR DRIVING OUT OF GARAGE CUT SCENE

IF NOT IS_CAR_DEAD tonis_ride						 
	CAR_GOTO_COORDINATES_ACCURATE tonis_ride 1198.5 -871.4 -100.0
	SET_CAR_CRUISE_SPEED tonis_ride 2.0
	SET_CAR_DRIVING_STYLE tonis_ride 3
ENDIF

IF NOT IS_CHAR_DEAD toni
	CHAR_LOOK_AT_PLAYER_ALWAYS toni player
	PLAYER_LOOK_AT_CHAR_ALWAYS player toni
	//SET_ANIM_GROUP_FOR_CHAR toni ANIM_OLDFAT_PED
ENDIF

WHILE NOT LOCATE_CAR_2D tonis_ride 1198.5 -871.4 2.0 2.0 FALSE
	WAIT 0

	IF IS_CAR_DEAD tonis_ride
		GOTO mission_joey4_failed
	ENDIF
	
	IF tonis_audio_all_finished = 0

		WHILE NOT HAS_MISSION_AUDIO_FINISHED
			WAIT 0

			IF IS_CAR_DEAD tonis_ride
			OR IS_CHAR_DEAD toni
				PRINT_NOW ( JM4_8 ) 5000 1 
				GOTO mission_joey4_failed	
			ENDIF

		ENDWHILE
		
		LOAD_MISSION_AUDIO J4T_2

		WHILE NOT HAS_MISSION_AUDIO_LOADED
			WAIT 0

			IF IS_CAR_DEAD tonis_ride
			OR IS_CHAR_DEAD toni
				PRINT_NOW ( JM4_8 ) 5000 1 
				GOTO mission_joey4_failed	
			ENDIF

		ENDWHILE

		PLAY_MISSION_AUDIO
		PRINT_NOW ( JM4_11 ) 5000 1 //"Go to X, wait for Toni"

		WHILE NOT HAS_MISSION_AUDIO_FINISHED
			WAIT 0

			IF IS_CAR_DEAD tonis_ride
			OR IS_CHAR_DEAD toni
				PRINT_NOW ( JM4_8 ) 5000 1 
				GOTO mission_joey4_failed	
			ENDIF

		ENDWHILE
	
		LOAD_MISSION_AUDIO J4T_3

		tonis_audio_all_finished = 1
	ENDIF
	

ENDWHILE

CLEAR_PRINTS

	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0

		IF IS_CAR_DEAD tonis_ride
		OR IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1 
			GOTO mission_joey4_failed	
		ENDIF

	ENDWHILE

	PLAY_MISSION_AUDIO
	PRINT_NOW ( JM4_12 ) 5000 1 //"Go to X, wait for Toni"

GET_OBJECT_COORDINATES joeys_garage_door2 joeydoor2_X joeydoor2_Y joeydoor2_Z
GET_OBJECT_COORDINATES joeys_garage_door3 joeydoor3_X joeydoor3_Y joeydoor3_Z

joeydoor2_Z = joeydoor2_Z - 3.0
joeydoor3_Z = joeydoor3_Z - 3.0

WHILE NOT SLIDE_OBJECT joeys_garage_door2 joeydoor2_X joeydoor2_Y joeydoor2_Z 0.1 0.1 0.1 FALSE
OR NOT SLIDE_OBJECT joeys_garage_door3 joeydoor3_X joeydoor3_Y joeydoor3_Z 0.1 0.1 0.1 FALSE
	WAIT 0
		
		IF IS_CAR_DEAD tonis_ride
		OR IS_CHAR_DEAD toni 
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed	
		ENDIF

		IF IS_CAR_UPSIDEDOWN tonis_ride
		AND IS_CAR_STOPPED tonis_ride
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

ENDWHILE 

	WHILE NOT HAS_MISSION_AUDIO_FINISHED
		WAIT 0

		IF IS_CAR_DEAD tonis_ride
		OR IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1 
			GOTO mission_joey4_failed	
		ENDIF

	ENDWHILE

	LOAD_MISSION_AUDIO J4T_4

	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0

		IF IS_CAR_DEAD tonis_ride
		OR IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1 
			GOTO mission_joey4_failed	
		ENDIF

	ENDWHILE

	PLAY_MISSION_AUDIO
	PRINT_NOW ( JM4_13 ) 5000 1 //"Go to X, wait for Toni"
		
	WHILE NOT HAS_MISSION_AUDIO_FINISHED
		WAIT 0

		IF IS_CAR_DEAD tonis_ride
		OR IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1 
			GOTO mission_joey4_failed	
		ENDIF

	ENDWHILE

IF NOT IS_CHAR_DEAD toni
	STOP_CHAR_LOOKING toni
	STOP_PLAYER_LOOKING Player
ENDIF
	
CLEAR_PRINTS

SWITCH_WIDESCREEN OFF
SET_PLAYER_CONTROL Player On
SET_CAR_STATUS tonis_ride STATUS_PLAYER
SET_POLICE_IGNORE_PLAYER Player Off
RESTORE_CAMERA
SET_CAR_DENSITY_MULTIPLIER 1.0 // TURN ALL THE CARS BACK ON
SWITCH_CAR_GENERATOR gen_car12 0

	REQUEST_MODEL PED_GANG_TRIAD_A
	REQUEST_MODEL PED_GANG_TRIAD_B
	LOAD_MISSION_AUDIO J4_A

	WHILE NOT HAS_MODEL_LOADED PED_GANG_TRIAD_A
	OR NOT HAS_MODEL_LOADED PED_GANG_TRIAD_B
	OR NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE


SWITCH_PED_ROADS_OFF 824.9 -633.8 13.0 845.3 -693.8 18.0 
SWITCH_ROADS_OFF 824.9 -633.8 13.0 845.3 -693.8 18.0
CLEAR_AREA 843.4 -663.8 15.0 10.0 TRUE

ADD_BLIP_FOR_COORD 843.0 -660.0 -100.0 blip1_jm4
CHANGE_BLIP_DISPLAY blip1_jm4 BLIP_ONLY


	CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 850.0 -663.0 14.7 triad1_jm4
	CLEAR_CHAR_THREAT_SEARCH triad1_jm4
	SET_CHAR_PROOFS triad1_jm4 TRUE TRUE TRUE TRUE TRUE

	CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 850.0 -664.7 14.7 triad2_jm4
	CLEAR_CHAR_THREAT_SEARCH triad2_jm4
	SET_CHAR_PROOFS triad2_jm4 TRUE TRUE TRUE TRUE TRUE

	TURN_CHAR_TO_FACE_CHAR triad1_jm4 triad2_jm4
	TURN_CHAR_TO_FACE_CHAR triad2_jm4 triad1_jm4

REMOVE_BLIP blip1_jm4
flag_car_blip_displayed_jm4 = TRUE
blob_flag = 1

	IF IS_CAR_DEAD tonis_ride
		PRINT_NOW ( JM4_8 ) 5000 1
		GOTO mission_joey4_failed
	ENDIF

	WHILE NOT IS_PLAYER_STOPPED_IN_AREA_IN_CAR_3D player 839.2 -667.4 14.0 842.1 -673.9 17.0 blob_flag
	OR IS_WANTED_LEVEL_GREATER Player 0
	OR NOT IS_PLAYER_IN_CAR Player tonis_ride    	

		WAIT 0

		IF IS_CAR_DEAD tonis_ride
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed
		ENDIF
		
		IF IS_CAR_UPSIDEDOWN tonis_ride
		AND IS_CAR_STOPPED tonis_ride
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF NOT IS_PLAYER_IN_CAR player tonis_ride
			IF flag_car_blip_displayed_jm4 = FALSE
			ADD_BLIP_FOR_CAR tonis_ride blip2_jm4
			blob_flag = 0
			REMOVE_BLIP blip1_jm4
			PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the car!"
			flag_car_blip_displayed_jm4 = TRUE
			ENDIF
		ENDIF

		IF IS_PLAYER_IN_CAR player tonis_ride
			IF flag_car_blip_displayed_jm4 = TRUE
				ADD_BLIP_FOR_COORD 843.0 -660.0 -100.0 blip1_jm4
				blob_flag = 1
				REMOVE_BLIP blip2_jm4
			flag_car_blip_displayed_jm4 = FALSE
			ENDIF
		ENDIF

		IF NOT IS_CAR_HEALTH_GREATER tonis_ride 900
		AND	Toni_abuse1_done_before = 0
			PRINT_NOW ( JM4_6 ) 5000 1 //"Watch the fuckin CAR!"
			PLAY_MISSION_AUDIO
			Toni_abuse1_done_before = 1
		ENDIF	

		IF IS_PLAYER_STOPPED_IN_AREA_IN_CAR_3D player 839.2 -667.4 14.0 842.1 -673.9 17.0 FALSE

			IF IS_WANTED_LEVEL_GREATER player 0
				IF flag_displayed_wanted_message_jm4 = 0
					PRINT_NOW ( WANTED1 ) 3000 1
					flag_displayed_wanted_message_jm4 = 1
				ENDIF
			
			ENDIF
		ELSE
			IF NOT IS_PLAYER_IN_AREA_3D player 839.2 -667.4 14.0 842.1 -673.9 17.0 FALSE
				flag_displayed_wanted_message_jm4 = 0
			ENDIF
		ENDIF

	ENDWHILE

REMOVE_BLIP blip1_jm4
SET_POLICE_IGNORE_PLAYER Player ON
SET_PLAYER_CONTROL Player Off
SWITCH_WIDESCREEN ON
SET_FIXED_CAMERA_POSITION 825.604 -680.602 16.567 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 826.336 -679.921 16.539 JUMP_CUT

	LOAD_MISSION_AUDIO J4_B

	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE


//TONI LANDRETTE CUT_SCENE
IF NOT IS_CHAR_DEAD	triad1_jm4
AND NOT IS_CHAR_DEAD triad2_jm4
	SET_CHARS_CHATTING triad1_jm4 triad2_jm4 999999
ENDIF

IF NOT IS_CHAR_DEAD	toni
	SET_CHAR_PROOFS toni TRUE TRUE TRUE TRUE TRUE
ENDIF

PLAY_MISSION_AUDIO
PRINT_NOW ( JM4_2 ) 5000 1 //wait here
 
CLEAR_AREA 843.4 -663.8 15.0 10.0 TRUE

WAIT 4000

	IF IS_CAR_DEAD tonis_ride
	OR IS_CHAR_DEAD toni
		PRINT_NOW ( JM4_8 ) 5000 1 
		GOTO mission_joey4_failed	
	ENDIF

GIVE_WEAPON_TO_CHAR toni WEAPONTYPE_BASEBALLBAT 0
SET_CHAR_OBJ_LEAVE_CAR toni tonis_ride

	WHILE IS_CHAR_IN_CAR toni tonis_ride
		WAIT 0

		IF IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_DEAD tonis_ride
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_UPSIDEDOWN tonis_ride
		AND IS_CAR_STOPPED tonis_ride
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

	ENDWHILE

//SET_FIXED_CAMERA_POSITION 840.0 -672.4 17.0 0.0 0.0 0.0
//SET_FIXED_CAMERA_POSITION 836.632 -670.922 17.843 0.0 0.0 0.0
//POINT_CAMERA_AT_CHAR toni FIXED INTERPOLATION

SET_FIXED_CAMERA_POSITION 841.312 -669.063 16.536 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 842.117 -668.501 16.343 JUMP_CUT

//TONI WALKS TO DOORS

	IF IS_CAR_DEAD tonis_ride
	OR IS_CHAR_DEAD toni
		PRINT_NOW ( JM4_8 ) 5000 1 
		GOTO mission_joey4_failed	
	ENDIF

TURN_CHAR_TO_FACE_COORD toni 843.9 -663.7 15.1

TIMERB = 0

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT toni 843.9 -663.7

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED toni
		WAIT 0

		IF IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_DEAD tonis_ride
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_UPSIDEDOWN tonis_ride
		AND IS_CAR_STOPPED tonis_ride
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF TIMERB > 10000
			IF NOT IS_CHAR_DEAD	toni
				SET_CHAR_COORDINATES toni 843.9 -663.7 13.9
			ENDIF
		ENDIF

	ENDWHILE


//OPEN DOORS

	WHILE NOT ROTATE_OBJECT laundrete_door1 90.0 10.0 FALSE
	OR NOT ROTATE_OBJECT laundrete_door2 90.0 10.0 FALSE
		WAIT 0

		IF IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_DEAD tonis_ride
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_UPSIDEDOWN tonis_ride
		AND IS_CAR_STOPPED tonis_ride
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

	ENDWHILE

//TONI WALKS IN

	IF IS_CAR_DEAD tonis_ride
	OR IS_CHAR_DEAD toni 
		PRINT_NOW ( JM4_8 ) 5000 1
		GOTO mission_joey4_failed	
	ENDIF

TIMERB = 0

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT toni 848.1 -663.4

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED toni
		WAIT 0

		IF IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_DEAD tonis_ride
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_UPSIDEDOWN tonis_ride
		AND IS_CAR_STOPPED tonis_ride
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF TIMERB > 10000
			IF NOT IS_CHAR_DEAD	toni
				SET_CHAR_COORDINATES toni 848.1 -663.4 13.9
			ENDIF
		ENDIF

	ENDWHILE

SET_CHAR_OBJ_WAIT_ON_FOOT toni

IF NOT IS_CHAR_DEAD triad1_jm4
AND NOT IS_CHAR_DEAD triad2_jm4
	SET_CHARS_CHATTING triad1_jm4 triad2_jm4 0
ENDIF

WAIT 0

	IF NOT IS_CHAR_DEAD triad1_jm4
	AND NOT IS_CHAR_DEAD triad2_jm4
	AND NOT IS_CHAR_DEAD toni
		TURN_CHAR_TO_FACE_CHAR triad1_jm4 toni
		TURN_CHAR_TO_FACE_CHAR triad2_jm4 toni
		CHAR_LOOK_AT_CHAR_ALWAYS triad1_jm4 toni
		CHAR_LOOK_AT_CHAR_ALWAYS triad2_jm4	toni
	ENDIF

WAIT 5000

ADD_ONE_OFF_SOUND 845.0 -663.0 14.0 sound_test_1 //Need Sound event

GET_OBJECT_HEADING laundrete_door1 door1_position_jm4
GET_OBJECT_HEADING laundrete_door2 door2_position_jm4


	IF IS_CHAR_DEAD toni 
		PRINT_NOW ( JM4_8 ) 5000 1
		GOTO mission_joey4_failed	
	ENDIF

TURN_CHAR_TO_FACE_COORD toni 843.9 -663.7 15.1

	IF NOT IS_CHAR_DEAD triad1_jm4
	OR NOT IS_CHAR_DEAD triad2_jm4
		GIVE_WEAPON_TO_CHAR triad1_jm4 WEAPONTYPE_PISTOL 100
		GIVE_WEAPON_TO_CHAR triad2_jm4 WEAPONTYPE_PISTOL 100
	ENDIF

SET_CHAR_RUNNING toni TRUE

	IF NOT IS_CHAR_DEAD triad1_jm4
	OR NOT IS_CHAR_DEAD triad2_jm4
		SET_CHAR_STAY_IN_SAME_PLACE triad1_jm4 TRUE
		SET_CHAR_STAY_IN_SAME_PLACE triad2_jm4 TRUE
		SET_CHAR_OBJ_KILL_CHAR_ON_FOOT triad1_jm4 toni
		SET_CHAR_OBJ_KILL_CHAR_ON_FOOT triad2_jm4 toni
	ENDIF

//TONI RUNS OUT

CLEAR_AREA 843.4 -663.8 15.0 10.0 TRUE

TIMERB = 0

IF NOT IS_CHAR_DEAD triad1_jm4
AND NOT IS_CHAR_DEAD triad2_jm4
	STOP_CHAR_LOOKING triad1_jm4
	STOP_CHAR_LOOKING triad2_jm4 
ENDIF

SET_CHAR_OBJ_RUN_TO_COORD toni 843.9 -663.7

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED toni
		WAIT 0

		IF IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_DEAD tonis_ride
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_UPSIDEDOWN tonis_ride
		AND IS_CAR_STOPPED tonis_ride
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF TIMERB > 10000
			IF NOT IS_CHAR_DEAD	toni
				SET_CHAR_COORDINATES toni 843.9 -663.7 13.9
			ENDIF
		ENDIF

	ENDWHILE

SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER toni tonis_ride
SET_FIXED_CAMERA_POSITION 836.029 -677.868 15.840 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 836.713 -677.156 15.680 JUMP_CUT

WAIT 1500

	IF NOT IS_CHAR_DEAD triad1_jm4
	AND NOT IS_CHAR_DEAD triad2_jm4
		SET_CHAR_STAY_IN_SAME_PLACE triad1_jm4 FALSE
		SET_CHAR_STAY_IN_SAME_PLACE triad2_jm4 FALSE
		SET_CHAR_OBJ_RUN_TO_COORD triad1_jm4 842.0 -663.8
		SET_CHAR_OBJ_RUN_TO_COORD triad2_jm4 843.5 -663.8
	ENDIF

//TRIADS RUN OUT

	WHILE NOT triads_ojective_passed = 2
		WAIT 0

			IF IS_CHAR_DEAD toni
				PRINT_NOW ( JM4_8 ) 5000 1
				GOTO mission_joey4_failed
			ENDIF

			IF IS_CAR_DEAD tonis_ride
				GOTO mission_joey4_failed
			ENDIF

			IF IS_CHAR_DEAD triad1_jm4
			AND ojective_triad1_done_before = 0
				triads_ojective_passed ++
				ojective_triad1_done_before = 1
			ENDIF

			IF IS_CHAR_DEAD triad2_jm4
			AND ojective_triad2_done_before = 0
				triads_ojective_passed ++
				ojective_triad2_done_before = 1
			ENDIF

			IF IS_CHAR_OBJECTIVE_PASSED triad1_jm4
			AND ojective_triad1_done_before = 0
				SET_CHAR_OBJ_DESTROY_CAR triad1_jm4 tonis_ride
				triads_ojective_passed ++
				ojective_triad1_done_before = 1
			ENDIF

			IF IS_CHAR_OBJECTIVE_PASSED triad2_jm4
			AND ojective_triad2_done_before = 0
				SET_CHAR_OBJ_DESTROY_CAR triad2_jm4 tonis_ride	
				triads_ojective_passed ++
				ojective_triad2_done_before = 1
			ENDIF

	ENDWHILE


	WHILE NOT IS_CHAR_IN_CAR toni tonis_ride
		WAIT 0

		IF IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_DEAD tonis_ride
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_UPSIDEDOWN tonis_ride
		AND IS_CAR_STOPPED tonis_ride
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

	ENDWHILE

	CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 843.1 -689.0 13.9 triad3_jm4
	GIVE_WEAPON_TO_CHAR triad3_jm4 WEAPONTYPE_PISTOL 100
	SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triad3_jm4 Player
	SET_CHAR_THREAT_SEARCH triad3_jm4 THREAT_PLAYER1

	CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 844.3 -634.8 13.9 triad4_jm4
	GIVE_WEAPON_TO_CHAR triad4_jm4 WEAPONTYPE_PISTOL 100
	SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triad4_jm4 Player
	SET_CHAR_THREAT_SEARCH triad4_jm4 THREAT_PLAYER1

	IF NOT IS_CHAR_DEAD	toni
		SET_CHAR_PROOFS toni FALSE FALSE FALSE FALSE FALSE
	ENDIF

	IF NOT IS_CHAR_DEAD triad1_jm4
	AND NOT IS_CHAR_DEAD triad2_jm4
		SET_CHAR_PROOFS triad1_jm4 FALSE FALSE FALSE FALSE FALSE
		SET_CHAR_PROOFS triad2_jm4 FALSE FALSE FALSE FALSE FALSE
	ENDIF

SET_PLAYER_CONTROL Player On
SWITCH_WIDESCREEN OFF
RESTORE_CAMERA

	LOAD_MISSION_AUDIO J4_C

	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE

PLAY_MISSION_AUDIO
PRINT_NOW ( JM4_3 ) 4000 1 //"GO GO GO!"
SET_POLICE_IGNORE_PLAYER Player OFF

ADD_BLIP_FOR_COORD 1216.8 -327.6 -100.0 blip3_jm4
CHANGE_BLIP_DISPLAY blip3_jm4 BLIP_ONLY

	// CLOSE DOORS
	WHILE NOT ROTATE_OBJECT laundrete_door1 0.0 10.0 FALSE
	OR NOT ROTATE_OBJECT laundrete_door2 180.0 10.0	FALSE
		WAIT 0
			  
		IF IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_DEAD tonis_ride
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_UPSIDEDOWN tonis_ride
		AND IS_CAR_STOPPED tonis_ride
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey4_failed
		ENDIF
	
	ENDWHILE

is_char1_dead_jm4 = 0
is_char2_dead_jm4 = 0
is_char3_dead_jm4 = 0
is_char4_dead_jm4 = 0
flag_car_blip_displayed_jm4 = TRUE

REMOVE_BLIP blip3_jm4

// waiting for the player to get to Toni's

IF NOT IS_CHAR_DEAD	triad1_jm4
	SET_CHAR_THREAT_SEARCH triad1_jm4 THREAT_PLAYER1
ENDIF

IF NOT IS_CHAR_DEAD	triad2_jm4
	SET_CHAR_THREAT_SEARCH triad2_jm4 THREAT_PLAYER1
ENDIF

CLEAR_AREA 1216.7 -328.1 26.0 6.0 TRUE

flag_displayed_wanted_message_jm4 = 0

blob_flag = 1

	WHILE NOT IS_PLAYER_STOPPED_IN_AREA_IN_CAR_3D player 1215.0 -326.9 25.0 1220.2 -330.5 27.0 blob_flag
	OR IS_WANTED_LEVEL_GREATER Player 0
	OR NOT IS_PLAYER_IN_CAR	player tonis_ride
		WAIT 0

		IF IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CAR_DEAD tonis_ride
			GOTO mission_joey4_failed
		ENDIF

		IF NOT IS_PLAYER_IN_CAR player tonis_ride
			IF flag_car_blip_displayed_jm4 = FALSE
				ADD_BLIP_FOR_CAR tonis_ride blip2_jm4
				REMOVE_BLIP blip3_jm4
				PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the car!"
				blob_flag = 0
				flag_car_blip_displayed_jm4 = TRUE
			ENDIF
		ENDIF

		IF IS_PLAYER_IN_CAR player tonis_ride
			IF flag_car_blip_displayed_jm4 = TRUE
				ADD_BLIP_FOR_COORD 1216.8 -327.6 -100.0 blip3_jm4
				REMOVE_BLIP blip2_jm4
				blob_flag = 1
			flag_car_blip_displayed_jm4 = FALSE
			ENDIF
		ENDIF

		IF IS_CAR_UPSIDEDOWN tonis_ride
		AND IS_CAR_STOPPED tonis_ride
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

		IF IS_CHAR_DEAD triad1_jm4
		AND is_char1_dead_jm4 = 0
			is_char1_dead_jm4 = 1
		ENDIF

		IF IS_CHAR_DEAD triad2_jm4
		AND is_char2_dead_jm4 = 0
			is_char2_dead_jm4 = 1		
		ENDIF

		IF IS_CHAR_DEAD triad3_jm4
		AND is_char3_dead_jm4 = 0
			is_char3_dead_jm4 = 1
		ENDIF

		IF IS_CHAR_DEAD triad4_jm4
		AND is_char4_dead_jm4 = 0
			is_char4_dead_jm4 = 1		
		ENDIF

		IF is_char1_dead_jm4 = 1
		AND is_char2_dead_jm4 = 1
		AND is_char3_dead_jm4 = 1
		AND is_char4_dead_jm4 = 1
		AND played_tune_before = 0
			ADD_SCORE player 2000
			GET_PLAYER_COORDINATES Player player_X player_Y player_Z
			ADD_ONE_OFF_SOUND player_X player_Y player_Z SOUND_PART_MISSION_COMPLETE
			played_tune_before = 1
		ENDIF

		IF IS_PLAYER_STOPPED_IN_AREA_IN_CAR_3D player 1215.0 -326.9 25.0 1220.2 -330.5 27.0 FALSE

			IF IS_WANTED_LEVEL_GREATER player 0
				IF flag_displayed_wanted_message_jm4 = 0
					PRINT_NOW ( WANTED1 ) 3000 1
					flag_displayed_wanted_message_jm4 = 1
				ENDIF
			ELSE
			
			ENDIF
		ELSE
			IF NOT IS_PLAYER_IN_AREA_3D player 1215.0 -326.9 25.0 1220.2 -330.5 27.0 FALSE
				flag_displayed_wanted_message_jm4 = 0
			ENDIF
		ENDIF

	ENDWHILE

REMOVE_BLIP blip3_jm4

CLEAR_AREA 1216.5 -326.8 26.0 6.0 TRUE
CLEAR_AREA 1219.6 -319.2 27.7 2.0 TRUE
SET_PLAYER_CONTROL Player Off
SET_POLICE_IGNORE_PLAYER Player ON
SWITCH_WIDESCREEN ON

SET_FIXED_CAMERA_POSITION 1224.119 -333.413 26.529 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 1223.382 -332.738 26.568 JUMP_CUT

IF NOT IS_CHAR_DEAD	toni
	SET_CURRENT_CHAR_WEAPON toni WEAPONTYPE_UNARMED
	CHAR_LOOK_AT_PLAYER_ALWAYS toni player
	PLAYER_LOOK_AT_CHAR_ALWAYS player toni
ENDIF

REMOVE_BLIP blip2_jm4

//SAMPLE 1***************************************************
LOAD_MISSION_AUDIO J4_D

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE

PLAY_MISSION_AUDIO
PRINT_NOW ( JM4_4 ) 4000 1 //"come back for job"

WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0

		IF IS_CAR_DEAD tonis_ride
		OR IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1 
			GOTO mission_joey4_failed	
		ENDIF

ENDWHILE

//SAMPLE 2***************************************************
LOAD_MISSION_AUDIO J4_E

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE

PLAY_MISSION_AUDIO
PRINT_NOW ( JM4_5 ) 5000 1 //"come back for job"

WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0

		IF IS_CAR_DEAD tonis_ride
		OR IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1 
			GOTO mission_joey4_failed	
		ENDIF

ENDWHILE

//SAMPLE 3***************************************************
LOAD_MISSION_AUDIO J4_F

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE

PLAY_MISSION_AUDIO

WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0

		IF IS_CAR_DEAD tonis_ride
		OR IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1 
			GOTO mission_joey4_failed	
		ENDIF

ENDWHILE


	IF IS_CAR_DEAD tonis_ride
	OR IS_CHAR_DEAD toni
		PRINT_NOW ( JM4_8 ) 5000 1 
		GOTO mission_joey4_failed	
	ENDIF

	IF NOT IS_CHAR_DEAD toni
		SET_CHAR_RUNNING toni FALSE
		SET_CHAR_OBJ_LEAVE_CAR toni tonis_ride
		STOP_CHAR_LOOKING toni
		STOP_PLAYER_LOOKING Player
	ENDIF

	WHILE IS_CHAR_IN_CAR toni tonis_ride
		WAIT 0

		IF IS_CAR_DEAD tonis_ride
		OR IS_CHAR_DEAD toni 
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed	
		ENDIF

		IF IS_CAR_UPSIDEDOWN tonis_ride
		AND IS_CAR_STOPPED tonis_ride
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey4_failed
		ENDIF

	ENDWHILE

	IF IS_CHAR_DEAD toni 
		PRINT_NOW ( JM4_8 ) 5000 1
		GOTO mission_joey4_failed	
	ENDIF

TIMERB = 0
CLEAR_AREA 1219.4 -324.4 26.1 2.0 TRUE
SET_CHAR_OBJ_GOTO_COORD_ON_FOOT toni 1219.4 -324.4

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED toni
		WAIT 0

		IF IS_CHAR_DEAD toni
			PRINT_NOW ( JM4_8 ) 5000 1 
			GOTO mission_joey4_failed	
		ENDIF

		IF TIMERB > 10000
			IF NOT IS_CHAR_DEAD	toni
				SET_CHAR_COORDINATES toni 1219.4 -324.4 -100.0
			ENDIF
		ENDIF

	ENDWHILE

	IF IS_CHAR_DEAD toni
		PRINT_NOW ( JM4_8 ) 5000 1 
		GOTO mission_joey4_failed	
	ENDIF

TIMERB = 0
CLEAR_AREA 1219.5 -315.4 29.9 2.0 TRUE
SET_CHAR_OBJ_GOTO_COORD_ON_FOOT toni 1219.5 -318.6

PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 3000 7000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 3000

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED toni
		WAIT 0

		IF IS_CHAR_DEAD toni 
			PRINT_NOW ( JM4_8 ) 5000 1
			GOTO mission_joey4_failed	
		ENDIF

		IF TIMERB > 10000
			IF NOT IS_CHAR_DEAD	toni
				SET_CHAR_COORDINATES toni 1219.5 -318.6 28.4
			ENDIF
		ENDIF

	ENDWHILE

SWITCH_WIDESCREEN OFF
SET_PLAYER_CONTROL Player On
SET_POLICE_IGNORE_PLAYER Player OFF
RESTORE_CAMERA_JUMPCUT
DELETE_CHAR toni
}

GOTO mission_joey4_passed



// Mission Joey4 failed

mission_joey4_failed:
//SWITCH_WIDESCREEN OFF
//SET_PLAYER_CONTROL Player On
//RESTORE_CAMERA_JUMPCUT
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission Joey4 passed

mission_joey4_passed:

USE_TEXT_COMMANDS 122 // HACKED achievement unlock // GOT_ANY_STORIES_OLD_MAN

flag_joey_mission4_passed = 1
//PLAY_MISSION_PASSED_TUNE 1
//PRINT_WITH_NUMBER_BIG ( M_PASS ) 3000 5000 1 //"Mission Passed!"
//CLEAR_WANTED_LEVEL player
//ADD_SCORE player 3000
REGISTER_MISSION_PASSED JM4
PLAYER_MADE_PROGRESS 1
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1219.6 -321.0 26.4 RADAR_SPRITE_TONY toni_contact_blip
REMOVE_PICKUP SHOP_UZI 
CREATE_PICKUP WEAPON_UZI PICKUP_IN_SHOP 1070.5 -400.8 15.2 SHOP_UZI2
START_NEW_SCRIPT toni_mission1_loop
START_NEW_SCRIPT joey_mission5_loop 
START_NEW_SCRIPT uzi_message
RETURN
		


// mission cleanup

mission_cleanup_joey4:

flag_player_on_mission = 0
flag_player_on_joey_mission = 0
REMOVE_BLIP blip1_jm4
REMOVE_BLIP blip2_jm4
REMOVE_BLIP blip3_jm4
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_MAFIA
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_B
SWITCH_PED_ROADS_ON 824.9 -633.8 13.0 845.3 -693.8 18.0 
SWITCH_ROADS_ON 824.9 -633.8 13.0 845.3 -693.8 18.0 
UNLOAD_SPECIAL_CHARACTER 2
SWITCH_CAR_GENERATOR gen_car12 101
REMOVE_CHAR_ELEGANTLY toni
MISSION_HAS_FINISHED
RETURN


{
delete_tonis_car:

	DELETE_CAR tonis_ride

RETURN
}
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Joey mission 5****************************************
// *********************************Dead Skunk in the Trunk***********************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff

GOSUB mission_start_joey5

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_joey5_failed
ENDIF

GOSUB mission_cleanup_joey5

MISSION_END


// Variables for mission


VAR_INT deadman_car blip1_j5 blip2_j5
 
VAR_INT lipsbrother1_car lipsbrother2_car is_lipsbrother1_car_dead is_lipsbrother2_car_dead

VAR_INT lipsbrother1 lipsbrother2 skunk_message_played_before

VAR_INT flag_car_blip_displayed_j5 flag_car_crushed_joey5

VAR_INT on_new_objective_joey5_1 on_new_objective_joey5_2 

VAR_INT flag_dont_do_car_check_joey5 flag_leave_car_message_joey5 flag_car_in_area_joey5

// ***************************************Mission Start*************************************

mission_start_joey5:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_joey_mission = 1
SCRIPT_NAME joey5
WAIT 0

skunk_message_played_before = 0
flag_dont_do_car_check_joey5 = 0
flag_leave_car_message_joey5 = 0
flag_car_in_area_joey5 = 0

{

LOAD_SPECIAL_CHARACTER 1 joey
LOAD_SPECIAL_MODEL cut_obj1 JOEYH
LOAD_SPECIAL_MODEL cut_obj2 PLAYERH
LOAD_SPECIAL_MODEL cut_obj3 TROLL
REQUEST_MODEL CAR_IDAHO
REQUEST_MODEL jogarageext
REQUEST_MODEL jogarageint

//LOAD_SCENE 1190.07 -869.86 13.97

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED jogarageext 
OR NOT HAS_MODEL_LOADED jogarageint
OR NOT HAS_MODEL_LOADED CAR_IDAHO
	WAIT 0
ENDWHILE


LOAD_CUTSCENE J5_DST
SET_CUTSCENE_OFFSET 1190.079 -869.861 13.977

CREATE_CAR CAR_IDAHO 1182.5 -857.0 14.1 cut_car2_lm3
SET_CAR_HEADING cut_car2_lm3 291.2

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_joey
SET_CUTSCENE_ANIM cs_joey joey

CREATE_CUTSCENE_HEAD cs_joey CUT_OBJ1 cs_joeyhead
SET_CUTSCENE_HEAD_ANIM cs_joeyhead joey

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT CUT_OBJ3 cs_troll
SET_CUTSCENE_ANIM cs_troll TROLL
									   	
CLEAR_AREA 1191.9 -870.4 15.0 1.0 TRUE
SET_PLAYER_COORDINATES player 1191.9 -870.4 -100.0

SET_PLAYER_HEADING player 230.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time


WHILE cs_time < 1250
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM5_A ) 10000 2 // Mission brief

WHILE cs_time < 5658
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM5_B ) 10000 2 // Mission brief

WHILE cs_time < 8419
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM5_C ) 10000 2 // Mission brief

WHILE cs_time < 12522
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM5_D ) 10000 2 // Mission brief

WHILE cs_time < 16368
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM5_E ) 10000 2 // Mission brief

WHILE cs_time < 18855
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 20000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE


DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_IDAHO
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageext 
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageint

DELETE_CAR cut_car2_lm3

on_new_objective_joey5_1 = 0
on_new_objective_joey5_2 = 0
is_lipsbrother1_car_dead = 0
is_lipsbrother2_car_dead = 0
flag_car_blip_displayed_j5 = TRUE
flag_car_crushed_joey5 = 0

REQUEST_MODEL PED_GANG_MAFIA_B
REQUEST_MODEL CAR_CORPSE
REQUEST_MODEL CAR_SENTINEL

	WHILE NOT HAS_MODEL_LOADED PED_GANG_MAFIA_B
	OR NOT HAS_MODEL_LOADED CAR_CORPSE
	OR NOT HAS_MODEL_LOADED CAR_SENTINEL
		WAIT 0
	ENDWHILE	

// START OF MISSION

CREATE_CAR CAR_CORPSE 867.2 -992.8 -100.0 deadman_car
ADD_BLIP_FOR_CAR deadman_car blip1_j5

CREATE_CAR CAR_SENTINEL 892.0 -992.3 4.6 lipsbrother1_car
SET_CAR_HEADING lipsbrother1_car 90.0
SET_CAR_STRONG lipsbrother1_car	TRUE
CREATE_CHAR_INSIDE_CAR lipsbrother1_car PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_B lipsbrother1
GIVE_WEAPON_TO_CHAR lipsbrother1 WEAPONTYPE_PISTOL 60
CAR_SET_IDLE  lipsbrother1_car
LOCK_CAR_DOORS lipsbrother1_car CARLOCK_LOCKED
SET_CAR_ONLY_DAMAGED_BY_PLAYER lipsbrother1_car TRUE

CREATE_CAR CAR_SENTINEL 800.0 -961.9 -100.0 lipsbrother2_car
SET_CAR_HEADING lipsbrother2_car 241.0
SET_CAR_STRONG lipsbrother2_car	TRUE
CREATE_CHAR_INSIDE_CAR lipsbrother2_car PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_B lipsbrother2
GIVE_WEAPON_TO_CHAR lipsbrother2 WEAPONTYPE_PISTOL 60
CAR_SET_IDLE  lipsbrother2_car
LOCK_CAR_DOORS lipsbrother2_car CARLOCK_LOCKED
SET_CAR_ONLY_DAMAGED_BY_PLAYER lipsbrother2_car TRUE

	WHILE NOT IS_PLAYER_IN_CAR player deadman_car
		WAIT 0

		IF IS_CAR_DEAD deadman_car
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey5_failed
		ENDIF

		IF IS_CAR_UPSIDEDOWN deadman_car
		AND IS_CAR_STOPPED deadman_car
			PRINT_NOW ( WRECKED ) 5000 1
   			GOTO mission_joey5_failed
   		ENDIF

		IF IS_CHAR_DEAD lipsbrother1
		AND is_lipsbrother1_car_dead = 0
			ADD_SCORE player 5000 
			is_lipsbrother1_car_dead = 1
		ENDIF

		IF IS_CHAR_DEAD lipsbrother2
		AND is_lipsbrother2_car_dead = 0
			ADD_SCORE player 5000 
			is_lipsbrother2_car_dead = 1
		ENDIF

		IF NOT IS_CAR_DEAD lipsbrother1_car
			IF NOT IS_CAR_HEALTH_GREATER lipsbrother1_car 999
				PRINT_NOW ( JM5_2 ) 5000 1 // Gosh! it's the Forelis! 
				GOTO kill_the_player
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD lipsbrother2_car
			IF NOT IS_CAR_HEALTH_GREATER lipsbrother2_car 999
				PRINT_NOW ( JM5_2 ) 5000 1 // Gosh! it's the Forelis! 
				GOTO kill_the_player
			ENDIF
		ENDIF

	ENDWHILE 

SET_POLICE_IGNORE_PLAYER Player ON
SET_PLAYER_CONTROL Player OFF
SWITCH_WIDESCREEN ON

SET_FIXED_CAMERA_POSITION 863.389 -988.698 4.350 0.0 0.0 0.0 
POINT_CAMERA_AT_POINT 864.217 -989.236 4.507 JUMP_CUT
SET_PED_DENSITY_MULTIPLIER 0.0

PRINT_NOW ( JM5_2 ) 5000 1 // Gosh! it's the Forelis! 

WAIT 1500

	IF NOT IS_CHAR_DEAD lipsbrother1
		IF NOT IS_CAR_DEAD lipsbrother1_car
			SET_CAR_MISSION lipsbrother1_car MISSION_RAMPLAYER_FARAWAY
			SET_CAR_ONLY_DAMAGED_BY_PLAYER lipsbrother1_car FALSE
			SET_CAR_CRUISE_SPEED lipsbrother1_car 40.0
			SET_CAR_DRIVING_STYLE lipsbrother1_car 2
			SET_CHAR_THREAT_SEARCH lipsbrother1 THREAT_PLAYER1
		ENDIF
	ENDIF
	
	IF NOT IS_CHAR_DEAD lipsbrother2
		IF NOT IS_CAR_DEAD lipsbrother2_car
			SET_CAR_MISSION lipsbrother2_car MISSION_BLOCKPLAYER_FARAWAY
			SET_CAR_ONLY_DAMAGED_BY_PLAYER lipsbrother2_car FALSE
			SET_CAR_CRUISE_SPEED lipsbrother2_car 40.0
			SET_CAR_DRIVING_STYLE lipsbrother2_car 2
			SET_CHAR_THREAT_SEARCH lipsbrother2 THREAT_PLAYER1
		ENDIF
	ENDIF

WAIT 1500

SET_PED_DENSITY_MULTIPLIER 1.0
SET_POLICE_IGNORE_PLAYER Player OFF
SET_PLAYER_CONTROL Player ON
SWITCH_WIDESCREEN OFF
RESTORE_CAMERA_JUMPCUT

kill_the_player:
		
		IF NOT IS_CHAR_DEAD lipsbrother1
			IF NOT IS_CAR_DEAD lipsbrother1_car
				SET_CAR_MISSION lipsbrother1_car MISSION_RAMPLAYER_FARAWAY
				SET_CAR_ONLY_DAMAGED_BY_PLAYER lipsbrother1_car FALSE
				SET_CAR_CRUISE_SPEED lipsbrother1_car 40.0
				SET_CAR_DRIVING_STYLE lipsbrother1_car 2
				SET_CHAR_THREAT_SEARCH lipsbrother1 THREAT_PLAYER1
			ENDIF
		ENDIF
		
		IF NOT IS_CHAR_DEAD lipsbrother2
			IF NOT IS_CAR_DEAD lipsbrother2_car
				SET_CAR_MISSION lipsbrother2_car MISSION_RAMPLAYER_FARAWAY
				SET_CAR_ONLY_DAMAGED_BY_PLAYER lipsbrother2_car FALSE
				SET_CAR_CRUISE_SPEED lipsbrother2_car 40.0
				SET_CAR_DRIVING_STYLE lipsbrother2_car 2
				SET_CHAR_THREAT_SEARCH lipsbrother2 THREAT_PLAYER1
			ENDIF
		ENDIF

ADD_BLIP_FOR_COORD 1139.0 54.5.0 -100.0 blip2_j5
	   
//	char_dead1 = 0
//	char_dead2 = 0

REMOVE_BLIP blip2_j5

blob_flag = 1

car_not_quite_under_crane:
	WAIT 0

	IF IS_CAR_DEAD deadman_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey5_failed
	ENDIF

WHILE NOT IS_CAR_STOPPED_IN_AREA_3D deadman_car 1135.8 55.5 -1.0 1149.8 46.3 30.0 blob_flag
	WAIT 0

	GOSUB skunk_car_check
	
	IF IS_CAR_DEAD deadman_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey5_failed
	ELSE
		
		IF IS_CAR_IN_AREA_3D deadman_car 1135.8 55.5 -1.0 1149.8 46.3 30.0 FALSE
			flag_dont_do_car_check_joey5 = 1
		
			IF flag_leave_car_message_joey5 = 0
				PRINT_NOW ( OUT_VEH ) 4000 1 //"Get out of the car!"
				flag_leave_car_message_joey5 = 1
			ENDIF

		ELSE
			flag_leave_car_message_joey5 = 0
			flag_dont_do_car_check_joey5 = 0
		ENDIF

	ENDIF

	IF IS_CAR_UPSIDEDOWN deadman_car
	AND IS_CAR_STOPPED deadman_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey5_failed
	ENDIF

	IF flag_dont_do_car_check_joey5 = 0
		IF NOT IS_CAR_DEAD deadman_car
			IF IS_PLAYER_IN_CAR player deadman_car
				IF flag_car_blip_displayed_j5 = TRUE
					ADD_BLIP_FOR_COORD 1139.0 54.5.0 -100.0 blip2_j5
					CHANGE_BLIP_DISPLAY blip2_j5 BLIP_ONLY
					REMOVE_BLIP blip1_j5
					flag_car_blip_displayed_j5 = FALSE
					blob_flag = 1
				ENDIF
			ENDIF

			IF NOT IS_PLAYER_IN_CAR player deadman_car
				IF flag_car_blip_displayed_j5 = FALSE
					ADD_BLIP_FOR_CAR deadman_car blip1_j5
					REMOVE_BLIP blip2_j5
					PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the car!"
					flag_car_blip_displayed_j5 = TRUE
					blob_flag = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF flag_player_had_crusher_help_hm5 = 0
	
		IF LOCATE_PLAYER_ANY_MEANS_2D player 1140.3 50.1 20.0 20.0 FALSE
			IF IS_PLAYER_IN_CAR player deadman_car
				PRINT_HELP ( CRUSH ) //"To crush the car..."
				flag_player_had_crusher_help_hm5 = 1
			ENDIF
		ENDIF

	ENDIF

	IF IS_PLAYER_IN_CAR player deadman_car
	AND skunk_message_played_before = 0
		PRINT_NOW ( JM5_1 ) 4000 1 // Take it to the crusher
		skunk_message_played_before = 1
	ENDIF

ENDWHILE


	IF IS_CAR_DEAD deadman_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey5_failed
	ENDIF

	blob_flag = 1


WHILE NOT IS_CRANE_LIFTING_CAR 1120.0 46.0 deadman_car
	WAIT 0

	GOSUB skunk_car_check
	
	IF IS_CAR_DEAD deadman_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey5_failed
	ENDIF
		
	IF IS_CAR_UPSIDEDOWN deadman_car
	AND IS_CAR_STOPPED deadman_car
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_joey5_failed
	ENDIF

	IF IS_CAR_STOPPED_IN_AREA_3D deadman_car 1135.8 55.5 -1.0 1149.8 46.3 20.0 blob_flag
		flag_car_in_area_joey5 = 1
	ELSE
		flag_car_in_area_joey5 = 0
	ENDIF

	IF flag_car_in_area_joey5 = 0
		IF NOT IS_CAR_DEAD deadman_car
			IF IS_PLAYER_IN_CAR player deadman_car
				IF flag_car_blip_displayed_j5 = TRUE
					ADD_BLIP_FOR_COORD 1139.0 54.5.0 -100.0 blip2_j5
					CHANGE_BLIP_DISPLAY blip2_j5 BLIP_ONLY
					REMOVE_BLIP blip1_j5
					flag_car_blip_displayed_j5 = FALSE
					blob_flag = 1
				ENDIF
			ENDIF

			IF NOT IS_PLAYER_IN_CAR player deadman_car
				IF flag_car_blip_displayed_j5 = FALSE
					ADD_BLIP_FOR_CAR deadman_car blip1_j5
					REMOVE_BLIP blip2_j5
					PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the car!"
					flag_car_blip_displayed_j5 = TRUE
					blob_flag = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
ENDWHILE

REMOVE_BLIP blip1_j5
REMOVE_BLIP blip2_j5
CLEAR_PRINTS

WHILE NOT IS_CAR_CRUSHED deadman_car
								 
		GOSUB skunk_car_check

		IF IS_CAR_DEAD deadman_car
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey5_failed
		ENDIF
		
		IF IS_CAR_CRUSHED deadman_car
			GOTO mission_joey5_passed	
		ENDIF
			
		IF IS_CAR_UPSIDEDOWN deadman_car
		AND IS_CAR_STOPPED deadman_car
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_joey5_failed
		ENDIF

	 	WAIT 0
ENDWHILE


GOTO mission_joey5_passed

}

 // Mission joey5 failed

mission_joey5_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission joey5 passed

mission_joey5_passed:

flag_joey_mission5_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 10000 
REGISTER_MISSION_PASSED	JM5
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT joey_mission6_loop
RETURN
		


// mission cleanup

mission_cleanup_joey5:

flag_player_on_mission = 0
flag_player_on_joey_mission = 0
REMOVE_BLIP blip1_j5
REMOVE_BLIP blip2_j5
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_B
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SENTINEL
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_CORPSE
IF NOT IS_CAR_DEAD lipsbrother1_car
	LOCK_CAR_DOORS lipsbrother1_car CARLOCK_UNLOCKED 
ENDIF
IF NOT IS_CAR_DEAD lipsbrother2_car
	LOCK_CAR_DOORS lipsbrother2_car CARLOCK_UNLOCKED 
ENDIF 
MISSION_HAS_FINISHED
RETURN

// *********************************************************

skunk_car_check:
{
					
	IF IS_CHAR_DEAD lipsbrother1
	AND is_lipsbrother1_car_dead = 0
		ADD_SCORE player 5000 
		is_lipsbrother1_car_dead = 1
	ENDIF

	IF IS_CHAR_DEAD lipsbrother2
	AND is_lipsbrother2_car_dead = 0
		ADD_SCORE player 5000 
		is_lipsbrother2_car_dead = 1
	ENDIF

	IF NOT IS_CAR_DEAD lipsbrother1_car

		IF IS_CAR_UPSIDEDOWN lipsbrother1_car
		AND IS_CAR_STOPPED lipsbrother1_car
		AND on_new_objective_joey5_1 = 0
			IF NOT IS_CHAR_DEAD	lipsbrother1
				LOCK_CAR_DOORS lipsbrother1_car CARLOCK_UNLOCKED
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT lipsbrother1 Player
			ENDIF
			on_new_objective_joey5_1 = 1
		ENDIF

		IF IS_CAR_IN_AREA_2D lipsbrother1_car 1122.7 2.9 1183.8 111.9 FALSE
		AND on_new_objective_joey5_1 = 0
			IF NOT IS_CHAR_DEAD	lipsbrother1
				LOCK_CAR_DOORS lipsbrother1_car CARLOCK_UNLOCKED
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT lipsbrother1 Player
			ENDIF
			on_new_objective_joey5_1 = 1
		ENDIF

	ENDIF

	IF NOT IS_CAR_DEAD lipsbrother2_car

		IF IS_CAR_UPSIDEDOWN lipsbrother2_car
		AND IS_CAR_STOPPED lipsbrother2_car
		AND on_new_objective_joey5_2 = 0
			IF NOT IS_CHAR_DEAD	lipsbrother2
				LOCK_CAR_DOORS lipsbrother2_car CARLOCK_UNLOCKED
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT lipsbrother2 Player
			ENDIF
			on_new_objective_joey5_2 = 1
		ENDIF

		IF NOT IS_CAR_DEAD lipsbrother2_car
			IF IS_CAR_IN_AREA_2D lipsbrother2_car 1122.7 2.9 1183.8 111.9 FALSE
			AND on_new_objective_joey5_1 = 0
				IF NOT IS_CHAR_DEAD	lipsbrother2
					LOCK_CAR_DOORS lipsbrother2_car CARLOCK_UNLOCKED
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT lipsbrother2 Player
				ENDIF
				on_new_objective_joey5_1 = 1
			ENDIF
		ENDIF

	ENDIF

RETURN
}


MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// **************************************Joey Mission 6***************************************
// ****************************************Bank Job/ The Getaway******************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************


// Mission start stuff

GOSUB mission_start_joey6

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_joey6_failed
ENDIF

GOSUB mission_cleanup_joey6

MISSION_END


// Variables for mission

VAR_INT thug1 thug2 thug3 thugs_score joey_alarm_loop  flag_not_enough_seats

VAR_INT blip1_jm6 blip2_jm6 blip3_jm6 blip4_jm6 thug1_blip thug2_blip thug3_blip	

VAR_INT any_car_jm6 maxpassengers sound_already_created_before

VAR_INT flag_displayed_horn_message_jm6	flag_displayed_wanted_message_jm6

VAR_INT thug1_is_dead thug2_is_dead thug3_is_dead blip_for_thug_added1 blip_for_thug_added2 blip_for_thug_added3

VAR_INT objective_count objective_count_done_before1 objective_count_done_before2 objective_count_done_before3

VAR_FLOAT bankdoor_X bankdoor_Y bankdoor_Z bankdoor2_X bankdoor2_Y bankdoor2_Z

// ***************************************Mission Start*************************************


mission_start_joey6:

REGISTER_MISSION_GIVEN

DISPLAY_RADAR 4 // HACKED RADAR STOP AT STREET

flag_player_on_mission = 1
flag_player_on_joey_mission = 1
SCRIPT_NAME joey6
WAIT 0

{
LOAD_SPECIAL_CHARACTER 1 joey
LOAD_SPECIAL_MODEL cut_obj1 JOEYH
LOAD_SPECIAL_MODEL cut_obj2 PLAYERH
LOAD_SPECIAL_MODEL cut_obj3 TROLL
REQUEST_MODEL CAR_STALLION
REQUEST_MODEL jogarageext
REQUEST_MODEL jogarageint

LOAD_ALL_MODELS_NOW

//LOAD_SCENE 1190.07 -869.86 13.97

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED jogarageext 
OR NOT HAS_MODEL_LOADED jogarageint
OR NOT HAS_MODEL_LOADED CAR_STALLION
	WAIT 0
ENDWHILE

LOAD_CUTSCENE J6_TBJ
SET_CUTSCENE_OFFSET 1190.079 -869.861 13.977

CREATE_CAR CAR_STALLION 1192.9 -860.8 14.0 cut_car3_lm3
SET_CAR_HEADING cut_car3_lm3 150.0

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_joey
SET_CUTSCENE_ANIM cs_joey joey

CREATE_CUTSCENE_HEAD cs_joey CUT_OBJ1 cs_joeyhead
SET_CUTSCENE_HEAD_ANIM cs_joeyhead joey

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT CUT_OBJ3 cs_troll
SET_CUTSCENE_ANIM cs_troll TROLL
									  
CLEAR_AREA 1191.9 -870.4 15.0 1.0 TRUE
SET_PLAYER_COORDINATES player 1191.9 -870.4 -100.0

SET_PLAYER_HEADING player 230.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 4434
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM6_A ) 10000 2 // Mission brief

WHILE cs_time < 6704
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM6_B ) 10000 2 // Mission brief

WHILE cs_time < 12000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM6_C ) 10000 2 // Mission brief

WHILE cs_time < 14274
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM6_D ) 10000 2 // Mission brief

WHILE cs_time < 17302
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( JM6_E ) 10000 2 // Mission brief
		 
WHILE cs_time < 21000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STALLION
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageext 
MARK_MODEL_AS_NO_LONGER_NEEDED jogarageint

DELETE_CAR cut_car3_lm3

thugs_score	= 0
sound_already_created_before = 0
flag_not_enough_seats = 0

LOAD_SPECIAL_CHARACTER 2 robber

	WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 2
		WAIT 0
	ENDWHILE



// START OF MISSION

ADD_BLIP_FOR_COORD 1086.0 -227.0 -100.0 blip1_jm6
CHANGE_BLIP_DISPLAY blip1_jm6 BLIP_ONLY

flag_displayed_horn_message_jm6 = 0
flag_displayed_wanted_message_jm6 = 0

thug1_is_dead = 0
thug2_is_dead = 0
thug3_is_dead = 0
blip_for_thug_added1 = 0
blip_for_thug_added2 = 0
blip_for_thug_added3 = 0

//PICK UP THE THUGS

pick_up_thugs:
WAIT 0

WHILE NOT IS_PLAYER_STOPPED_IN_AREA_IN_CAR_2D player 1089.9 -223.9 1084.5 -228.5 TRUE
OR NOT IS_PLAYER_PRESSING_HORN player
OR IS_WANTED_LEVEL_GREATER Player 0    	
	WAIT 0

	IF IS_PLAYER_STOPPED_IN_AREA_IN_CAR_2D player 1089.9 -223.9 1084.5 -228.5 FALSE

		IF IS_WANTED_LEVEL_GREATER player 0
			IF flag_not_enough_seats = 0
				PRINT_NOW ( WANTED1 ) 5000 1
			ENDIF
		ELSE
			IF flag_not_enough_seats = 0
				PRINT_NOW ( HORN ) 5000 1
			ENDIF
		ENDIF
	ELSE
		flag_not_enough_seats = 0
	ENDIF

	IF NOT IS_PLAYER_IN_AREA_IN_CAR_2D player 1089.9 -223.9 1084.5 -228.5 FALSE
		CLEAR_THIS_PRINT ( WANTED1 )
		CLEAR_THIS_PRINT ( HORN )
	ENDIF

	IF IS_PLAYER_IN_AREA_ON_FOOT_2D player 1089.9 -223.9 1084.5 -228.5 FALSE
		PRINT_NOW ( JM6_5 ) 5000 1 //"We need a getaway vehicle"
	ELSE
		CLEAR_THIS_PRINT ( JM6_5 )
	ENDIF

	GET_TIME_OF_DAY hours minutes
	IF hours >= 17
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_joey6_failed
	ENDIF

ENDWHILE  								

	STORE_CAR_PLAYER_IS_IN player any_car_jm6

	GET_MAXIMUM_NUMBER_OF_PASSENGERS any_car_jm6 maxpassengers

	CLEAR_THIS_PRINT ( WANTED1 )
	CLEAR_THIS_PRINT ( HORN )

	IF NOT maxpassengers > 2	//	GSW - Changed this from a WHILE
		PRINT_NOW ( NODOORS ) 5000 1 //Car not big enough
		flag_not_enough_seats = 1	
		GOTO pick_up_thugs
	ENDIF

	IF IS_PLAYER_IN_MODEL Player CAR_COACH
	OR IS_PLAYER_IN_MODEL Player CAR_BUS
		PRINT_NOW ( JM6_6 ) 5000 1 //Go and get a vehicle less conspicuous
		flag_not_enough_seats = 1		
		GOTO pick_up_thugs
	ENDIF

//PICK UP THUGS CUT_SCENE**************************************************************************************
 
CLEAR_AREA 1087.7 -229.2 8.0 6.0 TRUE

IF NOT IS_CAR_DEAD any_car_jm6
	LOCK_CAR_DOORS any_car_jm6 CARLOCK_LOCKED_PLAYER_INSIDE
ENDIF

WAIT 500

SET_PLAYER_CONTROL Player OFF
SWITCH_WIDESCREEN ON
SET_POLICE_IGNORE_PLAYER Player ON
SET_EVERYONE_IGNORE_PLAYER Player ON

IF NOT IS_CAR_DEAD any_car_jm6
	LOCK_CAR_DOORS any_car_jm6 CARLOCK_UNLOCKED
ENDIF

	REMOVE_BLIP blip1_jm6

	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 1086.5 -238.3 9.0 thug1
	TURN_CHAR_TO_FACE_PLAYER thug1 Player
	CHAR_SET_IDLE thug1

	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 1088.4 -237.9 9.0 thug2
	TURN_CHAR_TO_FACE_PLAYER thug2 Player
	CHAR_SET_IDLE thug2

	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 1090.4 -238.0 9.0 thug3
	TURN_CHAR_TO_FACE_PLAYER thug3 Player
	CHAR_SET_IDLE thug3

	GIVE_WEAPON_TO_CHAR thug1 WEAPONTYPE_PISTOL 100
	GIVE_WEAPON_TO_CHAR thug2 WEAPONTYPE_SHOTGUN 50
	GIVE_WEAPON_TO_CHAR thug3 WEAPONTYPE_UZI 100

SET_FIXED_CAMERA_POSITION 1078.773 -232.474 12.190 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 1079.691 -232.132 11.990 JUMP_CUT
	
	//APPLY_BRAKES_TO_PLAYERS_CAR Player On

	SET_CHAR_PERSONALITY thug1 PEDSTAT_TOUGH_GUY
	SET_CHAR_PERSONALITY thug2 PEDSTAT_TOUGH_GUY
	SET_CHAR_PERSONALITY thug3 PEDSTAT_TOUGH_GUY

	SET_CHAR_THREAT_SEARCH thug1 THREAT_COP
	SET_CHAR_THREAT_SEARCH thug2 THREAT_COP
	SET_CHAR_THREAT_SEARCH thug3 THREAT_COP

WAIT 1000

WHILE NOT SLIDE_OBJECT Bank_job_door 1087.523 -233.801 13.5 0.0 0.0 0.07 FALSE
	WAIT 0

	GET_TIME_OF_DAY hours minutes
	IF hours >= 17
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_joey6_failed
	ENDIF

	IF IS_CHAR_DEAD thug1
	OR IS_CHAR_DEAD thug2
	OR IS_CHAR_DEAD thug3
		PRINT_NOW ( JM6_7 ) 5000 1
		GOTO mission_joey6_failed
	ENDIF

ENDWHILE

IF NOT IS_CHAR_DEAD thug1
	SET_PLAYER_AS_LEADER thug1 player
	SET_CHAR_RUNNING thug1 TRUE
	// 3master these guys can die inadvertantly
	SET_CHAR_PROOFS thug1 TRUE TRUE TRUE TRUE TRUE
	WAIT 800
ENDIF

IF NOT IS_CHAR_DEAD thug2
	SET_PLAYER_AS_LEADER thug2 player
	SET_CHAR_RUNNING thug2 TRUE
	SET_CHAR_PROOFS thug2 TRUE TRUE TRUE TRUE TRUE
	WAIT 800
ENDIF

IF NOT IS_CHAR_DEAD thug3
	SET_PLAYER_AS_LEADER thug3 player
	SET_CHAR_RUNNING thug3 TRUE
	SET_CHAR_PROOFS thug3 TRUE TRUE TRUE TRUE TRUE
	//WAIT 400
ENDIF


IF NOT IS_CAR_DEAD any_car_jm6
AND NOT IS_CHAR_DEAD thug1
AND NOT IS_CHAR_DEAD thug2
AND NOT IS_CHAR_DEAD thug3

TIMERB = 0

	WHILE NOT IS_CHAR_IN_CAR thug1 any_car_jm6 
	OR NOT IS_CHAR_IN_CAR thug2 any_car_jm6 
	OR NOT IS_CHAR_IN_CAR thug3 any_car_jm6 
		WAIT 0

			IF IS_CHAR_DEAD thug1
			OR IS_CHAR_DEAD thug2
			OR IS_CHAR_DEAD thug3
				PRINT_NOW ( JM6_7 ) 5000 1
				GOTO mission_joey6_failed
			ENDIF
			
			IF IS_CAR_DEAD any_car_jm6
				GOTO mission_joey6_failed
			ENDIF

			GET_TIME_OF_DAY hours minutes
			IF hours >= 17
				PRINT_NOW ( OUTTIME ) 5000 1
				GOTO mission_joey6_failed
			ENDIF

			IF TIMERB > 15000
				GOTO next_robber_bit
			ENDIF

	ENDWHILE

ENDIF

next_robber_bit:

IF NOT IS_CHAR_DEAD thug1
	// 3master these guys can die inadvertantly
	SET_CHAR_PROOFS thug1 FALSE FALSE FALSE FALSE FALSE
ENDIF

IF NOT IS_CHAR_DEAD thug2
	SET_CHAR_PROOFS thug2 FALSE FALSE FALSE FALSE FALSE
ENDIF

IF NOT IS_CHAR_DEAD thug3
	SET_CHAR_PROOFS thug3 FALSE FALSE FALSE FALSE FALSE
ENDIF

//SAMPLE1*********************************************************
LOAD_MISSION_AUDIO J6_A

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE

PLAY_MISSION_AUDIO

RESTORE_CAMERA_JUMPCUT
APPLY_BRAKES_TO_PLAYERS_CAR Player OFF
SET_PLAYER_CONTROL Player ON
SWITCH_WIDESCREEN OFF
SET_POLICE_IGNORE_PLAYER Player OFF
SET_EVERYONE_IGNORE_PLAYER Player OFF

//END OF PICK UP THUGS CUT_SCENE*******************************************************************************

	PRINT_NOW ( JM6_1 ) 5000 1 //"Lets go"

WHILE NOT SLIDE_OBJECT Bank_job_door 1087.523 -233.801 11.012 0.0 0.0 0.2 FALSE
	WAIT 0

	GET_TIME_OF_DAY hours minutes
	IF hours >= 17
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_joey6_failed
	ENDIF

	IF IS_CHAR_DEAD thug1
	OR IS_CHAR_DEAD thug2
	OR IS_CHAR_DEAD thug3
		PRINT_NOW ( JM6_7 ) 5000 1
		GOTO mission_joey6_failed
	ENDIF

ENDWHILE
	
	ADD_BLIP_FOR_COORD 1038.0 -700.0 -100.0 blip3_jm6
	//CHANGE_BLIP_DISPLAY blip3_jm6 BLIP_ONLY
	flag_displayed_wanted_message_jm6 = 0
	
		
//GET TO THE BANK
get_to_the_bank:
WAIT 0

	IF IS_CAR_DEAD any_car_jm6
		//Do nothing
	ENDIF

WHILE NOT IS_PLAYER_STOPPED_IN_AREA_3D player 1040.5 -691.5 14.0 1043.8 -698.5 17.0 TRUE
OR NOT IS_PLAYER_IN_ANY_CAR player
OR IS_WANTED_LEVEL_GREATER Player 0    	
	WAIT 0

	IF IS_CAR_DEAD any_car_jm6
		//GO GET ANOTHER ONE	
	ENDIF

	IF IS_PLAYER_IN_ANY_CAR Player
		STORE_CAR_PLAYER_IS_IN player any_car_jm6
	ENDIF

	IF NOT IS_CHAR_DEAD thug1
		IF NOT IS_CHAR_IN_PLAYERS_GROUP	thug1 player
			IF blip_for_thug_added1 = 0
				ADD_BLIP_FOR_CHAR thug1 thug1_blip
				blip_for_thug_added1 = 1
			ENDIF
	   	
			IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug1 30.0 30.0 FALSE
		   		IF blip_for_thug_added1 = 1
					SET_PLAYER_AS_LEADER thug1 player
					REMOVE_BLIP	thug1_blip
					blip_for_thug_added1 = 0
				ENDIF
			ENDIF
	   	ENDIF	
	ENDIF

	IF NOT IS_CHAR_DEAD thug2
		IF NOT IS_CHAR_IN_PLAYERS_GROUP	thug2 player
			IF blip_for_thug_added2 = 0
				ADD_BLIP_FOR_CHAR thug2 thug2_blip
				blip_for_thug_added2 = 1
			ENDIF
	   	
			IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug2 30.0 30.0 FALSE
		   		IF blip_for_thug_added2 = 1
					SET_PLAYER_AS_LEADER thug2 player
					REMOVE_BLIP	thug2_blip
					blip_for_thug_added2 = 0
				ENDIF
			ENDIF
	   	ENDIF	
	ENDIF

	IF NOT IS_CHAR_DEAD thug3
		IF NOT IS_CHAR_IN_PLAYERS_GROUP	thug3 player
			IF blip_for_thug_added3 = 0
				ADD_BLIP_FOR_CHAR thug3 thug3_blip
				blip_for_thug_added3 = 1
			ENDIF
	   	
			IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug3 30.0 30.0 FALSE
		   		IF blip_for_thug_added3 = 1
					SET_PLAYER_AS_LEADER thug3 player
					REMOVE_BLIP	thug3_blip
					blip_for_thug_added3 = 0
				ENDIF
			ENDIF
	   	ENDIF	
	ENDIF

	IF IS_CHAR_DEAD thug1
	OR IS_CHAR_DEAD thug2
	OR IS_CHAR_DEAD thug3
		PRINT_NOW ( JM6_7 ) 5000 1
		GOTO mission_joey6_failed
	ENDIF

	IF IS_PLAYER_STOPPED_IN_AREA_IN_CAR_3D player 1040.5 -691.5 14.0 1043.8 -698.5 17.0 FALSE
		IF IS_WANTED_LEVEL_GREATER player 0
			IF flag_displayed_wanted_message_jm6 = 0
				PRINT_NOW ( WANTED1 ) 5000 1
				flag_displayed_wanted_message_jm6 = 1
			ENDIF
		ENDIF
	ELSE
		IF NOT IS_PLAYER_IN_AREA_3D player 1040.5 -691.5 14.0 1043.8 -698.5 17.0 FALSE
			flag_displayed_wanted_message_jm6 = 0
		ENDIF
	ENDIF

	IF IS_PLAYER_IN_AREA_ON_FOOT_3D player 1040.5 -691.5 14.0 1043.8 -698.5 17.0 FALSE
		PRINT_NOW ( JM6_5 ) 5000 1 //"We need a getaway vehicle"
	ELSE
		CLEAR_THIS_PRINT ( JM6_5 )
	ENDIF

	GET_TIME_OF_DAY hours minutes
	IF hours >= 17
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_joey6_failed
	ENDIF

ENDWHILE

IF IS_PLAYER_IN_MODEL Player CAR_COACH
OR IS_PLAYER_IN_MODEL Player CAR_BUS
	PRINT_NOW ( JM6_6 ) 5000 1 //Go and get a vehicle less conspicuous
	//WAIT 3000	
	GOTO get_to_the_bank
ENDIF

IF IS_CHAR_DEAD thug1
OR IS_CHAR_DEAD thug2
OR IS_CHAR_DEAD thug3
	PRINT_NOW ( JM6_7 ) 5000 1
	GOTO mission_joey6_failed
ENDIF

IF NOT IS_CHAR_IN_CAR thug1 any_car_jm6
OR NOT IS_CHAR_IN_CAR thug2 any_car_jm6
OR NOT IS_CHAR_IN_CAR thug3 any_car_jm6
	PRINT_NOW ( JM6_7 ) 5000 1 //Go and get a vehicle less conspicuous
	//WAIT 3000	
	GOTO get_to_the_bank
ENDIF

// BANK ROBBERY CUT SCENE**************************************************************************************

CLEAR_AREA 1037.3 -699.6 15.0 6.0 TRUE
SET_PED_DENSITY_MULTIPLIER 0.0

SET_PLAYER_CONTROL Player OFF
SWITCH_WIDESCREEN ON
SET_POLICE_IGNORE_PLAYER Player ON
SET_EVERYONE_IGNORE_PLAYER Player On
APPLY_BRAKES_TO_PLAYERS_CAR Player ON

SET_FIXED_CAMERA_POSITION 1036.448 -705.615 14.512 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 1036.637 -704.639 14.624 JUMP_CUT
	
	REMOVE_BLIP blip3_jm6

//SAMPLE2*********************************************************

	LOAD_MISSION_AUDIO J6_B

	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE

	PLAY_MISSION_AUDIO

	PRINT_NOW ( JM6_2 ) 5000 1 //"Wait here"


	STORE_CAR_PLAYER_IS_IN player any_car_jm6

	IF NOT IS_CAR_DEAD any_car_jm6 
		IF NOT IS_CHAR_DEAD thug1
			LEAVE_GROUP thug1
			SET_CHAR_OBJ_LEAVE_CAR thug1 any_car_jm6
		ENDIF
	ENDIF

	WAIT 400	
	
	IF NOT IS_CAR_DEAD any_car_jm6 
		IF NOT IS_CHAR_DEAD thug2 
			LEAVE_GROUP thug2
			SET_CHAR_OBJ_LEAVE_CAR thug2 any_car_jm6
		ENDIF
	ENDIF

	WAIT 400	

	IF NOT IS_CAR_DEAD any_car_jm6	
		IF NOT IS_CHAR_DEAD thug3 
			LEAVE_GROUP thug3
			SET_CHAR_OBJ_LEAVE_CAR thug3 any_car_jm6
		ENDIF
	ENDIF


objective_count = 0
objective_count_done_before1 = 0
objective_count_done_before2 = 0
objective_count_done_before3 = 0


//WAITING FOR THUGS TO GET OUT OF CAR

WHILE NOT objective_count = 3   

		WAIT 0

		IF IS_CHAR_DEAD thug1
		AND objective_count_done_before1 = 0
			objective_count ++
			objective_count_done_before1 = 1
			thug1_is_dead = 1
		ENDIF

		IF IS_CHAR_DEAD thug2
		AND objective_count_done_before2 = 0
			objective_count ++
			objective_count_done_before2 = 1
			thug2_is_dead = 1
		ENDIF

		IF IS_CHAR_DEAD thug3
		AND objective_count_done_before3 = 0
			objective_count ++
			objective_count_done_before3 = 1
			thug3_is_dead = 1
		ENDIF

		IF thug1_is_dead = 1
		AND thug2_is_dead = 1
		AND thug3_is_dead = 1
			GOTO mission_joey6_failed
		ENDIF
			
		IF IS_CAR_DEAD any_car_jm6
			GOTO mission_joey6_failed
		ENDIF

		IF NOT IS_CAR_DEAD any_car_jm6
		AND NOT IS_CHAR_DEAD thug1
			IF thug1_is_dead = 0
				IF NOT IS_CHAR_IN_CAR thug1 any_car_jm6 
				AND objective_count_done_before1 = 0					
					SET_CHAR_OBJ_RUN_TO_COORD thug1 1037.4 -699.9
					WAIT 300
					objective_count ++
					objective_count_done_before1 = 1						
				ENDIF
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD any_car_jm6
		AND NOT IS_CHAR_DEAD thug2
			IF thug2_is_dead = 0
				IF NOT IS_CHAR_IN_CAR thug2 any_car_jm6 
				AND objective_count_done_before2 = 0					
					SET_CHAR_OBJ_RUN_TO_COORD thug2 1037.4 -699.9
					WAIT 300
					objective_count ++
					objective_count_done_before2 = 1						
				ENDIF
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD any_car_jm6
		AND NOT IS_CHAR_DEAD thug3
			IF thug3_is_dead = 0
				IF NOT IS_CHAR_IN_CAR thug3 any_car_jm6 
				AND objective_count_done_before3 = 0					
					SET_CHAR_OBJ_RUN_TO_COORD thug3 1037.4 -699.9
					objective_count ++
					objective_count_done_before3 = 1						
				ENDIF
			ENDIF
		ENDIF	

ENDWHILE

//THUGS GO IN THE BANK
 /*
	IF NOT IS_CHAR_DEAD thug1
		SET_CHAR_OBJ_RUN_TO_COORD thug1 1037.4 -699.9
		WAIT 400
	ENDIF

	IF NOT IS_CHAR_DEAD thug2
		SET_CHAR_OBJ_RUN_TO_COORD thug2 1037.4 -699.9 
		WAIT 400
	ENDIF

	IF NOT IS_CHAR_DEAD thug3
		SET_CHAR_OBJ_RUN_TO_COORD thug3 1037.4 -699.9 
	ENDIF
  */
objective_count = 0
objective_count_done_before1 = 0
objective_count_done_before2 = 0
objective_count_done_before3 = 0

GET_OBJECT_COORDINATES bankdoor1 bankdoor_X bankdoor_Y bankdoor_Z
bankdoor_Y = bankdoor_Y - 1.0

GET_OBJECT_COORDINATES bankdoor2 bankdoor2_X bankdoor2_Y bankdoor2_Z
bankdoor2_Y = bankdoor2_Y + 1.0

WHILE NOT SLIDE_OBJECT bankdoor1 bankdoor_X bankdoor_Y bankdoor_Z 0.0 0.1 0.0 FALSE
OR NOT SLIDE_OBJECT bankdoor2 bankdoor2_X bankdoor2_Y bankdoor2_Z 0.0 0.1 0.0 FALSE
	WAIT 0

ENDWHILE


TIMERB = 0

WHILE NOT objective_count = 3

	WAIT 0

		IF IS_CHAR_DEAD thug1
		AND objective_count_done_before1 = 0
			objective_count ++
			objective_count_done_before1 = 1
			thug1_is_dead = 1
		ENDIF

		IF IS_CHAR_DEAD thug2
		AND objective_count_done_before2 = 0
			objective_count ++
			objective_count_done_before2 = 1
			thug2_is_dead = 1
		ENDIF

		IF IS_CHAR_DEAD thug3
		AND objective_count_done_before3 = 0
			objective_count ++
			objective_count_done_before3 = 1
			thug3_is_dead = 1
		ENDIF

		IF thug1_is_dead = 1
		AND thug2_is_dead = 1
		AND thug3_is_dead = 1
			GOTO mission_joey6_failed
		ENDIF

		IF thug1_is_dead = 0
			IF IS_CHAR_OBJECTIVE_PASSED thug1
			AND objective_count_done_before1 = 0
				SET_CHAR_OBJ_RUN_TO_COORD thug1 1032.9 -700.2		
				objective_count ++
				objective_count_done_before1 = 1		
			ENDIF
		ENDIF

		IF thug2_is_dead = 0
			IF IS_CHAR_OBJECTIVE_PASSED thug2
			AND objective_count_done_before2 = 0
				SET_CHAR_OBJ_RUN_TO_COORD thug2 1032.9 -700.2		
				objective_count ++
				objective_count_done_before2 = 1		
			ENDIF
		ENDIF

		IF thug3_is_dead = 0
			IF IS_CHAR_OBJECTIVE_PASSED thug3
			AND objective_count_done_before3 = 0
				SET_CHAR_OBJ_RUN_TO_COORD thug3 1032.9 -700.2		
				objective_count ++
				objective_count_done_before3 = 1		
			ENDIF
		ENDIF

		IF TIMERB > 15000
			IF NOT IS_CHAR_DEAD	thug1
				SET_CHAR_COORDINATES thug1 1037.4 -699.9 13.9
			ENDIF
			IF NOT IS_CHAR_DEAD	thug2
				SET_CHAR_COORDINATES thug2 1037.4 -699.9 13.9
			ENDIF
			IF NOT IS_CHAR_DEAD	thug3
				SET_CHAR_COORDINATES thug3 1037.4 -699.9 13.9
			ENDIF
		ENDIF

		
ENDWHILE

objective_count = 0
objective_count_done_before1 = 0
objective_count_done_before2 = 0
objective_count_done_before3 = 0


TIMERB = 0

WHILE NOT objective_count = 3

	WAIT 0

		IF IS_CHAR_DEAD thug1
		AND objective_count_done_before1 = 0
			objective_count ++
			objective_count_done_before1 = 1
			thug1_is_dead = 1
		ENDIF

		IF IS_CHAR_DEAD thug2
		AND objective_count_done_before2 = 0
			objective_count ++
			objective_count_done_before2 = 1
			thug2_is_dead = 1
		ENDIF

		IF IS_CHAR_DEAD thug3
		AND objective_count_done_before3 = 0
			objective_count ++
			objective_count_done_before3 = 1
			thug3_is_dead = 1
		ENDIF

		IF thug1_is_dead = 1
		AND thug2_is_dead = 1
		AND thug3_is_dead = 1
			GOTO mission_joey6_failed
		ENDIF

		IF thug1_is_dead = 0
			IF IS_CHAR_OBJECTIVE_PASSED thug1
			AND objective_count_done_before1 = 0		
				SET_CHAR_COORDINATES thug1 1104.0 -792.0 14.0
				SET_CHAR_OBJ_WAIT_ON_FOOT thug1
				objective_count ++
				objective_count_done_before1 = 1		
			ENDIF
		ENDIF

		IF thug2_is_dead = 0
			IF IS_CHAR_OBJECTIVE_PASSED thug2
			AND objective_count_done_before2 = 0		
				SET_CHAR_COORDINATES thug2 1102.0 -792.0 14.0
				SET_CHAR_OBJ_WAIT_ON_FOOT thug2
				objective_count ++
				objective_count_done_before2 = 1		
			ENDIF
		ENDIF

		IF thug3_is_dead = 0
			IF IS_CHAR_OBJECTIVE_PASSED thug3
			AND objective_count_done_before3 = 0		
				SET_CHAR_COORDINATES thug3 1100.0 -792.0 14.0
				SET_CHAR_OBJ_WAIT_ON_FOOT thug3
				objective_count ++
				objective_count_done_before3 = 1		
			ENDIF
		ENDIF

		IF TIMERB > 15000
			IF NOT IS_CHAR_DEAD	thug1
				SET_CHAR_COORDINATES thug1 1032.9 -700.2 13.9
			ENDIF
			IF NOT IS_CHAR_DEAD	thug2
				SET_CHAR_COORDINATES thug2 1032.9 -700.2 13.9
			ENDIF
			IF NOT IS_CHAR_DEAD	thug3
				SET_CHAR_COORDINATES thug3 1032.9 -700.2 13.9
			ENDIF
		ENDIF

ENDWHILE

LOAD_MISSION_AUDIO J6_1

GET_OBJECT_COORDINATES bankdoor1 bankdoor_X bankdoor_Y bankdoor_Z
bankdoor_Y = bankdoor_Y + 1.0

GET_OBJECT_COORDINATES bankdoor2 bankdoor2_X bankdoor2_Y bankdoor2_Z
bankdoor2_Y = bankdoor2_Y - 1.0

WHILE NOT SLIDE_OBJECT bankdoor1 bankdoor_X bankdoor_Y bankdoor_Z 0.0 0.1 0.0 FALSE
OR NOT SLIDE_OBJECT bankdoor2 bankdoor2_X bankdoor2_Y bankdoor2_Z 0.0 0.1 0.0 FALSE
	WAIT 0

ENDWHILE


//WAIT 1000

	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE

	PLAY_MISSION_AUDIO

	WHILE NOT HAS_MISSION_AUDIO_FINISHED
		WAIT 0

	ENDWHILE

WAIT 1000

//THUGS COME OUT OF BANK

CLEAR_AREA 1037.3 -699.6 15.0 4.0 TRUE

GET_OBJECT_COORDINATES bankdoor1 bankdoor_X bankdoor_Y bankdoor_Z
bankdoor_Y = bankdoor_Y - 1.0

GET_OBJECT_COORDINATES bankdoor2 bankdoor2_X bankdoor2_Y bankdoor2_Z
bankdoor2_Y = bankdoor2_Y + 1.0

WHILE NOT SLIDE_OBJECT bankdoor1 bankdoor_X bankdoor_Y bankdoor_Z 0.0 0.1 0.0 FALSE
OR NOT SLIDE_OBJECT bankdoor2 bankdoor2_X bankdoor2_Y bankdoor2_Z 0.0 0.1 0.0 FALSE
	WAIT 0

ENDWHILE

	IF NOT IS_CHAR_DEAD thug1		   
	   SET_CHAR_COORDINATES thug1 1032.9 -700.2 15.0
	   SET_CHAR_OBJ_RUN_TO_COORD thug1 1036.9 -700.2
	   //SET_PLAYER_AS_LEADER thug1 player
	ENDIF

	WAIT 800

	IF NOT IS_CHAR_DEAD thug2
		SET_CHAR_COORDINATES thug2 1032.9 -700.2 15.0
	    SET_CHAR_OBJ_RUN_TO_COORD thug2 1036.9 -700.2
	ENDIF

	WAIT 500  // GS-SC: Make this look less unnatural

	IF NOT IS_CHAR_DEAD thug3
		SET_CHAR_COORDINATES thug3 1032.9 -700.2 15.0
	    SET_CHAR_OBJ_RUN_TO_COORD thug3 1036.9 -700.2
	ENDIF

objective_count = 0
objective_count_done_before1 = 0
objective_count_done_before2 = 0
objective_count_done_before3 = 0


TIMERB = 0

WHILE NOT objective_count = 3
	WAIT 0

	IF IS_CHAR_DEAD thug1
	AND objective_count_done_before1 = 0
		objective_count ++
		objective_count_done_before1 = 1
		thug1_is_dead = 1
	ENDIF

	IF IS_CHAR_DEAD thug2
	AND objective_count_done_before2 = 0
		objective_count ++
		objective_count_done_before2 = 1
		thug2_is_dead = 1
	ENDIF

	IF IS_CHAR_DEAD thug3
	AND objective_count_done_before3 = 0
		objective_count ++
		objective_count_done_before3 = 1
		thug3_is_dead = 1
	ENDIF

	IF thug1_is_dead = 1
	AND thug2_is_dead = 1
	AND thug3_is_dead = 1
		GOTO mission_joey6_failed
	ENDIF

	IF thug1_is_dead = 0
		IF IS_CHAR_OBJECTIVE_PASSED thug1
		AND objective_count_done_before1 = 0		
			SET_PLAYER_AS_LEADER thug1 player
			objective_count ++
			objective_count_done_before1 = 1		
		ENDIF
	ENDIF

	IF thug2_is_dead = 0
		IF IS_CHAR_OBJECTIVE_PASSED thug2
		AND objective_count_done_before2 = 0		
			SET_PLAYER_AS_LEADER thug2 player
			objective_count ++
			objective_count_done_before2 = 1		
		ENDIF
	ENDIF

	IF thug3_is_dead = 0
		IF IS_CHAR_OBJECTIVE_PASSED thug3
		AND objective_count_done_before3 = 0		
			SET_PLAYER_AS_LEADER thug3 player
			objective_count ++
			objective_count_done_before3 = 1		
		ENDIF
	ENDIF

	IF TIMERB > 15000
		IF NOT IS_CHAR_DEAD	thug1
			SET_CHAR_COORDINATES thug1 1036.9 -700.2 13.9
		ENDIF
		IF NOT IS_CHAR_DEAD	thug2
			SET_CHAR_COORDINATES thug2 1036.9 -700.2 13.9
		ENDIF
		IF NOT IS_CHAR_DEAD	thug3
			SET_CHAR_COORDINATES thug3 1036.9 -700.2 13.9
		ENDIF
	ENDIF

ENDWHILE

ADD_CONTINUOUS_SOUND 1034.8 -700.1 15.0 SOUND_BANK_ALARM_LOOP_L joey_alarm_loop 
sound_already_created_before = 1

//SAMPLE3*********************************************************
	LOAD_MISSION_AUDIO J6_D

	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE

	PLAY_MISSION_AUDIO



	GET_OBJECT_COORDINATES bankdoor1 bankdoor_X bankdoor_Y bankdoor_Z
	bankdoor_Y = bankdoor_Y + 1.0

	GET_OBJECT_COORDINATES bankdoor2 bankdoor2_X bankdoor2_Y bankdoor2_Z
	bankdoor2_Y = bankdoor2_Y - 1.0

	WHILE NOT SLIDE_OBJECT bankdoor1 bankdoor_X bankdoor_Y bankdoor_Z 0.0 0.1 0.0 FALSE
	OR NOT SLIDE_OBJECT bankdoor2 bankdoor2_X bankdoor2_Y bankdoor2_Z 0.0 0.1 0.0 FALSE
		WAIT 0

	ENDWHILE

WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0

ENDWHILE

objective_count = 0
objective_count_done_before1 = 0
objective_count_done_before2 = 0
objective_count_done_before3 = 0




TIMERB = 0

WHILE NOT objective_count = 3 //WAITING FOR THUGS TO GET BACK INTO CAR  

	WAIT 0

	IF IS_CHAR_DEAD thug1
	AND objective_count_done_before1 = 0
		objective_count ++
		objective_count_done_before1 = 1
		thug1_is_dead = 1
	ENDIF

	IF IS_CHAR_DEAD thug2
	AND objective_count_done_before2 = 0
		objective_count ++
		objective_count_done_before2 = 1
		thug2_is_dead = 1
	ENDIF

	IF IS_CHAR_DEAD thug3
	AND objective_count_done_before3 = 0
		objective_count ++
		objective_count_done_before3 = 1
		thug3_is_dead = 1
	ENDIF


	IF thug1_is_dead = 1
	AND thug2_is_dead = 1
	AND thug3_is_dead = 1
		GOTO mission_joey6_failed
	ENDIF

//	STORE_CAR_PLAYER_IS_IN player any_car_jm6
//	maybe should stop player leaving this car while the thugs get in
	
	IF IS_CAR_DEAD any_car_jm6
		GOTO mission_joey6_failed
	ENDIF

	IF thug1_is_dead = 0
		IF IS_CHAR_IN_CAR thug1 any_car_jm6 
		AND objective_count_done_before1 = 0		
			objective_count ++
			objective_count_done_before1 = 1		
		ENDIF
	ENDIF

	IF thug2_is_dead = 0
		IF IS_CHAR_IN_CAR thug2 any_car_jm6 
		AND objective_count_done_before2 = 0		
			objective_count ++
			objective_count_done_before2 = 1		
		ENDIF
	ENDIF

	IF thug3_is_dead = 0
		IF IS_CHAR_IN_CAR thug3 any_car_jm6 
		AND objective_count_done_before3 = 0		
			objective_count ++
			objective_count_done_before3 = 1		
		ENDIF
	ENDIF
	/*
	IF TIMERB > 15000
		IF NOT IS_CAR_DEAD any_car_jm6
			IF NOT IS_CHAR_DEAD	thug1
				//WARP_CHAR_INTO_CAR thug1 any_car_jm6
				//WARP_CHAR_INTO_CAR_AS_PASSERNGER thug1 any_car_jm6
			ENDIF
			IF NOT IS_CHAR_DEAD	thug2
				//WARP_CHAR_INTO_CAR thug2 any_car_jm6
				//WARP_CHAR_INTO_CAR_AS_PASSERNGER thug1 any_car_jm6
			ENDIF
			IF NOT IS_CHAR_DEAD	thug3
				//WARP_CHAR_INTO_CAR thug3 any_car_jm6
				//WARP_CHAR_INTO_CAR_AS_PASSERNGER thug1 any_car_jm6
			ENDIF
		ENDIF
	ENDIF
	*/
ENDWHILE	

ALTER_WANTED_LEVEL_NO_DROP Player 3    //player gets wanted here

SET_PLAYER_CONTROL Player ON  // GS-SC: Move this to after the thugs get in the car
SWITCH_WIDESCREEN OFF
RESTORE_CAMERA_JUMPCUT
SET_POLICE_IGNORE_PLAYER Player OFF
SET_EVERYONE_IGNORE_PLAYER Player OFF
APPLY_BRAKES_TO_PLAYERS_CAR Player Off
SET_PED_DENSITY_MULTIPLIER 1.0

//END OF BANK ROBBERY CUT SCENE********************************************************************************

	ADD_BLIP_FOR_COORD 1086.0 -227.0 -100.0 blip2_jm6
	ADD_SPRITE_BLIP_FOR_COORD 925.0 -359.5 -100.0 RADAR_SPRITE_SPRAY blip4_jm6
	REMOVE_BLIP blip4_jm6 
	CHANGE_BLIP_DISPLAY blip2_jm6 BLIP_ONLY
	
//SAMPLE4*********************************************************
	LOAD_MISSION_AUDIO J6_C

	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE

	PLAY_MISSION_AUDIO

	PRINT_NOW ( JM6_3 ) 3000 1 //"get us out of here"

	//PRINT_SOON ( JM6_4 ) 5000 1 //"get us out of here"



//Get back to warehouse

back_to_safe_house:

WAIT 0

	IF IS_CAR_DEAD any_car_jm6
		//GO GET ANOTHER ONE	
	ENDIF

	WHILE NOT IS_PLAYER_STOPPED_IN_AREA_2D player 1089.9 -223.9 1084.5 -228.5 TRUE
	OR NOT IS_PLAYER_IN_ANY_CAR player 

		IF IS_CHAR_DEAD thug1
		AND IS_CHAR_DEAD thug2
		AND IS_CHAR_DEAD thug3
			PRINT_NOW ( JM6_8 )	5000 1
			GOTO mission_joey6_failed
		ENDIF

		IF NOT IS_CHAR_DEAD thug1
			IF NOT IS_CHAR_IN_PLAYERS_GROUP	thug1 player
				IF blip_for_thug_added1 = 0
					ADD_BLIP_FOR_CHAR thug1 thug1_blip
					blip_for_thug_added1 = 1
				ENDIF
	   	
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug1 30.0 30.0 FALSE
		   			IF blip_for_thug_added1 = 1
						SET_PLAYER_AS_LEADER thug1 player
						REMOVE_BLIP	thug1_blip
						blip_for_thug_added1 = 0
					ENDIF
				ENDIF
	   		ENDIF	
		ENDIF

		IF NOT IS_CHAR_DEAD thug2
			IF NOT IS_CHAR_IN_PLAYERS_GROUP	thug2 player
				IF blip_for_thug_added2 = 0
					ADD_BLIP_FOR_CHAR thug2 thug2_blip
					blip_for_thug_added2 = 1
				ENDIF
	   	
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug2 30.0 30.0 FALSE
		   			IF blip_for_thug_added2 = 1
						SET_PLAYER_AS_LEADER thug2 player
						REMOVE_BLIP	thug2_blip
						blip_for_thug_added2 = 0
					ENDIF
				ENDIF
	   		ENDIF	
		ENDIF

		IF NOT IS_CHAR_DEAD thug3
			IF NOT IS_CHAR_IN_PLAYERS_GROUP	thug3 player
				IF blip_for_thug_added3 = 0
					ADD_BLIP_FOR_CHAR thug3 thug3_blip
					blip_for_thug_added3 = 1
				ENDIF
	   	
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug3 30.0 30.0 FALSE
		   			IF blip_for_thug_added3 = 1
						SET_PLAYER_AS_LEADER thug3 player
						REMOVE_BLIP	thug3_blip
						blip_for_thug_added3 = 0
					ENDIF
				ENDIF
	   		ENDIF	
		ENDIF

		WAIT 0
		IF IS_CAR_DEAD any_car_jm6
			//GO GET ANOTHER ONE	
		ENDIF

		IF IS_PLAYER_IN_ANY_CAR Player
			STORE_CAR_PLAYER_IS_IN player any_car_jm6
		ENDIF


		WHILE IS_WANTED_LEVEL_GREATER Player 0 
			WAIT 0
			REMOVE_BLIP blip2_jm6
			REMOVE_BLIP blip4_jm6 
			DISPLAY_RADAR 6 // PATHING PAY N SPRAY
			ADD_SPRITE_BLIP_FOR_COORD 925.0 -359.5 -100.0 RADAR_SPRITE_SPRAY blip4_jm6

			IF IS_CHAR_DEAD thug1
			AND IS_CHAR_DEAD thug2
			AND IS_CHAR_DEAD thug3
				PRINT_NOW ( JM6_8 )	5000 1
				GOTO mission_joey6_failed
			ENDIF

			IF NOT IS_CHAR_DEAD thug1
				IF NOT IS_CHAR_IN_PLAYERS_GROUP	thug1 player
					IF blip_for_thug_added1 = 0
						ADD_BLIP_FOR_CHAR thug1 thug1_blip
						blip_for_thug_added1 = 1
					ENDIF
	   	
					IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug1 30.0 30.0 FALSE
		   				IF blip_for_thug_added1 = 1
							SET_PLAYER_AS_LEADER thug1 player
							REMOVE_BLIP	thug1_blip
							blip_for_thug_added1 = 0
						ENDIF
					ENDIF
	   			ENDIF	
			ENDIF

			IF NOT IS_CHAR_DEAD thug2
				IF NOT IS_CHAR_IN_PLAYERS_GROUP	thug2 player
					IF blip_for_thug_added2 = 0
						ADD_BLIP_FOR_CHAR thug2 thug2_blip
						blip_for_thug_added2 = 1
					ENDIF
	   	
					IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug2 30.0 30.0 FALSE
		   				IF blip_for_thug_added2 = 1
							SET_PLAYER_AS_LEADER thug2 player
							REMOVE_BLIP	thug2_blip
							blip_for_thug_added2 = 0
						ENDIF
					ENDIF
	   			ENDIF	
			ENDIF

			IF NOT IS_CHAR_DEAD thug3
				IF NOT IS_CHAR_IN_PLAYERS_GROUP	thug3 player
					IF blip_for_thug_added3 = 0
						ADD_BLIP_FOR_CHAR thug3 thug3_blip
						blip_for_thug_added3 = 1
					ENDIF
	   	
					IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug3 30.0 30.0 FALSE
		   				IF blip_for_thug_added3 = 1
							SET_PLAYER_AS_LEADER thug3 player
							REMOVE_BLIP	thug3_blip
							blip_for_thug_added3 = 0
						ENDIF
					ENDIF
	   			ENDIF	
			ENDIF

		ENDWHILE  //Wanted while

		REMOVE_BLIP blip2_jm6
		REMOVE_BLIP blip4_jm6
		ADD_BLIP_FOR_COORD 1086.0 -227.0 -100.0 blip2_jm6
		CHANGE_BLIP_DISPLAY blip2_jm6 BLIP_ONLY
		DISPLAY_RADAR 3 // PATHING ON

		IF NOT IS_PLAYER_IN_ANY_CAR player
			WHILE NOT IS_PLAYER_IN_ANY_CAR player
				WAIT 0
				PRINT_NOW ( EBAL_5 ) 5000 1
				REMOVE_BLIP blip2_jm6
			ENDWHILE
			CLEAR_THIS_PRINT ( EBAL_5 )
			ADD_BLIP_FOR_COORD 1086.0 -227.0 -100.0 blip2_jm6
			CHANGE_BLIP_DISPLAY blip2_jm6 BLIP_ONLY
		ENDIF

	ENDWHILE  //not @ destination while


//THUGS GO BACK INTO SAFEHOUSE CUT_SCENE***********************************************************************

IF NOT IS_CHAR_DEAD thug1
	IF NOT IS_CHAR_IN_PLAYERS_GROUP thug1 player
		PRINT_NOW ( HEY2 ) 4000 1
		GOTO back_to_safe_house
	ENDIF
ENDIF

IF NOT IS_CHAR_DEAD thug2
	IF NOT IS_CHAR_IN_PLAYERS_GROUP thug2 player
		PRINT_NOW ( HEY2 ) 4000 1
		GOTO back_to_safe_house
	ENDIF
ENDIF

IF NOT IS_CHAR_DEAD thug3
	IF NOT IS_CHAR_IN_PLAYERS_GROUP thug3 player
		PRINT_NOW ( HEY2 ) 4000 1
		GOTO back_to_safe_house
	ENDIF
ENDIF

CLEAR_AREA 1087.7 -229.2 8.0 6.0 TRUE

SET_PLAYER_CONTROL Player Off
SWITCH_WIDESCREEN ON
SET_POLICE_IGNORE_PLAYER Player On
SET_EVERYONE_IGNORE_PLAYER Player On

SET_FIXED_CAMERA_POSITION 1098.781 -228.929 16.723 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 1098.005 -229.116 16.12 JUMP_CUT

	IF NOT IS_CAR_DEAD any_car_jm6
		APPLY_BRAKES_TO_PLAYERS_CAR Player On
		 
		IF NOT IS_CHAR_DEAD thug1
			LEAVE_GROUP thug1
			IF IS_CHAR_IN_ANY_CAR thug1
				STORE_CAR_CHAR_IS_IN thug1 any_car_jm6
				SET_CHAR_OBJ_LEAVE_CAR thug1 any_car_jm6
			ENDIF
		ENDIF

		WAIT 400

		IF NOT IS_CHAR_DEAD thug2
			LEAVE_GROUP thug2
			IF IS_CHAR_IN_ANY_CAR thug2
				STORE_CAR_CHAR_IS_IN thug2 any_car_jm6
				SET_CHAR_OBJ_LEAVE_CAR thug2 any_car_jm6
			ENDIF
		ENDIF

		WAIT 400

		IF NOT IS_CHAR_DEAD thug3
			LEAVE_GROUP thug3
			IF IS_CHAR_IN_ANY_CAR thug3
				STORE_CAR_CHAR_IS_IN thug3 any_car_jm6
				SET_CHAR_OBJ_LEAVE_CAR thug3 any_car_jm6
			ENDIF
		ENDIF

	ENDIF

	IF NOT IS_CHAR_DEAD thug1
		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug1 30.0 30.0 FALSE
			IF NOT IS_CHAR_DEAD	thug1
				MARK_CHAR_AS_NO_LONGER_NEEDED thug1
			ENDIF
			//thug1_is_dead = 1
		ENDIF
	ENDIF

	IF NOT IS_CHAR_DEAD thug2
		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug2 30.0 30.0 FALSE
			IF NOT IS_CHAR_DEAD	thug2
				MARK_CHAR_AS_NO_LONGER_NEEDED thug2
			ENDIF
			//thug2_is_dead = 1
		ENDIF
	ENDIF

	IF NOT IS_CHAR_DEAD thug3
		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player thug3 30.0 30.0 FALSE
			IF NOT IS_CHAR_DEAD	thug3
				MARK_CHAR_AS_NO_LONGER_NEEDED thug3
			ENDIF
			//thug3_is_dead = 1
		ENDIF
	ENDIF

objective_count = 0
objective_count_done_before1 = 0
objective_count_done_before2 = 0
objective_count_done_before3 = 0

WHILE NOT SLIDE_OBJECT Bank_job_door 1087.523 -233.801 14.012 0.0 0.0 0.2 FALSE
	WAIT 0

ENDWHILE

WHILE NOT objective_count = 3 //WAITING FOR THUGS TO GET OUT OF CAR  

		WAIT 0

		IF IS_CHAR_DEAD thug1
			IF objective_count_done_before1 = 0
				objective_count ++
				objective_count_done_before1 = 1
				thug1_is_dead = 1
			ENDIF
		ENDIF

		IF IS_CHAR_DEAD thug2
		AND objective_count_done_before2 = 0
			objective_count ++
			objective_count_done_before2 = 1
			thug2_is_dead = 1
		ENDIF


		IF IS_CHAR_DEAD thug3
		AND objective_count_done_before3 = 0
			objective_count ++
			objective_count_done_before3 = 1
			thug3_is_dead = 1
		ENDIF

		IF thug1_is_dead = 1
		AND thug2_is_dead = 1
		AND thug3_is_dead = 1
			GOTO mission_joey6_failed
		ENDIF
		
	IF NOT IS_CAR_DEAD any_car_jm6
			
		IF thug1_is_dead = 0
			IF NOT IS_CHAR_IN_CAR thug1	any_car_jm6	    
			AND objective_count_done_before1 = 0
				//SET_CHAR_OBJ_WAIT_ON_FOOT thug1
				SET_CHAR_OBJ_RUN_TO_COORD thug1 1087.0 -238.6		
				objective_count ++
				objective_count_done_before1 = 1		
			ENDIF
		ENDIF

		IF thug2_is_dead = 0
			IF NOT IS_CHAR_IN_CAR thug2 any_car_jm6			 
			AND objective_count_done_before2 = 0
				//SET_CHAR_OBJ_WAIT_ON_FOOT thug2
				SET_CHAR_OBJ_RUN_TO_COORD thug2 1087.5 -238.6		
				objective_count ++
				objective_count_done_before2 = 1		
			ENDIF
		ENDIF

		IF thug3_is_dead = 0
			IF NOT IS_CHAR_IN_CAR thug3	any_car_jm6		 
			AND objective_count_done_before3 = 0
				//SET_CHAR_OBJ_WAIT_ON_FOOT thug3
				SET_CHAR_OBJ_RUN_TO_COORD thug3 1088.0 -238.6		
				objective_count ++
				objective_count_done_before3 = 1		
			ENDIF
		ENDIF

	ENDIF

ENDWHILE


REMOVE_BLIP blip1_jm6

	IF NOT IS_CHAR_DEAD thug1
		SET_CHAR_OBJ_RUN_TO_COORD thug1 1087.0 -238.6	
	ENDIF

	IF NOT IS_CHAR_DEAD thug2
		SET_CHAR_OBJ_RUN_TO_COORD thug2 1087.5 -238.6
	ENDIF

	IF NOT IS_CHAR_DEAD thug3
		SET_CHAR_OBJ_RUN_TO_COORD thug3 1088.0 -238.6
	ENDIF

objective_count = 0
objective_count_done_before1 = 0
objective_count_done_before2 = 0
objective_count_done_before3 = 0

TIMERB = 0

WHILE NOT objective_count = 3

	WAIT 0

		IF IS_CHAR_DEAD thug1
		AND objective_count_done_before1 = 0
			objective_count ++
			objective_count_done_before1 = 1
			thug1_is_dead = 1
		ENDIF

		IF IS_CHAR_DEAD thug2
		AND objective_count_done_before2 = 0
			objective_count ++
			objective_count_done_before2 = 1
			thug2_is_dead = 1
		ENDIF


		IF IS_CHAR_DEAD thug3
		AND objective_count_done_before3 = 0
			objective_count ++
			objective_count_done_before3 = 1
			thug3_is_dead = 1
		ENDIF


		IF thug1_is_dead = 1
		AND thug2_is_dead = 1
		AND thug3_is_dead = 1
			GOTO mission_joey6_failed
		ENDIF

		IF thug1_is_dead = 0
			IF IS_CHAR_OBJECTIVE_PASSED thug1
			AND objective_count_done_before1 = 0		// GSW - could maybe use objective_count_done_before1 here
				objective_count ++
				objective_count_done_before1 = 1		// GSW - could maybe use objective_count_done_before1 here
			ENDIF
		ENDIF

		IF thug2_is_dead = 0
			IF IS_CHAR_OBJECTIVE_PASSED thug2
			AND objective_count_done_before2 = 0		// GSW - could maybe use objective_count_done_before2 here
				objective_count ++
				objective_count_done_before2 = 1		// GSW - could maybe use objective_count_done_before2 here
			ENDIF
		ENDIF

		IF thug3_is_dead = 0
			IF IS_CHAR_OBJECTIVE_PASSED thug3
			AND objective_count_done_before3 = 0		// GSW - could maybe use objective_count_done_before3 here
				objective_count ++
				objective_count_done_before3 = 1		// GSW - could maybe use objective_count_done_before3 here
			ENDIF
		ENDIF

		IF TIMERB > 15000
			IF NOT IS_CHAR_DEAD	thug1
				SET_CHAR_COORDINATES thug1 1087.0 -238.6 10.0
			ENDIF
			IF NOT IS_CHAR_DEAD	thug2
				SET_CHAR_COORDINATES thug2 1087.5 -238.6 10.0
			ENDIF
			IF NOT IS_CHAR_DEAD	thug3
				SET_CHAR_COORDINATES thug3 1088.0 -238.6 10.0
			ENDIF
		ENDIF

ENDWHILE

	IF NOT IS_CHAR_DEAD thug1
		SET_CHAR_OBJ_WAIT_ON_FOOT thug1
	ENDIF

	IF NOT IS_CHAR_DEAD thug2
		SET_CHAR_OBJ_WAIT_ON_FOOT thug2
	ENDIF

	IF NOT IS_CHAR_DEAD thug3
		SET_CHAR_OBJ_WAIT_ON_FOOT thug3
	ENDIF


WHILE NOT SLIDE_OBJECT Bank_job_door 1087.523 -233.801 11.012 0.0 0.0 0.1 FALSE
	WAIT 0

ENDWHILE

SET_PLAYER_CONTROL Player ON
SWITCH_WIDESCREEN OFF
RESTORE_CAMERA_JUMPCUT
SET_POLICE_IGNORE_PLAYER Player OFF
SET_EVERYONE_IGNORE_PLAYER Player OFF
APPLY_BRAKES_TO_PLAYERS_CAR Player Off

//THUGS GO BACK INTO SAFEHOUSE CUT_SCENE***********************************************************************

}
GOTO mission_joey6_passed



// Mission Joey6 failed

mission_joey6_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission joey6 passed

mission_joey6_passed:

flag_joey_mission6_passed = 1
	IF NOT IS_CHAR_DEAD thug1
		thugs_score = thugs_score + 10000
	ENDIF
	DELETE_CHAR thug1

	IF NOT IS_CHAR_DEAD thug2
		thugs_score = thugs_score + 10000
	ENDIF
	DELETE_CHAR thug2

	IF NOT IS_CHAR_DEAD thug3
		thugs_score = thugs_score + 10000	
	ENDIF
	DELETE_CHAR thug3
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) thugs_score 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player thugs_score
REGISTER_MISSION_PASSED JM6
PLAYER_MADE_PROGRESS 1
REMOVE_BLIP joey_contact_blip
RETURN
		

// mission cleanup

mission_cleanup_joey6:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_joey_mission = 0
IF sound_already_created_before = 1
	REMOVE_SOUND joey_alarm_loop
ENDIF
REMOVE_BLIP blip1_jm6
REMOVE_BLIP blip3_jm6
REMOVE_BLIP blip2_jm6
REMOVE_BLIP blip4_jm6
REMOVE_BLIP	thug1_blip
REMOVE_BLIP	thug2_blip
REMOVE_BLIP	thug3_blip
SET_PED_DENSITY_MULTIPLIER 1.0
UNLOAD_SPECIAL_CHARACTER 2
MISSION_HAS_FINISHED
RETURN
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Toni mission 1****************************************
// ***************************************Laundry day*****************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff			

GOSUB mission_start_toni1

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_toni1_failed
ENDIF

GOSUB mission_cleanup_toni1

MISSION_END

// Variables for mission

VAR_INT t1_triad_van1 t1_triad_van2 t1_triad_van3 //t1_triad_van4 // Vehicle for mission

VAR_INT blip1_van1 blip2_van2 blip3_van3 //blip4_van4

VAR_INT counter1_toni1 // Counts up number of mission vans destroyed

VAR_INT vanman1 vanman2 vanman3 in_van1 in_van2 in_van3 //vanman4 in_van4
 
VAR_INT dead_van1 dead_van2 dead_van3 //dead_van4

VAR_INT grenade_blip picked_up_grenades

VAR_INT triad_hates_you	free_greandes

// ***************************************Mission Start*************************************

mission_start_toni1:

REGISTER_MISSION_GIVEN

// only objective is to blow up a bunch of vans. dont need pathing
DISPLAY_RADAR 2 // PATHING OFF

flag_player_on_mission = 1
flag_player_on_toni_mission = 1
SCRIPT_NAME toni1
WAIT 0

picked_up_grenades = 0
counter1_toni1 = 0
dead_van1 = 0
dead_van2 = 0
dead_van3 = 0
//dead_van4 = 0
in_van1 = 0
in_van2	= 0
in_van3	= 0
//in_van4	= 0

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_toni1_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

PRINT_BIG ( TM1 ) 15000 2 //"Toni Mission 1"	 
*/

{

LOAD_SPECIAL_CHARACTER 1 tony
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 TONYH
REQUEST_MODEL ind_newrizzos

/*
WHILE GET_FADING_STATUS
	WAIT 0

ENDWHILE
*/

//LOAD_SCENE 1218.4 -314.5 28.9

LOAD_ALL_MODELS_NOW
						 
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED ind_newrizzos
	WAIT 0

ENDWHILE

LOAD_CUTSCENE t1_tol
SET_CUTSCENE_OFFSET 1218.42 -314.5 28.9
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_tony
SET_CUTSCENE_ANIM cs_tony tony

CREATE_CUTSCENE_HEAD cs_tony CUT_OBJ2 cs_tonyhead
SET_CUTSCENE_HEAD_ANIM cs_tonyhead tony

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CLEAR_AREA 1219.5 -321.1 27.5 1.0 TRUE
SET_PLAYER_COORDINATES player 1219.5 -321.1 26.4

SET_PLAYER_HEADING player 180.0

CLEAR_AREA 1216.1 -313.0 29.9 10.0 TRUE	//TONIS RESTAURANT

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 171
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM1_A ) 10000 1 // Mission brief

WHILE cs_time < 3769
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM1_B ) 10000 1 // Mission brief

WHILE cs_time < 5825
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM1_C ) 10000 1 // Mission brief

WHILE cs_time < 8026
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM1_D ) 10000 1 // Mission brief

WHILE cs_time < 11500
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 15961
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM1_G ) 10000 1 // Mission brief

WHILE cs_time < 21005
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM1_H ) 10000 1 // Mission brief

WHILE cs_time < 22997
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM1_I ) 10000 1 // Mission brief

WHILE cs_time < 27589
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM1_J ) 10000 1 // Mission brief

WHILE cs_time < 29796
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 31666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

REQUEST_MODEL CAR_MRWONGS
REQUEST_MODEL PED_CT_MAN1
SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER


WAIT 500

DO_FADE 1500 FADE_IN

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED ind_newrizzos

	WHILE NOT HAS_MODEL_LOADED CAR_MRWONGS
	OR NOT HAS_MODEL_LOADED PED_CT_MAN1
		WAIT 0

	ENDWHILE
	 
// START OF MISSION

SWITCH_CAR_GENERATOR gen_car31 0 

CREATE_PICKUP_WITH_AMMO WEAPON_GRENADE PICKUP_ONCE 10 1278.8 -81.5 15.1 free_greandes
ADD_SPRITE_BLIP_FOR_PICKUP free_greandes RADAR_SPRITE_WEAPON grenade_blip

CREATE_CAR CAR_MRWONGS 854.0 -778.0 -100.0 t1_triad_van1  
CREATE_CHAR_INSIDE_CAR t1_triad_van1 PEDTYPE_CIVMALE PED_CT_MAN1 vanman1
ADD_BLIP_FOR_CAR t1_triad_van1 blip1_van1
SET_CAR_CRUISE_SPEED  t1_triad_van1 17.0
SET_CAR_DRIVING_STYLE t1_triad_van1 0
SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van1 TRUE
SET_CHAR_PERSONALITY vanman1 PEDSTAT_TOUGH_GUY
SET_CAR_HEALTH t1_triad_van1 600

CREATE_CAR CAR_MRWONGS 1020.0 -677.0 -100.0 t1_triad_van2
CREATE_CHAR_INSIDE_CAR t1_triad_van2 PEDTYPE_CIVMALE PED_CT_MAN1 vanman2
ADD_BLIP_FOR_CAR t1_triad_van2 blip2_van2
SET_CAR_CRUISE_SPEED  t1_triad_van2 17.0
SET_CAR_DRIVING_STYLE t1_triad_van2 0
SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van2 TRUE
SET_CHAR_PERSONALITY vanman2 PEDSTAT_GEEK_GUY
SET_CAR_HEALTH t1_triad_van2 600

CREATE_CAR CAR_MRWONGS 904.0 -579.0 -100.0 t1_triad_van3
CREATE_CHAR_INSIDE_CAR t1_triad_van3 PEDTYPE_CIVMALE PED_CT_MAN1 vanman3
ADD_BLIP_FOR_CAR t1_triad_van3 blip3_van3
SET_CAR_CRUISE_SPEED  t1_triad_van3 17.0
SET_CAR_DRIVING_STYLE t1_triad_van3 0
SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van3 TRUE
SET_CHAR_PERSONALITY vanman3 PEDSTAT_TOUGH_GUY
SET_CAR_HEALTH t1_triad_van3 600

/*
CREATE_CAR CAR_MRWONGS 996.0 -463.0 14.0 t1_triad_van4
CREATE_CHAR_INSIDE_CAR t1_triad_van4 PEDTYPE_CIVMALE PED_CT_MAN1 vanman4
ADD_BLIP_FOR_CAR t1_triad_van4 blip4_van4
SET_CAR_CRUISE_SPEED  t1_triad_van4 17.0
SET_CAR_DRIVING_STYLE t1_triad_van4 0
SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van4 TRUE
SET_CHAR_PERSONALITY vanman4 PEDSTAT_GEEK_GUY
SET_CAR_HEALTH t1_triad_van4 600
*/

WHILE NOT counter1_toni1 = 3
	WAIT 0

		IF IS_CAR_DEAD t1_triad_van1 
		AND dead_van1 = 0
			REMOVE_BLIP blip1_van1
			dead_van1 = 1
			++ counter1_toni1	
		ENDIF
	
		IF NOT IS_CAR_DEAD t1_triad_van1 
			IF NOT IS_CAR_HEALTH_GREATER t1_triad_van1 995
				IF NOT IS_CHAR_DEAD vanman1
					IF IS_CHAR_IN_CAR vanman1 t1_triad_van1
						SET_CAR_CRUISE_SPEED t1_triad_van1 18.0
						SET_CAR_DRIVING_STYLE t1_triad_van1 2
						SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van1 FALSE
					ENDIF
				ENDIF
			ENDIF
		ENDIF
 
		IF NOT IS_CAR_DEAD t1_triad_van1
			IF IS_PLAYER_IN_CAR player t1_triad_van1
			AND in_van1 = 0
				SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van1 FALSE
				in_van1 = 1
			ENDIF
		ENDIF

		IF IS_CAR_DEAD t1_triad_van2
		AND dead_van2 = 0 
			REMOVE_BLIP blip2_van2
			dead_van2 = 1
			++ counter1_toni1
		ENDIF
	   	
		IF NOT IS_CAR_DEAD t1_triad_van2
			IF NOT IS_CAR_HEALTH_GREATER t1_triad_van2 995
				IF NOT IS_CHAR_DEAD vanman2
					IF IS_CHAR_IN_CAR vanman2 t1_triad_van2
						SET_CAR_CRUISE_SPEED t1_triad_van2 17.0
						SET_CAR_DRIVING_STYLE t1_triad_van2 2
						SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van2 FALSE
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD t1_triad_van2
			IF IS_PLAYER_IN_CAR player t1_triad_van2
			AND in_van2 = 0
				SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van2 FALSE
				in_van2 = 1
			ENDIF
		ENDIF

	   	IF IS_CAR_DEAD t1_triad_van3
		AND dead_van3 = 0 
			REMOVE_BLIP blip3_van3
			dead_van3 = 1
			++ counter1_toni1
		ENDIF
		
		IF NOT IS_CAR_DEAD t1_triad_van3
			IF NOT IS_CAR_HEALTH_GREATER t1_triad_van3 995
				IF NOT IS_CHAR_DEAD vanman3
					IF IS_CHAR_IN_CAR vanman3 t1_triad_van3
						SET_CAR_CRUISE_SPEED t1_triad_van3 19.0
						SET_CAR_DRIVING_STYLE t1_triad_van3 2
						SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van3 FALSE
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD t1_triad_van3
			IF IS_PLAYER_IN_CAR player t1_triad_van3
			AND in_van3 = 0
				SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van3 FALSE
			 	in_van3 = 1
			ENDIF
		ENDIF

		/*
		IF IS_CAR_DEAD t1_triad_van4
		AND dead_van4 = 0 
			REMOVE_BLIP blip4_van4
			dead_van4 = 1
			++ counter1_toni1
		ENDIF
		
		IF NOT IS_CAR_DEAD t1_triad_van4
			IF NOT IS_CAR_HEALTH_GREATER t1_triad_van4 599
				IF NOT IS_CHAR_DEAD vanman4
					IF IS_CHAR_IN_CAR vanman4 t1_triad_van4
						SET_CAR_CRUISE_SPEED t1_triad_van4 20.0
						SET_CAR_DRIVING_STYLE t1_triad_van4 2
						SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van4 FALSE		
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD t1_triad_van4
			IF IS_PLAYER_IN_CAR player t1_triad_van4
			AND in_van4 = 0
				SET_CAR_ONLY_DAMAGED_BY_PLAYER t1_triad_van4 FALSE
				in_van4 = 1
			ENDIF
		ENDIF
		*/
		IF HAS_PICKUP_BEEN_COLLECTED free_greandes
		AND picked_up_grenades = 0
			WAIT 1500
			PRINT_HELP GREN_1
			picked_up_grenades = 1
		ENDIF
		 
ENDWHILE

}

GOTO mission_toni1_passed 

 // Mission toni1 failed

mission_toni1_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission toni1 passed

mission_toni1_passed:

flag_toni_mission1_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 20000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 20000
REGISTER_MISSION_PASSED	TM1
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT toni_mission2_loop 
RETURN
		


// mission cleanup

mission_cleanup_toni1:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_toni_mission = 0
REMOVE_BLIP blip1_van1
REMOVE_BLIP blip2_van2
REMOVE_BLIP blip3_van3
//REMOVE_BLIP blip4_van4
REMOVE_BLIP grenade_blip
REMOVE_PICKUP free_greandes
SWITCH_CAR_GENERATOR gen_car31 101
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_MRWONGS
MARK_MODEL_AS_NO_LONGER_NEEDED PED_CT_MAN1
MISSION_HAS_FINISHED
RETURN
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Toni mission 2****************************************
// **************************************Triad Ambush*****************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff

GOSUB mission_start_toni2

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_toni2_failed
ENDIF

GOSUB mission_cleanup_toni2

MISSION_END


// Variables for mission

VAR_INT thong1 thong1B thong2 thong2B thong3 thong3B thong_car	// gang members for mission

VAR_INT blip1_t2 blip2_t2 thong_blip1 thong_blip1B thong_blip2 thong_blip2B thong_blip3 thong_blip3B

VAR_INT thong1_dead thong1B_dead thong2_dead thong2B_dead thong3_dead thong3B_dead thongs_killed thongs_killed_message

VAR_INT briefcase_tm2 traid_threat_cleared_T2 

// ***************************************Mission Start*************************************

mission_start_toni2:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_toni_mission = 1
SCRIPT_NAME toni2
WAIT 0

thong1_dead = 0
thong1B_dead = 0
thong2_dead = 0
thong2B_dead = 0
thong3_dead = 0
thong3B_dead = 0
thongs_killed = 0
thongs_killed_message = 0
traid_threat_cleared_T2 = 0

{

LOAD_SPECIAL_MODEL cut_obj1 PLAYERH			
LOAD_SPECIAL_MODEL cut_obj2	NOTE
REQUEST_MODEL ind_newrizzos


LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED ind_newrizzos
	WAIT 0

ENDWHILE

LOAD_CUTSCENE T2_TPU
SET_CUTSCENE_OFFSET 1218.42 -314.5 28.9
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj2 cs_note
SET_CUTSCENE_ANIM cs_note NOTE

CLEAR_AREA 1219.5 -321.1 27.5 1.0 TRUE
SET_PLAYER_COORDINATES player 1219.5 -321.1 26.4

SET_PLAYER_HEADING player 180.0

CLEAR_AREA 1216.1 -313.0 29.9 10.0 TRUE	//TONIS RESTAURANT

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time


WHILE cs_time < 151 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM2_A ) 10000 1 

WHILE cs_time < 3879
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM2_AA ) 10000 1 

WHILE cs_time < 7522
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( TM2_B ) 10000 1 

WHILE cs_time < 10947
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM2_C ) 10000 1 

WHILE cs_time < 14507
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM2_D ) 10000 1 

WHILE cs_time < 18705
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM2_E ) 10000 1 

WHILE cs_time < 22114
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 23333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED ind_newrizzos


// START OF MISSION

IF IS_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1
	CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1
	traid_threat_cleared_T2 = 1
ENDIF

SWITCH_CAR_GENERATOR gen_car31 0

CREATE_PICKUP briefcase PICKUP_ONCE 865.7 -663.6 14.8 briefcase_tm2

ADD_BLIP_FOR_PICKUP	briefcase_tm2 blip1_t2

REQUEST_MODEL CAR_BELLYUP
REQUEST_MODEL PED_GANG_TRIAD_A
REQUEST_MODEL PED_GANG_TRIAD_B

WHILE NOT HAS_MODEL_LOADED CAR_BELLYUP
OR NOT HAS_MODEL_LOADED PED_GANG_TRIAD_A
OR NOT HAS_MODEL_LOADED PED_GANG_TRIAD_B
	WAIT 0
ENDWHILE


main_toni2:

	WAIT 0
		
WHILE NOT HAS_PICKUP_BEEN_COLLECTED briefcase_tm2
	WAIT 0

ENDWHILE

REMOVE_BLIP blip1_t2

SET_POLICE_IGNORE_PLAYER Player On
SET_PLAYER_CONTROL Player Off
SWITCH_WIDESCREEN ON			

				CLEAR_AREA 869.4 -639.0 15.0 1.0 TRUE
				CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 869.4 -639.0 -100.0 thong1
				GIVE_WEAPON_TO_CHAR thong1 WEAPONTYPE_BASEBALLBAT 1
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT thong1 869.4 -656.0

				CLEAR_AREA 868.5 -637.0 15.0 1.0 TRUE
				CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 868.5 -637.0 -100.0 thong1B
				SET_CHAR_HEADING thong1B 180.0
				GIVE_WEAPON_TO_CHAR thong1B WEAPONTYPE_PISTOL 200
				//SET_CHAR_OBJ_GOTO_COORD_ON_FOOT thong1B 869.4 -656.0

			SET_FIXED_CAMERA_POSITION 869.7 -666.0 16.0 0.0 0.0 0.0

			POINT_CAMERA_AT_CHAR thong1 FIXED INTERPOLATION

			WAIT 2500

				CLEAR_AREA 869.4 -688.0 15.0 1.0 TRUE
				CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 869.4 -688.0 -100.0 thong2
				GIVE_WEAPON_TO_CHAR thong2 WEAPONTYPE_BASEBALLBAT 1
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT thong2 869.4 -678.0

				CLEAR_AREA 868.5 -690.0 15.0 1.0 TRUE
				CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 868.5 -690.0 -100.0 thong2B
				GIVE_WEAPON_TO_CHAR thong2B WEAPONTYPE_PISTOL 100
				//SET_CHAR_OBJ_GOTO_COORD_ON_FOOT thong2B 869.4 -678.0

			POINT_CAMERA_AT_CHAR thong2 FIXED INTERPOLATION
			
			WAIT 2500

				CLEAR_AREA 892.6 -666.0 15.0 4.0 TRUE
				CREATE_CAR CAR_BELLYUP 892.5 -666.0 -100.0 thong_car
				SET_CAR_HEADING thong_car 180.0
				CREATE_CHAR_INSIDE_CAR thong_car PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A thong3
				CREATE_CHAR_AS_PASSENGER thong_car PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 0 thong3B
				GIVE_WEAPON_TO_CHAR thong3 WEAPONTYPE_PISTOL 27
				GIVE_WEAPON_TO_CHAR thong3B WEAPONTYPE_BASEBALLBAT 1
				CAR_SET_IDLE thong_car

				POINT_CAMERA_AT_CAR thong_car FIXED INTERPOLATION

				SET_CHAR_OBJ_LEAVE_CAR thong3B thong_car

				WHILE IS_CHAR_IN_CAR thong3B thong_car
				   WAIT 0	
					IF IS_CHAR_DEAD thong3B
					OR IS_CAR_DEAD thong_car
						GOTO next_bit_tm2
					ENDIF

				ENDWHILE

				IF NOT IS_CHAR_DEAD thong3B
					SET_CHAR_OBJ_GOTO_COORD_ON_FOOT thong3B 886.2 -665.8
				ENDIF

			WAIT 2500

			next_bit_tm2:


	SET_PLAYER_CONTROL Player On
	SET_POLICE_IGNORE_PLAYER Player OFF
	SWITCH_WIDESCREEN OFF
	RESTORE_CAMERA

			WAIT 0

			IF NOT IS_CHAR_DEAD thong1
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS thong1 player
				SET_CHAR_THREAT_SEARCH thong1 THREAT_PLAYER1  
			ENDIF

			IF NOT IS_CHAR_DEAD thong1B
				//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS thong1B player
				SET_CHAR_THREAT_SEARCH thong1B THREAT_PLAYER1  
			ENDIF

			IF NOT IS_CHAR_DEAD thong2
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS thong2 player
				SET_CHAR_THREAT_SEARCH thong2 THREAT_PLAYER1
			ENDIF

			IF NOT IS_CHAR_DEAD thong2B
				//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS thong2B player
				SET_CHAR_THREAT_SEARCH thong2B THREAT_PLAYER1
			ENDIF

			IF NOT IS_CHAR_DEAD thong3B
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS thong3B player
				SET_CHAR_THREAT_SEARCH thong3B THREAT_PLAYER1
			ENDIF

PRINT_NOW ( TM2_3 ) 5000 1	// " Get back to Toni's!"

IF NOT IS_CHAR_DEAD thong1
	ADD_BLIP_FOR_CHAR thong1 thong_blip1
ENDIF
IF NOT IS_CHAR_DEAD thong1B
	ADD_BLIP_FOR_CHAR thong1B thong_blip1B
ENDIF
IF NOT IS_CHAR_DEAD thong2
	ADD_BLIP_FOR_CHAR thong2 thong_blip2
ENDIF
IF NOT IS_CHAR_DEAD thong2B
	ADD_BLIP_FOR_CHAR thong2B thong_blip2B
ENDIF
IF NOT IS_CHAR_DEAD thong3
	ADD_BLIP_FOR_CHAR thong3 thong_blip3
ENDIF
IF NOT IS_CHAR_DEAD thong3B
	ADD_BLIP_FOR_CHAR thong3B thong_blip3B
ENDIF
			
WHILE NOT thongs_killed = 6
	WAIT 0

		IF IS_CHAR_DEAD thong1
		AND thong1_dead = 0
			thongs_killed ++
			//ADD_SCORE player 500
			REMOVE_BLIP	thong_blip1
			thong1_dead = 1
		ENDIF
		
		IF IS_CHAR_DEAD thong1B
		AND thong1B_dead = 0
			thongs_killed ++
			//ADD_SCORE player 500
			REMOVE_BLIP	thong_blip1B
			thong1B_dead = 1
		ENDIF

		IF IS_CHAR_DEAD thong2
		AND thong2_dead = 0
			thongs_killed ++
			//ADD_SCORE player 500
			REMOVE_BLIP	thong_blip2
			thong2_dead = 1
		ENDIF
		
		IF IS_CHAR_DEAD thong2B
		AND thong2B_dead = 0
			thongs_killed ++
			//ADD_SCORE player 500
			REMOVE_BLIP	thong_blip2B
			thong2B_dead = 1
		ENDIF

		IF IS_CHAR_DEAD thong3
		AND thong3_dead = 0
			thongs_killed ++
			//ADD_SCORE player 500
			REMOVE_BLIP	thong_blip3
			thong3_dead = 1
		ENDIF

		IF IS_CHAR_DEAD thong3B
		AND thong3B_dead = 0
			thongs_killed ++
			//ADD_SCORE player 500
			REMOVE_BLIP	thong_blip3B
			thong3B_dead = 1
		ENDIF

		IF NOT IS_PLAYER_IN_AREA_2D player 890.0 -639.3 846.6 -688.0 FALSE

			IF NOT IS_CHAR_DEAD thong1B
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS thong1B player
				//SET_CHAR_THREAT_SEARCH thong1B THREAT_PLAYER1  
			ENDIF

			IF NOT IS_CHAR_DEAD thong2B
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS thong2B player
				//SET_CHAR_THREAT_SEARCH thong1B THREAT_PLAYER1  
			ENDIF

			IF NOT IS_CHAR_DEAD thong3
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS thong3 player
				SET_CHAR_THREAT_SEARCH thong3 THREAT_PLAYER1
			ENDIF

		ENDIF

ENDWHILE


	PRINT_NOW ( TM2_1 ) 5000 1	// " Get back to Toni's!"

	ADD_BLIP_FOR_COORD 1219.6 -320.7 -100.0 blip2_t2
	//CHANGE_BLIP_DISPLAY blip2_t2 BLIP_ONLY

	  
WHILE NOT LOCATE_PLAYER_ON_FOOT_3D Player 1219.6 -320.7 27.4 1.0 1.0 2.0 TRUE
	WAIT 0

		/*	 
		IF thongs_killed = 6
		AND thongs_killed_message = 0
			PRINT_NOW ( TM2_2 ) 6000 1
			ADD_SCORE player 500
			thongs_killed_message = 1 
		ENDIF 
		*/ 		
ENDWHILE

	SET_PLAYER_CONTROL Player OFF
	SET_POLICE_IGNORE_PLAYER Player ON
	SWITCH_WIDESCREEN ON

GET_PLAYER_CHAR Player script_controlled_player
SET_CHAR_RUNNING script_controlled_player TRUE
	 
SET_FIXED_CAMERA_POSITION 1214.4 -323.9 29.8 0.0 0.0 0.
POINT_CAMERA_AT_POINT 1215.2 -323.4 29.4 JUMP_CUT


CLEAR_AREA 1219.6 -314.0 29.7 2.0 TRUE
SET_CHAR_OBJ_RUN_TO_COORD script_controlled_player 1219.6 -314.0

PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 10000

TIMERB = 0

WHILE NOT IS_CHAR_OBJECTIVE_PASSED script_controlled_player
	WAIT 0

	IF TIMERB > 7000
		IF NOT IS_CHAR_DEAD	script_controlled_player
			SET_CHAR_COORDINATES script_controlled_player 1219.6 -314.0 -100.0
		ENDIF
	ENDIF

ENDWHILE

CLEAR_AREA 1219.6 -323.8 26.8 2.0 TRUE
SET_CHAR_OBJ_RUN_TO_COORD script_controlled_player 1219.6 -323.8

TIMERB = 0

WHILE NOT IS_CHAR_OBJECTIVE_PASSED script_controlled_player
	WAIT 0

	IF TIMERB > 7000
		IF NOT IS_CHAR_DEAD	script_controlled_player
			SET_CHAR_COORDINATES script_controlled_player 1219.6 -323.8 -100.0
		ENDIF
	ENDIF

ENDWHILE

	SET_PLAYER_CONTROL Player ON
	SET_POLICE_IGNORE_PLAYER Player OFF
	SWITCH_WIDESCREEN OFF
	RESTORE_CAMERA_JUMPCUT
	SET_CHAR_RUNNING script_controlled_player FALSE
}
		 
GOTO mission_toni2_passed 


 // Mission toni2 failed

mission_toni2_failed:
RETURN

   

// mission toni2 passed

mission_toni2_passed:

flag_toni_mission2_passed = 1
//PLAY_MISSION_PASSED_TUNE 1
//PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
//CLEAR_WANTED_LEVEL player
//ADD_SCORE player 10000
SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1
REGISTER_MISSION_PASSED	TM2
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT toni_mission3_loop
RETURN
		


// mission cleanup

mission_cleanup_toni2:

flag_player_on_mission = 0
flag_player_on_toni_mission = 0
SWITCH_CAR_GENERATOR gen_car31 101	
REMOVE_BLIP blip1_t2
REMOVE_BLIP blip2_t2
REMOVE_BLIP	thong_blip1
REMOVE_BLIP	thong_blip1B
REMOVE_BLIP	thong_blip2
REMOVE_BLIP	thong_blip2B
REMOVE_BLIP	thong_blip3
REMOVE_BLIP	thong_blip3B
REMOVE_PICKUP briefcase_tm2
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_BELLYUP
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_B
IF traid_threat_cleared_T2 = 1
	SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1
ENDIF	
MISSION_HAS_FINISHED
RETURN

MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Toni mission 3****************************************
// *************************************Pick up the Lads**************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff

GOSUB mission_start_toni3

IF has_deatharrest_been_executed
	GOSUB mission_toni3_failed
ENDIF

GOSUB mission_cleanup_toni3

MISSION_END

// Variables for mission

VAR_INT carry_car blip1_t3 blip2_t3 blip3_t3 blip4_t3 blip5_t3 cutscene_seen_flag

VAR_INT flag_displayed_horn_message_tm3 flag_displayed_wanted_message_tm3 flag_car_blip_displayed

VAR_INT triads1 triads2 triads3 triads4 triads5 triads6 triads7 triads8 triads9 triads10 //triads11 triads12  

VAR_INT triad_van1 triad_van2 triad_van3 triad_van4	triad_van5 triad_van6

// ***************************************Mission Start*************************************

mission_start_toni3:

REGISTER_MISSION_GIVEN

DISPLAY_RADAR 4 // HACKED RADAR STOP AT ROAD

flag_player_on_mission = 1
flag_player_on_toni_mission = 1
SCRIPT_NAME toni3
CLEAR_THIS_BIG_PRINT (M_PASS)
WAIT 0

cutscene_seen_flag = 0

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_toni3_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

PRINT_BIG ( TM3 ) 15000 2 //"Toni Mission 1"	 
*/

{

LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2	NOTE
REQUEST_MODEL ind_newrizzos

/*
WHILE GET_FADING_STATUS
	WAIT 0

ENDWHILE
*/

//LOAD_SCENE 1218.4 -314.5 28.9

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED ind_newrizzos
	WAIT 0

ENDWHILE

LOAD_CUTSCENE T3_MAS
SET_CUTSCENE_OFFSET 1218.42 -314.5 28.9
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj2 cs_note
SET_CUTSCENE_ANIM cs_note NOTE

CLEAR_AREA 1219.5 -321.1 27.5 1.0 TRUE
SET_PLAYER_COORDINATES player 1219.5 -321.1 26.4

SET_PLAYER_HEADING player 180.0

CLEAR_AREA 1216.1 -313.0 29.9 10.0 TRUE	//TONIS RESTAURANT

DO_FADE 1500 FADE_IN

//SWITCH_WORLD_PROCESSING OFF
SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

/*
WHILE cs_time < 100
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM3_MA ) 5000 1 // Pick Frankies Limo at Joeys and take it to him

WHILE cs_time < 1000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM3_MB ) 5000 1 // Pick Frankies Limo at Joeys and take it to him

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM3_MC ) 5000 1 // Pick Frankies Limo at Joeys and take it to him
*/
WHILE cs_time < 3006
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM3_A ) 10000 1 // Pick Frankies Limo at Joeys and take it to him

WHILE cs_time < 5297
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM3_B ) 10000 1 // Pick Frankies Limo at Joeys and take it to him

WHILE cs_time < 8661
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM3_C ) 10000 1 // Pick Frankies Limo at Joeys and take it to him

WHILE cs_time < 12025
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM3_D ) 10000 1 // Pick Frankies Limo at Joeys and take it to him

WHILE cs_time < 14817
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM3_E ) 10000 1 // Pick Frankies Limo at Joeys and take it to him

WHILE cs_time < 17107 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM3_F ) 10000 1 // Pick Frankies Limo at Joeys and take it to him

WHILE cs_time < 18968
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM3_G ) 10000 1 // Pick Frankies Limo at Joeys and take it to him

WHILE cs_time < 19787
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 21666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE


DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

//SWITCH_WORLD_PROCESSING ON
SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED ind_newrizzos

// START OF MISSION

LOAD_SPECIAL_CHARACTER 1 tony
LOAD_SPECIAL_CHARACTER 2 joey2
LOAD_SPECIAL_CHARACTER 3 luigi

REQUEST_MODEL CAR_STRETCH
REQUEST_MODEL CAR_BELLYUP
REQUEST_MODEL PED_GANG_TRIAD_A
REQUEST_MODEL PED_GANG_TRIAD_B

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_SPECIAL_CHARACTER_LOADED 3
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED CAR_STRETCH
OR NOT HAS_MODEL_LOADED	CAR_BELLYUP
OR NOT HAS_MODEL_LOADED PED_GANG_TRIAD_A
OR NOT HAS_MODEL_LOADED	PED_GANG_TRIAD_B
	WAIT 0
ENDWHILE
/*
WHILE NOT ROTATE_OBJECT joeys_garage_door3 135.0 30.0 FALSE
	WAIT 0

ENDWHILE
*/
CREATE_CAR CAR_STRETCH 1187.0 -860.4 14.5 carry_car
SET_CAR_HEADING carry_car 225.0
CHANGE_CAR_COLOUR carry_car CARCOLOUR_BLACK CARCOLOUR_BLACK
SET_CAR_STRONG carry_car TRUE
SET_CAR_PROOFS carry_car TRUE TRUE TRUE TRUE TRUE
//ADD_BLIP_FOR_CAR carry_car blip1_t3
ADD_BLIP_FOR_COORD 1191.7 -870.0 -100.0	blip1_t3
SET_CAN_RESPRAY_CAR carry_car OFF
//SET_RADIO_CHANNEL carry_car 1 -1

//PICK UP LIMO AND JOEY

//GOTO skip_to_toni3_cut //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

pick_up_joey:

	flag_car_blip_displayed = TRUE

	IF IS_CAR_DEAD carry_car
		GOTO mission_toni3_failed
	ENDIF


WHILE NOT LOCATE_PLAYER_ON_FOOT_3D Player 1191.7 -870.0 15.0 1.5 1.5 2.0 TRUE
	WAIT 0

	IF IS_CAR_DEAD carry_car
		GOTO mission_toni3_failed
	ENDIF

ENDWHILE


	SET_PLAYER_CONTROL Player Off
	SET_POLICE_IGNORE_PLAYER Player On
	SET_EVERYONE_IGNORE_PLAYER Player ON
	SWITCH_WIDESCREEN ON		
	SET_FADING_COLOUR 0 0 0
	DO_FADE 1000 FADE_OUT
	 
	WAIT 1000
	LOAD_SCENE 1190.07 -869.86 13.97

	IF IS_PLAYER_PLAYING Player

	   	CLEAR_AREA 1190.2 -866.4 14.1 1.0 TRUE
	   	SET_PLAYER_COORDINATES player 1189.5 -867.6 14.1
		SET_PLAYER_HEADING player 36.0	
		SET_FIXED_CAMERA_POSITION 1186.177 -852.455 17.219 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT 1186.077 -853.425 16.995 JUMP_CUT
		GET_PLAYER_CHAR Player script_controlled_player
		SET_CHAR_RUNNING script_controlled_player TRUE
		IF NOT IS_CAR_DEAD carry_car
			SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER script_controlled_player carry_car
		ENDIF

		DO_FADE 1000 FADE_IN
		WAIT 1000
	ENDIF

	IF IS_CAR_DEAD carry_car
	  	GOTO mission_toni3_failed
	ENDIF

	WHILE NOT IS_PLAYER_IN_CAR player carry_car	
		WAIT 0

			IF IS_CAR_DEAD carry_car
				GOTO mission_toni3_failed
			ENDIF

	ENDWHILE
/*
WHILE NOT ROTATE_OBJECT joeys_garage_door3 45.0 30.0 FALSE
	WAIT 0

ENDWHILE
*/
REMOVE_BLIP blip1_t3
SET_RADIO_CHANNEL 1 -1

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 1179.4 -858.6 14.0 joey
CLEAR_CHAR_THREAT_SEARCH joey

	IF IS_CAR_DEAD carry_car
		GOTO mission_toni3_failed
	ENDIF

SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER joey carry_car

//SET_FIXED_CAMERA_POSITION 1182.8 -856.1 17.0 0.0 0.0 0.0
//POINT_CAMERA_AT_CHAR joey FIXED INTERPOLATION

TIMERB = 0
LOAD_MISSION_AUDIO T3_A

	WHILE NOT IS_CHAR_IN_CAR joey carry_car 
		WAIT 0

		 	IF IS_CHAR_DEAD joey
				GOTO mission_toni3_failed
			ENDIF

			IF IS_CAR_DEAD carry_car
				GOTO mission_toni3_failed
			ENDIF

			IF TIMERB > 10000
				IF NOT IS_CHAR_DEAD	joey
				AND NOT IS_CAR_DEAD	carry_car
					//WARP_CHAR_INTO_CAR joey carry_car
					//WARP_CHAR_INTO_CAR_AS_PASSENGER joey carry_car
				ENDIF
			ENDIF

	ENDWHILE	

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE

PLAY_MISSION_AUDIO

SET_CHAR_CANT_BE_DRAGGED_OUT joey TRUE
ADD_BLIP_FOR_COORD 906.2 -426.0 -100.0 blip3_t3

//CAR DRIVING OUT OF GARAGE CUT SCENE

CLEAR_AREA 1195.0 -870.3 15.0 10.0 TRUE

SET_FIXED_CAMERA_POSITION 1200.9 -866.5 19.0 0.0 0.0 0.0
POINT_CAMERA_AT_PLAYER player FIXED JUMP_CUT

GET_OBJECT_COORDINATES joeys_garage_door2 joeydoor2_X joeydoor2_Y joeydoor2_Z
GET_OBJECT_COORDINATES joeys_garage_door3 joeydoor3_X joeydoor3_Y joeydoor3_Z

joeydoor2_Z = joeydoor2_Z + 3.0
joeydoor3_Z = joeydoor3_Z + 3.0

	WHILE NOT SLIDE_OBJECT joeys_garage_door2 joeydoor2_X joeydoor2_Y joeydoor2_Z 0.1 0.1 0.1 FALSE
	OR NOT SLIDE_OBJECT joeys_garage_door3 joeydoor3_X joeydoor3_Y joeydoor3_Z 0.1 0.1 0.1 FALSE

		WAIT 0

		IF IS_CAR_DEAD carry_car
			GOTO mission_toni3_failed
		ENDIF

	ENDWHILE

CAR_GOTO_COORDINATES_ACCURATE carry_car 1198.4 -871.1 -100.0
SET_CAR_CRUISE_SPEED carry_car 4.0
SET_CAR_DRIVING_STYLE carry_car 3

WHILE NOT LOCATE_CAR_2D carry_car 1198.4 -871.1 2.0 2.0 FALSE
	WAIT 0

	IF IS_CAR_DEAD carry_car
		GOTO mission_toni3_failed
	ENDIF

ENDWHILE

GET_OBJECT_COORDINATES joeys_garage_door2 joeydoor2_X joeydoor2_Y joeydoor2_Z
GET_OBJECT_COORDINATES joeys_garage_door3 joeydoor3_X joeydoor3_Y joeydoor3_Z

joeydoor2_Z = joeydoor2_Z - 3.0
joeydoor3_Z = joeydoor3_Z - 3.0

	WHILE NOT SLIDE_OBJECT joeys_garage_door2 joeydoor2_X joeydoor2_Y joeydoor2_Z 0.1 0.1 0.1 FALSE
	OR NOT SLIDE_OBJECT joeys_garage_door3 joeydoor3_X joeydoor3_Y joeydoor3_Z 0.1 0.1 0.1 FALSE
		WAIT 0

		IF IS_CAR_DEAD carry_car
			GOTO mission_toni3_failed
		ENDIF

	ENDWHILE

ADD_BLIP_FOR_CAR carry_car blip1_t3
REMOVE_BLIP blip1_t3

SWITCH_WIDESCREEN OFF
SET_PLAYER_CONTROL Player On
SET_CAR_STATUS carry_car STATUS_PLAYER
SET_POLICE_IGNORE_PLAYER Player Off
SET_EVERYONE_IGNORE_PLAYER Player OFF
RESTORE_CAMERA_JUMPCUT
SET_CAMERA_IN_FRONT_OF_PLAYER
SET_CAR_PROOFS carry_car FALSE FALSE FALSE FALSE FALSE
flag_displayed_horn_message_tm3 = 0
flag_displayed_wanted_message_tm3 = 0


//PICK UP LUIGI

REMOVE_BLIP blip3_t3

pick_up_Luigi:

IF IS_CAR_DEAD carry_car
	GOTO mission_toni3_failed
ENDIF

flag_car_blip_displayed = TRUE
blob_flag = 1

WHILE NOT IS_PLAYER_STOPPED_IN_AREA_3D player 903.8 -423.0 14.0 908.3 -431.0 18.0 blob_flag
OR NOT IS_PLAYER_IN_CAR player carry_car
OR NOT IS_PLAYER_PRESSING_HORN player
OR IS_WANTED_LEVEL_GREATER Player 0    	

	WAIT 0

	IF IS_CAR_DEAD carry_car
		PRINT_NOW (TM3_A1) 5000 1 //Joeys dead
		GOTO mission_toni3_failed
	ENDIF
   
	IF IS_PLAYER_IN_CAR player carry_car
		IF flag_car_blip_displayed = TRUE
			ADD_BLIP_FOR_COORD 906.2 -426.0 -100.0 blip3_t3
			blob_flag = 1
			REMOVE_BLIP blip1_t3
		flag_car_blip_displayed = FALSE
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player carry_car
		IF flag_car_blip_displayed = FALSE
			ADD_BLIP_FOR_CAR carry_car blip1_t3
			REMOVE_BLIP blip3_t3
			blob_flag = 0
			PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the carry_car!"
			flag_car_blip_displayed = TRUE
		ENDIF
	ENDIF

	IF IS_PLAYER_STOPPED_IN_AREA_IN_CAR_3D player 903.8 -420.2 14.0 908.3 -431.1 18.0 FALSE
		IF IS_PLAYER_IN_CAR player carry_car
			IF IS_WANTED_LEVEL_GREATER player 0
				IF flag_displayed_wanted_message_tm3 = 0
					PRINT_NOW ( WANTED1 ) 5000 1
					flag_displayed_wanted_message_tm3 = 1
				ENDIF
			ELSE
				IF flag_displayed_horn_message_tm3 = 0
					PRINT_NOW ( HORN ) 5000 1
					flag_displayed_horn_message_tm3 = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_AREA_IN_CAR_3D player 903.8 -420.2 14.0 908.3 -431.1 18.0 FALSE
		IF flag_displayed_horn_message_tm3 = 1
		OR flag_displayed_wanted_message_tm3 = 1
			CLEAR_THIS_PRINT ( WANTED1 )
			CLEAR_THIS_PRINT ( HORN )
			flag_displayed_horn_message_tm3 = 0
			flag_displayed_wanted_message_tm3 = 0
		ENDIF
	ENDIF
	
	IF NOT IS_CAR_HEALTH_GREATER carry_car 600
		WAIT 500
		IF IS_CAR_DEAD carry_car
			PRINT_NOW (TM3_A1) 5000 1 //Joeys dead
			GOTO mission_toni3_failed
		ENDIF
		PRINT_NOW ( TRASH ) 5000 2 //Repair the car!
		REMOVE_BLIP blip1_t3
		REMOVE_BLIP blip3_t3
		ADD_BLIP_FOR_CAR carry_car blip1_t3
		CHANGE_BLIP_DISPLAY blip1_t3 BLIP_ONLY
		flag_car_blip_displayed = TRUE

		WHILE NOT IS_CAR_HEALTH_GREATER carry_car 600
			WAIT 0 

			IF IS_CAR_DEAD carry_car
				PRINT_NOW (TM3_A1) 5000 1 //Joeys dead
				GOTO mission_toni3_failed
			ENDIF

			IF IS_PLAYER_IN_CAR player carry_car
				IF flag_car_blip_displayed = TRUE
					//ADD_BLIP_FOR_COORD 925.0 -359.5 -100.0 blip5_t3
					ADD_SPRITE_BLIP_FOR_COORD 925.0 -359.5 -100.0 RADAR_SPRITE_SPRAY blip5_t3
					REMOVE_BLIP blip1_t3
				flag_car_blip_displayed = FALSE
				ENDIF
			ENDIF

			IF NOT IS_PLAYER_IN_CAR player carry_car
				IF flag_car_blip_displayed = FALSE
					ADD_BLIP_FOR_CAR carry_car blip1_t3
					REMOVE_BLIP blip5_t3
					PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the carry_car!"
					flag_car_blip_displayed = TRUE
				ENDIF
			ENDIF

		ENDWHILE

			REMOVE_BLIP blip5_t3
			GOTO pick_up_Luigi			
	ENDIF
	

ENDWHILE

CLEAR_THIS_PRINT ( WANTED1 )
CLEAR_THIS_PRINT ( HORN )

IF NOT IS_CAR_DEAD carry_car
	LOCK_CAR_DOORS carry_car CARLOCK_LOCKED_PLAYER_INSIDE
ENDIF

WAIT 500

SET_PLAYER_CONTROL Player Off
SWITCH_WIDESCREEN ON
SET_POLICE_IGNORE_PLAYER Player ON
SET_EVERYONE_IGNORE_PLAYER Player ON
REMOVE_BLIP blip3_t3

IF NOT IS_CAR_DEAD carry_car
	LOCK_CAR_DOORS carry_car CARLOCK_UNLOCKED
ENDIF

CLEAR_AREA 897.0 -425.5 14.7 6.0 TRUE

//SET_FIXED_CAMERA_POSITION 903.2 -427.7 16.6 0.0 0.0 0.0
//POINT_CAMERA_AT_CHAR luigi FIXED JUMP_CUT
SET_FIXED_CAMERA_POSITION 900.505 -419.672 14.976 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 900.937 -420.566 15.093 JUMP_CUT

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL3 897.0 -425.3 14.8 luigi
CLEAR_CHAR_THREAT_SEARCH luigi


SET_PED_DENSITY_MULTIPLIER 0.0

TIMERB = 0
LOAD_MISSION_AUDIO T3_B

 SET_CHAR_OBJ_GOTO_COORD_ON_FOOT luigi 901.0 -426.4

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED luigi
		WAIT 0

		IF IS_CHAR_DEAD luigi
			GOTO mission_toni3_failed
		ENDIF

		IF IS_CAR_DEAD carry_car
			GOTO mission_toni3_failed
		ENDIF

		IF TIMERB > 12000
			IF NOT IS_CHAR_DEAD	luigi
				SET_CHAR_COORDINATES luigi 901.0 -426.4 -100.0
			ENDIF
		ENDIF

	ENDWHILE


SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER luigi carry_car

	WHILE NOT IS_CHAR_IN_CAR luigi carry_car 
		WAIT 0

	 	IF IS_CHAR_DEAD luigi
			GOTO mission_toni3_failed
		ENDIF

		IF IS_CAR_DEAD carry_car
			GOTO mission_toni3_failed
		ENDIF

	ENDWHILE

SET_CHAR_CANT_BE_DRAGGED_OUT luigi TRUE

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE

PLAY_MISSION_AUDIO

SET_PLAYER_CONTROL Player On
RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN OFF
SET_POLICE_IGNORE_PLAYER Player OFF
SET_EVERYONE_IGNORE_PLAYER Player OFF
SET_PED_DENSITY_MULTIPLIER 1.0

SWITCH_PED_ROADS_ON 824.9 -633.8 13.0 845.3 -693.8 18.0 
SWITCH_ROADS_ON 824.9 -633.8 13.0 845.3 -693.8 18.0

flag_displayed_horn_message_tm3 = 0
flag_displayed_wanted_message_tm3 = 0


//PICK UP TONI

pick_up_toni:

flag_car_blip_displayed = TRUE
blob_flag = 1

IF NOT IS_CAR_DEAD carry_car
	IF NOT IS_PLAYER_IN_CAR player carry_car
		REMOVE_BLIP blip1_t3
		ADD_BLIP_FOR_CAR carry_car blip1_t3
		blob_flag = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the carry_car!"
	ENDIF
ENDIF

WHILE NOT IS_PLAYER_STOPPED_IN_AREA_3D player 1197.8 -321.0 24.3 1202.0 -327.5 28.0 blob_flag
OR NOT IS_PLAYER_IN_CAR player carry_car
OR NOT IS_PLAYER_PRESSING_HORN player
OR IS_WANTED_LEVEL_GREATER Player 0

	WAIT 0

	IF IS_CAR_DEAD carry_car
		PRINT_NOW (TM3_A2) 5000 1 //Joey and Luigi are dead
		GOTO mission_toni3_failed
	ENDIF
   
	IF IS_PLAYER_IN_CAR player carry_car
		IF flag_car_blip_displayed = TRUE
			ADD_BLIP_FOR_COORD 1200.5 -322.5 -100.0 blip4_t3
			blob_flag = 1
			REMOVE_BLIP blip1_t3
		flag_car_blip_displayed = FALSE
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player carry_car
		IF flag_car_blip_displayed = FALSE
			REMOVE_BLIP blip1_t3
			ADD_BLIP_FOR_CAR carry_car blip1_t3
			blob_flag = 0
			REMOVE_BLIP blip4_t3
			PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the carry_car!"
			flag_car_blip_displayed = TRUE
		ENDIF
	ENDIF

	IF IS_PLAYER_STOPPED_IN_AREA_IN_CAR_3D player 1197.8 -321.0 24.3 1202.0 -327.5 28.0 FALSE
		IF IS_PLAYER_IN_CAR player carry_car

			IF IS_WANTED_LEVEL_GREATER player 0
				IF flag_displayed_wanted_message_tm3 = 0
					PRINT_NOW ( WANTED1 ) 5000 1
					flag_displayed_wanted_message_tm3 = 1
				ENDIF
			ELSE
				IF flag_displayed_horn_message_tm3 = 0
					PRINT_NOW ( HORN ) 5000 1
					flag_displayed_horn_message_tm3 = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_AREA_IN_CAR_3D player 1197.8 -321.0 24.3 1202.0 -327.5 28.0 FALSE
		IF flag_displayed_horn_message_tm3 = 1
		OR flag_displayed_wanted_message_tm3 = 1
			CLEAR_THIS_PRINT ( WANTED1 )
			CLEAR_THIS_PRINT ( HORN )
			flag_displayed_horn_message_tm3 = 0
			flag_displayed_wanted_message_tm3 = 0
		ENDIF
	ENDIF

	IF NOT IS_CAR_HEALTH_GREATER carry_car 600
		WAIT 500
		IF IS_CAR_DEAD carry_car
			PRINT_NOW (TM3_A2) 5000 1 //Joey and Luigi are dead
			GOTO mission_toni3_failed
		ENDIF
		PRINT_NOW ( TRASH ) 5000 2 //Repair the car!
		REMOVE_BLIP blip1_t3
		REMOVE_BLIP blip4_t3
		ADD_BLIP_FOR_CAR carry_car blip1_t3
		CHANGE_BLIP_DISPLAY blip1_t3 BLIP_ONLY		
		flag_car_blip_displayed = TRUE

		WHILE NOT IS_CAR_HEALTH_GREATER carry_car 600
			WAIT 0 

			IF IS_CAR_DEAD carry_car
				PRINT_NOW (TM3_A2) 5000 1 //Joey and Luigi are dead
				GOTO mission_toni3_failed
			ENDIF

			IF IS_PLAYER_IN_CAR player carry_car
				IF flag_car_blip_displayed = TRUE
					ADD_SPRITE_BLIP_FOR_COORD 925.0 -359.5 -100.0 RADAR_SPRITE_SPRAY blip5_t3
					REMOVE_BLIP blip1_t3
				flag_car_blip_displayed = FALSE
				ENDIF
			ENDIF

			IF NOT IS_PLAYER_IN_CAR player carry_car
				IF flag_car_blip_displayed = FALSE
					ADD_BLIP_FOR_CAR carry_car blip1_t3
					REMOVE_BLIP blip5_t3
					PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the carry_car!"
					flag_car_blip_displayed = TRUE
				ENDIF
			ENDIF

		ENDWHILE

		REMOVE_BLIP blip5_t3
		GOTO pick_up_toni
	ENDIF
	

ENDWHILE

CLEAR_THIS_PRINT ( WANTED1 )
CLEAR_THIS_PRINT ( HORN )

IF NOT IS_CAR_DEAD carry_car
	LOCK_CAR_DOORS carry_car CARLOCK_LOCKED_PLAYER_INSIDE
ENDIF

WAIT 500

SET_PLAYER_CONTROL Player Off
SWITCH_WIDESCREEN ON
SET_POLICE_IGNORE_PLAYER Player ON
SET_EVERYONE_IGNORE_PLAYER Player ON
REMOVE_BLIP blip4_t3

IF NOT IS_CAR_DEAD carry_car
	LOCK_CAR_DOORS carry_car CARLOCK_UNLOCKED
ENDIF

CLEAR_AREA 1213.6 -321.1 26.5 10.0 TRUE

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 1217.0 -321.1 -100.0 toni
SET_CHAR_HEADING toni 90.0
CLEAR_CHAR_THREAT_SEARCH toni

//SET_FIXED_CAMERA_POSITION 1211.6 -323.7 28.0 0.0 0.0 0.0
//POINT_CAMERA_AT_CHAR toni FIXED JUMP_CUT
SET_FIXED_CAMERA_POSITION 1222.214 -328.629 34.454 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 1221.629 -328.046 33.891 JUMP_CUT

SET_PED_DENSITY_MULTIPLIER 0.0
/*
TIMERB = 0

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT toni 1219.2 -320.9

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED toni
		WAIT 0

		IF IS_CHAR_DEAD toni
			GOTO mission_toni3_failed
		ENDIF

		IF IS_CAR_DEAD carry_car
			GOTO mission_toni3_failed
		ENDIF

		IF TIMERB > 12000
			IF NOT IS_CHAR_DEAD	toni
				SET_CHAR_COORDINATES toni 1219.2 -320.9 26.4
			ENDIF
		ENDIF

	ENDWHILE
*/
TIMERB = 0

LOAD_MISSION_AUDIO T3_C

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT toni 1205.5 -321.0

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED toni
		WAIT 0

		IF IS_CHAR_DEAD toni
			GOTO mission_toni3_failed
		ENDIF

		IF IS_CAR_DEAD carry_car
			GOTO mission_toni3_failed
		ENDIF

		IF TIMERB > 12000
			IF NOT IS_CHAR_DEAD	toni
				SET_CHAR_COORDINATES toni 1205.5 -321.0 -100.0
			ENDIF
		ENDIF

	ENDWHILE


SET_FIXED_CAMERA_POSITION 1206.2 -326.2 27.0 0.0 0.0 0.0
POINT_CAMERA_AT_CHAR toni FIXED JUMP_CUT
SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER toni carry_car

	WHILE NOT IS_CHAR_IN_CAR toni carry_car 
		WAIT 0

	 	IF IS_CHAR_DEAD toni
			GOTO mission_toni3_failed
		ENDIF

		IF IS_CAR_DEAD carry_car
			GOTO mission_toni3_failed
		ENDIF

	ENDWHILE

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE

PLAY_MISSION_AUDIO

SET_CHAR_CANT_BE_DRAGGED_OUT toni TRUE
SET_POLICE_IGNORE_PLAYER Player OFF
SET_EVERYONE_IGNORE_PLAYER Player OFF
SET_PED_DENSITY_MULTIPLIER 1.0


//YET ANOTHER AMBUSH BY THE TRIADS

CREATE_CAR CAR_BELLYUP 1193.0 -228.0 -100.0 triad_van1
SET_CAR_HEADING triad_van1 180.0
SET_CAR_DRIVING_STYLE triad_van1 3
SET_CAR_CRUISE_SPEED triad_van1 30.0
SET_CAR_STRONG triad_van1 TRUE

			CREATE_CHAR_INSIDE_CAR triad_van1 PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A triads1
			GIVE_WEAPON_TO_CHAR triads1 WEAPONTYPE_PISTOL 100
			SET_CAR_MISSION  triad_van1 2
			SET_CHAR_THREAT_SEARCH triads1 THREAT_PLAYER1

			CREATE_CHAR_AS_PASSENGER triad_van1 PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 0 triads2
			GIVE_WEAPON_TO_CHAR triads2 WEAPONTYPE_PISTOL 100
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS triads2 Player
			//SET_CHAR_OBJ_DESTROY_CAR triads2 carry_car
			SET_CHAR_THREAT_SEARCH triads2 THREAT_PLAYER1

CREATE_CAR CAR_BELLYUP 1275.8 -346.7 -100.0 triad_van2
SET_CAR_HEADING triad_van2 1.0
SET_CAR_DRIVING_STYLE triad_van2 3
SET_CAR_CRUISE_SPEED triad_van2 30.0
SET_CAR_STRONG triad_van2 TRUE

			CREATE_CHAR_INSIDE_CAR triad_van2 PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A triads3
			GIVE_WEAPON_TO_CHAR triads3 WEAPONTYPE_PISTOL 100
			SET_CAR_MISSION  triad_van2 2
			SET_CHAR_THREAT_SEARCH triads3 THREAT_PLAYER1

			CREATE_CHAR_AS_PASSENGER triad_van2 PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 0 triads4
			GIVE_WEAPON_TO_CHAR triads4 WEAPONTYPE_PISTOL 100
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS triads4 Player
			//SET_CHAR_OBJ_DESTROY_CAR triads4 carry_car
			SET_CHAR_THREAT_SEARCH triads4 THREAT_PLAYER1

CREATE_CAR CAR_BELLYUP 1342.5 -281.5 -100.0 triad_van3
SET_CAR_HEADING triad_van3 90.0
SET_CAR_DRIVING_STYLE triad_van3 3
SET_CAR_CRUISE_SPEED triad_van3 30.0	
SET_CAR_STRONG triad_van3 TRUE

			CREATE_CHAR_INSIDE_CAR triad_van3 PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A triads5
			GIVE_WEAPON_TO_CHAR triads5 WEAPONTYPE_PISTOL 100
			SET_CAR_MISSION  triad_van3 2
			SET_CHAR_THREAT_SEARCH triads5 THREAT_PLAYER1

			CREATE_CHAR_AS_PASSENGER triad_van3 PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 0 triads6
			GIVE_WEAPON_TO_CHAR triads6 WEAPONTYPE_PISTOL 100
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS triads6 Player
			//SET_CHAR_OBJ_DESTROY_CAR triads6 carry_car
			SET_CHAR_THREAT_SEARCH triads6 THREAT_PLAYER1

CREATE_CAR CAR_BELLYUP 1121.6 -345.2 -100.0 triad_van4
SET_CAR_HEADING triad_van4 270.0
SET_CAR_DRIVING_STYLE triad_van4 3
SET_CAR_CRUISE_SPEED triad_van4 30.0	
SET_CAR_STRONG triad_van4 TRUE

			CREATE_CHAR_INSIDE_CAR triad_van4 PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A triads7
			GIVE_WEAPON_TO_CHAR triads7 WEAPONTYPE_PISTOL 100
			SET_CAR_MISSION triad_van4 2
			SET_CHAR_THREAT_SEARCH triads7 THREAT_PLAYER1

			CREATE_CHAR_AS_PASSENGER triad_van4 PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 0 triads8
			GIVE_WEAPON_TO_CHAR triads8 WEAPONTYPE_PISTOL 100
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS triads8 Player
			//SET_CHAR_OBJ_DESTROY_CAR triads8 carry_car
			SET_CHAR_THREAT_SEARCH triads8 THREAT_PLAYER1

//ROAD BLOCK

CREATE_CAR CAR_BELLYUP 1383.3 -285.0 -100.0 triad_van5
SET_CAR_HEADING triad_van5 10.0

CREATE_CAR CAR_BELLYUP 1383.3 -279.0 -100.0 triad_van6
SET_CAR_HEADING triad_van6 160.0

CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 1382.1 -281.7 -100.0 triads9
GIVE_WEAPON_TO_CHAR triads9 WEAPONTYPE_PISTOL 100
SET_CHAR_STAY_IN_SAME_PLACE triads9 TRUE
SET_CHAR_OBJ_DESTROY_CAR triads9 carry_car
SET_CHAR_THREAT_SEARCH triads9 THREAT_PLAYER1

CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 1384.3 -291.5 -100.0 triads10
GIVE_WEAPON_TO_CHAR triads10 WEAPONTYPE_PISTOL 100
SET_CHAR_STAY_IN_SAME_PLACE triads10 TRUE
SET_CHAR_OBJ_DESTROY_CAR triads10 carry_car
SET_CHAR_THREAT_SEARCH triads10 THREAT_PLAYER1

POINT_CAMERA_AT_CAR triad_van1 BEHINDCAR INTERPOLATION

WAIT 3000

SET_PLAYER_CONTROL Player On
SWITCH_WIDESCREEN OFF
RESTORE_CAMERA_JUMPCUT


//GO TO FRANKIES

get_to_frankies:

flag_car_blip_displayed = TRUE

IF NOT IS_CAR_DEAD carry_car
	SET_TARGET_CAR_FOR_MISSION_GARAGE frankie_garage carry_car
ENDIF

IF NOT IS_CAR_DEAD carry_car
	IF NOT IS_PLAYER_IN_CAR player carry_car
		REMOVE_BLIP blip1_t3
		ADD_BLIP_FOR_CAR carry_car blip1_t3
		blob_flag = 0
		PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the carry_car!"
	ENDIF
ENDIF

WHILE NOT IS_CAR_IN_MISSION_GARAGE frankie_garage
//OR NOT IS_PLAYER_IN_CAR player carry_car
	WAIT 0

		IF IS_CAR_DEAD carry_car
			PRINT_NOW (TM3_A3) 5000 1 //Joey, luigi and Toni are dead
			GOTO mission_toni3_failed
		ENDIF

		IF IS_PLAYER_IN_CAR player carry_car
			IF flag_car_blip_displayed = TRUE
				ADD_BLIP_FOR_COORD 1428.6 -183.1 -100.0 blip2_t3
				CHANGE_BLIP_DISPLAY blip2_t3 BLIP_ONLY
				REMOVE_BLIP blip1_t3
			flag_car_blip_displayed = FALSE
			ENDIF
		ENDIF

		IF NOT IS_PLAYER_IN_CAR player carry_car
			IF flag_car_blip_displayed = FALSE
			ADD_BLIP_FOR_CAR carry_car blip1_t3
			REMOVE_BLIP blip2_t3
			PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the carry_car!"
			flag_car_blip_displayed = TRUE
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD triad_van1
			IF IS_CAR_IN_AREA_2D triad_van1 1393.6 -268.2 1427.1 -154.1 FALSE
				IF NOT IS_CHAR_DEAD triads1
				AND NOT IS_CHAR_DEAD triads2
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triads1 Player
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triads2 Player
				ENDIF	
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD triad_van2
			IF IS_CAR_IN_AREA_2D triad_van2 1393.6 -268.2 1427.1 -154.1 FALSE
				IF NOT IS_CHAR_DEAD triads3
				AND NOT IS_CHAR_DEAD triads4
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triads3 Player
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triads4 Player
				ENDIF	
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD triad_van3
			IF IS_CAR_IN_AREA_2D triad_van3 1393.6 -268.2 1427.1 -154.1 FALSE
				IF NOT IS_CHAR_DEAD triads5
				AND NOT IS_CHAR_DEAD triads6
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triads5 Player
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triads6 Player
				ENDIF	
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD triad_van4
			IF IS_CAR_IN_AREA_2D triad_van4 1393.6 -268.2 1427.1 -154.1 FALSE
				IF NOT IS_CHAR_DEAD triads7
				AND NOT IS_CHAR_DEAD triads8
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triads7 Player
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triads8 Player
				ENDIF	
			ENDIF
		ENDIF

ENDWHILE


REMOVE_BLIP blip1_t3
REMOVE_BLIP blip2_t3
SET_FIXED_CAMERA_POSITION 1421.8 -182.5 52.5 0.0 0.0 0.0
POINT_CAMERA_AT_CAR carry_car FIXED INTERPOLATION

WAIT 1000

SET_POLICE_IGNORE_PLAYER Player OFF
SET_EVERYONE_IGNORE_PLAYER Player OFF

IF IS_PLAYER_IN_ANY_CAR player
	WARP_PLAYER_FROM_CAR_TO_COORD player 1454.6 -189.5 55.0
ELSE
	SET_PLAYER_COORDINATES Player 1454.6 -189.5 55.0
ENDIF

	IF NOT IS_CHAR_DEAD triads1
		DELETE_CHAR triads1
	ENDIF
	IF NOT IS_CHAR_DEAD triads2
		DELETE_CHAR triads2
	ENDIF
	IF NOT IS_CHAR_DEAD triads3
		DELETE_CHAR triads3
	ENDIF
	IF NOT IS_CHAR_DEAD triads4
		DELETE_CHAR triads4
	ENDIF
	IF NOT IS_CHAR_DEAD triads5
		DELETE_CHAR triads5
	ENDIF
	IF NOT IS_CHAR_DEAD triads6
		DELETE_CHAR triads6
	ENDIF
	IF NOT IS_CHAR_DEAD triads7
		DELETE_CHAR triads7
	ENDIF
	IF NOT IS_CHAR_DEAD triads8
		DELETE_CHAR triads8
	ENDIF
	IF NOT IS_CHAR_DEAD triads9
		DELETE_CHAR triads9
	ENDIF
	IF NOT IS_CHAR_DEAD triads10
		DELETE_CHAR triads10
	ENDIF
	IF NOT IS_CAR_DEAD triad_van1
		DELETE_CAR triad_van1
	ENDIF
	IF NOT IS_CAR_DEAD triad_van2
		DELETE_CAR triad_van2
	ENDIF
	IF NOT IS_CAR_DEAD triad_van3
		DELETE_CAR triad_van3
	ENDIF
	IF NOT IS_CAR_DEAD triad_van4
		DELETE_CAR triad_van4
	ENDIF
	IF NOT IS_CAR_DEAD triad_van5
		DELETE_CAR triad_van5
	ENDIF
	IF NOT IS_CAR_DEAD triad_van6
		DELETE_CAR triad_van6
	ENDIF

//skip_to_toni3_cut: //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
//LOAD_SCENE 1457.776 -185.348 54.925	//TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
//SET_PLAYER_COORDINATES player 1454.6 -189.5 55.0 //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


	GET_GAME_TIMER breakout_timer_start
	breakout_diff = 0

	WHILE NOT CAN_PLAYER_START_MISSION Player
	AND breakout_diff < 5000	//	if player is not in control after 5 secs do the cutscene anyway
		WAIT 0

		IF IS_CAR_DEAD carry_car
			PRINT_NOW (TM3_A3) 5000 1 //Joey, luigi and Toni are dead
			GOTO mission_toni3_failed
		ENDIF

		GET_GAME_TIMER breakout_timer							
		breakout_diff = breakout_timer - breakout_timer_start
	ENDWHILE

	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player


// ****************************************START OF CUTSCENE2********************************
 
SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

CLEAR_AREA 1427.0 -187.8 50.0 12.0 TRUE
CLEAR_AREA 1444.99 -186.9 56.0 30.0 TRUE

SWITCH_RUBBISH OFF
SWITCH_STREAMING OFF

LOAD_SPECIAL_CHARACTER 4 frankie
REQUEST_MODEL PED_GANG_MAFIA_B

LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 FRANKH
LOAD_SPECIAL_MODEL cut_obj3 JOEYH
LOAD_SPECIAL_MODEL cut_obj4 LUIGIH
LOAD_SPECIAL_MODEL cut_obj5 TONYH
REQUEST_MODEL salvsdetail
REQUEST_MODEL swank_inside
REQUEST_MODEL franksclb02

WHILE GET_FADING_STATUS
	WAIT 0

ENDWHILE

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 4
OR NOT HAS_MODEL_LOADED PED_GANG_MAFIA_B
OR NOT HAS_MODEL_LOADED	salvsdetail
OR NOT HAS_MODEL_LOADED swank_inside
OR NOT HAS_MODEL_LOADED	franksclb02
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj4
OR NOT HAS_MODEL_LOADED cut_obj5
	WAIT 0
ENDWHILE

LOAD_CUTSCENE S0_MAS
SET_CUTSCENE_OFFSET 1457.776 -185.348 54.925

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_tony
SET_CUTSCENE_ANIM cs_tony tony

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_joey
SET_CUTSCENE_ANIM cs_joey joey2

CREATE_CUTSCENE_OBJECT PED_SPECIAL3 cs_luigi
SET_CUTSCENE_ANIM cs_luigi luigi

CREATE_CUTSCENE_OBJECT PED_SPECIAL4 cs_frankie
SET_CUTSCENE_ANIM cs_frankie frankie

CREATE_CUTSCENE_OBJECT PED_GANG_MAFIA_B cs_mafia
SET_CUTSCENE_ANIM cs_mafia gang02

CREATE_CUTSCENE_HEAD cs_player cut_obj1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_frankie cut_obj2 cs_frankiehead
SET_CUTSCENE_HEAD_ANIM cs_frankiehead frank

CREATE_CUTSCENE_HEAD cs_joey cut_obj3 cs_joeyhead
SET_CUTSCENE_HEAD_ANIM cs_joeyhead joey

CREATE_CUTSCENE_HEAD cs_luigi cut_obj4 cs_luigihead
SET_CUTSCENE_HEAD_ANIM cs_luigihead luigi

CREATE_CUTSCENE_HEAD cs_tony cut_obj5 cs_tonyhead
SET_CUTSCENE_HEAD_ANIM cs_tonyhead tony

//SET_PLAYER_COORDINATES player 1455.2 -186.8 55.0

SET_PLAYER_HEADING player 341.0

DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON
START_CUTSCENE

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 416 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_H 10000 1

WHILE cs_time < 3252
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_I 10000 1

WHILE cs_time < 4866
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_J 10000 1

WHILE cs_time < 5839
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_K 10000 1

WHILE cs_time < 10201
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_L 10000 1

WHILE cs_time < 13769
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_M 10000 1

WHILE cs_time < 17654
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_N 10000 1

WHILE cs_time < 18718
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_N2 10000 1

WHILE cs_time < 19529
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_O 10000 1

WHILE cs_time < 21673
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_P 10000 1

WHILE cs_time < 25525
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_Q 10000 1

WHILE cs_time < 26615
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_R 10000 1

WHILE cs_time < 29462
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_S 10000 1

WHILE cs_time < 32814
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_T 10000 1

WHILE cs_time < 35855
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_U 10000 1

WHILE cs_time < 37787
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_V 10000 1

WHILE cs_time < 44707
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW TM3_W 10000 1

WHILE cs_time < 47837
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 48666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT
WHILE GET_FADING_STATUS
WAIT 0
ENDWHILE

WHILE NOT HAS_CUTSCENE_FINISHED
WAIT 0
ENDWHILE

CLEAR_PRINTS

DO_FADE 0 FADE_OUT

CLEAR_CUTSCENE

DO_FADE 0 FADE_OUT

UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
UNLOAD_SPECIAL_CHARACTER 3
UNLOAD_SPECIAL_CHARACTER 4
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj3
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj4
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj5
MARK_MODEL_AS_NO_LONGER_NEEDED salvsdetail
MARK_MODEL_AS_NO_LONGER_NEEDED swank_inside
MARK_MODEL_AS_NO_LONGER_NEEDED franksclb02

WAIT 500

DO_FADE 1500 FADE_IN


}
		
GOTO mission_toni3_passed  
			


 // Mission toni3 failed

mission_toni3_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission toni3 passed

mission_toni3_passed:

flag_toni_mission3_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 15000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 15000
REGISTER_MISSION_PASSED	TM3
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT frankie_mission1_loop
REMOVE_BLIP	luigi_contact_blip
REMOVE_BLIP	joey_contact_blip
REMOVE_BLIP	toni_contact_blip
REMOVE_BLIP frankie_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1455.7 -187.3 -100.0 RADAR_SPRITE_SAL frankie_contact_blip
//WAIT 3000						  
//WARP_PLAYER_FROM_CAR_TO_COORD player 1455.7 -187.3 -100.0
DELETE_CAR carry_car				 
RESTORE_CAMERA_JUMPCUT
SET_CAMERA_BEHIND_PLAYER
RETURN
		


// mission cleanup

mission_cleanup_toni3:

DISPLAY_RADAR 3 // HACKED RADAR ON

flag_player_on_mission = 0
flag_player_on_toni_mission = 0
REMOVE_BLIP blip1_t3
REMOVE_BLIP blip2_t3
REMOVE_BLIP blip3_t3
REMOVE_BLIP blip4_t3
REMOVE_BLIP blip5_t3
REMOVE_CHAR_ELEGANTLY joey
REMOVE_CHAR_ELEGANTLY luigi
REMOVE_CHAR_ELEGANTLY toni
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STRETCH
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_BELLYUP
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_B
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_B
UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
UNLOAD_SPECIAL_CHARACTER 3
UNLOAD_SPECIAL_CHARACTER 4
SET_TARGET_CAR_FOR_MISSION_GARAGE frankie_garage -1
CLEAR_THIS_PRINT ( IN_VEH )
MISSION_HAS_FINISHED
RETURN

MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Toni mission 4****************************************
// ********************************Kill the Triad Warlords************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff

GOSUB mission_start_toni4

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_toni4_failed
ENDIF

GOSUB mission_cleanup_toni4

MISSION_END

// Variables for mission

VAR_INT blip1_tm4 blip2_tm4 blip3_tm4 triad1_can_leg_it triad2_can_leg_it triad3_can_leg_it
 
VAR_INT	triad_head1 triad_head2 triad_head3 warlords_dead 

VAR_INT triad_grunt1 triad_grunt1B triad_grunt2 triad_grunt2B triad_grunt3 triad_grunt3B

VAR_INT grunts1_been_created_before grunts2_been_created_before grunts3_been_created_before 

VAR_INT mafia_goon1 mafia_goon2	been_in_fish_factory clear_triads_threats

VAR_INT grabbed_peds_before	Fishbastards audio_played_tm4

VAR_INT char_already_dead1 char_already_dead2 char_already_dead3

VAR_INT pay_back_for_traids1 pay_back_for_traids2 pay_back_for_traids3

// ***************************************Mission Start*************************************

mission_start_toni4:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_toni_mission = 1
SCRIPT_NAME toni4
WAIT 0

grunts1_been_created_before = 0
grunts2_been_created_before = 0
grunts3_been_created_before = 0
grabbed_peds_before = 0
been_in_fish_factory = 0 
audio_played_tm4 = 0
triad1_can_leg_it = 0
triad1_can_leg_it = 0
triad1_can_leg_it = 0
pay_back_for_traids1 = 0
pay_back_for_traids2 = 0
pay_back_for_traids3 = 0

{

REQUEST_MODEL PED_GANG_MAFIA_A
REQUEST_MODEL PED_GANG_MAFIA_B
REQUEST_MODEL ind_newrizzos
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2	NOTE

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED PED_GANG_MAFIA_A
OR NOT HAS_MODEL_LOADED PED_GANG_MAFIA_B
OR NOT HAS_MODEL_LOADED ind_newrizzos
	WAIT 0

ENDWHILE

CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_B 1216.4 -309.9 -100.0 mafia_goon1
CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A 1215.9 -311.2 29.0 mafia_goon2

	IF NOT IS_CHAR_DEAD mafia_goon1
	AND NOT IS_CHAR_DEAD mafia_goon2

		GIVE_WEAPON_TO_CHAR mafia_goon1 WEAPONTYPE_UZI 300
		SET_CHAR_THREAT_SEARCH mafia_goon1 THREAT_COP
		SET_CHAR_THREAT_SEARCH mafia_goon1 THREAT_GANG_TRIAD
		SET_CHAR_RUNNING mafia_goon1 TRUE
		TURN_CHAR_TO_FACE_CHAR mafia_goon1 mafia_goon2
		SET_CHARS_CHATTING mafia_goon1 mafia_goon2 24000

		GIVE_WEAPON_TO_CHAR mafia_goon2 WEAPONTYPE_UZI 300
		SET_CHAR_THREAT_SEARCH mafia_goon2 THREAT_COP
		SET_CHAR_THREAT_SEARCH mafia_goon2 THREAT_GANG_TRIAD
		SET_CHAR_RUNNING mafia_goon2 TRUE
		TURN_CHAR_TO_FACE_CHAR mafia_goon2 mafia_goon1

	ENDIF


LOAD_CUTSCENE T4_TAT
SET_CUTSCENE_OFFSET 1218.42 -314.5 28.9

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj2 cs_note
SET_CUTSCENE_ANIM cs_note NOTE

CLEAR_AREA 1219.6 -323.0 25.6 1.0 TRUE
SET_PLAYER_COORDINATES player 1219.6 -323.0 25.6

SET_PLAYER_HEADING player 180.0

CLEAR_AREA 1216.1 -313.0 29.9 10.0 TRUE	//TONIS RESTAURANT

DO_FADE 1500 FADE_IN

//SWITCH_WORLD_PROCESSING OFF
SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time


WHILE cs_time < 82
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM4_A ) 10000 1 // Mission brief

WHILE cs_time < 2415
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM4_A2 ) 10000 1 // Mission brief

WHILE cs_time < 4420
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM4_B ) 10000 1 // Mission brief

WHILE cs_time < 7629
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM4_C ) 10000 1 // Mission brief

WHILE cs_time < 11110
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM4_D ) 10000 1 // Mission brief

WHILE cs_time < 13283
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM4_E ) 10000 1 // Mission brief

WHILE cs_time < 18058
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM4_F ) 10000 1 // Mission brief

WHILE cs_time < 21248
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM4_G ) 10000 1 // Mission brief

WHILE cs_time < 24000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

//SWITCH_WORLD_PROCESSING ON
SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER

IF NOT IS_CHAR_DEAD	mafia_goon1
AND NOT IS_CHAR_DEAD mafia_goon2
	SET_CHARS_CHATTING mafia_goon1 mafia_goon2 0
ENDIF

GIVE_WEAPON_TO_PLAYER Player WEAPONTYPE_SHOTGUN 20
SET_CURRENT_PLAYER_WEAPON Player WEAPONTYPE_SHOTGUN

IF NOT IS_CHAR_DEAD	mafia_goon1
AND NOT IS_CHAR_DEAD mafia_goon2
	SET_CHAR_COORDINATES mafia_goon1 1220.2 -321.8 26.4
	SET_CHAR_COORDINATES mafia_goon2 1219.0 -321.3 26.4
ENDIF

WAIT 500

DO_FADE 1500 FADE_IN

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED ind_newrizzos

REQUEST_MODEL PED_GANG_TRIAD_A
REQUEST_MODEL PED_GANG_TRIAD_B

	WHILE NOT HAS_MODEL_LOADED PED_GANG_TRIAD_A
	OR NOT HAS_MODEL_LOADED PED_GANG_TRIAD_B
		WAIT 0
	ENDWHILE

SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1 //TEST

warlords_dead = 0
triads_spot_you = 0
clear_triads_threats = 0

IF NOT IS_CHAR_DEAD mafia_goon1
	SET_PLAYER_AS_LEADER mafia_goon1 player
ENDIF

IF NOT IS_CHAR_DEAD mafia_goon2  
	SET_PLAYER_AS_LEADER mafia_goon2 player
ENDIF
 

    SETUP_ZONE_PED_INFO LITTLEI DAY	  (15) 500 250 0 (0 0 0 0) 0
    SETUP_ZONE_PED_INFO	LITTLEI	NIGHT ( 8) 500 250 0 (0 0 0 0) 0

    SETUP_ZONE_PED_INFO CHINA DAY   (30) 350 600 0 (0 0 0 0) 0  
    SETUP_ZONE_PED_INFO CHINA NIGHT (30) 350 600 0 (0 0 0 0) 0


// START MISSION

//RESET_NUM_OF_MODELS_KILLED_BY_PLAYER

CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 906.4 -541.4 14.4 triad_head1 //Fish warhouse (Chinatown)
GIVE_WEAPON_TO_CHAR triad_head1 WEAPONTYPE_UZI 80
SET_CHAR_HEADING triad_head1 109.0
ADD_BLIP_FOR_CHAR triad_head1 blip1_tm4
ADD_ARMOUR_TO_CHAR triad_head1 100
//SET_CHAR_THREAT_SEARCH triad_head1 THREAT_GANG_MAFIA
CLEAR_CHAR_THREAT_SEARCH triad_head1
SET_CHAR_THREAT_SEARCH triad_head1 THREAT_PLAYER1
SET_CHAR_THREAT_SEARCH triad_head1 THREAT_FAST_CAR
SET_CHAR_ONLY_DAMAGED_BY_PLAYER triad_head1 TRUE
SET_CHAR_STAY_IN_SAME_PLACE triad_head1 TRUE

CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 968.6 -682.2 14.3 triad_head2 //Market place
GIVE_WEAPON_TO_CHAR triad_head2 WEAPONTYPE_UZI 80
ADD_BLIP_FOR_CHAR triad_head2 blip2_tm4
ADD_ARMOUR_TO_CHAR triad_head2 100
//SET_CHAR_THREAT_SEARCH triad_head2 THREAT_GANG_MAFIA
CLEAR_CHAR_THREAT_SEARCH triad_head2
SET_CHAR_THREAT_SEARCH triad_head2 THREAT_PLAYER1
SET_CHAR_THREAT_SEARCH triad_head2 THREAT_FAST_CAR
SET_CHAR_ONLY_DAMAGED_BY_PLAYER triad_head2 TRUE
SET_CHAR_STAY_IN_SAME_PLACE triad_head2 TRUE

CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 968.3 -1136.8 15.0 triad_head3 //Fish factory
GIVE_WEAPON_TO_CHAR triad_head3 WEAPONTYPE_UZI 80
SET_CHAR_HEADING triad_head3 38.0
ADD_BLIP_FOR_CHAR triad_head3 blip3_tm4
ADD_ARMOUR_TO_CHAR triad_head3 100
//SET_CHAR_THREAT_SEARCH triad_head3 THREAT_GANG_MAFIA
CLEAR_CHAR_THREAT_SEARCH triad_head3
SET_CHAR_THREAT_SEARCH triad_head3 THREAT_PLAYER1
SET_CHAR_THREAT_SEARCH triad_head3 THREAT_FAST_CAR
SET_CHAR_ONLY_DAMAGED_BY_PLAYER triad_head3 TRUE
SET_CHAR_STAY_IN_SAME_PLACE triad_head3 TRUE

char_already_dead1 = 0
char_already_dead2 = 0
char_already_dead3 = 0
	
	LOAD_MISSION_AUDIO T4_A

	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE
	
WHILE NOT warlords_dead = 3
	WAIT 0

		IF IS_CHAR_DEAD triad_head1 
		AND char_already_dead1 = 0
			REMOVE_BLIP blip1_tm4 
			warlords_dead ++
			char_already_dead1 = 1
		ENDIF  	   		   	 		 

		IF IS_CHAR_DEAD triad_head2 
		AND char_already_dead2 = 0 
			REMOVE_BLIP blip2_tm4
			warlords_dead ++
			char_already_dead2 = 1
		ENDIF

		IF IS_CHAR_DEAD triad_head3 
		AND char_already_dead3 = 0
			REMOVE_BLIP blip3_tm4 
			warlords_dead ++
			char_already_dead3 = 1
		ENDIF

		IF IS_PLAYER_IN_ZONE Player PORT_W
		AND has_player_been_at_fish_before = 1
		AND clear_triads_threats = 0

			IF NOT IS_CHAR_DEAD	fish_triad1
				CLEAR_CHAR_THREAT_SEARCH fish_triad1
			ENDIF
			IF NOT IS_CHAR_DEAD	fish_triad2
				CLEAR_CHAR_THREAT_SEARCH fish_triad2
			ENDIF
			IF NOT IS_CHAR_DEAD	fish_triad3
				CLEAR_CHAR_THREAT_SEARCH fish_triad3
			ENDIF
			IF NOT IS_CHAR_DEAD	fish_triad4
				CLEAR_CHAR_THREAT_SEARCH fish_triad4
			ENDIF
			IF NOT IS_CHAR_DEAD	fish_triad5
				CLEAR_CHAR_THREAT_SEARCH fish_triad5
			ENDIF
			IF NOT IS_CHAR_DEAD	fish_triad6
				CLEAR_CHAR_THREAT_SEARCH fish_triad6
			ENDIF

			CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1

			clear_triads_threats = 1
		ENDIF

		IF IS_PLAYER_IN_ZONE player FISHFAC	
			IF triads_spot_you = 0
				IF NOT IS_PLAYER_IN_ANY_CAR Player
				
					IF NOT IS_CHAR_DEAD	fish_triad1
						SET_CHAR_THREAT_SEARCH fish_triad1 THREAT_PLAYER1
					ENDIF
					IF NOT IS_CHAR_DEAD	fish_triad2
						SET_CHAR_THREAT_SEARCH fish_triad2 THREAT_PLAYER1
					ENDIF
					IF NOT IS_CHAR_DEAD	fish_triad3
						SET_CHAR_THREAT_SEARCH fish_triad3 THREAT_PLAYER1
					ENDIF
					IF NOT IS_CHAR_DEAD	fish_triad4
						SET_CHAR_THREAT_SEARCH fish_triad4 THREAT_PLAYER1
					ENDIF
					IF NOT IS_CHAR_DEAD	fish_triad5
						SET_CHAR_THREAT_SEARCH fish_triad5 THREAT_PLAYER1
					ENDIF
					IF NOT IS_CHAR_DEAD	fish_triad6
						SET_CHAR_THREAT_SEARCH fish_triad6 THREAT_PLAYER1
					ENDIF

					triads_spot_you = 1
				ENDIF
				
				IF IS_CHAR_DEAD	fish_triad1
				OR IS_CHAR_DEAD fish_triad2
				OR IS_CHAR_DEAD fish_triad3
				OR IS_CHAR_DEAD fish_triad4
				OR IS_CHAR_DEAD fish_triad5
				OR IS_CHAR_DEAD fish_triad6

					IF NOT IS_CHAR_DEAD	fish_triad1
						SET_CHAR_THREAT_SEARCH fish_triad1 THREAT_PLAYER1
					ENDIF
					IF NOT IS_CHAR_DEAD	fish_triad2
						SET_CHAR_THREAT_SEARCH fish_triad2 THREAT_PLAYER1
					ENDIF
					IF NOT IS_CHAR_DEAD	fish_triad3
						SET_CHAR_THREAT_SEARCH fish_triad3 THREAT_PLAYER1
					ENDIF
					IF NOT IS_CHAR_DEAD	fish_triad4
						SET_CHAR_THREAT_SEARCH fish_triad4 THREAT_PLAYER1
					ENDIF
					IF NOT IS_CHAR_DEAD	fish_triad5
						SET_CHAR_THREAT_SEARCH fish_triad5 THREAT_PLAYER1
					ENDIF
					IF NOT IS_CHAR_DEAD	fish_triad6
						SET_CHAR_THREAT_SEARCH fish_triad6 THREAT_PLAYER1
					ENDIF

					triads_spot_you = 1
				ENDIF
			ENDIF
		ENDIF

		IF IS_PLAYER_IN_ZONE player CHINA
		AND audio_played_tm4 = 0
			PLAY_MISSION_AUDIO
			audio_played_tm4 = 1
   	 	ENDIF

		IF grunts1_been_created_before = 0
			IF NOT IS_CHAR_DEAD triad_head1
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player triad_head1 80.0 80.0 FALSE 

					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 907.4 -542.4 14.4 triad_grunt1
					SET_CHAR_HEADING triad_grunt1 180.0 
					GIVE_WEAPON_TO_CHAR triad_grunt1 WEAPONTYPE_UZI 80
					SET_CHAR_AS_LEADER triad_grunt1 triad_head1
					CLEAR_CHAR_THREAT_SEARCH triad_grunt1
					SET_CHAR_THREAT_SEARCH triad_grunt1 THREAT_PLAYER1

					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 907.4 -542.4 14.4 triad_grunt1B
					SET_CHAR_HEADING triad_grunt1B 160.0 
					GIVE_WEAPON_TO_CHAR triad_grunt1B WEAPONTYPE_UZI 80
					SET_CHAR_AS_LEADER triad_grunt1B triad_head1
					CLEAR_CHAR_THREAT_SEARCH triad_grunt1B
					SET_CHAR_THREAT_SEARCH triad_grunt1B THREAT_PLAYER1

					SET_CHAR_ONLY_DAMAGED_BY_PLAYER triad_head1 FALSE
					grunts1_been_created_before = 1
					
				ENDIF
			ENDIF
		ENDIF

		IF NOT IS_CHAR_DEAD	triad_head1
			IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player triad_head1 30.0 30.0 FALSE
			AND triad1_can_leg_it = 0
				SET_CHAR_STAY_IN_SAME_PLACE triad_head1 FALSE
				triad1_can_leg_it = 1
			ENDIF
		ENDIF

		IF grunts2_been_created_before = 0
			IF NOT IS_CHAR_DEAD triad_head2
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player triad_head2 80.0 80.0 FALSE
			
					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 965.6 -680.2 14.3 triad_grunt2 
					GIVE_WEAPON_TO_CHAR triad_grunt2 WEAPONTYPE_UZI 80
					SET_CHAR_AS_LEADER triad_grunt2 triad_head2
					CLEAR_CHAR_THREAT_SEARCH triad_grunt2
					SET_CHAR_THREAT_SEARCH triad_grunt2 THREAT_PLAYER1

					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 965.5 -683.0 14.3 triad_grunt2B 
					GIVE_WEAPON_TO_CHAR triad_grunt2B WEAPONTYPE_UZI 80
					SET_CHAR_AS_LEADER triad_grunt2B triad_head2
					CLEAR_CHAR_THREAT_SEARCH triad_grunt2B
					SET_CHAR_THREAT_SEARCH triad_grunt2B THREAT_PLAYER1

					SET_CHAR_ONLY_DAMAGED_BY_PLAYER triad_head2 FALSE
					grunts2_been_created_before	= 1

				ENDIF
			ENDIF
		ENDIF

		IF NOT IS_CHAR_DEAD	triad_head2
			IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player triad_head2 30.0 30.0 FALSE
			AND triad2_can_leg_it = 0
				SET_CHAR_STAY_IN_SAME_PLACE triad_head2 FALSE
				triad2_can_leg_it = 1
			ENDIF
		ENDIF

		IF grunts3_been_created_before = 0
			IF NOT IS_CHAR_DEAD triad_head3
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player triad_head3 80.0 80.0 FALSE
				
 					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 967.1 -1134.0 15.0 triad_grunt3 
					GIVE_WEAPON_TO_CHAR triad_grunt3 WEAPONTYPE_UZI 80
					SET_CHAR_AS_LEADER triad_grunt3 triad_head3
					SET_CHAR_THREAT_SEARCH triad_grunt3 THREAT_PLAYER1
					CLEAR_CHAR_THREAT_SEARCH triad_grunt3
					SET_CHAR_ONLY_DAMAGED_BY_PLAYER triad_head3 FALSE

					CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 966.1 -1129.0 15.0 triad_grunt3B 
					GIVE_WEAPON_TO_CHAR triad_grunt3B WEAPONTYPE_UZI 80
					SET_CHAR_AS_LEADER triad_grunt3B triad_head3
					SET_CHAR_THREAT_SEARCH triad_grunt3B THREAT_PLAYER1
					CLEAR_CHAR_THREAT_SEARCH triad_grunt3B
					SET_CHAR_ONLY_DAMAGED_BY_PLAYER triad_head3 FALSE
					grunts3_been_created_before = 1

				ENDIF
			ENDIF
		ENDIF
						
		IF grunts1_been_created_before = 1
		AND pay_back_for_traids1 = 0
			IF IS_CHAR_DEAD	triad_grunt1
			OR IS_CHAR_DEAD triad_grunt1B
			OR IS_CHAR_DEAD triad_head1

				IF NOT IS_CHAR_DEAD triad_grunt1
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triad_grunt1 Player		
				ENDIF
				IF NOT IS_CHAR_DEAD triad_grunt1B
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triad_grunt1B Player		
				ENDIF
				IF NOT IS_CHAR_DEAD triad_head1
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triad_head1 Player		
				ENDIF

				pay_back_for_traids1 = 1
			ENDIF
		ENDIF
		 
		IF grunts2_been_created_before = 1
		AND pay_back_for_traids2 = 0
			IF IS_CHAR_DEAD	triad_grunt2
			OR IS_CHAR_DEAD triad_grunt2B
			OR IS_CHAR_DEAD triad_head2

				IF NOT IS_CHAR_DEAD triad_grunt2
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triad_grunt2 Player		
				ENDIF
				IF NOT IS_CHAR_DEAD triad_grunt2B
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triad_grunt2B Player		
				ENDIF
				IF NOT IS_CHAR_DEAD triad_head2
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triad_head2 Player		
				ENDIF

				pay_back_for_traids2 = 1
			ENDIF
		ENDIF

		IF grunts3_been_created_before = 1
		AND pay_back_for_traids3 = 0
			IF IS_CHAR_DEAD	triad_grunt3
			OR IS_CHAR_DEAD triad_grunt3B
			OR IS_CHAR_DEAD triad_head3

				IF NOT IS_CHAR_DEAD triad_grunt3
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triad_grunt3 Player		
				ENDIF
				IF NOT IS_CHAR_DEAD triad_grunt3B
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triad_grunt3B Player		
				ENDIF
				IF NOT IS_CHAR_DEAD triad_head3
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT triad_head3 Player		
				ENDIF

				pay_back_for_traids3 = 1
			ENDIF
		ENDIF

		IF NOT IS_CHAR_DEAD	triad_head3
			IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player triad_head3 30.0 30.0 FALSE
			AND triad3_can_leg_it = 0
				SET_CHAR_STAY_IN_SAME_PLACE triad_head3 FALSE
				triad3_can_leg_it = 1
			ENDIF
		ENDIF

		IF NOT IS_CHAR_DEAD mafia_goon1
			IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player mafia_goon1 120.0 120.0 FALSE
		   		DELETE_CHAR mafia_goon1
		   	ELSE
		   		IF NOT IS_CHAR_IN_PLAYERS_GROUP mafia_goon1 Player
					SET_PLAYER_AS_LEADER mafia_goon1 player
				ENDIF
		   	ENDIF	
		ENDIF

		IF NOT IS_CHAR_DEAD mafia_goon2
			IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player mafia_goon2 120.0 120.0 FALSE
		   		DELETE_CHAR mafia_goon2
		   	ELSE
		   		IF NOT IS_CHAR_IN_PLAYERS_GROUP mafia_goon2 Player
					SET_PLAYER_AS_LEADER mafia_goon2 player
				ENDIF
		   	ENDIF	
		ENDIF
	
		IF IS_PLAYER_IN_AREA_3D player 1025.2 -1108.4 12.0 1009.2 -1098.4 16.0 FALSE
			IF NOT IS_PLAYER_IN_MODEL player CAR_BELLYUP
			AND NOT IS_PLAYER_IN_MODEL player CAR_TRASHMASTER
				IF IS_PLAYER_IN_AREA_3D player 1015.6 -1100.5 12.0 1009.2 -1108.1 16.0 FALSE
				AND been_in_fish_factory = 0
					been_in_fish_factory = 1
				ENDIF

				IF been_in_fish_factory = 0	
					PRINT_NOW ( TM4_GAT ) 5000 1 // Need Belly-up
				ENDIF	
			ENDIF 
		ENDIF

ENDWHILE

}

GOTO mission_toni4_passed
 

 // Mission toni4 failed

mission_toni4_failed:

    SETUP_ZONE_PED_INFO CHINA DAY   (20) 0 300 0 (0 0 0 0) 20 //China town 
    SETUP_ZONE_PED_INFO CHINA NIGHT (10) 0 400 0 (0 0 0 0) 10 

RETURN

   

// mission toni4 passed

mission_toni4_passed:

// the achievement states three guys?
IF NOT IS_CHAR_DEAD mafia_goon1
AND NOT IS_CHAR_DEAD mafia_goon2
	USE_TEXT_COMMANDS 97 // HACKED achievement unlock // MOB_BOSS
ENDIF

flag_toni_mission4_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 30000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 30000
REGISTER_MISSION_PASSED TM4
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT toni_mission5_loop
 	SETUP_ZONE_PED_INFO CHINA DAY   (20) 0 200 0 (0 0 0 0) 20 //China town 
    SETUP_ZONE_PED_INFO CHINA NIGHT (10) 0 300 0 (0 0 0 0) 10
RETURN
		


// mission cleanup

mission_cleanup_toni4:

flag_player_on_mission = 0
flag_player_on_toni_mission = 0
REMOVE_BLIP blip1_tm4
REMOVE_BLIP blip2_tm4
REMOVE_BLIP blip3_tm4
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_B
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_B
//UNLOAD_SPECIAL_CHARACTER 1
SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1 //TEST
SETUP_ZONE_PED_INFO LITTLEI DAY	  (17) 300 0 0 (0 0 0 0) 20	//St Marks
SETUP_ZONE_PED_INFO	LITTLEI	NIGHT (11) 400 0 0 (0 0 0 0) 10
MISSION_HAS_FINISHED
RETURN


MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Toni mission 5****************************************
// **********************************Destroy Fish Factory*************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff

GOSUB mission_start_toni5

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_toni5_failed
ENDIF

GOSUB mission_cleanup_toni5

MISSION_END

// Variables for mission

VAR_INT blip1_tm5 blip2_tm5 
 
VAR_INT explosive_truck countdown_tm5 

VAR_INT fish_factory_destroyed triads_spot_you

VAR_INT flag_car_blip_displayed_tm5	explosive_truck_health explosive_truck_health2

VAR_INT fish_fire2 fish_fire3 fish_fire4 fish_fire5 fish_fire6 fish_fire7

VAR_INT debris1_tm5 debris2_tm5 debris3_tm5 debris4_tm5 debris5_tm5 debris6_tm5 debris7_tm5 debris8_tm5 debris9_tm5 debris10_tm5

VAR_FLOAT truck_x truck_y truck_z  

// ***************************************Mission Start*************************************

mission_start_toni5:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_toni_mission = 1
SCRIPT_NAME toni5
WAIT 0

{

LOAD_SPECIAL_CHARACTER 1 tony
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 TONYH
REQUEST_MODEL ind_newrizzos

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1  
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED ind_newrizzos
	WAIT 0

ENDWHILE


LOAD_CUTSCENE t5_bf
SET_CUTSCENE_OFFSET 1218.42 -314.5 28.9

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_tony
SET_CUTSCENE_ANIM cs_tony tony

CREATE_CUTSCENE_HEAD cs_tony CUT_OBJ2 cs_tonyhead
SET_CUTSCENE_HEAD_ANIM cs_tonyhead tony

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CLEAR_AREA 1219.5 -321.1 27.5 1.0 TRUE
SET_PLAYER_COORDINATES player 1219.5 -321.1 26.4

SET_PLAYER_HEADING player 180.0

CLEAR_AREA 1216.1 -313.0 29.9 10.0 TRUE	//TONIS RESTAURANT

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 1350
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM5_B ) 10000 1 // Mission brief

WHILE cs_time < 3169
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM5_C ) 10000 1 // Mission brief

WHILE cs_time < 5730
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM5_D ) 10000 1 // Mission brief

WHILE cs_time < 7755
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM5_E ) 10000 1 // Mission brief

WHILE cs_time < 12490
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM5_F ) 10000 1 // Mission brief

WHILE cs_time < 17220
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM5_G ) 10000 1 // Mission brief

WHILE cs_time < 21330
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM5_H ) 10000 1 // Mission brief

WHILE cs_time < 24141
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM5_I ) 10000 1 // Mission brief

WHILE cs_time < 25817
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( TM5_J ) 10000 1 // Mission brief

WHILE cs_time < 28632
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 30000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED ind_newrizzos

REQUEST_MODEL CAR_TRASHMASTER

WHILE NOT HAS_MODEL_LOADED CAR_TRASHMASTER
	WAIT 0
ENDWHILE


triads_spot_you = 0
clear_triads_threats = 0

// START MISSION

CREATE_CAR CAR_TRASHMASTER 1314.0 -106.0 -100.0 explosive_truck
SET_CAR_PROOFS explosive_truck TRUE TRUE FALSE FALSE TRUE
ARM_CAR_WITH_BOMB explosive_truck CARBOMB_TIMED

fish_factory_destroyed = 0

ADD_BLIP_FOR_CAR explosive_truck blip1_tm5

	WHILE NOT IS_PLAYER_IN_CAR player explosive_truck
		WAIT 0

		IF IS_CAR_DEAD explosive_truck
			GOTO mission_toni5_failed
		ENDIF		
	
		GOSUB triad_AI

		IF NOT IS_CAR_HEALTH_GREATER explosive_truck 860
		AND NOT IS_CAR_IN_AREA_3D explosive_truck 961.0 -1112.5 12.5 969.5 -1122.8 15.0 FALSE
		    EXPLODE_CAR explosive_truck
			GOTO mission_toni5_failed
		ENDIF

	ENDWHILE 


countdown_tm5 = 151000
DISPLAY_ONSCREEN_TIMER countdown_tm5

GET_CAR_HEALTH explosive_truck explosive_truck_health
DISPLAY_ONSCREEN_COUNTER_WITH_STRING explosive_truck_health COUNTER_DISPLAY_BAR (DAM)
explosive_truck_health2 = 1000 - explosive_truck_health
	IF explosive_truck_health2 > 100
		explosive_truck_health2 = 100
	ENDIF
explosive_truck_health = explosive_truck_health2

flag_car_blip_displayed_tm5 = TRUE
blob_flag = 1

toni5_wait_for_van:
WAIT 0

		IF IS_CAR_DEAD explosive_truck
			GOTO mission_toni5_failed
		ENDIF

	WHILE NOT IS_CAR_STOPPED_IN_AREA_3D explosive_truck 961.0 -1112.5 12.5 969.5 -1122.8 15.0 blob_flag
		WAIT 0

			IF IS_CAR_DEAD explosive_truck
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE truck_x truck_y truck_z 0.0 0.0 0.0 4.0 0 0 0 4000
				GOTO mission_toni5_failed
			ENDIF

			GOSUB triad_AI

			GOSUB Truck_health

			GET_CAR_COORDINATES explosive_truck truck_x truck_y truck_z

			IF IS_PLAYER_IN_CAR player explosive_truck
				IF flag_car_blip_displayed_tm5 = TRUE
					ADD_BLIP_FOR_COORD 965.0 -1117.0 -100.0 blip2_tm5
					blob_flag = 1
					REMOVE_BLIP blip1_tm5
				flag_car_blip_displayed_tm5 = FALSE
				ENDIF
			ENDIF

			IF NOT IS_PLAYER_IN_CAR player explosive_truck
				IF flag_car_blip_displayed_tm5 = FALSE
				ADD_BLIP_FOR_CAR explosive_truck blip1_tm5
				blob_flag = 0
				REMOVE_BLIP blip2_tm5
				PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the car!"
				flag_car_blip_displayed_tm5 = TRUE
				ENDIF
			ENDIF

			IF NOT IS_CAR_HEALTH_GREATER explosive_truck 900
			AND NOT IS_CAR_IN_AREA_3D explosive_truck 961.0 -1112.5 12.5 969.5 -1122.8 15.0 FALSE
			    EXPLODE_CAR explosive_truck
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE truck_x truck_y truck_z 0.0 0.0 0.0 4.0 0 0 0 4000
				GOTO mission_toni5_failed
			ENDIF

			IF countdown_tm5 = 0
			AND NOT IS_CAR_IN_AREA_3D explosive_truck 961.0 -1112.5 12.5 969.5 -1122.8 15.0 FALSE
				EXPLODE_CAR explosive_truck
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE truck_x truck_y truck_z 0.0 0.0 0.0 4.0 0 0 0 4000
				GOTO mission_toni5_failed
			ENDIF

	ENDWHILE

REQUEST_MODEL fshfctry_dstryd
PRINT_NOW ( JM1_3 ) 5000 2 //Activate the car bomb then get out of there!
FORCE_WEATHER WEATHER_SUNNY

		IF IS_CAR_DEAD explosive_truck
			PRINT_NOW ( WRECKED ) 5000 1
			GOTO mission_toni5_failed
		ENDIF

	WHILE NOT IS_EXPLOSION_IN_AREA EXPLOSION_CAR 961.0 -1112.5 12.5 969.5 -1122.8 15.0
		WAIT 0

			IF IS_CAR_DEAD explosive_truck
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE truck_x truck_y truck_z 0.0 0.0 0.0 4.0 0 0 0 4000
				GOTO explosion
			ENDIF

			GOSUB triad_AI

			GOSUB Truck_health

			GET_CAR_COORDINATES explosive_truck truck_x truck_y truck_z
			
			IF NOT IS_CAR_IN_AREA_3D explosive_truck 961.0 -1112.5 12.5 969.5 -1122.8 15.0 FALSE
				GOTO toni5_wait_for_van
			ENDIF

			IF NOT IS_PLAYER_IN_CAR player explosive_truck
		   	AND NOT IS_CAR_ARMED_WITH_BOMB explosive_truck CARBOMB_TIMEDACTIVE
		 		PRINT_NOW ( JM1_5 ) 5000 1 // The vehicle bomb's not set!
			ENDIF

			IF NOT IS_CAR_HEALTH_GREATER explosive_truck 900
			    EXPLODE_CAR explosive_truck
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE truck_x truck_y truck_z 0.0 0.0 0.0 4.0 0 0 0 4000
				GOTO explosion
			ENDIF

			IF countdown_tm5 = 0
				EXPLODE_CAR explosive_truck
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE truck_x truck_y truck_z 0.0 0.0 0.0 4.0 0 0 0 4000
				GOTO explosion
			ENDIF

	ENDWHILE

explosion:
	
	
	CLEAR_ONSCREEN_TIMER countdown_tm5

	SET_PLAYER_CONTROL Player Off
	SWITCH_WIDESCREEN ON
	SET_POLICE_IGNORE_PLAYER Player On
	SET_EVERYONE_IGNORE_PLAYER Player ON

	SET_FIXED_CAMERA_POSITION 940.279 -1136.787 16.550 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT 941.065 -1136.169 16.522 JUMP_CUT
	
	REMOVE_BLIP blip1_tm5
	REMOVE_BLIP blip2_tm5
	WAIT 300

	SHAKE_CAM 300
    //ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE 965.8 -1111.9 15.5 0.0 0.0 0.0 4.0 0 0 0 4000
	ADD_EXPLOSION 965.8 -1111.9 15.5 EXPLOSION_HELI
	//ADD_ONE_OFF_SOUND 965.8 -1111.9 15.5 sound_test_1
	START_SCRIPT_FIRE 966.0 -1111.8 13.8 fish_Fire3

	//ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE 966.0 -1123.0 15.4 0.0 0.0 0.0 4.0 0 0 0 4000
	ADD_EXPLOSION 966.0 -1123.0 15.4 EXPLOSION_HELI
	//ADD_ONE_OFF_SOUND 966.0 -1123.0 15.4 sound_test_1
	WAIT 600

		SHAKE_CAM 400
		ADD_EXPLOSION 970.0 -1119.0 16.0 EXPLOSION_HELI
		WAIT 300

	SHAKE_CAM 300
	ADD_EXPLOSION 985.0 -1119.0 14.0 EXPLOSION_HELI
	WAIT 400

		SHAKE_CAM 400
		ADD_EXPLOSION 985.0 -1120.0 20.0 EXPLOSION_HELI
		WAIT 200
	
	SHAKE_CAM 300
	SET_FIXED_CAMERA_POSITION 960.5 -1094.0 21.1 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT 961.2 -1094.7 20.8 JUMP_CUT

	ADD_EXPLOSION 969.2 -1104.0 18.3 EXPLOSION_HELI
	WAIT 300

		SHAKE_CAM 400
		ADD_EXPLOSION 968.4 -1119.2 17.4 EXPLOSION_HELI
		WAIT 200
	
	SHAKE_CAM 300
	ADD_EXPLOSION 979.4 -1103.9 18.9 EXPLOSION_HELI
	WAIT 300

		SHAKE_CAM 400
		ADD_EXPLOSION 976.0 -1108.3 21.4 EXPLOSION_HELI
		WAIT 300
	
	SHAKE_CAM 300
	ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE 969.8 -1104.9 18.7 0.0 0.0 0.0 5.0 0 0 0 5000
	//ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE 986.3 -1103.4 14.7 0.0 0.0 0.0 4.0 0 0 0 4000
	ADD_EXPLOSION 972.7 -1102.2 18.5 EXPLOSION_HELI
	ADD_EXPLOSION 986.3 -1103.4 14.7 EXPLOSION_HELI
	CREATE_OBJECT fish01 972.7 -1103.6 20.6 debris1_tm5
	CREATE_OBJECT fish01 972.7 -1103.2 20.6 debris2_tm5
	CREATE_OBJECT fish01 978.8 -1107.2 21.6 debris3_tm5
	CREATE_OBJECT fish01 979.8 -1105.2 21.6 debris4_tm5
	SET_OBJECT_DYNAMIC debris1_tm5 TRUE
	SET_OBJECT_DYNAMIC debris2_tm5 TRUE
	SET_OBJECT_DYNAMIC debris3_tm5 TRUE
	SET_OBJECT_DYNAMIC debris4_tm5 TRUE
	SET_OBJECT_VELOCITY debris1_tm5 -10.0 6.0 18.0
	SET_OBJECT_VELOCITY debris2_tm5 8.0 7.0 16.0
	SET_OBJECT_VELOCITY debris3_tm5 -7.0 10.0 14.0
	SET_OBJECT_VELOCITY debris4_tm5 9.0 6.0 15.0
	ADD_ONE_OFF_SOUND 969.8 -1104.9 18.7 sound_test_1
	//ADD_ONE_OFF_SOUND 971.7 -1101.2 17.5 sound_test_1

	WAIT 400
	SHAKE_CAM 500
	
	ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE 974.2 -1129.8 19.5 0.0 0.0 0.0 5.0 0 0 0 5000
	//ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE 973.6 -1128.8 19.6 0.0 0.0 0.0 4.0 0 0 0 4000
	ADD_EXPLOSION 982.0 -1102.8 17.4 EXPLOSION_HELI
	ADD_EXPLOSION 973.6 -1128.8 19.6 EXPLOSION_HELI
		CREATE_OBJECT fish01 982.0 -1103.8 20.4 debris5_tm5
		CREATE_OBJECT fish01 982.0 -1103.0 20.4 debris6_tm5
		CREATE_OBJECT fish01 983.0 -1112.0 20.4 debris7_tm5
		CREATE_OBJECT fish01 985.0 -1108.0 19.4 debris8_tm5
		CREATE_OBJECT fish01 977.0 -1113.0 21.4 debris9_tm5
		CREATE_OBJECT fish01 976.0 -1115.0 21.4 debris10_tm5
		SET_OBJECT_DYNAMIC debris5_tm5 TRUE
		SET_OBJECT_DYNAMIC debris6_tm5 TRUE
		SET_OBJECT_DYNAMIC debris7_tm5 TRUE
		SET_OBJECT_DYNAMIC debris8_tm5 TRUE
		SET_OBJECT_DYNAMIC debris9_tm5 TRUE
		SET_OBJECT_DYNAMIC debris10_tm5 TRUE
		SET_OBJECT_VELOCITY debris5_tm5 -3.0 6.0 18.0
		SET_OBJECT_VELOCITY debris6_tm5 5.0 7.0 16.0
		SET_OBJECT_VELOCITY debris7_tm5 -6.0 7.0 17.0
		SET_OBJECT_VELOCITY debris8_tm5 8.0 9.0 16.0
		SET_OBJECT_VELOCITY debris9_tm5 -7.0 8.0 14.0
		SET_OBJECT_VELOCITY debris10_tm5 -1.0 10.0 14.0
	ADD_ONE_OFF_SOUND 974.2 -1129.8 19.5 sound_test_1
	//ADD_ONE_OFF_SOUND 983.0 -1103.8 18.4 sound_test_1

	SET_FADING_COLOUR 255 255 255
	
	DO_FADE 400 FADE_OUT
	IF NOT IS_PLAYER_DEAD player
		SWAP_NEAREST_BUILDING_MODEL 981.5 -1123.9 16.7 80.0 fishfctory fshfctry_dstryd
	ENDIF
	DO_FADE 400 FADE_IN

	START_SCRIPT_FIRE 979.3 -1106.1 14.7 fish_Fire2
	START_SCRIPT_FIRE 981.0 -1132.0 14.0 fish_fire4
	START_SCRIPT_FIRE 970.6 -1107.5 18.5 fish_fire6
	START_SCRIPT_FIRE 965.8 -1123.4 14.0 fish_fire7

	fish_factory_destroyed = 1

	WAIT 3000

	RELEASE_WEATHER
	SWITCH_WIDESCREEN OFF
	SET_PLAYER_CONTROL Player ON
	SET_POLICE_IGNORE_PLAYER Player OFF
	SET_EVERYONE_IGNORE_PLAYER Player OFF
	RESTORE_CAMERA_JUMPCUT

}

GOTO mission_toni5_passed
 

 // Mission toni5 failed

mission_toni5_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission toni5 passed

mission_toni5_passed:

flag_toni_mission5_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 30000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 30000
REMOVE_BLIP frankie_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1455.7 -187.3 -100.0 RADAR_SPRITE_SAL frankie_contact_blip
SETUP_ZONE_PED_INFO FISHFAC DAY   ( 0) 0 0 0 (0 0 0 0) 0 //Fish factory  
SETUP_ZONE_PED_INFO FISHFAC NIGHT ( 0) 0 0 0 (0 0 0 0) 0
SWITCH_CAR_GENERATOR gen_car47 0
SWITCH_CAR_GENERATOR gen_car48 0
SWITCH_CAR_GENERATOR gen_car49 0
flag_frankie_switched_off = 0
REGISTER_MISSION_PASSED TM5
PLAYER_MADE_PROGRESS 1
REMOVE_BLIP toni_contact_blip
START_NEW_SCRIPT toni5_flames_loop
RETURN
		


// mission cleanup

mission_cleanup_toni5:

flag_player_on_mission = 0
flag_player_on_toni_mission = 0
REMOVE_BLIP blip1_tm5
REMOVE_BLIP blip2_tm5
CLEAR_ONSCREEN_TIMER countdown_tm5
CLEAR_ONSCREEN_COUNTER explosive_truck_health
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_TRASHMASTER
MARK_MODEL_AS_NO_LONGER_NEEDED fshfctry_dstryd
SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1 //TEST
SET_FADING_COLOUR 1 1 1
MISSION_HAS_FINISHED
RETURN



{
triad_AI:

	IF IS_PLAYER_IN_ZONE Player PORT_W
	AND has_player_been_at_fish_before = 1
	AND clear_triads_threats = 0

		IF NOT IS_CHAR_DEAD	fish_triad1
			CLEAR_CHAR_THREAT_SEARCH fish_triad1
		ENDIF
		IF NOT IS_CHAR_DEAD	fish_triad2
			CLEAR_CHAR_THREAT_SEARCH fish_triad2
		ENDIF
		IF NOT IS_CHAR_DEAD	fish_triad3
			CLEAR_CHAR_THREAT_SEARCH fish_triad3
		ENDIF
		IF NOT IS_CHAR_DEAD	fish_triad4
			CLEAR_CHAR_THREAT_SEARCH fish_triad4
		ENDIF
		IF NOT IS_CHAR_DEAD	fish_triad5
			CLEAR_CHAR_THREAT_SEARCH fish_triad5
		ENDIF
		IF NOT IS_CHAR_DEAD	fish_triad6
			CLEAR_CHAR_THREAT_SEARCH fish_triad6
		ENDIF

		CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1

		clear_triads_threats = 1
	ENDIF

	IF IS_PLAYER_IN_ZONE player FISHFAC	
		IF triads_spot_you = 0
			IF NOT IS_PLAYER_IN_ANY_CAR Player
			
				IF NOT IS_CHAR_DEAD	fish_triad1
					SET_CHAR_THREAT_SEARCH fish_triad1 THREAT_PLAYER1
				ENDIF
				IF NOT IS_CHAR_DEAD	fish_triad2
					SET_CHAR_THREAT_SEARCH fish_triad2 THREAT_PLAYER1
				ENDIF
				IF NOT IS_CHAR_DEAD	fish_triad3
					SET_CHAR_THREAT_SEARCH fish_triad3 THREAT_PLAYER1
				ENDIF
				IF NOT IS_CHAR_DEAD	fish_triad4
					SET_CHAR_THREAT_SEARCH fish_triad4 THREAT_PLAYER1
				ENDIF
				IF NOT IS_CHAR_DEAD	fish_triad5
					SET_CHAR_THREAT_SEARCH fish_triad5 THREAT_PLAYER1
				ENDIF
				IF NOT IS_CHAR_DEAD	fish_triad6
					SET_CHAR_THREAT_SEARCH fish_triad6 THREAT_PLAYER1
				ENDIF

				SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1 //TEST

				triads_spot_you = 1
			ENDIF
			
			IF IS_CHAR_DEAD	fish_triad1
			OR IS_CHAR_DEAD fish_triad2
			OR IS_CHAR_DEAD fish_triad3
			OR IS_CHAR_DEAD fish_triad4
			OR IS_CHAR_DEAD fish_triad5
			OR IS_CHAR_DEAD fish_triad6

				IF NOT IS_CHAR_DEAD	fish_triad1
					SET_CHAR_THREAT_SEARCH fish_triad1 THREAT_PLAYER1
				ENDIF
				IF NOT IS_CHAR_DEAD	fish_triad2
					SET_CHAR_THREAT_SEARCH fish_triad2 THREAT_PLAYER1
				ENDIF
				IF NOT IS_CHAR_DEAD	fish_triad3
					SET_CHAR_THREAT_SEARCH fish_triad3 THREAT_PLAYER1
				ENDIF
				IF NOT IS_CHAR_DEAD	fish_triad4
					SET_CHAR_THREAT_SEARCH fish_triad4 THREAT_PLAYER1
				ENDIF
				IF NOT IS_CHAR_DEAD	fish_triad5
					SET_CHAR_THREAT_SEARCH fish_triad5 THREAT_PLAYER1
				ENDIF
				IF NOT IS_CHAR_DEAD	fish_triad6
					SET_CHAR_THREAT_SEARCH fish_triad6 THREAT_PLAYER1
				ENDIF

				SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1 //TEST

				triads_spot_you = 1
			ENDIF
		ENDIF
	ENDIF


 RETURN
 }



Truck_health:
{

	IF NOT IS_CAR_DEAD explosive_truck 

		GET_CAR_HEALTH explosive_truck explosive_truck_health 
		explosive_truck_health2 = 1000 - explosive_truck_health
		IF explosive_truck_health2 > 100
			explosive_truck_health2 = 100
		ENDIF
		explosive_truck_health = explosive_truck_health2 

	ENDIF

RETURN
}
MISSION_START
// *****************************************************************************************
// ********************************* Frankie Mission 1 *************************************
// *********************************   Pulp Friction   *************************************
// *****************************************************************************************
// *** Frankie wants to discuss war with his lieutenants. He needs Maria out of the house***
// *** for the evening so Claude has to chaperone her. Drive Maria to a dealer to get her***
// *** party gear. Then on to an illegal warehouse party and wait for her outside. While ***
// *** waiting for Maria the police will decide to 'raid the joint'. The player must get ***
// *** Maria out and back to Frankie's safely.											 ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_frankie1

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_frankie1_failed
ENDIF

GOSUB mission_cleanup_frankie1

MISSION_END
 
// Variables for mission

VAR_INT frankies_limo chico	chico_message_flag fm1_blip	flag_blip_on_limo doorman1 doorman2	parked_car1	parked_car2	parked_car3	timera_reset timerb_reset
VAR_INT swatvan_fm1	swatvan2_fm1 cop1_fm1 cop2_fm1 cop3_fm1	cop4_fm1 cop5_fm1 cop6_fm1 cop7_fm1	cop8_fm1 clubbers_flee_flag 
VAR_INT R G R1 G1 R2 G2 R3 G3 R4 G4 R5 G5 shadow_counter add_sound_flag camera_mode chico_audio_flag
VAR_INT clubber1_fm1 clubber2_fm1 clubber3_fm1 clubber4_fm1	clubber5_fm1 clubber6_fm1 clubber7_fm1 clubber8_fm1 maria_blip warehouse_rave_loop
VAR_INT clubber3_car1 clubber5_car2 clubber8_car3 flag_blip_on_maria create_more_swat1 create_more_swat2 swat1_exit_car swat2_exit_car
VAR_INT	timerc_reset_flag_f1a timerc_current_f1a timerc_started_f1a	timerc_f1a fuckup_flag fuckup_timer_start fuckup_timer_current fuckup_timer
VAR_INT	timerc_reset_flag_f1b timerc_current_f1b timerc_started_f1b	timerc_f1b locate_dome_flag	swat_cam_needs_restoring skip_cutscene_flag

VAR_FLOAT swat1_stuck_x swat1_stuck_y swat1_stuck_z
VAR_FLOAT swat2_stuck_x swat2_stuck_y swat2_stuck_z
VAR_FLOAT chico_x chico_y chico_z inside_warehouse_x inside_warehouse_y inside_warehouse_z outside_warehouse_x outside_warehouse_y

// ****************************************Mission Start************************************

mission_start_frankie1:

flag_player_on_mission = 1
flag_player_on_frankie_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

SCRIPT_NAME frank1

chico_message_flag 	= 0
flag_blip_on_limo  	= 0
timera_reset  		= 0
timerb_reset  		= 0
clubbers_flee_flag 	= 0
clubber3_car1  		= 0
clubber5_car2  		= 0
clubber8_car3  		= 0
flag_blip_on_maria  = 0
create_more_swat1  	= 0
create_more_swat2  	= 0
swat1_exit_car  	= 0
swat2_exit_car 		= 0
maria_blip			= 0
add_sound_flag		= 0
locate_dome_flag	= 0
chico_audio_flag	= 0
swat_cam_needs_restoring = 0
skip_cutscene_flag  = 0

timerc_reset_flag_f1a = 0
timerc_current_f1a = 0
timerc_started_f1a = 0
timerc_f1a = 0
timerc_reset_flag_f1b = 0
timerc_current_f1b = 0
timerc_started_f1b = 0	
timerc_f1b = 0
fuckup_flag = 0
fuckup_timer_start = 0
fuckup_timer_current = 0
fuckup_timer = 0

shadow_counter = 0

inside_warehouse_x = 1273.0
inside_warehouse_y = -1107.4
inside_warehouse_z = 11.5

outside_warehouse_x = 1261.0
outside_warehouse_y	= -1108.0

swat1_stuck_x = 0.0
swat1_stuck_y = 0.0
swat1_stuck_z = 0.0

swat2_stuck_x = 0.0
swat2_stuck_y = 0.0
swat2_stuck_z = 0.0

R = 0
G = 0
R1 = 0
G1 = 0
R2 = 0
G2 = 0
R3 = 0
G3 = 0
R4 = 0
G4 = 0
R5 = 0
G5 = 0

{
LOAD_SPECIAL_CHARACTER 1 frankie
LOAD_SPECIAL_CHARACTER 2 maria
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 FRANKH
LOAD_SPECIAL_MODEL cut_obj3 MARIAH
REQUEST_MODEL PED_GANG_MAFIA_B
REQUEST_MODEL salvsdetail
REQUEST_MODEL swank_inside
REQUEST_MODEL franksclb02

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED PED_GANG_MAFIA_B
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED salvsdetail
OR NOT HAS_MODEL_LOADED	swank_inside
OR NOT HAS_MODEL_LOADED	franksclb02
	WAIT 0
ENDWHILE

IF maria_exists = 1
	GOSUB delete_char_maria 
ENDIF
maria_exists = 0

CHANGE_GARAGE_TYPE frankie_garage GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE
CLOSE_GARAGE frankie_garage

SWITCH_RUBBISH OFF
CLEAR_AREA 1444.99 -186.9 56.0 35.0 TRUE

LOAD_CUTSCENE S1_PF

SET_CUTSCENE_OFFSET 1457.776 -185.348 54.925

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_frankie

SET_CUTSCENE_ANIM cs_frankie frankie

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_maria

SET_CUTSCENE_ANIM cs_maria maria

CREATE_CUTSCENE_OBJECT PED_GANG_MAFIA_B cs_mafia

SET_CUTSCENE_ANIM cs_mafia gang02

CREATE_CUTSCENE_HEAD cs_player cut_obj1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_frankie cut_obj2 cs_frankiehead
SET_CUTSCENE_HEAD_ANIM cs_frankiehead frank

CREATE_CUTSCENE_HEAD cs_maria cut_obj3 cs_mariahead
SET_CUTSCENE_HEAD_ANIM cs_mariahead maria

SET_PLAYER_COORDINATES player 1418.0 -186.0 -100.0

SET_PLAYER_HEADING player 270.0

DO_FADE 1500 FADE_IN

//SWITCH_STREAMING ON
START_CUTSCENE

GET_CUTSCENE_TIME cs_time
WHILE cs_time < 219 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_A 15000 1
WHILE cs_time < 1849
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_B 15000 1
WHILE cs_time < 4493
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_C 15000 1
WHILE cs_time < 7519
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_D	15000 1
WHILE cs_time < 10505
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_E	15000 1
WHILE cs_time < 14239
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_F	15000 1
WHILE cs_time < 15964
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_G	15000 1
WHILE cs_time < 18485
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_H	15000 1
WHILE cs_time < 21608
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_I	15000 1
WHILE cs_time < 24863
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_J	15000 1
WHILE cs_time < 28287
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_K	15000 1
WHILE cs_time < 31451
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_L	15000 1
WHILE cs_time < 34679
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_M	15000 1
WHILE cs_time < 36802
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_N	15000 1
WHILE cs_time < 39747
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW FM1_O	3000 1
WHILE cs_time < 43500
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SET_PLAYER_COORDINATES player 1418.0 -186.0 -100.0

CLEAR_CUTSCENE

DO_FADE 0 FADE_OUT

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_B
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj3
MARK_MODEL_AS_NO_LONGER_NEEDED salvsdetail
MARK_MODEL_AS_NO_LONGER_NEEDED swank_inside
MARK_MODEL_AS_NO_LONGER_NEEDED franksclb02

REQUEST_MODEL CAR_STRETCH
REQUEST_MODEL PED_CRIMINAL1

CLEAR_AREA 1444.99 -186.9 56.0 35.0 TRUE

SWITCH_RUBBISH ON

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED CAR_STRETCH
OR NOT HAS_MODEL_LOADED	PED_CRIMINAL1
	WAIT 0
ENDWHILE

CREATE_CAR CAR_STRETCH 1436.0 -183.0 50.0 frankies_limo
SET_RADIO_CHANNEL 3 -1
SET_CAR_HEADING frankies_limo 90.0
CHANGE_CAR_COLOUR frankies_limo 0 0 // FRANKIES LIMO NEEDS A UNIQUE COLOUR
SET_CAR_STRONG frankies_limo TRUE
SET_CAN_RESPRAY_CAR frankies_limo FALSE

SET_PLAYER_CONTROL player OFF
SWITCH_WIDESCREEN ON

maria_exists = 1
CREATE_CHAR_AS_PASSENGER frankies_limo PEDTYPE_SPECIAL PED_SPECIAL2 1 maria
CLEAR_CHAR_THREAT_SEARCH maria
ADD_ARMOUR_TO_CHAR maria 100
SET_CHAR_CANT_BE_DRAGGED_OUT maria TRUE
SET_ANIM_GROUP_FOR_CHAR	maria ANIM_SEXY_WOMANPED

IF NOT IS_CHAR_IN_CAR maria	frankies_limo
	SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER	maria frankies_limo
ENDIF

CREATE_CHAR PEDTYPE_CIVMALE PED_CRIMINAL1 770.2257 -565.9869 13.8 chico 
SET_CHAR_HEADING chico 265.2053
CLEAR_CHAR_THREAT_SEARCH chico
CHAR_SET_IDLE chico
SET_CHAR_STAY_IN_SAME_PLACE chico TRUE

SWITCH_PED_ROADS_OFF 759.0 -616.0 11.0 782.0 -536.0 26.0

GENERATE_RANDOM_INT_IN_RANGE 0 4 camera_mode

IF camera_mode < 1
	SET_FIXED_CAMERA_POSITION 1405.736 -190.179 62.455 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT 1427.2837 -183.5375 49.4573 JUMP_CUT
ENDIF

IF camera_mode = 1
	SET_FIXED_CAMERA_POSITION 1425.685 -178.463 50.184 0.0 0.0 0.0
	POINT_CAMERA_AT_CAR frankies_limo FIXED JUMP_CUT
ENDIF

IF camera_mode = 2
	SET_FIXED_CAMERA_POSITION 1432.161 -179.705 50.643 0.0 0.0 0.0
	POINT_CAMERA_AT_CAR frankies_limo FIXED JUMP_CUT
ENDIF

IF camera_mode > 2
	SET_FIXED_CAMERA_POSITION 1421.134 -193.771 63.916 0.0 0.0 0.0
	POINT_CAMERA_AT_CAR frankies_limo FIXED JUMP_CUT
ENDIF

WARP_PLAYER_INTO_CAR player frankies_limo

DO_FADE 0 FADE_OUT

GET_CHAR_COORDINATES chico chico_x chico_y chico_z

ADD_BLIP_FOR_COORD 775.5 -557.3 14.0 fm1_blip

REQUEST_MODEL PED_GANG_MAFIA_A
REQUEST_MODEL CAR_SENTINEL
REQUEST_MODEL CAR_CHEETAH
REQUEST_MODEL CAR_MANANA

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED PED_GANG_MAFIA_A
OR NOT HAS_MODEL_LOADED CAR_SENTINEL
OR NOT HAS_MODEL_LOADED CAR_CHEETAH
OR NOT HAS_MODEL_LOADED CAR_MANANA
	WAIT 0
ENDWHILE

SWITCH_STREAMING ON

IF IS_CHAR_DEAD maria
	PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
	GOTO mission_frankie1_failed
ENDIF

IF IS_CAR_DEAD frankies_limo
	GOTO mission_frankie1_failed
ENDIF

IF NOT IS_CHAR_IN_CAR maria	frankies_limo
	SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER	maria frankies_limo
ENDIF

DO_FADE 1500 FADE_IN

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

IF IS_CHAR_DEAD maria
	PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
	GOTO mission_frankie1_failed
ENDIF

IF IS_CAR_DEAD frankies_limo
	GOTO mission_frankie1_failed
ENDIF

IF NOT IS_CHAR_IN_CAR maria	frankies_limo
	SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER	maria frankies_limo
ENDIF

CHANGE_GARAGE_TYPE frankie_garage GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE
OPEN_GARAGE frankie_garage
CAR_GOTO_COORDINATES_ACCURATE frankies_limo 1416.1118 -189.4448 49.5264

WHILE NOT LOCATE_CAR_2D frankies_limo 1420.5 -189.1 3.0 3.0 0
	
	WAIT 0
	
	IF IS_CAR_DEAD frankies_limo
		GOTO mission_frankie1_failed
	ENDIF

ENDWHILE

CLOSE_GARAGE frankie_garage
APPLY_BRAKES_TO_PLAYERS_CAR player ON

IF IS_CHAR_DEAD maria
	PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
	GOTO mission_frankie1_failed
ENDIF

SET_CAMERA_IN_FRONT_OF_PLAYER
RESTORE_CAMERA_JUMPCUT
SET_PLAYER_CONTROL player ON
SET_CAR_STATUS frankies_limo STATUS_PLAYER
SWITCH_WIDESCREEN OFF

locate_dome_flag = 1

REQUEST_MODEL CAR_ENFORCER
REQUEST_MODEL PED_SWAT
REQUEST_MODEL PED_P_MAN1
REQUEST_MODEL PED_FEMALE1
REQUEST_MODEL PED_FEMALE2

//WHILE NOT LOCATE_STOPPED_CHAR_IN_CAR_2D maria chico_x chico_y 10.0 10.0 0
WHILE NOT LOCATE_STOPPED_CHAR_IN_CAR_3D maria 775.5 -557.3 14.0 3.0 3.0 2.0 locate_dome_flag

	WAIT 0

	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CHAR_DEAD chico
		PRINT_NOW FM1_8 5000 1 // "You killed Chico!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player frankies_limo
	AND flag_blip_on_limo = 0
		locate_dome_flag = 0
		REMOVE_BLIP fm1_blip
		ADD_BLIP_FOR_CAR frankies_limo fm1_blip
		PRINT_NOW (FM1_1) 5000 1 //"Get back into the limo!"
		flag_blip_on_limo = 1
	ENDIF
	
	IF IS_PLAYER_IN_CAR player frankies_limo
	AND flag_blip_on_limo = 1
		locate_dome_flag = 1
		REMOVE_BLIP fm1_blip
		ADD_BLIP_FOR_CHAR chico fm1_blip
		flag_blip_on_limo = 0
	ENDIF

	GET_CHAR_COORDINATES chico chico_x chico_y chico_z

	IF LOCATE_PLAYER_IN_CAR_2D player chico_x chico_y 30.0 30.0 0
	AND chico_message_flag = 0
		PRINT_NOW FM1_P 5000 1 //THATS CHICO OVER THERE, STOP NEXT TO HIM AND I'LL GET OUT
		chico_message_flag = 1
	ENDIF

	IF chico_message_flag = 1
	AND NOT LOCATE_PLAYER_IN_CAR_2D player chico_x chico_y 30.0 30.0 0
		PRINT_NOW FM1_6 5000 1 //WHERE ARE YOU GOING, I WANT TO SEE CHICO
		chico_message_flag = 0
	ENDIF

ENDWHILE

SET_PLAYER_CONTROL player OFF
SET_EVERYONE_IGNORE_PLAYER player TRUE
SWITCH_WIDESCREEN ON
//MAKE_PLAYER_SAFE player
SET_ALL_CARS_CAN_BE_DAMAGED FALSE

//SET_FIXED_CAMERA_POSITION 769.86 -569.95 14.462 0.0 0.0 0.0
//POINT_CAMERA_AT_CHAR maria FIXED JUMP_CUT
SET_FIXED_CAMERA_POSITION 770.7659 -569.9462 14.3248 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 770.7453 -568.9474 14.4 JUMP_CUT

REMOVE_BLIP	fm1_blip

CLOSE_GARAGE frankie_garage

SET_CHAR_OBJ_LEAVE_CAR maria frankies_limo

WHILE IS_CHAR_IN_ANY_CAR maria

	WAIT 0

	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CHAR_DEAD chico
		PRINT_NOW FM1_8 5000 1 // "You killed Chico!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player frankies_limo
	AND flag_blip_on_limo = 0
		ADD_BLIP_FOR_CAR frankies_limo fm1_blip
		PRINT_NOW (FM1_1) 5000 1 //"Get back into the limo!"
		flag_blip_on_limo = 1
	ENDIF
	
	IF IS_PLAYER_IN_CAR player frankies_limo
	AND flag_blip_on_limo = 1
		REMOVE_BLIP fm1_blip
		flag_blip_on_limo = 0
	ENDIF

	IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player maria 20.0 20.0 0
		PRINT_NOW FM1_3 5000 1 //COMEBACK
	ENDIF

ENDWHILE

SET_CHAR_OBJ_GOTO_CHAR_ON_FOOT maria chico

GET_CHAR_COORDINATES chico chico_x chico_y chico_z

WHILE NOT LOCATE_STOPPED_CHAR_ON_FOOT_2D maria chico_x chico_y 3.0 3.0 0

	WAIT 0

	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CHAR_DEAD chico
		PRINT_NOW FM1_8 5000 1 // "You killed Chico!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	GET_CHAR_COORDINATES chico chico_x chico_y chico_z

	IF NOT IS_PLAYER_IN_CAR player frankies_limo
	AND flag_blip_on_limo = 0
		ADD_BLIP_FOR_CAR frankies_limo fm1_blip
		PRINT_NOW (FM1_1) 5000 1 //"Get back into the limo!"
		flag_blip_on_limo = 1
	ENDIF
	
	IF IS_PLAYER_IN_CAR player frankies_limo
	AND flag_blip_on_limo = 1
		REMOVE_BLIP fm1_blip
		flag_blip_on_limo = 0
	ENDIF

	IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player maria 20.0 20.0 0
		PRINT_NOW FM1_3 5000 1 //COMEBACK
	ENDIF

ENDWHILE

CLEAR_SMALL_PRINTS

WHILE NOT chico_audio_flag = 15

	WAIT 0

	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		CLEAR_MISSION_AUDIO
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		CLEAR_MISSION_AUDIO
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CHAR_DEAD chico
		PRINT_NOW FM1_8 5000 1 // "You killed Chico!"
		CLEAR_MISSION_AUDIO
		GOTO mission_frankie1_failed
	ENDIF

	IF skip_cutscene_flag = 0
		IF NOT IS_BUTTON_PRESSED PAD1 CROSS
			skip_cutscene_flag = 1
		ENDIF
	ENDIF

	IF skip_cutscene_flag = 1
		IF IS_BUTTON_PRESSED PAD1 CROSS
			skip_cutscene_flag = 2
		ENDIF
	ENDIF
	
	IF skip_cutscene_flag = 2
		IF NOT IS_BUTTON_PRESSED PAD1 CROSS
			CLEAR_MISSION_AUDIO
			LOAD_MISSION_AUDIO S1_F
			SET_CHAR_WAIT_STATE chico WAITSTATE_FALSE 100
			SET_CHAR_WAIT_STATE maria WAITSTATE_FALSE 100
			chico_audio_flag = 15
			skip_cutscene_flag = 3
		ENDIF
	ENDIF

	IF chico_audio_flag = 0
		TURN_CHAR_TO_FACE_CHAR chico maria
		TURN_CHAR_TO_FACE_CHAR maria chico
		LOAD_MISSION_AUDIO S1_A
		chico_audio_flag = 1
	ENDIF 

	IF chico_audio_flag = 14
		IF HAS_MISSION_AUDIO_FINISHED
			LOAD_MISSION_AUDIO S1_F
			SET_CHAR_WAIT_STATE chico WAITSTATE_FALSE 100
			chico_audio_flag = 15
		ENDIF
	ENDIF

	IF chico_audio_flag = 13
		IF HAS_MISSION_AUDIO_LOADED
			GET_CHAR_COORDINATES chico chico_x chico_y chico_z
			PLAY_MISSION_AUDIO
			PRINT_NOW FM1_U 3200 1//"Gracias and enjoy. That's good stuff."
			SET_CHAR_WAIT_STATE chico WAITSTATE_PLAYANIM_CHAT 10000
			chico_audio_flag = 14
		ENDIF
	ENDIF

	IF chico_audio_flag = 12
		IF HAS_MISSION_AUDIO_FINISHED
			TURN_CHAR_TO_FACE_CHAR chico maria
			TURN_CHAR_TO_FACE_CHAR maria chico
			LOAD_MISSION_AUDIO S1_E
			SET_CHAR_WAIT_STATE maria WAITSTATE_FALSE 100
			chico_audio_flag = 13
		ENDIF
	ENDIF

	IF chico_audio_flag = 11
		IF HAS_MISSION_AUDIO_LOADED
			GET_CHAR_COORDINATES maria chico_x chico_y chico_z
			PLAY_MISSION_AUDIO
			PRINT_NOW FM1_T 4000 2 //"Thanks for the tip. C'mon, let's go party. See you around Chico."
			SET_CHAR_WAIT_STATE maria WAITSTATE_PLAYANIM_CHAT 10000
			chico_audio_flag = 12
		ENDIF
	ENDIF

	IF chico_audio_flag = 10
		IF HAS_MISSION_AUDIO_FINISHED
			TURN_CHAR_TO_FACE_CHAR chico maria
			TURN_CHAR_TO_FACE_CHAR maria chico
			LOAD_MISSION_AUDIO S1_D
			SET_CHAR_WAIT_STATE chico WAITSTATE_FALSE 100
			chico_audio_flag = 11
		ENDIF
	ENDIF

	IF chico_audio_flag = 9
		IF HAS_MISSION_AUDIO_LOADED
			GET_CHAR_COORDINATES chico chico_x chico_y chico_z
			PLAY_MISSION_AUDIO
			PRINT_NOW FM1_S1 15000 2 //"You should check out the warehouse party going down at the North end of Portland Harbour."
			chico_audio_flag = 10
		ENDIF
	ENDIF

	IF chico_audio_flag = 8
		IF HAS_MISSION_AUDIO_FINISHED
			TURN_CHAR_TO_FACE_CHAR chico maria
			TURN_CHAR_TO_FACE_CHAR maria chico
			LOAD_MISSION_AUDIO S1_C1
			chico_audio_flag = 9
		ENDIF
	ENDIF

	IF chico_audio_flag = 7
		IF HAS_MISSION_AUDIO_LOADED
			GET_CHAR_COORDINATES chico chico_x chico_y chico_z
			SET_CHAR_WAIT_STATE chico WAITSTATE_PLAYANIM_CHAT 10000
			PLAY_MISSION_AUDIO
			PRINT_NOW FM1_S 5000 2 //"Here you go lady"
			chico_audio_flag = 8
		ENDIF
	ENDIF

	IF chico_audio_flag = 6
		IF HAS_MISSION_AUDIO_FINISHED
			TURN_CHAR_TO_FACE_CHAR chico maria
			TURN_CHAR_TO_FACE_CHAR maria chico
			LOAD_MISSION_AUDIO S1_C
			SET_CHAR_WAIT_STATE maria WAITSTATE_FALSE 100
			chico_audio_flag = 7
		ENDIF
	ENDIF

	IF chico_audio_flag = 5
		IF HAS_MISSION_AUDIO_LOADED
			GET_CHAR_COORDINATES maria chico_x chico_y chico_z
			PLAY_MISSION_AUDIO
			PRINT_NOW FM1_R 6000 2 //"Hi Chico. Yeah just the usual."
			SET_CHAR_WAIT_STATE maria WAITSTATE_PLAYANIM_CHAT 10000
			chico_audio_flag = 6
		ENDIF
	ENDIF

	IF chico_audio_flag = 4
		IF HAS_MISSION_AUDIO_FINISHED
			TURN_CHAR_TO_FACE_CHAR chico maria
			TURN_CHAR_TO_FACE_CHAR maria chico
			LOAD_MISSION_AUDIO S1_B
			SET_CHAR_WAIT_STATE chico WAITSTATE_FALSE 100
			chico_audio_flag = 5
		ENDIF
	ENDIF

	IF chico_audio_flag = 3
		IF HAS_MISSION_AUDIO_LOADED
			GET_CHAR_COORDINATES chico chico_x chico_y chico_z
			PLAY_MISSION_AUDIO
			PRINT_NOW FM1_Q1 6000 2 //"You looking for some spank?"
			chico_audio_flag = 4
		ENDIF
	ENDIF

	IF chico_audio_flag = 2
		IF HAS_MISSION_AUDIO_FINISHED
			TURN_CHAR_TO_FACE_CHAR chico maria
			TURN_CHAR_TO_FACE_CHAR maria chico
			LOAD_MISSION_AUDIO S1_A1
			chico_audio_flag = 3
		ENDIF
	ENDIF 

	IF chico_audio_flag = 1
		IF HAS_MISSION_AUDIO_LOADED
			GET_CHAR_COORDINATES chico chico_x chico_y chico_z
			PLAY_MISSION_AUDIO
			PRINT_NOW FM1_Q 6000 2 //"Hey it's my favourite lady!"
			SET_CHAR_WAIT_STATE chico WAITSTATE_PLAYANIM_CHAT 10000
			chico_audio_flag = 2
		ENDIF
	ENDIF

ENDWHILE

maria_getting_into_car:

IF IS_CHAR_DEAD maria
	PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
	GOTO mission_frankie1_failed
ENDIF

IF IS_CAR_DEAD frankies_limo
	PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
	GOTO mission_frankie1_failed
ENDIF

CLEAR_SMALL_PRINTS
SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER maria frankies_limo
SET_CHAR_RUNNING maria TRUE

MARK_CHAR_AS_NO_LONGER_NEEDED chico

SWITCH_PED_ROADS_ON 759.0 -616.0 11.0 782.0 -536.0 26.0

WHILE NOT IS_CHAR_IN_CAR maria frankies_limo
	
	WAIT 0

	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

ENDWHILE

IF flag_player_on_mission = 0
	ADD_BLIP_FOR_CAR frankies_limo fm1_blip
	ADD_BLIP_FOR_CHAR maria maria_blip
ENDIF

SET_PLAYER_CONTROL player ON
SET_EVERYONE_IGNORE_PLAYER player FALSE
SWITCH_WIDESCREEN OFF
SET_ALL_CARS_CAN_BE_DAMAGED TRUE
SET_CHAR_RUNNING maria FALSE

RESTORE_CAMERA_JUMPCUT
SET_CAMERA_IN_FRONT_OF_PLAYER

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
	
	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

ENDWHILE

PLAY_MISSION_AUDIO

PRINT_NOW FM1_V 3500 1 //"C'mon Fido, let's go check out this party!"

REMOVE_BLIP fm1_blip
REMOVE_BLIP maria_blip
ADD_BLIP_FOR_COORD 1256.6 -1099.3 -11.7 fm1_blip

CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A 1267.73 -1109.24 11.0 doorman1
SET_CHAR_HEADING doorman1 90.0
SET_CHAR_THREAT_SEARCH doorman1 THREAT_GANG_HOOD
SET_CHAR_PERSONALITY doorman1 PEDSTAT_TOUGH_GUY
GIVE_WEAPON_TO_CHAR doorman1 WEAPONTYPE_PISTOL 99
SET_CHAR_OBJ_WAIT_ON_FOOT doorman1
SET_CHAR_HEED_THREATS doorman1 TRUE

CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A 1267.73 -1105.62 11.0 doorman2
SET_CHAR_HEADING doorman2 90.0
SET_CHAR_THREAT_SEARCH doorman2 THREAT_GANG_HOOD
SET_CHAR_PERSONALITY doorman2 PEDSTAT_TOUGH_GUY
GIVE_WEAPON_TO_CHAR doorman2 WEAPONTYPE_PISTOL 99
SET_CHAR_OBJ_WAIT_ON_FOOT doorman2
SET_CHAR_HEED_THREATS doorman2 TRUE

CREATE_CAR CAR_SENTINEL 1243.0 -1112.0 11.0 parked_car1
CREATE_CAR CAR_CHEETAH 1247.0 -1112.0 11.0 parked_car2
CREATE_CAR CAR_MANANA 1251.0 -1112.0 11.0 parked_car3

/////////////CLUB STUFF////

DRAW_SHADOW SHADOW_EXPLOSION 1270.8430 -1107.7288 11.1079 0.0 1.0 0 255 0 0// ShadowType X Y Z Rotation Scale Transparency Red Green Blue
DRAW_LIGHT 1273.1917 -1107.3098 11.1079 255 0 0
ADD_CONTINUOUS_SOUND 1269.7494 -1100.4137 14.0 SOUND_RAVE_LOOP_INDUSTRIAL_L warehouse_rave_loop
ADD_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION 1273.0 -1107.2 10.7 0
ADD_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION 1273.0522 -1107.2312 10.7 0
ADD_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION 1273.1 -1107.1 10.7 0
ADD_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION 1273.2 -1107.0 10.7 0
ADD_PARTICLE_EFFECT POBJECT_WALL_STEAM_SLOWMOTION 1270.0 -1107.35 10.8 0
ADD_PARTICLE_EFFECT POBJECT_PAVEMENT_STEAM_SLOWMOTION 1271.5223 -1107.5471 10.6 0
add_sound_flag = 1
locate_dome_flag = 1
chico_message_flag = 0
flag_blip_on_limo = 0

///////////////////////////

WHILE NOT LOCATE_STOPPED_CHAR_IN_CAR_2D maria 1259.0410 -1107.7825 3.0 3.0 locate_dome_flag

	WAIT 0
	
	GOSUB draw_disco_lights

	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	IF chico_message_flag = 0
		IF LOCATE_CHAR_ANY_MEANS_2D	maria 1258.0 -1100.0 50.0 50.0 0
			PRINT_NOW FM1_9 5000 1 //"Thats the club up ahead"
			chico_message_flag = 1
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player frankies_limo
	AND flag_blip_on_limo = 0
		REMOVE_BLIP fm1_blip
		ADD_BLIP_FOR_CAR frankies_limo fm1_blip
		PRINT_NOW (FM1_1) 5000 1 //"Get back into the limo!"
		locate_dome_flag = 0
		flag_blip_on_limo = 1
	ENDIF
	
	IF IS_PLAYER_IN_CAR player frankies_limo
	AND flag_blip_on_limo = 1
		REMOVE_BLIP fm1_blip
		ADD_BLIP_FOR_COORD 1262.1 -1099.4 -100.0 fm1_blip
		locate_dome_flag = 1
		flag_blip_on_limo = 0
	ENDIF

	IF chico_audio_flag = 16
		IF HAS_MISSION_AUDIO_LOADED
			chico_audio_flag = 17
		ENDIF
	ENDIF

	IF chico_audio_flag = 15
		IF HAS_MISSION_AUDIO_FINISHED
			LOAD_MISSION_AUDIO S1_G
			chico_audio_flag = 16
		ENDIF
	ENDIF

ENDWHILE

IF NOT chico_audio_flag = 17
	WAIT 0
	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
		
		IF IS_CHAR_DEAD maria
			PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
			GOTO mission_frankie1_failed
		ENDIF

		IF IS_CAR_DEAD frankies_limo
			PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
			GOTO mission_frankie1_failed
		ENDIF

	ENDWHILE
	chico_audio_flag = 17
ENDIF

GET_CHAR_COORDINATES maria chico_x chico_y chico_z
PLAY_MISSION_AUDIO

SET_PLAYER_CONTROL player OFF
SET_EVERYONE_IGNORE_PLAYER player TRUE
SET_ALL_CARS_CAN_BE_DAMAGED FALSE

PRINT_NOW FM1_W 5000 1 //"OK Fido, you wait here and look after the car while I go and shake my butt."

WAIT 0

WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
	
	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

ENDWHILE

SET_PLAYER_CONTROL player ON
SET_EVERYONE_IGNORE_PLAYER player FALSE
SET_ALL_CARS_CAN_BE_DAMAGED TRUE

SET_CHAR_OBJ_LEAVE_CAR maria frankies_limo

WHILE IS_CHAR_IN_CAR maria frankies_limo

	WAIT 0

	GOSUB draw_disco_lights
	
	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	IF chico_audio_flag = 17
		IF HAS_MISSION_AUDIO_FINISHED
			LOAD_MISSION_AUDIO S1_H
			chico_audio_flag = 18
		ENDIF
	ENDIF

ENDWHILE

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT maria 1266.85 -1107.65
TIMERA = 0

WHILE NOT LOCATE_CHAR_ON_FOOT_2D maria 1266.85 -1107.65 1.0 1.0 0
	
	WAIT 0

	GOSUB draw_disco_lights

	IF TIMERA > 20000
		CLEAR_AREA 1267.665 -1107.569 11.38 3.0 FALSE
	ENDIF
	
	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	IF chico_audio_flag = 17
		IF HAS_MISSION_AUDIO_FINISHED
			LOAD_MISSION_AUDIO S1_H
			chico_audio_flag = 18
		ENDIF
	ENDIF

ENDWHILE

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT maria inside_warehouse_x inside_warehouse_y

WHILE NOT LOCATE_CHAR_ON_FOOT_2D maria inside_warehouse_x inside_warehouse_y 1.0 1.0 0
	
	WAIT 0

	GOSUB draw_disco_lights
	
	IF TIMERA > 20000
		CLEAR_AREA 1267.665 -1107.569 11.38 4.0 FALSE
	ENDIF
	
	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	IF chico_audio_flag = 17
		IF HAS_MISSION_AUDIO_FINISHED
			LOAD_MISSION_AUDIO S1_H
			chico_audio_flag = 18
		ENDIF
	ENDIF

ENDWHILE

maria_exists = 0
DELETE_CHAR	maria

wait_for_maria:////////////////////////////////////////////////////////////////////////

WAIT 0

GOSUB draw_disco_lights

IF IS_CAR_DEAD frankies_limo
	PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
	GOTO mission_frankie1_failed
ENDIF

TIMERA = 0

WHILE LOCATE_PLAYER_ANY_MEANS_2D player	1262.1 -1099.4 22.0 22.0 0

	WAIT 0

	GOSUB draw_disco_lights
	
	IF TIMERA > 10000
		GOTO club_busted
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	IF chico_audio_flag = 17
		IF HAS_MISSION_AUDIO_FINISHED
			LOAD_MISSION_AUDIO S1_H
			chico_audio_flag = 18
		ENDIF
	ENDIF

ENDWHILE
	
PRINT_NOW (FM1_4) 500 2 //You're supposed to be waiting for Maria! Get back to the warehouse!

GOTO wait_for_maria///////////////////////////////////////////////////////////////////

club_busted://////////////////////////////////////////////////////////////////////////

WHILE NOT HAS_MODEL_LOADED CAR_ENFORCER
OR NOT HAS_MODEL_LOADED PED_SWAT
OR NOT HAS_MODEL_LOADED PED_P_MAN1
OR NOT HAS_MODEL_LOADED	PED_FEMALE1
OR NOT HAS_MODEL_LOADED	PED_FEMALE2
	WAIT 0
ENDWHILE

swat_car_one:

CREATE_CAR CAR_ENFORCER 1293.0 -925.0 -100.0 swatvan_fm1
SET_CAR_HEADING swatvan_fm1 225.0
SET_CAR_CRUISE_SPEED swatvan_fm1 40.0
SET_CAR_DRIVING_STYLE swatvan_fm1 2
SWITCH_CAR_SIREN swatvan_fm1 ON
LOCK_CAR_DOORS swatvan_fm1 CARLOCK_LOCKOUT_PLAYER_ONLY

CREATE_CHAR_INSIDE_CAR swatvan_fm1 PEDTYPE_GANG_HOOD PED_SWAT cop1_fm1
SET_CHAR_THREAT_SEARCH cop1_fm1 THREAT_GANG_MAFIA
SET_CHAR_PERSONALITY cop1_fm1 PEDSTAT_TOUGH_GUY
GIVE_WEAPON_TO_CHAR cop1_fm1 WEAPONTYPE_PISTOL 99

CREATE_CHAR_AS_PASSENGER swatvan_fm1 PEDTYPE_GANG_HOOD PED_SWAT 0 cop2_fm1
SET_CHAR_THREAT_SEARCH cop2_fm1 THREAT_GANG_MAFIA
SET_CHAR_PERSONALITY cop2_fm1 PEDSTAT_TOUGH_GUY
GIVE_WEAPON_TO_CHAR cop2_fm1 WEAPONTYPE_PISTOL 99

CREATE_CHAR_AS_PASSENGER swatvan_fm1 PEDTYPE_GANG_HOOD PED_SWAT 1 cop3_fm1
SET_CHAR_THREAT_SEARCH cop3_fm1 THREAT_GANG_MAFIA
SET_CHAR_PERSONALITY cop3_fm1 PEDSTAT_TOUGH_GUY
GIVE_WEAPON_TO_CHAR cop3_fm1 WEAPONTYPE_PISTOL 99

CREATE_CHAR_AS_PASSENGER swatvan_fm1 PEDTYPE_GANG_HOOD PED_SWAT 2 cop4_fm1
SET_CHAR_THREAT_SEARCH cop4_fm1 THREAT_GANG_MAFIA
SET_CHAR_PERSONALITY cop4_fm1 PEDSTAT_TOUGH_GUY
GIVE_WEAPON_TO_CHAR cop4_fm1 WEAPONTYPE_PISTOL 99

CAR_GOTO_COORDINATES swatvan_fm1 1252.0 -1086.0 -100.0

IF create_more_swat1 = 1
	create_more_swat1 = 0
	RETURN
ENDIF

swat_car_two:

CREATE_CAR CAR_ENFORCER 1084.0 -1012.0 -100.0 swatvan2_fm1
SET_CAR_HEADING swatvan2_fm1 180.0
SET_CAR_CRUISE_SPEED swatvan2_fm1 40.0
SET_CAR_DRIVING_STYLE swatvan2_fm1 2
SWITCH_CAR_SIREN swatvan2_fm1 ON
LOCK_CAR_DOORS swatvan2_fm1 CARLOCK_LOCKOUT_PLAYER_ONLY

CREATE_CHAR_INSIDE_CAR swatvan2_fm1 PEDTYPE_GANG_HOOD PED_SWAT cop5_fm1
SET_CHAR_THREAT_SEARCH cop5_fm1 THREAT_GANG_MAFIA
SET_CHAR_PERSONALITY cop5_fm1 PEDSTAT_TOUGH_GUY
GIVE_WEAPON_TO_CHAR cop5_fm1 WEAPONTYPE_PISTOL 99

CREATE_CHAR_AS_PASSENGER swatvan2_fm1 PEDTYPE_GANG_HOOD PED_SWAT 0 cop6_fm1
SET_CHAR_THREAT_SEARCH cop6_fm1 THREAT_GANG_MAFIA
SET_CHAR_PERSONALITY cop6_fm1 PEDSTAT_TOUGH_GUY
GIVE_WEAPON_TO_CHAR cop6_fm1 WEAPONTYPE_PISTOL 99

CREATE_CHAR_AS_PASSENGER swatvan2_fm1 PEDTYPE_GANG_HOOD PED_SWAT 1 cop7_fm1
SET_CHAR_THREAT_SEARCH cop7_fm1 THREAT_GANG_MAFIA
SET_CHAR_PERSONALITY cop7_fm1 PEDSTAT_TOUGH_GUY
GIVE_WEAPON_TO_CHAR cop7_fm1 WEAPONTYPE_PISTOL 99

CREATE_CHAR_AS_PASSENGER swatvan2_fm1 PEDTYPE_GANG_HOOD PED_SWAT 2 cop8_fm1
SET_CHAR_THREAT_SEARCH cop8_fm1 THREAT_GANG_MAFIA
SET_CHAR_PERSONALITY cop8_fm1 PEDSTAT_TOUGH_GUY
GIVE_WEAPON_TO_CHAR cop8_fm1 WEAPONTYPE_PISTOL 99

CAR_GOTO_COORDINATES swatvan2_fm1 1235.0 -1099.0 -100.0

SET_PLAYER_CONTROL player OFF
SET_EVERYONE_IGNORE_PLAYER player TRUE
SWITCH_WIDESCREEN ON
SET_ALL_CARS_CAN_BE_DAMAGED FALSE
SET_FIXED_CAMERA_POSITION 1309.913 -1061.354 15.691 0.0 0.0 0.0
POINT_CAMERA_AT_CAR swatvan_fm1 FIXED JUMP_CUT
SET_GENERATE_CARS_AROUND_CAMERA TRUE
swat_cam_needs_restoring = 1

IF create_more_swat2 = 1
	create_more_swat2 = 0
	RETURN
ENDIF

IF NOT chico_audio_flag = 18
	WHILE NOT HAS_MISSION_AUDIO_FINISHED
		WAIT 0
		
		IF IS_CAR_DEAD frankies_limo
			PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
			GOTO mission_frankie1_failed
		ENDIF

	ENDWHILE
	LOAD_MISSION_AUDIO S1_H
	chico_audio_flag = 18
ENDIF

WAIT 0

IF chico_audio_flag = 18
	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
		
		IF IS_CAR_DEAD frankies_limo
			PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
			GOTO mission_frankie1_failed
		ENDIF

	ENDWHILE
	chico_audio_flag = 19
ENDIF

PLAY_MISSION_AUDIO
PRINT_NOW (FM1_SS) 4000 2 //"Calling all cars, request back-up for narcotics raid. Warehouse party Portland Harbour East."

WHILE swat1_exit_car = 0
OR swat2_exit_car = 0

	WAIT 0

	IF fuckup_flag = 0
		GET_GAME_TIMER fuckup_timer_start
		fuckup_flag = 1
	ENDIF

	IF fuckup_flag = 1
		GET_GAME_TIMER fuckup_timer_current
		fuckup_timer = fuckup_timer_current - fuckup_timer_start
		IF fuckup_timer > 180000
			swat1_exit_car = 1
			swat2_exit_car = 1
			IF swat_cam_needs_restoring = 1
				SET_CAMERA_BEHIND_PLAYER
				RESTORE_CAMERA_JUMPCUT
				SET_PLAYER_CONTROL player ON
				SET_EVERYONE_IGNORE_PLAYER player FALSE
				SWITCH_WIDESCREEN OFF
				SET_ALL_CARS_CAN_BE_DAMAGED TRUE
				SET_GENERATE_CARS_AROUND_CAMERA FALSE
				swat_cam_needs_restoring = 0
			ENDIF
			fuckup_flag = 2
		ENDIF
	ENDIF
	
	GOSUB draw_disco_lights

	IF chico_audio_flag = 20
		IF HAS_MISSION_AUDIO_LOADED
			chico_audio_flag = 21
		ENDIF
	ENDIF
	
	IF chico_audio_flag = 19
		IF HAS_MISSION_AUDIO_FINISHED
			LOAD_MISSION_AUDIO S1_I
			chico_audio_flag = 20
		ENDIF
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD swatvan_fm1
		MARK_CAR_AS_NO_LONGER_NEEDED swatvan_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop1_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop2_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop3_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop4_fm1
		create_more_swat1 = 1
		GOSUB swat_car_one
	ENDIF

	IF IS_CAR_UPSIDEDOWN swatvan_fm1
	AND IS_CAR_STOPPED swatvan_fm1
		MARK_CAR_AS_NO_LONGER_NEEDED swatvan_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop1_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop2_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop3_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop4_fm1
		create_more_swat1 = 1
		GOSUB swat_car_one
	ENDIF

	IF IS_CAR_IN_WATER swatvan_fm1
		MARK_CAR_AS_NO_LONGER_NEEDED swatvan_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop1_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop2_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop3_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop4_fm1
		create_more_swat1 = 1
		GOSUB swat_car_one
	ENDIF

	IF timera_reset = 1
		IF NOT IS_CAR_STOPPED swatvan_fm1
			timera_reset = 0
		ENDIF
	ENDIF
			
	IF IS_CAR_STOPPED swatvan_fm1
		IF timera_reset = 0
			TIMERA = 0
			timera_reset = 1
		ENDIF

		IF TIMERA > 5000
		AND timera_reset = 1
			MARK_CAR_AS_NO_LONGER_NEEDED swatvan_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED cop1_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED cop2_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED cop3_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED cop4_fm1
			create_more_swat1 = 1
			GOSUB swat_car_one
		ENDIF
	ENDIF
	
	IF LOCATE_CAR_3D swatvan_fm1 swat1_stuck_x swat1_stuck_y swat1_stuck_z 2.0 2.0 2.0 0
		IF timerc_reset_flag_f1a = 0
			GET_GAME_TIMER timerc_started_f1a
			timerc_reset_flag_f1a = 1
		ENDIF

		IF timerc_reset_flag_f1a = 1
			GET_GAME_TIMER timerc_current_f1a
			timerc_f1a = timerc_current_f1a - timerc_started_f1a
			IF timerc_f1a > 8000
				MARK_CAR_AS_NO_LONGER_NEEDED swatvan_fm1
				MARK_CHAR_AS_NO_LONGER_NEEDED cop1_fm1
				MARK_CHAR_AS_NO_LONGER_NEEDED cop2_fm1
				MARK_CHAR_AS_NO_LONGER_NEEDED cop3_fm1
				MARK_CHAR_AS_NO_LONGER_NEEDED cop4_fm1
				create_more_swat1 = 1
				GOSUB swat_car_one
			ENDIF
		ENDIF
	ENDIF

	IF NOT LOCATE_CAR_3D swatvan_fm1 swat1_stuck_x swat1_stuck_y swat1_stuck_z 2.0 2.0 2.0 0
		GET_CAR_COORDINATES swatvan_fm1 swat1_stuck_x swat1_stuck_y swat1_stuck_z
		timerc_reset_flag_f1a = 0
	ENDIF
	
	IF IS_CAR_DEAD swatvan2_fm1
		MARK_CAR_AS_NO_LONGER_NEEDED swatvan2_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop5_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop6_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop7_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop8_fm1
		create_more_swat2 = 1
		GOSUB swat_car_two
	ENDIF

	IF IS_CAR_UPSIDEDOWN swatvan2_fm1
	AND IS_CAR_STOPPED swatvan2_fm1
		MARK_CAR_AS_NO_LONGER_NEEDED swatvan2_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop5_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop6_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop7_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop8_fm1
		create_more_swat2 = 1
		GOSUB swat_car_two
	ENDIF

	IF IS_CAR_IN_WATER swatvan2_fm1
		MARK_CAR_AS_NO_LONGER_NEEDED swatvan2_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop5_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop6_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop7_fm1
		MARK_CHAR_AS_NO_LONGER_NEEDED cop8_fm1
		create_more_swat2 = 1
		GOSUB swat_car_two
	ENDIF

	IF timerb_reset = 1
		IF NOT IS_CAR_STOPPED swatvan2_fm1
			timerb_reset = 0
		ENDIF
	ENDIF
			
	IF IS_CAR_STOPPED swatvan2_fm1
		IF timerb_reset = 0
			TIMERB = 0
			timerb_reset = 1
		ENDIF

		IF TIMERB > 5000
		AND timerb_reset = 1
			MARK_CAR_AS_NO_LONGER_NEEDED swatvan2_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED cop5_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED cop6_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED cop7_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED cop8_fm1
			create_more_swat2 = 1
			GOSUB swat_car_two
		ENDIF
	ENDIF

	IF LOCATE_CAR_3D swatvan2_fm1 swat2_stuck_x swat2_stuck_y swat2_stuck_z 2.0 2.0 2.0 0
		IF timerc_reset_flag_f1b = 0
			GET_GAME_TIMER timerc_started_f1b
			timerc_reset_flag_f1b = 1
		ENDIF

		IF timerc_reset_flag_f1b = 1
			GET_GAME_TIMER timerc_current_f1b
			timerc_f1b = timerc_current_f1b - timerc_started_f1b
			IF timerc_f1b > 8000
				MARK_CAR_AS_NO_LONGER_NEEDED swatvan2_fm1
				MARK_CHAR_AS_NO_LONGER_NEEDED cop5_fm1
				MARK_CHAR_AS_NO_LONGER_NEEDED cop6_fm1
				MARK_CHAR_AS_NO_LONGER_NEEDED cop7_fm1
				MARK_CHAR_AS_NO_LONGER_NEEDED cop8_fm1
				create_more_swat2 = 1
				GOSUB swat_car_two
			ENDIF
		ENDIF
	ENDIF

	IF NOT LOCATE_CAR_3D swatvan2_fm1 swat2_stuck_x swat2_stuck_y swat2_stuck_z 2.0 2.0 2.0 0
		GET_CAR_COORDINATES swatvan2_fm1 swat2_stuck_x swat2_stuck_y swat2_stuck_z
		timerc_reset_flag_f1b = 0
	ENDIF
	
	IF LOCATE_CAR_2D swatvan_fm1 1252.0 -1086.0 8.0 8.0 0
	AND swat1_exit_car = 0
		
		IF swat_cam_needs_restoring = 1
			SET_CAMERA_BEHIND_PLAYER
			RESTORE_CAMERA_JUMPCUT
			SET_PLAYER_CONTROL player ON
			SET_EVERYONE_IGNORE_PLAYER player FALSE
			SWITCH_WIDESCREEN OFF
			SET_ALL_CARS_CAN_BE_DAMAGED TRUE
			SET_GENERATE_CARS_AROUND_CAMERA FALSE
			swat_cam_needs_restoring = 0
		ENDIF

		IF chico_audio_flag = 21
			IF NOT IS_CHAR_DEAD	doorman1
				GET_CHAR_COORDINATES doorman1 chico_x chico_y chico_z
				SET_MISSION_AUDIO_POSITION chico_x chico_y chico_z
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED doorman1
				IF NOT IS_CHAR_DEAD	doorman2 
					GET_CHAR_COORDINATES doorman2 chico_x chico_y chico_z
					SET_MISSION_AUDIO_POSITION chico_x chico_y chico_z
				ELSE
					MARK_CHAR_AS_NO_LONGER_NEEDED doorman2
				ENDIF
			ENDIF
			PLAY_MISSION_AUDIO
			PRINT_NOW FM1_TT 5000 1//"IT'S A POLICE RAID! EVERYBODY FOR THEMSELVES!!"
			chico_audio_flag = 22
		ENDIF

		SET_CAR_CRUISE_SPEED swatvan_fm1 0.0

		IF NOT IS_CHAR_DEAD	cop1_fm1
			SET_CHAR_OBJ_LEAVE_CAR cop1_fm1	swatvan_fm1
			SET_CHAR_HEED_THREATS cop1_fm1 TRUE
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED cop1_fm1
		ENDIF

		IF NOT IS_CHAR_DEAD	cop2_fm1
			SET_CHAR_OBJ_LEAVE_CAR cop2_fm1	swatvan_fm1
			SET_CHAR_HEED_THREATS cop2_fm1 TRUE
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED cop2_fm1
		ENDIF

		IF NOT IS_CHAR_DEAD	cop3_fm1
			SET_CHAR_OBJ_LEAVE_CAR cop3_fm1	swatvan_fm1
			SET_CHAR_HEED_THREATS cop3_fm1 TRUE
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED cop3_fm1
		ENDIF

		IF NOT IS_CHAR_DEAD	cop4_fm1
			SET_CHAR_OBJ_LEAVE_CAR cop4_fm1	swatvan_fm1
			SET_CHAR_HEED_THREATS cop4_fm1 TRUE
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED cop4_fm1
		ENDIF
		
		IF NOT IS_CHAR_DEAD doorman2
		AND NOT IS_CHAR_DEAD cop1_fm1
			SET_CHAR_OBJ_KILL_CHAR_ON_FOOT doorman2 cop1_fm1
		ENDIF
		swat1_exit_car = 1
	ENDIF

	IF LOCATE_CAR_2D swatvan2_fm1 1235.0 -1099.0 8.0 8.0 0
	AND swat2_exit_car = 0
		
		IF swat_cam_needs_restoring = 1
			RESTORE_CAMERA_JUMPCUT
			SET_CAMERA_BEHIND_PLAYER
			SET_PLAYER_CONTROL player ON
			SET_EVERYONE_IGNORE_PLAYER player FALSE
			SWITCH_WIDESCREEN OFF
			SET_ALL_CARS_CAN_BE_DAMAGED TRUE
			SET_GENERATE_CARS_AROUND_CAMERA FALSE
			swat_cam_needs_restoring = 0
		ENDIF

		IF chico_audio_flag = 21
			IF NOT IS_CHAR_DEAD	doorman1
				GET_CHAR_COORDINATES doorman1 chico_x chico_y chico_z
				SET_MISSION_AUDIO_POSITION chico_x chico_y chico_z
			ELSE
				IF NOT IS_CHAR_DEAD	doorman2 
					GET_CHAR_COORDINATES doorman2 chico_x chico_y chico_z
					SET_MISSION_AUDIO_POSITION chico_x chico_y chico_z
				ENDIF
			ENDIF
			PLAY_MISSION_AUDIO
			PRINT_NOW FM1_TT 5000 1//"IT'S A POLICE RAID! EVERYBODY FOR THEMSELVES!!"
			chico_audio_flag = 22
		ENDIF

		SET_CAR_CRUISE_SPEED swatvan2_fm1 0.0

		IF NOT IS_CHAR_DEAD	cop5_fm1
			SET_CHAR_OBJ_LEAVE_CAR cop5_fm1	swatvan2_fm1
			SET_CHAR_HEED_THREATS cop5_fm1 TRUE
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED cop5_fm1
		ENDIF

		IF NOT IS_CHAR_DEAD	cop6_fm1
			SET_CHAR_OBJ_LEAVE_CAR cop6_fm1	swatvan2_fm1
			SET_CHAR_HEED_THREATS cop6_fm1 TRUE
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED cop6_fm1
		ENDIF

		IF NOT IS_CHAR_DEAD	cop7_fm1
			SET_CHAR_OBJ_LEAVE_CAR cop7_fm1	swatvan2_fm1
			SET_CHAR_HEED_THREATS cop7_fm1 TRUE
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED cop7_fm1
		ENDIF

		IF NOT IS_CHAR_DEAD	cop8_fm1
			SET_CHAR_OBJ_LEAVE_CAR cop8_fm1	swatvan2_fm1
			SET_CHAR_HEED_THREATS cop8_fm1 TRUE
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED cop8_fm1
		ENDIF
		
		IF NOT IS_CHAR_DEAD doorman1
		AND NOT IS_CHAR_DEAD cop5_fm1
			SET_CHAR_OBJ_KILL_CHAR_ON_FOOT doorman1 cop5_fm1
		ENDIF
		swat2_exit_car = 1
	ENDIF

ENDWHILE

IF swat_cam_needs_restoring = 1
	SET_CAMERA_BEHIND_PLAYER
	RESTORE_CAMERA_JUMPCUT
	SET_PLAYER_CONTROL player ON
	SET_EVERYONE_IGNORE_PLAYER player FALSE
	SWITCH_WIDESCREEN OFF
	SET_ALL_CARS_CAN_BE_DAMAGED TRUE
	SET_GENERATE_CARS_AROUND_CAMERA FALSE
	swat_cam_needs_restoring = 0
ENDIF

WHILE clubbers_flee_flag < 10

	WAIT 0

	GOSUB draw_disco_lights

	IF chico_audio_flag = 23
		IF HAS_MISSION_AUDIO_LOADED
			chico_audio_flag = 24
		ENDIF
	ENDIF
	
	IF chico_audio_flag = 22
		IF HAS_MISSION_AUDIO_FINISHED
			LOAD_MISSION_AUDIO S1_J
			chico_audio_flag = 23
		ENDIF
	ENDIF
	
	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	IF clubbers_flee_flag = 0
		CREATE_CHAR PEDTYPE_GANG_MAFIA PED_P_MAN1 inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber1_fm1
		SET_CHAR_THREAT_SEARCH clubber1_fm1 THREAT_GANG_HOOD
		GIVE_WEAPON_TO_CHAR clubber1_fm1 WEAPONTYPE_UZI 99
		SET_CHAR_PERSONALITY clubber1_fm1 PEDSTAT_TOUGH_GUY
		SET_CHAR_RUNNING clubber1_fm1 TRUE
		SET_CHAR_OBJ_RUN_TO_COORD clubber1_fm1 outside_warehouse_x outside_warehouse_y
		clubbers_flee_flag = 1
	ENDIF	

	IF clubbers_flee_flag = 1	
		IF IS_CHAR_DEAD clubber1_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber1_fm1
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_FEMALE1 inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber2_fm1
			SET_CHAR_THREAT_SEARCH clubber2_fm1 THREAT_GANG_HOOD
			SET_CHAR_PERSONALITY clubber2_fm1 PEDSTAT_TOUGH_GUY
			GIVE_WEAPON_TO_CHAR clubber2_fm1 WEAPONTYPE_PISTOL 50
			SET_CHAR_RUNNING clubber2_fm1 TRUE
			SET_CHAR_OBJ_RUN_TO_COORD clubber2_fm1 outside_warehouse_x outside_warehouse_y
			clubbers_flee_flag = 2
		ELSE
			IF NOT LOCATE_CHAR_ANY_MEANS_2D	clubber1_fm1 inside_warehouse_x inside_warehouse_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_FEMALE1 inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber2_fm1
				GIVE_WEAPON_TO_CHAR clubber2_fm1 WEAPONTYPE_PISTOL 50
				SET_CHAR_THREAT_SEARCH clubber2_fm1 THREAT_GANG_HOOD
				SET_CHAR_PERSONALITY clubber2_fm1 PEDSTAT_TOUGH_GUY
				SET_CHAR_RUNNING clubber2_fm1 TRUE
				SET_CHAR_OBJ_RUN_TO_COORD clubber2_fm1 outside_warehouse_x outside_warehouse_y
				clubbers_flee_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF clubbers_flee_flag = 2	
		IF IS_CHAR_DEAD clubber2_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber2_fm1
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_CRIMINAL1 inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber3_fm1
			SET_CHAR_THREAT_SEARCH clubber3_fm1 THREAT_GANG_HOOD
			SET_CHAR_PERSONALITY clubber3_fm1 PEDSTAT_TOUGH_GUY
			SET_CHAR_RUNNING clubber3_fm1 TRUE
			GIVE_WEAPON_TO_CHAR	clubber3_fm1 WEAPONTYPE_PISTOL 50
			SET_CHAR_OBJ_RUN_TO_COORD clubber3_fm1 outside_warehouse_x outside_warehouse_y
			clubbers_flee_flag = 3
			clubber3_car1 = 1
		ELSE
			IF NOT LOCATE_CHAR_ANY_MEANS_2D	clubber2_fm1 inside_warehouse_x inside_warehouse_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_CRIMINAL1 inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber3_fm1
				SET_CHAR_THREAT_SEARCH clubber3_fm1 THREAT_GANG_HOOD
				SET_CHAR_PERSONALITY clubber3_fm1 PEDSTAT_TOUGH_GUY
				SET_CHAR_RUNNING clubber3_fm1 TRUE
				GIVE_WEAPON_TO_CHAR	clubber3_fm1 WEAPONTYPE_PISTOL 50
				SET_CHAR_OBJ_RUN_TO_COORD clubber3_fm1 outside_warehouse_x outside_warehouse_y
				clubbers_flee_flag = 3
				clubber3_car1 = 1
			ENDIF
		ENDIF
	ENDIF
		
	IF clubbers_flee_flag = 3
		IF IS_CHAR_DEAD clubber3_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber3_fm1
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_FEMALE2 inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber4_fm1
			SET_CHAR_THREAT_SEARCH clubber4_fm1 THREAT_GANG_HOOD
			SET_CHAR_PERSONALITY clubber4_fm1 PEDSTAT_TOUGH_GUY
			GIVE_WEAPON_TO_CHAR	clubber4_fm1 WEAPONTYPE_UZI 99
			SET_CHAR_RUNNING clubber4_fm1 TRUE
			SET_CHAR_OBJ_RUN_TO_COORD clubber4_fm1 outside_warehouse_x outside_warehouse_y
			clubbers_flee_flag = 4
		ELSE
			IF NOT LOCATE_CHAR_ANY_MEANS_2D	clubber3_fm1 inside_warehouse_x inside_warehouse_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_FEMALE2 inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber4_fm1
				SET_CHAR_THREAT_SEARCH clubber4_fm1 THREAT_GANG_HOOD
				SET_CHAR_PERSONALITY clubber4_fm1 PEDSTAT_TOUGH_GUY
				GIVE_WEAPON_TO_CHAR	clubber4_fm1 WEAPONTYPE_UZI 99
				SET_CHAR_RUNNING clubber4_fm1 TRUE
				SET_CHAR_OBJ_RUN_TO_COORD clubber4_fm1 outside_warehouse_x outside_warehouse_y
				clubbers_flee_flag = 4
			ENDIF
		ENDIF
	ENDIF

	IF clubbers_flee_flag = 4	
		IF IS_CHAR_DEAD clubber4_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber4_fm1
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber5_fm1
			SET_CHAR_THREAT_SEARCH clubber5_fm1 THREAT_GANG_HOOD
			SET_CHAR_PERSONALITY clubber5_fm1 PEDSTAT_TOUGH_GUY
			SET_CHAR_RUNNING clubber5_fm1 TRUE
			GIVE_WEAPON_TO_CHAR	clubber5_fm1 WEAPONTYPE_PISTOL 50
			SET_CHAR_OBJ_RUN_TO_COORD clubber5_fm1 outside_warehouse_x outside_warehouse_y
			clubbers_flee_flag = 5
			clubber5_car2 = 1
		ELSE
			IF NOT LOCATE_CHAR_ANY_MEANS_2D	clubber4_fm1 inside_warehouse_x inside_warehouse_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber5_fm1
				SET_CHAR_THREAT_SEARCH clubber5_fm1 THREAT_GANG_HOOD
				SET_CHAR_PERSONALITY clubber5_fm1 PEDSTAT_TOUGH_GUY
				SET_CHAR_RUNNING clubber5_fm1 TRUE
				GIVE_WEAPON_TO_CHAR	clubber5_fm1 WEAPONTYPE_PISTOL 50
				SET_CHAR_OBJ_RUN_TO_COORD clubber5_fm1 outside_warehouse_x outside_warehouse_y
				clubbers_flee_flag = 5
				clubber5_car2 = 1
			ENDIF
		ENDIF
	ENDIF

	IF clubbers_flee_flag = 5	
		IF IS_CHAR_DEAD clubber5_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber5_fm1
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_CRIMINAL1 inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber6_fm1
			SET_CHAR_THREAT_SEARCH clubber6_fm1 THREAT_GANG_HOOD
			SET_CHAR_PERSONALITY clubber6_fm1 PEDSTAT_TOUGH_GUY
			SET_CHAR_RUNNING clubber6_fm1 TRUE
			GIVE_WEAPON_TO_CHAR	clubber6_fm1 WEAPONTYPE_PISTOL 50
			SET_CHAR_OBJ_RUN_TO_COORD clubber6_fm1 outside_warehouse_x outside_warehouse_y
			clubbers_flee_flag = 6
		ELSE 
			IF NOT LOCATE_CHAR_ANY_MEANS_2D	clubber5_fm1 inside_warehouse_x inside_warehouse_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_CRIMINAL1 inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber6_fm1
				SET_CHAR_THREAT_SEARCH clubber6_fm1 THREAT_GANG_HOOD
				SET_CHAR_PERSONALITY clubber6_fm1 PEDSTAT_TOUGH_GUY
				SET_CHAR_RUNNING clubber6_fm1 TRUE
				GIVE_WEAPON_TO_CHAR	clubber6_fm1 WEAPONTYPE_PISTOL 50
				SET_CHAR_OBJ_RUN_TO_COORD clubber6_fm1 outside_warehouse_x outside_warehouse_y
				clubbers_flee_flag = 6
			ENDIF
		ENDIF
	ENDIF
		
	IF clubbers_flee_flag = 6
		IF IS_CHAR_DEAD clubber6_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber6_fm1
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_FEMALE1 inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber7_fm1
			SET_CHAR_THREAT_SEARCH clubber7_fm1 THREAT_GANG_HOOD
			SET_CHAR_PERSONALITY clubber7_fm1 PEDSTAT_TOUGH_GUY
			GIVE_WEAPON_TO_CHAR	clubber7_fm1 WEAPONTYPE_PISTOL 50
			SET_CHAR_RUNNING clubber7_fm1 TRUE
			SET_CHAR_OBJ_RUN_TO_COORD clubber7_fm1 outside_warehouse_x outside_warehouse_y
			clubbers_flee_flag = 7
		ELSE
			IF NOT LOCATE_CHAR_ANY_MEANS_2D	clubber6_fm1 inside_warehouse_x inside_warehouse_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_FEMALE1 inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber7_fm1
				SET_CHAR_THREAT_SEARCH clubber7_fm1 THREAT_GANG_HOOD
				SET_CHAR_PERSONALITY clubber7_fm1 PEDSTAT_TOUGH_GUY
				GIVE_WEAPON_TO_CHAR	clubber7_fm1 WEAPONTYPE_PISTOL 50
				SET_CHAR_RUNNING clubber7_fm1 TRUE
				SET_CHAR_OBJ_RUN_TO_COORD clubber7_fm1 outside_warehouse_x outside_warehouse_y
				clubbers_flee_flag = 7
			ENDIF
		ENDIF
	ENDIF

	IF clubbers_flee_flag = 7	
		IF IS_CHAR_DEAD clubber7_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber7_fm1
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber8_fm1
			SET_CHAR_THREAT_SEARCH clubber8_fm1 THREAT_GANG_HOOD
			SET_CHAR_PERSONALITY clubber8_fm1 PEDSTAT_TOUGH_GUY
			SET_CHAR_RUNNING clubber8_fm1 TRUE
			GIVE_WEAPON_TO_CHAR	clubber8_fm1 WEAPONTYPE_PISTOL 50
			SET_CHAR_OBJ_RUN_TO_COORD clubber8_fm1 outside_warehouse_x outside_warehouse_y
			clubbers_flee_flag = 8
			clubber8_car3 = 1
		ELSE
			IF NOT LOCATE_CHAR_ANY_MEANS_2D	clubber7_fm1 inside_warehouse_x inside_warehouse_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A inside_warehouse_x inside_warehouse_y inside_warehouse_z clubber8_fm1
				SET_CHAR_THREAT_SEARCH clubber8_fm1 THREAT_GANG_HOOD
				SET_CHAR_PERSONALITY clubber8_fm1 PEDSTAT_TOUGH_GUY
				SET_CHAR_RUNNING clubber8_fm1 TRUE
				GIVE_WEAPON_TO_CHAR	clubber8_fm1 WEAPONTYPE_PISTOL 50
				SET_CHAR_OBJ_RUN_TO_COORD clubber8_fm1 outside_warehouse_x outside_warehouse_y
				clubbers_flee_flag = 8
				clubber8_car3 = 1
			ENDIF
		ENDIF	
	ENDIF

	IF clubbers_flee_flag = 8	
		IF IS_CHAR_DEAD clubber8_fm1
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber8_fm1
			IF swat_cam_needs_restoring = 1
				RESTORE_CAMERA_JUMPCUT
				SET_CAMERA_BEHIND_PLAYER
				SET_PLAYER_CONTROL player ON
				SET_EVERYONE_IGNORE_PLAYER player FALSE
				SWITCH_WIDESCREEN OFF
				SET_ALL_CARS_CAN_BE_DAMAGED TRUE
				SET_GENERATE_CARS_AROUND_CAMERA FALSE
				swat_cam_needs_restoring = 0
			ENDIF
			maria_exists = 1
			CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 inside_warehouse_x inside_warehouse_y inside_warehouse_z maria
			SET_ANIM_GROUP_FOR_CHAR	maria ANIM_SEXY_WOMANPED
			ADD_ARMOUR_TO_CHAR maria 100
			CLEAR_CHAR_THREAT_SEARCH maria
			REMOVE_BLIP	fm1_blip
			ADD_BLIP_FOR_CHAR maria fm1_blip
			PRINT_NOW FM1_5 4000 2 //"Get Maria out of there and back to Frankie's"
			ALTER_WANTED_LEVEL_NO_DROP player 2
			SET_CHAR_RUNNING maria TRUE
			GET_PLAYER_COORDINATES player chico_x chico_y chico_z
			SET_CHAR_OBJ_RUN_TO_COORD maria chico_x chico_y
			clubbers_flee_flag = 9
		ELSE
			IF NOT LOCATE_CHAR_ANY_MEANS_2D	clubber8_fm1 inside_warehouse_x inside_warehouse_y 2.0 2.0 0
				IF swat_cam_needs_restoring = 1
					RESTORE_CAMERA_JUMPCUT
					SET_CAMERA_BEHIND_PLAYER
					SET_PLAYER_CONTROL player ON
					SET_EVERYONE_IGNORE_PLAYER player FALSE
					SWITCH_WIDESCREEN OFF
					SET_ALL_CARS_CAN_BE_DAMAGED TRUE
					SET_GENERATE_CARS_AROUND_CAMERA FALSE
					swat_cam_needs_restoring = 0
				ENDIF
				maria_exists = 1
				CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 inside_warehouse_x inside_warehouse_y inside_warehouse_z maria
				SET_ANIM_GROUP_FOR_CHAR	maria ANIM_SEXY_WOMANPED
				ADD_ARMOUR_TO_CHAR maria 100
				CLEAR_CHAR_THREAT_SEARCH maria
				REMOVE_BLIP	fm1_blip
				ADD_BLIP_FOR_CHAR maria fm1_blip
				PRINT_NOW FM1_5 4000 2 //"Get Maria out of there and back to Frankie's"
				ALTER_WANTED_LEVEL_NO_DROP player 2
				SET_CHAR_RUNNING maria TRUE
				GET_PLAYER_COORDINATES player chico_x chico_y chico_z
				SET_CHAR_OBJ_RUN_TO_COORD maria chico_x chico_y
				clubbers_flee_flag = 9
			ENDIF
		ENDIF
	ENDIF

	IF clubbers_flee_flag = 9
		IF IS_CHAR_DEAD maria
			GOTO mission_frankie1_failed
		ELSE
			SET_CHAR_OBJ_GOTO_PLAYER_ON_FOOT maria player
			IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player maria 4.0 4.0 0
				SET_PLAYER_AS_LEADER maria player
				REMOVE_BLIP fm1_blip
				clubbers_flee_flag = 10
			ENDIF
		ENDIF
	ENDIF

	IF NOT clubber3_car1 = 3
	OR NOT clubber5_car2 = 3
	OR NOT clubber8_car3 = 3
		GOSUB clubbers_into_cars 
	ENDIF
	
	GOSUB police_idle_checks 

	GOSUB clubber_idle_checks 

	IF fuckup_flag = 2
		swat1_exit_car = 0
		swat2_exit_car = 0
		fuckup_flag = 3
	ENDIF

	IF swat1_exit_car = 0
		IF LOCATE_STOPPED_CAR_2D swatvan_fm1 1252.0 -1086.0 18.0 18.0 0
		
			IF chico_audio_flag = 21
				IF NOT IS_CHAR_DEAD	doorman1
					GET_CHAR_COORDINATES doorman1 chico_x chico_y chico_z
					SET_MISSION_AUDIO_POSITION chico_x chico_y chico_z
				ELSE
					MARK_CHAR_AS_NO_LONGER_NEEDED doorman1
					IF NOT IS_CHAR_DEAD	doorman2 
						GET_CHAR_COORDINATES doorman2 chico_x chico_y chico_z
						SET_MISSION_AUDIO_POSITION chico_x chico_y chico_z
					ELSE
						MARK_CHAR_AS_NO_LONGER_NEEDED doorman2
					ENDIF
				ENDIF
				PLAY_MISSION_AUDIO
				PRINT_NOW FM1_TT 5000 1//"IT'S A POLICE RAID! EVERYBODY FOR THEMSELVES!!"
				chico_audio_flag = 22
			ENDIF

			IF NOT IS_CHAR_DEAD	cop1_fm1
				SET_CHAR_OBJ_LEAVE_CAR cop1_fm1	swatvan_fm1
				SET_CHAR_HEED_THREATS cop1_fm1 TRUE
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED cop1_fm1
			ENDIF

			IF NOT IS_CHAR_DEAD	cop2_fm1
				SET_CHAR_OBJ_LEAVE_CAR cop2_fm1	swatvan_fm1
				SET_CHAR_HEED_THREATS cop2_fm1 TRUE
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED cop2_fm1
			ENDIF

			IF NOT IS_CHAR_DEAD	cop3_fm1
				SET_CHAR_OBJ_LEAVE_CAR cop3_fm1	swatvan_fm1
				SET_CHAR_HEED_THREATS cop3_fm1 TRUE
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED cop3_fm1
			ENDIF

			IF NOT IS_CHAR_DEAD	cop4_fm1
				SET_CHAR_OBJ_LEAVE_CAR cop4_fm1	swatvan_fm1
				SET_CHAR_HEED_THREATS cop4_fm1 TRUE
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED cop4_fm1
			ENDIF
			
			IF NOT IS_CHAR_DEAD doorman2
			AND NOT IS_CHAR_DEAD cop1_fm1
				SET_CHAR_OBJ_KILL_CHAR_ON_FOOT doorman2 cop1_fm1
			ENDIF
			swat1_exit_car = 1
		ENDIF
	ENDIF

	IF swat2_exit_car = 0
		IF LOCATE_STOPPED_CAR_2D swatvan2_fm1 1235.0 -1099.0 18.0 18.0 0
		
			IF chico_audio_flag = 21
				IF NOT IS_CHAR_DEAD	doorman1
					GET_CHAR_COORDINATES doorman1 chico_x chico_y chico_z
					SET_MISSION_AUDIO_POSITION chico_x chico_y chico_z
				ELSE
					MARK_CHAR_AS_NO_LONGER_NEEDED doorman1
					IF NOT IS_CHAR_DEAD	doorman2 
						GET_CHAR_COORDINATES doorman2 chico_x chico_y chico_z
						SET_MISSION_AUDIO_POSITION chico_x chico_y chico_z
					ELSE
						MARK_CHAR_AS_NO_LONGER_NEEDED doorman2
					ENDIF
				ENDIF
				PLAY_MISSION_AUDIO
				PRINT_NOW FM1_TT 5000 1//"IT'S A POLICE RAID! EVERYBODY FOR THEMSELVES!!"
				chico_audio_flag = 22
			ENDIF

			IF NOT IS_CHAR_DEAD	cop5_fm1
				SET_CHAR_OBJ_LEAVE_CAR cop5_fm1	swatvan2_fm1
				SET_CHAR_HEED_THREATS cop5_fm1 TRUE
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED cop5_fm1
			ENDIF

			IF NOT IS_CHAR_DEAD	cop6_fm1
				SET_CHAR_OBJ_LEAVE_CAR cop6_fm1	swatvan2_fm1
				SET_CHAR_HEED_THREATS cop6_fm1 TRUE
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED cop6_fm1
			ENDIF

			IF NOT IS_CHAR_DEAD	cop7_fm1
				SET_CHAR_OBJ_LEAVE_CAR cop7_fm1	swatvan2_fm1
				SET_CHAR_HEED_THREATS cop7_fm1 TRUE
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED cop7_fm1
			ENDIF

			IF NOT IS_CHAR_DEAD	cop8_fm1
				SET_CHAR_OBJ_LEAVE_CAR cop8_fm1	swatvan2_fm1
				SET_CHAR_HEED_THREATS cop8_fm1 TRUE
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED cop8_fm1
			ENDIF
			
			IF NOT IS_CHAR_DEAD doorman1
			AND NOT IS_CHAR_DEAD cop5_fm1
				SET_CHAR_OBJ_KILL_CHAR_ON_FOOT doorman1 cop5_fm1
			ENDIF
			swat2_exit_car = 1
		ENDIF
	ENDIF

ENDWHILE

MARK_CAR_AS_NO_LONGER_NEEDED swatvan_fm1
MARK_CAR_AS_NO_LONGER_NEEDED swatvan2_fm1

WHILE NOT IS_CHAR_IN_ANY_CAR maria //frankies_limo
	
	WAIT 0
	
	GOSUB draw_disco_lights
	
	IF chico_audio_flag = 23
		IF HAS_MISSION_AUDIO_LOADED
			chico_audio_flag = 24
		ENDIF
	ENDIF
	
	IF chico_audio_flag = 22
		IF HAS_MISSION_AUDIO_FINISHED
			LOAD_MISSION_AUDIO S1_J
			chico_audio_flag = 23
		ENDIF
	ENDIF
	
	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	IF NOT IS_CHAR_IN_PLAYERS_GROUP maria player
	AND flag_blip_on_maria = 0
		PRINT_NOW FM1_10 5000 1 //"Hey wait for me!"
		REMOVE_BLIP fm1_blip
		ADD_BLIP_FOR_CHAR maria fm1_blip
		flag_blip_on_maria = 1
	ENDIF

	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player maria 8.0 8.0 FALSE
	AND flag_blip_on_maria = 1
		SET_PLAYER_AS_LEADER maria player
		REMOVE_BLIP fm1_blip
		ADD_BLIP_FOR_COORD 1424.0 -183.5 50.0 fm1_blip
		flag_blip_on_maria = 0
	ENDIF

	IF flag_blip_on_maria = 0
		IF NOT IS_PLAYER_IN_CAR player frankies_limo
		AND flag_blip_on_limo = 0
			REMOVE_BLIP fm1_blip
			ADD_BLIP_FOR_CAR frankies_limo fm1_blip
			PRINT_NOW (FM1_1) 5000 1 //"Get back into the limo!"
			flag_blip_on_limo = 1
		ENDIF
		
		IF IS_PLAYER_IN_CAR player frankies_limo
		AND flag_blip_on_limo = 1
			REMOVE_BLIP fm1_blip
			ADD_BLIP_FOR_CHAR maria fm1_blip
			flag_blip_on_limo = 0
		ENDIF
	ENDIF

//	IF NOT IS_PLAYER_IN_CAR player frankies_limo
//	AND flag_blip_on_limo = 0
//		REMOVE_BLIP fm1_blip
//		ADD_BLIP_FOR_CAR frankies_limo fm1_blip
//		PRINT_NOW (FM1_1) 5000 1 //"Get back into the limo!"
//		flag_blip_on_limo = 1
//	ENDIF
//	
//	IF IS_PLAYER_IN_CAR player frankies_limo
//	AND flag_blip_on_limo = 1
//		REMOVE_BLIP fm1_blip
//		ADD_BLIP_FOR_CHAR maria fm1_blip//COORD 1424.0 -183.5 50.0 fm1_blip
//		flag_blip_on_limo = 0
//	ENDIF

	IF NOT clubber3_car1 = 3
	OR NOT clubber5_car2 = 3
	OR NOT clubber8_car3 = 3
		GOSUB clubbers_into_cars 
	ENDIF

	GOSUB police_idle_checks 
	
	GOSUB clubber_idle_checks 

ENDWHILE

REMOVE_BLIP	fm1_blip
flag_blip_on_maria = 0
flag_blip_on_limo = 0
ADD_BLIP_FOR_COORD 1424.0 -183.5 50.0 fm1_blip

WAIT 0

IF NOT chico_audio_flag = 24
	WHILE NOT HAS_MISSION_AUDIO_LOADED
		
		WAIT 0
		
		GOSUB draw_disco_lights
		
		IF NOT clubber3_car1 = 3
		OR NOT clubber5_car2 = 3
		OR NOT clubber8_car3 = 3
			GOSUB clubbers_into_cars 
		ENDIF

		GOSUB police_idle_checks 
		
		GOSUB clubber_idle_checks 

		IF IS_CHAR_DEAD maria
			PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
			GOTO mission_frankie1_failed
		ENDIF

		IF IS_CAR_DEAD frankies_limo
			PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
			GOTO mission_frankie1_failed
		ENDIF

		IF NOT IS_CHAR_IN_PLAYERS_GROUP maria player
		AND flag_blip_on_maria = 0
			PRINT_NOW FM1_10 5000 1 //"Hey wait for me!"
			REMOVE_BLIP fm1_blip
			ADD_BLIP_FOR_CHAR maria fm1_blip
			flag_blip_on_maria = 1
		ENDIF

		IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player maria 8.0 8.0 FALSE
		AND flag_blip_on_maria = 1
			SET_PLAYER_AS_LEADER maria player
			REMOVE_BLIP fm1_blip
			ADD_BLIP_FOR_COORD 1424.0 -183.5 50.0 fm1_blip
			flag_blip_on_maria = 0
		ENDIF

		IF flag_blip_on_maria = 0
			IF NOT IS_PLAYER_IN_CAR player frankies_limo
			AND flag_blip_on_limo = 0
				REMOVE_BLIP fm1_blip
				ADD_BLIP_FOR_CAR frankies_limo fm1_blip
				PRINT_NOW (FM1_1) 5000 1 //"Get back into the limo!"
				flag_blip_on_limo = 1
			ENDIF
			
			IF IS_PLAYER_IN_CAR player frankies_limo
			AND flag_blip_on_limo = 1
				REMOVE_BLIP fm1_blip
				ADD_BLIP_FOR_COORD 1424.0 -183.5 50.0 fm1_blip
				flag_blip_on_limo = 0
			ENDIF
		ENDIF

		GOSUB police_idle_checks 

		GOSUB clubber_idle_checks 

	ENDWHILE
	chico_audio_flag = 24
ENDIF

PLAY_MISSION_AUDIO
PRINT_NOW FM1_X 5000 1 //"OK Fido, let's get out of here. YeeEEHAAA"

CHANGE_GARAGE_TYPE frankie_garage GARAGE_MISSION_KEEPCAR_REMAINCLOSED

IF NOT IS_CAR_DEAD frankies_limo
	SET_TARGET_CAR_FOR_MISSION_GARAGE frankie_garage frankies_limo
ENDIF

//WHILE NOT LOCATE_PLAYER_IN_CAR_2D player 1424.0 -183.5 10.0 10.0 0
//WHILE NOT IS_PLAYER_STOPPED_IN_AREA_3D player 1428.8 -187.0 50.0 1442.5 -179.9 53.0 0
WHILE NOT IS_CAR_IN_MISSION_GARAGE frankie_garage

	WAIT 0

	GOSUB draw_disco_lights
	
	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF IS_CAR_DEAD frankies_limo
		PRINT_NOW WRECKED 5000 1 // "The vehicle is wrecked!"
		GOTO mission_frankie1_failed
	ENDIF

	IF LOCATE_CAR_2D frankies_limo 1424.8 -183.0 20.0 20.0 0
		CLEAR_WANTED_LEVEL player
	ENDIF

	IF NOT IS_CHAR_IN_PLAYERS_GROUP maria player
	AND flag_blip_on_maria = 0
		PRINT_NOW FM1_10 5000 1 //"Hey wait for me!"
		REMOVE_BLIP fm1_blip
		ADD_BLIP_FOR_CHAR maria fm1_blip
		flag_blip_on_maria = 1
	ENDIF

	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player maria 8.0 8.0 FALSE
	AND flag_blip_on_maria = 1
		SET_PLAYER_AS_LEADER maria player
		REMOVE_BLIP fm1_blip
		ADD_BLIP_FOR_COORD 1424.0 -183.5 50.0 fm1_blip
		flag_blip_on_limo = 0
		flag_blip_on_maria = 0
	ENDIF

	IF flag_blip_on_maria = 0
		IF NOT IS_PLAYER_IN_CAR player frankies_limo
		AND flag_blip_on_limo = 0
			REMOVE_BLIP fm1_blip
			ADD_BLIP_FOR_CAR frankies_limo fm1_blip
			PRINT_NOW (FM1_1) 5000 1 //"Get back into the limo!"
			flag_blip_on_limo = 1
		ENDIF
		
		IF IS_PLAYER_IN_CAR player frankies_limo
		AND flag_blip_on_limo = 1
			REMOVE_BLIP fm1_blip
			ADD_BLIP_FOR_COORD 1424.0 -183.5 50.0 fm1_blip
			flag_blip_on_limo = 0
		ENDIF
	ENDIF

	IF NOT clubber3_car1 = 3
	OR NOT clubber5_car2 = 3
	OR NOT clubber8_car3 = 3 
		GOSUB clubbers_into_cars 
	ENDIF

	GOSUB police_idle_checks 

	GOSUB clubber_idle_checks 

ENDWHILE

CLEAR_WANTED_LEVEL player 

DO_FADE 500	FADE_OUT

WAIT 500

SET_PLAYER_CONTROL player OFF
SWITCH_WIDESCREEN ON
SET_EVERYONE_IGNORE_PLAYER player TRUE
SET_ALL_CARS_CAN_BE_DAMAGED FALSE

IF IS_CHAR_DEAD maria
	PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
	GOTO mission_frankie1_failed
ENDIF

LEAVE_GROUP maria

CLEAR_WANTED_LEVEL player

WARP_PLAYER_FROM_CAR_TO_COORD player 1435.7676 -176.4341 52.2953
SET_PLAYER_HEADING player 184.9588
maria_exists = 0
DELETE_CHAR maria
CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 1435.9358 -178.4347 54.0279 maria
maria_exists = 1
SET_CHAR_HEADING maria 184.9134

GET_PLAYER_CHAR player script_controlled_player

CLEAR_CHAR_THREAT_SEARCH maria
CLEAR_CHAR_THREAT_SEARCH script_controlled_player

SET_FIXED_CAMERA_POSITION 1433.4507 -173.6104 55.66595 0.0 0.0 0.0
POINT_CAMERA_AT_CHAR maria FIXED JUMP_CUT

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT maria 1436.2628 -180.6451
SET_CHAR_OBJ_GOTO_COORD_ON_FOOT script_controlled_player 1436.2628 -180.6451

DELETE_CAR frankies_limo

CLEAR_AREA 1423.9675 -189.2235 49.2032 5.0 FALSE

DO_FADE 500 FADE_IN

LOAD_MISSION_AUDIO S1_K

//camera 1433.4507 -173.6104 56.66595
//point at maria maybe 1433.9979 -174.4381 56.542


//chat
//maria goto 1453.5276 -179.3224
//player goto 1443.6184 -188.2894

flag_blip_on_maria = 0
skip_cutscene_flag = 0
WHILE NOT flag_blip_on_maria = 8
	
	WAIT 0

	IF IS_CHAR_DEAD maria
		PRINT_NOW FM1_7 5000 1 // "You failed to protect Maria!"
		GOTO mission_frankie1_failed
	ENDIF

	IF skip_cutscene_flag = 0
		IF NOT IS_BUTTON_PRESSED PAD1 CROSS
			skip_cutscene_flag = 1
		ENDIF
	ENDIF

	IF skip_cutscene_flag = 1
		IF IS_BUTTON_PRESSED PAD1 CROSS
			skip_cutscene_flag = 2
		ENDIF
	ENDIF
	
	IF skip_cutscene_flag = 2
		IF NOT IS_BUTTON_PRESSED PAD1 CROSS
			DO_FADE 0 FADE_OUT
			WAIT 0
			CLEAR_MISSION_AUDIO
			CLEAR_SMALL_PRINTS
			SWITCH_WIDESCREEN OFF
			SET_PLAYER_CONTROL player ON
			SET_EVERYONE_IGNORE_PLAYER player FALSE
			SET_ALL_CARS_CAN_BE_DAMAGED TRUE
			DELETE_CHAR maria
			SET_PLAYER_COORDINATES player 1443.6184 -188.2894 55.0
			SET_PLAYER_HEADING player 180.0
			SET_CAMERA_BEHIND_PLAYER
			RESTORE_CAMERA_JUMPCUT
			DO_FADE 500 FADE_IN
			skip_cutscene_flag = 3
			GOTO mission_frankie1_passed
		ENDIF
	ENDIF

	IF flag_blip_on_maria = 7
		IF LOCATE_PLAYER_ANY_MEANS_2D player 1443.6184 -188.2894 1.0 1.0 0
			IF NOT IS_CHAR_ON_SCREEN maria
				maria_exists = 0
				DELETE_CHAR	maria
				flag_blip_on_maria = 8
			ENDIF
		ENDIF
	ENDIF

	IF flag_blip_on_maria = 6
		IF HAS_MISSION_AUDIO_FINISHED
			CLEAR_SMALL_PRINTS
			SET_CHAR_WAIT_STATE maria WAITSTATE_FALSE 100
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	script_controlled_player 1443.6184 -188.2894
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	maria 1453.5276 -179.3224
			flag_blip_on_maria = 7
		ENDIF
	ENDIF

	IF flag_blip_on_maria = 5
		IF HAS_MISSION_AUDIO_LOADED
			GET_CHAR_COORDINATES maria chico_x chico_y chico_z
			PLAY_MISSION_AUDIO
			PRINT_NOW FM1_AA 8000 1	//"I'd better go I'll see you around I hope."
			flag_blip_on_maria = 6
		ENDIF
	ENDIF

	IF flag_blip_on_maria = 4
		IF HAS_MISSION_AUDIO_FINISHED
			TURN_CHAR_TO_FACE_CHAR script_controlled_player maria
			TURN_CHAR_TO_FACE_CHAR maria script_controlled_player
			LOAD_MISSION_AUDIO S1_L
			flag_blip_on_maria = 5
		ENDIF
	ENDIF

	IF flag_blip_on_maria = 3
		IF HAS_MISSION_AUDIO_LOADED
			TURN_CHAR_TO_FACE_CHAR script_controlled_player maria
			TURN_CHAR_TO_FACE_CHAR maria script_controlled_player
			GET_CHAR_COORDINATES maria chico_x chico_y chico_z
			PLAY_MISSION_AUDIO
			PRINT_NOW FM1_Y 8000 1	//"I enjoyed myself for the first time in a long while,"
			SET_CHAR_WAIT_STATE maria WAITSTATE_PLAYANIM_CHAT 20000
			flag_blip_on_maria = 4
		ENDIF
	ENDIF

	IF flag_blip_on_maria = 2
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D maria 1440.5144 -179.1538 1.0 1.0 0
			GET_CHAR_HEADING maria swat1_stuck_x
			swat1_stuck_x -= 3.0
			IF swat1_stuck_x < 0.0
				swat1_stuck_x = 359.0
			ENDIF
			IF swat1_stuck_x < 180.0
				swat1_stuck_x = 180.0
			ENDIF
			SET_CHAR_HEADING maria swat1_stuck_x
			CHAR_LOOK_AT_PLAYER_ALWAYS maria player
			IF LOCATE_STOPPED_PLAYER_ON_FOOT_2D player 1440.6287 -181.4022 1.0 1.0 0
				STOP_CHAR_LOOKING maria
				SET_FIXED_CAMERA_POSITION 1442.1001 -173.1516 55.8166 0.0 0.0 0.0
				POINT_CAMERA_AT_POINT 1441.78 -174.0602 55.6919 JUMP_CUT
				SET_PLAYER_HEADING player 0.0
				TURN_CHAR_TO_FACE_CHAR script_controlled_player maria
				TURN_PLAYER_TO_FACE_CHAR player maria
				TURN_CHAR_TO_FACE_CHAR maria script_controlled_player
				flag_blip_on_maria = 3
			ENDIF
		ENDIF
	ENDIF			

	IF flag_blip_on_maria = 1
		IF LOCATE_PLAYER_ON_FOOT_2D player 1436.2628 -180.6451 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	script_controlled_player 1440.6287 -181.4022
			flag_blip_on_maria = 2
		ENDIF
	ENDIF

	IF flag_blip_on_maria = 0
		IF LOCATE_CHAR_ON_FOOT_2D maria 1436.2628 -180.6451 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	maria 1440.5144 -179.1538
			flag_blip_on_maria = 1
		ENDIF
	ENDIF

ENDWHILE

SET_CAMERA_BEHIND_PLAYER
RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN OFF
SET_PLAYER_CONTROL player ON
SET_EVERYONE_IGNORE_PLAYER player FALSE
SET_ALL_CARS_CAN_BE_DAMAGED TRUE

GOTO mission_frankie1_passed
}	   		
	

// Mission Frankie1 failed
mission_frankie1_failed:

PRINT_BIG ( m_fail ) 5000 1
RETURN
   

// mission Frankie1 passed
mission_frankie1_passed:

flag_frankie_mission1_passed = 1
IF flag_luigi_mission4_terminated = 1
START_NEW_SCRIPT luigi_mission4_loop
	REMOVE_BLIP luigi_contact_blip
	ADD_SPRITE_BLIP_FOR_CONTACT_POINT 892.8 -425.8 13.9 RADAR_SPRITE_LUIGI luigi_contact_blip
//	ADD_SPRITE_BLIP_FOR_CONTACT_POINT 886.2 -417.1 -100.0 RADAR_SPRITE_LUIGI luigi_contact_blip
ENDIF
IF flag_luigi_mission5_terminated = 1
	START_NEW_SCRIPT luigi_mission5_loop
	REMOVE_BLIP	luigi_contact_blip
	ADD_SPRITE_BLIP_FOR_CONTACT_POINT 886.2 -417.1 -100.0 RADAR_SPRITE_LUIGI luigi_contact_blip
ENDIF
IF flag_joey_mission5_terminated = 1
	START_NEW_SCRIPT joey_mission5_loop
	REMOVE_BLIP	joey_contact_blip
	ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1191.7 -870.0 -100.0 RADAR_SPRITE_JOEY joey_contact_blip
ENDIF
IF flag_joey_mission6_terminated = 1
START_NEW_SCRIPT joey_mission6_loop
	REMOVE_BLIP	joey_contact_blip
	ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1191.7 -870.0 -100.0 RADAR_SPRITE_JOEY joey_contact_blip
ENDIF
PRINT_WITH_NUMBER_BIG m_pass 10000 5000 1
ADD_SCORE player 10000
CLEAR_WANTED_LEVEL player
PLAY_MISSION_PASSED_TUNE 1
REGISTER_MISSION_PASSED	FM1
PLAYER_MADE_PROGRESS 1
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1219.6 -321.0 26.4 RADAR_SPRITE_TONY toni_contact_blip
START_NEW_SCRIPT toni_mission4_loop 
START_NEW_SCRIPT frankie_mission2_loop
START_NEW_SCRIPT imp_exp_pager
RETURN
		


// mission cleanup
mission_cleanup_frankie1:

flag_player_on_mission = 0
flag_player_on_frankie_mission = 0

RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN OFF
SET_PLAYER_CONTROL player ON

IF add_sound_flag = 1
	REMOVE_SOUND warehouse_rave_loop
ENDIF

REMOVE_PARTICLE_EFFECTS_IN_AREA 1264.0 -1111.0 5.0 1275.0 -1103.0 15.0

MARK_MODEL_AS_NO_LONGER_NEEDED PED_CRIMINAL1
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STRETCH
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_A
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SENTINEL
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_CHEETAH
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_MANANA
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_ENFORCER
MARK_MODEL_AS_NO_LONGER_NEEDED PED_SWAT
MARK_MODEL_AS_NO_LONGER_NEEDED PED_P_MAN1
MARK_MODEL_AS_NO_LONGER_NEEDED PED_FEMALE1
MARK_MODEL_AS_NO_LONGER_NEEDED PED_FEMALE2

REMOVE_BLIP fm1_blip

CHANGE_GARAGE_TYPE frankie_garage GARAGE_MISSION_KEEPCAR
SET_TARGET_CAR_FOR_MISSION_GARAGE frankie_garage -1
						 
UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2

MISSION_HAS_FINISHED
RETURN
		
/////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////// Functions ///////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////

clubbers_into_cars://////////////////////////////////////////////////////////////////////////////////

IF clubbers_flee_flag > 2
	IF clubber3_car1 = 1
		IF NOT IS_CHAR_DEAD clubber3_fm1
			IF LOCATE_CHAR_ON_FOOT_2D clubber3_fm1 outside_warehouse_x outside_warehouse_y 3.0 3.0 0
				IF IS_CAR_STILL_ALIVE parked_car1
					IF LOCATE_CAR_2D parked_car1 1243.0 -1112.0 8.0 8.0 0
						SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER clubber3_fm1 parked_car1
						clubber3_car1 = 2
					ELSE
						SET_CHAR_HEED_THREATS clubber3_fm1 TRUE
						MARK_CAR_AS_NO_LONGER_NEEDED parked_car1
						MARK_CHAR_AS_NO_LONGER_NEEDED clubber3_fm1
						clubber3_car1 = 3
					ENDIF
				ELSE
					SET_CHAR_HEED_THREATS clubber3_fm1 TRUE
					MARK_CAR_AS_NO_LONGER_NEEDED parked_car1
					MARK_CHAR_AS_NO_LONGER_NEEDED clubber3_fm1
					clubber3_car1 = 3
				ENDIF
			ENDIF
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber3_fm1
			MARK_CAR_AS_NO_LONGER_NEEDED parked_car1
			clubber3_car1 = 3
		ENDIF
	ENDIF
	
	IF clubber3_car1 = 2
		IF NOT IS_CHAR_DEAD clubber3_fm1
			IF NOT IS_CAR_DEAD parked_car1
				IF IS_CHAR_IN_CAR clubber3_fm1 parked_car1
					SET_CAR_DRIVING_STYLE parked_car1 2
					SET_CAR_CRUISE_SPEED parked_car1 100.0
					CAR_WANDER_RANDOMLY	parked_car1
					SET_CAR_AVOID_LEVEL_TRANSITIONS parked_car1 TRUE
					MARK_CAR_AS_NO_LONGER_NEEDED parked_car1
//					MARK_CHAR_AS_NO_LONGER_NEEDED clubber3_fm1
					clubber3_car1 = 3
				ENDIF
			ELSE
				SET_CHAR_HEED_THREATS clubber3_fm1 TRUE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber3_fm1
				MARK_CAR_AS_NO_LONGER_NEEDED parked_car1
				clubber3_car1 = 3
			ENDIF
		ELSE
			MARK_CAR_AS_NO_LONGER_NEEDED parked_car1
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber3_fm1
			clubber3_car1 = 3
		ENDIF
	ENDIF
ENDIF

IF clubbers_flee_flag > 4
	IF clubber5_car2 = 1
		IF NOT IS_CHAR_DEAD clubber5_fm1
			IF LOCATE_CHAR_ON_FOOT_2D clubber5_fm1 outside_warehouse_x outside_warehouse_y 3.0 3.0 0
				IF IS_CAR_STILL_ALIVE parked_car2
					IF LOCATE_CAR_2D parked_car2 1243.0 -1112.0 8.0 8.0 0
						SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER clubber5_fm1 parked_car2
						clubber5_car2 = 2
					ELSE
						SET_CHAR_HEED_THREATS clubber5_fm1 TRUE
						MARK_CHAR_AS_NO_LONGER_NEEDED clubber5_fm1
						MARK_CAR_AS_NO_LONGER_NEEDED parked_car2
						clubber5_car2 = 3
					ENDIF
				ELSE
					SET_CHAR_HEED_THREATS clubber5_fm1 TRUE
					MARK_CHAR_AS_NO_LONGER_NEEDED clubber5_fm1
					MARK_CAR_AS_NO_LONGER_NEEDED parked_car2
					clubber5_car2 = 3
				ENDIF
			ENDIF
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber5_fm1
			MARK_CAR_AS_NO_LONGER_NEEDED parked_car2
			clubber5_car2 = 3
		ENDIF
	ENDIF
	
	IF clubber5_car2 = 2
		IF NOT IS_CHAR_DEAD clubber5_fm1
			IF NOT IS_CAR_DEAD parked_car2
				IF IS_CHAR_IN_CAR clubber5_fm1 parked_car2
					SET_CAR_DRIVING_STYLE parked_car2 2
					SET_CAR_CRUISE_SPEED parked_car2 100.0
					CAR_WANDER_RANDOMLY	parked_car2
					SET_CAR_AVOID_LEVEL_TRANSITIONS parked_car2 TRUE
					MARK_CAR_AS_NO_LONGER_NEEDED parked_car2
//					MARK_CHAR_AS_NO_LONGER_NEEDED clubber5_fm1
					clubber5_car2 = 3
				ENDIF
			ELSE
				SET_CHAR_HEED_THREATS clubber5_fm1 TRUE
				MARK_CAR_AS_NO_LONGER_NEEDED parked_car2
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber5_fm1
				clubber5_car2 = 3
			ENDIF
		ELSE
			MARK_CAR_AS_NO_LONGER_NEEDED parked_car2
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber5_fm1
			clubber5_car2 = 3
		ENDIF
	ENDIF
ENDIF

IF clubbers_flee_flag > 7
	IF clubber8_car3 = 1
		IF NOT IS_CHAR_DEAD clubber8_fm1
			IF LOCATE_CHAR_ON_FOOT_2D clubber8_fm1 outside_warehouse_x outside_warehouse_y 3.0 3.0 0
				IF IS_CAR_STILL_ALIVE parked_car3
					IF LOCATE_CAR_2D parked_car3 1243.0 -1112.0 8.0 8.0 0
						SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER clubber8_fm1 parked_car3
						clubber8_car3 = 2
					ELSE
						SET_CHAR_HEED_THREATS clubber8_fm1 TRUE
						MARK_CHAR_AS_NO_LONGER_NEEDED clubber8_fm1
						MARK_CAR_AS_NO_LONGER_NEEDED parked_car3
						clubber8_car3 = 3
					ENDIF
				ELSE
					SET_CHAR_HEED_THREATS clubber8_fm1 TRUE
					MARK_CHAR_AS_NO_LONGER_NEEDED clubber8_fm1
					MARK_CAR_AS_NO_LONGER_NEEDED parked_car3
					clubber8_car3 = 3
				ENDIF
			ENDIF
		ELSE
			MARK_CAR_AS_NO_LONGER_NEEDED parked_car3
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber8_fm1
			clubber8_car3 = 3
		ENDIF
	ENDIF
	
	IF clubber8_car3 = 2
		IF NOT IS_CHAR_DEAD clubber8_fm1
			IF NOT IS_CAR_DEAD parked_car3
				IF IS_CHAR_IN_CAR clubber8_fm1 parked_car3
					SET_CAR_DRIVING_STYLE parked_car3 2
					SET_CAR_CRUISE_SPEED parked_car3 100.0
					CAR_WANDER_RANDOMLY	parked_car3
					SET_CAR_AVOID_LEVEL_TRANSITIONS parked_car3 TRUE
					MARK_CAR_AS_NO_LONGER_NEEDED parked_car3
//					MARK_CHAR_AS_NO_LONGER_NEEDED clubber8_fm1
					clubber8_car3 = 3
				ENDIF
			ELSE
				SET_CHAR_HEED_THREATS clubber8_fm1 TRUE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber8_fm1
				MARK_CAR_AS_NO_LONGER_NEEDED parked_car3
				clubber8_car3 = 3
			ENDIF
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber8_fm1
			MARK_CAR_AS_NO_LONGER_NEEDED parked_car3
			clubber8_car3 = 3
		ENDIF
	ENDIF
ENDIF

RETURN



clubber_idle_checks://////////////////////////////////////////////////////////////////////////////////

	IF IS_CHAR_DEAD	cop1_fm1
	AND IS_CHAR_DEAD cop2_fm1
	AND IS_CHAR_DEAD cop3_fm1
	AND IS_CHAR_DEAD cop4_fm1
	AND IS_CHAR_DEAD cop5_fm1
	AND IS_CHAR_DEAD cop6_fm1
		IF IS_CHAR_DEAD cop7_fm1
		AND IS_CHAR_DEAD cop8_fm1
			IF NOT IS_CHAR_DEAD	clubber1_fm1
				SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS	clubber1_fm1 player
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber1_fm1
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber1_fm1
			ENDIF
			IF NOT IS_CHAR_DEAD	clubber2_fm1
				CHAR_WANDER_DIR clubber2_fm1 -1
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber2_fm1
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber2_fm1
			ENDIF
			IF NOT IS_CHAR_DEAD	clubber4_fm1
				SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS	clubber4_fm1 player
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber4_fm1
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber4_fm1
			ENDIF
			IF NOT IS_CHAR_DEAD	clubber6_fm1
				CHAR_WANDER_DIR clubber6_fm1 -1
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber6_fm1
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber6_fm1
			ENDIF
			IF NOT IS_CHAR_DEAD	clubber7_fm1
				SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS	clubber7_fm1 player
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber7_fm1
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber7_fm1
			ENDIF
		ELSE
			IF NOT IS_CHAR_DEAD	clubber1_fm1
				IF IS_CHAR_STOPPED clubber1_fm1
					IF NOT IS_CHAR_SHOOTING clubber1_fm1
						CHAR_WANDER_DIR clubber1_fm1 -1
					ENDIF
				ENDIF
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber1_fm1
			ENDIF
			IF NOT IS_CHAR_DEAD	clubber2_fm1
				IF IS_CHAR_STOPPED clubber2_fm1
					IF NOT IS_CHAR_SHOOTING clubber2_fm1
						SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS	clubber2_fm1 player
					ENDIF
				ENDIF
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber2_fm1
			ENDIF
			IF NOT IS_CHAR_DEAD	clubber4_fm1
				IF IS_CHAR_STOPPED clubber4_fm1
					IF NOT IS_CHAR_SHOOTING clubber4_fm1
						CHAR_WANDER_DIR clubber4_fm1 -1
					ENDIF
				ENDIF
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber4_fm1
			ENDIF
			IF NOT IS_CHAR_DEAD	clubber6_fm1
				IF IS_CHAR_STOPPED clubber6_fm1
					IF NOT IS_CHAR_SHOOTING clubber6_fm1
						SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS	clubber6_fm1 player
					ENDIF
				ENDIF
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber6_fm1
			ENDIF
			IF NOT IS_CHAR_DEAD	clubber7_fm1
				IF IS_CHAR_STOPPED clubber7_fm1
					IF NOT IS_CHAR_SHOOTING clubber7_fm1
						CHAR_WANDER_DIR clubber7_fm1 -1
					ENDIF
				ENDIF
			ELSE
				MARK_CHAR_AS_NO_LONGER_NEEDED clubber7_fm1
			ENDIF
		ENDIF
	ELSE
		IF NOT IS_CHAR_DEAD	clubber1_fm1
			IF IS_CHAR_STOPPED clubber1_fm1
				IF NOT IS_CHAR_SHOOTING clubber1_fm1
					CHAR_WANDER_DIR clubber1_fm1 -1
				ENDIF
			ENDIF
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber1_fm1
		ENDIF
		IF NOT IS_CHAR_DEAD	clubber2_fm1
			IF IS_CHAR_STOPPED clubber2_fm1
				IF NOT IS_CHAR_SHOOTING clubber2_fm1
					SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS	clubber2_fm1 player
				ENDIF
			ENDIF
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber2_fm1
		ENDIF
		IF NOT IS_CHAR_DEAD	clubber4_fm1
			IF IS_CHAR_STOPPED clubber4_fm1
				IF NOT IS_CHAR_SHOOTING clubber4_fm1
					CHAR_WANDER_DIR clubber4_fm1 -1
				ENDIF
			ENDIF
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber4_fm1
		ENDIF
		IF NOT IS_CHAR_DEAD	clubber6_fm1
			IF IS_CHAR_STOPPED clubber6_fm1
				IF NOT IS_CHAR_SHOOTING clubber6_fm1
					SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS	clubber6_fm1 player
				ENDIF
			ENDIF
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber6_fm1
		ENDIF
		IF NOT IS_CHAR_DEAD	clubber7_fm1
			IF IS_CHAR_STOPPED clubber7_fm1
				IF NOT IS_CHAR_SHOOTING clubber7_fm1
					CHAR_WANDER_DIR clubber7_fm1 -1
				ENDIF
			ENDIF
		ELSE
			MARK_CHAR_AS_NO_LONGER_NEEDED clubber7_fm1
		ENDIF
	ENDIF

RETURN



police_idle_checks:///////////////////////////////////////////////////////////////////////////////////

	IF NOT IS_CHAR_DEAD	cop1_fm1
		SET_CHAR_SAY cop1_fm1 SOUND_SWAT_PED_SHOUT
		IF IS_CHAR_STOPPED cop1_fm1
			IF NOT IS_CHAR_SHOOTING cop1_fm1
				IF NOT IS_CHAR_DEAD clubber1_fm1
					SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop1_fm1 clubber1_fm1
				ELSE
					IF NOT IS_CHAR_DEAD clubber2_fm1
						SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop1_fm1 clubber2_fm1
					ELSE
						IF NOT IS_CHAR_DEAD clubber4_fm1
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop1_fm1 clubber4_fm1
						ELSE
							IF NOT IS_CHAR_DEAD clubber6_fm1
								SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop1_fm1 clubber6_fm1
							ELSE
								IF NOT IS_CHAR_DEAD clubber7_fm1
									SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop1_fm1 clubber7_fm1
								ELSE
									SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cop1_fm1 player
									MARK_CHAR_AS_NO_LONGER_NEEDED cop1_fm1
								ENDIF
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ELSE
		MARK_CHAR_AS_NO_LONGER_NEEDED cop1_fm1
	ENDIF
	
	IF NOT IS_CHAR_DEAD	cop2_fm1
		SET_CHAR_SAY cop2_fm1 SOUND_SWAT_PED_SHOUT
		IF IS_CHAR_STOPPED cop2_fm1
			IF NOT IS_CHAR_SHOOTING cop2_fm1
				IF NOT IS_CHAR_DEAD clubber7_fm1
					SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop2_fm1 clubber7_fm1
				ELSE
					IF NOT IS_CHAR_DEAD clubber4_fm1
						SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop2_fm1 clubber4_fm1
					ELSE
						IF NOT IS_CHAR_DEAD clubber6_fm1
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop2_fm1 clubber6_fm1
						ELSE
							IF NOT IS_CHAR_DEAD clubber2_fm1
								SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop2_fm1 clubber2_fm1
							ELSE
								IF NOT IS_CHAR_DEAD clubber1_fm1
									SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop2_fm1 clubber1_fm1
								ELSE
									SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cop2_fm1 player
									MARK_CHAR_AS_NO_LONGER_NEEDED cop2_fm1
								ENDIF
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ELSE
		MARK_CHAR_AS_NO_LONGER_NEEDED cop2_fm1
	ENDIF
	
	IF NOT IS_CHAR_DEAD	cop3_fm1
		SET_CHAR_SAY cop3_fm1 SOUND_SWAT_PED_SHOUT
		IF IS_CHAR_STOPPED cop3_fm1
			IF NOT IS_CHAR_SHOOTING cop3_fm1
				IF NOT IS_CHAR_DEAD clubber7_fm1
					SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop3_fm1 clubber7_fm1
				ELSE
					IF NOT IS_CHAR_DEAD clubber4_fm1
						SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop3_fm1 clubber4_fm1
					ELSE
						IF NOT IS_CHAR_DEAD clubber6_fm1
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop3_fm1 clubber6_fm1
						ELSE
							IF NOT IS_CHAR_DEAD clubber2_fm1
								SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop3_fm1 clubber2_fm1
							ELSE
								IF NOT IS_CHAR_DEAD clubber1_fm1
									SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop3_fm1 clubber1_fm1
								ELSE
									SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cop3_fm1 player
									MARK_CHAR_AS_NO_LONGER_NEEDED cop3_fm1
								ENDIF
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ELSE
		MARK_CHAR_AS_NO_LONGER_NEEDED cop3_fm1
	ENDIF
	
	IF NOT IS_CHAR_DEAD	cop4_fm1
		SET_CHAR_SAY cop4_fm1 SOUND_SWAT_PED_SHOUT
		IF IS_CHAR_STOPPED cop4_fm1
			IF NOT IS_CHAR_SHOOTING cop4_fm1
				IF NOT IS_CHAR_DEAD clubber4_fm1
					SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop4_fm1 clubber4_fm1
				ELSE
					IF NOT IS_CHAR_DEAD clubber7_fm1
						SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop4_fm1 clubber7_fm1
					ELSE
						IF NOT IS_CHAR_DEAD clubber2_fm1
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop4_fm1 clubber2_fm1
						ELSE
							IF NOT IS_CHAR_DEAD clubber6_fm1
								SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop4_fm1 clubber6_fm1
							ELSE
								IF NOT IS_CHAR_DEAD clubber1_fm1
									SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop4_fm1 clubber1_fm1
								ELSE
									SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cop4_fm1 player
									MARK_CHAR_AS_NO_LONGER_NEEDED cop4_fm1
								ENDIF
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ELSE
		MARK_CHAR_AS_NO_LONGER_NEEDED cop4_fm1
	ENDIF
	
	IF NOT IS_CHAR_DEAD	cop5_fm1
		SET_CHAR_SAY cop5_fm1 SOUND_SWAT_PED_SHOUT
		IF IS_CHAR_STOPPED cop5_fm1
			IF NOT IS_CHAR_SHOOTING cop5_fm1
				IF NOT IS_CHAR_DEAD clubber4_fm1
					SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop5_fm1 clubber4_fm1
				ELSE
					IF NOT IS_CHAR_DEAD clubber7_fm1
						SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop5_fm1 clubber7_fm1
					ELSE
						IF NOT IS_CHAR_DEAD clubber2_fm1
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop5_fm1 clubber2_fm1
						ELSE
							IF NOT IS_CHAR_DEAD clubber6_fm1
								SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop5_fm1 clubber6_fm1
							ELSE
								IF NOT IS_CHAR_DEAD clubber1_fm1
									SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop5_fm1 clubber1_fm1
								ELSE
									SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cop5_fm1 player
									MARK_CHAR_AS_NO_LONGER_NEEDED cop5_fm1
								ENDIF
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ELSE
		MARK_CHAR_AS_NO_LONGER_NEEDED cop5_fm1
	ENDIF
	
	IF NOT IS_CHAR_DEAD	cop6_fm1
		SET_CHAR_SAY cop6_fm1 SOUND_SWAT_PED_SHOUT
		IF IS_CHAR_STOPPED cop6_fm1
			IF NOT IS_CHAR_SHOOTING cop6_fm1
				IF NOT IS_CHAR_DEAD clubber4_fm1
					SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop6_fm1 clubber4_fm1
				ELSE
					IF NOT IS_CHAR_DEAD clubber1_fm1
						SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop6_fm1 clubber1_fm1
					ELSE
						IF NOT IS_CHAR_DEAD clubber2_fm1
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop6_fm1 clubber2_fm1
						ELSE
							IF NOT IS_CHAR_DEAD clubber7_fm1
								SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop6_fm1 clubber7_fm1
							ELSE
								IF NOT IS_CHAR_DEAD clubber6_fm1
									SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop6_fm1 clubber6_fm1
								ELSE
									SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cop6_fm1 player
									MARK_CHAR_AS_NO_LONGER_NEEDED cop6_fm1
								ENDIF
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ELSE
		MARK_CHAR_AS_NO_LONGER_NEEDED cop6_fm1
	ENDIF
	
	IF NOT IS_CHAR_DEAD	cop7_fm1
		SET_CHAR_SAY cop7_fm1 SOUND_SWAT_PED_SHOUT
		IF IS_CHAR_STOPPED cop7_fm1
			IF NOT IS_CHAR_SHOOTING cop7_fm1
				IF NOT IS_CHAR_DEAD clubber4_fm1
					SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop7_fm1 clubber4_fm1
				ELSE
					IF NOT IS_CHAR_DEAD clubber1_fm1
						SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop7_fm1 clubber1_fm1
					ELSE
						IF NOT IS_CHAR_DEAD clubber2_fm1
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop7_fm1 clubber2_fm1
						ELSE
							IF NOT IS_CHAR_DEAD clubber7_fm1
								SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop7_fm1 clubber7_fm1
							ELSE
								IF NOT IS_CHAR_DEAD clubber6_fm1
									SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop7_fm1 clubber6_fm1
								ELSE
									SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cop7_fm1 player
									MARK_CHAR_AS_NO_LONGER_NEEDED cop7_fm1
								ENDIF
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ELSE
		MARK_CHAR_AS_NO_LONGER_NEEDED cop7_fm1
	ENDIF
	
	IF NOT IS_CHAR_DEAD	cop8_fm1
		SET_CHAR_SAY cop8_fm1 SOUND_SWAT_PED_SHOUT
		IF IS_CHAR_STOPPED cop8_fm1
			IF NOT IS_CHAR_SHOOTING cop8_fm1
				IF NOT IS_CHAR_DEAD clubber6_fm1
					SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop8_fm1 clubber6_fm1
				ELSE
					IF NOT IS_CHAR_DEAD clubber1_fm1
						SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop8_fm1 clubber1_fm1
					ELSE
						IF NOT IS_CHAR_DEAD clubber2_fm1
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop8_fm1 clubber2_fm1
						ELSE
							IF NOT IS_CHAR_DEAD clubber7_fm1
								SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop8_fm1 clubber7_fm1
							ELSE
								IF NOT IS_CHAR_DEAD clubber4_fm1
									SET_CHAR_OBJ_KILL_CHAR_ON_FOOT cop8_fm1 clubber4_fm1
								ELSE
									SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cop8_fm1 player
									MARK_CHAR_AS_NO_LONGER_NEEDED cop8_fm1
								ENDIF
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ELSE
		MARK_CHAR_AS_NO_LONGER_NEEDED cop8_fm1
	ENDIF

RETURN



draw_disco_lights:///////////////////////////////////////////////////////////////////////////////////

	++ shadow_counter
	
	IF shadow_counter > 28
	AND shadow_counter < 32
		DRAW_SHADOW SHADOW_EXPLOSION 1272.5963 -1107.4248 12.0 30.0 0.8 0 R G 0 // ShadowType X Y Z Rotation Scale Transparency Red Green Blue
		DRAW_LIGHT 1272.45 -1107.6 13.1 R G 0
	ELSE
		GENERATE_RANDOM_INT_IN_RANGE 0 101 G
		GENERATE_RANDOM_INT_IN_RANGE 0 101 R
	ENDIF
	
	IF shadow_counter > 15
	AND shadow_counter < 20
		DRAW_SHADOW SHADOW_EXPLOSION 1270.9584 -1107.6783 12.0 0.0 1.2 0 R1 G1 0 // ShadowType X Y Z Rotation Scale Transparency Red Green Blue
		DRAW_LIGHT 1272.45 -1107.18 13.1 R1 G1 0
	ELSE
		GENERATE_RANDOM_INT_IN_RANGE 0 101 G1
		GENERATE_RANDOM_INT_IN_RANGE 0 101 R1
	ENDIF
	
	IF shadow_counter > 20
	AND shadow_counter < 40
		DRAW_SHADOW SHADOW_EXPLOSION 1273.3 -1107.0 12.0 80.0 1.0 0 R2 G2 0 // ShadowType X Y Z Rotation Scale Transparency Red Green Blue
		DRAW_LIGHT 1272.45 -1107.6 12.8 R2 G2 0
	ELSE
		GENERATE_RANDOM_INT_IN_RANGE 0 101 G2
		GENERATE_RANDOM_INT_IN_RANGE 0 101 R2
	ENDIF
	
	IF shadow_counter > 18
	AND shadow_counter < 40
		DRAW_SHADOW SHADOW_EXPLOSION 1273.3 -1107.7 12.0 140.0 0.8 0 R3 G3 0 // ShadowType X Y Z Rotation Scale Transparency Red Green Blue
		DRAW_LIGHT 1272.45 -1107.18 12.8 R3 G3 0
	ELSE
		GENERATE_RANDOM_INT_IN_RANGE 0 101 G3
		GENERATE_RANDOM_INT_IN_RANGE 0 101 R3
	ENDIF
	
	IF shadow_counter > 5
	AND shadow_counter < 14
		DRAW_SHADOW SHADOW_EXPLOSION 1271.4812 -1108.0588 12.0 235.0 1.1 0 R4 G4 0 // ShadowType X Y Z Rotation Scale Transparency Red Green Blue
		DRAW_LIGHT 1272.45 -1107.6 12.5 R4 G4 0
	ELSE
		GENERATE_RANDOM_INT_IN_RANGE 0 101 G4
		GENERATE_RANDOM_INT_IN_RANGE 0 101 R4
	ENDIF

	IF shadow_counter > 9
	AND shadow_counter < 26
		DRAW_SHADOW SHADOW_EXPLOSION 1271.5570 -1107.0217 12.0 325.0 1.8 0 R5 G5 0 // ShadowType X Y Z Rotation Scale Transparency Red Green Blue
		DRAW_LIGHT 1272.45 -1107.18 12.5 R5 G5 0
	ELSE
		GENERATE_RANDOM_INT_IN_RANGE 0 101 G5
		GENERATE_RANDOM_INT_IN_RANGE 0 101 R5
	ENDIF
	
	IF shadow_counter = 40
	OR shadow_counter > 40
		shadow_counter = 0
	ENDIF

RETURN


delete_char_maria:

DELETE_CHAR maria

RETURN

MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ***********************************Frankie Mission 2*************************************
// **********************************"Cuttin' The Grass"************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME frank2

// Mission start stuff

GOSUB mission_start_frankie2

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_frankie2_failed
	ENDIF
			
GOSUB mission_cleanup_frankie2

MISSION_END


// Variables for mission

VAR_INT curley_bob_fm2

VAR_INT hours_fm2

VAR_INT minutes_fm2

VAR_INT hours_stuff_happen_fm2

VAR_INT mission_taxi_fm2

VAR_INT radar_blip_coord2_fm2

VAR_INT radar_blip_coord3_fm2

VAR_INT car_fm2

VAR_INT van_driver_fm2

VAR_INT radar_blip_coord1_fm2

VAR_INT radar_blip_ped1_fm2

VAR_INT radar_blip_car1_fm2

VAR_INT columbian_fm2

VAR_INT radar_blip_ped2_fm2

VAR_INT flag_player_too_far_message_fm2

VAR_INT minutes_stuff_happen_fm2

VAR_INT flag_player_got_car_message_fm2

VAR_INT flag_player_got_cops_message_fm2

VAR_INT time_car_stopped_fm2

VAR_INT current_time_fm2

VAR_INT flag_car_has_just_stopped

VAR_INT timer_difference

VAR_INT flag_taxi1_exit_car_fm2

VAR_INT flag_taxi2_exit_car_fm2

VAR_INT flag_car_fm2_created

VAR_INT flag_mission_taxi_fm2_created

VAR_INT flag_no_longer_mad

VAR_INT flag_curley_at_point1_fm2

VAR_INT flag_curley_at_point2_fm2

VAR_INT flag_curley_bob_fm2_dead

VAR_INT flag_bob_in_position_one

VAR_INT flag_bob_in_position_two

VAR_INT flag_bob_in_position_three

VAR_INT baddie_car_fm2

VAR_INT radar_blip_car2_fm2

VAR_INT flag_curley_bob_dead_fm2

VAR_INT car_health_fm2

VAR_INT flag_car_fm2_dead

VAR_FLOAT car_fm2_x

VAR_FLOAT car_fm2_y

VAR_FLOAT car_fm2_z

VAR_INT radar_blip_club_fm2

VAR_INT flag_curly_mad_fm2

VAR_INT spooked_counter

VAR_INT spooked_check

VAR_INT flag_player_had_warning1_fm2

VAR_INT flag_player_had_warning2_fm2

VAR_INT flag_curly_moved_fm2  // Moves curly if he gets stuck


// ****************************************Start Mission************************************
 
mission_start_frankie2:

flag_player_on_mission = 1

flag_player_on_frankie_mission = 1

REGISTER_MISSION_GIVEN

// only objective is to follow a car. dont need pathing
DISPLAY_RADAR 2 // PATHING OFF

WAIT 0

hours_fm2 = 0

minutes_fm2 = 0

hours_stuff_happen_fm2 = 0

minutes_stuff_happen_fm2 = 0

flag_player_got_car_message_fm2 = 0

flag_player_got_cops_message_fm2 = 0

time_car_stopped_fm2 = 0

flag_car_has_just_stopped = 0

timer_difference = 0

flag_taxi1_exit_car_fm2 = 0

flag_taxi2_exit_car_fm2 = 0

flag_car_fm2_created = 0

flag_mission_taxi_fm2_created = 0

flag_no_longer_mad = 0

flag_curley_at_point1_fm2 = 0

flag_curley_at_point2_fm2 = 0

flag_curley_bob_fm2_dead = 0

flag_bob_in_position_one = 0

flag_bob_in_position_two = 0

flag_bob_in_position_three = 0

flag_curley_bob_dead_fm2 = 0

car_health_fm2 = 0

blob_flag = 1

flag_car_fm2_dead = 0

car_fm2_x = 0.0

car_fm2_y = 0.0

car_fm2_z = 0.0

flag_curly_mad_fm2 = 0

spooked_counter = 0

spooked_check = 0

flag_player_had_warning1_fm2 = 0

flag_player_had_warning2_fm2 = 0

flag_curly_moved_fm2 = 0 //moves curly if he gets stuck

{


// ******************************************START OF CUTSCENE******************************

/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_frankie2_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( FM2 ) 15000 2 //"Cuttin' The Grass"

SWITCH_STREAMING OFF
*/

LOAD_SPECIAL_CHARACTER 1 FRANKIE
REQUEST_MODEL PED_GANG_MAFIA_B
LOAD_SPECIAL_MODEL cut_obj1 FRANKH
//LOAD_SPECIAL_MODEL cut_obj2 PLAYERH
REQUEST_MODEL franksclb02
REQUEST_MODEL salvsdetail
REQUEST_MODEL swank_inside

/*
WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE
*/

LOAD_ALL_MODELS_NOW
	
// Cutscene stuff

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED PED_GANG_MAFIA_B
OR NOT HAS_MODEL_LOADED cut_obj1
//OR NOT HAS_MODEL_LOADED cut_obj2

	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED franksclb02
OR NOT HAS_MODEL_LOADED	salvsdetail
OR NOT HAS_MODEL_LOADED swank_inside

	WAIT 0

ENDWHILE

LOAD_CUTSCENE s2_ctg

SET_CUTSCENE_OFFSET 1457.776 -185.348 54.925

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_frankie

SET_CUTSCENE_ANIM cs_frankie frankie

CREATE_CUTSCENE_HEAD cs_frankie CUT_OBJ1 cs_frankiehead

SET_CUTSCENE_HEAD_ANIM cs_frankiehead frank

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead

//SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT PED_GANG_MAFIA_B cs_mafia

SET_CUTSCENE_ANIM cs_mafia gang02

CLEAR_AREA 1455.1 -187.8 -100.0 1.0 TRUE 

SET_PLAYER_COORDINATES player 1455.1 -187.8 -100.0 

SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 1726
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_J ) 10000 1 //"Leave us alone for a minute,"

WHILE cs_time < 2910
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( FM2_J )

WHILE cs_time < 4558
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_A ) 10000 1 //"The Colombian Cartel is making SPANK somewhere in Liberty.

WHILE cs_time < 7896
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_K ) 10000 1 //"But we don't know where, and they seem to know everything we're doin' before we do."

WHILE cs_time < 13257
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_B ) 10000 1 //"We got us a rat."

WHILE cs_time < 15103
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_L ) 10000 1 //"There is a guy named Curly Bob works the bar at Luigi's.

WHILE cs_time < 18415
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_M ) 10000 1 //"He's been throwing more money around than he's earning."

WHILE cs_time < 21238
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_C ) 10000 1 //"He ain't pimping or pushing so he must be talking."

WHILE cs_time < 25040
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_N ) 10000 1 //"He usually gets a taxi home after work. So follow him."

WHILE cs_time < 28251
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_O ) 10000 1 //"And if he's rattin' us out...kill him."

WHILE cs_time < 30960
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( FM2_O )

WHILE cs_time < 38333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_B
//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2

MARK_MODEL_AS_NO_LONGER_NEEDED franksclb02

MARK_MODEL_AS_NO_LONGER_NEEDED salvsdetail

MARK_MODEL_AS_NO_LONGER_NEEDED swank_inside

// *******************************************END OF CUTSCENE*******************************

LOAD_SPECIAL_CHARACTER 2 curly

REQUEST_MODEL CAR_TAXI
REQUEST_MODEL PED_TAXI_DRIVER 

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED CAR_TAXI
OR NOT HAS_MODEL_LOADED PED_TAXI_DRIVER

	WAIT 0
	
ENDWHILE

WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE

SETUP_ZONE_PED_INFO PORT_E DAY 0 0 0 0 0 0 0 0 0
SETUP_ZONE_PED_INFO PORT_E NIGHT 0 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO PORT_E DAY 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO PORT_E NIGHT 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

// CREATES THE TAXI FOR THE BLOKE TO GET INTO

PRINT_NOW ( FM2_11 ) 5000 1 //"Park out the front of Luigi's Club, Curly Bob will be leaving shortly."

ADD_BLIP_FOR_COORD 907.0 -424.7 13.8 radar_blip_club_fm2

CREATE_CAR CAR_TAXI 906.9 -433.7 -100.0 car_fm2

SET_CAR_ONLY_DAMAGED_BY_PLAYER car_fm2 TRUE

flag_car_fm2_created = 1

SET_CAR_HEADING car_fm2 180.0

CHANGE_CAR_LOCK car_fm2 CARLOCK_LOCKOUT_PLAYER_ONLY
		
CREATE_CHAR_INSIDE_CAR car_fm2 PEDTYPE_CIVMALE PED_TAXI_DRIVER van_driver_fm2

SET_CHAR_CANT_BE_DRAGGED_OUT van_driver_fm2 TRUE

CLEAR_CHAR_THREAT_SEARCH van_driver_fm2 

CAR_SET_IDLE car_fm2

SWITCH_WIDESCREEN OFF

RESTORE_CAMERA

SET_PLAYER_CONTROL player on

SET_POLICE_IGNORE_PLAYER player off


timerb = 0


//GET_TIME_OF_DAY hours_fm2 minutes_fm2

//minutes_stuff_happen_fm2 = minutes_fm2 - 1

//IF minutes_stuff_happen_fm2 <= 0

//	minutes_stuff_happen_fm2 += 60

//ENDIF

// waiting for the time of day to be correct

//WHILE NOT minutes_fm2 = minutes_stuff_happen_fm2

//	WAIT 0 

//GET_TIME_OF_DAY hours_fm2 minutes_fm2
         		
//ENDWHILE


WHILE timerb < 60000

	WAIT 0

ENDWHILE

// checks to see where curly will be created

IF IS_PLAYER_IN_AREA_3D player 901.2 -427.8 12.0 878.1 -422.4 27.0 FALSE
OR IS_PLAYER_IN_AREA_3D player 878.1 -422.4 12.0 900.4 -404.2 27.0 FALSE 

	// creates curley bob infront of the club
	
	CLEAR_AREA 902.9 -398.8 14.0 1.0 TRUE    

	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 902.9 -398.8 14.0 curley_bob_fm2

	ADD_BLIP_FOR_CHAR curley_bob_fm2 radar_blip_ped1_fm2

	CHANGE_BLIP_DISPLAY radar_blip_ped1_fm2 MARKER_ONLY 

	CLEAR_CHAR_THREAT_SEARCH curley_bob_fm2

	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT curley_bob_fm2 902.7 -430.4

	timerb = 0

	WHILE NOT LOCATE_CHAR_ON_FOOT_2D curley_bob_fm2 902.7 -430.4 1.0 1.0 FALSE

		WAIT 0
						
		IF IS_CHAR_DEAD curley_bob_fm2
			PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
			GOTO mission_frankie2_failed
		ELSE

			IF NOT IS_CHAR_HEALTH_GREATER curley_bob_fm2 99
				PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
				GOTO mission_frankie2_failed
			ENDIF

		ENDIF

		IF flag_curly_moved_fm2 = 0

			IF timerb >= 15000

				IF NOT LOCATE_CHAR_ON_FOOT_2D curley_bob_fm2 902.7 -430.4 1.0 1.0 FALSE
					SET_CHAR_COORDINATES curley_bob_fm2 902.7 -430.4 13.7
					flag_curly_moved_fm2 = 1
				ENDIF
				
			ENDIF
		
		ENDIF 
						
	ENDWHILE

	CHAR_SET_IDLE curley_bob_fm2
	
	GOTO mission_check 

ELSE
	
	// creates curley bob down the alleyway
	
	CLEAR_AREA 886.3 -422.2 13.8 1.0 TRUE    

	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 886.3 -422.2 13.8 curley_bob_fm2

	ADD_BLIP_FOR_CHAR curley_bob_fm2 radar_blip_ped1_fm2

	CHANGE_BLIP_DISPLAY radar_blip_ped1_fm2 MARKER_ONLY

	CLEAR_CHAR_THREAT_SEARCH curley_bob_fm2

	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT curley_bob_fm2 888.0 -425.0
	
	CLEAR_AREA 887.4 -417.3 13.9 10.0 FALSE  // This should get rid of anything is his way

	CLEAR_AREA 892.8 -425.5 13.9 3.0 FALSE

	CLEAR_AREA 896.3 -425.6 13.8 3.0 FALSE

	CLEAR_AREA 899.1 -424.6 14.0 3.0 FALSE

	CLEAR_AREA 903.4 -425.6 13.9 2.0 FALSE
	
	//waiting for curly bob to get to the pavement

	timerb = 0

	WHILE NOT LOCATE_CHAR_ON_FOOT_2D curley_bob_fm2 904.0 -427.3 1.0 1.0 FALSE

		WAIT 0
						
		IF IS_CHAR_DEAD curley_bob_fm2
			PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
			GOTO mission_frankie2_failed
		ELSE

			IF NOT IS_CHAR_HEALTH_GREATER curley_bob_fm2 99
				PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
				GOTO mission_frankie2_failed
			ENDIF

		ENDIF
	   	   		
		IF LOCATE_CHAR_ON_FOOT_2D curley_bob_fm2 888.0 -425.0 1.0 1.0 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD curley_bob_fm2 892.1 -425.3
		ENDIF

   
		IF LOCATE_CHAR_ON_FOOT_2D curley_bob_fm2 892.1 -425.3 1.0 1.0 FALSE
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT curley_bob_fm2 904.0 -427.3
		ENDIF

		IF flag_curly_moved_fm2 = 0

			IF timerb >= 25000

				IF NOT LOCATE_CHAR_ON_FOOT_2D curley_bob_fm2 904.0 -427.3 1.0 1.0 FALSE 
					SET_CHAR_COORDINATES curley_bob_fm2 904.0 -427.3 13.9
					flag_curly_moved_fm2 = 1
				ENDIF

			ENDIF
		
		ENDIF 

	ENDWHILE

	CHAR_SET_IDLE curley_bob_fm2

ENDIF

mission_check:

REMOVE_BLIP radar_blip_club_fm2

// Checks to see which part of the mission the player will get

IF NOT IS_PLAYER_STOPPED_IN_AREA_IN_CAR_2D player 905.0 -432.0 910.0 -419.0 FALSE
	GOTO mission_jump3
ENDIF

// Checks to see if the player is in the area in a taxi

IF IS_PLAYER_IN_MODEL player car_taxi
OR IS_PLAYER_IN_MODEL player car_cabbie
OR IS_PLAYER_IN_MODEL player car_borgnine
	STORE_CAR_PLAYER_IS_IN player mission_taxi_fm2
	flag_mission_taxi_fm2_created = 1
ELSE
	GOTO mission_jump3
ENDIF

// *********************If player is in a taxi luanches part one of the mission************* 

IF LOCATE_STOPPED_PLAYER_IN_CAR_2D player 906.0 -425.0 4.0 4.0 FALSE
AND IS_PLAYER_IN_CAR player mission_taxi_fm2
     			
	IF IS_CHAR_DEAD curley_bob_fm2
		PRINT_NOW ( FM2_9 ) 5000 1 //Curly Bob's dead!"
		GOTO mission_frankie2_failed
	ENDIF

	IF IS_PLAYER_IN_MODEL player car_taxi
	OR IS_PLAYER_IN_MODEL player car_cabbie
		STORE_CAR_PLAYER_IS_IN player mission_taxi_fm2
	ENDIF

// Checks to see if the taxi is damaged or not

	IF IS_CAR_DEAD mission_taxi_fm2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle is wrecked!"
		GOTO mission_frankie2_failed
	ELSE

		IF IS_CAR_UPSIDEDOWN mission_taxi_fm2
		AND IS_CAR_STOPPED mission_taxi_fm2 
			PRINT_NOW ( UPSIDE ) 5000 1 //"You've flipped your wheels!"
			GOTO mission_frankie2_failed
		ENDIF

	ENDIF

	IF NOT IS_CAR_HEALTH_GREATER mission_taxi_fm2 700
		PRINT_NOW ( FM2_6 ) 5000 1 //"Get out of here! I'm not taking a ride in this shit-heap!"
		GOTO mission_frankie2_failed
	ENDIF
		 			
	SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER curley_bob_fm2 mission_taxi_fm2
	
		WHILE NOT IS_CHAR_IN_CAR curley_bob_fm2 mission_taxi_fm2

			WAIT 0

			IF IS_CAR_DEAD mission_taxi_fm2
				PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle is wrecked!"
				GOTO mission_frankie2_failed
			ELSE

				IF IS_CAR_UPSIDEDOWN mission_taxi_fm2
				AND IS_CAR_STOPPED mission_taxi_fm2 
					PRINT_NOW ( UPSIDE ) 5000 1 //"You've flipped your wheels!"
					GOTO mission_frankie2_failed
				ENDIF

			ENDIF

			IF IS_CHAR_DEAD curley_bob_fm2
				PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
				GOTO mission_frankie2_failed
			ELSE

				IF NOT IS_CHAR_HEALTH_GREATER curley_bob_fm2 99
					PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
					GOTO mission_frankie2_failed
				ENDIF

			ENDIF
				
			IF NOT LOCATE_PLAYER_IN_CAR_CHAR_2D player curley_bob_fm2 5.0 5.0 FALSE
				PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
				GOTO mission_frankie2_failed
			ENDIF
		   		   		   									
		ENDWHILE

		REMOVE_BLIP radar_blip_ped1_fm2

	 	PRINT_NOW ( FM2_5 ) 7000 1 //"Take me to the Portland Harbour East docks."

		ADD_BLIP_FOR_COORD 1529.0 -827.0 -100.0 radar_blip_coord2_fm2
	
	blob_flag = 1

	WHILE NOT LOCATE_STOPPED_PLAYER_IN_CAR_2D player 1529.0 -827.0 3.0 4.0 blob_flag
	OR NOT IS_CHAR_IN_CAR curley_bob_fm2 mission_taxi_fm2
	OR NOT IS_PLAYER_IN_CAR player mission_taxi_fm2

		WAIT 0

		IF IS_CAR_DEAD mission_taxi_fm2
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle is wrecked!"
			GOTO mission_frankie2_failed
		ELSE

			IF IS_CAR_UPSIDEDOWN mission_taxi_fm2
			AND IS_CAR_STOPPED mission_taxi_fm2 
				PRINT_NOW ( UPSIDE ) 5000 1 //"You've flipped your wheels!"
				GOTO mission_frankie2_failed
			ENDIF

		ENDIF
			 			
  		IF IS_CHAR_DEAD curley_bob_fm2
  			PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
  			GOTO mission_frankie2_failed
  		ENDIF

		IF NOT IS_CHAR_IN_CAR curley_bob_fm2 mission_taxi_fm2
			PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
			GOTO mission_frankie2_failed
		ENDIF
							
		IF NOT IS_PLAYER_IN_CAR player mission_taxi_fm2
		AND flag_player_got_car_message_fm2 = 0
   			CLEAR_PRINTS
   			PRINT_NOW ( IN_VEH ) 5000 1 //"Get back into the vehicle and get on with the mission"
   			ADD_BLIP_FOR_CAR mission_taxi_fm2 radar_blip_car1_fm2
			REMOVE_BLIP radar_blip_coord2_fm2
   			flag_player_got_car_message_fm2 = 1
			blob_flag = 0
   		ENDIF

   		IF IS_PLAYER_IN_CAR player mission_taxi_fm2
		AND flag_player_got_car_message_fm2 = 1
	  		ADD_BLIP_FOR_COORD 1529.0 -827.0 -100.0 radar_blip_coord2_fm2
			CHANGE_BLIP_DISPLAY radar_blip_coord2_fm2 BLIP_ONLY
   			REMOVE_BLIP radar_blip_car1_fm2
   			flag_player_got_car_message_fm2 = 0
			blob_flag = 1
   		ENDIF

		IF IS_CAR_STOPPED mission_taxi_fm2
			IF flag_car_has_just_stopped = 0
				//GET_GAME_TIMER time_car_stopped_fm2
				timerb = 0
				flag_car_has_just_stopped = 1
			ENDIF
			//GET_GAME_TIMER current_time_fm2
			//timer_difference = current_time_fm2 - time_car_stopped_fm2
			//IF timer_difference > 10000
			IF timerb > 10000
				flag_taxi1_exit_car_fm2 = 1
				PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
				GOTO mission_frankie2_failed
			ENDIF
		ELSE
		 	flag_car_has_just_stopped = 0
		ENDIF	
		   	  			
  	ENDWHILE

	REMOVE_BLIP radar_blip_coord2_fm2

	USE_TEXT_COMMANDS 135 // HACKED achievement unlock // FARE_GAME

	GOTO mission_jump2
	
ENDIF

// *********If player does not have a taxi creates taxi for Curley Bob to get into**********

mission_jump3:

IF IS_CAR_DEAD car_fm2
	PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
	flag_car_fm2_dead = 1
	GOTO mission_frankie2_failed
ELSE

	IF IS_CAR_UPSIDEDOWN car_fm2
	AND IS_CAR_STOPPED car_fm2 
		PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
		GOTO mission_frankie2_failed
	ENDIF

ENDIF

IF LOCATE_STOPPED_CAR_2D car_fm2 906.9 -433.0 6.0 6.0 FALSE
AND NOT IS_CAR_UPSIDEDOWN car_fm2 
	SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER curley_bob_fm2 car_fm2
ELSE
	PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
	GOTO mission_frankie2_failed
ENDIF

//waiting for the character to get into the car

	WHILE NOT IS_CHAR_IN_CAR curley_bob_fm2 car_fm2

	 	WAIT 0
			 	  	  		 
  		IF IS_CHAR_DEAD curley_bob_fm2
			PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
			GOTO mission_frankie2_failed
		ELSE

			IF NOT IS_CHAR_HEALTH_GREATER curley_bob_fm2 99
				PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
				GOTO mission_frankie2_failed
			ENDIF

		ENDIF
	   	   
		IF IS_CAR_DEAD car_fm2

			IF IS_CHAR_DEAD curley_bob_fm2
  				PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
  				GOTO mission_frankie2_failed
  			ELSE
				PRINT_NOW ( WRECKED ) 5000 1 //The vehicle's wrecked!"
				flag_car_fm2_dead = 1
				GOTO mission_frankie2_failed
			ENDIF

		ELSE

			IF IS_CAR_UPSIDEDOWN car_fm2
			AND IS_CAR_STOPPED car_fm2 
				PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
				GOTO mission_frankie2_failed
			ENDIF

		ENDIF

	ENDWHILE

	REMOVE_BLIP radar_blip_ped1_fm2

	PRINT_NOW ( FM2_2 ) 7000 1 //Tail Curly Bob!"

	SWITCH_WIDESCREEN OFF

	RESTORE_CAMERA

	SET_PLAYER_CONTROL player on

	SET_POLICE_IGNORE_PLAYER player off
	
	ADD_BLIP_FOR_CAR car_fm2 radar_blip_car2_fm2

	//CHANGE_BLIP_DISPLAY radar_blip_car2_fm2 MARKER_ONLY // rockstar wants a blip

	SET_CAR_CRUISE_SPEED car_fm2 30.0

   	CAR_GOTO_COORDINATES_ACCURATE car_fm2 1529.0 -827.0 -100.0

	SET_CAR_DRIVING_STYLE  car_fm2 DRIVINGMODE_SLOWDOWNFORCARS

	SET_CAR_CRUISE_SPEED car_fm2 20.0

	ADD_STUCK_CAR_CHECK car_fm2 5.0 30000

	DISPLAY_ONSCREEN_COUNTER_WITH_STRING spooked_counter COUNTER_DISPLAY_BAR ( FM2_16 )
	
	timerb = 0
	
	timera = 0		

// Waiting for the car to get to the bottom of the dock area

	WHILE NOT LOCATE_CAR_2D car_fm2 1529.0 -827.0 3.0 3.0 FALSE
	
		WAIT 0

		IF spooked_check = 0

			IF timerb > 1500
				 spooked_check = 1
			ENDIF

		ENDIF
		
		IF IS_CAR_DEAD car_fm2
			
			IF IS_CHAR_DEAD curley_bob_fm2
  				PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
  				GOTO mission_frankie2_failed
  			ELSE
				PRINT_NOW ( WRECKED ) 5000 1 //The vehicle's wrecked!"
				flag_car_fm2_dead = 1
				GOTO mission_frankie2_failed
			ENDIF

		ELSE

			IF IS_CAR_STUCK car_fm2
				spooked_counter = 100
				PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
  				GOTO mission_frankie2_failed
			ENDIF

			IF IS_CAR_UPSIDEDOWN car_fm2
			AND IS_CAR_STOPPED car_fm2
				spooked_counter = 100
				PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
				GOTO mission_frankie2_failed
			ENDIF
						
		ENDIF
					
		CLEAR_AREA 1529.0 -827.0 -100.0 4.0 FALSE // This should clear the area at the bottom of the docks
						
  	 	IF IS_CHAR_DEAD curley_bob_fm2
  	 		PRINT_NOW ( FM2_9 ) 5000 1 //"Curly's dead!"
  	 		GOTO mission_frankie2_failed
  	 	ELSE
		   
	   		IF spooked_check = 1

				IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D player curley_bob_fm2 40.0 40.0 40.0 FALSE
				   
					IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D player curley_bob_fm2 30.0 30.0 30.0 FALSE
						
						IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D player curley_bob_fm2 20.0 20.0 20.0 FALSE


							IF IS_PLAYER_IN_MODEL player CAR_MAFIA
							
								IF timera > 8
									++ spooked_counter
									timera = 0
				   				ENDIF 
															
							ELSE
							
								IF timera > 16
									++ spooked_counter
									timera = 0
				   				ENDIF

							ENDIF
											
						ELSE

							IF IS_PLAYER_IN_MODEL player CAR_MAFIA

								IF timera > 16
									++ spooked_counter
									timera = 0
				   				ENDIF

							ELSE

								IF timera > 32
									++ spooked_counter
									timera = 0
				   				ENDIF

							ENDIF
																													
						ENDIF

					ELSE

						IF IS_PLAYER_IN_MODEL player CAR_MAFIA

							IF timera > 32
								++ spooked_counter
								timera = 0
				   			ENDIF

						ELSE
						
							IF timera > 64
								++ spooked_counter
								timera = 0
				   			ENDIF

						ENDIF
					 							
					ENDIF

				ELSE

					IF IS_PLAYER_IN_MODEL player CAR_MAFIA

						IF timera > 500

							IF spooked_counter > 0
								-- spooked_counter
							ENDIF
							timera = 0
						ENDIF

					ELSE
										
						IF timera > 250

							IF spooked_counter > 0
								-- spooked_counter
							ENDIF
							timera = 0
						ENDIF
						
					ENDIF	
				
				ENDIF

			ENDIF
			

			IF spooked_counter > 10

				IF flag_player_had_warning1_fm2 = 0
					PRINT_NOW ( FM2_15 ) 5000 1 //"Don't get too close or curly will suspect something!"
					flag_player_had_warning1_fm2 = 1				
				ENDIF
		
			ENDIF	


			IF spooked_counter = 100
				PRINT_NOW ( FM2_14 ) 5000 1 //"You got too close and spooked Curly!"	
				GOTO mission_frankie2_failed
			ENDIF	


		 	IF NOT IS_CHAR_IN_CAR curley_bob_fm2 car_fm2
				spooked_counter = 100
				PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
				GOTO mission_frankie2_failed
			ENDIF

			IF IS_CHAR_IN_AREA_2D curley_bob_fm2 1538.0 -741.0 1304.0 -901.0 FALSE
				SET_CAR_DRIVING_STYLE car_fm2 1
				SET_CAR_CRUISE_SPEED car_fm2 10.0
				flag_no_longer_mad = 1
			ENDIF

			IF flag_no_longer_mad = 0

				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player curley_bob_fm2 30.0 30.0 FALSE
					SET_CAR_DRIVING_STYLE car_fm2 DRIVINGMODE_AVOIDCARS
					SET_CAR_CRUISE_SPEED car_fm2 25.0
				ELSE
			   		SET_CAR_DRIVING_STYLE car_fm2 DRIVINGMODE_SLOWDOWNFORCARS
					SET_CAR_CRUISE_SPEED car_fm2 20.0
				ENDIF

			ENDIF

		ENDIF			  	  	   	  	
							   
		IF IS_CAR_VISIBLY_DAMAGED car_fm2
		 		 		   
			IF IS_CHAR_DEAD curley_bob_fm2
  	 			PRINT_NOW ( FM2_9 ) 5000 1 //"Curly's dead!"
  	 			GOTO mission_frankie2_failed
  	 		ELSE
				spooked_counter = 100
				PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
				GOTO mission_frankie2_failed
			ENDIF
				
		ENDIF
		
		IF IS_CAR_STOPPED car_fm2
			IF flag_car_has_just_stopped = 0
				GET_GAME_TIMER time_car_stopped_fm2
				flag_car_has_just_stopped = 1
			ENDIF
			GET_GAME_TIMER current_time_fm2
			timer_difference = current_time_fm2 - time_car_stopped_fm2
			IF timer_difference > 15000
				flag_taxi2_exit_car_fm2 = 1
				spooked_counter = 100
				PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
				GOTO mission_frankie2_failed
			ENDIF
		ELSE
			flag_car_has_just_stopped = 0
		ENDIF	 
				
  	ENDWHILE

REMOVE_BLIP radar_blip_car2_fm2

REMOVE_STUCK_CAR_CHECK car_fm2
  
	      
// ********************Curley Bob gets out of the script controlled taxi********************

IF flag_car_fm2_created = 1
AND IS_CHAR_IN_CAR curley_bob_fm2 car_fm2
	flag_taxi2_exit_car_fm2 = 1
ENDIF

IF flag_taxi2_exit_car_fm2 = 1
   	SET_CHAR_OBJ_LEAVE_CAR curley_bob_fm2 car_fm2


  		WHILE IS_CHAR_IN_CAR curley_bob_fm2 car_fm2

  			WAIT 0
		   		  		  			
  			IF IS_CHAR_DEAD curley_bob_fm2
				PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
				GOTO mission_frankie2_failed
			ELSE

				IF NOT IS_CHAR_HEALTH_GREATER curley_bob_fm2 99
					PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
					GOTO mission_frankie2_failed
				ENDIF

			ENDIF
			  			
  			IF IS_CAR_DEAD car_fm2

				IF IS_CHAR_DEAD curley_bob_fm2
  					PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
  					GOTO mission_frankie2_failed
  				ELSE
					PRINT_NOW ( WRECKED ) 5000 1 //The vehicle's wrecked!"
					flag_car_fm2_dead = 1
					GOTO mission_frankie2_failed
				ENDIF

			ELSE

				IF IS_CAR_UPSIDEDOWN car_fm2
				AND IS_CAR_STOPPED car_fm2 
					PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
					GOTO mission_frankie2_failed
				ENDIF

			ENDIF

  		 ENDWHILE

CLEAR_ONSCREEN_COUNTER spooked_counter

IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player curley_bob_fm2 160.0 160.0 160.0 FALSE	
	PRINT_NOW ( FM2_12 ) 5000 1 //"You lost him!"
	GOTO mission_frankie2_failed
ENDIF

// Checks to see if the player is around the ramp and will fail the mission

IF IS_PLAYER_IN_AREA_3D player 1573.72 -876.49 5.0 1404.09 -1034.30 30.0 FALSE
	spooked_counter = 100
	PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
	GOTO mission_frankie2_failed
ENDIF

GOTO mission_jump4

ENDIF


// *****************Orders Curley Bob out of the taxi if the player is driving**************

mission_jump2:

IF flag_mission_taxi_fm2_created = 1
AND IS_CHAR_IN_CAR curley_bob_fm2 mission_taxi_fm2
	flag_taxi1_exit_car_fm2 = 1
ENDIF 

IF flag_taxi1_exit_car_fm2 = 1

	SET_CHAR_OBJ_LEAVE_CAR curley_bob_fm2 mission_taxi_fm2

		WHILE IS_CHAR_IN_CAR curley_bob_fm2 mission_taxi_fm2

			WAIT 0

			IF IS_CHAR_DEAD curley_bob_fm2
				PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
				GOTO mission_frankie2_failed
			ELSE

				IF NOT IS_CHAR_HEALTH_GREATER curley_bob_fm2 99
					PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
					GOTO mission_frankie2_failed
				ENDIF

			ENDIF 
		  		  		  		  
			IF IS_CAR_DEAD mission_taxi_fm2

				IF IS_CHAR_DEAD curley_bob_fm2
  					PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
  					GOTO mission_frankie2_failed
  				ELSE
					PRINT_NOW ( WRECKED ) 5000 1 //The vehicle's wrecked!"
					GOTO mission_frankie2_failed
				ENDIF

			ELSE

				IF IS_CAR_UPSIDEDOWN mission_taxi_fm2
				AND IS_CAR_STOPPED mission_taxi_fm2
					PRINT_NOW ( FM2_7 ) 7000 1 //"Something's spooked Curly, the meeting's off!"
					GOTO mission_frankie2_failed
				ENDIF

			ENDIF
						
		 ENDWHILE

		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player curley_bob_fm2 160.0 160.0 160.0 FALSE	
			PRINT_NOW ( FM2_12 ) 5000 1 //"You lost him!"
			GOTO mission_frankie2_failed
		ENDIF

ENDIF


// ***********************Curley Bob has finally got to the docks***************************

mission_jump4:

SWITCH_WIDESCREEN ON

IF IS_PLAYER_IN_ANY_CAR player
	APPLY_BRAKES_TO_PLAYERS_CAR player ON
ENDIF

SET_PLAYER_CONTROL player OFF

CLEAR_WANTED_LEVEL player // This might have to come out when this bit is an Alex cut-scene

IF NOT IS_CHAR_DEAD van_driver_fm2
	SET_CHAR_CANT_BE_DRAGGED_OUT van_driver_fm2 FALSE
ENDIF

SET_POLICE_IGNORE_PLAYER player ON

CLEAR_AREA 1546.56 -834.79 12.70 1.0 TRUE

SET_FIXED_CAMERA_POSITION 1546.56 -834.79 12.70 0.0 0.0 0.0 

POINT_CAMERA_AT_POINT 1545.50 -834.60 12.79 JUMP_CUT

SET_CHAR_OBJ_RUN_TO_COORD curley_bob_fm2 1532.0 -889.0

timerb = 0

WHILE timerb < 1500
	
	WAIT 0

	CLEAR_AREA 1532.0 -889.0 -100.0 3.0 FALSE // Clears area curly is running to. 
    	
	IF IS_CHAR_DEAD curley_bob_fm2
		PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
		flag_curley_bob_fm2_dead = 1
		GOTO mission_frankie2_failed
	ENDIF
      		
ENDWHILE

IF IS_CHAR_DEAD curley_bob_fm2
	PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
	flag_curley_bob_fm2_dead = 1
	GOTO mission_frankie2_failed
ENDIF

// ****************************************START OF CUTSCENE TWO****************************

GET_GAME_TIMER breakout_timer_start

breakout_diff = 0

WHILE NOT CAN_PLAYER_START_MISSION Player
AND breakout_diff < 5000	//	if player is not in control after 5 secs do the cutscene anyway

	WAIT 0

	IF IS_CHAR_DEAD curley_bob_fm2
		PRINT_NOW ( FM2_9 ) 5000 1 //"Curly Bob's dead!"
		flag_curley_bob_fm2_dead = 1
		GOTO mission_frankie2_failed
	ENDIF

	GET_GAME_TIMER breakout_timer

	breakout_diff = breakout_timer - breakout_timer_start
	
ENDWHILE

MAKE_PLAYER_SAFE_FOR_CUTSCENE player

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

LOAD_SPECIAL_CHARACTER 3 miguel
LOAD_SPECIAL_CHARACTER 4 cat
LOAD_SPECIAL_MODEL cut_obj1 MIGUELH
LOAD_SPECIAL_MODEL cut_obj2 CATH
LOAD_SPECIAL_MODEL cut_obj3 CURLYH
REQUEST_MODEL CAR_COLUMB

WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE

IF NOT IS_CHAR_DEAD curley_bob_fm2
	CHAR_SET_IDLE curley_bob_fm2
ENDIF 

LOAD_ALL_MODELS_NOW
	
// Cutscene stuff
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 3
OR NOT HAS_SPECIAL_CHARACTER_LOADED 4
OR NOT HAS_MODEL_LOADED CAR_COLUMB
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
  	
	WAIT 0

ENDWHILE

// creates car

CREATE_CAR CAR_COLUMB 1542.9 -896.1975 10.6 baddie_car_fm2

SET_CAR_HEADING baddie_car_fm2 90.0 

//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor FALSE	

LOAD_CUTSCENE s2_ctg2

SET_CUTSCENE_OFFSET 1573.8866 -906.0611 11.1

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_curly

SET_CUTSCENE_ANIM cs_curly curly

CREATE_CUTSCENE_OBJECT PED_SPECIAL3 cs_miguel

SET_CUTSCENE_ANIM cs_miguel miguel

CREATE_CUTSCENE_OBJECT PED_SPECIAL4 cs_catalina

SET_CUTSCENE_ANIM cs_catalina cat

CREATE_CUTSCENE_HEAD cs_miguel CUT_OBJ1 cs_miguelhead

SET_CUTSCENE_HEAD_ANIM cs_miguelhead miguel

CREATE_CUTSCENE_HEAD cs_catalina CUT_OBJ2 cs_catalinahead

SET_CUTSCENE_HEAD_ANIM cs_catalinahead cat

CREATE_CUTSCENE_HEAD cs_curly CUT_OBJ3 cs_curlyhead

SET_CUTSCENE_HEAD_ANIM cs_curlyhead curly

CLEAR_AREA 898.6 -425.6 13.9 1.0 TRUE 

//SET_PLAYER_COORDINATES player 898.6 -425.6 13.9  // Player is in a taxi so don't comment back in

DO_FADE 1500 FADE_IN

DELETE_CHAR curley_bob_fm2

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time <= 0
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_F ) 10000 1 //"Here comes our little friend. Mr. big mouth himself."

WHILE cs_time < 3225
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_G ) 10000 1 //"Were you followed? You know what goes on here is our little secret."

WHILE cs_time < 7047 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_H ) 10000 1 //"No..no, I wasn't followed, You got my stuff?"

WHILE cs_time < 10272
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_I ) 10000 1 //"Here's your SPANK, squealer, now talk."

WHILE cs_time < 13914
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_P ) 10000 1 //"OK, so the Leone's are fighting wars on two fronts."

WHILE cs_time < 16721
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_Q ) 10000 1 //"They're in a turf war with the Triads with no sign of either side giving up."

WHILE cs_time < 20483
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_R ) 10000 1 //"Meanwhile Loey Leone has stirred up some bad blood with the Forellis."

WHILE cs_time < 24246
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_S ) 10000 1 //"Every day they're losing men and influence in the city."

WHILE cs_time < 26993
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_T ) 10000 1 //"Salvatore is becoming dangerous and paranoid. He suspects everybody and everything."

WHILE cs_time < 31770
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM2_U ) 10000 1 //"With loyalty like yours, what has he possibly got to worry about."

WHILE cs_time < 35267
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( FM2_U )

WHILE cs_time < 37000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

IF flag_car_fm2_dead = 0

	IF NOT IS_CAR_DEAD car_fm2
		DELETE_CHAR van_driver_fm2
		DELETE_CAR car_fm2
		flag_car_fm2_dead = 0	
	ENDIF

ENDIF

DELETE_CAR baddie_car_fm2 

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

SET_CAMERA_BEHIND_PLAYER

UNLOAD_SPECIAL_CHARACTER 3
UNLOAD_SPECIAL_CHARACTER 4
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_COLUMB
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3


// ******************************************END OF CUTSCENE TWO****************************

 

// ********************************Kill Curley Bob Stuff************************************

SWITCH_WIDESCREEN OFF

RESTORE_CAMERA

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 1493.7 -886.6 -100.0 curley_bob_fm2

SET_CHAR_HEADING curley_bob_fm2 90.0

GIVE_WEAPON_TO_CHAR curley_bob_fm2 WEAPONTYPE_SHOTGUN 30000

SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS curley_bob_fm2 player

ADD_BLIP_FOR_CHAR curley_bob_fm2 radar_blip_ped2_fm2

PRINT_NOW ( FM2_8 ) 7000 1 //"Kill Curley Bob for his treachery!"

WHILE NOT flag_curley_bob_dead_fm2 = 1

	WAIT 0

IF flag_curley_bob_dead_fm2 = 0
	
	IF IS_CHAR_DEAD curley_bob_fm2
		flag_curley_bob_dead_fm2 = 1
	ELSE
		
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D player curley_bob_fm2 25.0 25.0 25.0 FALSE

			IF flag_curly_mad_fm2 = 0
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS curley_bob_fm2 player
				flag_curly_mad_fm2 = 1
			ENDIF

		ELSE
			flag_curly_mad_fm2 = 0
			SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS curley_bob_fm2 player
		ENDIF
			 

		IF NOT IS_CHAR_ON_SCREEN curley_bob_fm2
		AND NOT LOCATE_PLAYER_ANY_MEANS_CHAR_3D player curley_bob_fm2 160.0 160.0 80.0 FALSE
			PRINT_NOW ( FM2_10 ) 5000 1 //"Curly got away!"
			GOTO mission_frankie2_failed
		ENDIF
		
	ENDIF	
	
ENDIF		
            		
ENDWHILE

REMOVE_BLIP radar_blip_ped2_fm2

}
 
GOTO mission_frankie2_passed
	   		


// Mission Frankie2 failed

mission_frankie2_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
REMOVE_CHAR_ELEGANTLY curley_bob_fm2
RETURN

   

// mission Frankie2 passed

mission_frankie2_passed:

flag_frankie_mission2_passed = 1
REGISTER_MISSION_PASSED ( FM2 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( m_pass ) 15000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 15000
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT frankie_mission2.1_loop
START_NEW_SCRIPT toni4_pager_loop
	
IF flag_toni_mission5_passed = 0
	flag_frankie_switched_off = 1
	REMOVE_BLIP frankie_contact_blip
ENDIF

RETURN
		


// mission cleanup

mission_cleanup_frankie2:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_frankie_mission = 0

IF flag_car_fm2_dead = 0

	IF NOT IS_CAR_DEAD car_fm2
		CHANGE_CAR_LOCK car_fm2 CARLOCK_UNLOCKED
		SET_CAR_ONLY_DAMAGED_BY_PLAYER car_fm2 FALSE
	ENDIF

ENDIF
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_TAXI
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_COLUMB
MARK_MODEL_AS_NO_LONGER_NEEDED PED_TAXI_DRIVER
REMOVE_BLIP radar_blip_club_fm2 
REMOVE_BLIP radar_blip_ped1_fm2
REMOVE_BLIP radar_blip_coord2_fm2
REMOVE_BLIP radar_blip_car1_fm2
REMOVE_BLIP radar_blip_car2_fm2
REMOVE_BLIP radar_blip_ped2_fm2
SETUP_ZONE_PED_INFO PORT_E DAY 0 0 0 0 0 0 0 0 0
SETUP_ZONE_PED_INFO PORT_E NIGHT 0 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO PORT_E DAY 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO PORT_E NIGHT 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
CLEAR_ONSCREEN_COUNTER spooked_counter
MISSION_HAS_FINISHED
RETURN
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *************************************Frankie Mission 2.1*********************************
// ************************************Bomb Da Base Cash Wall*******************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
SCRIPT_NAME frank21

// Mission start stuff

GOSUB mission_start_frankie2.1

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_frankie2.1_failed
	ENDIF

GOSUB mission_cleanup_frankie2.1

MISSION_END

// ***************************************Start Mission*************************************

mission_start_frankie2.1:

flag_player_on_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_player_on_frankie_mission = 1

{
// ****************************************START OF CUTSCENE********************************

/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_frankie2.1_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( FM21 ) 15000 2 //"Bomb Da Base Part 1"

SWITCH_STREAMING OFF
*/

LOAD_SPECIAL_CHARACTER 1 FRANKIE
LOAD_SPECIAL_MODEL cut_obj1 FRANKH
//LOAD_SPECIAL_MODEL cut_obj2 PLAYERH
REQUEST_MODEL PED_GANG_MAFIA_B

REQUEST_MODEL franksclb02
REQUEST_MODEL salvsdetail
REQUEST_MODEL swank_inside

/*
WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE
*/

LOAD_ALL_MODELS_NOW
	
// Cutscene stuff

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED PED_GANG_MAFIA_B
//OR NOT HAS_MODEL_LOADED cut_obj2

	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED franksclb02
OR NOT HAS_MODEL_LOADED	salvsdetail
OR NOT HAS_MODEL_LOADED swank_inside

	WAIT 0

ENDWHILE

LOAD_CUTSCENE s3_rtc

SET_CUTSCENE_OFFSET 1457.776 -185.348 54.925

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_frankie

SET_CUTSCENE_ANIM cs_frankie frankie

CREATE_CUTSCENE_HEAD cs_frankie CUT_OBJ1 cs_frankiehead

SET_CUTSCENE_HEAD_ANIM cs_frankiehead frank

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead

//SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT PED_GANG_MAFIA_B cs_mafia

SET_CUTSCENE_ANIM cs_mafia gang02

CLEAR_AREA 1455.1 -187.8 -100.0 1.0 TRUE 

SET_PLAYER_COORDINATES player 1455.1 -187.8 -100.0 

SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time


WHILE cs_time < 27
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_A ) 10000 1 //"We should take these Colombian bastards out"

WHILE cs_time < 1972
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_B ) 10000 1 //"but while we're at war with the Triads we just ain't strong enough"


WHILE cs_time < 5136
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_C ) 10000 1 //"The Cartel has got bottomless funds from pushing this SPANK crap."

WHILE cs_time < 8848
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_D ) 10000 1 //"If we make an open attack on them, they'll wipe the floor with us."

WHILE cs_time < 12450
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_E ) 10000 1 //"They must be making SPANK on that big boat that Curly lead you to."

WHILE cs_time < 15984
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_F ) 10000 1 //"So we gotta use our heads -or rather one head. Your head."

WHILE cs_time < 20426
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_G ) 10000 1 //"I'm asking you to destroy that SPANK factory as a personal favor to me, Salvatore Leone."

WHILE cs_time < 27076
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_H ) 10000 1 //"If you do this for me, you will be a made man -anything you want."

WHILE cs_time < 32651
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_I ) 10000 1 //"Go and see 8-Ball, you'll need his expertise to blow-up that boat."

WHILE cs_time < 36233
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( FM3_I )

WHILE cs_time < 38333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_B
//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2


MARK_MODEL_AS_NO_LONGER_NEEDED franksclb02

MARK_MODEL_AS_NO_LONGER_NEEDED salvsdetail

MARK_MODEL_AS_NO_LONGER_NEEDED swank_inside

// **************************************END OF CUTSCENE************************************
	
} 
GOTO mission_frankie2.1_passed


// Mission Frankie2.1 failed

mission_frankie2.1_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN


// mission Frankie2.1 passed

mission_frankie2.1_passed:

flag_frankie_mission2.1_passed = 1
flag_frankie_switched_off = 1
REGISTER_MISSION_PASSED ( FM21 )
PLAYER_MADE_PROGRESS 1
REMOVE_BLIP frankie_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1272.2 -92.9 -100.0 RADAR_SPRITE_EIGHT eightball_contact_blip   
START_NEW_SCRIPT frankie_mission3_loop
RETURN
		


// mission cleanup

mission_cleanup_frankie2.1:

flag_player_on_mission = 0
flag_player_on_frankie_mission = 0
MISSION_HAS_FINISHED
RETURN

  
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *************************************Frankie Mission 3***********************************
// ***************************************"BOMB DA BASE"************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME frank3

// Mission start stuff

GOSUB mission_start_frankie3

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_frankie3_failed
	ENDIF

GOSUB mission_cleanup_frankie3

MISSION_END


// Variables for mission

VAR_INT ped_8ball_fm3

VAR_INT radar_blip_ped2_fm3

VAR_INT radar_blip_coord3_fm3

VAR_INT guard1_fm3

VAR_INT guard2_fm3

VAR_INT guard3_fm3

VAR_INT guard4_fm3

VAR_INT guard5_fm3

VAR_INT guard6_fm3

VAR_INT guard7_fm3

VAR_INT guard8_fm3

VAR_INT guard9_fm3

VAR_INT guard10_fm3

VAR_INT guard11_fm3 

VAR_INT guard12_fm3

VAR_INT car_fm3

VAR_INT timer_fm3

VAR_INT radar_blip_coord2_fm3

VAR_INT flag_bloke_leave_group_fm3

VAR_INT flag_bloke_in_area_fm3

VAR_INT flag_guard1_fm3_dead

VAR_INT flag_guard2_fm3_dead

VAR_INT flag_guard3_fm3_dead

VAR_INT flag_guard4_fm3_dead

VAR_INT flag_guard5_fm3_dead

VAR_INT flag_guard6_fm3_dead

VAR_INT flag_guard7_fm3_dead

VAR_INT flag_guard8_fm3_dead

VAR_INT flag_guard9_fm3_dead

VAR_INT flag_guard10_fm3_dead

VAR_INT flag_guard11_fm3_dead

VAR_INT flag_guard12_fm3_dead

VAR_INT flag_got_message_fm3

VAR_INT flag_on_frankie3

VAR_INT flag_guard3_fm3_created

VAR_INT flag_guard4_fm3_created

VAR_INT flag_guard5_fm3_created

VAR_INT flag_guard6_fm3_created

VAR_INT flag_blip_on_eightball_fm3

// guards told to look for 8ball

VAR_INT flag_guard1_looking_for_8ball

VAR_INT flag_guard2_looking_for_8ball

VAR_INT flag_guard3_looking_for_8ball

VAR_INT flag_guard4_looking_for_8ball

VAR_INT flag_guard5_looking_for_8ball

VAR_INT flag_guard6_looking_for_8ball

VAR_INT flag_guard7_looking_for_8ball

VAR_INT flag_guard8_looking_for_8ball

VAR_INT flag_guard9_looking_for_8ball

VAR_INT flag_guard10_looking_for_8ball

VAR_INT flag_guard11_looking_for_8ball

VAR_INT flag_guard12_looking_for_8ball

VAR_INT flag_8ball_ordered_area1

VAR_INT crate_fm3

VAR_INT flag_drop_crate_fm3

VAR_INT counter_no_guards_dead_fm3  // Check to see if the player is cheating

VAR_INT flag_played_cops_audio_fm3

VAR_INT flag_played_8ball_audio_fm3

VAR_INT flag_gun_help1_fm3

VAR_INT flag_gun_help2_fm3

VAR_INT flag_gun_help3_fm3

VAR_INT flag_timer_fm3

VAR_INT flag_timer2_fm3

VAR_INT flag_timer3_fm3

VAR_INT flag_timer4_fm3

VAR_INT boat_barrel7

VAR_INT boat_barrel8

VAR_INT boat_barrel9

VAR_INT boat_barrel10

VAR_INT boat_barrel11

VAR_INT boat_barrel12

VAR_INT boat_barrel13

VAR_INT boat_barrel14

VAR_INT boat_barrel15

VAR_INT boat_barrel16

VAR_INT boat_barrel17

VAR_FLOAT eightball_x_fm3

VAR_FLOAT eightball_y_fm3

VAR_FLOAT eightball_z_fm3

VAR_INT car_columb1_fm3

VAR_INT car_columb2_fm3

VAR_INT flag_columb_car1_dead

VAR_INT flag_columb_car2_dead

VAR_INT flag_audio_cops_loaded_fm3

VAR_INT flag_timer_set_fm3 // if 8ball gets stuck timer to warp him to his next location

VAR_INT flag_8ball_moved1  // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_8ball_moved2 // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_8ball_moved3 // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_8ball_moved4 // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_8ball_moved5 // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_8ball_moved6 // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_8ball_moved7 // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_8ball_moved8 // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_8ball_moved9 // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_8ball_moved10 // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_8ball_moved11 // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_8ball_moved12 // if 8ball gets stuck these will warp him to his next location

VAR_INT flag_car_marked_fm3

VAR_INT flag_8ball_ducking_fm3


// ***************************************Start Mission*************************************

mission_start_frankie3:

flag_player_on_mission = 1

flag_player_on_frankie_mission = 1

WAIT 0

flag_on_frankie3 = 0

flag_bloke_leave_group_fm3 = 0

flag_bloke_in_area_fm3 = 0

timer_fm3 = 25000  // 25 secs

flag_guard1_fm3_dead = 0

flag_guard2_fm3_dead = 0

flag_guard3_fm3_dead = 0

flag_guard4_fm3_dead = 0

flag_guard5_fm3_dead = 0

flag_guard6_fm3_dead = 0

flag_guard7_fm3_dead = 0

flag_guard8_fm3_dead = 0

flag_guard9_fm3_dead = 0

flag_guard10_fm3_dead = 0

flag_guard11_fm3_dead = 0

flag_guard12_fm3_dead = 0

flag_got_message_fm3 = 0

flag_guard3_fm3_created = 0

flag_guard4_fm3_created = 0

flag_guard5_fm3_created = 0

flag_guard6_fm3_created = 0

flag_blip_on_eightball_fm3 = 0

flag_guard1_looking_for_8ball = 0

flag_guard2_looking_for_8ball = 0

flag_guard3_looking_for_8ball = 0

flag_guard4_looking_for_8ball = 0

flag_guard5_looking_for_8ball = 0

flag_guard6_looking_for_8ball = 0

flag_guard7_looking_for_8ball = 0

flag_guard8_looking_for_8ball = 0

flag_guard9_looking_for_8ball = 0

flag_guard10_looking_for_8ball = 0

flag_guard11_looking_for_8ball = 0

flag_guard12_looking_for_8ball = 0

flag_8ball_ordered_area1 = 0

flag_drop_crate_fm3 = 0

counter_no_guards_dead_fm3 = 0

blob_flag = 1

flag_played_cops_audio_fm3 = 0

flag_played_8ball_audio_fm3 = 0

flag_gun_help1_fm3 = 0

flag_gun_help2_fm3 = 0

flag_gun_help3_fm3 = 0

flag_timer_fm3 = 0

flag_timer2_fm3 = 0

flag_timer3_fm3 = 0

flag_timer4_fm3 = 0

eightball_x_fm3 = 0.0

eightball_y_fm3 = 0.0

eightball_z_fm3 = 0.0

flag_columb_car1_dead = 0

flag_columb_car2_dead = 0

flag_audio_cops_loaded_fm3 = 0

flag_timer_set_fm3 = 0

flag_8ball_moved1 = 0

flag_8ball_moved2 = 0

flag_8ball_moved3 = 0

flag_8ball_moved4 = 0

flag_8ball_moved5 = 0

flag_8ball_moved6 = 0

flag_8ball_moved7 = 0

flag_8ball_moved8 = 0

flag_8ball_moved9 = 0

flag_8ball_moved10 = 0

flag_8ball_moved11 = 0

flag_8ball_moved12 = 0

flag_car_marked_fm3 = 0

flag_8ball_ducking_fm3 = 0

{


IF flag_player_had_cut1_fm3 = 1

	IF flag_taken_money_off_fm3 = 1
	OR IS_SCORE_GREATER player 99999
		GOTO player_has_money
	ENDIF

ENDIF
  
player_not_got_money:

CLEAR_AREA 1272.6 -95.6 -100.0 2.0 TRUE


// ************************START OF CUTSCENE TWO "PLAYER NOT GOT THE MONEY"*****************

/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_frankie3_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( FM3 ) 15000 2 //"Bomb Da Base"

SWITCH_STREAMING OFF
*/

LOAD_SPECIAL_CHARACTER 1 EIGHT2
LOAD_SPECIAL_MODEL cut_obj1 EITDOOR
LOAD_SPECIAL_MODEL cut_obj2 EIGHTH
LOAD_SPECIAL_MODEL cut_obj3 PLAYERH
REQUEST_MODEL ind_land089c
REQUEST_MODEL mak_semtech
REQUEST_MODEL mak_bomb01

LOAD_ALL_MODELS_NOW
	
// Cutscene stuff

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj1

	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED ind_land089c
OR NOT HAS_MODEL_LOADED mak_semtech
OR NOT HAS_MODEL_LOADED mak_bomb01

	WAIT 0
	
ENDWHILE  

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1271.8 -91.3 13.9 3.0 cs8_door FALSE	

LOAD_CUTSCENE s4_bdba

SET_CUTSCENE_OFFSET 1272.5 -90.7 13.8

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_eight

SET_CUTSCENE_ANIM cs_eight eight2

CREATE_CUTSCENE_HEAD cs_eight CUT_OBJ2 cs_eighthead

SET_CUTSCENE_HEAD_ANIM cs_eighthead eight

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ3 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj1 cs_eitdoor

SET_CUTSCENE_ANIM cs_eitdoor EITDOOR

CLEAR_AREA 1272.6 -95.6 -100.0 1.0 TRUE

SET_PLAYER_COORDINATES player 1272.6 -95.6 -100.0

SET_PLAYER_HEADING player 270.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2849
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_8A ) 10000 1 //"Yo my man! Salvatore phoned ahead,"

WHILE cs_time < 5438
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_8B ) 10000 1 //"but a job like this is gonna' need a lot of fireworks."

WHILE cs_time < 8136
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_8C ) 10000 1 //"I'll need $100000 to cover expenses"

WHILE cs_time < 10752
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_8D ) 10000 1 //"but you know with me you get a lot of bang for your bucks."

WHILE cs_time < 13578
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_CC ) 10000 1 //"Come back when you have the money."

WHILE cs_time < 14964
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( FM3_CC )

WHILE cs_time < 15666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1271.8 -91.3 13.9 3.0 cs8_door TRUE

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED ind_land089c
MARK_MODEL_AS_NO_LONGER_NEEDED mak_semtech
MARK_MODEL_AS_NO_LONGER_NEEDED mak_bomb01

// ************************END OF CUTSCENE TWO "PLAYER NOT GOT THE MONEY********************

flag_player_had_cut1_fm3 = 1

GOTO mission_cleanup_frankie3

player_has_money:

CLEAR_AREA 1272.6 -95.6 -100.0 2.0 TRUE

// ********************************START OF CUTSCENE ONE "GOT THE MONEY"********************

/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_frankie3_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( FM3 ) 15000 2 //"Bomb Da Base"

SWITCH_STREAMING OFF
*/

LOAD_SPECIAL_CHARACTER 1 EIGHT2
LOAD_SPECIAL_MODEL cut_obj1 EITDOOR
LOAD_SPECIAL_MODEL cut_obj2 EIGHTH
LOAD_SPECIAL_MODEL cut_obj3 PLAYERH
LOAD_SPECIAL_MODEL cut_obj4 rifle
LOAD_SPECIAL_MODEL cut_obj5	cs_bomb
REQUEST_MODEL ind_land089c
REQUEST_MODEL mak_semtech
REQUEST_MODEL mak_bomb01

LOAD_ALL_MODELS_NOW
	
// Cutscene stuff

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj4
OR NOT HAS_MODEL_LOADED cut_obj5

	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED ind_land089c
OR NOT HAS_MODEL_LOADED mak_semtech
OR NOT HAS_MODEL_LOADED mak_bomb01

	WAIT 0
	
ENDWHILE 

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1271.8 -91.3 13.9 3.0 cs8_door FALSE	

LOAD_CUTSCENE s4_bdbb

SET_CUTSCENE_OFFSET 1272.5 -90.7 13.8

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_eight

SET_CUTSCENE_ANIM cs_eight eight2

CREATE_CUTSCENE_HEAD cs_eight CUT_OBJ2 cs_eighthead

SET_CUTSCENE_HEAD_ANIM cs_eighthead eight

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ3 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj1 cs_eitdoor

SET_CUTSCENE_ANIM cs_eitdoor EITDOOR

CREATE_CUTSCENE_OBJECT cut_obj4 cs_rifle

SET_CUTSCENE_ANIM cs_rifle rifle

CREATE_CUTSCENE_OBJECT cut_obj5 cs_bomb

SET_CUTSCENE_ANIM cs_bomb cs_bomb

CLEAR_AREA 1272.6 -95.6 -100.0 1.0 TRUE

SET_PLAYER_COORDINATES player 1272.6 -95.6 -100.0

SET_PLAYER_HEADING player 270.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 3123
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_8E ) 10000 1 //"Okay, let's do this thing!"

WHILE cs_time < 4903
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_8F ) 10000 1 //"I can set this baby to detonate, but I still can't use a piece with these hands."

WHILE cs_time < 8643
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM3_8G ) 10000 1 //"Here, this rifle should help you pop some heads!"

WHILE cs_time < 10635
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( FM3_8G )

WHILE cs_time < 17000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1271.8 -91.3 13.9 3.0 cs8_door TRUE

//UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ4
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ5
MARK_MODEL_AS_NO_LONGER_NEEDED ind_land089c
MARK_MODEL_AS_NO_LONGER_NEEDED mak_semtech
MARK_MODEL_AS_NO_LONGER_NEEDED mak_bomb01


//GOTO wiltest  //TEST STUFF TO COME OUT!!!!!!!!!!!!!!





// ********************************END OF CUTSCENE ONE "GOT THE MONEY"**********************

IF flag_taken_money_off_fm3 = 0
	ADD_SCORE player -100000
	REGISTER_MISSION_GIVEN
	flag_taken_money_off_fm3 = 1
ENDIF


// *********************************START OF THE MISSION STUFF******************************

REQUEST_MODEL PED_GANG_COLOMBIAN_A

REQUEST_MODEL PED_GANG_COLOMBIAN_B

REQUEST_MODEL barrel4

REQUEST_MODEL CAR_COLUMB


WHILE NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_B
OR NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_A
OR NOT HAS_MODEL_LOADED barrel4
OR NOT HAS_MODEL_LOADED CAR_COLUMB
//OR NOT HAS_SPECIAL_CHARACTER_LOADED 1

	WAIT 0

ENDWHILE

SETUP_ZONE_PED_INFO PORT_E DAY 0 0 0 0 0 0 0 0 0
SETUP_ZONE_PED_INFO PORT_E NIGHT 0 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO PORT_E DAY 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO PORT_E NIGHT 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

// barrels on the boat 1 - 6, 10 - 14 removed as they were doubles

CREATE_OBJECT barrel4 1535.15 -930.763 18.7294 boat_barrel7

CREATE_OBJECT barrel4 1535.18 -929.604 18.7294 boat_barrel8

CREATE_OBJECT barrel4 1535.21 -928.446 18.7294 boat_barrel9

CREATE_OBJECT barrel4 1484.85 -942.803 18.7328 boat_barrel15

CREATE_OBJECT barrel4 1483.69 -942.752 18.7328 boat_barrel16

CREATE_OBJECT barrel4 1482.53 -942.701 18.7328 boat_barrel17

CLEAR_AREA 1272.8 -96.5 -100.0 1.0 TRUE

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 1272.8 -96.5 -100.0 ped_8ball_fm3

SET_CHAR_HEADING ped_8ball_fm3 270.0

CLEAR_CHAR_THREAT_SEARCH ped_8ball_fm3

CHAR_SET_IDLE ped_8ball_fm3

GIVE_WEAPON_TO_PLAYER player WEAPONTYPE_SNIPERRIFLE 30

SET_CURRENT_PLAYER_WEAPON player WEAPONTYPE_SNIPERRIFLE

SET_PLAYER_AS_LEADER ped_8ball_fm3 player

ADD_BLIP_FOR_COORD 1529.0 -824.0 -100.0 radar_blip_coord2_fm3

WHILE GET_FADING_STATUS

	WAIT 0

	IF IS_CHAR_DEAD ped_8ball_fm3
		PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
		GOTO mission_frankie3_failed
	ENDIF

	IF NOT IS_CHAR_IN_PLAYERS_GROUP ped_8ball_fm3 player
	AND flag_blip_on_eightball_fm3 = 0
		PRINT_NOW ( HEY3 ) 5000 1 //"You have left 8-ball behind go and get him!"
		ADD_BLIP_FOR_CHAR ped_8ball_fm3 radar_blip_ped2_fm3
		REMOVE_BLIP radar_blip_coord2_fm3
		blob_flag = 0
		flag_blip_on_eightball_fm3 = 1
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_8ball_fm3 8.0 8.0 FALSE
	AND flag_blip_on_eightball_fm3 = 1
		SET_PLAYER_AS_LEADER ped_8ball_fm3 player
		REMOVE_BLIP radar_blip_ped2_fm3
		ADD_BLIP_FOR_COORD 1529.0 -824.0 -100.0 radar_blip_coord2_fm3
		blob_flag = 1
		flag_blip_on_eightball_fm3 = 0
	ENDIF

ENDWHILE

LOAD_MISSION_AUDIO S3_A

timera = 0

WHILE timera < 7000
OR NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0

	IF IS_CHAR_DEAD ped_8ball_fm3
		PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
		GOTO mission_frankie3_failed
	ENDIF

	IF NOT IS_CHAR_IN_PLAYERS_GROUP ped_8ball_fm3 player
	AND flag_blip_on_eightball_fm3 = 0
		PRINT_NOW ( HEY3 ) 5000 1 //"You have left 8-ball behind go and get him!"
		ADD_BLIP_FOR_CHAR ped_8ball_fm3 radar_blip_ped2_fm3
		REMOVE_BLIP radar_blip_coord2_fm3
		blob_flag = 0
		flag_blip_on_eightball_fm3 = 1
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_8ball_fm3 8.0 8.0 FALSE
	AND flag_blip_on_eightball_fm3 = 1
		SET_PLAYER_AS_LEADER ped_8ball_fm3 player
		REMOVE_BLIP radar_blip_ped2_fm3
		ADD_BLIP_FOR_COORD 1529.0 -824.0 -100.0 radar_blip_coord2_fm3
		blob_flag = 1
		flag_blip_on_eightball_fm3 = 0
	ENDIF

	IF flag_gun_help1_fm3 = 0

		PRINT_HELP ( HELP7_A ) //"Press and hold the R1 button to target with the sniper rifle."
		flag_gun_help1_fm3 = 1

	ENDIF

ENDWHILE

timera = 0

WHILE timera < 7000

	WAIT 0

	IF IS_CHAR_DEAD ped_8ball_fm3
		PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
		GOTO mission_frankie3_failed
	ENDIF

	IF NOT IS_CHAR_IN_PLAYERS_GROUP ped_8ball_fm3 player
	AND flag_blip_on_eightball_fm3 = 0
		PRINT_NOW ( HEY3 ) 5000 1 //"You have left 8-ball behind go and get him!"
		ADD_BLIP_FOR_CHAR ped_8ball_fm3 radar_blip_ped2_fm3
		REMOVE_BLIP radar_blip_coord2_fm3
		blob_flag = 0
		flag_blip_on_eightball_fm3 = 1
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_8ball_fm3 8.0 8.0 FALSE
	AND flag_blip_on_eightball_fm3 = 1
		SET_PLAYER_AS_LEADER ped_8ball_fm3 player
		REMOVE_BLIP radar_blip_ped2_fm3
		ADD_BLIP_FOR_COORD 1529.0 -824.0 -100.0 radar_blip_coord2_fm3
		blob_flag = 1
		flag_blip_on_eightball_fm3 = 0
	ENDIF

	IF flag_gun_help2_fm3 = 0

		PRINT_HELP ( HELP8_A ) //"Press the ^ button to zoom in with the rifle and the / button to zoom out again."
		flag_gun_help2_fm3 = 1

	ENDIF

ENDWHILE

timera = 0

WHILE timera < 7000

	WAIT 0

	IF IS_CHAR_DEAD ped_8ball_fm3
		PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
		GOTO mission_frankie3_failed
	ENDIF

	IF NOT IS_CHAR_IN_PLAYERS_GROUP ped_8ball_fm3 player
	AND flag_blip_on_eightball_fm3 = 0
		PRINT_NOW ( HEY3 ) 5000 1 //"You have left 8-ball behind go and get him!"
		ADD_BLIP_FOR_CHAR ped_8ball_fm3 radar_blip_ped2_fm3
		REMOVE_BLIP radar_blip_coord2_fm3
		blob_flag = 0
		flag_blip_on_eightball_fm3 = 1
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_8ball_fm3 8.0 8.0 FALSE
	AND flag_blip_on_eightball_fm3 = 1
		SET_PLAYER_AS_LEADER ped_8ball_fm3 player
		REMOVE_BLIP radar_blip_ped2_fm3
		ADD_BLIP_FOR_COORD 1529.0 -824.0 -100.0 radar_blip_coord2_fm3
		blob_flag = 1
		flag_blip_on_eightball_fm3 = 0
	ENDIF

	IF flag_gun_help3_fm3 = 0

		PRINT_HELP ( HELP9_A ) //"Press the | button to fire the sniper rifle."
		flag_gun_help3_fm3 = 1

	ENDIF

ENDWHILE

//sets up the default guards on the boat

//guard1 on quayside righthand side of the ramp

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1524.0 -900.0 -100.0 guard1_fm3

TURN_CHAR_TO_FACE_COORD guard1_fm3 1524.0 -887.0 -100.0  

GIVE_WEAPON_TO_CHAR guard1_fm3 WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard1_fm3

SET_CHAR_THREAT_SEARCH guard1_fm3 THREAT_PLAYER1

SET_CHAR_PERSONALITY guard1_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard1_fm3 true

//guard2 on quayside left side of the ramp

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 1530.0 -901.0 -100.0 guard2_fm3

TURN_CHAR_TO_FACE_COORD guard2_fm3 1530.0 -887.0 -100.0  

GIVE_WEAPON_TO_CHAR guard2_fm3 WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard2_fm3

SET_CHAR_THREAT_SEARCH guard2_fm3 THREAT_PLAYER1

SET_CHAR_PERSONALITY guard2_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard2_fm3 true

//guard3 on boat left hand side by exploding creates

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1534.6 -936.8 18.4 guard3_fm3 //follows route 0

ADD_ROUTE_POINT 0 1533.9 -926.0 -100.0

ADD_ROUTE_POINT 0 1534.6 -936.8 -100.0

SET_CHAR_OBJ_FOLLOW_ROUTE guard3_fm3 0 follow_route_loop 

GIVE_WEAPON_TO_CHAR guard3_fm3 WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard3_fm3

SET_CHAR_THREAT_SEARCH guard3_fm3 THREAT_PLAYER1

SET_CHAR_PERSONALITY guard3_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard3_fm3 true
 

//guard4 on boat walks behind the large containers towards the rear of the shop

CREATE_CHAR	PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 1510.2 -941.7 18.4 guard4_fm3  //follows route 1

ADD_ROUTE_POINT 1 1527.5 -942.9 -100.0

ADD_ROUTE_POINT 1 1510.2 -941.7 -100.0

SET_CHAR_OBJ_FOLLOW_ROUTE guard4_fm3 1 follow_route_loop

GIVE_WEAPON_TO_CHAR guard4_fm3 WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard4_fm3

SET_CHAR_THREAT_SEARCH guard4_fm3 THREAT_PLAYER1

SET_CHAR_PERSONALITY guard4_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard4_fm3 true

//guard5 on boat just behid the first row of boxes

CREATE_CHAR	PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1502.6 -926.7 -100.0 guard5_fm3  //follows route 2

ADD_ROUTE_POINT 2 1512.2 -927.6 -100.0

ADD_ROUTE_POINT 2 1502.6 -926.7 -100.0

SET_CHAR_OBJ_FOLLOW_ROUTE guard5_fm3 2 follow_route_loop

GIVE_WEAPON_TO_CHAR guard5_fm3 WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard5_fm3

SET_CHAR_THREAT_SEARCH guard5_fm3 THREAT_PLAYER1

SET_CHAR_THREAT_SEARCH guard5_fm3 THREAT_SPECIAL

SET_CHAR_PERSONALITY guard5_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard5_fm3 true

//guard6 on boat by the rail of the boat

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 1472.5 -917.7 -100.0 guard6_fm3  //follows route 3

ADD_ROUTE_POINT 3 1507.1 -918.7 -100.0

ADD_ROUTE_POINT 3 1472.5 -917.7 -100.0

SET_CHAR_OBJ_FOLLOW_ROUTE guard6_fm3 3 follow_route_loop 

GIVE_WEAPON_TO_CHAR guard6_fm3 WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard6_fm3

SET_CHAR_THREAT_SEARCH guard6_fm3 THREAT_PLAYER1

SET_CHAR_PERSONALITY guard6_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard6_fm3 true


//guard7 on boat end of large boxes by crate 4

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1500.3 -922.2 -100.0 guard7_fm3  //follows route 4

ADD_ROUTE_POINT 4 1499.1 -943.7 -100.0

ADD_ROUTE_POINT 4 1500.3 -922.2 -100.0

SET_CHAR_OBJ_FOLLOW_ROUTE guard7_fm3 4 follow_route_loop 

GIVE_WEAPON_TO_CHAR guard7_fm3 WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard7_fm3

SET_CHAR_THREAT_SEARCH guard7_fm3 THREAT_PLAYER1

SET_CHAR_PERSONALITY guard7_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard7_fm3 true

//Guard8 between second last container and crates 5,6 and 7

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1489.5 -955.8 -100.0 guard8_fm3  //follows route 5

ADD_ROUTE_POINT 5 1490.2 -924.8 -100.0

ADD_ROUTE_POINT 5 1489.5 -955.8 -100.0

SET_CHAR_OBJ_FOLLOW_ROUTE guard8_fm3 5 follow_route_loop 

GIVE_WEAPON_TO_CHAR guard8_fm3 WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard8_fm3

SET_CHAR_THREAT_SEARCH guard8_fm3 THREAT_PLAYER1

SET_CHAR_PERSONALITY guard8_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard8_fm3 true


//guard9 stands on top of crate6 does not patrol

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 1484.4 -930.5 19.8 guard9_fm3

TURN_CHAR_TO_FACE_COORD guard9_fm3 1487.8 -925.6 -100.0

GIVE_WEAPON_TO_CHAR guard9_fm3 WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard9_fm3

SET_CHAR_THREAT_SEARCH guard9_fm3 THREAT_PLAYER1

SET_CHAR_PERSONALITY guard9_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard9_fm3 true

//guard10 walks from right hand side boat door to behind containers and back again

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1476.8 -950.9 -100.0 guard10_fm3  //follows route 6

ADD_ROUTE_POINT 6 1476.8 -950.9 -100.0

ADD_ROUTE_POINT 6 1476.8 -927.2 -100.0

SET_CHAR_OBJ_FOLLOW_ROUTE guard10_fm3 6 follow_route_loop 

GIVE_WEAPON_TO_CHAR guard10_fm3 WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard10_fm3

SET_CHAR_THREAT_SEARCH guard10_fm3 THREAT_PLAYER1

SET_CHAR_PERSONALITY guard10_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard10_fm3 true


//guard11 on boat top right of the gang plank

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1524.0 -919.0 -100.0 guard11_fm3

TURN_CHAR_TO_FACE_COORD guard11_fm3 1525.0 -897.0 -100.0

GIVE_WEAPON_TO_CHAR guard11_fm3 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard11_fm3

SET_CHAR_THREAT_SEARCH guard11_fm3 THREAT_PLAYER1

SET_CHAR_PERSONALITY guard11_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard11_fm3 true

//guard12 on boat top left hand side of the gang plank

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1529.0 -919.0 -100.0 guard12_fm3

TURN_CHAR_TO_FACE_COORD guard12_fm3 1525.0 -897.0 -100.0

GIVE_WEAPON_TO_CHAR guard12_fm3 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

CLEAR_CHAR_THREAT_SEARCH guard12_fm3

SET_CHAR_THREAT_SEARCH guard12_fm3 THREAT_PLAYER1

SET_CHAR_PERSONALITY guard12_fm3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEED_THREATS guard12_fm3 true

CREATE_CAR CAR_COLUMB 1534.4 -891.5 10.8 car_columb1_fm3

SET_CAR_HEADING car_columb1_fm3 90.0

CREATE_CAR CAR_COLUMB 1515.7 -896.3 10.8 car_columb2_fm3

SET_CAR_HEADING car_columb2_fm3 314.0 


// waiting for the boat to be destroyed

blob_flag = 1

WHILE NOT flag_bloke_in_area_fm3 = 13 

	WAIT 0

	GOSUB car_dead_check
	
	GOSUB guard_death_check
	
	//GOSUB clear_area_check_fm3	   

	IF flag_bloke_leave_group_fm3 = 0

		IF counter_no_guards_dead_fm3 > 0
			PRINT_NOW ( FM3_8 ) 5000 1 //"The guards have been alerted!"
			GOTO mission_frankie3_failed
		ENDIF

	ENDIF
		
	IF IS_CHAR_DEAD ped_8ball_fm3
		PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
		GOTO mission_frankie3_failed
	ELSE
		GET_CHAR_COORDINATES ped_8ball_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
	ENDIF 
   
	IF flag_bloke_leave_group_fm3 = 0
			
		IF NOT IS_CHAR_IN_PLAYERS_GROUP ped_8ball_fm3 player
		AND flag_blip_on_eightball_fm3 = 0
			PRINT_NOW ( HEY3 ) 5000 1 //"You have left 8-ball behind go and get him!"
			ADD_BLIP_FOR_CHAR ped_8ball_fm3 radar_blip_ped2_fm3
			REMOVE_BLIP radar_blip_coord2_fm3
			blob_flag = 0
			flag_blip_on_eightball_fm3 = 1
		ENDIF
	
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_8ball_fm3 8.0 8.0 FALSE
		AND flag_blip_on_eightball_fm3 = 1
			SET_PLAYER_AS_LEADER ped_8ball_fm3 player
			REMOVE_BLIP radar_blip_ped2_fm3
			ADD_BLIP_FOR_COORD 1529.0 -824.0 -100.0 radar_blip_coord2_fm3
		   //	CHANGE_BLIP_DISPLAY radar_blip_coord2_fm3 blip_only 
			blob_flag = 1
			flag_blip_on_eightball_fm3 = 0
		ENDIF

	ENDIF

	IF IS_PLAYER_IN_ANY_CAR player
		STORE_CAR_PLAYER_IS_IN player car_fm3
	ENDIF

	IF IS_CHAR_DEAD ped_8ball_fm3
		PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
		GOTO mission_frankie3_failed
	ENDIF

IF flag_bloke_leave_group_fm3 = 0
	
	IF LOCATE_STOPPED_PLAYER_ANY_MEANS_2D player 1529.0 -824.0 3.0 4.0 blob_flag
	AND LOCATE_STOPPED_CHAR_ANY_MEANS_2D ped_8ball_fm3 1529.0 -824.0 3.0 4.0 TRUE
	AND flag_bloke_leave_group_fm3 = 0

		REMOVE_BLIP radar_blip_coord2_fm3
		LEAVE_GROUP ped_8ball_fm3
		flag_bloke_leave_group_fm3 = 1

		SWITCH_WIDESCREEN ON
		SET_PLAYER_CONTROL player OFF
		SET_POLICE_IGNORE_PLAYER player ON
		SET_EVERYONE_IGNORE_PLAYER player ON
	
		IF flag_got_message_fm3 = 0
		AND flag_bloke_leave_group_fm3 = 1
		
			IF flag_played_8ball_audio_fm3 = 0
				PLAY_MISSION_AUDIO
				flag_played_8ball_audio_fm3 = 1
			ENDIF 
	   		PRINT_NOW ( FM3_8I ) 5000 1 //"Get a good vantage point and I'll head in when you fire the first shot."
			ADD_BLIP_FOR_COORD 1498.7 -870.5 -100.0 radar_blip_coord3_fm3
	 		flag_bloke_in_area_fm3 = 1
			flag_got_message_fm3 = 1
		ENDIF

		WHILE NOT HAS_MISSION_AUDIO_FINISHED

			WAIT 0

			GOSUB car_dead_check
	
			GOSUB guard_death_check
	
			GOSUB clear_area_check_fm3

			IF IS_CHAR_DEAD ped_8ball_fm3
				PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
				GOTO mission_frankie3_failed
			ENDIF

		ENDWHILE

 // Camera looks at the boat and guards		

		SET_FIXED_CAMERA_POSITION 1543.01 -877.81 16.84 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT 1542.43 -878.62 16.75 JUMP_CUT

		IF flag_timer_fm3 = 0
			timera = 0
			flag_timer_fm3 = 1
		ENDIF

		WHILE timera <= 5000

			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO camera_jump_fm3
			ENDIF  
			
			GOSUB car_dead_check
	
			GOSUB guard_death_check
	
			GOSUB clear_area_check_fm3

			IF IS_CHAR_DEAD ped_8ball_fm3
				PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
				GOTO mission_frankie3_failed
			ENDIF

		ENDWHILE
		
		CLEAR_AREA 1536.8 -895.0 10.8 1.0 FALSE 
		SET_FIXED_CAMERA_POSITION 1537.1 -899.8 12.5 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT 1536.4 -900.4 12.7 JUMP_CUT

		IF flag_timer_fm3 = 1
		AND flag_timer2_fm3 = 0
			timera = 0
			flag_timer2_fm3 = 1
		ENDIF
		
		WHILE timera <= 5000

			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO camera_jump_fm3
			ENDIF  
			
			GOSUB car_dead_check
	
			GOSUB guard_death_check
	
			GOSUB clear_area_check_fm3

			IF IS_CHAR_DEAD ped_8ball_fm3
				PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
				GOTO mission_frankie3_failed
			ENDIF

		ENDWHILE

		CLEAR_AREA 1522.839 -916.137 19.602 1.0 FALSE 
		SET_FIXED_CAMERA_POSITION 1522.839 -916.137 19.602 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT 1521.984 -916.648 19.699 JUMP_CUT
		
		IF flag_timer3_fm3 = 0
		AND flag_timer2_fm3 = 1
			timera = 0
			flag_timer3_fm3 = 1
		ENDIF

		WHILE timera <= 5000

			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO camera_jump_fm3
			ENDIF

			GOSUB car_dead_check
	
			GOSUB guard_death_check
	
			GOSUB clear_area_check_fm3

			IF IS_CHAR_DEAD ped_8ball_fm3
				PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
				GOTO mission_frankie3_failed
			ENDIF

		ENDWHILE

		CLEAR_AREA 1476.3 -922.7 19.0 1.0 FALSE
		SET_FIXED_CAMERA_POSITION 1476.3 -922.7 19.0 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT 1477.1 -923.3 19.1 JUMP_CUT
		
		IF flag_timer4_fm3 = 0
		AND flag_timer3_fm3 = 1
			timera = 0
			flag_timer4_fm3 = 1
		ENDIF

		WHILE timera <= 5000
		
			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO camera_jump_fm3
			ENDIF

			GOSUB car_dead_check
	
			GOSUB guard_death_check
	
			GOSUB clear_area_check_fm3

			IF IS_CHAR_DEAD ped_8ball_fm3
				PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
				GOTO mission_frankie3_failed
			ENDIF

		ENDWHILE

camera_jump_fm3:

		RESTORE_CAMERA_JUMPCUT

		GOSUB car_dead_check
	
		GOSUB guard_death_check
	
		GOSUB clear_area_check_fm3

		IF IS_CHAR_DEAD ped_8ball_fm3
			PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
			GOTO mission_frankie3_failed
		ENDIF
		
		// checks to see if the player is in a vehicle

		IF IS_CHAR_IN_ANY_CAR ped_8ball_fm3

			//PRINT_NOW ( FM3_4 ) 7000 1 //"Stop the vehicle and let me out!"

			STORE_CAR_CHAR_IS_IN ped_8ball_fm3 car_fm3
											
			WHILE NOT IS_CAR_STOPPED car_fm3

				WAIT 0

				GOSUB car_dead_check
	
				GOSUB guard_death_check
	
				GOSUB clear_area_check_fm3
			   							
				IF IS_CAR_DEAD car_fm3

					IF IS_CHAR_DEAD ped_8ball_fm3
						PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
						GOTO mission_frankie3_failed
					ELSE
						PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle wrecked!"
						GOTO mission_frankie3_failed
					ENDIF

				ENDIF
								
				IF IS_CHAR_DEAD ped_8ball_fm3
					PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
					GOTO mission_frankie3_failed
				ENDIF

			ENDWHILE
					
			WAIT 0

			GOSUB car_dead_check
	
			GOSUB guard_death_check
	
			GOSUB clear_area_check_fm3
						
			IF IS_CAR_DEAD car_fm3

				IF IS_CHAR_DEAD ped_8ball_fm3
					PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
					GOTO mission_frankie3_failed
				ELSE
					PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle wrecked!"
					GOTO mission_frankie3_failed
				ENDIF

			ENDIF
								
			IF IS_CHAR_DEAD ped_8ball_fm3
				PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
				GOTO mission_frankie3_failed
			ENDIF
			
			SET_CHAR_OBJ_LEAVE_CAR ped_8ball_fm3 car_fm3

				WHILE IS_CHAR_IN_CAR ped_8ball_fm3 car_fm3

					WAIT 0

					GOSUB car_dead_check
	
					GOSUB guard_death_check
	
					GOSUB clear_area_check_fm3
					
					IF IS_CAR_DEAD car_fm3

						IF IS_CHAR_DEAD ped_8ball_fm3
							PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
							GOTO mission_frankie3_failed
						ELSE
							PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle wrecked!"
							GOTO mission_frankie3_failed
						ENDIF

					ENDIF
								
					IF IS_CHAR_DEAD ped_8ball_fm3
						PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
						GOTO mission_frankie3_failed
					ENDIF

				ENDWHILE

		ENDIF
				
		SWITCH_WIDESCREEN OFF
		SET_PLAYER_CONTROL player ON
		SET_POLICE_IGNORE_PLAYER player OFF
		SET_EVERYONE_IGNORE_PLAYER player OFF
		
	ENDIF
	
ENDIF

// tells players mate to go to his stageing area

IF flag_bloke_in_area_fm3 < 13

	GOSUB car_dead_check
	
	GOSUB guard_death_check
	
	GOSUB clear_area_check_fm3
	
	IF LOCATE_PLAYER_ON_FOOT_3D player 1498.7 -870.5 26.8 3.0 3.0 2.0 FALSE 
		REMOVE_BLIP radar_blip_coord3_fm3
	ENDIF

	IF flag_played_8ball_audio_fm3 = 1
	
		IF flag_played_cops_audio_fm3 = 0	

			IF HAS_MISSION_AUDIO_FINISHED 
				CLEAR_THIS_PRINT ( FM3_8I )
			ENDIF

		ENDIF

	ENDIF

	IF flag_bloke_in_area_fm3 = 1

		IF flag_8ball_ordered_area1 = 0
			SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1545.9 -867.7
			timera = 0
			flag_8ball_ordered_area1 = 1
		ENDIF
		
		IF flag_8ball_moved1 = 0

			IF timera >= 25000
			
				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1545.9 -867.7 1.0 1.0 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1545.9 -867.7 10.8
					flag_8ball_moved1 = 1
				ENDIF

			ENDIF
					
		ENDIF
		
		IF flag_8ball_ducking_fm3 = 0 
			
			IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1545.9 -867.7 1.0 1.0 FALSE
				flag_8ball_moved1 = 1
				SET_CHAR_WAIT_STATE ped_8ball_fm3 WAITSTATE_PLAYANIM_DUCK 10000
				flag_8ball_ducking_fm3 = 1
			ENDIF

		ENDIF

		IF counter_no_guards_dead_fm3 > 0
		OR IS_PLAYER_SHOOTING_IN_AREA player 1610.6 -614.6 1340.9 -1074.5 FALSE
				
			TIMERB = 0

			WHILE TIMERB < 5000

				WAIT 0

				GOSUB car_dead_check
	
				GOSUB guard_death_check
	
				GOSUB clear_area_check_fm3
				
				IF IS_CHAR_DEAD ped_8ball_fm3
					PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
					GOTO mission_frankie3_failed
				ENDIF

			ENDWHILE

			flag_bloke_in_area_fm3 = 2

			IF flag_car_marked_fm3 = 0
				MARK_CAR_AS_NO_LONGER_NEEDED car_columb1_fm3  
				MARK_CAR_AS_NO_LONGER_NEEDED car_columb2_fm3
			flag_car_marked_fm3 = 1
			ENDIF
			
		ENDIF


	ENDIF

// Bottom of boat ramp 

	IF flag_bloke_in_area_fm3 = 2
	
		SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1527.0 -899.0

		IF flag_timer_set_fm3 = 0
			timera = 0
			flag_timer_set_fm3 = 1
		ENDIF
		
		IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1527.0 -899.0 2.0 2.0 FALSE
			flag_8ball_moved2 = 1
			flag_bloke_in_area_fm3 = 3
		ENDIF

		IF flag_8ball_moved2 = 0

			IF timera >= 20000
		
				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1527.0 -899.0 2.0 2.0 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1527.0 -899.0 10.8
					flag_8ball_moved2 = 1
				ENDIF

			ENDIF
			
		ENDIF 	

	ENDIF

// Top of the boat ramp

	IF flag_bloke_in_area_fm3 = 3
					
		SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1526.0 -919.0

		IF flag_timer_set_fm3 = 1
			timera = 0
			flag_timer_set_fm3 = 2
		ENDIF
		
		IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1526.0 -919.0 2.0 2.0 FALSE
			flag_8ball_moved3 = 1
			flag_bloke_in_area_fm3 = 4
		ENDIF

		IF flag_8ball_moved3 = 0

			IF timera >= 20000

				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1526.0 -919.0 2.0 2.0 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1526.0 -919.0 18.4
					flag_8ball_moved3 = 1
				ENDIF
			
			ENDIF
			
		ENDIF  

	ENDIF

// create one on the boat
	
	IF flag_bloke_in_area_fm3 = 4
	
		SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1522.9 -924.3

		IF flag_timer_set_fm3 = 2
			timera = 0
			flag_timer_set_fm3 = 3
		ENDIF

		IF flag_8ball_moved4 = 0
		
			IF timera >= 25000
			   
				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1522.9 -924.3 1.0 1.0 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1522.9 -924.3 18.4
					flag_8ball_moved4 = 1
				ENDIF

			ENDIF

		ENDIF
		
		IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1522.9 -924.3 1.0 1.0 FALSE

			flag_8ball_moved4 = 1
									
			IF counter_no_guards_dead_fm3 < 12

				IF flag_8ball_ducking_fm3 = 1
					SET_CHAR_WAIT_STATE ped_8ball_fm3 WAITSTATE_PLAYANIM_DUCK 5000
					flag_8ball_ducking_fm3 = 2
				ENDIF

				TIMERB = 0

				WHILE TIMERB < 5000

					WAIT 0

					GOSUB car_dead_check
	
					GOSUB guard_death_check
	
					GOSUB clear_area_check_fm3
				
					IF IS_CHAR_DEAD ped_8ball_fm3
						PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
						GOTO mission_frankie3_failed
					ENDIF

				ENDWHILE

			ENDIF
				flag_bloke_in_area_fm3 = 5
		ENDIF
		
	ENDIF

// Create two on the boat

	IF flag_bloke_in_area_fm3 = 5
	
		SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1517.0 -929.0

		IF flag_timer_set_fm3 = 3
			timera = 0
			flag_timer_set_fm3 = 4
		ENDIF

		IF flag_8ball_moved5 = 0

			IF timera >= 25000
					
				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1517.0 -929.0 1.0 1.0 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1517.0 -929.0 18.4
					flag_8ball_moved5 = 1
				ENDIF
				
			ENDIF

		ENDIF
		
		IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1517.0 -929.0 1.0 1.0 FALSE

			flag_8ball_moved5 = 1

			LOAD_MISSION_AUDIO S3_B

			IF counter_no_guards_dead_fm3 < 12

				IF flag_8ball_ducking_fm3 = 2
					SET_CHAR_WAIT_STATE ped_8ball_fm3 WAITSTATE_PLAYANIM_DUCK 5000
					flag_8ball_ducking_fm3 = 3
				ENDIF
				
				TIMERB = 0

				WHILE TIMERB < 5000
				
					WAIT 0
					
					GOSUB car_dead_check
	
					GOSUB guard_death_check
	
					GOSUB clear_area_check_fm3
								
					IF IS_CHAR_DEAD ped_8ball_fm3
						PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
						GOTO mission_frankie3_failed
					ENDIF

				ENDWHILE

			ENDIF
			flag_bloke_in_area_fm3 = 6

			IF HAS_MISSION_AUDIO_LOADED
				flag_audio_cops_loaded_fm3 = 1
			ENDIF


			IF flag_played_cops_audio_fm3 = 0

				IF flag_audio_cops_loaded_fm3 = 1
					PLAY_MISSION_AUDIO
					flag_played_cops_audio_fm3 = 1
				ENDIF
								
			ENDIF
			
		ENDIF
		
	ENDIF

// Create three on the boat

	IF flag_bloke_in_area_fm3 = 6
	
		SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1510.0 -923.0

		IF flag_timer_set_fm3 = 4
			timera = 0
			flag_timer_set_fm3 = 5
		ENDIF

		IF flag_8ball_moved6 = 0

			IF timera >= 25000

				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1510.0 -923.0 1.0 1.0 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1510.0 -923.0 18.4
					flag_8ball_moved6 = 1
				ENDIF
				
			ENDIF
			
		ENDIF  

		IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1510.0 -923.0 1.0 1.0 FALSE

			flag_8ball_moved6 = 1

			IF counter_no_guards_dead_fm3 < 12

				IF flag_8ball_ducking_fm3 = 3
					SET_CHAR_WAIT_STATE ped_8ball_fm3 WAITSTATE_PLAYANIM_DUCK 5000
					flag_8ball_ducking_fm3 = 4
				ENDIF

				TIMERB = 0

				WHILE TIMERB < 5000

					WAIT 0

					GOSUB car_dead_check
	
					GOSUB guard_death_check
	
					GOSUB clear_area_check_fm3
								
					IF IS_CHAR_DEAD ped_8ball_fm3
						PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
						GOTO mission_frankie3_failed
					ENDIF

				ENDWHILE

			ENDIF
			flag_bloke_in_area_fm3 = 7
		ENDIF

	ENDIF

// Create four on the boat

	IF flag_bloke_in_area_fm3 = 7
	
		SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1504.4 -928.6

		IF flag_timer_set_fm3 = 5
			timera = 0
			flag_timer_set_fm3 = 6
		ENDIF

		IF flag_8ball_moved7 = 0

			IF timera >= 25000
				
				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1504.4 -928.6 1.0 1.0 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1504.4 -928.6 18.4
					flag_8ball_moved7 = 1
				ENDIF
				
			ENDIF
			
		ENDIF 

		IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1504.4 -928.6 1.0 1.0 FALSE

			flag_8ball_moved7 = 1

			IF counter_no_guards_dead_fm3 < 12

				IF flag_8ball_ducking_fm3 = 4
					SET_CHAR_WAIT_STATE ped_8ball_fm3 WAITSTATE_PLAYANIM_DUCK 5000
					flag_8ball_ducking_fm3 = 5
				ENDIF

				TIMERB = 0

				WHILE TIMERB < 5000

					WAIT 0

					GOSUB car_dead_check
	
					GOSUB guard_death_check
	
					GOSUB clear_area_check_fm3
								
					IF IS_CHAR_DEAD ped_8ball_fm3
						PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
						GOTO mission_frankie3_failed
					ENDIF

				ENDWHILE

			ENDIF
			flag_bloke_in_area_fm3 = 8
		ENDIF

	ENDIF

// Create five on the boat

	IF flag_bloke_in_area_fm3 = 8
	
		SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1493.7 -922.1

		IF flag_timer_set_fm3 = 6
			timera = 0
			flag_timer_set_fm3 = 7
		ENDIF

		IF flag_8ball_moved8 = 0

			IF timera >= 25000

				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1493.7 -922.1 1.0 1.0 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1493.7 -922.1 18.4
					flag_8ball_moved8 = 1
				ENDIF

			ENDIF

		ENDIF
		
		IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1493.7 -922.1 1.0 1.0 FALSE

			flag_8ball_moved8 = 1

			IF counter_no_guards_dead_fm3 < 12

				IF flag_8ball_ducking_fm3 = 5
					SET_CHAR_WAIT_STATE ped_8ball_fm3 WAITSTATE_PLAYANIM_DUCK 5000
					flag_8ball_ducking_fm3 = 6
				ENDIF

				TIMERB = 0

				WHILE TIMERB < 5000

					WAIT 0

					GOSUB car_dead_check
	
					GOSUB guard_death_check
	
					GOSUB clear_area_check_fm3
			   
					IF IS_CHAR_DEAD ped_8ball_fm3
						PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
						GOTO mission_frankie3_failed
					ENDIF

				ENDWHILE

			ENDIF
			flag_bloke_in_area_fm3 = 9
		ENDIF

	ENDIF

// Create six on the boat

	IF flag_bloke_in_area_fm3 = 9
	
		SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1487.0 -930.2

		IF flag_timer_set_fm3 = 7
			timera = 0
			flag_timer_set_fm3 = 8
		ENDIF

		IF flag_8ball_moved9 = 0

			IF timera >= 25000

				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1487.0 -930.2 1.0 1.0 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1487.0 -930.2 18.4
					flag_8ball_moved9 = 1
				ENDIF
				
			ENDIF
			
		ENDIF  

		IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1487.0 -930.2 1.0 1.0 FALSE

			flag_8ball_moved9 = 1

			IF counter_no_guards_dead_fm3 < 12

				IF flag_8ball_ducking_fm3 = 6
					SET_CHAR_WAIT_STATE ped_8ball_fm3 WAITSTATE_PLAYANIM_DUCK 5000
					flag_8ball_ducking_fm3 = 7
				ENDIF

				TIMERB = 0

				WHILE TIMERB < 5000

					WAIT 0

					GOSUB car_dead_check
	
					GOSUB guard_death_check
	
					GOSUB clear_area_check_fm3
			   
					IF IS_CHAR_DEAD ped_8ball_fm3
						PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
						GOTO mission_frankie3_failed
					ENDIF

				ENDWHILE

			ENDIF
			flag_bloke_in_area_fm3 = 10
		ENDIF

	ENDIF

// just past crate six

	IF flag_bloke_in_area_fm3 = 10
	
		SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1481.5 -926.8

		IF flag_timer_set_fm3 = 8
			timera = 0
			flag_timer_set_fm3 = 9
		ENDIF

		IF flag_8ball_moved10 = 0

			IF timera >= 15000

				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1481.5 -926.8 1.0 1.0 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1481.5 -926.8 18.4
					flag_8ball_moved10 = 1
				ENDIF
				
			ENDIF
			
		ENDIF  

		IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1481.5 -926.8 1.0 1.0 FALSE
			flag_8ball_moved10 = 1
			flag_bloke_in_area_fm3 = 11
		ENDIF

	ENDIF

// Outside the door on the boat

	IF flag_bloke_in_area_fm3 = 11
	
		SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1475.8 -940.3

		IF flag_timer_set_fm3 = 9
			timera = 0
			flag_timer_set_fm3 = 10
		ENDIF

		IF flag_8ball_moved11 = 0

			IF timera >= 15000

				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1475.8 -940.3 1.0 1.0 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1475.8 -940.3 18.4
					flag_8ball_moved11 = 1
				ENDIF
				
			ENDIF
			
		ENDIF  

		IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1475.8 -940.3 1.0 1.0 FALSE
			flag_8ball_moved11 = 1
			flag_bloke_in_area_fm3 = 12
		ENDIF

	ENDIF

// Inside the door on the boat

	IF flag_bloke_in_area_fm3 = 12
	
		SET_CHAR_OBJ_RUN_TO_COORD ped_8ball_fm3 1474.2 -940.2

		IF flag_timer_set_fm3 = 10
			timera = 0
			flag_timer_set_fm3 = 11
		ENDIF

		IF flag_8ball_moved12 = 0

			IF timera >= 25000

				IF NOT LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1474.2 -940.2 0.5 0.5 FALSE
					SET_CHAR_COORDINATES ped_8ball_fm3 1474.2 -940.2 18.4
					flag_8ball_moved12 = 1
				ENDIF
				
			ENDIF
			
		ENDIF 

		IF LOCATE_CHAR_ON_FOOT_2D ped_8ball_fm3 1474.2 -940.2 0.5 0.5 FALSE

			flag_8ball_moved12 = 1
			CHAR_SET_IDLE ped_8ball_fm3
			flag_bloke_in_area_fm3 = 13
			TIMERB = 0
			WHILE TIMERB < 3000

				WAIT 0

				GOSUB car_dead_check
	
				GOSUB guard_death_check
	
				GOSUB clear_area_check_fm3
				
				IF IS_CHAR_DEAD ped_8ball_fm3
					PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
					GOTO mission_frankie3_failed
				ENDIF

			ENDWHILE
			
		ENDIF

	ENDIF
   
ENDIF

ENDWHILE

// *********waiting for 8ball to place the bomb and then he legs it off of the boat********

timera = 0

WHILE timera < 3000

	WAIT 0

	GOSUB car_dead_check
	
	GOSUB guard_death_check
	
	IF IS_CHAR_DEAD ped_8ball_fm3
   		PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
   		GOTO mission_frankie3_failed
   	ENDIF
	
ENDWHILE


// ***********************************BOAT BLOWING UP CUTSCENE******************************

//wiltest:  // TEST STUFF TO COME OUT!!!!!!!!!!!!!!!!!!!!!!!!

GET_GAME_TIMER breakout_timer_start

breakout_diff = 0

WHILE NOT CAN_PLAYER_START_MISSION Player
AND breakout_diff < 5000	//	if player is not in control after 5 secs do the cutscene anyway

	WAIT 0

	IF IS_CHAR_DEAD ped_8ball_fm3
   		PRINT_NOW ( FM3_7 ) 5000 1 //"8-Ball's dead!"
   		GOTO mission_frankie3_failed
   	ENDIF

	GET_GAME_TIMER breakout_timer

	breakout_diff = breakout_timer - breakout_timer_start
	
ENDWHILE

MAKE_PLAYER_SAFE_FOR_CUTSCENE player 

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

// Cutscene stuff
LOAD_SPECIAL_MODEL cut_obj1 ship
LOAD_SPECIAL_MODEL cut_obj2 gangp
//LOAD_SPECIAL_CHARACTER 1 EIGHT2  // TEST STUFF

WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE


REMOVE_CHAR_ELEGANTLY guard1_fm3
REMOVE_CHAR_ELEGANTLY guard2_fm3
REMOVE_CHAR_ELEGANTLY guard3_fm3
REMOVE_CHAR_ELEGANTLY guard4_fm3
REMOVE_CHAR_ELEGANTLY guard5_fm3
REMOVE_CHAR_ELEGANTLY guard6_fm3
REMOVE_CHAR_ELEGANTLY guard7_fm3
REMOVE_CHAR_ELEGANTLY guard8_fm3
REMOVE_CHAR_ELEGANTLY guard9_fm3
REMOVE_CHAR_ELEGANTLY guard10_fm3
REMOVE_CHAR_ELEGANTLY guard11_fm3
REMOVE_CHAR_ELEGANTLY guard12_fm3


CLEAR_AREA 1519.02 -934.60 18.4 25.0 TRUE


DELETE_OBJECT boat_barrel7
DELETE_OBJECT boat_barrel8
DELETE_OBJECT boat_barrel9
DELETE_OBJECT boat_barrel15
DELETE_OBJECT boat_barrel16
DELETE_OBJECT boat_barrel17


LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
//OR NOT HAS_SPECIAL_CHARACTER_LOADED 1 // TEST STUFF

	WAIT 0

ENDWHILE

// Swaps boat for building lod then sets boat lod to invisible

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE  1508.77 -937.206 20.6832 50.0 rustship_structure FALSE

SWAP_NEAREST_BUILDING_MODEL  1508.77 -937.206 20.6832 50.0 rustship_structure LOD_land014

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE  1508.77 -937.206 20.6832 50.0 LODtship_structure FALSE

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1526.75 -907.423 14.2965 50.0 boatramp1 FALSE

SWAP_NEAREST_BUILDING_MODEL 1526.75 -907.423 14.2965 50.0 boatramp1 LOD_land014

LOAD_CUTSCENE s4_bdbd

SET_CUTSCENE_OFFSET 1573.8866 -906.0611 11.1

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_eight

SET_CUTSCENE_ANIM cs_eight eight2

CREATE_CUTSCENE_OBJECT cut_obj1 cs_ship

SET_CUTSCENE_ANIM cs_ship ship

CREATE_CUTSCENE_OBJECT cut_obj2 cs_gangplank

SET_CUTSCENE_ANIM cs_gangplank gangp

CLEAR_AREA 1526.5 -894.8 -100.0 1.0 TRUE

SET_PLAYER_COORDINATES player 1526.5 -894.8 -100.0

SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

DELETE_CHAR ped_8ball_fm3 

SWITCH_RUBBISH OFF

SWITCH_STREAMING ON

START_CUTSCENE

START_BOAT_FOAM_ANIMATION

UPDATE_BOAT_FOAM_ANIMATION cs_ship 

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 1433
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

ADD_EXPLOSION 1478.48 -936.52 20.4 EXPLOSION_HELI

WHILE cs_time < 2565
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

ADD_EXPLOSION 1479.48 -936.52 20.4 EXPLOSION_HELI

WHILE cs_time < 3433
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

ADD_EXPLOSION 1481.48 -936.52 20.4 EXPLOSION_HELI

WHILE cs_time < 4433
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

ADD_EXPLOSION 1487.92 -933.90 20.4 EXPLOSION_HELI

WHILE cs_time < 5833
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

ADD_EXPLOSION 1490.70 -928.15 20.4 EXPLOSION_HELI

WHILE cs_time < 6433 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

ADD_EXPLOSION 1595.53 -921.84 20.4 EXPLOSION_HELI

WHILE cs_time < 7433
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

ADD_EXPLOSION 1500.53 -921.84 20.4 EXPLOSION_HELI

WHILE cs_time < 8433
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

ADD_EXPLOSION 1502.53 -921.84 20.4 EXPLOSION_HELI

WHILE cs_time < 9633
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

ADD_EXPLOSION 1510.5 -918.2 20.4 EXPLOSION_HELI

WHILE cs_time < 12833
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

ADD_EXPLOSION 1510.5 -918.2 20.4 EXPLOSION_HELI

WHILE cs_time < 13000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

ADD_EXPLOSION 1518.02 -931.86 19.4 EXPLOSION_HELI

WHILE cs_time < 33333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
	UPDATE_BOAT_FOAM_ANIMATION cs_ship
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2

// *****************************END OF BOAT BLOWING UP CUTSCENE*****************************

GOTO mission_frankie3_passed

}
	   		
// Mission Failed stuff

mission_frankie3_failed:

SET_PLAYER_AMMO player WEAPONTYPE_SNIPERRIFLE 0

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN


// mission Frankie3 passed

mission_frankie3_passed:

flag_frankie_mission3_passed = 1
REGISTER_MISSION_PASSED ( FM3 )
PLAYER_MADE_PROGRESS 1
CANCEL_OVERRIDE_RESTART 
PRINT_WITH_NUMBER_BIG ( m_pass ) 150000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 150000
CLEAR_WANTED_LEVEL player
REMOVE_BLIP eightball_contact_blip
flag_frankie_switched_off = 0
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 1455.7 -187.3 -100.0 RADAR_SPRITE_SAL frankie_contact_blip
START_NEW_SCRIPT frankie_mission4_loop
START_NEW_SCRIPT emergency_crane_pager
RETURN
		


// mission cleanup

mission_cleanup_frankie3:

flag_player_on_mission = 0
flag_player_on_frankie_mission = 0
flag_on_frankie3 = 0
IF NOT IS_CHAR_DEAD guard1_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard1_fm3 FALSE
ENDIF

IF NOT IS_CHAR_DEAD guard2_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard2_fm3 FALSE
ENDIF

IF NOT IS_CHAR_DEAD guard3_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard3_fm3 FALSE
ENDIF

IF NOT IS_CHAR_DEAD guard4_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard4_fm3 FALSE
ENDIF

IF NOT IS_CHAR_DEAD guard5_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard5_fm3 FALSE
ENDIF

IF NOT IS_CHAR_DEAD guard6_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard6_fm3 FALSE
ENDIF

IF NOT IS_CHAR_DEAD guard7_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard7_fm3 FALSE
ENDIF

IF NOT IS_CHAR_DEAD guard8_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard8_fm3 FALSE
ENDIF

IF NOT IS_CHAR_DEAD guard9_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard9_fm3 FALSE
ENDIF

IF NOT IS_CHAR_DEAD guard10_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard10_fm3 FALSE
ENDIF

IF NOT IS_CHAR_DEAD guard11_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard11_fm3 FALSE
ENDIF

IF NOT IS_CHAR_DEAD guard12_fm3
	SET_CHAR_STAY_IN_SAME_PLACE guard12_fm3 FALSE
ENDIF

REMOVE_CHAR_ELEGANTLY ped_8ball_fm3
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_B
MARK_MODEL_AS_NO_LONGER_NEEDED barrel4
MARK_CHAR_AS_NO_LONGER_NEEDED ped_8ball_fm3
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_COLUMB
REMOVE_BLIP radar_blip_coord2_fm3
REMOVE_BLIP radar_blip_coord3_fm3
CLEAR_ONSCREEN_TIMER timer_fm3
REMOVE_ROUTE 0
REMOVE_ROUTE 1
REMOVE_ROUTE 2
REMOVE_ROUTE 3
REMOVE_ROUTE 4
REMOVE_ROUTE 5
REMOVE_ROUTE 6
SETUP_ZONE_PED_INFO PORT_E DAY 0 0 0 0 0 0 0 0 0
SETUP_ZONE_PED_INFO PORT_E NIGHT 0 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO PORT_E DAY 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO PORT_E NIGHT 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
DELETE_OBJECT boat_barrel7
DELETE_OBJECT boat_barrel8
DELETE_OBJECT boat_barrel9
DELETE_OBJECT boat_barrel15
DELETE_OBJECT boat_barrel16
DELETE_OBJECT boat_barrel17
MISSION_HAS_FINISHED
RETURN




guard_death_check:


// guard1

	IF flag_guard1_fm3_dead = 0

		IF IS_CHAR_DEAD guard1_fm3
			flag_guard1_fm3_dead = 1
			++ counter_no_guards_dead_fm3
	  	ELSE

			IF flag_guard1_looking_for_8ball = 0

				IF flag_bloke_in_area_fm3 = 2
				OR flag_guard2_fm3_dead = 1
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1

					IF flag_columb_car2_dead = 0 
						SET_CHAR_OBJ_RUN_TO_COORD guard1_fm3 1517.6 -896.6
					ELSE
						SET_CHAR_OBJ_RUN_TO_COORD guard1_fm3 1523.3 -893.7
					ENDIF
					SET_CHAR_THREAT_SEARCH guard1_fm3 THREAT_SPECIAL  //Guard now looks out for 8-ball
					flag_guard1_looking_for_8ball = 1
				ENDIF

			ENDIF

			IF flag_guard1_looking_for_8ball = 1

				IF flag_columb_car2_dead = 0 

					IF LOCATE_CHAR_ON_FOOT_3D guard1_fm3 1517.6 -896.6 10.8 0.5 0.5 2.0 FALSE
						SET_CHAR_OBJ_GUARD_SPOT guard1_fm3 1517.6 -896.6 10.8
						SET_CHAR_STAY_IN_SAME_PLACE guard1_fm3 TRUE
						TURN_CHAR_TO_FACE_COORD guard1_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					ENDIF

				ELSE
					
					IF LOCATE_CHAR_ON_FOOT_3D guard1_fm3 1523.3 -893.7 10.8 0.5 0.5 2.0 FALSE
						SET_CHAR_OBJ_GUARD_SPOT guard1_fm3 1523.3 -893.7 10.8
						SET_CHAR_STAY_IN_SAME_PLACE guard1_fm3 TRUE
						TURN_CHAR_TO_FACE_COORD guard1_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					ENDIF 

				ENDIF

			ENDIF
			
		ENDIF
	  				
	ENDIF

// guard2

	IF flag_guard2_fm3_dead = 0

		IF IS_CHAR_DEAD guard2_fm3
			flag_guard2_fm3_dead = 1
			++ counter_no_guards_dead_fm3
	  	ELSE	
			
			IF flag_guard2_looking_for_8ball = 0

				IF flag_bloke_in_area_fm3 = 2
				OR flag_guard1_fm3_dead = 1
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1
					
					IF flag_columb_car1_dead =  0 
						SET_CHAR_OBJ_RUN_TO_COORD guard2_fm3 1532.9 -893.8
					ELSE
						SET_CHAR_OBJ_RUN_TO_COORD guard2_fm3 1528.6 -892.2	
					ENDIF
					SET_CHAR_THREAT_SEARCH guard2_fm3 THREAT_SPECIAL  //Guard now looks out for 8-ball
					flag_guard2_looking_for_8ball = 1
				ENDIF

			ENDIF

			IF flag_guard2_looking_for_8ball = 1

				IF flag_columb_car1_dead =  0 

					IF LOCATE_CHAR_ON_FOOT_3D guard2_fm3 1532.9 -893.8 10.8 0.5 0.5 2.0 FALSE
						SET_CHAR_OBJ_GUARD_SPOT guard2_fm3 1532.9 -893.8 10.8 
						TURN_CHAR_TO_FACE_COORD guard2_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
						SET_CHAR_STAY_IN_SAME_PLACE guard2_fm3 TRUE
					ENDIF

				ELSE
					
					IF LOCATE_CHAR_ON_FOOT_3D guard2_fm3 1528.6 -892.2 10.8 0.5 0.5 2.0 FALSE
						SET_CHAR_OBJ_GUARD_SPOT guard2_fm3 1528.6 -892.2 10.8 
						TURN_CHAR_TO_FACE_COORD guard2_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
						SET_CHAR_STAY_IN_SAME_PLACE guard2_fm3 TRUE
					ENDIF
				
				ENDIF
				
			ENDIF	 

		ENDIF
	  				
	ENDIF

// guard3

	IF flag_guard3_fm3_dead = 0
		
		IF IS_CHAR_DEAD guard3_fm3
			flag_guard3_fm3_dead = 1
			++ counter_no_guards_dead_fm3
		ELSE

			IF flag_guard3_looking_for_8ball = 0
			
				IF flag_bloke_in_area_fm3 = 2  //8ball has reached the gangplank of the boat
				OR counter_no_guards_dead_fm3 > 0
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1
					SET_CHAR_THREAT_SEARCH guard3_fm3 THREAT_SPECIAL //Guard3 now looks out for 8-ball
					SET_CHAR_OBJ_RUN_TO_COORD guard3_fm3 1534.1 -931.2
					flag_guard3_looking_for_8ball = 1
				ENDIF

			ENDIF

			IF flag_guard3_looking_for_8ball = 1

				IF LOCATE_CHAR_ON_FOOT_3D guard3_fm3 1534.1 -931.2 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_GUARD_SPOT guard3_fm3 1534.1 -931.2 18.4
					TURN_CHAR_TO_FACE_COORD guard3_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					SET_CHAR_STAY_IN_SAME_PLACE guard3_fm3 TRUE
					//flag_guard3_looking_for_8ball = 2
				ENDIF
				
			ENDIF
		   			
		ENDIF

	ENDIF

// guard4
	
	IF flag_guard4_fm3_dead = 0
	
		IF IS_CHAR_DEAD guard4_fm3
			flag_guard4_fm3_dead = 1
			++ counter_no_guards_dead_fm3
		ELSE
			
			IF flag_guard4_looking_for_8ball = 0

				IF flag_bloke_in_area_fm3 =	4 //8-ball has reached the second create on the boat
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1
				OR counter_no_guards_dead_fm3 > 0
					SET_CHAR_OBJ_RUN_TO_COORD guard4_fm3 1517.5 -940.6
					SET_CHAR_THREAT_SEARCH guard4_fm3 THREAT_SPECIAL //Guard4 now looks out for 8-ball
					flag_guard4_looking_for_8ball = 1
				ENDIF

			ENDIF

			IF flag_guard4_looking_for_8ball = 1
			
				IF LOCATE_CHAR_ANY_MEANS_3D guard4_fm3 1517.5 -940.6 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD guard4_fm3 1516.1 -932.6
					flag_guard4_looking_for_8ball = 2
				ENDIF
				
			ENDIF
			
			IF flag_guard4_looking_for_8ball = 2
			
				IF LOCATE_CHAR_ANY_MEANS_3D guard4_fm3 1516.1 -932.6 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_GUARD_SPOT guard4_fm3 1516.1 -932.6 18.4
					TURN_CHAR_TO_FACE_COORD guard4_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					SET_CHAR_STAY_IN_SAME_PLACE guard4_fm3 TRUE	  
				ENDIF
			
			ENDIF
			
		ENDIF

		

	ENDIF

// Guard5

	IF flag_guard5_fm3_dead = 0
		
		IF IS_CHAR_DEAD guard5_fm3
			flag_guard5_fm3_dead = 1
			++ counter_no_guards_dead_fm3
		ELSE

			IF flag_guard5_looking_for_8ball = 0

				IF flag_bloke_in_area_fm3 = 5
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1
				OR flag_guard6_fm3_dead = 1
				OR flag_guard7_fm3_dead = 1
				 	SET_CHAR_OBJ_RUN_TO_COORD guard5_fm3 1505.6 -926.1
					SET_CHAR_THREAT_SEARCH guard5_fm3 THREAT_SPECIAL //Guard5 now looks out for 8-ball
					flag_guard5_looking_for_8ball = 1
				ENDIF

			ENDIF

			IF flag_guard5_looking_for_8ball = 1

				IF LOCATE_CHAR_ANY_MEANS_3D guard5_fm3 1505.6 -926.1 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD guard5_fm3 1507.2 -924.0
					flag_guard5_looking_for_8ball = 2
				ENDIF
				
			ENDIF
			
			IF flag_guard5_looking_for_8ball = 2
			
				IF LOCATE_CHAR_ANY_MEANS_3D guard5_fm3 1507.2 -924.0 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_GUARD_SPOT guard5_fm3 1507.2 -924.0 18.4
					TURN_CHAR_TO_FACE_COORD guard5_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					SET_CHAR_STAY_IN_SAME_PLACE guard5_fm3 TRUE
				ENDIF
				
			ENDIF	 

		ENDIF
			
	ENDIF

// Guard6

	IF flag_guard6_fm3_dead = 0

		IF IS_CHAR_DEAD guard6_fm3
			flag_guard6_fm3_dead = 1
			++ counter_no_guards_dead_fm3
		ELSE
		
			IF flag_guard6_looking_for_8ball = 0
			
				IF flag_bloke_in_area_fm3 = 5
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1
				OR flag_guard5_fm3_dead = 1
				OR flag_guard7_fm3_dead = 1
					SET_CHAR_OBJ_RUN_TO_COORD guard6_fm3 1501.0 -919.8
					SET_CHAR_THREAT_SEARCH guard6_fm3 THREAT_SPECIAL //Guard6 now looks out for 8-ball
					flag_guard6_looking_for_8ball = 1
				ENDIF
								
			ENDIF

			IF flag_guard6_looking_for_8ball = 1

				IF LOCATE_CHAR_ANY_MEANS_3D guard6_fm3 1501.0 -919.8 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_GUARD_SPOT guard6_fm3 1501.0 -919.8 18.4
					TURN_CHAR_TO_FACE_COORD guard6_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					SET_CHAR_STAY_IN_SAME_PLACE guard6_fm3 TRUE
				ENDIF
				
			ENDIF	

		ENDIF

	ENDIF

// Guard7

IF flag_guard7_fm3_dead = 0

		IF IS_CHAR_DEAD guard7_fm3
			flag_guard7_fm3_dead = 1
			++ counter_no_guards_dead_fm3
		ELSE
		
			IF flag_guard7_looking_for_8ball = 0
			
				IF flag_bloke_in_area_fm3 = 5
				OR flag_guard5_fm3_dead = 1
				OR flag_guard6_fm3_dead = 1
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1
					SET_CHAR_OBJ_RUN_TO_COORD guard7_fm3 1499.4 -937.8
					SET_CHAR_THREAT_SEARCH guard7_fm3 THREAT_SPECIAL //Guard7 now looks out for 8-ball
					flag_guard7_looking_for_8ball = 1
				ENDIF
								
			ENDIF

			IF flag_guard7_looking_for_8ball = 1

				IF LOCATE_CHAR_ANY_MEANS_3D guard7_fm3 1499.4 -937.8 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD guard7_fm3 1502.2 -930.8
					flag_guard7_looking_for_8ball = 2
				ENDIF

			ENDIF

			IF flag_guard7_looking_for_8ball = 2

				IF LOCATE_CHAR_ANY_MEANS_3D guard7_fm3 1502.2 -930.8 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_GUARD_SPOT guard7_fm3 1502.2 -930.8 18.4
					TURN_CHAR_TO_FACE_COORD guard7_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					SET_CHAR_STAY_IN_SAME_PLACE guard7_fm3 TRUE
				ENDIF
			
			ENDIF	 

		ENDIF

	ENDIF

// Guard8

IF flag_guard8_fm3_dead = 0

		IF IS_CHAR_DEAD guard8_fm3
			flag_guard8_fm3_dead = 1
			++ counter_no_guards_dead_fm3
		ELSE
		
			IF flag_guard8_looking_for_8ball = 0
			
				IF flag_bloke_in_area_fm3 =	 5
				OR flag_guard9_fm3_dead = 1
				OR flag_guard10_fm3_dead = 1
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1
					SET_CHAR_OBJ_RUN_TO_COORD guard8_fm3 1491.6 -935.8
					SET_CHAR_THREAT_SEARCH guard8_fm3 THREAT_SPECIAL //Guard8 now looks out for 8-ball
					flag_guard8_looking_for_8ball = 1
				ENDIF
								
			ENDIF

			IF flag_guard8_looking_for_8ball = 1

				IF LOCATE_CHAR_ANY_MEANS_3D guard8_fm3 1491.6 -935.8 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD guard8_fm3 1487.6 -933.6
					flag_guard8_looking_for_8ball = 2
				ENDIF

			ENDIF

			IF flag_guard8_looking_for_8ball = 2

				IF LOCATE_CHAR_ANY_MEANS_3D guard8_fm3 1487.6 -933.6 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_GUARD_SPOT guard8_fm3 1487.6 -933.6 18.4
					TURN_CHAR_TO_FACE_COORD guard8_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					SET_CHAR_STAY_IN_SAME_PLACE guard8_fm3 TRUE
				ENDIF
				
			ENDIF	

		ENDIF

	ENDIF

// Guard9

IF flag_guard9_fm3_dead = 0

		IF IS_CHAR_DEAD guard9_fm3
			flag_guard9_fm3_dead = 1
			++ counter_no_guards_dead_fm3
		ELSE
		
			IF flag_guard9_looking_for_8ball = 0
			
				IF flag_bloke_in_area_fm3 = 6
				OR flag_guard8_fm3_dead = 1
				OR flag_guard10_fm3_dead = 1
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1
					SET_CHAR_OBJ_GUARD_SPOT guard9_fm3 1484.4 -930.5 19.8
					SET_CHAR_THREAT_SEARCH guard9_fm3 THREAT_SPECIAL //Guard9 now looks out for 8-ball
					SET_CHAR_STAY_IN_SAME_PLACE guard9_fm3 TRUE
					TURN_CHAR_TO_FACE_COORD guard9_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					flag_guard9_looking_for_8ball = 1
				ENDIF
								
			ENDIF

		ENDIF

	ENDIF

// Guard10

IF flag_guard10_fm3_dead = 0

		IF IS_CHAR_DEAD guard10_fm3
			flag_guard10_fm3_dead = 1
			++ counter_no_guards_dead_fm3
		ELSE
		
			IF flag_guard10_looking_for_8ball = 0
			
				IF flag_bloke_in_area_fm3 = 6
				OR flag_guard8_fm3_dead = 1
				OR flag_guard9_fm3_dead = 1
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1
					SET_CHAR_OBJ_RUN_TO_COORD guard10_fm3 1476.7 -936.3
					SET_CHAR_THREAT_SEARCH guard10_fm3 THREAT_SPECIAL //Guard10 now looks out for 8-ball
					flag_guard10_looking_for_8ball = 1
				ENDIF
								
			ENDIF

			IF flag_guard10_looking_for_8ball = 1

				IF LOCATE_CHAR_ANY_MEANS_3D guard10_fm3 1476.7 -936.3 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD guard10_fm3 1482.6 -930.5
					flag_guard10_looking_for_8ball = 2
				ENDIF

			ENDIF

			IF flag_guard10_looking_for_8ball = 2

				IF LOCATE_CHAR_ANY_MEANS_3D guard10_fm3 1482.6 -930.5 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_GUARD_SPOT guard10_fm3 1482.6 -930.5 18.4
					TURN_CHAR_TO_FACE_COORD guard10_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					SET_CHAR_STAY_IN_SAME_PLACE guard10_fm3 TRUE
				ENDIF
				
			ENDIF	

		ENDIF

	ENDIF

// Guard11

	IF flag_guard11_fm3_dead = 0

		IF IS_CHAR_DEAD guard11_fm3
			flag_guard11_fm3_dead = 1
			++ counter_no_guards_dead_fm3
	  	ELSE

			IF flag_guard11_looking_for_8ball = 0

				IF flag_bloke_in_area_fm3 = 2
				OR flag_guard12_fm3_dead = 1
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1
				OR flag_guard1_fm3_dead = 1
				OR flag_guard2_fm3_dead = 1
					SET_CHAR_OBJ_RUN_TO_COORD guard11_fm3 1528.5 -927.5 
					SET_CHAR_THREAT_SEARCH guard11_fm3 THREAT_SPECIAL  //Guard now looks out for 8-ball
					flag_guard11_looking_for_8ball = 1
				ENDIF

			ENDIF

			IF flag_guard11_looking_for_8ball = 1
				
				IF LOCATE_CHAR_ANY_MEANS_3D guard11_fm3 1528.5 -927.5 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD guard11_fm3 1521.5 -927.2
					flag_guard11_looking_for_8ball = 2
				ENDIF

			ENDIF

			IF flag_guard11_looking_for_8ball = 2

				IF LOCATE_CHAR_ANY_MEANS_3D guard11_fm3 1521.5 -927.2 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_GUARD_SPOT guard11_fm3 1521.5 -927.2 18.4
					TURN_CHAR_TO_FACE_COORD guard11_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					SET_CHAR_STAY_IN_SAME_PLACE guard11_fm3 TRUE
				ENDIF
				
			ENDIF 

		ENDIF
	  				
	ENDIF

// Guard12

	IF flag_guard12_fm3_dead = 0

		IF IS_CHAR_DEAD guard12_fm3
			flag_guard12_fm3_dead = 1
			++ counter_no_guards_dead_fm3
	  	ELSE

			IF flag_guard12_looking_for_8ball = 0
				
				IF flag_bloke_in_area_fm3 = 2
				OR flag_guard11_fm3_dead = 1
				OR flag_columb_car1_dead = 1
				OR flag_columb_car2_dead = 1
				OR flag_guard1_fm3_dead = 1
				OR flag_guard2_fm3_dead = 1
					SET_CHAR_OBJ_RUN_TO_COORD guard12_fm3 1517.6 -923.1
					SET_CHAR_THREAT_SEARCH guard12_fm3 THREAT_SPECIAL  //Guard now looks out for 8-ball
					flag_guard12_looking_for_8ball = 1
				ENDIF

			ENDIF

			IF flag_guard12_looking_for_8ball = 1
			
				IF LOCATE_CHAR_ANY_MEANS_3D guard12_fm3 1517.6 -923.1 18.4 0.5 0.5 2.0 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD guard12_fm3 1512.7 -929.0
					flag_guard12_looking_for_8ball = 2
				ENDIF
				
			ENDIF
			
			IF flag_guard12_looking_for_8ball = 2
				
				IF LOCATE_CHAR_ANY_MEANS_3D guard12_fm3 1512.7 -929.0 18.4 0.2 0.2 2.0 FALSE
					SET_CHAR_OBJ_GUARD_SPOT guard12_fm3 1512.7 -929.0 18.4
					TURN_CHAR_TO_FACE_COORD guard12_fm3 eightball_x_fm3 eightball_y_fm3 eightball_z_fm3
					SET_CHAR_STAY_IN_SAME_PLACE guard12_fm3 TRUE
				ENDIF
				
			ENDIF	 

		ENDIF
	  				
	ENDIF
				
RETURN


car_dead_check:

	IF flag_columb_car1_dead = 0
	
		IF IS_CAR_DEAD car_columb1_fm3
			flag_columb_car1_dead = 1
		ENDIF
		
	ENDIF
	
	IF flag_columb_car2_dead = 0
	
		IF IS_CAR_DEAD car_columb2_fm3
			flag_columb_car2_dead = 1
		ENDIF
		
	ENDIF

RETURN

clear_area_check_fm3:

IF flag_bloke_in_area_fm3 <= 2
	CLEAR_AREA 1545.9 -867.7 10.8 1.0 FALSE
	CLEAR_AREA 1527.0 -899.0 10.8 1.0 FALSE
	CLEAR_AREA 1526.0 -919.0 18.4 1.0 FALSE
	CLEAR_AREA 1522.9 -924.3 18.4 1.0 FALSE
	CLEAR_AREA 1517.0 -929.0 18.4 1.0 FALSE
	CLEAR_AREA 1510.0 -923.0 18.4 1.0 FALSE
	CLEAR_AREA 1504.4 -928.6 18.4 1.0 FALSE
	CLEAR_AREA 1493.7 -922.1 18.4 1.0 FALSE
	CLEAR_AREA 1487.0 -930.2 18.4 1.0 FALSE
	CLEAR_AREA 1481.5 -926.8 18.4 1.0 FALSE
	CLEAR_AREA 1475.8 -940.3 18.4 1.0 FALSE
	CLEAR_AREA 1474.2 -940.2 18.4 1.0 FALSE
ENDIF
	
IF flag_bloke_in_area_fm3 = 3
	CLEAR_AREA 1527.0 -899.0 10.8 1.0 FALSE
	CLEAR_AREA 1526.0 -919.0 18.4 1.0 FALSE
	CLEAR_AREA 1522.9 -924.3 18.4 1.0 FALSE
	CLEAR_AREA 1517.0 -929.0 18.4 1.0 FALSE
	CLEAR_AREA 1510.0 -923.0 18.4 1.0 FALSE
	CLEAR_AREA 1504.4 -928.6 18.4 1.0 FALSE
	CLEAR_AREA 1493.7 -922.1 18.4 1.0 FALSE
	CLEAR_AREA 1487.0 -930.2 18.4 1.0 FALSE
	CLEAR_AREA 1481.5 -926.8 18.4 1.0 FALSE
	CLEAR_AREA 1475.8 -940.3 18.4 1.0 FALSE
	CLEAR_AREA 1474.2 -940.2 18.4 1.0 FALSE
ENDIF

IF flag_bloke_in_area_fm3 = 4
	CLEAR_AREA 1526.0 -919.0 18.4 1.0 FALSE
	CLEAR_AREA 1522.9 -924.3 18.4 1.0 FALSE
	CLEAR_AREA 1517.0 -929.0 18.4 1.0 FALSE
	CLEAR_AREA 1510.0 -923.0 18.4 1.0 FALSE
	CLEAR_AREA 1504.4 -928.6 18.4 1.0 FALSE
	CLEAR_AREA 1493.7 -922.1 18.4 1.0 FALSE
	CLEAR_AREA 1487.0 -930.2 18.4 1.0 FALSE
	CLEAR_AREA 1481.5 -926.8 18.4 1.0 FALSE
	CLEAR_AREA 1475.8 -940.3 18.4 1.0 FALSE
	CLEAR_AREA 1474.2 -940.2 18.4 1.0 FALSE
ENDIF

IF flag_bloke_in_area_fm3 = 5
	CLEAR_AREA 1522.9 -924.3 18.4 1.0 FALSE
	CLEAR_AREA 1517.0 -929.0 18.4 1.0 FALSE
	CLEAR_AREA 1510.0 -923.0 18.4 1.0 FALSE
	CLEAR_AREA 1504.4 -928.6 18.4 1.0 FALSE
	CLEAR_AREA 1493.7 -922.1 18.4 1.0 FALSE
	CLEAR_AREA 1487.0 -930.2 18.4 1.0 FALSE
	CLEAR_AREA 1481.5 -926.8 18.4 1.0 FALSE
	CLEAR_AREA 1475.8 -940.3 18.4 1.0 FALSE
	CLEAR_AREA 1474.2 -940.2 18.4 1.0 FALSE
ENDIF

IF flag_bloke_in_area_fm3 = 6
	CLEAR_AREA 1517.0 -929.0 18.4 1.0 FALSE
	CLEAR_AREA 1510.0 -923.0 18.4 1.0 FALSE
	CLEAR_AREA 1504.4 -928.6 18.4 1.0 FALSE
	CLEAR_AREA 1493.7 -922.1 18.4 1.0 FALSE
	CLEAR_AREA 1487.0 -930.2 18.4 1.0 FALSE
	CLEAR_AREA 1481.5 -926.8 18.4 1.0 FALSE
	CLEAR_AREA 1475.8 -940.3 18.4 1.0 FALSE
	CLEAR_AREA 1474.2 -940.2 18.4 1.0 FALSE
ENDIF

IF flag_bloke_in_area_fm3 = 7
	CLEAR_AREA 1510.0 -923.0 18.4 1.0 FALSE
	CLEAR_AREA 1504.4 -928.6 18.4 1.0 FALSE
	CLEAR_AREA 1493.7 -922.1 18.4 1.0 FALSE
	CLEAR_AREA 1487.0 -930.2 18.4 1.0 FALSE
	CLEAR_AREA 1481.5 -926.8 18.4 1.0 FALSE
	CLEAR_AREA 1475.8 -940.3 18.4 1.0 FALSE
	CLEAR_AREA 1474.2 -940.2 18.4 1.0 FALSE
ENDIF

IF flag_bloke_in_area_fm3 = 8
	CLEAR_AREA 1504.4 -928.6 18.4 1.0 FALSE
	CLEAR_AREA 1493.7 -922.1 18.4 1.0 FALSE
	CLEAR_AREA 1487.0 -930.2 18.4 1.0 FALSE
	CLEAR_AREA 1481.5 -926.8 18.4 1.0 FALSE
	CLEAR_AREA 1475.8 -940.3 18.4 1.0 FALSE
	CLEAR_AREA 1474.2 -940.2 18.4 1.0 FALSE
ENDIF

IF flag_bloke_in_area_fm3 = 9
	CLEAR_AREA 1493.7 -922.1 18.4 1.0 FALSE
	CLEAR_AREA 1487.0 -930.2 18.4 1.0 FALSE
	CLEAR_AREA 1481.5 -926.8 18.4 1.0 FALSE
	CLEAR_AREA 1475.8 -940.3 18.4 1.0 FALSE
	CLEAR_AREA 1474.2 -940.2 18.4 1.0 FALSE
ENDIF

IF flag_bloke_in_area_fm3 = 10
	CLEAR_AREA 1487.0 -930.2 18.4 1.0 FALSE
	CLEAR_AREA 1481.5 -926.8 18.4 1.0 FALSE
	CLEAR_AREA 1475.8 -940.3 18.4 1.0 FALSE
	CLEAR_AREA 1474.2 -940.2 18.4 1.0 FALSE
ENDIF


IF flag_bloke_in_area_fm3 = 11
	CLEAR_AREA 1481.5 -926.8 18.4 1.0 FALSE
	CLEAR_AREA 1475.8 -940.3 18.4 1.0 FALSE
	CLEAR_AREA 1474.2 -940.2 18.4 1.0 FALSE
ENDIF

IF flag_bloke_in_area_fm3 = 12
	CLEAR_AREA 1475.8 -940.3 18.4 1.0 FALSE
	CLEAR_AREA 1474.2 -940.2 18.4 1.0 FALSE
ENDIF

RETURN
 
 
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// ***********************************Final Industrial****************************************
// ***********************************  Last Requests ****************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff

GOSUB mission_start_frank4

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_frank4_failed
ENDIF
						 
GOSUB mission_cleanup_frank4

MISSION_END					


// Variables for mission


//VAR_INT maria // mission specific ped

VAR_INT blip1_fm4 blip2_fm4 blip3_fm4 boat_blip

VAR_INT flag_player_got_frank4_message frank4_car1 frank4_car2

VAR_INT boat_mar bomb_car  flag_car_blip_displayed_fm4

VAR_INT car_dead_once girls_attack_player

VAR_FLOAT boat_mar_X boat_mar_Y boat_mar_Z 
VAR_FLOAT player_f4x player_f4y player_f4z

VAR_FLOAT boat_maria_x boat_maria_y boat_asuka_x boat_asuka_y

// ***************************************Mission Start*************************************

mission_start_frank4:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_frankie_mission = 1
SCRIPT_NAME frank4
WAIT 0

girls_attack_player = 0
car_dead_once = 0


{

LOAD_SPECIAL_CHARACTER 1 frankie
//LOAD_SPECIAL_CHARACTER 2 goon
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 FRANKH

REQUEST_MODEL PED_GANG_MAFIA_B
REQUEST_MODEL franksclb02
REQUEST_MODEL salvsdetail
REQUEST_MODEL swank_inside

/*
WHILE GET_FADING_STATUS
	WAIT 0

ENDWHILE
*/

LOAD_ALL_MODELS_NOW
				  
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED PED_GANG_MAFIA_B
	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED franksclb02
OR NOT HAS_MODEL_LOADED	salvsdetail
OR NOT HAS_MODEL_LOADED swank_inside
	WAIT 0

ENDWHILE


LOAD_CUTSCENE S5_LRQ
SET_CUTSCENE_OFFSET 1457.776 -185.348 54.925

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_frankie
SET_CUTSCENE_ANIM cs_frankie frankie

CREATE_CUTSCENE_HEAD cs_frankie CUT_OBJ2 cs_frankiehead
SET_CUTSCENE_HEAD_ANIM cs_frankiehead frank

CREATE_CUTSCENE_OBJECT PED_GANG_MAFIA_B cs_mafia
SET_CUTSCENE_ANIM cs_mafia gang02

//CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_mafia
//SET_CUTSCENE_ANIM cs_mafia gang02

SET_PLAYER_COORDINATES player 1455.2 -186.8 55.0

SET_PLAYER_HEADING player 130.0

DO_FADE 1500 FADE_IN

//SWITCH_WORLD_PROCESSING OFF
SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time


WHILE cs_time < 2397
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_A ) 10000 1 // Mission brief

WHILE cs_time < 5260
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_B ) 10000 1 // Mission brief

WHILE cs_time < 9273
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_C ) 10000 1 // Mission brief

WHILE cs_time < 12861
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_D ) 10000 1 // Mission brief

WHILE cs_time < 15447
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_E ) 10000 1 // Mission brief

WHILE cs_time < 18080
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_F ) 10000 1 // Mission brief

WHILE cs_time < 22832
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_H ) 10000 1 // Mission brief

WHILE cs_time < 24908
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS 

WHILE cs_time < 26333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1000 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

//SWITCH_WORLD_PROCESSING ON
SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1000 FADE_IN 

UNLOAD_SPECIAL_CHARACTER 1
//UNLOAD_SPECIAL_CHARACTER 2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_B
MARK_MODEL_AS_NO_LONGER_NEEDED franksclb02
MARK_MODEL_AS_NO_LONGER_NEEDED salvsdetail
MARK_MODEL_AS_NO_LONGER_NEEDED swank_inside
//REQUEST_MODEL BOAT_SPEEDER
//REQUEST_MODEL CAR_CHEETAH
//LOAD_SPECIAL_MODEL cut_obj3 MARIAH
//LOAD_SPECIAL_MODEL cut_obj4 ASUKAH

	/*
	WHILE NOT HAS_MODEL_LOADED cut_obj3
	OR NOT HAS_MODEL_LOADED cut_obj4
		WAIT 0
	ENDWHILE
	*/

REQUEST_MODEL BOAT_REEFER
REQUEST_MODEL CAR_CHEETAH

	WHILE NOT HAS_MODEL_LOADED BOAT_REEFER
	OR NOT HAS_MODEL_LOADED	CAR_CHEETAH
		WAIT 0

	ENDWHILE

//GOTO skip_frank_cut1 //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

//CREATE SUBURBAN BARRIERS
IF barriers_been_added = 0

	CREATE_OBJECT_NO_OFFSET subwaygate -672.0 -760.0 8.3 subway_gate_suburban1
	DONT_REMOVE_OBJECT subway_gate_suburban1
	SET_OBJECT_HEADING subway_gate_suburban1 270.0   

	CREATE_OBJECT_NO_OFFSET subwaygate -672.0 -768.9 8.3 subway_gate_suburban2
	DONT_REMOVE_OBJECT subway_gate_suburban2
	SET_OBJECT_HEADING subway_gate_suburban2 270.0

	CREATE_OBJECT_NO_OFFSET tunnelentrance 533.3 97.0 -21.3 tunnel_gate_suburban
	DONT_REMOVE_OBJECT tunnel_gate_suburban
	SET_OBJECT_HEADING tunnel_gate_suburban 45.0
	
	barriers_been_added = 1
ENDIF

// START OF MISSION

CREATE_CAR CAR_CHEETAH 951.0 -421.0 14.6 bomb_car
ARM_CAR_WITH_BOMB bomb_car CARBOMB_ONIGNITIONACTIVE 
ADD_BLIP_FOR_CAR bomb_car blip1_fm4 

WHILE NOT IS_PLAYER_IN_ZONE Player REDLIGH
	 WAIT 0

	IF IS_CAR_DEAD bomb_car
	AND car_dead_once = 0
		REMOVE_BLIP blip1_fm4
		car_dead_once = 1 	
	ENDIF
	
ENDWHILE

ADD_PAGER_MESSAGE ( FM4_1 ) 140 10 2

ADD_BLIP_FOR_COORD 835.7 -1091.7 -100.0 blip2_fm4
/*
CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 835.6 -1110.7 2.0 maria
ADD_BLIP_FOR_CHAR maria blip2_fm4
CHAR_SET_IDLE maria
CLEAR_CHAR_THREAT_SEARCH maria
SET_CHAR_HEADING maria 345.0

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL3 834.3 -1111.7 2.0 asuka
CHAR_SET_IDLE asuka
CLEAR_CHAR_THREAT_SEARCH asuka
SET_CHAR_HEADING asuka 5.0
*/
WHILE NOT LOCATE_STOPPED_PLAYER_IN_CAR_3D Player 827.3 -1084.3 6.8 5.0 5.0 4.0 TRUE
	 WAIT 0

		IF IS_CAR_DEAD bomb_car
		AND car_dead_once = 0
			REMOVE_BLIP blip1_fm4
			car_dead_once = 1 	
		ENDIF

		IF LOCATE_PLAYER_ON_FOOT_3D Player  827.3 -1084.3 6.8 5.0 5.0 4.0 FALSE
			GOTO on_foot_frank4
		ENDIF

		/*
		IF IS_PLAYER_IN_CAR Player bomb_car
			GOTO mission_frank4_failed
		ENDIF		
		*/
ENDWHILE

on_foot_frank4:

SET_PLAYER_CONTROL Player Off

//skip_frank_cut1: //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
//SET_PLAYER_COORDINATES player 845.5 -1098.0 -100.0 //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

FORCE_WEATHER_NOW WEATHER_SUNNY

REMOVE_BLIP blip1_fm4
REMOVE_BLIP blip2_fm4


//MEET MARIA ON THE INDUSTRIAL PIER CUT SCENE****************************************************************************

	GET_GAME_TIMER breakout_timer_start
	breakout_diff = 0

	WHILE NOT CAN_PLAYER_START_MISSION Player
	AND breakout_diff < 5000	//	if player is not in control after 5 secs do the cutscene anyway
		WAIT 0

		GET_GAME_TIMER breakout_timer							
		breakout_diff = breakout_timer - breakout_timer_start
	ENDWHILE

	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

//LOAD_SPECIAL_MODEL cut_obj1 PLAYERH

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

LOAD_SPECIAL_CHARACTER 2 maria
LOAD_SPECIAL_CHARACTER 3 asuka
LOAD_SPECIAL_MODEL cut_obj2 MARIAH
LOAD_SPECIAL_MODEL cut_obj3 ASUKAH

//PRINT_BIG ( FM4 ) 15000 2 //"Frankie Mission 4"	 

WHILE GET_FADING_STATUS
	WAIT 0

ENDWHILE

CREATE_CAR BOAT_REEFER 835.0 -1117.0 0.4 boat_mar
SET_CAR_HEADING boat_mar 143.0
ANCHOR_BOAT boat_mar TRUE
BOAT_STOP boat_mar


LOAD_ALL_MODELS_NOW
			  
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_SPECIAL_CHARACTER_LOADED 3 
	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
	WAIT 0

ENDWHILE


LOAD_CUTSCENE S5_LRQB
SET_CUTSCENE_OFFSET 831.0839 -1114.2113 0.1822
//SET_CUTSCENE_OFFSET 830.0839 -1114.2113 0.1822

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_maria
SET_CUTSCENE_ANIM cs_maria maria

CREATE_CUTSCENE_OBJECT PED_SPECIAL3 cs_asuka
SET_CUTSCENE_ANIM cs_asuka asuka

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_maria CUT_OBJ2 cs_mariahead
SET_CUTSCENE_HEAD_ANIM cs_mariahead maria

CREATE_CUTSCENE_HEAD cs_asuka CUT_OBJ3 cs_asukahead
SET_CUTSCENE_HEAD_ANIM cs_asukahead asuka

//SET_PLAYER_COORDINATES player 835.4 -1108.7 1.0

//SET_PLAYER_HEADING player 230.0

IF NOT IS_CAR_DEAD boat_mar
	IF IS_PLAYER_IN_ANY_CAR player
		WARP_PLAYER_FROM_CAR_TO_COORD Player 835.4 -1108.7 1.0
	ENDIF
ENDIF

WARP_PLAYER_INTO_CAR Player boat_mar

DO_FADE 1500 FADE_IN

//SWITCH_WORLD_PROCESSING OFF
SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 697
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_2 ) 10000 1 // Mission brief

WHILE cs_time < 3275
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_3 ) 10000 1 // Mission brief

WHILE cs_time < 6479
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_4 ) 10000 1 // Mission brief

WHILE cs_time < 9000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_4B ) 10000 1 // Mission brief

WHILE cs_time < 11356
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_5 ) 10000 1 // Mission brief

WHILE cs_time < 13307
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_6 ) 10000 1 // Mission brief

WHILE cs_time < 16285
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_6B ) 10000 1 // Mission brief

WHILE cs_time < 19438
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_7 ) 10000 1 // Mission brief

WHILE cs_time < 23340
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_8 ) 10000 1 // Mission brief

WHILE cs_time < 24733
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( FM4_9 ) 10000 1 // Mission brief

WHILE cs_time < 30156
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 31666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

/*
IF NOT IS_CAR_DEAD boat_mar
	SET_CAR_COORDINATES boat_mar 834.9 -1116.5 0.5 
	SET_CAR_HEADING boat_mar 143.0
ENDIF
*/
DO_FADE 1000 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

//SWITCH_WORLD_PROCESSING ON
SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_PLAYER_CONTROL Player ON
SET_CAMERA_BEHIND_PLAYER


CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 837.0 -1116.5 1.8 maria
SET_CHAR_ONLY_DAMAGED_BY_PLAYER maria TRUE
SET_CHAR_HEADING maria 17.0
SET_CHAR_STAYS_IN_CURRENT_LEVEL maria FALSE
SET_CHAR_IGNORE_LEVEL_TRANSITIONS maria TRUE
//ATTACH_CHAR_TO_CAR maria boat_mar -0.8 0.0 9.5 0 360.0 WEAPONTYPE_UNARMED
SET_CHAR_PROOFS maria 0 0 0 1 0
//boat_mar_Y = boat_mar_Y	- 1.0

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL3 836.6 -1114.6 1.8 asuka
SET_CHAR_ONLY_DAMAGED_BY_PLAYER asuka TRUE
SET_CHAR_HEADING asuka 178.0
SET_CHAR_STAYS_IN_CURRENT_LEVEL asuka FALSE
SET_CHAR_IGNORE_LEVEL_TRANSITIONS asuka TRUE
//ATTACH_CHAR_TO_CAR asuka boat_mar -1.0 -0.7 10.0 0 360.0 WEAPONTYPE_UNARMED
SET_CHAR_PROOFS asuka 0 0 0 1 0
SET_CHARS_CHATTING maria asuka 999999

TURN_CHAR_TO_FACE_CHAR asuka maria

IF NOT IS_CAR_DEAD boat_mar
	ADD_BLIP_FOR_COORD 565.3 -678.4 -100.0 blip3_fm4
	ADD_BLIP_FOR_CAR boat_mar boat_blip
ENDIF

WAIT 500

DO_FADE 1000 FADE_IN 

//UNLOAD_SPECIAL_CHARACTER 2
//UNLOAD_SPECIAL_CHARACTER 3
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3

//GOTO skip_frank_cut2 //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	IF NOT IS_CAR_DEAD boat_mar
		ANCHOR_BOAT boat_mar FALSE
	ENDIF

	flag_car_blip_displayed_fm4 = TRUE

	IF IS_CHAR_DEAD	asuka
	OR IS_CHAR_DEAD maria
		GOTO mission_frank4_failed	
	ENDIF

WHILE NOT IS_PLAYER_IN_AREA_3D Player 565.3 -678.4 -2.0 575.3 -688.4 4.0 TRUE
OR NOT IS_CHAR_IN_AREA_3D maria 565.3 -678.4 -2.0 575.3 -688.4 4.0 FALSE
OR NOT IS_CHAR_IN_AREA_3D asuka 565.3 -678.4 -2.0 575.3 -688.4 4.0 FALSE
//OR NOT IS_PLAYER_IN_CAR player boat_mar
	 WAIT 0

		IF IS_CAR_DEAD boat_mar
			GOTO mission_frank4_failed
		ENDIF

		GET_PLAYER_COORDINATES player player_f4x player_f4y player_f4z
		boat_maria_x = player_f4x + 0.6
		boat_maria_y = player_f4y - 0.4

		boat_asuka_x = player_f4x + 0.4
		boat_asuka_y = player_f4y + 0.6

		IF NOT LOCATE_CHAR_ANY_MEANS_2D maria boat_maria_x boat_maria_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT maria boat_maria_x boat_maria_y
			SET_CHARS_CHATTING maria asuka 999999
		ENDIF

		IF NOT LOCATE_CHAR_ANY_MEANS_2D asuka boat_asuka_x boat_asuka_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT asuka boat_asuka_x boat_asuka_y
		ENDIF


		IF IS_CHAR_DEAD	asuka
		OR IS_CHAR_DEAD maria
			GOTO mission_frank4_failed	
		ENDIF
		
		IF IS_PLAYER_IN_CAR player boat_mar
			IF flag_car_blip_displayed_fm4 = TRUE
				REMOVE_BLIP blip3_fm4
				ADD_BLIP_FOR_COORD 565.3 -678.4 -100.0 blip3_fm4
				REMOVE_BLIP boat_blip
				flag_car_blip_displayed_fm4 = FALSE
			ENDIF
		ENDIF

		IF NOT IS_PLAYER_IN_CAR player boat_mar
			IF flag_car_blip_displayed_fm4 = FALSE
				REMOVE_BLIP	boat_blip
				ADD_BLIP_FOR_CAR boat_mar boat_blip
				REMOVE_BLIP blip3_fm4
				PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the vehicle!"
				flag_car_blip_displayed_fm4 = TRUE
			ENDIF
		ENDIF

		IF girls_attack_player = 0
			IF NOT IS_CHAR_HEALTH_GREATER asuka 96
			OR NOT IS_CHAR_HEALTH_GREATER maria 96
				IF NOT IS_CHAR_DEAD	asuka
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT asuka Player
					GIVE_WEAPON_TO_CHAR asuka WEAPONTYPE_UZI 200
				ENDIF
				IF NOT IS_CHAR_DEAD	maria
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT maria Player
					GIVE_WEAPON_TO_CHAR maria WEAPONTYPE_UZI 200
				ENDIF
				girls_attack_player = 1
			ENDIF	
		ENDIF
		 
ENDWHILE

IF NOT IS_CAR_DEAD boat_mar
	ANCHOR_BOAT boat_mar TRUE
	BOAT_STOP boat_mar
ENDIF

CLEAR_PRINTS
REMOVE_BLIP blip3_fm4

//skip_frank_cut2: //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
//SET_PLAYER_COORDINATES player 559.4 -791.9 -100.0 //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

//EVERYONE OFF THE BOAT IN COMMERCIAL CUTSCENE**************************************************************************

	GET_GAME_TIMER breakout_timer_start
	breakout_diff = 0

	WHILE NOT CAN_PLAYER_START_MISSION Player
	AND breakout_diff < 5000	//	if player is not in control after 5 secs do the cutscene anyway
		WAIT 0

		IF IS_CAR_DEAD boat_mar
			GOTO mission_frank4_failed
		ENDIF
	
		IF IS_CHAR_DEAD	asuka
		OR IS_CHAR_DEAD maria
			GOTO mission_frank4_failed	
		ENDIF

		GET_GAME_TIMER breakout_timer							
		breakout_diff = breakout_timer - breakout_timer_start
	ENDWHILE

	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player


SET_FADING_COLOUR 0 0 0

DO_FADE 1000 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0

ENDWHILE

LOAD_COLLISION_WITH_SCREEN Level_commercial

IF NOT IS_CAR_DEAD boat_mar
	IF IS_PLAYER_IN_ANY_CAR player
		WARP_PLAYER_FROM_CAR_TO_COORD Player 515.1 -650.9 16.0//612.3 -674.5 1.8
	ENDIF
ENDIF

SET_PLAYER_COORDINATES player 515.1 -650.9 16.0 //612.3 -674.5 1.8
SET_PLAYER_HEADING player 90.0

SWITCH_STREAMING OFF

LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 MARIAH
LOAD_SPECIAL_MODEL cut_obj3 ASUKAH
REQUEST_MODEL CAR_YAKUZA
REQUEST_MODEL CAR_BLISTA


//PRINT_BIG ( FM4 ) 15000 2 //"Frankie Mission 4"	 

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED CAR_YAKUZA
OR NOT HAS_MODEL_LOADED	CAR_BLISTA
	WAIT 0

ENDWHILE

DELETE_CHAR maria
DELETE_CHAR asuka

LOAD_CUTSCENE S5_LRQC
SET_CUTSCENE_OFFSET 523.102 -636.96 15.616 //563.0 -683.0 1.8
	
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_maria
SET_CUTSCENE_ANIM cs_maria maria

CREATE_CUTSCENE_OBJECT PED_SPECIAL3 cs_asuka
SET_CUTSCENE_ANIM cs_asuka asuka

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_maria CUT_OBJ2 cs_mariahead
SET_CUTSCENE_HEAD_ANIM cs_mariahead maria

CREATE_CUTSCENE_HEAD cs_asuka CUT_OBJ3 cs_asukahead
SET_CUTSCENE_HEAD_ANIM cs_asukahead asuka

DO_FADE 1000 FADE_IN

SET_PLAYER_COORDINATES player 515.1 -650.9 16.0
SET_PLAYER_HEADING player 90.0

CREATE_CAR CAR_YAKUZA 500.0 -659.4 -100.0 frank4_car1

CREATE_CAR CAR_BLISTA 486.5 -643.6 -100.0 frank4_car2

MARK_MODEL_AS_NO_LONGER_NEEDED CAR_YAKUZA
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_BLISTA
MARK_CAR_AS_NO_LONGER_NEEDED frank4_car1
MARK_CAR_AS_NO_LONGER_NEEDED frank4_car2

//SWITCH_WORLD_PROCESSING OFF
SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time


WHILE cs_time < 12345
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LRQC_1 ) 5000 1 // Mission brief

WHILE cs_time < 14476
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LRQC_2 ) 5000 1 // Mission brief

WHILE cs_time < 16021
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LRQC_3 ) 5000 1 // Mission brief

WHILE cs_time < 17946
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LRQC_4 ) 5000 1 // Mission brief

WHILE cs_time < 21438
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LRQC_5 ) 5000 1 // Mission brief

WHILE cs_time < 23312
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LRQC_6 ) 5000 1 // Mission brief

WHILE cs_time < 25177 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 28000 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1000 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

//SWITCH_WORLD_PROCESSING ON
SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER
//SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1000 FADE_IN 


UNLOAD_SPECIAL_CHARACTER 2
UNLOAD_SPECIAL_CHARACTER 3
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
RELEASE_WEATHER
}

GOTO mission_frank4_passed


 // Mission frank4 failed

mission_frank4_failed:
	PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
RETURN

   
// mission frank4 passed

mission_frank4_passed:

USE_TEXT_COMMANDS 108 // HACKED achievement unlock // A_MARKED_MAN

flag_frankie_mission4_passed = 1
flag_industrial_passed = 1
PLAY_MISSION_PASSED_TUNE 1
INDUSTRIAL_PASSED
bridge_is_damaged = 1
	//SWAP BRIDGE FROM DAMAGED TO FIXED
	SWAP_NEAREST_BUILDING_MODEL	525.362 -927.066 71.841	20.0 nbbridgfk2	nbbridgcabls01
	SWAP_NEAREST_BUILDING_MODEL	706.432 -935.82  67.071	20.0 nbbridgfk2	nbbridgcabls01
	SWAP_NEAREST_BUILDING_MODEL	529.023 -920.098 43.504 20.0 damgbridgerdb nbbridgerdb
	SWAP_NEAREST_BUILDING_MODEL	702.763 -939.963 38.736	20.0 damgbridgerdb nbbridgerdb
	SWAP_NEAREST_BUILDING_MODEL	529.023 -942.94  43.504	20.0 damgbbridgerda	nbbridgerda
	SWAP_NEAREST_BUILDING_MODEL	702.764 -919.963 38.736	20.0 damgbbridgerda	nbbridgerda

	SWAP_NEAREST_BUILDING_MODEL	525.362 -927.066 71.841	20.0 lodridgfk2	lodridgcabls01
	SWAP_NEAREST_BUILDING_MODEL	706.432 -935.82  67.071	20.0 lodridgfk2	lodridgcabls01
	SWAP_NEAREST_BUILDING_MODEL	521.146 -922.94  43.504 20.0 lodgbridgerdb lodridgerdb
	SWAP_NEAREST_BUILDING_MODEL	702.763 -939.963 38.736	20.0 lodgbridgerdb lodridgerdb
	SWAP_NEAREST_BUILDING_MODEL	529.023 -940.098 43.504	20.0 lodgbbridgerda	lodridgerda
	SWAP_NEAREST_BUILDING_MODEL	702.764 -919.963 38.736	20.0 lodgbbridgerda	lodridgerda

	SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 1027.26 -933.796 15.042 50.0 indhelix_barrier FALSE 

	SWAP_NEAREST_BUILDING_MODEL 1027.26 -933.796 15.042 50.0 indhelix_barrier LOD_land014  

	DELETE_OBJECT subway_gate_industrial
	DELETE_OBJECT tunnel_gate_industrial

IF ammu2_blip_added = 0
	ADD_SPRITE_BLIP_FOR_CONTACT_POINT 345.5 -713.5 26.1 RADAR_SPRITE_WEAPON com_ammu_nation2
	ADD_SPRITE_BLIP_FOR_CONTACT_POINT 379.0 -493.8 25.2 RADAR_SPRITE_SPRAY com_sprayshop2
	ammu2_blip_added = 1
ENDIF

SWITCH_ROADS_ON 619.6 -911.5 45.0 834.3 -954.5 32.0 //Industrial to commercial Bridge
SWITCH_ROADS_ON 659.6 200.0 -20.0 945.8 147.5 5.0	//Tunnel
SWITCH_ROADS_ON 529.6 106.5 -30.0 581.4 65.7 0.0 //tunnel from commercial to intersection for sub and ind
REGISTER_MISSION_PASSED	FM4
PLAYER_MADE_PROGRESS 1			
SWITCH_CAR_GENERATOR com_car23 101
REMOVE_BLIP frankie_contact_blip
REMOVE_BLIP luigi_contact_blip
REMOVE_BLIP toni_contact_blip
REMOVE_BLIP joey_contact_blip
PRINT_WITH_NUMBER_BIG ( M_PASS ) 20000 5000 1 //"Mission Passed!"
ADD_SCORE player 20000
START_NEW_SCRIPT asuka_mission1_loop
REMOVE_BLIP asuka_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 523.7 -643.0 16.1 RADAR_SPRITE_ASUKA asuka_contact_blip  
RETURN
		

// mission cleanup

mission_cleanup_frank4:

flag_player_on_mission = 0
flag_player_on_frankie_mission = 0
REMOVE_BLIP blip1_fm4
REMOVE_BLIP blip2_fm4
REMOVE_BLIP blip3_fm4
REMOVE_BLIP boat_blip
RELEASE_WEATHER
MARK_MODEL_AS_NO_LONGER_NEEDED BOAT_REEFER 
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_CHEETAH
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_YAKUZA
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_BLISTA 
REMOVE_CHAR_ELEGANTLY maria
REMOVE_CHAR_ELEGANTLY asuka
//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
UNLOAD_SPECIAL_CHARACTER 2
UNLOAD_SPECIAL_CHARACTER 3
MISSION_HAS_FINISHED
RETURN
MISSION_START
// *****************************************************************************************
// ***********************************    Diablo 1 	  **************************************
// *********************************** Low Rider Race **************************************
// *****************************************************************************************
// *** There will be a race to see who is the man. It will start at the top of the 		 ***
// *** bridge and encompass most of the industrial sector. The player must get to the 	 ***
// *** end before his three Hispanic rivals.											 ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_d1

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_d1_failed
ENDIF

GOSUB mission_cleanup_d1

MISSION_END
 
// Variables for mission

//VAR_INT	player_cpcounter_test//TEST VARS
VAR_FLOAT car1_x car1_y car1_z car2_x car2_y car2_z car3_x car3_y car3_z players_x players_y players_z
VAR_FLOAT difference_x_float_d difference_y_float_d	sum_difference_d_xy	ai_car1_locate_size ai_car2_locate_size ai_car3_locate_size
VAR_FLOAT car2_distance_from_cp car1_distance_from_cp car3_distance_from_cp players_distance_from_cp
VAR_FLOAT car1_stuck_x car1_stuck_y car1_stuck_z
VAR_FLOAT car2_stuck_x car2_stuck_y car2_stuck_z
VAR_FLOAT car3_stuck_x car3_stuck_y car3_stuck_z
VAR_FLOAT player_x_d1 player_y_d1 player_z_d1
VAR_FLOAT car1_x_d1 car1_y_d1 car1_z_d1
VAR_FLOAT car2_x_d1 car2_y_d1 car2_z_d1
VAR_FLOAT car3_x_d1 car3_y_d1 car3_z_d1
VAR_FLOAT blip_2nd_x blip_2nd_y blip_2nd_z
VAR_FLOAT cp2_x_d1 cp2_y_d1 cp2_z_d1
VAR_FLOAT cp3_x_d1 cp3_y_d1 cp3_z_d1
VAR_FLOAT cp4_x_d1 cp4_y_d1 cp4_z_d1
VAR_FLOAT cp5_x_d1 cp5_y_d1 cp5_z_d1
VAR_FLOAT cp6_x_d1 cp6_y_d1 cp6_z_d1
VAR_FLOAT cp7_x_d1 cp7_y_d1 cp7_z_d1
VAR_FLOAT cp8_x_d1 cp8_y_d1 cp8_z_d1
VAR_FLOAT cp9_x_d1 cp9_y_d1 cp9_z_d1
VAR_FLOAT cp10_x_d1 cp10_y_d1 cp10_z_d1
VAR_FLOAT cp11_x_d1 cp11_y_d1 cp11_z_d1
VAR_FLOAT cp12_x_d1 cp12_y_d1 cp12_z_d1
VAR_FLOAT cp13_x_d1 cp13_y_d1 cp13_z_d1
VAR_FLOAT cp14_x_d1 cp14_y_d1 cp14_z_d1
VAR_FLOAT cp15_x_d1 cp15_y_d1 cp15_z_d1
VAR_FLOAT cp16_x_d1 cp16_y_d1 cp16_z_d1
VAR_FLOAT cp17_x_d1 cp17_y_d1 cp17_z_d1
VAR_FLOAT cp18_x_d1 cp18_y_d1 cp18_z_d1												   //players_car_speed
VAR_INT blip_chase_d1 second_blip blip_car1_d1 blip_car2_d1 blip_car3_d1			   //players_car_speed_int
VAR_INT car1_d1 car2_d1 car3_d1 car1_health car2_health car3_health	
VAR_INT ped_car1_driver_d1 ped_car2_driver_d1 ped_car3_driver_d1
VAR_INT game_timer_start_d1 game_timer_end_d1 player_cpcounter car1_cpcounter car2_cpcounter car3_cpcounter
VAR_INT behind_car1 behind_car2 behind_car3 position timera_reset_flag_d1 timerb_reset_flag_d1  
VAR_INT timerc timerc_started timerc_current timerc_reset_flag_d1
VAR_INT timerd timerd_started timerd_current timerd_reset_flag
VAR_INT timere timere_started timere_current timere_reset_flag
VAR_INT timerf timerf_started timerf_current timerf_reset_flag

// ****************************************Mission Start************************************

mission_start_d1:

flag_player_on_mission = 1
flag_player_on_diablo_mission = 1

REGISTER_MISSION_GIVEN

// new design, pathing off for racing stuff
DISPLAY_RADAR 2 // PATHING OFF

WAIT 0

SCRIPT_NAME diablo1

game_timer_start_d1  = 0
game_timer_end_d1	 = 0
player_cpcounter 	 = 0
car1_cpcounter 	 	 = 0
car2_cpcounter 	 	 = 0
car3_cpcounter 		 = 0
behind_car1 		 = 0
behind_car2 		 = 0
behind_car3 	 	 = 0
position			 = 0
timera_reset_flag_d1 = 0
timerb_reset_flag_d1 = 0
timerc_reset_flag_d1 = 0
timerc_started 		 = 0
timerc_current 	 	 = 0
timerc				 = 0
timerd 				 = 0
timerd_started 		 = 0
timerd_current 	 	 = 0
timerd_reset_flag	 = 0
ai_car1_locate_size  = 7.0
ai_car2_locate_size  = 7.0
ai_car3_locate_size  = 7.0
timere_reset_flag = 0
timerf_reset_flag = 0
car1_stuck_x = 0.0
car1_stuck_y = 0.0
car1_stuck_z = 0.0
car2_stuck_x = 0.0
car2_stuck_y = 0.0
car2_stuck_z = 0.0
car3_stuck_x = 0.0
car3_stuck_y = 0.0
car3_stuck_z = 0.0

//_____________Check Points____________//

//cp1_x_d1 = 776.0
//cp1_y_d1 = -917.5
//cp1_z_d1 = 39.0

cp2_x_d1 =  1050.859
cp2_y_d1 =  -929.54
cp2_z_d1 =  14.4

cp3_x_d1 =  1314.0
cp3_y_d1 =  -945.0
cp3_z_d1 =  14.8

cp4_x_d1 =  1092.0
cp4_y_d1 =  -1061.0
cp4_z_d1 =  14.3

cp5_x_d1 =  842.0
cp5_y_d1 =  -1009.0
cp5_z_d1 =  4.4

cp6_x_d1 =  855.0
cp6_y_d1 =  -768.8
cp6_z_d1 =  14.6

cp7_x_d1 =  1004.0
cp7_y_d1 =  -822.0
cp7_z_d1 =  14.5

cp8_x_d1 =  1126.0
cp8_y_d1 =  -602.0
cp8_z_d1 =  14.4

cp9_x_d1 =  1196.0
cp9_y_d1 =  -254.0
cp9_z_d1 =  24.4

cp10_x_d1 = 1116.0
cp10_y_d1 = -14.0
cp10_z_d1 = 6.0

cp11_x_d1 = 934.0
cp11_y_d1 = -38.7
cp11_z_d1 = 7.0

cp12_x_d1 = 876.0
cp12_y_d1 = -131.0
cp12_z_d1 = 4.5

cp13_x_d1 = 870.0
cp13_y_d1 = -453.0
cp13_z_d1 = 14.4

cp14_x_d1 = 1049.0
cp14_y_d1 = -473.0
cp14_z_d1 = 14.4

cp15_x_d1 = 1337.0
cp15_y_d1 = -490.0
cp15_z_d1 = 46.0

cp16_x_d1 = 1337.0
cp16_y_d1 = -215.0
cp16_z_d1 = 45.4

cp17_x_d1 = 1048.0
cp17_y_d1 = -249.0
cp17_z_d1 = 5.0

cp18_x_d1 = 980.0
cp18_y_d1 = -565.0
cp18_z_d1 = 14.5

//______________________________________//

{

SET_PED_DENSITY_MULTIPLIER 0.0
CLEAR_AREA_OF_CHARS 890.3 -309.1 0.0 1038.1 -132.9 10.0

TIMERA = 0

/*
SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

//	SWITCH_STREAMING OFF

PRINT_BIG ( DIAB1 ) 15000 2 //"Diablo Mission 1"

IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_d1_failed
ENDIF

WHILE TIMERA < 1500					  
	WAIT 0

ENDWHILE

*/

LOAD_CUTSCENE EL_PH1
//SET_CUTSCENE_OFFSET 939.4 -230.1 3.9
SET_CUTSCENE_OFFSET 938.27 -229.561 4.023
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

DO_FADE 1500 FADE_IN

START_CUTSCENE

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW DIAB1_B 10000 1 //"This is El Buro of the Diablos."

WHILE cs_time < 4731
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW DIAB1_D 10000 1 //"You're new in Liberty, but already you are gaining a reputation on the streets."

WHILE cs_time < 10501
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW DIAB1_E 10000 1 //"There's a street race starting by the old school hall near the Callahan Bridge."

WHILE cs_time < 15111
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW DIAB1_F 10000 1 //"Get yourself some wheels and first through all the checkpoints wins the prize."

WHILE cs_time < 20500
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS
SWITCH_STREAMING ON

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE
SET_PED_DENSITY_MULTIPLIER 1.0

WAIT 500

DO_FADE 1500 FADE_IN

//____________________________________________________________________//


REQUEST_MODEL PED_GANG_DIABLO_A
REQUEST_MODEL PED_GANG_DIABLO_B
REQUEST_MODEL CAR_CHEETAH

WHILE NOT HAS_MODEL_LOADED CAR_CHEETAH
OR NOT HAS_MODEL_LOADED	PED_GANG_DIABLO_A
OR NOT HAS_MODEL_LOADED	PED_GANG_DIABLO_B
	WAIT 0
ENDWHILE

//WHILE NOT IS_BUTTON_PRESSED PAD1 LEFTSHOCK
//	WAIT 0
//ENDWHILE

SWITCH_ROADS_OFF 1034.0 -956.0 12.0 1063.0 -847.0 20.0

CREATE_CAR CAR_CHEETAH 1048.1465 -858.6693 13.7827 car1_d1
LOCK_CAR_DOORS car1_d1 CARLOCK_LOCKED
SET_CAR_PROOFS car1_d1 TRUE TRUE TRUE FALSE TRUE
SET_CAR_WATERTIGHT car1_d1 TRUE
SET_CAR_STRONG car1_d1 TRUE
SET_UPSIDEDOWN_CAR_NOT_DAMAGED car1_d1 TRUE

CREATE_CAR CAR_CHEETAH 1053.3384 -859.3337 13.7827 car2_d1
LOCK_CAR_DOORS car2_d1 CARLOCK_LOCKED
SET_CAR_PROOFS car2_d1 TRUE TRUE TRUE FALSE TRUE
SET_CAR_WATERTIGHT car2_d1 TRUE
SET_CAR_STRONG car2_d1 TRUE
SET_UPSIDEDOWN_CAR_NOT_DAMAGED car2_d1 TRUE

CREATE_CAR CAR_CHEETAH 1058.6385 -859.2989 13.7827 car3_d1
LOCK_CAR_DOORS car3_d1 CARLOCK_LOCKED
SET_CAR_PROOFS car3_d1 TRUE TRUE TRUE FALSE TRUE
SET_CAR_WATERTIGHT car3_d1 TRUE
SET_CAR_STRONG car3_d1 TRUE
SET_UPSIDEDOWN_CAR_NOT_DAMAGED car3_d1 TRUE

CREATE_CHAR_INSIDE_CAR car1_d1 PEDTYPE_CIVMALE PED_GANG_DIABLO_A ped_car1_driver_d1	
CREATE_CHAR_INSIDE_CAR car2_d1 PEDTYPE_CIVMALE PED_GANG_DIABLO_B ped_car2_driver_d1	
CREATE_CHAR_INSIDE_CAR car3_d1 PEDTYPE_CIVMALE PED_GANG_DIABLO_A ped_car3_driver_d1

SET_CHAR_CANT_BE_DRAGGED_OUT ped_car1_driver_d1 TRUE
SET_CHAR_CANT_BE_DRAGGED_OUT ped_car2_driver_d1 TRUE
SET_CHAR_CANT_BE_DRAGGED_OUT ped_car3_driver_d1 TRUE	

SET_CAR_HEADING car1_d1 180.0
SET_CAR_HEADING car2_d1 180.0
SET_CAR_HEADING car3_d1 180.0

CAR_SET_IDLE car1_d1
CAR_SET_IDLE car2_d1
CAR_SET_IDLE car3_d1

SET_CAR_DRIVING_STYLE car1_d1 2
SET_CAR_CRUISE_SPEED car1_d1 50.0

SET_CAR_DRIVING_STYLE car2_d1 2
SET_CAR_CRUISE_SPEED car2_d1 50.0

SET_CAR_DRIVING_STYLE car3_d1 2
SET_CAR_CRUISE_SPEED car3_d1 50.0

SET_CAR_ONLY_DAMAGED_BY_PLAYER car1_d1 TRUE
SET_CAR_ONLY_DAMAGED_BY_PLAYER car2_d1 TRUE
SET_CAR_ONLY_DAMAGED_BY_PLAYER car3_d1 TRUE

ADD_BLIP_FOR_COORD 1042.9772 -858.7398 13.7827 blip_chase_d1

PRINT_NOW DIAB1_4 5000 1 //"~g~Get a fast car and get to the starting grid."					

WHILE NOT LOCATE_STOPPED_PLAYER_IN_CAR_3D player 1042.9772 -858.7398 13.7827 2.0 2.0 2.0 1
							   
	WAIT 0

	IF LOCATE_STOPPED_PLAYER_ON_FOOT_3D player 1042.9772 -858.7398 13.7827 2.0 2.0 2.0 1
		PRINT_NOW YD1_G 5000 1
	ENDIF

	IF IS_CAR_DEAD car1_d1
		GOTO mission_d1_failed
	ENDIF

	IF IS_CAR_DEAD car2_d1
		GOTO mission_d1_failed
	ENDIF

	IF IS_CAR_DEAD car3_d1
		GOTO mission_d1_failed
	ENDIF

	GET_CAR_HEALTH car1_d1 timerc

	IF timerc < 1000
		timerc = 9
		GOTO race_start
	ENDIF

	GET_CAR_HEALTH car2_d1 timerc

	IF timerc < 1000
		timerc = 9
		GOTO race_start
	ENDIF

	GET_CAR_HEALTH car3_d1 timerc

	IF timerc < 1000
		timerc = 9
		GOTO race_start
	ENDIF

//	IF IS_PLAYER_IN_ANY_CAR player
//		STORE_CAR_PLAYER_IS_IN player players_car
//		GET_CAR_SPEED players_car players_car_speed
//		players_car_speed_int =# players_car_speed
//		PRINT_WITH_NUMBER_NOW NUMBER players_car_speed_int 50 1
//	ENDIF

ENDWHILE

race_start:

SET_CAR_ONLY_DAMAGED_BY_PLAYER car1_d1 FALSE
SET_CAR_ONLY_DAMAGED_BY_PLAYER car2_d1 FALSE
SET_CAR_ONLY_DAMAGED_BY_PLAYER car3_d1 FALSE

IF timerc = 9
	PRINT_BIG DIAB1_1 1200 4 // "3..2..1.. GO GO GO!"
ELSE
	SET_PLAYER_CONTROL player OFF
	SET_EVERYONE_IGNORE_PLAYER player TRUE
	SET_ALL_CARS_CAN_BE_DAMAGED FALSE
	PRINT_BIG ( YD1_3 ) 1100 4
	ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_RACE_START_3
	WAIT 1000
	PRINT_BIG ( YD1_2 ) 1100 4
	ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_RACE_START_2
	WAIT 1000
	PRINT_BIG ( YD1_1 ) 1100 4
	ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_RACE_START_1
	WAIT 1000
	PRINT_BIG ( YD1GO ) 800 4
	ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_RACE_START_GO
	SET_PLAYER_CONTROL player ON
	SET_EVERYONE_IGNORE_PLAYER player FALSE
	SET_ALL_CARS_CAN_BE_DAMAGED TRUE
ENDIF

IF IS_CAR_DEAD car1_d1
	GOTO mission_d1_failed
ENDIF

IF IS_CAR_DEAD car2_d1
	GOTO mission_d1_failed
ENDIF

IF IS_CAR_DEAD car3_d1
	GOTO mission_d1_failed
ENDIF

timerc = 0

REMOVE_BLIP blip_chase_d1

ADD_BLIP_FOR_CAR_OLD car1_d1 RED MARKER_ONLY blip_car1_d1
ADD_BLIP_FOR_CAR_OLD car2_d1 RED MARKER_ONLY blip_car2_d1
ADD_BLIP_FOR_CAR_OLD car3_d1 RED MARKER_ONLY blip_car3_d1

player_x_d1 = cp2_x_d1
player_y_d1 = cp2_y_d1
player_z_d1 = cp2_z_d1
blip_2nd_x = cp3_x_d1
blip_2nd_y = cp3_y_d1
blip_2nd_z = cp3_z_d1

car1_x_d1 = cp2_x_d1
car1_y_d1 = cp2_y_d1
car1_z_d1 = cp2_z_d1

car2_x_d1 = cp2_x_d1
car2_y_d1 = cp2_y_d1
car2_z_d1 = cp2_z_d1

car3_x_d1 = cp2_x_d1
car3_y_d1 = cp2_y_d1
car3_z_d1 = cp2_z_d1

ADD_BLIP_FOR_COORD player_x_d1 player_y_d1 player_z_d1 blip_chase_d1
ADD_BLIP_FOR_CONTACT_POINT blip_2nd_x blip_2nd_y blip_2nd_z second_blip
CHANGE_BLIP_SCALE second_blip 2
DIM_BLIP second_blip TRUE
CAR_GOTO_COORDINATES car1_d1 car1_x_d1 car1_y_d1 car1_z_d1
CAR_GOTO_COORDINATES car2_d1 car2_x_d1 car2_y_d1 car2_z_d1
CAR_GOTO_COORDINATES car3_d1 car3_x_d1 car3_y_d1 car3_z_d1

GET_GAME_TIMER game_timer_start_d1
GET_GAME_TIMER game_timer_end_d1
game_timer_end_d1 = game_timer_end_d1 - game_timer_start_d1
game_timer_end_d1 = game_timer_end_d1 / 1000
DISPLAY_ONSCREEN_COUNTER_WITH_STRING game_timer_end_d1 COUNTER_DISPLAY_NUMBER DIAB1_5


loop1:

WAIT 0

GET_GAME_TIMER game_timer_end_d1
game_timer_end_d1 = game_timer_end_d1 - game_timer_start_d1
game_timer_end_d1 = game_timer_end_d1 / 1000
 	
position = 0 + behind_car1 
position += behind_car2 
position += behind_car3

IF position = 0
	PRINT_NOW FIRST 100 1 //"1st"
ENDIF

IF position = 1
	PRINT_NOW SECOND 100 1 //"2nd"
ENDIF

IF position = 2
	PRINT_NOW THIRD 100 1 //"3rd"
ENDIF

IF position = 3
	PRINT_NOW FOURTH 100 1 //"4th"
ENDIF

IF player_cpcounter = 17
	DRAW_CORONA player_x_d1 player_y_d1 player_z_d1 5.5 CORONATYPE_CIRCLE FLARETYPE_NONE 100 0 0
ELSE
	DRAW_CORONA player_x_d1 player_y_d1 player_z_d1 5.5 CORONATYPE_CIRCLE FLARETYPE_NONE 0 0 100
ENDIF

IF LOCATE_PLAYER_IN_CAR_3D player player_x_d1 player_y_d1 player_z_d1 6.0 6.0 6.0 0
	
	++ player_cpcounter
	
	REMOVE_BLIP blip_chase_d1
	REMOVE_BLIP second_blip
	
	IF player_cpcounter = 1
		player_x_d1 = cp3_x_d1
		player_y_d1 = cp3_y_d1
		player_z_d1 = cp3_z_d1
		blip_2nd_x = cp4_x_d1
		blip_2nd_y = cp4_y_d1
		blip_2nd_z = cp4_z_d1
	ENDIF

	IF player_cpcounter = 2
		player_x_d1 = cp4_x_d1
		player_y_d1 = cp4_y_d1
		player_z_d1 = cp4_z_d1
		blip_2nd_x = cp5_x_d1
		blip_2nd_y = cp5_y_d1
		blip_2nd_z = cp5_z_d1
	ENDIF

	IF player_cpcounter = 3
		player_x_d1 = cp5_x_d1
		player_y_d1 = cp5_y_d1
		player_z_d1 = cp5_z_d1
		blip_2nd_x = cp6_x_d1
		blip_2nd_y = cp6_y_d1
		blip_2nd_z = cp6_z_d1
	ENDIF

	IF player_cpcounter = 4
		player_x_d1 = cp6_x_d1
		player_y_d1 = cp6_y_d1
		player_z_d1 = cp6_z_d1
		blip_2nd_x = cp7_x_d1
		blip_2nd_y = cp7_y_d1
		blip_2nd_z = cp7_z_d1
	ENDIF

	IF player_cpcounter = 5
		player_x_d1 = cp7_x_d1
		player_y_d1 = cp7_y_d1
		player_z_d1 = cp7_z_d1
		blip_2nd_x = cp8_x_d1
		blip_2nd_y = cp8_y_d1
		blip_2nd_z = cp8_z_d1
	ENDIF

	IF player_cpcounter = 6
		player_x_d1 = cp8_x_d1
		player_y_d1 = cp8_y_d1
		player_z_d1 = cp8_z_d1
		blip_2nd_x = cp9_x_d1
		blip_2nd_y = cp9_y_d1
		blip_2nd_z = cp9_z_d1
	ENDIF

	IF player_cpcounter = 7
		player_x_d1 = cp9_x_d1
		player_y_d1 = cp9_y_d1
		player_z_d1 = cp9_z_d1
		blip_2nd_x = cp10_x_d1
		blip_2nd_y = cp10_y_d1
		blip_2nd_z = cp10_z_d1
	ENDIF

	IF player_cpcounter = 8
		player_x_d1 = cp10_x_d1
		player_y_d1 = cp10_y_d1
		player_z_d1 = cp10_z_d1
		blip_2nd_x = cp11_x_d1
		blip_2nd_y = cp11_y_d1
		blip_2nd_z = cp11_z_d1
	ENDIF

	IF player_cpcounter = 9
		player_x_d1 = cp11_x_d1
		player_y_d1 = cp11_y_d1
		player_z_d1 = cp11_z_d1
		blip_2nd_x = cp12_x_d1
		blip_2nd_y = cp12_y_d1
		blip_2nd_z = cp12_z_d1
	ENDIF

	IF player_cpcounter = 10
		player_x_d1 = cp12_x_d1
		player_y_d1 = cp12_y_d1
		player_z_d1 = cp12_z_d1
		blip_2nd_x = cp13_x_d1
		blip_2nd_y = cp13_y_d1
		blip_2nd_z = cp13_z_d1
	ENDIF

	IF player_cpcounter = 11
		player_x_d1 = cp13_x_d1
		player_y_d1 = cp13_y_d1
		player_z_d1 = cp13_z_d1
		blip_2nd_x = cp14_x_d1
		blip_2nd_y = cp14_y_d1
		blip_2nd_z = cp14_z_d1
	ENDIF

	IF player_cpcounter = 12
		player_x_d1 = cp14_x_d1
		player_y_d1 = cp14_y_d1
		player_z_d1 = cp14_z_d1
		blip_2nd_x = cp15_x_d1
		blip_2nd_y = cp15_y_d1
		blip_2nd_z = cp15_z_d1
	ENDIF

	IF player_cpcounter = 13
		player_x_d1 = cp15_x_d1
		player_y_d1 = cp15_y_d1
		player_z_d1 = cp15_z_d1
		blip_2nd_x = cp16_x_d1
		blip_2nd_y = cp16_y_d1
		blip_2nd_z = cp16_z_d1
	ENDIF

	IF player_cpcounter = 14
		player_x_d1 = cp16_x_d1
		player_y_d1 = cp16_y_d1
		player_z_d1 = cp16_z_d1
		blip_2nd_x = cp17_x_d1
		blip_2nd_y = cp17_y_d1
		blip_2nd_z = cp17_z_d1
	ENDIF

	IF player_cpcounter = 15
		player_x_d1 = cp17_x_d1
		player_y_d1 = cp17_y_d1
		player_z_d1 = cp17_z_d1
		blip_2nd_x = cp18_x_d1
		blip_2nd_y = cp18_y_d1
		blip_2nd_z = cp18_z_d1
	ENDIF

	IF player_cpcounter = 16
		player_x_d1 = cp18_x_d1
		player_y_d1 = cp18_y_d1
		player_z_d1 = cp18_z_d1
		blip_2nd_x = cp2_x_d1
		blip_2nd_y = cp2_y_d1
		blip_2nd_z = cp2_z_d1
	ENDIF

	IF player_cpcounter = 17
		player_x_d1 = cp2_x_d1
		player_y_d1 = cp2_y_d1
		player_z_d1 = cp2_z_d1
		blip_2nd_x = cp2_x_d1
		blip_2nd_y = cp2_y_d1
		blip_2nd_z = cp2_z_d1
	ENDIF

	IF player_cpcounter = 18
//	AND	position = 0
		GOTO mission_d1_passed		
	ENDIF

	ADD_BLIP_FOR_COORD_OLD blip_2nd_x blip_2nd_y blip_2nd_z PURPLE BLIP_ONLY second_blip
	DIM_BLIP second_blip ON
	CHANGE_BLIP_SCALE second_blip 2
	ADD_BLIP_FOR_COORD player_x_d1 player_y_d1 player_z_d1 blip_chase_d1

ENDIF
		
IF NOT IS_CAR_DEAD car1_d1

	GET_CAR_HEALTH car1_d1 car1_health
	IF car1_health < 500
		SET_CAR_HEALTH car1_d1 1000
	ENDIF

	IF NOT player_cpcounter	= car1_cpcounter
		IF player_cpcounter < car1_cpcounter
			behind_car1 = 1
		ELSE
			behind_car1 = 0
		ENDIF  
	ELSE
		GET_CAR_COORDINATES	car1_d1 car1_x car1_y car1_z
		difference_x_float_d = car1_x - player_x_d1
		difference_y_float_d = car1_y - player_y_d1
		difference_x_float_d = difference_x_float_d * difference_x_float_d
		difference_y_float_d = difference_y_float_d * difference_y_float_d
		sum_difference_d_xy = difference_x_float_d + difference_y_float_d
		SQRT sum_difference_d_xy car1_distance_from_cp

		GET_PLAYER_COORDINATES player players_x players_y players_z
		difference_x_float_d = players_x - player_x_d1
		difference_y_float_d = players_y - player_y_d1
		difference_x_float_d = difference_x_float_d * difference_x_float_d
		difference_y_float_d = difference_y_float_d * difference_y_float_d
		sum_difference_d_xy = difference_x_float_d + difference_y_float_d
		SQRT sum_difference_d_xy players_distance_from_cp

		IF players_distance_from_cp < car1_distance_from_cp
			behind_car1 = 0
		ELSE
			behind_car1 = 1
		ENDIF
	ENDIF

	IF LOCATE_CAR_3D car1_d1 car1_stuck_x car1_stuck_y car1_stuck_z 4.0 4.0 4.0 0
		IF timerd_reset_flag = 0
			GET_GAME_TIMER timerd_started
			timerd_reset_flag = 1
		ENDIF

		IF timerd_reset_flag = 1
			GET_GAME_TIMER timerd_current
			timerd = timerd_current - timerd_started
			IF timerd > 8000
				IF NOT IS_CAR_ON_SCREEN car1_d1
					GET_CAR_COORDINATES car1_d1 car1_x car1_y car1_z
					GET_CLOSEST_CAR_NODE car1_x car1_y car1_z car1_x car1_y car1_z
					IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car1_x car1_y car1_z 4.0 4.0 4.0
						IF NOT IS_POINT_ON_SCREEN car1_x car1_y car1_z 4.0
							SET_CAR_COORDINATES car1_d1 car1_x car1_y car1_z
							TURN_CAR_TO_FACE_COORD car1_d1 car1_x_d1 car1_y_d1
							timerd_reset_flag = 0
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF NOT LOCATE_CAR_3D car1_d1 car1_stuck_x car1_stuck_y car1_stuck_z 4.0 4.0 4.0 0
		GET_CAR_COORDINATES car1_d1 car1_stuck_x car1_stuck_y car1_stuck_z
		timerd_reset_flag = 0
	ENDIF
	
	IF IS_CAR_UPSIDEDOWN car1_d1
	AND IS_CAR_STOPPED car1_d1
		IF NOT IS_CAR_ON_SCREEN car1_d1
			GET_CAR_COORDINATES car1_d1 car1_x car1_y car1_z
			GET_CLOSEST_CAR_NODE car1_x car1_y car1_z car1_x car1_y car1_z
			IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car1_x car1_y car1_z 4.0 4.0 4.0
				IF NOT IS_POINT_ON_SCREEN car1_x car1_y car1_z 3.0
					SET_CAR_COORDINATES car1_d1 car1_x car1_y car1_z
					TURN_CAR_TO_FACE_COORD car1_d1 car1_x_d1 car1_y_d1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF timera_reset_flag_d1 = 1
		IF NOT IS_CAR_STOPPED car1_d1
			timera_reset_flag_d1 = 0
		ENDIF
	ENDIF
		
	IF IS_CAR_STOPPED car1_d1
		IF timera_reset_flag_d1 = 0
			TIMERA = 0
			timera_reset_flag_d1 = 1
		ENDIF

		IF TIMERA > 5000
		AND timera_reset_flag_d1 = 1
			IF NOT IS_CAR_ON_SCREEN car1_d1
				GET_CAR_COORDINATES car1_d1 car1_x car1_y car1_z
				GET_CLOSEST_CAR_NODE car1_x car1_y car1_z car1_x car1_y car1_z
				IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car1_x car1_y car1_z 4.0 4.0 4.0
					IF NOT IS_POINT_ON_SCREEN car1_x car1_y car1_z 4.0
						SET_CAR_COORDINATES car1_d1 car1_x car1_y car1_z
						TURN_CAR_TO_FACE_COORD car1_d1 car1_x_d1 car1_y_d1
						timera_reset_flag_d1 = 0
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF LOCATE_CAR_3D car1_d1 car1_x_d1 car1_y_d1 car1_z_d1 ai_car1_locate_size ai_car1_locate_size ai_car1_locate_size 0
		++ car1_cpcounter

		IF car1_cpcounter = 1
			car1_x_d1 = cp3_x_d1
			car1_y_d1 = cp3_y_d1
			car1_z_d1 = cp3_z_d1
		ENDIF

		IF car1_cpcounter = 2
			car1_x_d1 = cp4_x_d1
			car1_y_d1 = cp4_y_d1
			car1_z_d1 = cp4_z_d1
			SWITCH_ROADS_ON 1034.0 -956.0 12.0 1063.0 -847.0 20.0
		ENDIF

		IF car1_cpcounter = 3
			car1_x_d1 = cp5_x_d1
			car1_y_d1 = cp5_y_d1
			car1_z_d1 = cp5_z_d1
		ENDIF

		IF car1_cpcounter = 4
			car1_x_d1 = cp6_x_d1
			car1_y_d1 = cp6_y_d1
			car1_z_d1 = cp6_z_d1
		ENDIF

		IF car1_cpcounter = 5
			car1_x_d1 = cp7_x_d1
			car1_y_d1 = cp7_y_d1
			car1_z_d1 = cp7_z_d1
		ENDIF

		IF car1_cpcounter = 6
			car1_x_d1 = cp8_x_d1
			car1_y_d1 = cp8_y_d1
			car1_z_d1 = cp8_z_d1
		ENDIF

		IF car1_cpcounter = 7
			car1_x_d1 = cp9_x_d1
			car1_y_d1 = cp9_y_d1
			car1_z_d1 = cp9_z_d1
		ENDIF

		IF car1_cpcounter = 8
			car1_x_d1 = cp10_x_d1
			car1_y_d1 = cp10_y_d1
			car1_z_d1 = cp10_z_d1
		ENDIF

		IF car1_cpcounter = 9
			car1_x_d1 = cp11_x_d1
			car1_y_d1 = cp11_y_d1
			car1_z_d1 = cp11_z_d1
		ENDIF

		IF car1_cpcounter = 10
			car1_x_d1 = cp12_x_d1
			car1_y_d1 = cp12_y_d1
			car1_z_d1 = cp12_z_d1
		ENDIF

		IF car1_cpcounter = 11
			car1_x_d1 = cp13_x_d1
			car1_y_d1 = cp13_y_d1
			car1_z_d1 = cp13_z_d1
		ENDIF

		IF car1_cpcounter = 12
			car1_x_d1 = cp14_x_d1
			car1_y_d1 = cp14_y_d1
			car1_z_d1 = cp14_z_d1
		ENDIF

		IF car1_cpcounter = 13
			car1_x_d1 = cp15_x_d1
			car1_y_d1 = cp15_y_d1
			car1_z_d1 = cp15_z_d1
		ENDIF

		IF car1_cpcounter = 14
			car1_x_d1 = cp16_x_d1
			car1_y_d1 = cp16_y_d1
			car1_z_d1 = cp16_z_d1
		ENDIF

		IF car1_cpcounter = 15
			car1_x_d1 = cp17_x_d1
			car1_y_d1 = cp17_y_d1
			car1_z_d1 = cp17_z_d1
		ENDIF

		IF car1_cpcounter = 16
			car1_x_d1 = cp18_x_d1
			car1_y_d1 = cp18_y_d1
			car1_z_d1 = cp18_z_d1
		ENDIF

		IF car1_cpcounter = 17
			car1_x_d1 = cp2_x_d1
			car1_y_d1 = cp2_y_d1
			car1_z_d1 = cp2_z_d1
			ai_car1_locate_size = 6.0
		ENDIF

		IF car1_cpcounter = 18
//		AND	position > 0
			PRINT_NOW DIAB1_3 5000 1 //"~r~You failed to win the race!"
			GOTO mission_d1_failed		
		ENDIF
		
		IF ai_car1_locate_size = 7.0
			CAR_GOTO_COORDINATES car1_d1 car1_x_d1 car1_y_d1 car1_z_d1
		ELSE
			CAR_GOTO_COORDINATES_ACCURATE car1_d1 car1_x_d1 car1_y_d1 car1_z_d1
		ENDIF

	ENDIF
ELSE

	IF NOT IS_CAR_IN_WATER car1_d1
		behind_car1 = 0
		car1_cpcounter	= 0
	ENDIF

	IF IS_CAR_IN_WATER car1_d1
		IF NOT IS_CAR_ON_SCREEN car1_d1
			GET_CAR_COORDINATES car1_d1 car1_x car1_y car1_z
			GET_CLOSEST_CAR_NODE car1_x car1_y car1_z car1_x car1_y car1_z
			IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car1_x car1_y car1_z 4.0 4.0 4.0
				IF NOT IS_POINT_ON_SCREEN car1_x car1_y car1_z 3.0
					SET_CAR_COORDINATES car1_d1 car1_x car1_y car1_z
					TURN_CAR_TO_FACE_COORD car1_d1 car1_x_d1 car1_y_d1
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
ENDIF

IF NOT IS_CAR_DEAD car2_d1
	
	GET_CAR_HEALTH car2_d1 car2_health
	IF car2_health < 500
		SET_CAR_HEALTH car2_d1 1000
	ENDIF

	IF NOT player_cpcounter	= car2_cpcounter	
		IF player_cpcounter < car2_cpcounter
			behind_car2 = 1
		ELSE
			behind_car2 = 0
		ENDIF
	ELSE
		GET_CAR_COORDINATES car2_d1 car2_x car2_y car2_z
		difference_x_float_d = car2_x - player_x_d1
		difference_y_float_d = car2_y - player_y_d1
		difference_x_float_d = difference_x_float_d * difference_x_float_d
		difference_y_float_d = difference_y_float_d * difference_y_float_d
		sum_difference_d_xy = difference_x_float_d + difference_y_float_d
		SQRT sum_difference_d_xy car2_distance_from_cp

		GET_PLAYER_COORDINATES player players_x players_y players_z
		difference_x_float_d = players_x - player_x_d1
		difference_y_float_d = players_y - player_y_d1
		difference_x_float_d = difference_x_float_d * difference_x_float_d
		difference_y_float_d = difference_y_float_d * difference_y_float_d
		sum_difference_d_xy = difference_x_float_d + difference_y_float_d
		SQRT sum_difference_d_xy players_distance_from_cp

		IF players_distance_from_cp < car2_distance_from_cp
			behind_car2 = 0
		ELSE
			behind_car2 = 1
		ENDIF
	ENDIF
		
	IF LOCATE_CAR_3D car2_d1 car2_stuck_x car2_stuck_y car2_stuck_z 4.0 4.0 4.0 0
		IF timere_reset_flag = 0
			GET_GAME_TIMER timere_started
			timere_reset_flag = 1
		ENDIF

		IF timere_reset_flag = 1
			GET_GAME_TIMER timere_current
			timere = timere_current - timere_started
			IF timere > 8000
				IF NOT IS_CAR_ON_SCREEN car2_d1
					GET_CAR_COORDINATES car2_d1 car2_x car2_y car2_z
					GET_CLOSEST_CAR_NODE car2_x car2_y car2_z car2_x car2_y car2_z
					IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car2_x car2_y car2_z 4.0 4.0 4.0
						IF NOT IS_POINT_ON_SCREEN car2_x car2_y car2_z 4.0
							SET_CAR_COORDINATES car2_d1 car2_x car2_y car2_z
							TURN_CAR_TO_FACE_COORD car2_d1 car2_x_d1 car2_y_d1
							timere_reset_flag = 0
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF NOT LOCATE_CAR_3D car2_d1 car2_stuck_x car2_stuck_y car2_stuck_z 4.0 4.0 4.0 0
		GET_CAR_COORDINATES car2_d1 car2_stuck_x car2_stuck_y car2_stuck_z
		timere_reset_flag = 0
	ENDIF
	
	IF IS_CAR_UPSIDEDOWN car2_d1
	AND IS_CAR_STOPPED car2_d1
		IF NOT IS_CAR_ON_SCREEN car2_d1
			GET_CAR_COORDINATES car2_d1 car2_x car2_y car2_z
			GET_CLOSEST_CAR_NODE car2_x car2_y car2_z car2_x car2_y car2_z
			IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car2_x car2_y car2_z 4.0 4.0 4.0
				IF NOT IS_POINT_ON_SCREEN car2_x car2_y car2_z 3.0
					SET_CAR_COORDINATES car2_d1 car2_x car2_y car2_z
					TURN_CAR_TO_FACE_COORD car2_d1 car2_x_d1 car2_y_d1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF timerb_reset_flag_d1 = 1
		IF NOT IS_CAR_STOPPED car2_d1
			timerb_reset_flag_d1 = 0
		ENDIF
	ENDIF
		
	IF IS_CAR_STOPPED car2_d1
		IF timerb_reset_flag_d1 = 0
			TIMERB = 0
			timerb_reset_flag_d1 = 1
		ENDIF

		IF TIMERB > 5000
		AND timerb_reset_flag_d1 = 1
			IF NOT IS_CAR_ON_SCREEN car2_d1
				GET_CAR_COORDINATES car2_d1 car2_x car2_y car2_z
				GET_CLOSEST_CAR_NODE car2_x car2_y car2_z car2_x car2_y car2_z
				IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car2_x car2_y car2_z 4.0 4.0 4.0
					IF NOT IS_POINT_ON_SCREEN car2_x car2_y car2_z 4.0
						SET_CAR_COORDINATES car2_d1 car2_x car2_y car2_z
						TURN_CAR_TO_FACE_COORD car2_d1 car2_x_d1 car2_y_d1
						timerb_reset_flag_d1 = 0
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF LOCATE_CAR_3D car2_d1 car2_x_d1 car2_y_d1 car2_z_d1 ai_car2_locate_size ai_car2_locate_size ai_car2_locate_size 0
		++ car2_cpcounter

		IF car2_cpcounter = 1
			car2_x_d1 = cp3_x_d1
			car2_y_d1 = cp3_y_d1
			car2_z_d1 = cp3_z_d1
		ENDIF

		IF car2_cpcounter = 2
			car2_x_d1 = cp4_x_d1
			car2_y_d1 = cp4_y_d1
			car2_z_d1 = cp4_z_d1
		ENDIF

		IF car2_cpcounter = 3
			car2_x_d1 = cp5_x_d1
			car2_y_d1 = cp5_y_d1
			car2_z_d1 = cp5_z_d1
		ENDIF

		IF car2_cpcounter = 4
			car2_x_d1 = cp6_x_d1
			car2_y_d1 = cp6_y_d1
			car2_z_d1 = cp6_z_d1
		ENDIF

		IF car2_cpcounter = 5
			car2_x_d1 = cp7_x_d1
			car2_y_d1 = cp7_y_d1
			car2_z_d1 = cp7_z_d1
		ENDIF

		IF car2_cpcounter = 6
			car2_x_d1 = cp8_x_d1
			car2_y_d1 = cp8_y_d1
			car2_z_d1 = cp8_z_d1
		ENDIF

		IF car2_cpcounter = 7
			car2_x_d1 = cp9_x_d1
			car2_y_d1 = cp9_y_d1
			car2_z_d1 = cp9_z_d1
		ENDIF

		IF car2_cpcounter = 8
			car2_x_d1 = cp10_x_d1
			car2_y_d1 = cp10_y_d1
			car2_z_d1 = cp10_z_d1
		ENDIF

		IF car2_cpcounter = 9
			car2_x_d1 = cp11_x_d1
			car2_y_d1 = cp11_y_d1
			car2_z_d1 = cp11_z_d1
		ENDIF

		IF car2_cpcounter = 10
			car2_x_d1 = cp12_x_d1
			car2_y_d1 = cp12_y_d1
			car2_z_d1 = cp12_z_d1
		ENDIF

		IF car2_cpcounter = 11
			car2_x_d1 = cp13_x_d1
			car2_y_d1 = cp13_y_d1
			car2_z_d1 = cp13_z_d1
		ENDIF

		IF car2_cpcounter = 12
			car2_x_d1 = cp14_x_d1
			car2_y_d1 = cp14_y_d1
			car2_z_d1 = cp14_z_d1
		ENDIF

		IF car2_cpcounter = 13
			car2_x_d1 = cp15_x_d1
			car2_y_d1 = cp15_y_d1
			car2_z_d1 = cp15_z_d1
		ENDIF

		IF car2_cpcounter = 14
			car2_x_d1 = cp16_x_d1
			car2_y_d1 = cp16_y_d1
			car2_z_d1 = cp16_z_d1
		ENDIF

		IF car2_cpcounter = 15
			car2_x_d1 = cp17_x_d1
			car2_y_d1 = cp17_y_d1
			car2_z_d1 = cp17_z_d1
		ENDIF
		
		IF car2_cpcounter = 16
			car2_x_d1 = cp18_x_d1
			car2_y_d1 = cp18_y_d1
			car2_z_d1 = cp18_z_d1
		ENDIF
		
		IF car2_cpcounter = 17
			car2_x_d1 = cp2_x_d1
			car2_y_d1 = cp2_y_d1
			car2_z_d1 = cp2_z_d1
			ai_car2_locate_size = 6.0
		ENDIF

		IF car2_cpcounter = 18
//		AND	position > 0
			PRINT_NOW DIAB1_3 5000 1 //"~r~You failed to win the race!"
			GOTO mission_d1_failed		
		ENDIF
		
		IF ai_car2_locate_size = 7.0
			CAR_GOTO_COORDINATES car2_d1 car2_x_d1 car2_y_d1 car2_z_d1
		ELSE
			CAR_GOTO_COORDINATES_ACCURATE car2_d1 car2_x_d1 car2_y_d1 car2_z_d1
		ENDIF

	ENDIF
ELSE

	IF NOT IS_CAR_IN_WATER car2_d1
		behind_car2 = 0
		car2_cpcounter = 0
	ENDIF

	IF IS_CAR_IN_WATER car2_d1
		IF NOT IS_CAR_ON_SCREEN car2_d1
			GET_CAR_COORDINATES car2_d1 car2_x car2_y car2_z
			GET_CLOSEST_CAR_NODE car2_x car2_y car2_z car2_x car2_y car2_z
			IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car2_x car2_y car2_z 4.0 4.0 4.0
				IF NOT IS_POINT_ON_SCREEN car2_x car2_y car2_z 3.0
					SET_CAR_COORDINATES car2_d1 car2_x car2_y car2_z
					TURN_CAR_TO_FACE_COORD car2_d1 car2_x_d1 car2_y_d1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

ENDIF

IF NOT IS_CAR_DEAD car3_d1
	
	GET_CAR_HEALTH car3_d1 car3_health
	IF car3_health < 500
		SET_CAR_HEALTH car3_d1 1000
	ENDIF

	IF NOT player_cpcounter	= car3_cpcounter	
		IF player_cpcounter < car3_cpcounter
			behind_car3 = 1
		ELSE
			behind_car3 = 0
		ENDIF
	ELSE
		GET_CAR_COORDINATES	car3_d1 car3_x car3_y car3_z
		difference_x_float_d = car3_x - player_x_d1
		difference_y_float_d = car3_y - player_y_d1
		difference_x_float_d = difference_x_float_d * difference_x_float_d
		difference_y_float_d = difference_y_float_d * difference_y_float_d
		sum_difference_d_xy = difference_x_float_d + difference_y_float_d
		SQRT sum_difference_d_xy car3_distance_from_cp

		GET_PLAYER_COORDINATES player players_x players_y players_z
		difference_x_float_d = players_x - player_x_d1
		difference_y_float_d = players_y - player_y_d1
		difference_x_float_d = difference_x_float_d * difference_x_float_d
		difference_y_float_d = difference_y_float_d * difference_y_float_d
		sum_difference_d_xy = difference_x_float_d + difference_y_float_d
		SQRT sum_difference_d_xy players_distance_from_cp

		IF players_distance_from_cp < car3_distance_from_cp
			behind_car3 = 0
		ELSE
			behind_car3 = 1
		ENDIF
	ENDIF
	
	IF LOCATE_CAR_3D car3_d1 car3_stuck_x car3_stuck_y car3_stuck_z 4.0 4.0 4.0 0
		IF timerf_reset_flag = 0
			GET_GAME_TIMER timerf_started
			timerf_reset_flag = 1
		ENDIF

		IF timerf_reset_flag = 1
			GET_GAME_TIMER timerf_current
			timerf = timerf_current - timerf_started
			IF timerf > 8000
				IF NOT IS_CAR_ON_SCREEN car3_d1
					GET_CAR_COORDINATES car3_d1 car3_x car3_y car3_z
					GET_CLOSEST_CAR_NODE car3_x car3_y car3_z car3_x car3_y car3_z
					IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car3_x car3_y car3_z 4.0 4.0 4.0
						IF NOT IS_POINT_ON_SCREEN car3_x car3_y car3_z 4.0
							SET_CAR_COORDINATES car3_d1 car3_x car3_y car3_z
							TURN_CAR_TO_FACE_COORD car3_d1 car3_x_d1 car3_y_d1
							timerf_reset_flag = 0
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
	IF NOT LOCATE_CAR_3D car3_d1 car3_stuck_x car3_stuck_y car3_stuck_z 4.0 4.0 4.0 0
		GET_CAR_COORDINATES car3_d1 car3_stuck_x car3_stuck_y car3_stuck_z
		timerf_reset_flag = 0
	ENDIF
	
	IF IS_CAR_UPSIDEDOWN car3_d1
	AND IS_CAR_STOPPED car3_d1
		IF NOT IS_CAR_ON_SCREEN car3_d1
			GET_CAR_COORDINATES car3_d1 car3_x car3_y car3_z
			GET_CLOSEST_CAR_NODE car3_x car3_y car3_z car3_x car3_y car3_z
			IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car3_x car3_y car3_z 4.0 4.0 4.0
				IF NOT IS_POINT_ON_SCREEN car3_x car3_y car3_z 3.0
					SET_CAR_COORDINATES car3_d1 car3_x car3_y car3_z
					TURN_CAR_TO_FACE_COORD car3_d1 car3_x_d1 car3_y_d1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF timerc_reset_flag_d1 = 1
		IF NOT IS_CAR_STOPPED car3_d1
			timerc_reset_flag_d1 = 0
		ENDIF
	ENDIF
		
	IF IS_CAR_STOPPED car3_d1
		IF timerc_reset_flag_d1 = 0
			GET_GAME_TIMER timerc_started
			timerc_reset_flag_d1 = 1
		ENDIF

		IF timerc_reset_flag_d1 = 1
			GET_GAME_TIMER timerc_current
			timerc = timerc_current - timerc_started
			IF timerc > 5000
				IF NOT IS_CAR_ON_SCREEN car3_d1
					GET_CAR_COORDINATES car3_d1 car3_x car3_y car3_z
					GET_CLOSEST_CAR_NODE car3_x car3_y car3_z car3_x car3_y car3_z
					IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car3_x car3_y car3_z 4.0 4.0 4.0
						IF NOT IS_POINT_ON_SCREEN car3_x car3_y car3_z 4.0
							SET_CAR_COORDINATES car3_d1 car3_x car3_y car3_z
							TURN_CAR_TO_FACE_COORD car3_d1 car3_x_d1 car3_y_d1
							timerc_reset_flag_d1 = 0
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF LOCATE_CAR_3D car3_d1 car3_x_d1 car3_y_d1 car3_z_d1 ai_car3_locate_size ai_car3_locate_size ai_car3_locate_size 0
		++ car3_cpcounter

		IF car3_cpcounter = 1
			car3_x_d1 = cp3_x_d1
			car3_y_d1 = cp3_y_d1
			car3_z_d1 = cp3_z_d1
		ENDIF

		IF car3_cpcounter = 2
			car3_x_d1 = cp4_x_d1
			car3_y_d1 = cp4_y_d1
			car3_z_d1 = cp4_z_d1
		ENDIF

		IF car3_cpcounter = 3
			car3_x_d1 = cp5_x_d1
			car3_y_d1 = cp5_y_d1
			car3_z_d1 = cp5_z_d1
		ENDIF

		IF car3_cpcounter = 4
			car3_x_d1 = cp6_x_d1
			car3_y_d1 = cp6_y_d1
			car3_z_d1 = cp6_z_d1
		ENDIF

		IF car3_cpcounter = 5
			car3_x_d1 = cp7_x_d1
			car3_y_d1 = cp7_y_d1
			car3_z_d1 = cp7_z_d1
		ENDIF

		IF car3_cpcounter = 6
			car3_x_d1 = cp8_x_d1
			car3_y_d1 = cp8_y_d1
			car3_z_d1 = cp8_z_d1
		ENDIF

		IF car3_cpcounter = 7
			car3_x_d1 = cp9_x_d1
			car3_y_d1 = cp9_y_d1
			car3_z_d1 = cp9_z_d1
		ENDIF

		IF car3_cpcounter = 8
			car3_x_d1 = cp10_x_d1
			car3_y_d1 = cp10_y_d1
			car3_z_d1 = cp10_z_d1
		ENDIF

		IF car3_cpcounter = 9
			car3_x_d1 = cp11_x_d1
			car3_y_d1 = cp11_y_d1
			car3_z_d1 = cp11_z_d1
		ENDIF

		IF car3_cpcounter = 10
			car3_x_d1 = cp12_x_d1
			car3_y_d1 = cp12_y_d1
			car3_z_d1 = cp12_z_d1
		ENDIF

		IF car3_cpcounter = 11
			car3_x_d1 = cp13_x_d1
			car3_y_d1 = cp13_y_d1
			car3_z_d1 = cp13_z_d1
		ENDIF

		IF car3_cpcounter = 12
			car3_x_d1 = cp14_x_d1
			car3_y_d1 = cp14_y_d1
			car3_z_d1 = cp14_z_d1
		ENDIF

		IF car3_cpcounter = 13
			car3_x_d1 = cp15_x_d1
			car3_y_d1 = cp15_y_d1
			car3_z_d1 = cp15_z_d1
		ENDIF

		IF car3_cpcounter = 14
			car3_x_d1 = cp16_x_d1
			car3_y_d1 = cp16_y_d1
			car3_z_d1 = cp16_z_d1
		ENDIF

		IF car3_cpcounter = 15
			car3_x_d1 = cp17_x_d1
			car3_y_d1 = cp17_y_d1
			car3_z_d1 = cp17_z_d1
		ENDIF
		
		IF car3_cpcounter = 16
			car3_x_d1 = cp18_x_d1
			car3_y_d1 = cp18_y_d1
			car3_z_d1 = cp18_z_d1
		ENDIF
		
		IF car3_cpcounter = 17
			car3_x_d1 = cp2_x_d1
			car3_y_d1 = cp2_y_d1
			car3_z_d1 = cp2_z_d1
			ai_car3_locate_size = 6.0
		ENDIF

		IF car3_cpcounter = 18
//		AND	position > 0
			PRINT_NOW DIAB1_3 5000 1 //"~r~You failed to win the race!"
			GOTO mission_d1_failed		
		ENDIF

		IF ai_car3_locate_size = 7.0
			CAR_GOTO_COORDINATES car3_d1 car3_x_d1 car3_y_d1 car3_z_d1 
		ELSE
			CAR_GOTO_COORDINATES_ACCURATE car3_d1 car3_x_d1 car3_y_d1 car3_z_d1 
		ENDIF

	ENDIF
ELSE

	IF NOT IS_CAR_IN_WATER car3_d1
		behind_car3 = 0
		car3_cpcounter = 0
	ENDIF

	IF IS_CAR_IN_WATER car3_d1
		IF NOT IS_CAR_ON_SCREEN car3_d1
			GET_CAR_COORDINATES car3_d1 car3_x car3_y car3_z
			GET_CLOSEST_CAR_NODE car3_x car3_y car3_z car3_x car3_y car3_z
			IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY car3_x car3_y car3_z 4.0 4.0 4.0
				IF NOT IS_POINT_ON_SCREEN car3_x car3_y car3_z 3.0
					SET_CAR_COORDINATES car3_d1 car3_x car3_y car3_z
					TURN_CAR_TO_FACE_COORD car3_d1 car3_x_d1 car3_y_d1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

ENDIF

GOTO loop1
}	   		
	
// Mission d1 failed

mission_d1_failed:
PRINT_BIG M_FAIL 2000 1
RETURN

   

// mission d1 passed

mission_d1_passed:

GET_GAME_TIMER game_timer_end_d1
game_timer_end_d1 = game_timer_end_d1 - game_timer_start_d1
game_timer_end_d1 = game_timer_end_d1 / 1000
ADD_SCORE player 10000
PRINT_WITH_NUMBER_BIG M_PASS 10000 5000 1
PRINT_WITH_NUMBER_NOW DIAB1_2 game_timer_end_d1 5000 1 //"Race time: ~1~ seconds"
REGISTER_EL_BURRO_TIME game_timer_end_d1
CLEAR_WANTED_LEVEL player
PLAY_MISSION_PASSED_TUNE 1
//CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_DIABLO THREAT_PLAYER1

IF flag_diablo1_passed_before = 0
	REGISTER_MISSION_PASSED	DIAB1
	PLAYER_MADE_PROGRESS 1
	flag_diablo_mission1_passed = 1
	START_NEW_SCRIPT diablo_mission2_loop
	flag_diablo1_passed_before = 1
ENDIF

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		

// mission cleanup

mission_cleanup_d1:

DISPLAY_RADAR 3 // PATHING ON

SWITCH_ROADS_ON 1034.0 -956.0 12.0 1063.0 -847.0 20.0

REMOVE_BLIP blip_car1_d1
REMOVE_BLIP blip_car2_d1
REMOVE_BLIP blip_car3_d1
REMOVE_BLIP blip_chase_d1
REMOVE_BLIP second_blip
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_DIABLO_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_DIABLO_B
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_CHEETAH
CLEAR_ONSCREEN_COUNTER game_timer_end_d1

flag_player_on_mission = 0
flag_player_on_diablo_mission = 0
MISSION_HAS_FINISHED
RETURN
		

MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Deablo mission 2**************************************
// ***********************************Destroy Icream Vans*************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff			

GOSUB mission_start_diablo2

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_diablo2_failed
ENDIF

GOSUB mission_cleanup_diablo2

MISSION_END

// Variables for mission

VAR_INT icecream_van1  flag_car_blip_displayed_dm2 // Vehicle for mission

VAR_INT blip1_icecream1 blip1_diablo2 blip2_diablo2	creamers_spotted_you

VAR_INT briefcase_diablo2 removed_ice_cream_blip// Counts up number of mission vans destroyed

VAR_INT ojective_creamed_guys_passed //ice_creamvan_stored_before

VAR_INT icecream_man1 icecreamvan_any creamed_guy1 creamed_guy2 creamed_guy3 creamed_guy4	
 
VAR_INT ojective_creamed_guy1_done_before ojective_creamed_guy2_done_before ojective_creamed_guy3_done_before ojective_creamed_guy4_done_before

VAR_FLOAT icecreamx icecreamy icecreamz 

VAR_INT creamed_guy1_health creamed_guy2_health creamed_guy3_health creamed_guy4_health

// ***************************************Mission Start*************************************

mission_start_diablo2:

REGISTER_MISSION_GIVEN

flag_player_on_mission = 1
flag_player_on_diablo_mission = 1
SCRIPT_NAME diablo2
WAIT 0

{

SET_PED_DENSITY_MULTIPLIER 0.0
CLEAR_AREA_OF_CHARS 890.3 -309.1 0.0 1038.1 -132.9 10.0

LOAD_CUTSCENE EL_PH2
SET_CUTSCENE_OFFSET 938.27 -229.561 4.023
				
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player


DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( DIAB2_A ) 10000 1 

WHILE cs_time < 9115
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_B ) 10000 1 

WHILE cs_time < 15149
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_C ) 10000 1 

WHILE cs_time < 18028
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_D ) 10000 1 

WHILE cs_time < 20605
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_E ) 10000 1 

WHILE cs_time < 22985
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_F ) 10000 1 

WHILE cs_time < 26130
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_G ) 10000 1 

WHILE cs_time < 30784
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_H ) 10000 1 

WHILE cs_time < 33726
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 34000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE


DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

WAIT 500

DO_FADE 1500 FADE_IN


SET_PED_DENSITY_MULTIPLIER 1.0

ojective_creamed_guy1_done_before = 0
ojective_creamed_guy2_done_before = 0
ojective_creamed_guy3_done_before = 0
ojective_creamed_guy4_done_before = 0
ojective_creamed_guys_passed = 0
creamers_spotted_you = 0
removed_ice_cream_blip = 0

REQUEST_MODEL CAR_MRWHOOPEE
REQUEST_MODEL PED_GANG_MAFIA_A
REQUEST_MODEL PED_LI_MAN1
						  

	WHILE NOT HAS_MODEL_LOADED CAR_MRWHOOPEE
	OR NOT HAS_MODEL_LOADED PED_GANG_MAFIA_A
	OR NOT HAS_MODEL_LOADED PED_LI_MAN1
		WAIT 0
	ENDWHILE

WAIT 2000

CREATE_PICKUP briefcase PICKUP_ONCE	934.9 -69.8 8.1 briefcase_diablo2
ADD_BLIP_FOR_PICKUP	briefcase_diablo2 blip1_diablo2

PRINT ( DIAB2_1 ) 5000 1 // Pick up briefcase

WHILE NOT HAS_PICKUP_BEEN_COLLECTED briefcase_diablo2 
	WAIT 0

ENDWHILE

REMOVE_BLIP blip1_diablo2

// after the briefcase is collected, turn off pathing when looking for the ice cream truck
DISPLAY_RADAR 2 // PATHING OFF

CREATE_CAR CAR_MRWHOOPEE 1381.0 -382.0 -100.0 icecream_van1  
CREATE_CHAR_INSIDE_CAR icecream_van1 PEDTYPE_CIVMALE PED_LI_MAN1 icecream_man1
SET_CAR_DRIVING_STYLE icecream_van1 DRIVINGMODE_STOPFORCARS
ADD_BLIP_FOR_CAR icecream_van1 blip1_icecream1

PRINT_NOW ( DIAB2_2 ) 5000 1 // Find an icecream van


WHILE NOT IS_PLAYER_IN_MODEL Player CAR_MRWHOOPEE
	WAIT 0

	IF IS_CAR_DEAD icecream_van1 
		GOTO mission_diablo2_failed	
	ENDIF

ENDWHILE

// turn pathing back on when going to park the truck
DISPLAY_RADAR 3 // PATHING ON

REMOVE_BLIP blip1_icecream1
STORE_CAR_PLAYER_IS_IN player icecreamvan_any

	IF NOT IS_CAR_DEAD icecreamvan_any 
		ARM_CAR_WITH_BOMB icecreamvan_any CARBOMB_REMOTE
		GIVE_PLAYER_DETONATOR
		SET_CURRENT_PLAYER_WEAPON Player WEAPONTYPE_DETONATOR
	ENDIF

 PRINT_NOW ( DIAB2_3 ) 5000 1 // Park the icecream van down at atlantic quays

flag_car_blip_displayed_dm2 = TRUE
blob_flag = 1
 
WHILE NOT IS_CAR_STOPPED_IN_AREA_3D icecreamvan_any 1215.9 -1128.7 11.2 1210.4 -1123.3 14.2 blob_flag
OR NOT IS_PLAYER_IN_CAR player icecreamvan_any
OR NOT IS_ICECREAM_JINGLE_ON icecreamvan_any

	WAIT 0

		IF IS_CAR_DEAD icecreamvan_any 
			GOTO mission_diablo2_failed	
		ENDIF

		IF IS_CAR_STOPPED_IN_AREA_3D icecreamvan_any 1215.9 -1128.7 11.2 1210.4 -1123.3 14.2 FALSE
		AND IS_PLAYER_IN_CAR player icecreamvan_any
			PRINT_NOW ( DIAB2_6 ) 1000 1 // Tap L3 quickly to set the Icecream jingle
		ENDIF
		
		IF IS_PLAYER_IN_CAR player icecreamvan_any
			IF flag_car_blip_displayed_dm2 = TRUE
				ADD_BLIP_FOR_COORD 1213.5 -1125.6 11.9.0 blip2_diablo2
				blob_flag = 1
				REMOVE_BLIP blip1_icecream1
				flag_car_blip_displayed_dm2 = FALSE
			ENDIF
		ENDIF

		IF NOT IS_PLAYER_IN_CAR player icecreamvan_any
			IF flag_car_blip_displayed_dm2 = FALSE
				ADD_BLIP_FOR_CAR icecreamvan_any blip1_icecream1
				blob_flag = 0
				REMOVE_BLIP blip2_diablo2
				PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the car!"
				flag_car_blip_displayed_dm2 = TRUE
			ENDIF
		ENDIF
			
ENDWHILE	

CLEAR_AREA 1190.5 -1141.2 11.6 2.0 TRUE		
CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A 1190.5 -1141.2 11.6 creamed_guy1

CLEAR_AREA 1192.5 -1141.2 11.6 2.0 TRUE		
CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A 1192.5 -1141.2 11.6 creamed_guy2

CLEAR_AREA 1194.5 -1141.2 11.6 2.0 TRUE		
CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A 1194.5 -1141.2 11.6 creamed_guy3

CLEAR_AREA 1196.5 -1141.2 11.6 2.0 TRUE		
CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A 1196.5 -1141.2 11.6 creamed_guy4

GIVE_WEAPON_TO_CHAR creamed_guy1 WEAPONTYPE_UZI 160
GIVE_WEAPON_TO_CHAR creamed_guy2 WEAPONTYPE_UZI 160
GIVE_WEAPON_TO_CHAR creamed_guy3 WEAPONTYPE_UZI 160
GIVE_WEAPON_TO_CHAR creamed_guy4 WEAPONTYPE_UZI 160
SET_CHAR_PERSONALITY creamed_guy1 PEDSTAT_TOUGH_GUY
SET_CHAR_PERSONALITY creamed_guy2 PEDSTAT_TOUGH_GUY								   								   								   								   
SET_CHAR_PERSONALITY creamed_guy3 PEDSTAT_TOUGH_GUY								   								   								   								   
SET_CHAR_PERSONALITY creamed_guy4 PEDSTAT_TOUGH_GUY								   								   								   								   								   								   								   								   

PRINT_NOW ( DIAB2_5 ) 5000 1 // Use the remote to detonate the icecream van

WAIT 2000

CLEAR_AREA 1205.6 -1141.1 11.6 10.0 TRUE		

IF NOT IS_CHAR_DEAD	creamed_guy1
	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT creamed_guy1 1205.6 -1141.1
ENDIF

IF NOT IS_CHAR_DEAD	creamed_guy2
	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT creamed_guy2 1205.6 -1141.1
ENDIF

IF NOT IS_CHAR_DEAD	creamed_guy3
	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT creamed_guy3 1205.6 -1141.1
ENDIF

IF NOT IS_CHAR_DEAD	creamed_guy4
	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT creamed_guy4 1205.6 -1141.1
ENDIF


WHILE NOT ojective_creamed_guys_passed = 4
	WAIT 0

	IF IS_CAR_DEAD icecreamvan_any
	AND removed_ice_cream_blip = 0 
		REMOVE_BLIP blip1_icecream1
		removed_ice_cream_blip = 1		
	ENDIF

	IF IS_CHAR_DEAD creamed_guy1
	AND IS_CHAR_DEAD creamed_guy2
	AND IS_CHAR_DEAD creamed_guy3
	AND IS_CHAR_DEAD creamed_guy4
		GOTO mission_diablo2_passed
	ENDIF	

	IF IS_CHAR_DEAD creamed_guy1
	AND ojective_creamed_guy1_done_before = 0
		ojective_creamed_guys_passed ++
		ojective_creamed_guy1_done_before = 1
	ENDIF

	IF IS_CHAR_DEAD creamed_guy2
	AND ojective_creamed_guy2_done_before = 0
		ojective_creamed_guys_passed ++
		ojective_creamed_guy2_done_before = 1
	ENDIF

	IF IS_CHAR_DEAD creamed_guy3
	AND ojective_creamed_guy3_done_before = 0
		ojective_creamed_guys_passed ++
		ojective_creamed_guy3_done_before = 1
	ENDIF

	IF IS_CHAR_DEAD creamed_guy4
	AND ojective_creamed_guy4_done_before = 0
		ojective_creamed_guys_passed ++
		ojective_creamed_guy4_done_before = 1
	ENDIF

	GET_CAR_COORDINATES icecreamvan_any icecreamx icecreamy icecreamz
	icecreamx = icecreamx - 2.0 // offset a bit so they dont accidentally path into the truck 
	
	IF IS_CHAR_OBJECTIVE_PASSED creamed_guy1
	AND ojective_creamed_guy1_done_before = 0
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT creamed_guy1 icecreamx icecreamy
		ojective_creamed_guys_passed ++
		ojective_creamed_guy1_done_before = 1
	ENDIF

	IF IS_CHAR_OBJECTIVE_PASSED creamed_guy2
	AND ojective_creamed_guy2_done_before = 0
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT creamed_guy2 icecreamx icecreamy
		ojective_creamed_guys_passed ++
		ojective_creamed_guy2_done_before = 1
	ENDIF

	IF IS_CHAR_OBJECTIVE_PASSED creamed_guy3
	AND ojective_creamed_guy3_done_before = 0
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT creamed_guy3 icecreamx icecreamy
		ojective_creamed_guys_passed ++
		ojective_creamed_guy3_done_before = 1
	ENDIF

	IF IS_CHAR_OBJECTIVE_PASSED creamed_guy4
	AND ojective_creamed_guy4_done_before = 0
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT creamed_guy4 icecreamx icecreamy
		ojective_creamed_guys_passed ++
		ojective_creamed_guy4_done_before = 1
	ENDIF

	IF NOT IS_CHAR_DEAD creamed_guy1
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D Player creamed_guy1 8.0 8.0 2.0 FALSE
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy1 Player
			SET_CHAR_THREAT_SEARCH creamed_guy1 THREAT_PLAYER1 
		ENDIF
	ENDIF

	IF NOT IS_CHAR_DEAD creamed_guy2
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D Player creamed_guy2 8.0 8.0 2.0 FALSE
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy2 Player
			SET_CHAR_THREAT_SEARCH creamed_guy2 THREAT_PLAYER1 
		ENDIF
	ENDIF
	   
	IF NOT IS_CHAR_DEAD creamed_guy3
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D Player creamed_guy3 8.0 8.0 2.0 FALSE
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy3 Player
			SET_CHAR_THREAT_SEARCH creamed_guy3 THREAT_PLAYER1 
		ENDIF
	ENDIF

	IF NOT IS_CHAR_DEAD creamed_guy4
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D Player creamed_guy4 8.0 8.0 2.0 FALSE
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy4 Player 
			SET_CHAR_THREAT_SEARCH creamed_guy4 THREAT_PLAYER1
		ENDIF
	ENDIF

	IF NOT IS_CHAR_DEAD creamed_guy1
		GET_CHAR_HEALTH creamed_guy1 creamed_guy1_health
	ENDIF
	IF NOT IS_CHAR_DEAD	creamed_guy2
		GET_CHAR_HEALTH creamed_guy2 creamed_guy2_health
	ENDIF
	IF NOT IS_CHAR_DEAD	creamed_guy3
		GET_CHAR_HEALTH creamed_guy3 creamed_guy3_health
	ENDIF
	IF NOT IS_CHAR_DEAD	creamed_guy4
		GET_CHAR_HEALTH creamed_guy4 creamed_guy4_health
	ENDIF

	IF creamed_guy1_health < 100
	OR creamed_guy2_health < 100
	OR creamed_guy3_health < 100
	OR creamed_guy4_health < 100
		
		IF creamers_spotted_you = 0

			IF NOT IS_CHAR_DEAD creamed_guy1
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy1 Player
				SET_CHAR_THREAT_SEARCH creamed_guy1 THREAT_PLAYER1
			ENDIF

			IF NOT IS_CHAR_DEAD creamed_guy2
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy2 Player
				SET_CHAR_THREAT_SEARCH creamed_guy2 THREAT_PLAYER1
			ENDIF

			IF NOT IS_CHAR_DEAD creamed_guy3
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy3 Player
				SET_CHAR_THREAT_SEARCH creamed_guy3 THREAT_PLAYER1
			ENDIF

			IF NOT IS_CHAR_DEAD creamed_guy4
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy4 Player
				SET_CHAR_THREAT_SEARCH creamed_guy4 THREAT_PLAYER1
			ENDIF
		
			creamers_spotted_you = 1
		ENDIF

	ENDIF

ENDWHILE


WHILE NOT IS_CHAR_DEAD creamed_guy1
OR NOT IS_CHAR_DEAD creamed_guy2
OR NOT IS_CHAR_DEAD creamed_guy3
OR NOT IS_CHAR_DEAD creamed_guy4
	WAIT 0
	
	IF IS_CAR_DEAD icecreamvan_any
	AND removed_ice_cream_blip = 0 
		REMOVE_BLIP blip1_icecream1
		removed_ice_cream_blip = 1		
	ENDIF

	IF NOT IS_CHAR_DEAD creamed_guy1
		GET_CHAR_HEALTH creamed_guy1 creamed_guy1_health
	ENDIF
	IF NOT IS_CHAR_DEAD	creamed_guy2
		GET_CHAR_HEALTH creamed_guy2 creamed_guy2_health
	ENDIF
	IF NOT IS_CHAR_DEAD	creamed_guy3
		GET_CHAR_HEALTH creamed_guy3 creamed_guy3_health
	ENDIF
	IF NOT IS_CHAR_DEAD	creamed_guy4
		GET_CHAR_HEALTH creamed_guy4 creamed_guy4_health
	ENDIF

	IF creamed_guy1_health < 100
	OR creamed_guy2_health < 100
	OR creamed_guy3_health < 100
	OR creamed_guy4_health < 100
		
		IF creamers_spotted_you = 0

			IF NOT IS_CHAR_DEAD creamed_guy1
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy1 Player
				SET_CHAR_THREAT_SEARCH creamed_guy1 THREAT_PLAYER1
			ENDIF

			IF NOT IS_CHAR_DEAD creamed_guy2
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy2 Player
				SET_CHAR_THREAT_SEARCH creamed_guy2 THREAT_PLAYER1
			ENDIF

			IF NOT IS_CHAR_DEAD creamed_guy3
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy3 Player
				SET_CHAR_THREAT_SEARCH creamed_guy3 THREAT_PLAYER1
			ENDIF

			IF NOT IS_CHAR_DEAD creamed_guy4
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy4 Player
				SET_CHAR_THREAT_SEARCH creamed_guy4 THREAT_PLAYER1
			ENDIF
		
			creamers_spotted_you = 1
		ENDIF

	ENDIF
			
	IF NOT IS_CHAR_DEAD creamed_guy1
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D Player creamed_guy1 8.0 8.0 2.0 FALSE
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy1 Player
			SET_CHAR_THREAT_SEARCH creamed_guy1 THREAT_PLAYER1 
		ENDIF
	ENDIF

	IF NOT IS_CHAR_DEAD creamed_guy2
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D Player creamed_guy2 8.0 8.0 2.0 FALSE
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy2 Player
			SET_CHAR_THREAT_SEARCH creamed_guy2 THREAT_PLAYER1 
		ENDIF
	ENDIF
	   
	IF NOT IS_CHAR_DEAD creamed_guy3
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D Player creamed_guy3 8.0 8.0 2.0 FALSE
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy3 Player
			SET_CHAR_THREAT_SEARCH creamed_guy3 THREAT_PLAYER1 
		ENDIF
	ENDIF

	IF NOT IS_CHAR_DEAD creamed_guy4
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_3D Player creamed_guy4 8.0 8.0 2.0 FALSE
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT creamed_guy4 Player 
			SET_CHAR_THREAT_SEARCH creamed_guy4 THREAT_PLAYER1
		ENDIF
	ENDIF

ENDWHILE

GOTO mission_diablo2_passed
}

 // Mission Diablo2 failed

mission_diablo2_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission Diablo2 passed

mission_diablo2_passed:

flag_diablo_mission2_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 6000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 8000
REGISTER_MISSION_PASSED	DIAB2
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT diablo_mission3_loop

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		


// mission cleanup

mission_cleanup_diablo2:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_diablo_mission = 0
REMOVE_BLIP blip1_icecream1
REMOVE_BLIP blip1_diablo2
REMOVE_BLIP blip2_diablo2
REMOVE_PICKUP briefcase_diablo2
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_MRWHOOPEE
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_LI_MAN1
SET_PLAYER_AMMO Player WEAPONTYPE_DETONATOR 0
MISSION_HAS_FINISHED
RETURN
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Deablo mission 3**************************************
// ***********************************BURN, BURN THEM ALL!!!!*********************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff			

GOSUB mission_start_diablo3

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_diablo3_failed
ENDIF

GOSUB mission_cleanup_diablo3

MISSION_END

// Variables for mission

//VAR_INT countdown_diablo3 // On screen countdown timer

//VAR_INT counter1_dm3

VAR_INT counter_diablo3 // Counts up number of mission triads killed

VAR_INT burn_man1 burn_man2 burn_man3 burn_man4 burn_man5 burn_man6 

VAR_INT dead_burn_man1 dead_burn_man2 dead_burn_man3 dead_burn_man4 dead_burn_man5 dead_burn_man6

VAR_INT blip1_diablo3 flamethrower_diablo3

VAR_INT all_gang_created_before	traid_threat_cleared_D3

VAR_INT CurrentStatus given_money_before

// ***************************************Mission Start*************************************

mission_start_diablo3:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_diablo_mission = 1
SCRIPT_NAME diablo3
WAIT 0


REQUEST_MODEL PED_GANG_TRIAD_A
REQUEST_MODEL PED_GANG_TRIAD_B

traid_threat_cleared_D3 = 0

{

SET_PED_DENSITY_MULTIPLIER 0.0
CLEAR_AREA_OF_CHARS 890.3 -309.1 0.0 1038.1 -132.9 10.0


LOAD_CUTSCENE EL_PH4
SET_CUTSCENE_OFFSET 938.27 -229.561 4.023
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player


DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( DIAB3_A ) 10000 1 

WHILE cs_time < 5553
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB3_B ) 10000 1 

WHILE cs_time < 7767
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB3_C ) 10000 1 

WHILE cs_time < 11105
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB3_D ) 10000 1 

WHILE cs_time < 14603
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB3_E ) 10000 1 

WHILE cs_time < 17813
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB3_F ) 10000 1 

WHILE cs_time < 22948
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB3_G ) 10000 1 

WHILE cs_time < 23775
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 26333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE



DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

WAIT 500

DO_FADE 1500 FADE_IN

SET_PED_DENSITY_MULTIPLIER 1.0
						  
SETUP_ZONE_PED_INFO CHINA DAY (30) 0 650 0 (0 0 0 0) 0  
SETUP_ZONE_PED_INFO CHINA NIGHT (30) 0 650 0 (0 0 0 0) 0      


// START MISSION

all_gang_created_before = 0
counter_diablo3 = 0
dead_burn_man1 = 0
dead_burn_man2 = 0
dead_burn_man3 = 0
dead_burn_man4 = 0
dead_burn_man5 = 0
dead_burn_man6 = 0
given_money_before = 0


IF IS_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1
	CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1
	traid_threat_cleared_D3 = 1
ENDIF

RESET_NUM_OF_MODELS_KILLED_BY_PLAYER

CREATE_PICKUP_WITH_AMMO WEAPON_FLAME PICKUP_ONCE 0 879.2 -810.0 -100.0 flamethrower_diablo3     
ADD_SPRITE_BLIP_FOR_COORD 879.2 -810.0 -100.0 RADAR_SPRITE_WEAPON blip1_diablo3
//CHANGE_BLIP_DISPLAY blip1_diablo3 BLIP_ONLY

WHILE NOT HAS_MODEL_LOADED PED_GANG_TRIAD_A
OR NOT HAS_MODEL_LOADED	PED_GANG_TRIAD_B
	WAIT 0

ENDWHILE

WHILE NOT HAS_PICKUP_BEEN_COLLECTED flamethrower_diablo3 
	WAIT 0

ENDWHILE

REMOVE_BLIP blip1_diablo3

START_KILL_FRENZY (DIAB3_1) WEAPONTYPE_FLAMETHROWER 151000 25 PED_GANG_TRIAD_A PED_GANG_TRIAD_B -1 -1 FALSE

Diablo3_loop:

WAIT 0

READ_KILL_FRENZY_STATUS CurrentStatus

	IF CurrentStatus = 2
		GOTO mission_diablo3_passed
	ENDIF

	IF CurrentStatus = 3
		GOTO mission_diablo3_failed
	ENDIF

	IF IS_PLAYER_IN_AREA_2D player 1038.0 -781.0 838.0 -915.0 FALSE

		IF all_gang_created_before = 0
			CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 932.0 -846.0 14.5 burn_man1
			GIVE_WEAPON_TO_CHAR burn_man1 WEAPONTYPE_PISTOL 60

			CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 933.0 -846.0 14.5 burn_man2
			GIVE_WEAPON_TO_CHAR burn_man2 WEAPONTYPE_PISTOL 60
			SET_CHAR_AS_LEADER burn_man2 burn_man1

			CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 934.0 -846.0 14.5 burn_man3
			GIVE_WEAPON_TO_CHAR burn_man3 WEAPONTYPE_PISTOL 60
			SET_CHAR_AS_LEADER burn_man3 burn_man1
			
			CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 935.0 -846.0 14.5 burn_man4
			GIVE_WEAPON_TO_CHAR burn_man4 WEAPONTYPE_PISTOL 60
			SET_CHAR_AS_LEADER burn_man4 burn_man1

			CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_A 936.0 -846.0 14.5 burn_man5
			GIVE_WEAPON_TO_CHAR burn_man5 WEAPONTYPE_PISTOL 60
			SET_CHAR_AS_LEADER burn_man5 burn_man1

			CREATE_CHAR PEDTYPE_GANG_TRIAD PED_GANG_TRIAD_B 937.0 -846.0 14.5 burn_man6
			GIVE_WEAPON_TO_CHAR burn_man6 WEAPONTYPE_PISTOL 60
			SET_CHAR_AS_LEADER burn_man6 burn_man1

			all_gang_created_before = 1
		ENDIF
		

		IF IS_CHAR_DEAD burn_man1 
		AND dead_burn_man1 = 0
			++ counter_diablo3
			dead_burn_man1 = 1	
		ENDIF

		IF IS_CHAR_DEAD burn_man2 
		AND dead_burn_man2 = 0
			++ counter_diablo3
			dead_burn_man2 = 1	
		ENDIF

		IF IS_CHAR_DEAD burn_man3 
		AND dead_burn_man3 = 0
			++ counter_diablo3
			dead_burn_man3 = 1	
		ENDIF

		IF IS_CHAR_DEAD burn_man4 
		AND dead_burn_man4 = 0
			++ counter_diablo3
			dead_burn_man4 = 1	
		ENDIF

		IF IS_CHAR_DEAD burn_man5 
		AND dead_burn_man5 = 0
			++ counter_diablo3
			dead_burn_man5 = 1	
		ENDIF

		IF IS_CHAR_DEAD burn_man6 
		AND dead_burn_man6 = 0
			++ counter_diablo3
			dead_burn_man6 = 1	
		ENDIF

		IF counter_diablo3 = 6
		AND given_money_before = 0
			ADD_SCORE player 6000
			GET_PLAYER_COORDINATES Player player_X player_Y player_Z
			ADD_ONE_OFF_SOUND player_X player_Y player_Z SOUND_PART_MISSION_COMPLETE
			given_money_before = 1
		ENDIF
		
		//IF IS_PLAYER_SHOOTING_IN_AREA Player 916.0 -863.0 956.0 -830.0 FALSE
		//OR IS_PLAYER_IN_AREA_2D player 916.0 -863.0 956.0 -830.0 FALSE

			IF dead_burn_man1 = 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT burn_man1 Player
			ENDIF
			IF dead_burn_man2 = 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT burn_man2 Player
			ENDIF
			IF dead_burn_man3 = 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT burn_man3 Player
			ENDIF
			IF dead_burn_man4 = 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT burn_man4 Player
			ENDIF
			IF dead_burn_man5 = 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT burn_man5 Player
			ENDIF
			IF dead_burn_man6 = 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT burn_man6 Player
			ENDIF			
		//ENDIF

	ENDIF

READ_KILL_FRENZY_STATUS CurrentStatus

GOTO Diablo3_loop


}
 // Mission toni1 failed

mission_diablo3_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission toni1 passed

mission_diablo3_passed:

flag_diablo_mission3_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 10000
REGISTER_MISSION_PASSED	DIAB3
PLAYER_MADE_PROGRESS 1
SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1
START_NEW_SCRIPT diablo_mission4_loop

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		


// mission cleanup

mission_cleanup_diablo3:

flag_player_on_mission = 0
flag_player_on_diablo_mission = 0
REMOVE_BLIP blip1_diablo3
REMOVE_PICKUP flamethrower_diablo3
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_TRIAD_B
    SETUP_ZONE_PED_INFO CHINA DAY   (20) 0 200 0 (0 0 0 0) 20 //China town 
    SETUP_ZONE_PED_INFO CHINA NIGHT (10) 0 300 0 (0 0 0 0) 10
IF traid_threat_cleared_D3 = 1
	SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1
ENDIF
MISSION_HAS_FINISHED
RETURN
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Deablo mission 4**************************************
// ***************************************Donkey Porn*****************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff			

GOSUB mission_start_diablo4

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_diablo4_failed
ENDIF

GOSUB mission_cleanup_diablo4

MISSION_END

// Variables for mission

VAR_INT counter_diablo4 // Counts up number of mission vans destroyed

VAR_INT porn_man porn_van blip1_porn_van blip2_porn_shop blip3_pornman

VAR_INT NumEaten_diablo4 NumEaten_diablo4_total eaten_all_the_porn

VAR_INT diablo_collect_porn_van	audio_loop_diablo4

VAR_INT flag_car_blip_displayed_dm4	found_perv_before

VAR_INT donkeymag1, donkeymag2, donkeymag3, pervert1, pervert2, pervert3, pervert4, pervert5, pervert6, pervert7, pervert8

//VAR_INT pac_man_record_on	//Create a new race

 
// ***************************************Mission Start*************************************

mission_start_diablo4:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_diablo_mission = 1
SCRIPT_NAME diablo4

audio_loop_diablo4 = 0
NumEaten_diablo4_total = 0 
found_perv_before = 0
eaten_all_the_porn = 0

WAIT 0


{

SET_PED_DENSITY_MULTIPLIER 0.0
CLEAR_AREA_OF_CHARS 890.3 -309.1 0.0 1038.1 -132.9 10.0

LOAD_CUTSCENE EL_PH3
SET_CUTSCENE_OFFSET 938.27 -229.561 4.023
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB4_A ) 10000 1 

WHILE cs_time < 7326
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB4_B ) 10000 1 

WHILE cs_time < 10740
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB4_C ) 10000 1 

WHILE cs_time < 12550
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB4_D ) 10000 1 

WHILE cs_time < 17195
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB4_E ) 10000 1 

WHILE cs_time < 22417
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB4_F ) 10000 1 

WHILE cs_time < 24124
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB4_G ) 10000 1 

WHILE cs_time < 28426
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB4_H ) 10000 1 

WHILE cs_time < 33574
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 34000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE


DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

WAIT 500

DO_FADE 1500 FADE_IN

SET_PED_DENSITY_MULTIPLIER 1.0


LOAD_MISSION_AUDIO EL3_A

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0

ENDWHILE


NumEaten_diablo4 = 0

	IF flag_asuka_mission1_passed = 1
		SET_GANG_WEAPONS GANG_MAFIA WEAPONTYPE_PISTOL WEAPONTYPE_UZI //The Mafia
	ENDIF

	REQUEST_MODEL CAR_RUMPO
	REQUEST_MODEL PED_MALE2
    LOAD_SPECIAL_CHARACTER 1 DONKY
						  
	WHILE NOT HAS_MODEL_LOADED CAR_RUMPO
	OR NOT HAS_MODEL_LOADED PED_MALE2
		WAIT 0
	ENDWHILE

	CLEAR_AREA 918.2 -269.7 5.0 5.0	TRUE
	CREATE_CAR CAR_RUMPO 918.2 -269.7 -100.0 diablo_collect_porn_van  
	ADD_BLIP_FOR_CAR diablo_collect_porn_van blip1_porn_van

	IF IS_CAR_DEAD diablo_collect_porn_van
		GOTO mission_diablo4_failed	
	ENDIF

//GOTO pervert_test //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

WHILE NOT IS_PLAYER_IN_CAR player diablo_collect_porn_van
	WAIT 0
	
	IF IS_CAR_DEAD diablo_collect_porn_van
		GOTO mission_diablo4_failed	
	ENDIF

ENDWHILE

START_PACMAN_RACE 0

SET_POLICE_IGNORE_PLAYER Player ON
SET_PLAYER_CONTROL Player OFF
SWITCH_WIDESCREEN ON


IF LOCATE_CAR_2D diablo_collect_porn_van 918.2 -269.7 10.0 10.0 FALSE
	SET_FIXED_CAMERA_POSITION 914.282 -157.729 6.409 0.0 0.0 0.0 
	POINT_CAMERA_AT_POINT 914.107 -156.829 6.012 INTERPOLATION
ELSE
	SET_FIXED_CAMERA_POSITION 914.282 -157.729 6.409 0.0 0.0 0.0 
	POINT_CAMERA_AT_POINT 914.107 -156.829 6.012 JUMP_CUT
ENDIF

WAIT 4000

SET_POLICE_IGNORE_PLAYER Player OFF
SET_PLAYER_CONTROL Player ON
SWITCH_WIDESCREEN OFF
RESTORE_CAMERA_JUMPCUT

	REMOVE_BLIP blip1_porn_van

	CREATE_CAR CAR_RUMPO 1577.1 -679.0 -100.0 porn_van
	SET_CAR_HEADING porn_van 309.0
	 
	CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_MALE2 1574.0 -681.1 -100.0 porn_man
	ADD_BLIP_FOR_CHAR porn_man blip3_pornman
	CHANGE_BLIP_DISPLAY blip3_pornman MARKER_ONLY

	counter_diablo4 = 46000
	DISPLAY_ONSCREEN_TIMER counter_diablo4


	IF IS_CAR_DEAD diablo_collect_porn_van
		GOTO mission_diablo4_failed	
	ENDIF

	flag_car_blip_displayed_dm4 = TRUE


WHILE NOT IS_CHAR_DEAD porn_man 
	WAIT 0	

	IF IS_CAR_DEAD diablo_collect_porn_van
		PRINT_NOW ( WRECKED ) 5000 1
		GOTO mission_diablo4_failed	
	ENDIF

	IF NOT IS_CHAR_DEAD	porn_man
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player porn_man 30.0 30.0 FALSE
		AND found_perv_before = 0
			CLEAR_ONSCREEN_TIMER counter_diablo4
			found_perv_before = 1
		ENDIF
	ENDIF

	IF counter_diablo4 = 0
		GOTO mission_diablo4_failed
	ENDIF

	GET_NUMBER_OF_POWER_PILLS_EATEN NumEaten_diablo4

	IF NumEaten_diablo4 > 0
	AND IS_PLAYER_IN_CAR player diablo_collect_porn_van
		counter_diablo4 = counter_diablo4 + 1300
		CLEAR_NUMBER_OF_POWER_PILLS_EATEN
		NumEaten_diablo4_total ++
	ENDIF

	IF NumEaten_diablo4_total > 0
	AND audio_loop_diablo4 = 0 
		PLAY_MISSION_AUDIO
		audio_loop_diablo4 = 1
	ENDIF

	IF IS_PLAYER_IN_CAR player diablo_collect_porn_van
		IF flag_car_blip_displayed_dm4 = TRUE
			REMOVE_BLIP blip1_porn_van
			CLEAR_THIS_PRINT  ( IN_VEH )
			flag_car_blip_displayed_dm4 = FALSE
		ENDIF
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player diablo_collect_porn_van
		IF flag_car_blip_displayed_dm4 = FALSE
			ADD_BLIP_FOR_CAR diablo_collect_porn_van blip1_porn_van
			PRINT_NOW ( IN_VEH ) 5000 1 //"Get back in the car!"
			flag_car_blip_displayed_dm4 = TRUE
		ENDIF
	ENDIF

	IF NumEaten_diablo4_total = 106
	AND eaten_all_the_porn = 0
		ADD_SCORE player 10000
		GET_PLAYER_COORDINATES Player player_X player_Y player_Z
		ADD_ONE_OFF_SOUND player_X player_Y player_Z SOUND_PART_MISSION_COMPLETE
		eaten_all_the_porn = 1			
	ENDIF

ENDWHILE

	REMOVE_BLIP blip3_pornman
	REMOVE_BLIP blip1_porn_van
	ADD_BLIP_FOR_COORD 973.9 -428.3 -100.0 blip2_porn_shop
	REMOVE_BLIP blip2_porn_shop

	CLEAR_ONSCREEN_TIMER counter_diablo4
	CLEAR_PACMAN

	PRINT_NOW ( DIAB4_1 ) 5000 1 // Mission brief

	IF IS_CAR_DEAD diablo_collect_porn_van 
		GOTO mission_diablo4_failed	
	ENDIF

	IF IS_PLAYER_IN_CAR	player diablo_collect_porn_van
		flag_car_blip_displayed_dm4 = TRUE
	ELSE
	    flag_car_blip_displayed_dm4 = FALSE
	ENDIF
 

WHILE NOT IS_CAR_STOPPED_IN_AREA_3D diablo_collect_porn_van 976.5 -422.8 14.5 970.8 -433.4 16.9 TRUE
	WAIT 0

		IF IS_CAR_DEAD diablo_collect_porn_van
			PRINT_NOW ( WRECKED ) 5000 1 
			GOTO mission_diablo4_failed
		ENDIF

		IF IS_PLAYER_IN_CAR player diablo_collect_porn_van
			IF flag_car_blip_displayed_dm4 = TRUE
				ADD_BLIP_FOR_COORD 973.9 -428.3 -100.0 blip2_porn_shop
				REMOVE_BLIP blip1_porn_van
				CLEAR_THIS_PRINT  ( IN_VEH ) 
			flag_car_blip_displayed_dm4 = FALSE
			ENDIF
		ENDIF

		IF NOT IS_PLAYER_IN_CAR player diablo_collect_porn_van
			IF flag_car_blip_displayed_dm4 = FALSE
				ADD_BLIP_FOR_CAR diablo_collect_porn_van blip1_porn_van
				REMOVE_BLIP blip2_porn_shop
				PRINT_SOON ( IN_VEH ) 5000 1 //"Get back in the car!"
				flag_car_blip_displayed_dm4 = TRUE
			ENDIF
		ENDIF

ENDWHILE

//PERVERTS CUT SCENE*********************************************************************

//pervert_test:

	SET_POLICE_IGNORE_PLAYER Player On
	SET_PLAYER_CONTROL Player Off
	SWITCH_WIDESCREEN ON
	SET_PED_DENSITY_MULTIPLIER 0.0

	WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1  
		WAIT 0

	ENDWHILE

WAIT 1000

SET_MUSIC_DOES_FADE FALSE
SET_FADING_COLOUR 0 0 0
DO_FADE 1000 FADE_OUT

WAIT 1000

CLEAR_AREA 988.9 -444.7 14.9 10.0 TRUE

CREATE_CHAR PEDTYPE_CIVMALE PED_SPECIAL1 988.7 -444.5 14.1 pervert1
SET_CHAR_HEADING pervert1 180.0
 
CREATE_CHAR PEDTYPE_CIVMALE PED_SPECIAL1 987.7 -444.3 13.9 pervert2
SET_CHAR_HEADING pervert2 140.0

CREATE_CHAR PEDTYPE_CIVMALE PED_SPECIAL1 986.9 -444.9 13.9 pervert3
SET_CHAR_HEADING pervert3 140.0

CREATE_CHAR PEDTYPE_CIVMALE PED_MALE2 990.4 -441.9 14.1 pervert4
SET_CHAR_HEADING pervert4 83.0

CREATE_CHAR PEDTYPE_CIVMALE PED_MALE2 991.1 -440.7 13.9 pervert5
SET_CHAR_HEADING pervert5 128.0

CREATE_CHAR PEDTYPE_CIVMALE PED_MALE2 992.1 -439.1 13.9 pervert6
SET_CHAR_HEADING pervert6 141.0

CREATE_CHAR PEDTYPE_CIVMALE PED_MALE2 992.0 -437.7 13.9 pervert7
SET_CHAR_HEADING pervert7 180.0

CREATE_CHAR PEDTYPE_CIVMALE PED_MALE2 992.1 -436.1 13.9 pervert8
SET_CHAR_HEADING pervert8 180.0

SET_FIXED_CAMERA_POSITION 982.705 -448.508 16.014 0.0 0.0 0.0 
POINT_CAMERA_AT_POINT 982.707 -447.632 16.496 JUMP_CUT

SET_CHAR_WAIT_STATE pervert1 WAITSTATE_CROSS_ROAD_LOOK 10000
SET_CHAR_WAIT_STATE pervert3 WAITSTATE_CROSS_ROAD_LOOK 10000
SET_CHAR_WAIT_STATE pervert2 WAITSTATE_CROSS_ROAD_LOOK 10000

SET_CHAR_AS_LEADER pervert1 pervert3
SET_CHAR_AS_LEADER pervert2 pervert3

DO_FADE 1000 FADE_IN

WAIT 2000

SET_FIXED_CAMERA_POSITION 986.596 -448.508 16.014 0.0 0.0 0.0 
POINT_CAMERA_AT_POINT 986.514 -447.632 16.496 INTERPOLATION

WAIT 3000

IF NOT IS_CHAR_DEAD pervert3
	SET_FIXED_CAMERA_POSITION 988.078 -445.869 16.3 0.0 0.0 0.0 
	POINT_CAMERA_AT_CHAR pervert3 FIXED INTERPOLATION
ENDIF

WAIT 3000

CLEAR_AREA 978.9 -444.4 14.9 3.0 TRUE

IF NOT IS_CHAR_DEAD	pervert3
	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT pervert3 935.6 -445.8
ENDIF

WAIT 4000

SET_PED_DENSITY_MULTIPLIER 1.0

SET_FIXED_CAMERA_POSITION 994.524 -451.391 18.02 0.0 0.0 0.0 
POINT_CAMERA_AT_POINT 994.048 -450.563 17.724 INTERPOLATION

WAIT 6000

IF NOT IS_CHAR_DEAD	pervert3
	CHAR_WANDER_DIR pervert3 90
ENDIF

IF NOT IS_CHAR_DEAD	pervert2
	CHAR_WANDER_DIR pervert2 90
ENDIF

IF NOT IS_CHAR_DEAD	pervert1
	CHAR_WANDER_DIR pervert1 90		   
ENDIF


//PERVERTS CUT SCENE END******************************************************************

IF NOT IS_CAR_DEAD diablo_collect_porn_van
	IF IS_PLAYER_IN_CAR player diablo_collect_porn_van
		CLEAR_AREA 978.3 -442.7 13.9 1.0 TRUE
		WARP_PLAYER_FROM_CAR_TO_COORD player 978.3 -442.7 13.9
		SET_PLAYER_HEADING Player 180.0
	ELSE
		CLEAR_AREA 978.3 -442.7 13.9 1.0 TRUE
	   	SET_PLAYER_COORDINATES Player 978.3 -442.7 13.9
	   	SET_PLAYER_HEADING Player 180.0
	ENDIF
ENDIF


GOTO mission_diablo4_passed

}

 // Mission toni1 failed

mission_diablo4_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN
 

// mission toni1 passed

mission_diablo4_passed:

flag_diablo_mission4_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 20000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 20000
CREATE_OBJECT donkeymag 895.2 -308.2 7.4 donkeymag1
DONT_REMOVE_OBJECT donkeymag1
CREATE_OBJECT donkeymag 896.1 -308.6 7.4 donkeymag2
DONT_REMOVE_OBJECT donkeymag2
CREATE_OBJECT donkeymag	890.1 -309.6 7.4 donkeymag3
DONT_REMOVE_OBJECT donkeymag3
SET_OBJECT_HEADING donkeymag1 260.0
SET_OBJECT_HEADING donkeymag2 280.0
SET_OBJECT_HEADING donkeymag3 190.0
flag_diablo_mission1_passed = 0
REMOVE_BLIP diablo_contact_blip
START_NEW_SCRIPT diablo_mission1_loop
REGISTER_MISSION_PASSED DIAB4
PLAYER_MADE_PROGRESS 1

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		


// mission cleanup

mission_cleanup_diablo4:

flag_player_on_mission = 0
flag_player_on_diablo_mission = 0
REMOVE_BLIP blip1_porn_van
REMOVE_BLIP blip2_porn_shop
REMOVE_BLIP blip3_pornman
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_MALE2
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_RUMPO
CLEAR_ONSCREEN_TIMER counter_diablo4
CLEAR_PACMAN
SET_MUSIC_DOES_FADE TRUE
UNLOAD_SPECIAL_CHARACTER 1
	IF flag_asuka_mission1_passed = 1
		SET_GANG_WEAPONS GANG_MAFIA WEAPONTYPE_PISTOL WEAPONTYPE_SHOTGUN //The Mafia
	ENDIF
MISSION_HAS_FINISHED
RETURN
MISSION_START
// *****************************************************************************************
// *******************************   Asuka mission 1   ************************************* 
// ******************* Salvatore's Sendoff / Sayonara Salvatore ****************************
// *****************************************************************************************
// *** Salvatore will be leaving Luigi's Club in 3 hours. The player will have to kill 	 ***
// *** him before he arrives at his mansion. He will come out of the club with a very 	 ***
// *** large Mafia escort. (3 cars full and 5 extra goons) If the player is spotted 	 ***
// *** before Salvatore leaves the club, they will attack. 								 ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_asuka1

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_asuka1_failed
ENDIF

GOSUB mission_cleanup_asuka1 

MISSION_END

// Variables for mission

VAR_INT hours_a1 mins_a1 time_left_a1 beamer1_a1 beamer2_a1	beamer3_a1 mission_blip_am1
VAR_INT mafia_1X mafia_2X mafia_3X mafia_4X mafia_5X mafia_6X mafia_7X mafia_8X mafia_9X mafia_10X mafia_11X mafia_12X mafia_13X mafia_14X mafia_15X 
VAR_INT mafia_8_flag mafia_9_flag mafia_10_flag mafia_11_flag mafia_12_flag mafia_13_flag frankie_flag
VAR_INT set_beamer_1_kill_player set_beamer_2_kill_player set_beamer_3_kill_player 
VAR_INT beamer1_health beamer2_health beamer3_health garage_door_close timera_reset_flag_a1	timerb_reset_flag_a1 timerc_reset_flag_a1 
VAR_INT timerc_started_a1 timerc_current_a1 timerc_a1 frankies_ride	fuckers_car	beamer_1_dead_flag beamer_2_dead_flag beamer_3_dead_flag
VAR_INT players_car_a1 kill_player_now_flag	spotted_print enter_car_flag frankie_exists_flag 
VAR_INT mafia_8_kill_player_flag mafia_9_kill_player_flag mafia_10_kill_player_flag mafia_11_kill_player_flag mafia_12_kill_player_flag mafia_13_kill_player_flag
VAR_INT mafia_5_kill_player_flag mafia_7_kill_player_flag mafia_15_kill_player_flag	
VAR_INT	timerx timerx_started timerx_current timerx_reset_flag
VAR_INT	timery timery_started timery_current timery_reset_flag
VAR_INT	timerz timerz_started timerz_current timerz_reset_flag

VAR_FLOAT players_car_a1_speed	beamer1_a1_speed beamer2_a1_speed beamer3_a1_speed
VAR_FLOAT create_char_in_club_x create_char_in_club_y create_char_in_club_z bottom_of_steps_x bottom_of_steps_y mafia_10_x mafia_10_y	
VAR_FLOAT mafia_11_x mafia_11_y mafia_12_x mafia_12_y mafia_13_x mafia_13_y working_x_a1 working_y_a1 working_z_a1 beamer_heading
VAR_FLOAT street_x street_y	back_of_alley_x	back_of_alley_y	a1_x a1_y a1_z diff_heading_door
VAR_FLOAT beamer1_stuck_x beamer1_stuck_y beamer1_stuck_z beamer2_stuck_x beamer2_stuck_y beamer2_stuck_z beamer3_stuck_x beamer3_stuck_y beamer3_stuck_z

// ****************************************Mission Start************************************

mission_start_asuka1:

flag_player_on_mission 		 = 1
flag_player_on_asuka_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

SCRIPT_NAME asuka1

hours_a1 	  = 0
mins_a1  	  = 0
time_left_a1  = 0
mafia_8_flag  = 0
mafia_9_flag  = 0
mafia_10_flag = 0
mafia_11_flag = 0
mafia_12_flag = 0
mafia_13_flag = 0
frankie_flag  = 0
set_beamer_1_kill_player = 0
set_beamer_2_kill_player = 0
set_beamer_3_kill_player = 0
beamer1_health 		 = 0
beamer2_health  	 = 0
beamer3_health  	 = 0
garage_door_close 	 = 0
timera_reset_flag_a1 = 0
timerb_reset_flag_a1 = 0
timerc_reset_flag_a1 = 0
timerc_started_a1	 = 0
timerc_current_a1    = 0
timerc_a1			 = 0
door_crash_flag		 = 0
spotted_print		 = 0
frankies_ride 		 = 0
beamer_1_dead_flag   = 0
beamer_2_dead_flag   = 0
beamer_3_dead_flag   = 0
enter_car_flag       = 0
fuckers_car          = -1
frankie_exists_flag  = 0
mafia_5_kill_player_flag  = 0
mafia_7_kill_player_flag  = 0
mafia_8_kill_player_flag  = 0
mafia_9_kill_player_flag  = 0
mafia_10_kill_player_flag = 0
mafia_11_kill_player_flag = 0
mafia_12_kill_player_flag = 0
mafia_13_kill_player_flag = 0
mafia_15_kill_player_flag = 0
timerx_reset_flag = 0
timery_reset_flag = 0
timerz_reset_flag = 0

beamer1_stuck_x = 0.0
beamer1_stuck_y = 0.0
beamer1_stuck_z = 0.0
beamer2_stuck_x = 0.0
beamer2_stuck_y = 0.0
beamer2_stuck_z = 0.0
beamer3_stuck_x = 0.0
beamer3_stuck_y = 0.0
beamer3_stuck_z = 0.0
{
// ****************************************START OF CUTSCENE********************************

/*
SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_asuka1_failed
ENDIF

SWITCH_STREAMING OFF

PRINT_BIG AM1 15000 2
*/

LOAD_SPECIAL_CHARACTER 1 asuka
LOAD_SPECIAL_CHARACTER 2 maria
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 ASUKAH
LOAD_SPECIAL_MODEL cut_obj3 MARIAH
REQUEST_MODEL condo_ivy
REQUEST_MODEL kmricndo01

/*
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
*/

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj1
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED condo_ivy
OR NOT HAS_MODEL_LOADED	kmricndo01
	WAIT 0
ENDWHILE

LOAD_CUTSCENE A1_SS0

SET_CUTSCENE_OFFSET 523.102 -636.96 15.616

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_asuka
SET_CUTSCENE_ANIM cs_asuka asuka

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_maria
SET_CUTSCENE_ANIM cs_maria maria

CREATE_CUTSCENE_HEAD cs_player cut_obj1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_asuka cut_obj2 cs_asukahead
SET_CUTSCENE_HEAD_ANIM cs_asukahead asuka

CREATE_CUTSCENE_HEAD cs_maria cut_obj3 cs_mariahead
SET_CUTSCENE_HEAD_ANIM cs_mariahead maria

CLEAR_AREA 523.6 -639.4 16.6 1.0 TRUE
SET_PLAYER_COORDINATES player 523.6 -639.4 16.0

SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

START_CUTSCENE

SWITCH_RUBBISH OFF
//SWITCH_STREAMING OFF
// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 5353
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW AM1_A 15000 1

WHILE cs_time < 9624
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW AM1_B 15000 1

WHILE cs_time < 13409
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW AM1_C 15000 1

WHILE cs_time < 17788
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW AM1_D 15000 1

WHILE cs_time < 20113
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW AM1_E 15000 1

WHILE cs_time < 25303
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

GET_TIME_OF_DAY hours_a1 mins_a1

hours_a1 = hours_a1 + 3 // 3 HOURS UNTIL FRANKIE LEAVES THE CLUB
IF hours_a1 > 23
	hours_a1 = hours_a1 - 24
ENDIF

mins_a1 = 30

IF hours_a1 > 9
	PRINT_WITH_2_NUMBERS_NOW AM1_F hours_a1 mins_a1 15000 1// "Salvatore Leon will be leaving Luigi's at about ~1~:~1~."
ELSE
	PRINT_WITH_2_NUMBERS_NOW AM1_K hours_a1 mins_a1 15000 1// "Salvatore Leon will be leaving Luigi's at about 0~1~:~1~."
ENDIF

WHILE cs_time < 29629
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW AM1_G 15000 1

WHILE cs_time < 32657
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW AM1_H 15000 1

WHILE cs_time < 37360
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW AM1_I 15000 1

WHILE cs_time < 40118
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW AM1_J 15000 1

WHILE cs_time < 41666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

SWITCH_STREAMING ON
SWITCH_RUBBISH ON

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

DO_FADE 0 FADE_OUT

SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
MARK_MODEL_AS_NO_LONGER_NEEDED condo_ivy
MARK_MODEL_AS_NO_LONGER_NEEDED kmricndo01
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj3

// ******************************************END OF CUTSCENE********************************

LOAD_SPECIAL_CHARACTER 1 frankie
REQUEST_MODEL PED_GANG_MAFIA_A
REQUEST_MODEL PED_GANG_MAFIA_B
REQUEST_MODEL CAR_MAFIA

WHILE NOT HAS_MODEL_LOADED CAR_MAFIA
OR NOT HAS_MODEL_LOADED PED_GANG_MAFIA_A
OR NOT HAS_MODEL_LOADED PED_GANG_MAFIA_B
OR NOT HAS_SPECIAL_CHARACTER_LOADED 1
	WAIT 0
ENDWHILE

create_char_in_club_x =	894.0//894.3
create_char_in_club_y =	-417.0//-415.78
create_char_in_club_z =	15.3

ADD_BLIP_FOR_COORD create_char_in_club_x create_char_in_club_y create_char_in_club_z mission_blip_am1

// R* wants this to be off completely
DISPLAY_RADAR 2 // PATHING OFF
//DISPLAY_RADAR 4 // Radar stop at road

bottom_of_steps_x =	885.53
bottom_of_steps_y =	-417.0

back_of_alley_x = 886.03
back_of_alley_y = -425.77

street_x = 902.72
street_y = -425.65

mafia_10_x = 902.72  - 1.0
mafia_10_y = -425.65 + 3.0

mafia_11_x = 902.72  + 1.0
mafia_11_y = -425.65 + 3.0

mafia_12_x = 902.72  + 1.0
mafia_12_y = -425.65 - 2.0

mafia_13_x = 902.72  - 1.0
mafia_13_y = -425.65 - 2.0

mafia_8_flag  =	0
mafia_9_flag  =	0
mafia_10_flag =	0
mafia_11_flag =	0
mafia_12_flag =	0
mafia_13_flag =	0
kill_player_now_flag = 0

PRINT_NOW AM1_5 5000 1//"Get to the Red Light District and wait for Salvatore to leave the club."
IF hours_a1 > 9
	PRINT_WITH_2_NUMBERS_SOON AM1_8 hours_a1 mins_a1 5000 1//"Salvatore will be leaving at about ~1~:~1~"
ELSE
	PRINT_WITH_2_NUMBERS_SOON AM1_10 hours_a1 mins_a1 5000 1//"Salvatore will be leaving at about 0~1~:~1~"
ENDIF

//IF ammu2_blip_added = 0
//	ADD_SPRITE_BLIP_FOR_COORD 345.5 -713.5 26.1 RADAR_SPRITE_WEAPON ammu_nation2
//	ADD_SPRITE_BLIP_FOR_COORD 379.0 -493.8 25.2 RADAR_SPRITE_SPRAY sprayshop2_blip
//	ammu2_blip_added = 1
//ENDIF

GET_MINUTES_TO_TIME_OF_DAY hours_a1 mins_a1 time_left_a1

WHILE NOT time_left_a1 < 1
	
	WAIT 0

	GET_MINUTES_TO_TIME_OF_DAY hours_a1 mins_a1 time_left_a1

	IF garage_door_close = 0
		IF IS_PLAYER_IN_ZONE player REDLIGH
			PRINT_NOW AM1_6 5000 1//"Don't hang around Luigi's club, or the Mafia will spot you"
			//REMOVE_BLIP mission_blip_am1
			//DISPLAY_RADAR 2 // PATHING OFF
			garage_door_close = 1
		ENDIF
	ENDIF
	
ENDWHILE

IF garage_door_close = 0
	IF IS_PLAYER_IN_ZONE player REDLIGH
		PRINT_NOW AM1_6 5000 1//"Don't hang around Luigi's club, or the Mafia will spot you"
		//REMOVE_BLIP mission_blip_am1
		//DISPLAY_RADAR 2 // PATHING OFF
		garage_door_close = 1
	ENDIF
ENDIF
GET_MINUTES_TO_TIME_OF_DAY hours_a1 mins_a1 time_left_a1

WHILE NOT IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
	WAIT 0
	
	GET_MINUTES_TO_TIME_OF_DAY hours_a1 mins_a1 time_left_a1

	IF time_left_a1 < 1
		PRINT_NOW AM1_3 5000 1 //"You've missed Salvatore!"
		GOTO mission_asuka1_failed
	ENDIF

ENDWHILE

SWITCH_ROADS_OFF 905.0 -448.6 12.0 916.0 -393.0 20.0
CHANGE_GARAGE_TYPE frankie_garage GARAGE_MISSION

IF NOT LOCATE_PLAYER_ANY_MEANS_2D player 908.3 -86.0 100.0 100.0 0
	working_x_a1 = 908.3 
	working_y_a1 = -86.0
	working_z_a1 = 7.0
	CREATE_CAR CAR_MAFIA working_x_a1 working_y_a1 working_z_a1 beamer1_a1
	GET_CAR_HEADING	beamer1_a1 beamer_heading
	beamer_heading = beamer_heading - 180.0
	SET_CAR_HEADING beamer1_a1	beamer_heading
	LOCK_CAR_DOORS beamer1_a1 CARLOCK_LOCKOUT_PLAYER_ONLY
	SET_CAR_ONLY_DAMAGED_BY_PLAYER beamer1_a1 TRUE
	SET_UPSIDEDOWN_CAR_NOT_DAMAGED beamer1_a1 TRUE
	
	working_y_a1 = working_y_a1 + 11.0
	CREATE_CAR CAR_MAFIA working_x_a1 working_y_a1 working_z_a1 beamer2_a1
	SET_CAR_HEADING beamer2_a1	beamer_heading
	LOCK_CAR_DOORS beamer2_a1 CARLOCK_LOCKOUT_PLAYER_ONLY
	SET_CAR_ONLY_DAMAGED_BY_PLAYER beamer2_a1 TRUE
	SET_UPSIDEDOWN_CAR_NOT_DAMAGED beamer2_a1 TRUE

	working_y_a1 = working_y_a1 + 11.0
	CREATE_CAR CAR_MAFIA working_x_a1 working_y_a1 working_z_a1 beamer3_a1
	SET_CAR_HEADING beamer3_a1	beamer_heading
	LOCK_CAR_DOORS beamer3_a1 CARLOCK_LOCKOUT_PLAYER_ONLY
	SET_CAR_ONLY_DAMAGED_BY_PLAYER beamer3_a1 TRUE
	SET_UPSIDEDOWN_CAR_NOT_DAMAGED beamer3_a1 TRUE
		
ELSE
	working_x_a1 = 1123.67
	working_y_a1 = -59.3
	working_z_a1 = 7.0
	CREATE_CAR CAR_MAFIA working_x_a1 working_y_a1 working_z_a1 beamer3_a1
	GET_CAR_HEADING	beamer3_a1 beamer_heading
	beamer_heading = beamer_heading - 180.0
	SET_CAR_HEADING beamer3_a1	beamer_heading
	LOCK_CAR_DOORS beamer3_a1 CARLOCK_LOCKOUT_PLAYER_ONLY
	SET_CAR_ONLY_DAMAGED_BY_PLAYER beamer3_a1 TRUE
	SET_UPSIDEDOWN_CAR_NOT_DAMAGED beamer3_a1 TRUE

	working_y_a1 = working_y_a1 - 11.0
	CREATE_CAR CAR_MAFIA working_x_a1 working_y_a1 working_z_a1 beamer2_a1
	SET_CAR_HEADING beamer2_a1	beamer_heading
	LOCK_CAR_DOORS beamer2_a1 CARLOCK_LOCKOUT_PLAYER_ONLY
	SET_CAR_ONLY_DAMAGED_BY_PLAYER beamer2_a1 TRUE
	SET_UPSIDEDOWN_CAR_NOT_DAMAGED beamer2_a1 TRUE

	working_y_a1 = working_y_a1 - 11.0
	CREATE_CAR CAR_MAFIA working_x_a1 working_y_a1 working_z_a1 beamer1_a1
	SET_CAR_HEADING beamer1_a1	beamer_heading
	LOCK_CAR_DOORS beamer1_a1 CARLOCK_LOCKOUT_PLAYER_ONLY
	SET_CAR_ONLY_DAMAGED_BY_PLAYER beamer1_a1 TRUE
	SET_UPSIDEDOWN_CAR_NOT_DAMAGED beamer1_a1 TRUE
ENDIF

CREATE_CHAR_INSIDE_CAR beamer1_a1 PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_B mafia_1X
CREATE_CHAR_INSIDE_CAR beamer2_a1 PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A mafia_2X
CREATE_CHAR_INSIDE_CAR beamer3_a1 PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A mafia_3X
CREATE_CHAR_AS_PASSENGER beamer3_a1 PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A 0 mafia_4X
CREATE_CHAR_AS_PASSENGER beamer3_a1 PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_B 1 mafia_5X
CREATE_CHAR_AS_PASSENGER beamer1_a1 PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_B 0 mafia_6X
CREATE_CHAR_AS_PASSENGER beamer1_a1 PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A 1 mafia_7X
CREATE_CHAR_AS_PASSENGER beamer2_a1 PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_B 0 mafia_14X
SET_CHAR_THREAT_SEARCH mafia_1X THREAT_PLAYER1
SET_CHAR_THREAT_SEARCH mafia_2X THREAT_PLAYER1
SET_CHAR_THREAT_SEARCH mafia_3X THREAT_PLAYER1
SET_CHAR_THREAT_SEARCH mafia_4X THREAT_PLAYER1
SET_CHAR_THREAT_SEARCH mafia_5X THREAT_PLAYER1
SET_CHAR_THREAT_SEARCH mafia_6X THREAT_PLAYER1
SET_CHAR_THREAT_SEARCH mafia_7X THREAT_PLAYER1
SET_CHAR_THREAT_SEARCH mafia_14X THREAT_PLAYER1
SET_CHAR_PERSONALITY mafia_1X PEDSTAT_TOUGH_GUY
SET_CHAR_PERSONALITY mafia_2X PEDSTAT_TOUGH_GUY
SET_CHAR_PERSONALITY mafia_3X PEDSTAT_TOUGH_GUY
SET_CHAR_PERSONALITY mafia_4X PEDSTAT_TOUGH_GUY
SET_CHAR_PERSONALITY mafia_5X PEDSTAT_TOUGH_GUY
SET_CHAR_PERSONALITY mafia_6X PEDSTAT_TOUGH_GUY
SET_CHAR_PERSONALITY mafia_7X PEDSTAT_TOUGH_GUY
SET_CHAR_PERSONALITY mafia_14X PEDSTAT_TOUGH_GUY
GIVE_WEAPON_TO_CHAR mafia_1X WEAPONTYPE_UZI 999
GIVE_WEAPON_TO_CHAR mafia_2X WEAPONTYPE_UZI 999
GIVE_WEAPON_TO_CHAR mafia_3X WEAPONTYPE_UZI 999
GIVE_WEAPON_TO_CHAR mafia_4X WEAPONTYPE_UZI 999
GIVE_WEAPON_TO_CHAR mafia_5X WEAPONTYPE_UZI 999
GIVE_WEAPON_TO_CHAR mafia_6X WEAPONTYPE_UZI 999
GIVE_WEAPON_TO_CHAR mafia_7X WEAPONTYPE_UZI 999
GIVE_WEAPON_TO_CHAR mafia_14X WEAPONTYPE_UZI 999

working_x_a1 = 908.0 
working_y_a1 = -435.5
working_z_a1 = 14.56
CAR_GOTO_COORDINATES beamer1_a1 working_x_a1 working_y_a1 working_z_a1

working_y_a1 = working_y_a1 + 7.0
CAR_GOTO_COORDINATES beamer2_a1 working_x_a1 working_y_a1 working_z_a1

working_y_a1 = working_y_a1 + 7.0
CAR_GOTO_COORDINATES beamer3_a1 working_x_a1 working_y_a1 working_z_a1

SET_CAR_DRIVING_STYLE beamer1_a1 2
SET_CAR_DRIVING_STYLE beamer2_a1 2
SET_CAR_DRIVING_STYLE beamer3_a1 2
SET_CAR_CRUISE_SPEED beamer1_a1 15.0
SET_CAR_CRUISE_SPEED beamer2_a1 14.0
SET_CAR_CRUISE_SPEED beamer3_a1 13.0

IF DOES_OBJECT_EXIST backdoor
	GET_OBJECT_HEADING backdoor door_position_a1
ENDIF

LOAD_MISSION_AUDIO A1_A
 
IF NOT IS_PLAYER_IN_AREA_2D player 873.0 -443.0 927.0 -378.0 0
	SET_PLAYER_CONTROL player OFF
	SET_EVERYONE_IGNORE_PLAYER player ON
	SET_ALL_CARS_CAN_BE_DAMAGED FALSE
	IF IS_PLAYER_IN_ANY_CAR player
		APPLY_BRAKES_TO_PLAYERS_CAR player ON
	ENDIF
	SET_FADING_COLOUR 0 0 0
	DO_FADE 0 FADE_OUT
	WAIT 0
//	DO_FADE 250 FADE_OUT
//	WHILE GET_FADING_STATUS
//		WAIT 0
//	ENDWHILE
	SWITCH_WIDESCREEN ON
	CLEAR_AREA 905.759 -419.944 8.0 8.0 FALSE
	REQUEST_MODEL indhibuild3
	REQUEST_MODEL luigiclubout
	REQUEST_MODEL luigiineerclub
	REQUEST_MODEL ind_customroad016
	LOAD_ALL_MODELS_NOW
	SWITCH_STREAMING OFF
	SET_FIXED_CAMERA_POSITION 881.36 -425.198 19.727 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT 882.109 -424.825 19.181 JUMP_CUT
	TIMERB = 0
	beamer1_health = 1
ENDIF

TIMERA = 0
skip_flag = 0
REMOVE_BLIP mission_blip_am1 // NOW we can remove the blip (to lessen confusion)
//DISPLAY_RADAR 3 // PATHING ON

WHILE mafia_8_flag < 3
OR mafia_9_flag < 3 
OR mafia_10_flag < 3
OR mafia_11_flag < 3
OR mafia_12_flag < 3
OR mafia_13_flag < 3

	WAIT 0

	IF beamer1_health = 1
		IF TIMERB > 30000
			SWITCH_WIDESCREEN OFF
			SET_PLAYER_CONTROL player ON
			SET_EVERYONE_IGNORE_PLAYER player OFF
			SET_ALL_CARS_CAN_BE_DAMAGED TRUE
			SWITCH_STREAMING ON
			IF IS_PLAYER_IN_ANY_CAR player
				APPLY_BRAKES_TO_PLAYERS_CAR player OFF
			ENDIF
			RESTORE_CAMERA_JUMPCUT
			MARK_MODEL_AS_NO_LONGER_NEEDED indhibuild3
			MARK_MODEL_AS_NO_LONGER_NEEDED luigiclubout
			MARK_MODEL_AS_NO_LONGER_NEEDED luigiineerclub
			MARK_MODEL_AS_NO_LONGER_NEEDED ind_customroad016
			DO_FADE 250 FADE_IN
			skip_flag = 2
			beamer1_health = 0
		ENDIF

		IF skip_flag = 0
			IF NOT IS_BUTTON_PRESSED PAD1 CROSS
			AND NOT IS_BUTTON_PRESSED PAD1 START
				skip_flag = 1
			ENDIF
		ENDIF

		IF skip_flag = 1
			IF IS_BUTTON_PRESSED PAD1 CROSS
			OR IS_BUTTON_PRESSED PAD1 START
				SWITCH_WIDESCREEN OFF
				SET_PLAYER_CONTROL player ON
				SET_EVERYONE_IGNORE_PLAYER player OFF
				SET_ALL_CARS_CAN_BE_DAMAGED TRUE
				SWITCH_STREAMING ON
				IF IS_PLAYER_IN_ANY_CAR player
					APPLY_BRAKES_TO_PLAYERS_CAR player OFF
				ENDIF
				RESTORE_CAMERA_JUMPCUT
				MARK_MODEL_AS_NO_LONGER_NEEDED indhibuild3
				MARK_MODEL_AS_NO_LONGER_NEEDED luigiclubout
				MARK_MODEL_AS_NO_LONGER_NEEDED luigiineerclub
				MARK_MODEL_AS_NO_LONGER_NEEDED ind_customroad016
				DO_FADE 250 FADE_IN
				beamer1_health = 0
			ENDIF
		ENDIF
	ENDIF

	IF NOT time_left_a1 = 0
		GET_MINUTES_TO_TIME_OF_DAY hours_a1 mins_a1 time_left_a1
	ENDIF
	
	IF garage_door_close = 0
		IF IS_PLAYER_IN_ZONE player REDLIGH
			PRINT_NOW AM1_6 5000 1//"Don't hang around Luigi's club, or the Mafia will spot you"
			//REMOVE_BLIP mission_blip_am1
			//DISPLAY_RADAR 2 // PATHING OFF
			garage_door_close = 1
		ENDIF
	ENDIF

	//GS-SC: Create exclusions for the additional mafia peds

	IF HAS_CHAR_SPOTTED_PLAYER mafia_1X player
	AND kill_player_now_flag = 0
		IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
			IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
				kill_player_now_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF HAS_CHAR_SPOTTED_PLAYER mafia_2X player
	AND kill_player_now_flag = 0
		IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
			IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
				kill_player_now_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF HAS_CHAR_SPOTTED_PLAYER mafia_3X player
	AND kill_player_now_flag = 0
		IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
			IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
				kill_player_now_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF HAS_CHAR_SPOTTED_PLAYER mafia_4X player
	AND kill_player_now_flag = 0
		IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
			IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
				kill_player_now_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF HAS_CHAR_SPOTTED_PLAYER mafia_5X player
	AND kill_player_now_flag = 0
		IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
			IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
				kill_player_now_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF HAS_CHAR_SPOTTED_PLAYER mafia_6X player
	AND kill_player_now_flag = 0
		IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
			IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
				kill_player_now_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF HAS_CHAR_SPOTTED_PLAYER mafia_7X player
	AND kill_player_now_flag = 0
		IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
			IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
				kill_player_now_flag = 1
			ENDIF
		ENDIF
	ENDIF



//____CREATE MAFIA 8 TO GUARD THE STEPS____//

	IF NOT door_position_a1 = 90.0
		diff_heading_door = 90.0 - door_position_a1
		IF diff_heading_door < 10.0
			door_position_a1 = 90.0
		ELSE
			door_position_a1 += 10.0
		ENDIF
		SET_OBJECT_HEADING backdoor door_position_a1
		door_crash_flag = 1
	ENDIF

	IF mafia_8_flag = 0
		CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_B create_char_in_club_x create_char_in_club_y create_char_in_club_z mafia_8X	
		//SET_CHAR_THREAT_SEARCH mafia_8X THREAT_PLAYER1
		SET_CHAR_PERSONALITY mafia_8X PEDSTAT_TOUGH_GUY
		//SET_CHAR_HEED_THREATS mafia_8X TRUE
		GIVE_WEAPON_TO_CHAR mafia_8X WEAPONTYPE_UZI 999
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	mafia_8X bottom_of_steps_x bottom_of_steps_y
		mafia_8_flag = 1
	ELSE
		IF IS_CHAR_DEAD mafia_8X
			kill_player_now_flag = 1
			mafia_8_flag = 4
		ENDIF
	ENDIF
		
	IF mafia_8_flag = 1
		IF LOCATE_CHAR_ON_FOOT_2D mafia_8X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_8X 887.6 -418.5
			mafia_8_flag = 2
		ENDIF
	ENDIF

	IF mafia_8_flag = 2
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_8X 887.6 -418.5 0.5 0.5 0
			SET_CHAR_HEADING mafia_8X 90.0
			CHAR_SET_IDLE mafia_8X
			mafia_8_flag = 3
		ENDIF
	ENDIF

	IF mafia_8_flag > 0
	AND mafia_8_flag < 4
		IF HAS_CHAR_SPOTTED_PLAYER mafia_8X player
			IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 1 // ON HIGHER ROOF ABOVE THE ALLEY
				IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 1 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

//____CREATE MAFIA 9 TO GUARD THE STEPS____//

	IF mafia_8_flag > 0
	AND mafia_9_flag = 0
		IF IS_CHAR_DEAD	mafia_8X
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A create_char_in_club_x create_char_in_club_y create_char_in_club_z mafia_9X	
			IF beamer1_health = 1
				DO_FADE 400 FADE_IN
			ENDIF
			//SET_CHAR_THREAT_SEARCH mafia_9X THREAT_PLAYER1
			SET_CHAR_PERSONALITY mafia_9X PEDSTAT_TOUGH_GUY
			//SET_CHAR_HEED_THREATS mafia_9X TRUE
			GIVE_WEAPON_TO_CHAR mafia_9X WEAPONTYPE_UZI 999
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	mafia_9X bottom_of_steps_x bottom_of_steps_y
			mafia_9_flag = 1
		ELSE
			IF NOT LOCATE_CHAR_ON_FOOT_2D mafia_8X create_char_in_club_x create_char_in_club_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A create_char_in_club_x create_char_in_club_y create_char_in_club_z mafia_9X	
				IF beamer1_health = 1
					DO_FADE 400 FADE_IN
				ENDIF
				//SET_CHAR_THREAT_SEARCH mafia_9X THREAT_PLAYER1
				SET_CHAR_PERSONALITY mafia_9X PEDSTAT_TOUGH_GUY
				//SET_CHAR_HEED_THREATS mafia_9X TRUE
				GIVE_WEAPON_TO_CHAR mafia_9X WEAPONTYPE_UZI 999
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	mafia_9X bottom_of_steps_x bottom_of_steps_y
				mafia_9_flag = 1
			ENDIF
		ENDIF
	ELSE
		IF mafia_9_flag > 0
			IF IS_CHAR_DEAD mafia_9X
				kill_player_now_flag = 1
				mafia_9_flag = 4
			ENDIF
		ENDIF
	ENDIF
	
		
	IF mafia_9_flag = 1
		IF LOCATE_CHAR_ON_FOOT_2D mafia_9X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_9X 887.6 -415.3
			mafia_9_flag = 2
		ENDIF
	ENDIF

	IF mafia_9_flag = 2
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_9X 887.6 -415.3 0.5 0.5 0
			SET_CHAR_HEADING mafia_9X 90.0
			CHAR_SET_IDLE mafia_9X
			mafia_9_flag = 3
		ENDIF
	ENDIF

	IF mafia_9_flag > 0
	AND mafia_9_flag < 4
		IF HAS_CHAR_SPOTTED_PLAYER mafia_9X player
			IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
				IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

//___CREATE MAFIA 10 TO GUARD THE ALLEY____//

	IF mafia_9_flag > 0
	AND mafia_10_flag = 0
		IF IS_CHAR_DEAD mafia_9X
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A create_char_in_club_x create_char_in_club_y create_char_in_club_z mafia_10X	
			SET_CHAR_THREAT_SEARCH mafia_10X THREAT_PLAYER1
			SET_CHAR_PERSONALITY mafia_10X PEDSTAT_TOUGH_GUY
			//SET_CHAR_HEED_THREATS mafia_10X TRUE
			GIVE_WEAPON_TO_CHAR mafia_10X WEAPONTYPE_UZI 999
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	mafia_10X bottom_of_steps_x bottom_of_steps_y
			mafia_10_flag = 1
		ELSE
			IF NOT LOCATE_CHAR_ON_FOOT_2D mafia_9X create_char_in_club_x create_char_in_club_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A create_char_in_club_x create_char_in_club_y create_char_in_club_z mafia_10X	
				SET_CHAR_THREAT_SEARCH mafia_10X THREAT_PLAYER1
				SET_CHAR_PERSONALITY mafia_10X PEDSTAT_TOUGH_GUY
				//SET_CHAR_HEED_THREATS mafia_10X TRUE
				GIVE_WEAPON_TO_CHAR mafia_10X WEAPONTYPE_SHOTGUN 999
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	mafia_10X bottom_of_steps_x bottom_of_steps_y
				mafia_10_flag = 1
			ENDIF
		ENDIF
	ELSE
		IF mafia_10_flag > 0
			IF IS_CHAR_DEAD mafia_10X
				kill_player_now_flag = 1
				mafia_10_flag = 4
			ENDIF
		ENDIF
	ENDIF

	IF mafia_10_flag = 1
		IF LOCATE_CHAR_ON_FOOT_2D mafia_10X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_10X mafia_10_x mafia_10_y
			mafia_10_flag = 2
		ENDIF
	ENDIF

	IF mafia_10_flag = 2
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_10X mafia_10_x mafia_10_y 0.5 0.5 0
			SET_CHAR_HEADING mafia_10X 0.0
			CHAR_SET_IDLE mafia_10X
			mafia_10_flag = 3
		ENDIF
	ENDIF

	IF mafia_10_flag > 0
	AND mafia_10_flag < 4
		IF HAS_CHAR_SPOTTED_PLAYER mafia_10X player
			IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
				IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

//___CREATE MAFIA 11 TO GUARD THE ALLEY____//

	IF mafia_10_flag > 0
	AND mafia_11_flag = 0
		IF IS_CHAR_DEAD mafia_10X
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_B create_char_in_club_x create_char_in_club_y create_char_in_club_z mafia_11X	
			SET_CHAR_THREAT_SEARCH mafia_11X THREAT_PLAYER1
			SET_CHAR_PERSONALITY mafia_11X PEDSTAT_TOUGH_GUY
			//SET_CHAR_HEED_THREATS mafia_11X TRUE
			GIVE_WEAPON_TO_CHAR mafia_11X WEAPONTYPE_SHOTGUN 999
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	mafia_11X bottom_of_steps_x bottom_of_steps_y
			mafia_11_flag = 1
		ELSE
			IF NOT LOCATE_CHAR_ON_FOOT_2D mafia_10X create_char_in_club_x create_char_in_club_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A create_char_in_club_x create_char_in_club_y create_char_in_club_z mafia_11X	
				SET_CHAR_THREAT_SEARCH mafia_11X THREAT_PLAYER1
				SET_CHAR_PERSONALITY mafia_11X PEDSTAT_TOUGH_GUY
				//SET_CHAR_HEED_THREATS mafia_11X TRUE
				GIVE_WEAPON_TO_CHAR mafia_11X WEAPONTYPE_SHOTGUN 999
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	mafia_11X bottom_of_steps_x bottom_of_steps_y
				mafia_11_flag = 1
			ENDIF
		ENDIF
	ELSE
		IF mafia_11_flag > 0
			IF IS_CHAR_DEAD mafia_11X
				kill_player_now_flag = 1
				mafia_11_flag = 4
			ENDIF
		ENDIF
	ENDIF


	IF mafia_11_flag = 1
		IF LOCATE_CHAR_ON_FOOT_2D mafia_11X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_11X mafia_11_x mafia_11_y
			mafia_11_flag = 2
		ENDIF
	ENDIF

	IF mafia_11_flag = 2
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_11X mafia_11_x mafia_11_y 0.5 0.5 0
			SET_CHAR_HEADING mafia_11X 0.0
			CHAR_SET_IDLE mafia_11X
			mafia_11_flag = 3
		ENDIF
	ENDIF

	IF mafia_11_flag > 0
	AND mafia_11_flag < 4
		IF HAS_CHAR_SPOTTED_PLAYER mafia_11X player
			IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
				IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

//___CREATE MAFIA 12 TO GUARD THE ALLEY____//

	IF mafia_11_flag > 0
	AND mafia_12_flag = 0
		IF IS_CHAR_DEAD mafia_11X
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A create_char_in_club_x create_char_in_club_y create_char_in_club_z mafia_12X	
			SET_CHAR_THREAT_SEARCH mafia_12X THREAT_PLAYER1
			SET_CHAR_PERSONALITY mafia_12X PEDSTAT_TOUGH_GUY
			//SET_CHAR_HEED_THREATS mafia_12X TRUE
			GIVE_WEAPON_TO_CHAR mafia_12X WEAPONTYPE_UZI 999
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	mafia_12X bottom_of_steps_x bottom_of_steps_y
			mafia_12_flag = 1
		ELSE
			IF NOT LOCATE_CHAR_ON_FOOT_2D mafia_11X create_char_in_club_x create_char_in_club_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A create_char_in_club_x create_char_in_club_y create_char_in_club_z mafia_12X	
				SET_CHAR_THREAT_SEARCH mafia_12X THREAT_PLAYER1
				SET_CHAR_PERSONALITY mafia_12X PEDSTAT_TOUGH_GUY
				//SET_CHAR_HEED_THREATS mafia_12X TRUE
				GIVE_WEAPON_TO_CHAR mafia_12X WEAPONTYPE_SHOTGUN 999
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	mafia_12X bottom_of_steps_x bottom_of_steps_y
				mafia_12_flag = 1
			ENDIF
		ENDIF
	ELSE
		IF mafia_12_flag > 0
			IF IS_CHAR_DEAD mafia_12X
				kill_player_now_flag = 1
				mafia_12_flag = 4
			ENDIF
		ENDIF
	ENDIF

	IF mafia_12_flag = 1
		IF LOCATE_CHAR_ON_FOOT_2D mafia_12X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_12X mafia_12_x mafia_12_y
			mafia_12_flag = 2
		ENDIF
	ENDIF

	IF mafia_12_flag = 2
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_12X mafia_12_x mafia_12_y 0.5 0.5 0
			SET_CHAR_HEADING mafia_12X 180.0
			CHAR_SET_IDLE mafia_12X
			mafia_12_flag = 3
		ENDIF
	ENDIF

	IF mafia_12_flag > 0
	AND mafia_12_flag < 4
		IF HAS_CHAR_SPOTTED_PLAYER mafia_12X player
			IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
				IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

//___CREATE MAFIA 13 TO GUARD THE ALLEY____//

	IF mafia_12_flag > 0
	AND mafia_13_flag = 0
		IF IS_CHAR_DEAD mafia_12X
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_B create_char_in_club_x create_char_in_club_y create_char_in_club_z mafia_13X	
			SET_CHAR_THREAT_SEARCH mafia_13X THREAT_PLAYER1
			SET_CHAR_PERSONALITY mafia_13X PEDSTAT_TOUGH_GUY
			//SET_CHAR_HEED_THREATS mafia_13X TRUE
			GIVE_WEAPON_TO_CHAR mafia_13X WEAPONTYPE_SHOTGUN 999
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	mafia_13X bottom_of_steps_x bottom_of_steps_y
			mafia_13_flag = 1
		ELSE
			IF NOT LOCATE_CHAR_ON_FOOT_2D mafia_12X create_char_in_club_x create_char_in_club_y 2.0 2.0 0
				CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_A create_char_in_club_x create_char_in_club_y create_char_in_club_z mafia_13X	
			  	SET_CHAR_THREAT_SEARCH mafia_13X THREAT_PLAYER1
				SET_CHAR_PERSONALITY mafia_13X PEDSTAT_TOUGH_GUY
				//SET_CHAR_HEED_THREATS mafia_13X TRUE
				GIVE_WEAPON_TO_CHAR mafia_13X WEAPONTYPE_SHOTGUN 999
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	mafia_13X bottom_of_steps_x bottom_of_steps_y
				mafia_13_flag = 1
			ENDIF
		ENDIF
	ELSE
		IF mafia_13_flag > 0
			IF IS_CHAR_DEAD mafia_13X
				kill_player_now_flag = 1
				mafia_13_flag = 4
			ENDIF
		ENDIF
	ENDIF

	IF mafia_13_flag = 1
		IF LOCATE_CHAR_ON_FOOT_2D mafia_13X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_13X mafia_13_x mafia_13_y
			IF beamer1_health = 1
				SWITCH_WIDESCREEN OFF
				SET_PLAYER_CONTROL player ON
				SET_EVERYONE_IGNORE_PLAYER player OFF
				SET_ALL_CARS_CAN_BE_DAMAGED TRUE
				SWITCH_STREAMING ON
				IF IS_PLAYER_IN_ANY_CAR player
					APPLY_BRAKES_TO_PLAYERS_CAR player OFF
				ENDIF
				RESTORE_CAMERA_JUMPCUT
				MARK_MODEL_AS_NO_LONGER_NEEDED indhibuild3
				MARK_MODEL_AS_NO_LONGER_NEEDED luigiclubout
				MARK_MODEL_AS_NO_LONGER_NEEDED luigiineerclub
				MARK_MODEL_AS_NO_LONGER_NEEDED ind_customroad016
				beamer1_health = 0
			ENDIF 
			mafia_13_flag = 2
		ENDIF
	ENDIF

	IF mafia_13_flag = 2
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_13X mafia_13_x mafia_13_y 0.5 0.5 0
			SET_CHAR_HEADING mafia_13X 180.0
			CHAR_SET_IDLE mafia_13X
			mafia_13_flag = 3
		ENDIF
	ENDIF

	IF mafia_13_flag > 0
	AND mafia_13_flag < 4
		IF HAS_CHAR_SPOTTED_PLAYER mafia_13X player
			IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
				IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

//________CHECK IF THERE IS A CAR AT THE END OF THE ALLEY IF THERE IS ONE OF THE MAFIA WILL MOVE IT_______//

	IF fuckers_car < 1
		GET_RANDOM_CAR_OF_TYPE_IN_AREA 900.467 -431.884 905.759 -419.944 -1 fuckers_car
	ENDIF

	
	IF IS_CAR_DEAD fuckers_car
//		IF NOT fuckers_car = -1
//			IF NOT enter_car_flag = 0
				MARK_CAR_AS_NO_LONGER_NEEDED fuckers_car
				fuckers_car = -1
				enter_car_flag = 0
//			ENDIF
//		ENDIF
	ENDIF

	IF enter_car_flag < 5
		IF NOT fuckers_car = -1
			IF fuckers_car = beamer1_a1
				IF NOT IS_CAR_DEAD beamer1_a1
					CAR_GOTO_COORDINATES_ACCURATE beamer1_a1 904.9 -434.1 15.0
				ELSE
					DELETE_CAR beamer1_a1
				ENDIF
			ELSE
				IF fuckers_car = beamer2_a1
					IF NOT IS_CAR_DEAD beamer2_a1
						CAR_GOTO_COORDINATES_ACCURATE beamer2_a1 904.9 -434.1 15.0
					ELSE
						DELETE_CAR beamer2_a1
					ENDIF
				ELSE
					IF fuckers_car = beamer3_a1
						IF NOT IS_CAR_DEAD beamer3_a1
							CAR_GOTO_COORDINATES_ACCURATE beamer3_a1 904.9 -434.1 15.0
						ELSE
							DELETE_CAR beamer3_a1
						ENDIF
					ELSE
						IF mafia_10_flag < 4
							IF mafia_10_flag > 1
								IF LOCATE_CHAR_ON_FOOT_CAR_2D mafia_10X fuckers_car 4.0 4.0 0
									SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER mafia_10X fuckers_car
									TIMERA = 0
									enter_car_flag = 10
								ENDIF
							ENDIF
						ELSE
							IF mafia_11_flag < 4
								IF mafia_11_flag > 1
									IF LOCATE_CHAR_ON_FOOT_CAR_2D mafia_11X fuckers_car 4.0 4.0 0
										SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER mafia_11X fuckers_car
										TIMERA = 0
										enter_car_flag = 11
									ENDIF
								ENDIF
							ELSE
								IF mafia_12_flag < 4
									IF mafia_12_flag > 1
										IF LOCATE_CHAR_ON_FOOT_CAR_2D mafia_12X fuckers_car 4.0 4.0 0
											SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER mafia_12X fuckers_car
											TIMERA = 0
											enter_car_flag = 12
										ENDIF
									ENDIF
								ELSE
									IF mafia_13_flag < 4
										IF mafia_13_flag > 1
											IF LOCATE_CHAR_ON_FOOT_CAR_2D mafia_13X fuckers_car 4.0 4.0 0
												SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER mafia_13X fuckers_car
												TIMERA = 0
												enter_car_flag = 13
											ENDIF
										ENDIF
									ELSE
										IF IS_CAR_DEAD fuckers_car
											MARK_CAR_AS_NO_LONGER_NEEDED fuckers_car
											kill_player_now_flag = 1
										ENDIF
									ENDIF
								ENDIF
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF enter_car_flag = 10
		IF IS_CHAR_IN_CAR mafia_10X fuckers_car
			GOSUB move_fuckers_car
			mafia_10_flag = 4
			enter_car_flag = 5
		ENDIF
	ENDIF
	
	IF enter_car_flag = 11
		IF IS_CHAR_IN_CAR mafia_11X fuckers_car
			GOSUB move_fuckers_car
			mafia_11_flag = 4
			enter_car_flag = 5
		ENDIF
	ENDIF
	
	IF enter_car_flag = 12
		IF IS_CHAR_IN_CAR mafia_12X fuckers_car
			GOSUB move_fuckers_car
			mafia_12_flag = 4
			enter_car_flag = 5
		ENDIF
	ENDIF
	
	IF enter_car_flag = 13
		IF IS_CHAR_IN_CAR mafia_13X fuckers_car
			GOSUB move_fuckers_car
			mafia_13_flag = 4
			enter_car_flag = 5
		ENDIF
	ENDIF

	IF enter_car_flag > 9
		IF TIMERA > 20000
			IF NOT IS_CAR_DEAD fuckers_car
				IF NOT IS_PLAYER_IN_CAR player fuckers_car
					MARK_CAR_AS_NO_LONGER_NEEDED fuckers_car
					enter_car_flag = 0
					fuckers_car = -1
				ELSE
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF TIMERA > 180000
		frankie_exists_flag = 1
	ENDIF
//________________________________________________________________________________________________________//

	IF kill_player_now_flag = 1
		GOSUB kill_player_now_script
	ENDIF

	IF NOT frankie_exists_flag = 0
		GOTO create_salvatore
	ENDIF

ENDWHILE

IF frankie_exists_flag = 0
	IF IS_PLAYER_IN_AREA_2D player 878.79 -427.4 890.77 -403.89 0 //BACK OF CLUB
	OR IS_PLAYER_IN_AREA_2D player 878.79 -433.86 890.77 -427.4 0 //LOWER ROOF
		frankie_exists_flag = 2
	ELSE
		frankie_exists_flag = 1
	ENDIF
ENDIF

create_salvatore:

IF frankie_exists_flag = 1
	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 create_char_in_club_x create_char_in_club_y create_char_in_club_z frankie
	IF kill_player_now_flag = 0
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT frankie bottom_of_steps_x bottom_of_steps_y
	ELSE
		SET_CHAR_OBJ_RUN_TO_COORD frankie bottom_of_steps_x bottom_of_steps_y
	ENDIF
ENDIF

IF frankie_exists_flag = 2
	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 900.2028 -416.9139 14.0 frankie // OUT FRONT OF CLUB
	SET_CHAR_OBJ_RUN_TO_COORD frankie street_x street_y
	frankie_flag = 5
ENDIF

IF frankie_exists_flag = 3
	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 884.6421 -422.9535 14.0 frankie //CLOSER TO END OF ALLEY
	SET_CHAR_OBJ_RUN_TO_COORD frankie street_x street_y
	frankie_flag = 5
ENDIF

SET_CHAR_THREAT_SEARCH frankie THREAT_PLAYER1
SET_CHAR_PERSONALITY frankie PEDSTAT_GEEK_GUY
SET_CHAR_ONLY_DAMAGED_BY_PLAYER frankie TRUE

REMOVE_BLIP mission_blip_am1
ADD_BLIP_FOR_CHAR frankie mission_blip_am1
PRINT_NOW AM1_1 5000 1//"Salvatore is now leaving Luigi's"

garage_door_close = 0

WHILE NOT IS_CHAR_IN_ANY_CAR frankie
	
	WAIT 0

	IF IS_CHAR_DEAD frankie
		GOTO mission_asuka1_passed
	ENDIF

	IF NOT time_left_a1 = 0
		GET_MINUTES_TO_TIME_OF_DAY hours_a1 mins_a1 time_left_a1
	ENDIF
	
	IF HAS_CHAR_SPOTTED_PLAYER frankie player
		IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
			IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
				kill_player_now_flag = 1
			ENDIF
		ENDIF
	ENDIF

//___IF MAFIA HAVE SPOTTED THE PLAYER, MAKE FRANKIE RUN____//
	
	IF NOT IS_CHAR_DEAD mafia_8X
		IF HAS_CHAR_SPOTTED_PLAYER mafia_8X player
			IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
				IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ELSE
		kill_player_now_flag = 1
		mafia_8_flag = 4
	ENDIF

	IF NOT IS_CHAR_DEAD mafia_9X
		IF HAS_CHAR_SPOTTED_PLAYER mafia_9X player
			IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
				IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ELSE
		kill_player_now_flag = 1
		mafia_9_flag = 4
	ENDIF

	IF NOT IS_CHAR_DEAD mafia_10X
		IF HAS_CHAR_SPOTTED_PLAYER mafia_10X player
			IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
				IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ELSE
		kill_player_now_flag = 1
		mafia_10_flag = 4
	ENDIF

	IF NOT IS_CHAR_DEAD mafia_11X
		IF HAS_CHAR_SPOTTED_PLAYER mafia_11X player
			IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
				IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ELSE
		kill_player_now_flag = 1
		mafia_11_flag = 4
	ENDIF

	IF NOT IS_CHAR_DEAD mafia_12X
		IF HAS_CHAR_SPOTTED_PLAYER mafia_12X player
			IF NOT IS_PLAYER_IN_AREA_3D player 845.75 -443.85 0.0 890.77 -433.86 40.0 0
				IF NOT IS_PLAYER_IN_AREA_3D player 920.0792 -408.8181 0.0 931.3213 -398.101 40.0 0 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ELSE
		kill_player_now_flag = 1
		mafia_12_flag = 4
	ENDIF

	IF NOT IS_CHAR_DEAD mafia_13X
		IF HAS_CHAR_SPOTTED_PLAYER mafia_13X player
			IF NOT IS_PLAYER_IN_AREA_2D player 845.75 -443.85 890.77 -433.86 0
				IF NOT IS_PLAYER_IN_AREA_2D player 920.0792 -408.8181 931.3213 -398.101 0 //ON TOP OF SNIPER BUILDING OVER ROAD
					kill_player_now_flag = 1
				ENDIF
			ENDIF
		ENDIF
	ELSE
		kill_player_now_flag = 1
		mafia_13_flag = 4
	ENDIF

	IF kill_player_now_flag = 1
		GOSUB kill_player_now_script
	ENDIF


//___GET FRANKIE INTO A CAR, IF ALL CARS ARE DEAD FRANKIE RUNS BACK____//

	IF IS_CAR_DEAD beamer1_a1
		beamer_1_dead_flag = 1
	ENDIF

	IF IS_CAR_DEAD beamer2_a1
		beamer_2_dead_flag = 1
	ENDIF
	
	IF IS_CAR_DEAD beamer3_a1
		beamer_3_dead_flag = 1
	ENDIF

	IF frankie_flag = 0
		IF LOCATE_CHAR_ON_FOOT_2D frankie bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			IF kill_player_now_flag = 0
				SET_CHAR_OBJ_GOTO_COORD_ON_FOOT frankie street_x street_y
			ELSE
				SET_CHAR_OBJ_RUN_TO_COORD frankie street_x street_y
			ENDIF
			frankie_flag = 5
		ENDIF
	ENDIF
	
	IF frankie_flag = 5
		IF LOCATE_CHAR_ON_FOOT_2D frankie street_x street_y 1.0 1.0 0
			IF beamer_2_dead_flag = 0
			AND LOCATE_CHAR_ON_FOOT_CAR_2D frankie beamer2_a1 30.0 30.0 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER frankie	beamer2_a1
				frankie_flag = 2
			ELSE
				IF beamer_3_dead_flag = 0
				AND	LOCATE_CHAR_ON_FOOT_CAR_2D frankie beamer3_a1 30.0 30.0 0
					SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER frankie	beamer3_a1
					frankie_flag = 3
				ELSE
					IF beamer_1_dead_flag = 0
					AND	LOCATE_CHAR_ON_FOOT_CAR_2D frankie beamer1_a1 30.0 30.0 0
						SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER frankie	beamer1_a1
						frankie_flag = 1
					ELSE
						SET_CHAR_OBJ_RUN_TO_COORD frankie bottom_of_steps_x bottom_of_steps_y
						frankie_flag = 4
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF frankie_flag = 2
		IF beamer_2_dead_flag = 1
			IF beamer_1_dead_flag = 0
			AND	LOCATE_CHAR_ON_FOOT_CAR_2D frankie beamer1_a1 30.0 30.0 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER frankie	beamer1_a1
				frankie_flag = 1
			ELSE
				IF beamer_3_dead_flag = 0
				AND	LOCATE_CHAR_ON_FOOT_CAR_2D frankie beamer3_a1 30.0 30.0 0
					SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER frankie	beamer3_a1
					frankie_flag = 3
				ELSE
					SET_CHAR_OBJ_RUN_TO_COORD frankie bottom_of_steps_x bottom_of_steps_y
					frankie_flag = 4
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF frankie_flag = 3
		IF beamer_3_dead_flag = 1
			IF beamer_1_dead_flag = 0
			AND	LOCATE_CHAR_ON_FOOT_CAR_2D frankie beamer1_a1 30.0 30.0 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER frankie	beamer1_a1
				frankie_flag = 1
			ELSE
				SET_CHAR_OBJ_RUN_TO_COORD frankie bottom_of_steps_x bottom_of_steps_y
				frankie_flag = 4
			ENDIF
		ENDIF
	ENDIF

	IF frankie_flag = 1
		IF beamer_1_dead_flag = 1
			IF beamer_3_dead_flag = 0
			AND	LOCATE_CHAR_ON_FOOT_CAR_2D frankie beamer3_a1 30.0 30.0 0
				SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER frankie	beamer3_a1
				frankie_flag = 3
			ELSE
				SET_CHAR_OBJ_RUN_TO_COORD frankie bottom_of_steps_x bottom_of_steps_y
				frankie_flag = 4
			ENDIF
		ENDIF
	ENDIF

	IF frankie_flag = 4
		IF LOCATE_CHAR_ON_FOOT_2D frankie bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_RUN_TO_COORD frankie create_char_in_club_x create_char_in_club_y
			frankie_flag = 6
		ENDIF
	ENDIF

	IF frankie_flag = 6
		IF LOCATE_CHAR_ON_FOOT_2D frankie create_char_in_club_x create_char_in_club_y 1.0 1.0 0
			DELETE_CHAR frankie
			PRINT_NOW AM1_9 5000 1//"Salvatore has escaped back into Luigi's Club!"
			GOTO mission_asuka1_failed
		ENDIF
	ENDIF

ENDWHILE


IF NOT IS_CAR_DEAD beamer1_a1
	
	IF frankie_flag = 1
		CAR_GOTO_COORDINATES beamer1_a1 1438.0 -183.4 50.5
		SET_TARGET_CAR_FOR_MISSION_GARAGE frankie_garage beamer1_a1
	ELSE
		CAR_GOTO_COORDINATES beamer1_a1 1423.7 -168.1 50.2
	ENDIF

	IF kill_player_now_flag = 0
		SET_CAR_CRUISE_SPEED beamer1_a1 18.0
	ELSE
		SET_CAR_CRUISE_SPEED beamer1_a1 43.0
	ENDIF

ENDIF

IF NOT IS_CAR_DEAD beamer2_a1
	
	IF frankie_flag = 2
		CAR_GOTO_COORDINATES beamer2_a1 1438.0 -183.4 50.5
		SET_TARGET_CAR_FOR_MISSION_GARAGE frankie_garage beamer2_a1
	ELSE
		CAR_GOTO_COORDINATES beamer2_a1 1418.7 -168.1 50.2
	ENDIF
	
	IF kill_player_now_flag = 0
		SET_CAR_CRUISE_SPEED beamer2_a1 17.0
	ELSE
		SET_CAR_CRUISE_SPEED beamer2_a1 42.0
	ENDIF

ENDIF

IF NOT IS_CAR_DEAD beamer3_a1
	
	IF frankie_flag = 3
		CAR_GOTO_COORDINATES beamer3_a1 1438.0 -183.4 50.5
		SET_TARGET_CAR_FOR_MISSION_GARAGE frankie_garage beamer3_a1
	ELSE
		CAR_GOTO_COORDINATES beamer3_a1 1418.7 -168.1 50.2
	ENDIF
	
	IF kill_player_now_flag = 0
		SET_CAR_CRUISE_SPEED beamer3_a1 16.0
	ELSE
		SET_CAR_CRUISE_SPEED beamer3_a1 41.0
	ENDIF

ENDIF

SWITCH_ROADS_ON 905.0 -448.6 12.0 916.0 -393.0 20.0
CHANGE_GARAGE_TYPE frankie_garage GARAGE_FOR_SCRIPT_TO_OPEN_AND_CLOSE
IF NOT IS_CHAR_DEAD	frankie
	ADD_ARMOUR_TO_CHAR frankie 100
ENDIF
beamer1_health = 0
timerb_reset_flag_a1 = 0
TIMERA = 0
TIMERB = 0

cars_going_to_frankies:
//WHILE NOT IS_CHAR_STOPPED_IN_AREA_IN_CAR_3D frankie 1428.2 -179.2 50.0 1417.4 -186.3 53.0 0
//WHILE NOT garage_door_close = 1

	WAIT 0

	IF IS_CHAR_DEAD frankie
		GOTO mission_asuka1_passed
	ENDIF
	
//_____SEND MAFIA_8X BACK INTO THE CLUB THEN DELETE HIM____//
	
	IF NOT mafia_8_flag = 4
		IF IS_CHAR_DEAD mafia_8X
			mafia_8_flag = 4
		ENDIF
	ENDIF
	
	IF mafia_8_flag = 3
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_8X back_of_alley_x back_of_alley_y
		SET_CHAR_HEED_THREATS mafia_8X TRUE
		mafia_8_flag = 5
	ENDIF

	IF mafia_8_flag = 5
		IF LOCATE_CHAR_ON_FOOT_2D mafia_8X back_of_alley_x	back_of_alley_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_8X bottom_of_steps_x bottom_of_steps_y
			mafia_8_flag = 6
		ENDIF
	ENDIF

	IF mafia_8_flag = 6
		IF LOCATE_CHAR_ON_FOOT_2D mafia_8X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_8X create_char_in_club_x create_char_in_club_y
			mafia_8_flag = 7
		ENDIF
	ENDIF

	IF mafia_8_flag = 7
		IF LOCATE_CHAR_ON_FOOT_2D mafia_8X create_char_in_club_x create_char_in_club_y 0.5 0.5 0
			DELETE_CHAR mafia_8X
			mafia_8_flag = 4
		ENDIF
	ENDIF
	
//_____SEND MAFIA_9X BACK INTO THE CLUB THEN DELETE HIM____//
	
	IF NOT mafia_9_flag = 4
		IF IS_CHAR_DEAD mafia_9X
			mafia_9_flag = 4
		ENDIF
	ENDIF
	
	IF mafia_9_flag = 3
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_9X back_of_alley_x back_of_alley_y
		SET_CHAR_HEED_THREATS mafia_9X TRUE
		mafia_9_flag = 5
	ENDIF

	IF mafia_9_flag = 5
		IF LOCATE_CHAR_ON_FOOT_2D mafia_9X back_of_alley_x	back_of_alley_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_9X bottom_of_steps_x bottom_of_steps_y
			mafia_9_flag = 6
		ENDIF
	ENDIF

	IF mafia_9_flag = 6
		IF LOCATE_CHAR_ON_FOOT_2D mafia_9X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_9X create_char_in_club_x create_char_in_club_y
			mafia_9_flag = 7
		ENDIF
	ENDIF

	IF mafia_9_flag = 7
		IF LOCATE_CHAR_ON_FOOT_2D mafia_9X create_char_in_club_x create_char_in_club_y 0.5 0.5 0
			DELETE_CHAR mafia_9X
			mafia_9_flag = 4
		ENDIF
	ENDIF
	
//_____SEND MAFIA_10X BACK INTO THE CLUB THEN DELETE HIM____//
	
	IF NOT mafia_10_flag = 4
		IF IS_CHAR_DEAD mafia_10X
			mafia_10_flag = 4
		ENDIF
	ENDIF
	
	IF mafia_10_flag = 3
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_10X back_of_alley_x back_of_alley_y
		SET_CHAR_HEED_THREATS mafia_10X TRUE
		mafia_10_flag = 5
	ENDIF

	IF mafia_10_flag = 5
		IF LOCATE_CHAR_ON_FOOT_2D mafia_10X back_of_alley_x	back_of_alley_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_10X bottom_of_steps_x bottom_of_steps_y
			mafia_10_flag = 6
		ENDIF
	ENDIF

	IF mafia_10_flag = 6
		IF LOCATE_CHAR_ON_FOOT_2D mafia_10X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_10X create_char_in_club_x create_char_in_club_y
			mafia_10_flag = 7
		ENDIF
	ENDIF

	IF mafia_10_flag = 7
		IF LOCATE_CHAR_ON_FOOT_2D mafia_10X create_char_in_club_x create_char_in_club_y 0.5 0.5 0
			DELETE_CHAR mafia_10X
			mafia_10_flag = 4
		ENDIF
	ENDIF
	
//_____SEND MAFIA_11X BACK INTO THE CLUB THEN DELETE HIM____//
	
	IF NOT mafia_11_flag = 4
		IF IS_CHAR_DEAD mafia_11X
			mafia_11_flag = 4
		ENDIF
	ENDIF
	
	IF mafia_11_flag = 3
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_11X back_of_alley_x back_of_alley_y
		SET_CHAR_HEED_THREATS mafia_11X TRUE
		mafia_11_flag = 5
	ENDIF

	IF mafia_11_flag = 5
		IF LOCATE_CHAR_ON_FOOT_2D mafia_11X back_of_alley_x	back_of_alley_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_11X bottom_of_steps_x bottom_of_steps_y
			mafia_11_flag = 6
		ENDIF
	ENDIF

	IF mafia_11_flag = 6
		IF LOCATE_CHAR_ON_FOOT_2D mafia_11X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_11X create_char_in_club_x create_char_in_club_y
			mafia_11_flag = 7
		ENDIF
	ENDIF

	IF mafia_11_flag = 7
		IF LOCATE_CHAR_ON_FOOT_2D mafia_11X create_char_in_club_x create_char_in_club_y 0.5 0.5 0
			DELETE_CHAR mafia_11X
			mafia_11_flag = 4
		ENDIF
	ENDIF
	
//_____SEND MAFIA_12X BACK INTO THE CLUB THEN DELETE HIM____//
	
	IF NOT mafia_12_flag = 4
		IF IS_CHAR_DEAD mafia_12X
			mafia_12_flag = 4
		ENDIF
	ENDIF
	
	IF mafia_12_flag = 3
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_12X back_of_alley_x back_of_alley_y
		SET_CHAR_HEED_THREATS mafia_12X TRUE
		mafia_12_flag = 5
	ENDIF

	IF mafia_12_flag = 5
		IF LOCATE_CHAR_ON_FOOT_2D mafia_12X back_of_alley_x	back_of_alley_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_12X bottom_of_steps_x bottom_of_steps_y
			mafia_12_flag = 6
		ENDIF
	ENDIF

	IF mafia_12_flag = 6
		IF LOCATE_CHAR_ON_FOOT_2D mafia_12X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_12X create_char_in_club_x create_char_in_club_y
			mafia_12_flag = 7
		ENDIF
	ENDIF

	IF mafia_12_flag = 7
		IF LOCATE_CHAR_ON_FOOT_2D mafia_12X create_char_in_club_x create_char_in_club_y 0.5 0.5 0
			DELETE_CHAR mafia_12X
			mafia_12_flag = 4
		ENDIF
	ENDIF
	
//_____SEND MAFIA_13X BACK INTO THE CLUB THEN DELETE HIM____//
	
	IF NOT mafia_13_flag = 4
		IF IS_CHAR_DEAD mafia_13X
			mafia_13_flag = 4
		ENDIF
	ENDIF
	
	IF mafia_13_flag = 3
		SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_13X back_of_alley_x back_of_alley_y
		SET_CHAR_HEED_THREATS mafia_13X TRUE
		mafia_13_flag = 5
	ENDIF

	IF mafia_13_flag = 5
		IF LOCATE_CHAR_ON_FOOT_2D mafia_13X back_of_alley_x	back_of_alley_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_13X bottom_of_steps_x bottom_of_steps_y
			mafia_13_flag = 6
		ENDIF
	ENDIF

	IF mafia_13_flag = 6
		IF LOCATE_CHAR_ON_FOOT_2D mafia_13X bottom_of_steps_x bottom_of_steps_y 1.0 1.0 0
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_13X create_char_in_club_x create_char_in_club_y
			mafia_13_flag = 7
		ENDIF
	ENDIF

	IF mafia_13_flag = 7
		IF LOCATE_CHAR_ON_FOOT_2D mafia_13X create_char_in_club_x create_char_in_club_y 0.5 0.5 0
			DELETE_CHAR mafia_13X
			mafia_13_flag = 4
		ENDIF
	ENDIF

//_____          CARS - IF THEY'RE ATACKED THEY DRIVE FASTER                 _____//
//_____    IF FRANKIES CAR IS ATTACKED BOTH OTHER CARS ATTACK THE PLAYER     _____//
//_____IF ONE OF THE OTHER CARS IS DESTROYED THE OTHER WILL ATTACK THE PLAYER_____//

	IF IS_CHAR_DEAD frankie
		GOTO mission_asuka1_passed
	ENDIF
	
	IF frankies_ride = 0
		IF LOCATE_CHAR_IN_CAR_2D frankie 1371.0 -283.9 50.0 50.0 0
			STORE_CAR_CHAR_IS_IN frankie frankies_ride
			SET_CAR_CRUISE_SPEED frankies_ride 20.0
			//PRINT_WITH_NUMBER_NOW NUMBER 15 5000 1 
		ENDIF
	ENDIF
	
	IF NOT IS_CAR_DEAD beamer1_a1
		GET_CAR_HEALTH beamer1_a1 beamer1_health
		IF beamer1_health < 1000
			IF NOT frankies_ride = beamer1_a1
				SET_CAR_CRUISE_SPEED beamer1_a1 51.0
			ENDIF
			IF NOT IS_CAR_DEAD beamer2_a1
				IF NOT frankies_ride = beamer2_a1
					SET_CAR_CRUISE_SPEED beamer2_a1 50.0
				ENDIF
			ENDIF
			IF NOT IS_CAR_DEAD beamer3_a1
				IF NOT frankies_ride = beamer3_a1
					SET_CAR_CRUISE_SPEED beamer3_a1 49.0
					set_beamer_3_kill_player = 1
				ENDIF
			ENDIF
		ENDIF
	ELSE
		IF NOT IS_CAR_DEAD beamer3_a1
			IF NOT frankie_flag = 3
				set_beamer_3_kill_player = 1
			ELSE
				IF NOT IS_CAR_DEAD beamer2_a1
					IF NOT frankie_flag = 2
						set_beamer_2_kill_player = 1
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
	IF NOT IS_CAR_DEAD beamer3_a1
		GET_CAR_HEALTH beamer3_a1 beamer3_health
		IF beamer3_health < 1000
			IF NOT frankies_ride = beamer3_a1
				SET_CAR_CRUISE_SPEED beamer3_a1 51.0
			ENDIF
			IF NOT IS_CAR_DEAD beamer1_a1
				IF NOT frankies_ride = beamer1_a1
					SET_CAR_CRUISE_SPEED beamer1_a1 50.0
					set_beamer_1_kill_player = 1
				ENDIF
			ENDIF
			IF NOT IS_CAR_DEAD beamer2_a1
				IF NOT frankies_ride = beamer2_a1
					SET_CAR_CRUISE_SPEED beamer2_a1 49.0
				ENDIF
			ENDIF
		ENDIF
	ELSE
		IF NOT IS_CAR_DEAD beamer1_a1
			IF NOT frankie_flag = 1
				set_beamer_1_kill_player = 1
			ELSE
				IF NOT IS_CAR_DEAD beamer2_a1
					IF NOT frankie_flag = 2
						set_beamer_2_kill_player = 1
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
	IF NOT IS_CAR_DEAD beamer2_a1
		GET_CAR_HEALTH beamer2_a1 beamer2_health
		IF beamer2_health < 1000
			IF NOT frankies_ride = beamer2_a1
				SET_CAR_CRUISE_SPEED beamer2_a1 51.0
			ENDIF
			IF NOT IS_CAR_DEAD beamer1_a1
				IF NOT frankies_ride = beamer1_a1
					SET_CAR_CRUISE_SPEED beamer1_a1 50.0
					set_beamer_1_kill_player = 1
				ENDIF
			ENDIF
			IF NOT IS_CAR_DEAD beamer3_a1
				IF NOT frankies_ride = beamer3_a1
					SET_CAR_CRUISE_SPEED beamer3_a1 49.0
					set_beamer_3_kill_player = 1
				ENDIF
			ENDIF
		ENDIF
	ELSE
		IF NOT IS_CAR_DEAD beamer1_a1
			IF NOT frankie_flag = 1
				set_beamer_1_kill_player = 1
			ELSE
				IF NOT IS_CAR_DEAD beamer3_a1
					IF NOT frankie_flag = 3
						set_beamer_3_kill_player = 1
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
	IF set_beamer_1_kill_player = 1
		IF NOT IS_CAR_DEAD beamer1_a1
			IF NOT frankies_ride = beamer1_a1
				SET_CAR_CRUISE_SPEED beamer1_a1 100.0
				SET_CAR_MISSION beamer1_a1 MISSION_RAMPLAYER_FARAWAY
			ENDIF
		ENDIF
	ENDIF
		
	IF set_beamer_2_kill_player = 1
		IF NOT IS_CAR_DEAD beamer2_a1
			IF NOT frankies_ride = beamer2_a1
				SET_CAR_CRUISE_SPEED beamer2_a1 100.0
				SET_CAR_MISSION beamer2_a1 MISSION_RAMPLAYER_FARAWAY
			ENDIF
		ENDIF
	ENDIF
		
	IF set_beamer_3_kill_player = 1
		IF NOT IS_CAR_DEAD beamer3_a1
			IF NOT frankies_ride = beamer3_a1
				SET_CAR_CRUISE_SPEED beamer3_a1 100.0
				SET_CAR_MISSION beamer3_a1 MISSION_RAMPLAYER_FARAWAY
			ENDIF
		ENDIF
	ENDIF

	IF set_beamer_1_kill_player = 1
		IF NOT IS_CHAR_DEAD mafia_1X
		OR NOT IS_CAR_DEAD beamer1_a1
			IF IS_PLAYER_IN_ANY_CAR	player
				STORE_CAR_PLAYER_IS_IN player players_car_a1
				GET_CAR_SPEED players_car_a1 players_car_a1_speed
				GET_CAR_SPEED beamer1_a1 beamer1_a1_speed
				IF beamer1_a1_speed < 10.0
				AND players_car_a1_speed < 6.0
					IF LOCATE_CHAR_IN_CAR_CAR_2D mafia_1X players_car_a1 10.0 10.0 0
						IF NOT IS_CHAR_DEAD mafia_6X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_6X player
							SET_CHAR_RUNNING mafia_6X TRUE
						ENDIF
						IF NOT IS_CHAR_DEAD mafia_7X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_7X player
							SET_CHAR_RUNNING mafia_7X TRUE
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF set_beamer_2_kill_player = 1
		IF NOT IS_CHAR_DEAD mafia_2X
		OR NOT IS_CAR_DEAD beamer2_a1
			IF IS_PLAYER_IN_ANY_CAR	player
				STORE_CAR_PLAYER_IS_IN player players_car_a1
				GET_CAR_SPEED players_car_a1 players_car_a1_speed
				GET_CAR_SPEED beamer2_a1 beamer2_a1_speed
				IF beamer2_a1_speed < 10.0
				AND players_car_a1_speed < 6.0
					IF LOCATE_CHAR_IN_CAR_CAR_2D mafia_2X players_car_a1 10.0 10.0 0
						IF NOT IS_CHAR_DEAD mafia_14X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_14X player
							SET_CHAR_RUNNING mafia_14X TRUE
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF set_beamer_3_kill_player = 1
		IF NOT IS_CHAR_DEAD mafia_3X
		OR NOT IS_CAR_DEAD beamer3_a1
			IF IS_PLAYER_IN_ANY_CAR	player
				STORE_CAR_PLAYER_IS_IN player players_car_a1
				GET_CAR_SPEED players_car_a1 players_car_a1_speed
				GET_CAR_SPEED beamer3_a1 beamer3_a1_speed
				IF beamer3_a1_speed < 10.0
				AND players_car_a1_speed < 6.0
					IF LOCATE_CHAR_IN_CAR_CAR_2D mafia_3X players_car_a1 10.0 10.0 0
						IF NOT IS_CHAR_DEAD mafia_4X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_4X player
							SET_CHAR_RUNNING mafia_4X TRUE
						ENDIF
						IF NOT IS_CHAR_DEAD mafia_5X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_5X player
							SET_CHAR_RUNNING mafia_5X TRUE
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

//___________IF THE CARS GET STUCK OR UPSIDEDOWN THIS BIT WILL WARP THEM___________//

	IF NOT IS_CAR_DEAD beamer1_a1
		IF IS_CAR_UPSIDEDOWN beamer1_a1
		AND IS_CAR_STOPPED beamer1_a1
			IF NOT IS_CAR_ON_SCREEN beamer1_a1
				GET_CAR_COORDINATES beamer1_a1 a1_x a1_y a1_z
				GET_CLOSEST_CAR_NODE a1_x a1_y a1_z a1_x a1_y a1_z
//				IF NOT IS_POINT_ON_SCREEN a1_x a1_y a1_z 3.0
				IF NOT LOCATE_PLAYER_ANY_MEANS_2D player a1_x a1_y 80.0 80.0 0
					SET_CAR_COORDINATES beamer1_a1 a1_x a1_y a1_z
					TURN_CAR_TO_FACE_COORD beamer1_a1 1438.0 -183.4
				ELSE
					IF NOT IS_CHAR_DEAD mafia_1X
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_1X player
					ENDIF
					IF NOT IS_CHAR_DEAD mafia_7X
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_7X player
					ENDIF
					IF frankie_flag = 1
						IF NOT IS_CHAR_DEAD frankie
							GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
						ENDIF
					ENDIF
				ENDIF
			ELSE
				IF NOT IS_CHAR_DEAD mafia_1X
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_1X player
				ENDIF
				IF NOT IS_CHAR_DEAD mafia_7X
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_7X player
				ENDIF
				IF frankie_flag = 1
					IF NOT IS_CHAR_DEAD frankie
						GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		IF timera_reset_flag_a1 = 1
			IF NOT IS_CAR_STOPPED beamer1_a1
				timera_reset_flag_a1 = 0
			ENDIF
		ENDIF
			
		IF IS_CAR_STOPPED beamer1_a1
			IF timera_reset_flag_a1 = 0
				TIMERA = 0
				timera_reset_flag_a1 = 1
			ENDIF

			IF TIMERA > 4000
			AND timera_reset_flag_a1 = 1
				IF NOT IS_CAR_ON_SCREEN beamer1_a1
					GET_CAR_COORDINATES beamer1_a1 a1_x a1_y a1_z
					GET_CLOSEST_CAR_NODE a1_x a1_y a1_z a1_x a1_y a1_z
//					IF NOT IS_POINT_ON_SCREEN a1_x a1_y a1_z 4.0
					IF NOT LOCATE_PLAYER_ANY_MEANS_2D player a1_x a1_y 80.0 80.0 0
						SET_CAR_COORDINATES beamer1_a1 a1_x a1_y a1_z
						TURN_CAR_TO_FACE_COORD beamer1_a1 1438.0 -183.4
						timera_reset_flag_a1 = 0
					ELSE
						IF NOT IS_CHAR_DEAD mafia_1X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_1X player
						ENDIF
						IF NOT IS_CHAR_DEAD mafia_7X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_7X player
						ENDIF
						IF frankie_flag = 1
							IF NOT IS_CHAR_DEAD frankie
								GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
							ENDIF
						ENDIF
					ENDIF
				ELSE
					IF NOT IS_CHAR_DEAD mafia_1X
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_1X player
					ENDIF
					IF NOT IS_CHAR_DEAD mafia_7X
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_7X player
					ENDIF
					IF frankie_flag = 1
						IF NOT IS_CHAR_DEAD frankie
							GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		
		IF LOCATE_CAR_3D beamer1_a1 beamer1_stuck_x beamer1_stuck_y beamer1_stuck_z 4.0 4.0 4.0 0
			IF timerx_reset_flag = 0
				GET_GAME_TIMER timerx_started
				timerx_reset_flag = 1
			ENDIF

			IF timerx_reset_flag = 1
				GET_GAME_TIMER timerx_current
				timerx = timerx_current - timerx_started
				IF timerx > 5000
					IF NOT IS_CAR_ON_SCREEN beamer1_a1
						GET_CAR_COORDINATES beamer1_a1 a1_x a1_y a1_z
						GET_CLOSEST_CAR_NODE a1_x a1_y a1_z a1_x a1_y a1_z
//						IF NOT IS_POINT_ON_SCREEN a1_x a1_y a1_z 4.0
						IF NOT LOCATE_PLAYER_ANY_MEANS_2D player a1_x a1_y 80.0 80.0 0
							SET_CAR_COORDINATES beamer1_a1 a1_x a1_y a1_z
							TURN_CAR_TO_FACE_COORD beamer1_a1 1438.0 -183.4
							timera_reset_flag_a1 = 0
						ELSE
							IF NOT IS_CHAR_DEAD mafia_1X
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_1X player
							ENDIF
							IF NOT IS_CHAR_DEAD mafia_7X
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_7X player
							ENDIF
							IF frankie_flag = 1
								IF NOT IS_CHAR_DEAD frankie
									GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
									SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
								ENDIF
							ENDIF
						ENDIF
					ELSE
						IF NOT IS_CHAR_DEAD mafia_1X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_1X player
						ENDIF
						IF NOT IS_CHAR_DEAD mafia_7X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_7X player
						ENDIF
						IF frankie_flag = 1
							IF NOT IS_CHAR_DEAD frankie
								GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		IF NOT LOCATE_CAR_3D beamer1_a1 beamer1_stuck_x beamer1_stuck_y beamer1_stuck_z 4.0 4.0 4.0 0
			GET_CAR_COORDINATES beamer1_a1 beamer1_stuck_x beamer1_stuck_y beamer1_stuck_z
			timerx_reset_flag = 0
		ENDIF

	ENDIF

	IF NOT IS_CAR_DEAD beamer2_a1
		IF IS_CAR_UPSIDEDOWN beamer2_a1
		AND IS_CAR_STOPPED beamer2_a1
			IF NOT IS_CAR_ON_SCREEN beamer2_a1
				GET_CAR_COORDINATES beamer2_a1 a1_x a1_y a1_z
				GET_CLOSEST_CAR_NODE a1_x a1_y a1_z a1_x a1_y a1_z
//				IF NOT IS_POINT_ON_SCREEN a1_x a1_y a1_z 3.0
				IF NOT LOCATE_PLAYER_ANY_MEANS_2D player a1_x a1_y 80.0 80.0 0
					SET_CAR_COORDINATES beamer2_a1 a1_x a1_y a1_z
					TURN_CAR_TO_FACE_COORD beamer2_a1 1438.0 -183.4
				ELSE
					IF NOT IS_CHAR_DEAD mafia_2X
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_2X player
					ENDIF
					IF NOT IS_CHAR_DEAD mafia_14X
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_14X player
					ENDIF
					IF frankie_flag = 2
						IF NOT IS_CHAR_DEAD frankie
							GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
						ENDIF
					ENDIF
				ENDIF
			ELSE
				IF NOT IS_CHAR_DEAD mafia_2X
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_2X player
				ENDIF
				IF NOT IS_CHAR_DEAD mafia_14X
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_14X player
				ENDIF
				IF frankie_flag = 2
					IF NOT IS_CHAR_DEAD frankie
						GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		IF timerb_reset_flag_a1 = 1
			IF NOT IS_CAR_STOPPED beamer2_a1
				timerb_reset_flag_a1 = 0
			ENDIF
		ENDIF
			
		IF IS_CAR_STOPPED beamer2_a1
			IF timerb_reset_flag_a1 = 0
				TIMERB = 0
				timerb_reset_flag_a1 = 1
			ENDIF

			IF TIMERB > 5000
			AND timerb_reset_flag_a1 = 1
				IF NOT IS_CAR_ON_SCREEN beamer2_a1
					GET_CAR_COORDINATES beamer2_a1 a1_x a1_y a1_z
					GET_CLOSEST_CAR_NODE a1_x a1_y a1_z a1_x a1_y a1_z
//					IF NOT IS_POINT_ON_SCREEN a1_x a1_y a1_z 4.0
					IF NOT LOCATE_PLAYER_ANY_MEANS_2D player a1_x a1_y 80.0 80.0 0
						SET_CAR_COORDINATES beamer2_a1 a1_x a1_y a1_z
						TURN_CAR_TO_FACE_COORD beamer2_a1 1438.0 -183.4
						timerb_reset_flag_a1 = 0
					ELSE
						IF NOT IS_CHAR_DEAD mafia_2X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_2X player
						ENDIF
						IF NOT IS_CHAR_DEAD mafia_14X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_14X player
						ENDIF
						IF frankie_flag = 2
							IF NOT IS_CHAR_DEAD frankie
								GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
							ENDIF
						ENDIF
					ENDIF
				ELSE
					IF NOT IS_CHAR_DEAD mafia_2X
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_2X player
					ENDIF
					IF NOT IS_CHAR_DEAD mafia_14X
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_14X player
					ENDIF
					IF frankie_flag = 2
						IF NOT IS_CHAR_DEAD frankie
							GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		
		IF LOCATE_CAR_3D beamer2_a1 beamer2_stuck_x beamer2_stuck_y beamer2_stuck_z 4.0 4.0 4.0 0
			IF timery_reset_flag = 0
				GET_GAME_TIMER timery_started
				timery_reset_flag = 1
			ENDIF

			IF timery_reset_flag = 1
				GET_GAME_TIMER timery_current
				timery = timery_current - timery_started
				IF timery > 5000
					IF NOT IS_CAR_ON_SCREEN beamer2_a1
						GET_CAR_COORDINATES beamer2_a1 a1_x a1_y a1_z
						GET_CLOSEST_CAR_NODE a1_x a1_y a1_z a1_x a1_y a1_z
//						IF NOT IS_POINT_ON_SCREEN a1_x a1_y a1_z 4.0
						IF NOT LOCATE_PLAYER_ANY_MEANS_2D player a1_x a1_y 80.0 80.0 0
							SET_CAR_COORDINATES beamer2_a1 a1_x a1_y a1_z
							TURN_CAR_TO_FACE_COORD beamer2_a1 1438.0 -183.4
							timerb_reset_flag_a1 = 0
						ELSE
							IF NOT IS_CHAR_DEAD mafia_2X
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_2X player
							ENDIF
							IF NOT IS_CHAR_DEAD mafia_14X
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_14X player
							ENDIF
							IF frankie_flag = 2
								IF NOT IS_CHAR_DEAD frankie
									GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
									SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
								ENDIF
							ENDIF
						ENDIF
					ELSE
						IF NOT IS_CHAR_DEAD mafia_2X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_2X player
						ENDIF
						IF NOT IS_CHAR_DEAD mafia_14X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_14X player
						ENDIF
						IF frankie_flag = 2
							IF NOT IS_CHAR_DEAD frankie
								GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		IF NOT LOCATE_CAR_3D beamer2_a1 beamer2_stuck_x beamer2_stuck_y beamer2_stuck_z 4.0 4.0 4.0 0
			GET_CAR_COORDINATES beamer2_a1 beamer2_stuck_x beamer2_stuck_y beamer2_stuck_z
			timery_reset_flag = 0
		ENDIF

	ENDIF

	IF NOT IS_CAR_DEAD beamer3_a1
		IF IS_CAR_UPSIDEDOWN beamer3_a1
		AND IS_CAR_STOPPED beamer3_a1
			IF NOT IS_CAR_ON_SCREEN beamer3_a1
				GET_CAR_COORDINATES beamer3_a1 a1_x a1_y a1_z
				GET_CLOSEST_CAR_NODE a1_x a1_y a1_z a1_x a1_y a1_z
//				IF NOT IS_POINT_ON_SCREEN a1_x a1_y a1_z 3.0
				IF NOT LOCATE_PLAYER_ANY_MEANS_2D player a1_x a1_y 80.0 80.0 0
					SET_CAR_COORDINATES beamer3_a1 a1_x a1_y a1_z
					TURN_CAR_TO_FACE_COORD beamer3_a1 1438.0 -183.4
				ELSE
					IF NOT IS_CHAR_DEAD mafia_3X
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_3X player
					ENDIF
					IF NOT IS_CHAR_DEAD mafia_4X
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_4X player
					ENDIF
					IF NOT IS_CHAR_DEAD mafia_5X
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_5X player
					ENDIF
					IF frankie_flag = 3
						IF NOT IS_CHAR_DEAD frankie
							GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
						ENDIF
					ENDIF
				ENDIF
			ELSE
				IF NOT IS_CHAR_DEAD mafia_3X
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_3X player
				ENDIF
				IF NOT IS_CHAR_DEAD mafia_4X
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_4X player
				ENDIF
				IF NOT IS_CHAR_DEAD mafia_5X
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_5X player
				ENDIF
				IF frankie_flag = 3
					IF NOT IS_CHAR_DEAD frankie
						GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		IF timerc_reset_flag_a1 = 1
			IF NOT IS_CAR_STOPPED beamer3_a1
				timerc_reset_flag_a1 = 0
			ENDIF
		ENDIF
			
		IF IS_CAR_STOPPED beamer3_a1
			IF timerc_reset_flag_a1 = 0
				GET_GAME_TIMER timerc_started_a1
				timerc_reset_flag_a1 = 1
			ENDIF

			IF timerc_reset_flag_a1 = 1
				GET_GAME_TIMER timerc_current_a1
				timerc_a1 = timerc_current_a1 - timerc_started_a1
				IF timerc_a1 > 5000
					IF NOT IS_CAR_ON_SCREEN beamer3_a1
						GET_CAR_COORDINATES beamer3_a1 a1_x a1_y a1_z
						GET_CLOSEST_CAR_NODE a1_x a1_y a1_z a1_x a1_y a1_z
//						IF NOT IS_POINT_ON_SCREEN a1_x a1_y a1_z 4.0
						IF NOT LOCATE_PLAYER_ANY_MEANS_2D player a1_x a1_y 80.0 80.0 0
							SET_CAR_COORDINATES beamer3_a1 a1_x a1_y a1_z
							TURN_CAR_TO_FACE_COORD beamer3_a1 1438.0 -183.4
							timerc_reset_flag_a1 = 0
						ELSE
							IF NOT IS_CHAR_DEAD mafia_3X
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_3X player
							ENDIF
							IF NOT IS_CHAR_DEAD mafia_4X
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_4X player
							ENDIF
							IF NOT IS_CHAR_DEAD mafia_5X
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_5X player
							ENDIF
							IF frankie_flag = 3
								IF NOT IS_CHAR_DEAD frankie
									GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
									SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
								ENDIF
							ENDIF
						ENDIF
					ELSE
						IF NOT IS_CHAR_DEAD mafia_3X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_3X player
						ENDIF
						IF NOT IS_CHAR_DEAD mafia_4X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_4X player
						ENDIF
						IF NOT IS_CHAR_DEAD mafia_5X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_5X player
						ENDIF
						IF frankie_flag = 3
							IF NOT IS_CHAR_DEAD frankie
								GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		
		IF LOCATE_CAR_3D beamer3_a1 beamer3_stuck_x beamer3_stuck_y beamer3_stuck_z 4.0 4.0 4.0 0
			IF timerz_reset_flag = 0
				GET_GAME_TIMER timerz_started
				timerz_reset_flag = 1
			ENDIF

			IF timerz_reset_flag = 1
				GET_GAME_TIMER timerz_current
				timerz = timerz_current - timerz_started
				IF timerz > 5000
					IF NOT IS_CAR_ON_SCREEN beamer3_a1
						GET_CAR_COORDINATES beamer3_a1 a1_x a1_y a1_z
						GET_CLOSEST_CAR_NODE a1_x a1_y a1_z a1_x a1_y a1_z
//						IF NOT IS_POINT_ON_SCREEN a1_x a1_y a1_z 4.0
						IF NOT LOCATE_PLAYER_ANY_MEANS_2D player a1_x a1_y 80.0 80.0 0
							SET_CAR_COORDINATES beamer3_a1 a1_x a1_y a1_z
							TURN_CAR_TO_FACE_COORD beamer3_a1 1438.0 -183.4
							timerc_reset_flag_a1 = 0
						ELSE
							IF NOT IS_CHAR_DEAD mafia_3X
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_3X player
							ENDIF
							IF NOT IS_CHAR_DEAD mafia_4X
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_4X player
							ENDIF
							IF NOT IS_CHAR_DEAD mafia_5X
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_5X player
							ENDIF
							IF frankie_flag = 3
								IF NOT IS_CHAR_DEAD frankie
									GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
									SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
								ENDIF
							ENDIF
						ENDIF
					ELSE
						IF NOT IS_CHAR_DEAD mafia_3X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_3X player
						ENDIF
						IF NOT IS_CHAR_DEAD mafia_4X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_4X player
						ENDIF
						IF NOT IS_CHAR_DEAD mafia_5X
							SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_5X player
						ENDIF
						IF frankie_flag = 3
							IF NOT IS_CHAR_DEAD frankie
								GIVE_WEAPON_TO_CHAR	frankie WEAPONTYPE_M16 1000
								SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS frankie player
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		IF NOT LOCATE_CAR_3D beamer3_a1 beamer3_stuck_x beamer3_stuck_y beamer3_stuck_z 4.0 4.0 4.0 0
			GET_CAR_COORDINATES beamer3_a1 beamer3_stuck_x beamer3_stuck_y beamer3_stuck_z
			timerz_reset_flag = 0
		ENDIF

	ENDIF

//___________THIS BIT OPENS THE GARAGE, IF FRANKIE GETS THERE MISSION FAILED_________//

	IF garage_door_close = 0
		IF LOCATE_CHAR_ANY_MEANS_3D	frankie 1426.0 -183.4 50.5 15.0 12.0 6.0 0
			OPEN_GARAGE frankie_garage
			garage_door_close = 1
		ENDIF
	ENDIF
	
	IF garage_door_close = 1
		IF NOT IS_PLAYER_IN_AREA_3D player 1427.6 -187.3 49.5 1442.6 -179.0 53.8 0
			IF IS_CHAR_IN_AREA_3D frankie 1428.8 -187.0 50.0 1442.5 -179.9 53.0 0
				CLOSE_GARAGE frankie_garage
				garage_door_close = 2
			ENDIF
		ELSE
			OPEN_GARAGE frankie_garage
		ENDIF
	ENDIF

	IF garage_door_close = 2
		IF IS_PLAYER_IN_AREA_3D player 1427.6 -187.3 49.5 1442.6 -179.0 53.8 0
			OPEN_GARAGE frankie_garage
			garage_door_close = 1
		ENDIF
		IF IS_GARAGE_CLOSED	frankie_garage
			PRINT_NOW AM1_7 5000 1 //"Salvatore got back to his club alive!"
			GOTO mission_asuka1_failed
		ENDIF
	ENDIF

GOTO cars_going_to_frankies


// Mission Asuka1 failed

mission_asuka1_failed:

IF NOT IS_CHAR_DEAD mafia_1X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_1X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_2X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_2X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_3X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_3X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_4X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_4X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_5X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_5X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_6X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_6X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_7X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_7X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_8X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_8X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_9X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_9X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_10X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_10X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_11X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_11X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_12X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_12X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_13X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_13X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_14X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_14X player 
ENDIF

PRINT_BIG ( m_fail ) 5000 1
RETURN

   
// mission Asuka1 passed

mission_asuka1_passed:

flag_asuka_mission1_passed = 1

IF NOT IS_CHAR_DEAD mafia_1X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_1X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_2X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_2X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_3X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_3X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_4X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_4X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_5X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_5X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_6X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_6X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_7X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_7X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_8X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_8X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_9X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_9X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_10X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_10X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_11X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_11X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_12X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_12X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_13X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_13X player 
ENDIF
IF NOT IS_CHAR_DEAD mafia_14X
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS mafia_14X player 
ENDIF

PRINT_WITH_NUMBER_BIG m_pass 25000 5000 1
ADD_SCORE player 25000
SET_THREAT_FOR_PED_TYPE	PEDTYPE_GANG_MAFIA THREAT_PLAYER1
SET_GANG_WEAPONS GANG_MAFIA WEAPONTYPE_PISTOL WEAPONTYPE_SHOTGUN //The Mafia
CLEAR_WANTED_LEVEL player
REGISTER_MISSION_PASSED	AM1
PLAY_MISSION_PASSED_TUNE 1
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT asuka_mission2_loop
START_NEW_SCRIPT joeys_buggy_loop
START_NEW_SCRIPT yardie_phone_start
RETURN									


// mission cleanup

mission_cleanup_asuka1:

DISPLAY_RADAR 3 // PATHING ON

START_NEW_SCRIPT close_asuka1_door

//IF NOT IS_CHAR_DEAD frankie
//	REMOVE_CHAR_ELEGANTLY frankie
//ENDIF

SET_TARGET_CAR_FOR_MISSION_GARAGE frankie_garage -1

MARK_MODEL_AS_NO_LONGER_NEEDED CAR_MAFIA
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_A                       
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_B                       
UNLOAD_SPECIAL_CHARACTER 1
REMOVE_BLIP	mission_blip_am1
SWITCH_ROADS_ON 905.0 -448.6 12.0 916.0 -393.0 20.0
CLEAR_AREA 400.8 -165.9 -10.9 10.0 TRUE  // GS-SC: Fix for stray car at the end of mission
flag_player_on_mission = 0
flag_player_on_asuka_mission = 0
MISSION_HAS_FINISHED
RETURN


kill_player_now_script:

IF spotted_print = 0
	IF HAS_MISSION_AUDIO_LOADED
		PRINT_NOW AM1_2 5000 1
		PLAY_MISSION_AUDIO
		spotted_print = 1
	ENDIF
ENDIF

IF NOT IS_CHAR_DEAD	frankie
	SET_CHAR_RUNNING frankie TRUE
ENDIF

IF IS_PLAYER_IN_AREA_2D player 845.75 -443.85 890.77 -433.86 0 //HIGHER ROOF
OR IS_PLAYER_IN_AREA_2D player 878.79 -433.86 890.77 -427.4 0 //LOWER ROOF
OR IS_PLAYER_IN_AREA_3D player 890.77 -433.71 23.05 900.78 -403.76 46.0 0 //CLUB ROOF

	IF NOT mafia_13_flag = 4
		IF NOT mafia_13_flag = 0

			IF mafia_13_flag > 1
			AND mafia_13_kill_player_flag = 0
				SET_CHAR_USE_PEDNODE_SEEK mafia_13X TRUE
				SET_CHAR_OBJ_RUN_TO_COORD mafia_13X 886.0037 -414.0266 // NEAR BOTTOM OF STEPS
				mafia_13_kill_player_flag = 1
			ENDIF

			IF mafia_13_kill_player_flag = 1
				IF LOCATE_CHAR_ON_FOOT_2D mafia_13X	886.0037 -414.0266 1.0 1.0 0 //	NEAR BOTTOM OF STEPS
					SET_CHAR_USE_PEDNODE_SEEK mafia_13X FALSE
					SET_CHAR_OBJ_RUN_TO_COORD mafia_13X 888.8883 -409.8141 // AT BOTTOM OF STEPS
					mafia_13_kill_player_flag = 2
				ENDIF
			ENDIF
			
			IF mafia_13_kill_player_flag = 2
				IF LOCATE_CHAR_ON_FOOT_2D mafia_13X	888.8883 -409.8141 1.0 1.0 0// AT BOTTOM OF STEPS
					SET_CHAR_OBJ_RUN_TO_COORD mafia_13X 880.9434 -409.0293 // ON LANDING
					mafia_13_kill_player_flag = 3
				ENDIF
			ENDIF
			
			IF mafia_13_kill_player_flag = 3
				IF LOCATE_CHAR_ON_FOOT_2D mafia_13X	880.9434 -409.0293 1.0 1.0 0 //	ON LANDING
					SET_CHAR_OBJ_RUN_TO_COORD mafia_13X 880.9827 -406.0733 // ON LANDING
					mafia_13_kill_player_flag = 4
				ENDIF
			ENDIF
			
			IF mafia_13_kill_player_flag = 4
				IF LOCATE_CHAR_ON_FOOT_2D mafia_13X	880.9827 -406.0733 1.0 1.0 0 //	ON LANDING
					SET_CHAR_OBJ_RUN_TO_COORD mafia_13X 892.1010 -406.2053 // ON ROOF TOP OF STAIRS
					mafia_13_kill_player_flag = 5
				ENDIF
			ENDIF
			
			IF mafia_13_kill_player_flag = 5
				IF LOCATE_CHAR_ON_FOOT_2D mafia_13X	892.1010 -406.2053 1.0 1.0 0 // ON ROOF TOP OF STAIRS
					SET_CHAR_OBJ_RUN_TO_COORD mafia_13X 892.2498 -421.2303 // IN MIDDLE OF ROOF
					mafia_13_kill_player_flag = 6
				ENDIF
			ENDIF
			
			IF mafia_13_kill_player_flag = 6
				IF LOCATE_CHAR_ON_FOOT_2D mafia_13X	892.2498 -421.2303 1.0 1.0 0 // IN MIDDLE OF ROOF
					IF IS_PLAYER_IN_AREA_3D player 890.77 -433.71 23.05 900.78 -403.76 46.0 0 //CLUB ROOF
						SET_CHAR_OBJ_RUN_TO_COORD mafia_13X 893.2559 -425.0609 // ABOVE SMALL ROOF BETWEEN BILLBOARDS
					ELSE
						SET_CHAR_OBJ_RUN_TO_COORD mafia_13X 892.1462 -429.0872 // ABOVE SMALL ROOF
					ENDIF
					mafia_13_kill_player_flag = 7
				ENDIF
			ENDIF
			
			IF mafia_13_kill_player_flag = 7
				IF IS_PLAYER_IN_AREA_3D player 890.77 -433.71 23.05 900.78 -403.76 46.0 0 //CLUB ROOF
					SET_CHAR_OBJ_RUN_TO_COORD mafia_13X 893.2559 -425.0609 // ABOVE SMALL ROOF BETWEEN BILLBOARDS
					IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_13X	893.2559 -425.0609 1.0 1.0 0 // ABOVE SMALL ROOF
						SET_CHAR_USE_PEDNODE_SEEK mafia_13X TRUE
						SET_CHAR_STAY_IN_SAME_PLACE mafia_13X TRUE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_13X player
						mafia_13_kill_player_flag = 8
					ENDIF
				ELSE
					SET_CHAR_OBJ_RUN_TO_COORD mafia_13X 892.1462 -429.0872 // ABOVE SMALL ROOF
					IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_13X	892.1462 -429.0872 1.0 1.0 0 // ABOVE SMALL ROOF
						SET_CHAR_USE_PEDNODE_SEEK mafia_13X TRUE
						SET_CHAR_STAY_IN_SAME_PLACE mafia_13X TRUE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_13X player
						mafia_13_kill_player_flag = 8
					ENDIF
				ENDIF
			ENDIF

		ENDIF
	ENDIF

	IF NOT mafia_12_flag = 4
		IF NOT mafia_12_flag = 0
			IF IS_PLAYER_IN_AREA_3D player 890.77 -433.71 23.05 900.78 -403.76 46.0 0 //CLUB ROOF
			
				IF mafia_12_flag > 1
				AND mafia_12_kill_player_flag = 0
					SET_CHAR_USE_PEDNODE_SEEK mafia_12X TRUE
					SET_CHAR_OBJ_RUN_TO_COORD mafia_12X 886.0037 -414.0266 // NEAR BOTTOM OF STEPS
					mafia_12_kill_player_flag = 1
				ENDIF

				IF mafia_12_kill_player_flag = 1
					IF LOCATE_CHAR_ON_FOOT_2D mafia_12X	886.0037 -414.0266 1.0 1.0 0 //	NEAR BOTTOM OF STEPS
						SET_CHAR_USE_PEDNODE_SEEK mafia_12X FALSE
						SET_CHAR_OBJ_RUN_TO_COORD mafia_12X 888.8883 -409.8141 // AT BOTTOM OF STEPS
						mafia_12_kill_player_flag = 2
					ENDIF
				ENDIF
				
				IF mafia_12_kill_player_flag = 2
					IF LOCATE_CHAR_ON_FOOT_2D mafia_12X	888.8883 -409.8141 1.0 1.0 0// AT BOTTOM OF STEPS
						SET_CHAR_OBJ_RUN_TO_COORD mafia_12X 880.9434 -409.0293 // ON LANDING
						mafia_12_kill_player_flag = 3
					ENDIF
				ENDIF
				
				IF mafia_12_kill_player_flag = 3
					IF LOCATE_CHAR_ON_FOOT_2D mafia_12X	880.9434 -409.0293 1.0 1.0 0 //	ON LANDING
						SET_CHAR_OBJ_RUN_TO_COORD mafia_12X 880.9827 -406.0733 // ON LANDING
						mafia_12_kill_player_flag = 4
					ENDIF
				ENDIF
				
				IF mafia_12_kill_player_flag = 4
					IF LOCATE_CHAR_ON_FOOT_2D mafia_12X	880.9827 -406.0733 1.0 1.0 0 //	ON LANDING
						SET_CHAR_OBJ_RUN_TO_COORD mafia_12X 892.1010 -406.2053 // ON ROOF TOP OF STAIRS
						mafia_12_kill_player_flag = 5
					ENDIF
				ENDIF
				
				IF mafia_12_kill_player_flag = 5
					IF LOCATE_CHAR_ON_FOOT_2D mafia_12X	892.1010 -406.2053 1.0 1.0 0 // ON ROOF TOP OF STAIRS
						SET_CHAR_OBJ_RUN_TO_COORD mafia_12X 899.3036 -408.1849 // AT FRONT OF ROOF
						GIVE_WEAPON_TO_CHAR	mafia_12X WEAPONTYPE_UZI 9999
						mafia_12_kill_player_flag = 6
					ENDIF
				ENDIF
				
				IF mafia_12_kill_player_flag = 6
					IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_12X	899.3036 -408.1849 1.0 1.0 0 // AT FRONT OF ROOF
						SET_CHAR_USE_PEDNODE_SEEK mafia_12X TRUE
						SET_CHAR_STAY_IN_SAME_PLACE mafia_12X TRUE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_12X player
						mafia_12_kill_player_flag = 7
					ENDIF
				ENDIF

			ELSE
			
				IF mafia_12_flag > 1
				AND mafia_12_kill_player_flag = 0
					SET_CHAR_USE_PEDNODE_SEEK mafia_12X TRUE
					SET_CHAR_OBJ_RUN_TO_COORD mafia_12X 882.7668 -414.3651
					mafia_12_kill_player_flag = 1
				ENDIF

				IF mafia_12_kill_player_flag = 1
					IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_12X	882.7668 -414.3651 1.0 1.0 0
						SET_CHAR_USE_PEDNODE_SEEK mafia_12X TRUE
						SET_CHAR_STAY_IN_SAME_PLACE mafia_12X TRUE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_12X player
						mafia_12_kill_player_flag = 7
					ENDIF
				ENDIF

			ENDIF
		ENDIF
	ENDIF
	
	IF NOT mafia_11_flag = 4
		IF NOT mafia_11_flag = 0

			IF mafia_11_flag > 1
			AND mafia_11_kill_player_flag = 0
				SET_CHAR_USE_PEDNODE_SEEK mafia_11X TRUE
				SET_CHAR_OBJ_RUN_TO_COORD mafia_11X 886.0037 -414.0266 // NEAR BOTTOM OF STEPS
				mafia_11_kill_player_flag = 1
			ENDIF

			IF mafia_11_kill_player_flag = 1
				IF LOCATE_CHAR_ON_FOOT_2D mafia_11X	886.0037 -414.0266 1.0 1.0 0 //	NEAR BOTTOM OF STEPS
					SET_CHAR_USE_PEDNODE_SEEK mafia_11X FALSE
					SET_CHAR_OBJ_RUN_TO_COORD mafia_11X 888.8883 -409.8141 // AT BOTTOM OF STEPS
					mafia_11_kill_player_flag = 2
				ENDIF
			ENDIF
			
			IF mafia_11_kill_player_flag = 2
				IF LOCATE_CHAR_ON_FOOT_2D mafia_11X	888.8883 -409.8141 1.0 1.0 0// AT BOTTOM OF STEPS
					SET_CHAR_OBJ_RUN_TO_COORD mafia_11X 880.9434 -409.0293 // ON LANDING
					mafia_11_kill_player_flag = 3
				ENDIF
			ENDIF
			
			IF mafia_11_kill_player_flag = 3
				IF LOCATE_CHAR_ON_FOOT_2D mafia_11X	880.9434 -409.0293 1.0 1.0 0 //	ON LANDING
					SET_CHAR_OBJ_RUN_TO_COORD mafia_11X 880.9827 -406.0733 // ON LANDING
					mafia_11_kill_player_flag = 4
				ENDIF
			ENDIF
			
			IF mafia_11_kill_player_flag = 4
				IF LOCATE_CHAR_ON_FOOT_2D mafia_11X	880.9827 -406.0733 1.0 1.0 0 //	ON LANDING
					SET_CHAR_OBJ_RUN_TO_COORD mafia_11X 892.1010 -406.2053 // ON ROOF TOP OF STAIRS
					mafia_11_kill_player_flag = 5
				ENDIF
			ENDIF
			
			IF mafia_11_kill_player_flag = 5
				IF LOCATE_CHAR_ON_FOOT_2D mafia_11X	892.1010 -406.2053 1.0 1.0 0 // ON ROOF TOP OF STAIRS
					SET_CHAR_OBJ_RUN_TO_COORD mafia_11X 892.2498 -421.2303 // IN MIDDLE OF ROOF
					GIVE_WEAPON_TO_CHAR	mafia_11X WEAPONTYPE_UZI 9999
					mafia_11_kill_player_flag = 6
				ENDIF
			ENDIF
			
			IF mafia_11_kill_player_flag = 6
				IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_11X	892.2498 -421.2303 1.0 1.0 0 // IN MIDDLE OF ROOF
					SET_CHAR_USE_PEDNODE_SEEK mafia_11X TRUE
					SET_CHAR_STAY_IN_SAME_PLACE mafia_11X TRUE
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_11X player
					mafia_11_kill_player_flag = 7
				ENDIF
			ENDIF
			
		ENDIF
	ENDIF
	
	IF NOT mafia_10_flag = 4
		IF NOT mafia_10_flag = 0
			
			IF mafia_10_flag > 1
			AND mafia_10_kill_player_flag = 0
				SET_CHAR_USE_PEDNODE_SEEK mafia_10X TRUE
				SET_CHAR_OBJ_RUN_TO_COORD mafia_10X 886.0037 -414.0266 // NEAR BOTTOM OF STEPS
				mafia_10_kill_player_flag = 1
			ENDIF

			IF mafia_10_kill_player_flag = 1
				IF LOCATE_CHAR_ON_FOOT_2D mafia_10X	886.0037 -414.0266 1.0 1.0 0 //	NEAR BOTTOM OF STEPS
					SET_CHAR_USE_PEDNODE_SEEK mafia_10X FALSE
					SET_CHAR_OBJ_RUN_TO_COORD mafia_10X 888.8883 -409.8141 // AT BOTTOM OF STEPS
					mafia_10_kill_player_flag = 2
				ENDIF
			ENDIF
			
			IF mafia_10_kill_player_flag = 2
				IF LOCATE_CHAR_ON_FOOT_2D mafia_10X	888.8883 -409.8141 1.0 1.0 0// AT BOTTOM OF STEPS
					SET_CHAR_OBJ_RUN_TO_COORD mafia_10X 880.9434 -409.0293 // ON LANDING
					mafia_10_kill_player_flag = 3
				ENDIF
			ENDIF
			
			IF mafia_10_kill_player_flag = 3
				IF LOCATE_CHAR_ON_FOOT_2D mafia_10X	880.9434 -409.0293 1.0 1.0 0 //	ON LANDING
					SET_CHAR_OBJ_RUN_TO_COORD mafia_10X 880.9827 -406.0733 // ON LANDING
					mafia_10_kill_player_flag = 4
				ENDIF
			ENDIF

			IF mafia_10_kill_player_flag = 4
				IF LOCATE_CHAR_ON_FOOT_2D mafia_10X	880.9827 -406.0733 1.0 1.0 0 //	ON LANDING
					SET_CHAR_OBJ_RUN_TO_COORD mafia_10X 892.1010 -406.2053 // ON ROOF TOP OF STAIRS
					GIVE_WEAPON_TO_CHAR	mafia_10X WEAPONTYPE_UZI 9999
					mafia_10_kill_player_flag = 5
				ENDIF
			ENDIF

			IF mafia_10_kill_player_flag = 5
				IF LOCATE_STOPPED_CHAR_ON_FOOT_2D mafia_10X	892.1010 -406.2053 1.0 1.0 0 // ON ROOF TOP OF STAIRS
					SET_CHAR_USE_PEDNODE_SEEK mafia_10X TRUE
					SET_CHAR_STAY_IN_SAME_PLACE mafia_10X TRUE
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_10X player
					mafia_10_kill_player_flag = 6
				ENDIF
			ENDIF

		ENDIF
	ENDIF

	IF NOT mafia_9_flag = 4
		IF NOT mafia_9_flag = 0
			
			IF mafia_9_flag > 1
			AND mafia_9_kill_player_flag = 0
				SET_CHAR_STAY_IN_SAME_PLACE mafia_9X TRUE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_9X player
				mafia_9_kill_player_flag = 1
			ENDIF

		ENDIF
	ENDIF

	IF NOT mafia_8_flag = 4
		IF NOT mafia_8_flag = 0
			
			IF mafia_8_flag > 1
			AND mafia_8_kill_player_flag = 0
				SET_CHAR_STAY_IN_SAME_PLACE mafia_8X TRUE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_8X player
				mafia_8_kill_player_flag = 1
			ENDIF

		ENDIF
	ENDIF

	IF frankie_exists_flag = 0
		IF timerb_reset_flag_a1 = 0
			TIMERB = 0
			timerb_reset_flag_a1 = 1
		ENDIF
		IF timerb_reset_flag_a1 = 1
			IF TIMERB > 30000
				IF time_left_a1 < 1				
					frankie_exists_flag = 2
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
	IF mafia_10_kill_player_flag = 6
	OR mafia_10_flag = 4
		IF mafia_11_kill_player_flag = 7
		OR mafia_11_flag = 4
			IF mafia_12_kill_player_flag = 7
			OR mafia_12_flag = 4
				IF mafia_13_kill_player_flag = 8
				OR mafia_13_flag = 4
					IF time_left_a1 < 1
						IF frankie_exists_flag = 0
							frankie_exists_flag = 2
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
ELSE

	IF NOT mafia_8_flag = 4
		IF NOT mafia_8_flag = 0
			IF mafia_8_kill_player_flag = 1
				SET_CHAR_USE_PEDNODE_SEEK mafia_8X TRUE
				SET_CHAR_STAY_IN_SAME_PLACE mafia_8X FALSE
				mafia_8_kill_player_flag = 0
			ENDIF
		ENDIF
	ENDIF

	IF NOT mafia_9_flag = 4
		IF NOT mafia_9_flag = 0
			IF mafia_9_kill_player_flag = 1
				SET_CHAR_USE_PEDNODE_SEEK mafia_9X TRUE
				SET_CHAR_STAY_IN_SAME_PLACE mafia_9X FALSE
				mafia_9_kill_player_flag = 0
			ENDIF
		ENDIF
	ENDIF

	IF NOT mafia_10_flag = 4
		IF NOT mafia_10_flag = 0
			IF mafia_10_kill_player_flag = 6
				SET_CHAR_USE_PEDNODE_SEEK mafia_10X TRUE
				SET_CHAR_STAY_IN_SAME_PLACE mafia_10X FALSE
				mafia_10_kill_player_flag = 0
			ENDIF
		ENDIF
	ENDIF

	IF NOT mafia_11_flag = 4
		IF NOT mafia_11_flag = 0
			IF mafia_11_kill_player_flag = 7
				SET_CHAR_USE_PEDNODE_SEEK mafia_11X TRUE
				SET_CHAR_STAY_IN_SAME_PLACE mafia_11X FALSE
				mafia_11_kill_player_flag = 0
			ENDIF
		ENDIF
	ENDIF

	IF NOT mafia_12_flag = 4
		IF NOT mafia_12_flag = 0
			IF mafia_12_kill_player_flag = 7
				SET_CHAR_USE_PEDNODE_SEEK mafia_12X TRUE
				SET_CHAR_STAY_IN_SAME_PLACE mafia_12X FALSE
				mafia_12_kill_player_flag = 0
			ENDIF
		ENDIF
	ENDIF

	IF NOT mafia_13_flag = 4
		IF NOT mafia_13_flag = 0
			IF mafia_13_kill_player_flag = 8
				SET_CHAR_USE_PEDNODE_SEEK mafia_13X TRUE
				SET_CHAR_STAY_IN_SAME_PLACE mafia_13X FALSE
				mafia_13_kill_player_flag = 0
			ENDIF
		ENDIF
	ENDIF

ENDIF

IF IS_PLAYER_IN_AREA_2D player 920.0792 -408.8181 931.3213 -398.101 0 //ON TOP OF SNIPER BUILDING OVER ROAD
	
	IF NOT mafia_5_kill_player_flag = -100
		IF NOT IS_CHAR_DEAD	mafia_5X
			IF mafia_5_kill_player_flag = 0
				SET_CHAR_OBJ_RUN_TO_COORD mafia_5X 919.2639 -397.0023 //CORNER OF STREET
				mafia_5_kill_player_flag = 1
			ENDIF
		ELSE
			mafia_5_kill_player_flag = -100
		ENDIF

		IF mafia_5_kill_player_flag = 1
			IF LOCATE_CHAR_ON_FOOT_2D mafia_5X 919.2639 -397.0023 1.0 1.0 0	//CORNER OF STREET
				SET_CHAR_OBJ_RUN_TO_COORD mafia_5X 958.4280 -397.0979 //IN FRONT OF ALLEY
				mafia_5_kill_player_flag = 2
			ENDIF
		ENDIF

		IF mafia_5_kill_player_flag = 2
			IF LOCATE_CHAR_ON_FOOT_2D mafia_5X 958.4280 -397.0979 1.0 1.0 0	//IN FRONT OF ALLEY
				SET_CHAR_USE_PEDNODE_SEEK mafia_5X FALSE
				SET_CHAR_OBJ_RUN_TO_COORD mafia_5X 958.0251 -416.7367 //BOTTOM OF STEPS
				mafia_5_kill_player_flag = 3
			ENDIF
		ENDIF

		IF mafia_5_kill_player_flag = 3
			IF LOCATE_CHAR_ON_FOOT_2D mafia_5X 958.0251 -416.7367 1.0 1.0 0	//BOTTOM OF STEPS
				SET_CHAR_OBJ_RUN_TO_COORD mafia_5X 949.0732 -416.6061 //LANDING ON STEPS
				mafia_5_kill_player_flag = 4
			ENDIF
		ENDIF

		IF mafia_5_kill_player_flag = 4
			IF LOCATE_CHAR_ON_FOOT_2D mafia_5X 949.0732 -416.6061 1.0 1.0 0	//LANDING ON STEPS
				SET_CHAR_OBJ_RUN_TO_COORD mafia_5X 948.9913 -407.5764 //TOP OF STEPS
				mafia_5_kill_player_flag = 5
			ENDIF
		ENDIF

		IF mafia_5_kill_player_flag = 5
			IF LOCATE_CHAR_ON_FOOT_2D mafia_5X 948.9913 -407.5764 1.0 1.0 0 //TOP OF STEPS
				SET_CHAR_OBJ_RUN_TO_COORD mafia_5X 929.8204 -404.7728 //ON THE SNIPER ROOF
				mafia_5_kill_player_flag = 6
			ENDIF
		ENDIF

		IF mafia_5_kill_player_flag = 6
			IF LOCATE_CHAR_ON_FOOT_2D mafia_5X 929.8204 -404.7728 1.0 1.0 0 //ON THE SNIPER ROOF
				SET_CHAR_STAY_IN_SAME_PLACE	mafia_5X TRUE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_5X player
				SET_CHAR_USE_PEDNODE_SEEK mafia_5X TRUE
				mafia_5_kill_player_flag = 7
			ENDIF
		ENDIF
	ENDIF

	IF NOT mafia_7_kill_player_flag = -100
		IF NOT IS_CHAR_DEAD	mafia_7X
			IF mafia_7_kill_player_flag = 0
				SET_CHAR_OBJ_RUN_TO_COORD mafia_7X 919.2639 -397.0023 //CORNER OF STREET
				mafia_7_kill_player_flag = 1
			ENDIF
		ELSE
			mafia_7_kill_player_flag = -100
		ENDIF

		IF mafia_7_kill_player_flag = 1
			IF LOCATE_CHAR_ON_FOOT_2D mafia_7X 919.2639 -397.0023 1.0 1.0 0	//CORNER OF STREET
				SET_CHAR_OBJ_RUN_TO_COORD mafia_7X 958.4280 -397.0979 //IN FRONT OF ALLEY
				mafia_7_kill_player_flag = 2
			ENDIF
		ENDIF

		IF mafia_7_kill_player_flag = 2
			IF LOCATE_CHAR_ON_FOOT_2D mafia_7X 958.4280 -397.0979 1.0 1.0 0	//IN FRONT OF ALLEY
				SET_CHAR_USE_PEDNODE_SEEK mafia_7X FALSE
				SET_CHAR_OBJ_RUN_TO_COORD mafia_7X 958.0251 -416.7367 //BOTTOM OF STEPS
				mafia_7_kill_player_flag = 3
			ENDIF
		ENDIF

		IF mafia_7_kill_player_flag = 3
			IF LOCATE_CHAR_ON_FOOT_2D mafia_7X 958.0251 -416.7367 1.0 1.0 0	//BOTTOM OF STEPS
				SET_CHAR_OBJ_RUN_TO_COORD mafia_7X 949.0732 -416.6061 //LANDING ON STEPS
				mafia_7_kill_player_flag = 4
			ENDIF
		ENDIF

		IF mafia_7_kill_player_flag = 4
			IF LOCATE_CHAR_ON_FOOT_2D mafia_7X 949.0732 -416.6061 1.0 1.0 0	//LANDING ON STEPS
				SET_CHAR_OBJ_RUN_TO_COORD mafia_7X 948.9913 -407.5764 //TOP OF STEPS
				mafia_7_kill_player_flag = 5
			ENDIF
		ENDIF

		IF mafia_7_kill_player_flag = 5
			IF LOCATE_CHAR_ON_FOOT_2D mafia_7X 948.9913 -407.5764 1.0 1.0 0 //TOP OF STEPS
				SET_CHAR_OBJ_RUN_TO_COORD mafia_7X 930.0654 -407.9679 //ON THE SNIPER ROOF
				mafia_7_kill_player_flag = 6
			ENDIF
		ENDIF

		IF mafia_7_kill_player_flag = 6
			IF LOCATE_CHAR_ON_FOOT_2D mafia_7X 930.0654 -407.9679 1.0 1.0 0 //ON THE SNIPER ROOF
				SET_CHAR_STAY_IN_SAME_PLACE	mafia_7X TRUE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_7X player
				SET_CHAR_USE_PEDNODE_SEEK mafia_7X TRUE
				mafia_7_kill_player_flag = 7
			ENDIF
		ENDIF
	ENDIF

	IF mafia_15_kill_player_flag = 0
		IF NOT IS_POINT_ON_SCREEN 949.0732 -416.6061 19.5 2.0 
			CREATE_CHAR PEDTYPE_GANG_MAFIA PED_GANG_MAFIA_B 958.0251 -416.7367 14.2 mafia_15X //BOTTOM OF STEPS	
			SET_CHAR_PERSONALITY mafia_15X PEDSTAT_TOUGH_GUY
			GIVE_WEAPON_TO_CHAR mafia_15X WEAPONTYPE_SHOTGUN 999
			SET_CHAR_USE_PEDNODE_SEEK mafia_15X FALSE
			SET_CHAR_OBJ_GOTO_COORD_ON_FOOT mafia_15X 949.0732 -416.6061 //LANDING ON STEPS
			mafia_15_kill_player_flag = 1
		ENDIF
	ENDIF

	IF NOT mafia_15_kill_player_flag = -100
		
		IF mafia_15_kill_player_flag > 0
			IF IS_CHAR_DEAD	mafia_15X
				mafia_15_kill_player_flag = -100
			ENDIF
		ENDIF

		IF mafia_15_kill_player_flag = 1
			IF LOCATE_CHAR_ON_FOOT_2D mafia_15X	949.0732 -416.6061 1.0 1.0 0 //LANDING ON STEPS
				SET_CHAR_OBJ_RUN_TO_COORD mafia_15X	948.9913 -407.5764 //TOP OF STEPS
				mafia_15_kill_player_flag = 2
			ENDIF
		ENDIF

		IF mafia_15_kill_player_flag = 2
			IF LOCATE_CHAR_ON_FOOT_2D mafia_15X	948.9913 -407.5764 1.0 1.0 0 //TOP OF STEPS
				SET_CHAR_OBJ_RUN_TO_COORD mafia_15X	929.5118 -406.6480 //ON THE SNIPER ROOF
				mafia_15_kill_player_flag = 3
			ENDIF
		ENDIF

		IF mafia_15_kill_player_flag = 3
			IF LOCATE_CHAR_ON_FOOT_2D mafia_15X	929.5118 -406.6480 1.0 1.0 0 //ON THE SNIPER ROOF
				SET_CHAR_STAY_IN_SAME_PLACE	mafia_15X TRUE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_15X player
				SET_CHAR_USE_PEDNODE_SEEK mafia_15X TRUE
				mafia_15_kill_player_flag = 4
			ENDIF
		ENDIF
	ENDIF
			
	IF mafia_15_kill_player_flag = 4
		IF NOT frankie_exists_flag = 0
			frankie_exists_flag = 3
		ENDIF
	ENDIF

	IF mafia_5_kill_player_flag = 7
		IF NOT frankie_exists_flag = 0
			frankie_exists_flag = 3
		ENDIF
	ENDIF

	IF mafia_7_kill_player_flag = 7
		IF NOT frankie_exists_flag = 0
			frankie_exists_flag = 3
		ENDIF
	ENDIF

	IF mafia_5_kill_player_flag = -100
		IF NOT frankie_exists_flag = 0
			frankie_exists_flag = 3
		ENDIF
	ENDIF

	IF mafia_7_kill_player_flag = -100
		IF NOT frankie_exists_flag = 0
			frankie_exists_flag = 3
		ENDIF
	ENDIF

	IF mafia_15_kill_player_flag = -100
		IF NOT frankie_exists_flag = 0
			frankie_exists_flag = 3
		ENDIF
	ENDIF

	IF frankie_exists_flag = 0
		IF timerb_reset_flag_a1 = 0
			TIMERB = 0
			timerb_reset_flag_a1 = 1
		ENDIF
		IF timerb_reset_flag_a1 = 1
			IF TIMERB > 15000
				IF time_left_a1 < 1
					frankie_exists_flag = 3
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
RETURN
ELSE

	IF NOT mafia_5_kill_player_flag = -100
		IF NOT mafia_5_kill_player_flag = 0
			IF NOT IS_CHAR_DEAD	mafia_5X
				SET_CHAR_USE_PEDNODE_SEEK mafia_5X TRUE
				SET_CHAR_STAY_IN_SAME_PLACE mafia_5X FALSE
				mafia_5_kill_player_flag = 0
			ELSE
				mafia_5_kill_player_flag = -100
			ENDIF
		ENDIF
	ENDIF

	IF NOT mafia_7_kill_player_flag = -100
		IF NOT mafia_7_kill_player_flag = 0
			IF NOT IS_CHAR_DEAD	mafia_7X
				SET_CHAR_USE_PEDNODE_SEEK mafia_7X TRUE
				SET_CHAR_STAY_IN_SAME_PLACE mafia_7X FALSE
				mafia_7_kill_player_flag = 0
			ELSE
				mafia_7_kill_player_flag = -100
			ENDIF
		ENDIF
	ENDIF

	IF NOT mafia_15_kill_player_flag = -100
		IF NOT mafia_15_kill_player_flag = 0
			IF NOT IS_CHAR_DEAD	mafia_15X
				SET_CHAR_USE_PEDNODE_SEEK mafia_15X TRUE
				SET_CHAR_STAY_IN_SAME_PLACE mafia_15X FALSE
				mafia_15_kill_player_flag = -100
			ELSE
				mafia_15_kill_player_flag = -100
			ENDIF
		ENDIF
	ENDIF

ENDIF

IF IS_PLAYER_IN_AREA_2D player 878.79 -427.4 890.77 -403.89 0 //BACK OF CLUB
OR IS_PLAYER_IN_AREA_3D player 890.77 -427.4 13.0 900.0 -423.82 18.9 0//ALLEYWAY
OR IS_PLAYER_IN_AREA_2D player 900.0 -443.0 927.0 -378.0 0 //FRONT OF CLUB
	
	IF NOT mafia_8_flag = 4
		IF NOT mafia_8_flag = 0
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_8X player
		ENDIF
	ENDIF

	IF NOT mafia_9_flag = 4
		IF NOT mafia_9_flag = 0
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_9X player
		ENDIF
	ENDIF

	IF NOT mafia_10_flag = 4
		IF NOT mafia_10_flag = 0
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_10X player
		ENDIF
	ENDIF

	IF NOT mafia_11_flag = 4
		IF NOT mafia_11_flag = 0
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_11X player
		ENDIF
	ENDIF

	IF NOT mafia_12_flag = 4
		IF NOT mafia_12_flag = 0
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_12X player
		ENDIF
	ENDIF

	IF NOT mafia_13_flag = 4
		IF NOT mafia_13_flag = 0
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_13X player
		ENDIF
	ENDIF
	
	IF IS_PLAYER_IN_AREA_2D player 900.0 -443.0 927.0 -378.0 0 //FRONT OF CLUB
		IF NOT IS_CHAR_DEAD	mafia_5X
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_5X player
		ENDIF

		IF NOT IS_CHAR_DEAD	mafia_7X
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT mafia_7X player
		ENDIF
	ENDIF

	IF frankie_exists_flag = 0
		IF timerb_reset_flag_a1 = 0
			TIMERB = 0
			timerb_reset_flag_a1 = 1
		ENDIF
		IF timerb_reset_flag_a1 = 1
			IF TIMERB > 25000
				IF time_left_a1 < 1
					frankie_exists_flag = 2
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
RETURN
ENDIF

kill_player_now_flag = 0

RETURN

move_fuckers_car:

SET_CAR_DRIVING_STYLE fuckers_car 2
SET_CAR_CRUISE_SPEED fuckers_car 20.0
IF IS_PLAYER_IN_AREA_2D player 878.79 -427.4 890.77 -403.89 0 //BACK OF CLUB
OR IS_PLAYER_IN_AREA_3D player 890.77 -427.4 13.0 900.0 -423.82 18.9 0//ALLEYWAY
OR IS_PLAYER_IN_AREA_2D player 845.75 -443.85 890.77 -433.86 0 //HIGHER ROOF
OR IS_PLAYER_IN_AREA_2D player 878.79 -433.86 890.77 -427.4 0 //LOWER ROOF
OR IS_PLAYER_IN_AREA_3D player 890.77 -433.71 23.05 900.78 -403.76 46.0 0 //CLUB ROOF
	CAR_WANDER_RANDOMLY fuckers_car
	SET_CAR_AVOID_LEVEL_TRANSITIONS fuckers_car TRUE
ELSE
	SET_CAR_MISSION fuckers_car MISSION_RAMPLAYER_FARAWAY
ENDIF

RETURN

}

MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ****************************************Asuka mission 2********************************** 
// **************************************Sniper Surveillance********************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_asuka2

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_asuka2_failed
ENDIF

GOSUB mission_cleanup_asuka2

MISSION_END
 
// Variables for mission

VAR_INT tail_car_asuka2

VAR_INT blip1_FBI1 blip2_FBI2 blip3_FBI3 blip4_FBI4 blip5_FBI5 blip6_FBI6 blip7_FBI7 blip8_FBI8 blip9_FBI9 blip10_FBI10 blip1_FBI_VAN 

VAR_INT countdown_as2 FBI1health FBI2health FBI3health FBI4health FBI7health FBI8health FBI9health FBI10health

VAR_INT FBI1 FBI2 FBI3 FBI4 FBI5 FBI6 FBI7 FBI8 FBI9 FBI10 FBI_VAN1

VAR_INT sniper_asuka been_damaged_before

VAR_INT number_of_feds_killed fed1_already_dead fed2_already_dead fed3_already_dead fed4_already_dead fed5_already_dead fed6_already_dead 

VAR_INT fed7_already_dead fed8_already_dead fed9_already_dead fed10_already_dead

VAR_INT fedvan1_already_dead fbi_spotted_player fbi_spotted_player2

// ****************************************Mission Start************************************

mission_start_asuka2:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_asuka_mission = 1
SCRIPT_NAME asuka2
WAIT 0

number_of_feds_killed = 0
been_damaged_before = 0
fbi_spotted_player = 0
fbi_spotted_player2 = 0

{

LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 ASUKAH
LOAD_SPECIAL_MODEL cut_obj3 KENJIH
LOAD_SPECIAL_CHARACTER 1 asuka
LOAD_SPECIAL_CHARACTER 2 kenji
REQUEST_MODEL condo_ivy
REQUEST_MODEL kmricndo01


LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED condo_ivy
OR NOT HAS_MODEL_LOADED	kmricndo01
	WAIT 0
ENDWHILE

LOAD_CUTSCENE A3_SS
SET_CUTSCENE_OFFSET 523.102 -636.96 15.616

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_asuka
SET_CUTSCENE_ANIM cs_asuka asuka

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_kenji
SET_CUTSCENE_ANIM cs_kenji kenji

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_asuka CUT_OBJ2 cs_asukahead
SET_CUTSCENE_HEAD_ANIM cs_asukahead asuka

CREATE_CUTSCENE_HEAD cs_kenji CUT_OBJ3 cs_kenjihead
SET_CUTSCENE_HEAD_ANIM cs_kenjihead kenji

CLEAR_AREA 523.6 -639.4 16.6 1.0 TRUE
SET_PLAYER_COORDINATES player 523.6 -639.4 16.0

SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time


WHILE cs_time < 1892
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM2_A ) 10000 1 

WHILE cs_time < 4983
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM2_A2 ) 10000 1 

WHILE cs_time < 8705
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM2_B ) 10000 1 

WHILE cs_time < 10494
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM2_C ) 10000 1 

WHILE cs_time < 16940
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM2_D ) 10000 1 

WHILE cs_time < 22566
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM2_E ) 10000 1 

WHILE cs_time < 26394
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM2_E2 ) 10000 1 

WHILE cs_time < 28456
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM2_F ) 10000 1 

WHILE cs_time < 32144
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM2_G ) 10000 1 

WHILE cs_time < 36663
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 39000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED condo_ivy
MARK_MODEL_AS_NO_LONGER_NEEDED kmricndo01
UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2

REQUEST_MODEL PED_GANG_MAFIA_A
REQUEST_MODEL PED_GANG_MAFIA_B
REQUEST_MODEL CAR_RUMPO
		    
WHILE NOT HAS_MODEL_LOADED PED_GANG_MAFIA_A
OR NOT HAS_MODEL_LOADED PED_GANG_MAFIA_B
OR NOT HAS_MODEL_LOADED CAR_RUMPO
	WAIT 0
ENDWHILE
						  	

// MISSION START

fed1_already_dead = 0
fed2_already_dead = 0
fed3_already_dead = 0
fed4_already_dead = 0
fed5_already_dead = 0
fed6_already_dead = 0
fed7_already_dead = 0
fed8_already_dead = 0
fed9_already_dead = 0
fed10_already_dead = 0
fedvan1_already_dead = 0


//ADD_BLIP_FOR_COORD 430.0 -1448.7 -100.0 blip1_FBI1

countdown_as2 = 391000
DISPLAY_ONSCREEN_TIMER countdown_as2


//FEDS ON TOWER BLOCK*****************************************************************************
   		
CREATE_CHAR PEDTYPE_CIVMALE PED_GANG_MAFIA_A 383.0 -1447.9 51.4 FBI1	//Floor4
SET_CHAR_HEADING FBI1 304.0
SET_CHAR_THREAT_SEARCH FBI1 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR FBI1 WEAPONTYPE_M16 600
SET_CHAR_STAY_IN_SAME_PLACE FBI1 TRUE
SET_CHAR_PERSONALITY FBI1 PEDSTAT_TOUGH_GUY
ADD_BLIP_FOR_CHAR FBI1 blip1_FBI1 
//ADD_ARMOUR_TO_CHAR FBI1 99

CREATE_CHAR PEDTYPE_CIVMALE PED_GANG_MAFIA_B 381.2 -1438.2 63.4 FBI2	//floor6
SET_CHAR_HEADING FBI2 304.0
SET_CHAR_THREAT_SEARCH FBI2 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR FBI2 WEAPONTYPE_M16 600
SET_CHAR_STAY_IN_SAME_PLACE FBI2 TRUE
SET_CHAR_PERSONALITY FBI2 PEDSTAT_TOUGH_GUY
ADD_BLIP_FOR_CHAR FBI2 blip2_FBI2 
//ADD_ARMOUR_TO_CHAR FBI2 99

CREATE_CHAR PEDTYPE_CIVMALE PED_GANG_MAFIA_A 383.5 -1452.3 69.4 FBI3	//floor7
SET_CHAR_HEADING FBI3 304.0
SET_CHAR_THREAT_SEARCH FBI3 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR FBI3 WEAPONTYPE_M16 600
SET_CHAR_STAY_IN_SAME_PLACE FBI3 TRUE
SET_CHAR_PERSONALITY FBI3 PEDSTAT_TOUGH_GUY
ADD_BLIP_FOR_CHAR FBI3 blip3_FBI3
//ADD_ARMOUR_TO_CHAR FBI3 99

CREATE_CHAR PEDTYPE_CIVMALE PED_GANG_MAFIA_B 381.6 -1451.7 57.5 FBI8	//floor5
SET_CHAR_HEADING FBI8 304.0
SET_CHAR_THREAT_SEARCH FBI8 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR FBI8 WEAPONTYPE_M16 600
SET_CHAR_STAY_IN_SAME_PLACE FBI8 TRUE
SET_CHAR_PERSONALITY FBI8 PEDSTAT_TOUGH_GUY
ADD_BLIP_FOR_CHAR FBI8 blip8_FBI8
//ADD_ARMOUR_TO_CHAR FBI8 99

CREATE_CHAR PEDTYPE_CIVMALE PED_GANG_MAFIA_A 381.4 -1443.5 75.5 FBI9	//floor8
SET_CHAR_HEADING FBI9 304.0
SET_CHAR_THREAT_SEARCH FBI9 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR FBI9 WEAPONTYPE_M16 600
SET_CHAR_STAY_IN_SAME_PLACE FBI9 TRUE
SET_CHAR_PERSONALITY FBI9 PEDSTAT_TOUGH_GUY
ADD_BLIP_FOR_CHAR FBI9 blip9_FBI9
//ADD_ARMOUR_TO_CHAR FBI9 99

CREATE_CHAR PEDTYPE_CIVMALE PED_GANG_MAFIA_B 379.0 -1449.6 81.4 FBI10 //floor9 (Top)
SET_CHAR_HEADING FBI10 304.0
SET_CHAR_THREAT_SEARCH FBI10 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR FBI10 WEAPONTYPE_M16 600
SET_CHAR_STAY_IN_SAME_PLACE FBI10 TRUE
SET_CHAR_PERSONALITY FBI10 PEDSTAT_TOUGH_GUY
ADD_BLIP_FOR_CHAR FBI10 blip10_FBI10
//ADD_ARMOUR_TO_CHAR FBI10 99

//FEDS AT PARK**********************************************************************************

CREATE_CHAR PEDTYPE_CIVMALE PED_GANG_MAFIA_A 48.4 -642.8 29.0 FBI4 //Park
SET_CHAR_HEADING FBI4 169.0
SET_CHAR_THREAT_SEARCH FBI4 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR FBI4 WEAPONTYPE_CHAINGUN 100
SET_CHAR_STAY_IN_SAME_PLACE FBI4 TRUE
SET_CHAR_PERSONALITY FBI4 PEDSTAT_TOUGH_GUY
ADD_BLIP_FOR_CHAR FBI4 blip4_FBI4
//ADD_ARMOUR_TO_CHAR FBI4 99

CREATE_CHAR PEDTYPE_CIVMALE PED_GANG_MAFIA_B 42.2 -641.3 27.8 FBI7 //Park
SET_CHAR_HEADING FBI7 208.0
SET_CHAR_THREAT_SEARCH FBI7 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR FBI7 WEAPONTYPE_CHAINGUN 100
SET_CHAR_STAY_IN_SAME_PLACE FBI7 TRUE
SET_CHAR_PERSONALITY FBI7 PEDSTAT_TOUGH_GUY
ADD_BLIP_FOR_CHAR FBI7 blip7_FBI7
//ADD_ARMOUR_TO_CHAR FBI7 99

//FEDS IN VAN**********************************************************************************

CREATE_CAR CAR_RUMPO 61.3 -1389.4 26.3 FBI_VAN1
CHANGE_CAR_COLOUR FBI_VAN1 CARCOLOUR_BLACK CARCOLOUR_BLACK
SET_CAR_ONLY_DAMAGED_BY_PLAYER FBI_VAN1 True
LOCK_CAR_DOORS FBI_VAN1 CARLOCK_LOCKED
SET_CAR_HEADING FBI_VAN1 151.0
	CREATE_CHAR_INSIDE_CAR FBI_VAN1 PEDTYPE_CIVMALE PED_GANG_MAFIA_A FBI5
	ADD_BLIP_FOR_CHAR FBI5 blip5_FBI5
	CREATE_CHAR_AS_PASSENGER FBI_VAN1 PEDTYPE_CIVMALE PED_GANG_MAFIA_B 2 FBI6
	ADD_BLIP_FOR_CHAR FBI6 blip6_FBI6
	CAR_SET_IDLE FBI_VAN1         
	SET_CHAR_THREAT_SEARCH FBI5 THREAT_PLAYER1
	SET_CHAR_THREAT_SEARCH FBI6 THREAT_PLAYER1
	SET_CHAR_PERSONALITY FBI5 PEDSTAT_TOUGH_GUY
	SET_CHAR_PERSONALITY FBI6 PEDSTAT_TOUGH_GUY
	GIVE_WEAPON_TO_CHAR FBI5 WEAPONTYPE_CHAINGUN 100
	GIVE_WEAPON_TO_CHAR FBI6 WEAPONTYPE_CHAINGUN 100

	/*
	LOAD_MISSION_AUDIO A3_A

	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE
	*/

WHILE NOT number_of_feds_killed = 10
 
	WAIT 0

	IF IS_CHAR_DEAD FBI1
	AND fed1_already_dead = 0
		REMOVE_BLIP blip1_FBI1
		number_of_feds_killed ++
		fed1_already_dead = 1	
	ENDIF

	IF IS_CHAR_DEAD FBI2
	AND fed2_already_dead = 0
		REMOVE_BLIP blip2_FBI2
		number_of_feds_killed ++
		fed2_already_dead = 1	
	ENDIF

	IF IS_CHAR_DEAD FBI3
	AND fed3_already_dead = 0
		REMOVE_BLIP blip3_FBI3
		number_of_feds_killed ++
		fed3_already_dead = 1	
	ENDIF

	IF IS_CHAR_DEAD FBI4
	AND fed4_already_dead = 0
		REMOVE_BLIP blip4_FBI4
		number_of_feds_killed ++
		fed4_already_dead = 1	
	ENDIF

	IF IS_CHAR_DEAD FBI5
	AND fed5_already_dead = 0
		REMOVE_BLIP blip5_FBI5
		number_of_feds_killed ++
		fed5_already_dead = 1	
	ENDIF

	IF IS_CHAR_DEAD FBI6
	AND fed6_already_dead = 0
		REMOVE_BLIP blip6_FBI6
		number_of_feds_killed ++
		fed6_already_dead = 1	
	ENDIF

	IF IS_CHAR_DEAD FBI7
	AND fed7_already_dead = 0
		REMOVE_BLIP blip7_FBI7
		number_of_feds_killed ++
		fed7_already_dead = 1	
	ENDIF

	IF IS_CHAR_DEAD FBI8
	AND fed8_already_dead = 0
		REMOVE_BLIP blip8_FBI8
		number_of_feds_killed ++
		fed8_already_dead = 1	
	ENDIF

	IF IS_CHAR_DEAD FBI9
	AND fed9_already_dead = 0
		REMOVE_BLIP blip9_FBI9
		number_of_feds_killed ++
		fed9_already_dead = 1	
	ENDIF

	IF IS_CHAR_DEAD FBI10
	AND fed10_already_dead = 0
		REMOVE_BLIP blip10_FBI10
		number_of_feds_killed ++
		fed10_already_dead = 1	
	ENDIF

	//CHECK PED HEALTH
	IF NOT IS_CHAR_DEAD FBI1
		GET_CHAR_HEALTH FBI1 FBI1health
	ENDIF
	IF NOT IS_CHAR_DEAD	FBI2
		GET_CHAR_HEALTH FBI2 FBI2health
	ENDIF
	IF NOT IS_CHAR_DEAD	FBI3
		GET_CHAR_HEALTH FBI3 FBI3health
	ENDIF
	IF NOT IS_CHAR_DEAD	FBI4
		GET_CHAR_HEALTH FBI4 FBI4health
	ENDIF
	IF NOT IS_CHAR_DEAD	FBI7
		GET_CHAR_HEALTH FBI7 FBI7health
	ENDIF
	IF NOT IS_CHAR_DEAD	FBI8
		GET_CHAR_HEALTH FBI8 FBI8health
	ENDIF
	IF NOT IS_CHAR_DEAD	FBI9
		GET_CHAR_HEALTH FBI9 FBI9health
	ENDIF
	IF NOT IS_CHAR_DEAD	FBI10
		GET_CHAR_HEALTH FBI10 FBI10health
	ENDIF


	//PARK
	IF FBI4health < 100
	OR FBI7health <	100

		IF fbi_spotted_player2 = 0

		IF NOT IS_CHAR_DEAD FBI4
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI4 Player
			SET_CHAR_ACCURACY FBI4 70
		ENDIF
		IF NOT IS_CHAR_DEAD FBI7
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI7 Player
			SET_CHAR_ACCURACY FBI7 70
		ENDIF

			fbi_spotted_player2 = 1

		ENDIF

	ENDIF

	//PARK
	IF IS_CHAR_DEAD FBI4
	OR IS_CHAR_DEAD FBI7

		IF fbi_spotted_player2 = 0

			IF NOT IS_CHAR_DEAD FBI4
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI4 Player
				SET_CHAR_ACCURACY FBI4 70
			ENDIF
			IF NOT IS_CHAR_DEAD FBI7
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI7 Player
				SET_CHAR_ACCURACY FBI7 70
			ENDIF

			fbi_spotted_player2 = 1

		ENDIF

	ENDIF


	//ROOFTOP
	IF FBI1health < 100
	OR FBI2health <	100
	OR FBI3health <	100
	OR FBI8health <	100
	OR FBI9health <	100
	OR FBI10health < 100

		IF fbi_spotted_player = 0

			//PLAY_MISSION_AUDIO

			IF NOT IS_CHAR_DEAD FBI1
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI1 Player
				SET_CHAR_ACCURACY FBI1 50
			ENDIF

			IF NOT IS_CHAR_DEAD FBI2
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI2 Player
				SET_CHAR_ACCURACY FBI2 50
			ENDIF

			IF NOT IS_CHAR_DEAD FBI3
	 				WAIT 500
				IF NOT IS_CHAR_DEAD FBI3
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI3 Player
					SET_CHAR_ACCURACY FBI3 50
				ENDIF
			ENDIF

			IF NOT IS_CHAR_DEAD FBI8
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI8 Player
				SET_CHAR_ACCURACY FBI8 50
			ENDIF

			IF NOT IS_CHAR_DEAD FBI9
					WAIT 1000
				IF NOT IS_CHAR_DEAD FBI9
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI9 Player
					SET_CHAR_ACCURACY FBI9 50
				ENDIF
			ENDIF

			IF NOT IS_CHAR_DEAD FBI10
					WAIT 1000
				IF NOT IS_CHAR_DEAD FBI10
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI10 Player
					SET_CHAR_ACCURACY FBI10 70
				ENDIF
			ENDIF

			fbi_spotted_player = 1

		ENDIF

	ENDIF

	//ROOFTOP
	IF IS_CHAR_DEAD FBI1
	OR IS_CHAR_DEAD FBI2
	OR IS_CHAR_DEAD FBI3
	OR IS_CHAR_DEAD FBI8
	OR IS_CHAR_DEAD FBI9
	OR IS_CHAR_DEAD FBI10

		IF fbi_spotted_player = 0

			//PLAY_MISSION_AUDIO

			IF NOT IS_CHAR_DEAD FBI1
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI1 Player
				SET_CHAR_ACCURACY FBI1 40
			ENDIF

			IF NOT IS_CHAR_DEAD FBI2
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI2 Player
				SET_CHAR_ACCURACY FBI2 40
			ENDIF

			IF NOT IS_CHAR_DEAD FBI3
	 				WAIT 500
				IF NOT IS_CHAR_DEAD FBI3
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI3 Player
					SET_CHAR_ACCURACY FBI3 50
				ENDIF
			ENDIF

			IF NOT IS_CHAR_DEAD FBI8
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI8 Player
				SET_CHAR_ACCURACY FBI8 40
			ENDIF

			IF NOT IS_CHAR_DEAD FBI9
					WAIT 1000
				IF NOT IS_CHAR_DEAD FBI9
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI9 Player
					SET_CHAR_ACCURACY FBI9 50
				ENDIF
			ENDIF

			IF NOT IS_CHAR_DEAD FBI10
					WAIT 1000
				IF NOT IS_CHAR_DEAD FBI10
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT FBI10 Player
					SET_CHAR_ACCURACY FBI10 70
				ENDIF
			ENDIF


			fbi_spotted_player = 1

		ENDIF

	ENDIF

	IF NOT IS_CAR_DEAD FBI_VAN1
		IF NOT IS_CAR_HEALTH_GREATER FBI_VAN1 999
		AND been_damaged_before = 0
			IF NOT IS_CHAR_DEAD FBI5
			AND NOT IS_CHAR_DEAD FBI6 
				SET_CAR_ONLY_DAMAGED_BY_PLAYER FBI_VAN1 false
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS FBI5 Player
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS FBI6 Player
				LOCK_CAR_DOORS FBI_VAN1 CARLOCK_UNLOCKED
				been_damaged_before = 1
			ENDIF
		ENDIF
	ENDIF

	IF countdown_as2 = 0
		GOTO mission_asuka2_failed	
	ENDIF 

ENDWHILE

}

GOTO mission_asuka2_passed 


// Mission asuka2 failed

mission_asuka2_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission asuka2 passed

mission_asuka2_passed:

flag_asuka_mission2_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 15000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 15000
REGISTER_MISSION_PASSED	AM2
PLAYER_MADE_PROGRESS 1
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 459.1 -1413.0 26.1 RADAR_SPRITE_KENJI kenji_contact_blip //TEST STUFF
REMOVE_BLIP com_ammu_nation2
REMOVE_BLIP com_sprayshop2
START_NEW_SCRIPT asuka_mission3_loop
START_NEW_SCRIPT kenji_mission1_loop
RETURN
		


// mission cleanup

mission_cleanup_asuka2:

flag_player_on_mission = 0
flag_player_on_asuka_mission = 0
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_MAFIA_B
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_RUMPO
REMOVE_BLIP blip1_FBI1
REMOVE_BLIP blip2_FBI2
REMOVE_BLIP blip3_FBI3
REMOVE_BLIP blip4_FBI4
REMOVE_BLIP blip5_FBI5
REMOVE_BLIP blip6_FBI6
REMOVE_BLIP blip7_FBI7
REMOVE_BLIP blip8_FBI8
REMOVE_BLIP blip9_FBI9
REMOVE_BLIP blip10_FBI10
CLEAR_ONSCREEN_TIMER countdown_as2
MISSION_HAS_FINISHED
RETURN
		


MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *************************************Asuka mission 3************************************* 
// *************************************Boat Spy thing**************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_asuka3

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_asuka3_failed
ENDIF
										  
GOSUB mission_cleanup_asuka3

MISSION_END
 
// Variables for mission

VAR_INT blip1_as3 blip2_as3 cop_boat been_in_cop_boat_before  
VAR_INT spy_boat spy_bloke spy_car 
VAR_INT spy_blokes_car asuka_boat
VAR_INT boat_coord_number boat_health boat_health2
VAR_INT help1_displayed help2_displayed
// ****************************************Mission Start************************************

mission_start_asuka3:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_asuka_mission = 1
help1_displayed = 0
help2_displayed = 0
SCRIPT_NAME asuka3
WAIT 0

been_in_cop_boat_before = 0

{

LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2	NOTE
REQUEST_MODEL PED_MALE1
REQUEST_MODEL BOAT_REEFER
REQUEST_MODEL BOAT_SPEEDER
REQUEST_MODEL BOAT_PREDATOR
REQUEST_MODEL CAR_STALLION
REQUEST_MODEL condo_ivy
REQUEST_MODEL kmricndo01

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED condo_ivy
OR NOT HAS_MODEL_LOADED	kmricndo01
	WAIT 0

ENDWHILE

LOAD_CUTSCENE A2_PP
SET_CUTSCENE_OFFSET 523.102 -636.96 15.616

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_OBJECT cut_obj2 cs_note
SET_CUTSCENE_ANIM cs_note NOTE

CLEAR_AREA 523.6 -639.4 16.6 1.0 TRUE
SET_PLAYER_COORDINATES player 523.6 -639.4 16.0

SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time


WHILE cs_time < 3406
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM3_A ) 10000 1 

WHILE cs_time < 5677
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM3_B ) 10000 1 

WHILE cs_time < 11354
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM3_C ) 10000 1 

WHILE cs_time < 16000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 1000

DO_FADE 1500 FADE_IN

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED condo_ivy
MARK_MODEL_AS_NO_LONGER_NEEDED kmricndo01

WHILE NOT HAS_MODEL_LOADED PED_MALE1
OR NOT HAS_MODEL_LOADED BOAT_SPEEDER
OR NOT HAS_MODEL_LOADED CAR_STALLION
OR NOT HAS_MODEL_LOADED BOAT_PREDATOR
OR NOT HAS_MODEL_LOADED BOAT_REEFER 
	WAIT 0
ENDWHILE

CLEAR_AREA 640.0 -608.0 0.0 6.0 TRUE
CREATE_CAR BOAT_SPEEDER 612.0 -597.0 0.0 spy_boat
SET_CAR_HEADING spy_boat 0.0
SET_CAR_ONLY_DAMAGED_BY_PLAYER spy_boat TRUE
SET_CAR_HEALTH spy_boat 1500
SET_CAR_STRONG spy_boat TRUE

CREATE_CHAR_INSIDE_CAR spy_boat PEDTYPE_CIVMALE PED_MALE1 spy_bloke

CLEAR_AREA 568.0 -686.0 0.0 6.0 TRUE
CREATE_CAR BOAT_REEFER 568.0 -686.0 0.0 asuka_boat
SET_CAR_HEADING asuka_boat 180.0

CLEAR_AREA 554.8 -767.6 0.0 6.0 TRUE
CREATE_CAR BOAT_PREDATOR 556.562500 -658.062500 0.0 cop_boat
SET_CAR_HEADING cop_boat 0.000000
ADD_BLIP_FOR_CAR cop_boat blip1_as3	


// START MISSION			

IF NOT IS_CHAR_DEAD spy_bloke 
	ADD_BLIP_FOR_CHAR spy_bloke blip2_as3
	CHANGE_BLIP_DISPLAY blip2_as3 MARKER_ONLY	
ENDIF

WAIT 1500

SET_PLAYER_CONTROL Player OFF
SWITCH_WIDESCREEN ON

SET_FIXED_CAMERA_POSITION 526.0 -643.3 19.6 0.0 0.0 0.0

IF NOT IS_CAR_DEAD spy_boat
	POINT_CAMERA_AT_CAR spy_boat FIXED JUMP_CUT
ENDIF

WAIT 3000

SET_PLAYER_CONTROL Player ON
SWITCH_WIDESCREEN OFF
RESTORE_CAMERA


IF NOT IS_CAR_DEAD spy_boat 
	GET_CAR_HEALTH spy_boat boat_health
	DISPLAY_ONSCREEN_COUNTER_WITH_STRING boat_health COUNTER_DISPLAY_BAR (DAM)
	GOSUB boat_health
ENDIF
	
TIMERB = 0

	WHILE NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 55.0 55.0 FALSE
	AND IS_CAR_HEALTH_GREATER spy_boat 1499
		WAIT 0
			
		IF help1_displayed = 0		
			IF TIMERB > 4000
				PRINT_HELP BOATIN1 
				help1_displayed = 1
			ENDIF
		ENDIF

		IF help2_displayed = 0
			IF TIMERB > 11000
				PRINT_HELP BOATIN2
				help2_displayed = 1
			ENDIF
		ENDIF
	
		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE



IF NOT IS_CAR_DEAD spy_boat
	SET_CAR_ONLY_DAMAGED_BY_PLAYER spy_boat FALSE 
	SET_BOAT_CRUISE_SPEED spy_boat 48.0
ENDIF



WAIT 0
//LOCATION1
IF NOT IS_CAR_DEAD spy_boat 
	BOAT_GOTO_COORDS spy_boat 744.8 -350.1 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 744.8 -350.1 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION2
IF NOT IS_CAR_DEAD spy_boat 
	BOAT_GOTO_COORDS spy_boat 728.9 -133.7 0.0
	SET_BOAT_CRUISE_SPEED spy_boat 45.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 728.9 -133.7 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION3
IF NOT IS_CAR_DEAD spy_boat 
	BOAT_GOTO_COORDS spy_boat 635.5 24.7 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 635.5 24.7 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION4
IF NOT IS_CAR_DEAD spy_boat 
	BOAT_GOTO_COORDS spy_boat 746.6 252.9 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 746.6 252.9 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION5
IF NOT IS_CAR_DEAD spy_boat 
	BOAT_GOTO_COORDS spy_boat 872.1 335.9 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 872.1 335.9 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION6
IF NOT IS_CAR_DEAD spy_boat 
	BOAT_GOTO_COORDS spy_boat 1064.5 180.8 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 1064.5 180.8 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION7
IF NOT IS_CAR_DEAD spy_boat 
	BOAT_GOTO_COORDS spy_boat 1262.0 166.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 1262.0 166.0 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION8
IF NOT IS_CAR_DEAD spy_boat 
	BOAT_GOTO_COORDS spy_boat 1566.0 52.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 1566.0 52.0 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION9
IF NOT IS_CAR_DEAD spy_boat 	
	BOAT_GOTO_COORDS spy_boat 1595.0 -154.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 1595.0 -154.0 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION10
IF NOT IS_CAR_DEAD spy_boat 	
	BOAT_GOTO_COORDS spy_boat 1555.0 -299.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 1555.0 -299.0 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF


		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION11
IF NOT IS_CAR_DEAD spy_boat 	
	BOAT_GOTO_COORDS spy_boat 1617.0 -600.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 1617.0 -600.0 0.0 5.0 5.0 5.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF


		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

	   	IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION12
IF NOT IS_CAR_DEAD spy_boat 	
	BOAT_GOTO_COORDS spy_boat 1617.0 -762.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 1617.0 -762.0 0.0 5.0 5.0 5.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION13
IF NOT IS_CAR_DEAD spy_boat 	
	BOAT_GOTO_COORDS spy_boat 1637.0 -950.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 1637.0 -950.0 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION14
IF NOT IS_CAR_DEAD spy_boat 	
	BOAT_GOTO_COORDS spy_boat 1535.0 -1173.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 1535.0 -1173.0 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION15
IF NOT IS_CAR_DEAD spy_boat 	
	BOAT_GOTO_COORDS spy_boat 1268.0 -1273.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 1268.0 -1273.0 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF


		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION16
IF NOT IS_CAR_DEAD spy_boat 	
	BOAT_GOTO_COORDS spy_boat 938.1 -1226.4 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 938.1 -1226.4 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF


		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION17
IF NOT IS_CAR_DEAD spy_boat
	SET_BOAT_CRUISE_SPEED spy_boat 45.0
	BOAT_GOTO_COORDS spy_boat 618.0 -1083.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 618.0 -1083.0 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION18
IF NOT IS_CAR_DEAD spy_boat
	SET_BOAT_CRUISE_SPEED spy_boat 35.0
	BOAT_GOTO_COORDS spy_boat 560.0 -899.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 560.0 -899.0 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

//LOCATION19
IF NOT IS_CAR_DEAD spy_boat
	SET_BOAT_CRUISE_SPEED spy_boat 20.0
	BOAT_GOTO_COORDS spy_boat 548.0 -795.0 0.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_boat 548.0 -795.0 0.0 6.0 6.0 6.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_boat
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CAR_DEAD spy_boat
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_boat 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_boat
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_boat 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead
										   
		IF NOT IS_CAR_DEAD spy_boat
			GOSUB boat_health
		ENDIF

	ENDWHILE

WAIT 1000

IF NOT IS_CAR_DEAD spy_boat
AND NOT IS_CHAR_DEAD spy_bloke 	
	BOAT_STOP spy_boat
	ANCHOR_BOAT spy_boat TRUE
	WARP_CHAR_FROM_CAR_TO_COORD spy_bloke 547.3 -778.4 -100.0
	CLEAR_ONSCREEN_COUNTER boat_health	
ENDIF

CREATE_CAR CAR_STALLION 499.7 -734.4 -100.0 spy_car
SET_CAR_HEADING spy_car 90.0

SET_CHAR_RUNNING spy_bloke TRUE
SET_CHAR_OBJ_RUN_TO_COORD spy_bloke 510.0 -775.6

WHILE NOT IS_CHAR_OBJECTIVE_PASSED spy_bloke
	WAIT 0

		IF IS_CHAR_DEAD spy_bloke
			GOTO mission_asuka3_passed
		ENDIF

		GOSUB check_boats_dead

ENDWHILE

SET_CHAR_OBJ_RUN_TO_COORD spy_bloke 505.2 -751.1

WHILE NOT IS_CHAR_OBJECTIVE_PASSED spy_bloke
	WAIT 0

		IF IS_CHAR_DEAD spy_bloke
			GOTO mission_asuka3_passed
		ENDIF

		GOSUB check_boats_dead

ENDWHILE

SET_CHAR_OBJ_RUN_TO_COORD spy_bloke 501.1 -749.5

WHILE NOT IS_CHAR_OBJECTIVE_PASSED spy_bloke
	WAIT 0

		IF IS_CHAR_DEAD spy_bloke
			GOTO mission_asuka3_passed
		ENDIF

		GOSUB check_boats_dead

ENDWHILE


IF NOT IS_CAR_DEAD spy_car
	SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER spy_bloke spy_car
ENDIF

WHILE NOT IS_CHAR_IN_CAR spy_bloke spy_car
	WAIT 0

		IF IS_CHAR_DEAD spy_bloke
			GOTO mission_asuka3_passed
		ENDIF

		IF IS_CAR_DEAD spy_car
		AND NOT IS_CHAR_DEAD spy_bloke
			GOTO is_he_dead_yet
		ENDIF

		GOSUB check_boats_dead

ENDWHILE


IF NOT IS_CAR_DEAD spy_car
	CAR_GOTO_COORDINATES_ACCURATE spy_car 463.0 -727.4 16.1
	SET_CAR_MISSION spy_car MISSION_GOTOCOORDS_STRAIGHT_ACCURATE
   	SET_CAR_DRIVING_STYLE spy_car 1
	SET_CAR_CRUISE_SPEED spy_car 15.0
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_car 463.0 -727.4 16.1 3.0 3.0 3.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_car
		 	GOTO mission_asuka3_passed
		ENDIF

		IF IS_CHAR_DEAD spy_bloke
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CHAR_IN_CAR spy_bloke spy_car
			GOTO is_he_dead_yet	
		ENDIF

		IF NOT IS_CAR_DEAD spy_car
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_car 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_car
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_car 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead
	
	ENDWHILE

IF NOT IS_CAR_DEAD spy_car
	CAR_GOTO_COORDINATES_ACCURATE spy_car 456.0 -707.1 16.0
	SET_CAR_MISSION spy_car MISSION_GOTOCOORDS_STRAIGHT_ACCURATE 
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_car 456.0 -707.1 16.0 3.0 3.0 3.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_car
		 	GOTO mission_asuka3_passed
		ENDIF

		IF IS_CHAR_DEAD spy_bloke
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CHAR_IN_CAR spy_bloke spy_car
			GOTO is_he_dead_yet	
		ENDIF

		IF NOT IS_CAR_DEAD spy_car
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_car 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_car
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_car 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

	ENDWHILE


IF NOT IS_CAR_DEAD spy_car
	CAR_GOTO_COORDINATES_ACCURATE spy_car 459.0 -678.1 16.0
	SET_CAR_MISSION spy_car MISSION_GOTOCOORDS_STRAIGHT_ACCURATE 
ENDIF

	WHILE NOT LOCATE_CAR_3D spy_car 459.0 -678.1 16.0 3.0 3.0 3.0 FALSE
		WAIT 0

		IF IS_CAR_DEAD spy_car
		 	GOTO mission_asuka3_passed
		ENDIF
							  
		IF IS_CHAR_DEAD spy_bloke
		 	GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CHAR_IN_CAR spy_bloke spy_car
			GOTO is_he_dead_yet	
		ENDIF

		IF NOT IS_CAR_DEAD spy_car
			IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D Player spy_car 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CAR_DEAD spy_car
				AND NOT IS_CHAR_DEAD spy_bloke
					DELETE_CAR spy_car 
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

	ENDWHILE


IF NOT IS_CAR_DEAD spy_car
	CAR_WANDER_RANDOMLY spy_car
	SET_CAR_DRIVING_STYLE spy_car 2
	SET_CAR_CRUISE_SPEED spy_car 25.0
ENDIF

WHILE NOT IS_CHAR_DEAD spy_bloke
	WAIT 0

		IF NOT IS_CHAR_DEAD spy_bloke
			IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player spy_bloke 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CHAR_DEAD spy_bloke
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		IF IS_CAR_DEAD spy_car
			GOTO mission_asuka3_passed
		ENDIF

		IF NOT IS_CHAR_IN_CAR spy_bloke spy_car
			GOTO is_he_dead_yet	
		ENDIF

		GOSUB check_boats_dead

ENDWHILE


is_he_dead_yet:

SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS spy_bloke Player


WHILE NOT IS_CHAR_DEAD spy_bloke
	WAIT 0

		IF NOT IS_CHAR_DEAD spy_bloke
			IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D Player spy_bloke 160.0 160.0 FALSE
				PRINT_NOW ( AWAY ) 5000 2 // Mission brief
				IF NOT IS_CHAR_DEAD spy_bloke
					DELETE_CHAR	spy_bloke
				ENDIF
				GOTO mission_asuka3_failed
			ENDIF
		ENDIF

		GOSUB check_boats_dead

ENDWHILE


GOTO mission_asuka3_passed

}	   		


// Mission asuka3 failed

mission_asuka3_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission asuka3 passed

mission_asuka3_passed:

CLEAR_ONSCREEN_COUNTER boat_health
flag_asuka_mission3_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 10000
REGISTER_MISSION_PASSED	AM3
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT asuka_mission4_loop
RETURN
		


// mission cleanup

mission_cleanup_asuka3:

flag_player_on_mission = 0
flag_player_on_asuka_mission = 0
REMOVE_BLIP blip1_as3
REMOVE_BLIP blip2_as3
MARK_MODEL_AS_NO_LONGER_NEEDED PED_MALE1
MARK_MODEL_AS_NO_LONGER_NEEDED BOAT_SPEEDER
MARK_MODEL_AS_NO_LONGER_NEEDED BOAT_REEFER
MARK_MODEL_AS_NO_LONGER_NEEDED BOAT_PREDATOR
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STALLION
CLEAR_ONSCREEN_COUNTER boat_health
MISSION_HAS_FINISHED
RETURN



boat_health:
{
	GET_CAR_HEALTH spy_boat boat_health
	
	boat_health2 = 1500 - boat_health

	IF boat_health2 > 1500
   		boat_health2 = 1500
	ENDIF

	boat_health = boat_health2 / 15

RETURN

}


check_boats_dead:
{
	IF NOT IS_CAR_DEAD cop_boat
		IF IS_PLAYER_IN_CAR	player cop_boat
		AND been_in_cop_boat_before = 0
			PRINT_HELP PBOAT_1
			REMOVE_BLIP blip1_as3 
			been_in_cop_boat_before = 1
		ENDIF
	ELSE
		IF been_in_cop_boat_before = 0
			REMOVE_BLIP blip1_as3
			been_in_cop_boat_before = 1
		ENDIF
	ENDIF

RETURN
}
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************asuka mission 4******************************** 
// ******************************************Pay day for Ray********************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_asuka4

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_asuka4_failed
ENDIF

GOSUB mission_cleanup_asuka4

MISSION_END
 
// Variables for mission

VAR_INT blip1_as4 timer_frozen

VAR_INT countdown_as4 phone_1_obj phone_2_obj phone_3_obj phone_4_obj


// ****************************************Mission Start************************************

mission_start_asuka4:

REGISTER_MISSION_GIVEN

DISPLAY_RADAR 4 // HACKED RADAR STOP AT STREET

flag_player_on_mission = 1
flag_player_on_asuka_mission = 1
SCRIPT_NAME asuka4
WAIT 0


{

LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 ASUKAH
LOAD_SPECIAL_MODEL cut_obj3	minnote
LOAD_SPECIAL_CHARACTER 1 asuka
REQUEST_MODEL condo_ivy
REQUEST_MODEL kmricndo01


LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3 
	WAIT 0

ENDWHILE

WHILE NOT HAS_MODEL_LOADED condo_ivy
OR NOT HAS_MODEL_LOADED	kmricndo01
	WAIT 0

ENDWHILE

LOAD_CUTSCENE A4_PDR
SET_CUTSCENE_OFFSET 523.102 -636.96 15.616

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_asuka
SET_CUTSCENE_ANIM cs_asuka asuka

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_asuka CUT_OBJ2 cs_asukahead
SET_CUTSCENE_HEAD_ANIM cs_asukahead asuka

CREATE_CUTSCENE_OBJECT cut_obj3 cs_note
SET_CUTSCENE_ANIM cs_note minnote

CLEAR_AREA 523.6 -639.4 16.6 1.0 TRUE
SET_PLAYER_COORDINATES player 523.6 -639.4 16.0

SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time


WHILE cs_time < 805
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_A ) 10000 1 

WHILE cs_time < 3370
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_B ) 10000 1 

WHILE cs_time < 6758
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_C ) 10000 1 

WHILE cs_time < 12673
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_D ) 10000 1 

WHILE cs_time < 15481
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_E ) 10000 1 

WHILE cs_time < 18606
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_F ) 10000 1 

WHILE cs_time < 21381
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_G ) 10000 1 

WHILE cs_time < 25955
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 29333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED condo_ivy
MARK_MODEL_AS_NO_LONGER_NEEDED kmricndo01
UNLOAD_SPECIAL_CHARACTER 1
    
//GOTO skip_to_ray_cut //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// MISSION START

CREATE_OBJECT_NO_OFFSET faketarget 229.2 -1537.6 26.0 phone_1_obj
DONT_REMOVE_OBJECT phone_1_obj

CREATE_OBJECT_NO_OFFSET faketarget -53.5 -699.1 26.0 phone_2_obj
DONT_REMOVE_OBJECT phone_2_obj

CREATE_OBJECT_NO_OFFSET faketarget 204.8 -135.0 16.0 phone_3_obj
DONT_REMOVE_OBJECT phone_3_obj

CREATE_OBJECT_NO_OFFSET faketarget 60.3 -964.8 26.1 phone_4_obj
DONT_REMOVE_OBJECT phone_4_obj

	countdown_as4 = 241000
	DISPLAY_ONSCREEN_TIMER countdown_as4
	ADD_BLIP_FOR_OBJECT phone_1_obj blip1_as4
	SET_PHONE_MESSAGE Ray_phone1 ( AM4_1A )
	LOAD_MISSION_AUDIO A4_A

WHILE NOT LOCATE_PLAYER_ON_FOOT_3D Player 229.2 -1537.6 26.0 1.0 1.0 3.0 FALSE //PHONE1
OR NOT IS_PLAYER_LIFTING_A_PHONE player
	WAIT 0

	IF countdown_as4 = 0
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_asuka4_failed		 
	ENDIF

ENDWHILE

	SET_POLICE_IGNORE_PLAYER Player On
	SET_EVERYONE_IGNORE_PLAYER Player On
	FREEZE_ONSCREEN_TIMER TRUE
	SET_FIXED_CAMERA_POSITION 214.844 -1549.911 32.448 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT 215.507 -1549.246 32.105 JUMP_CUT

WHILE NOT IS_PHONE_DISPLAYING_MESSAGE Ray_phone1
	WAIT 0

ENDWHILE

	PLAY_MISSION_AUDIO

WHILE IS_PLAYER_LIFTING_A_PHONE player
	WAIT 0

ENDWHILE

	RESTORE_CAMERA_JUMPCUT
	FREEZE_ONSCREEN_TIMER FALSE
	REMOVE_BLIP blip1_as4
	ADD_BLIP_FOR_OBJECT phone_2_obj blip1_as4
	SET_PHONE_MESSAGE Ray_phone2 ( AM4_1B )
	SET_POLICE_IGNORE_PLAYER Player off
	SET_EVERYONE_IGNORE_PLAYER Player off

	LOAD_MISSION_AUDIO A4_B

WHILE NOT LOCATE_PLAYER_ON_FOOT_3D Player -53.5 -699.1 26.0 1.0 1.0 3.0 FALSE //PHONE2
OR NOT IS_PLAYER_LIFTING_A_PHONE player
	WAIT 0

	IF countdown_as4 = 0
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_asuka4_failed	 
	ENDIF

ENDWHILE

	SET_POLICE_IGNORE_PLAYER Player On
	SET_EVERYONE_IGNORE_PLAYER Player On
	FREEZE_ONSCREEN_TIMER TRUE
	SET_FIXED_CAMERA_POSITION -77.442 -702.532 33.574 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT -76.500 -702.391 33.270 JUMP_CUT

WHILE NOT IS_PHONE_DISPLAYING_MESSAGE Ray_phone2
	WAIT 0

ENDWHILE

	PLAY_MISSION_AUDIO

WHILE IS_PLAYER_LIFTING_A_PHONE player
	WAIT 0

ENDWHILE

	RESTORE_CAMERA_JUMPCUT
	FREEZE_ONSCREEN_TIMER FALSE
	REMOVE_BLIP blip1_as4
	ADD_BLIP_FOR_OBJECT phone_3_obj blip1_as4
	SET_PHONE_MESSAGE Ray_phone3 ( AM4_1C )
	SET_POLICE_IGNORE_PLAYER Player off
	SET_EVERYONE_IGNORE_PLAYER Player off

	LOAD_MISSION_AUDIO A4_C

WHILE NOT LOCATE_PLAYER_ON_FOOT_3D Player 204.8 -135.0 16.0 1.0 1.0 3.0 FALSE //PHONE3
OR NOT IS_PLAYER_LIFTING_A_PHONE player
	WAIT 0

	IF countdown_as4 = 0
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_asuka4_failed	 
	ENDIF

ENDWHILE

	SET_POLICE_IGNORE_PLAYER Player On
	SET_EVERYONE_IGNORE_PLAYER Player On
	FREEZE_ONSCREEN_TIMER TRUE
	SET_FIXED_CAMERA_POSITION 191.656 -130.530 20.037 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT 192.560 -130.834 19.734 JUMP_CUT

WHILE NOT IS_PHONE_DISPLAYING_MESSAGE Ray_phone3
	WAIT 0

ENDWHILE

	PLAY_MISSION_AUDIO

WHILE IS_PLAYER_LIFTING_A_PHONE player
	WAIT 0

ENDWHILE

	RESTORE_CAMERA_JUMPCUT
	FREEZE_ONSCREEN_TIMER FALSE
	REMOVE_BLIP blip1_as4
	ADD_BLIP_FOR_OBJECT phone_4_obj blip1_as4
	SET_PHONE_MESSAGE Ray_phone4 ( AM4_1D )
	SET_POLICE_IGNORE_PLAYER Player off
	SET_EVERYONE_IGNORE_PLAYER Player off

	LOAD_MISSION_AUDIO A4_D

WHILE NOT LOCATE_PLAYER_ON_FOOT_3D Player 60.3 -964.8 26.1 1.0 1.0 3.0 FALSE //PHONE4
OR NOT IS_PLAYER_LIFTING_A_PHONE player
	WAIT 0

	IF countdown_as4 = 0
		PRINT_NOW ( OUTTIME ) 5000 1
		GOTO mission_asuka4_failed 	 
	ENDIF

ENDWHILE

	SET_POLICE_IGNORE_PLAYER Player On
	SET_EVERYONE_IGNORE_PLAYER Player On
	FREEZE_ONSCREEN_TIMER TRUE
	SET_FIXED_CAMERA_POSITION 51.733 -973.067 30.559 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT 52.418 -972.450 30.172 JUMP_CUT

WHILE NOT IS_PHONE_DISPLAYING_MESSAGE Ray_phone4
	WAIT 0

ENDWHILE

	PLAY_MISSION_AUDIO

WHILE IS_PLAYER_LIFTING_A_PHONE player
	WAIT 0

ENDWHILE

	RESTORE_CAMERA_JUMPCUT
	CLEAR_ONSCREEN_TIMER countdown_as4
	REMOVE_BLIP blip1_as4
	ADD_BLIP_FOR_COORD 38.8 -725.4 22.8 blip1_as4
	SET_POLICE_IGNORE_PLAYER Player off
	SET_EVERYONE_IGNORE_PLAYER Player off

rays_cutscene_flag = 1

WHILE NOT LOCATE_PLAYER_ON_FOOT_3D Player 38.8 -725.4 22.8 1.0 1.0 2.0 TRUE
	WAIT 0

ENDWHILE

REMOVE_BLIP blip1_as4


//skip_to_ray_cut: //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
//SET_PLAYER_COORDINATES player 44.2 -725.0 24.7 //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


GET_GAME_TIMER breakout_timer_start
breakout_diff = 0

WHILE NOT CAN_PLAYER_START_MISSION Player
AND breakout_diff < 5000	//	if player is not in control after 5 secs do the cutscene anyway
	WAIT 0

	GET_GAME_TIMER breakout_timer							
	breakout_diff = breakout_timer - breakout_timer_start
ENDWHILE

MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

//RAY CUT SCENE*************************************************************************
CLEAR_WANTED_LEVEL player
SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF
	 
LOAD_SPECIAL_CHARACTER 2 ray
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 RAYH

WHILE GET_FADING_STATUS
	WAIT 0

ENDWHILE

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2 
	WAIT 0

ENDWHILE

LOAD_CUTSCENE R0_PDR2
SET_CUTSCENE_OFFSET 39.424 -726.677 21.692

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_ray
SET_CUTSCENE_ANIM cs_ray ray

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_ray CUT_OBJ2 cs_rayhead
SET_CUTSCENE_HEAD_ANIM cs_rayhead ray

CLEAR_AREA 39.0 -723.5 22.0 1.0 TRUE

SET_PLAYER_COORDINATES player 39.0 -723.5 22.0

SET_PLAYER_HEADING player 90.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2887
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_3 ) 10000 1 

WHILE cs_time < 6583
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_4 ) 10000 1 

WHILE cs_time < 10279
	WAIT 0							 
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_5 ) 10000 1 

WHILE cs_time < 13282
	WAIT 0							 
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_6 ) 10000 1 

WHILE cs_time < 15014
	WAIT 0							 
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_7 ) 10000 1 

WHILE cs_time < 20212
	WAIT 0							 
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_8 ) 10000 1 

WHILE cs_time < 21944
	WAIT 0							 
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_9 ) 10000 1 

WHILE cs_time < 24716
	WAIT 0							 
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_10 ) 10000 1 

WHILE cs_time < 27719
	WAIT 0							 
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM4_11 ) 10000 1 

WHILE cs_time < 30611
	WAIT 0							 
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 31666
	WAIT 0							 
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

SWITCH_RUBBISH ON
CLEAR_PRINTS
CLEAR_CUTSCENE
SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN

UNLOAD_SPECIAL_CHARACTER 2
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2

}

GOTO mission_asuka4_passed
	   		

// Mission asuka4 failed

mission_asuka4_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission asuka4 passed

mission_asuka4_passed:

flag_asuka_mission4_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 11000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 11000
REGISTER_MISSION_PASSED	AM4
PLAYER_MADE_PROGRESS 1
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 38.8 -725.4 -100.0 RADAR_SPRITE_RAY ray_contact_blip 
SET_CAMERA_BEHIND_PLAYER
START_NEW_SCRIPT asuka_mission5_loop
START_NEW_SCRIPT ray_mission1_loop
RETURN
		


// mission cleanup

mission_cleanup_asuka4:

DISPLAY_RADAR 3 // HACKED RADAR ON

flag_player_on_mission = 0
flag_player_on_asuka_mission = 0
CLEAR_ONSCREEN_TIMER countdown_as4
REMOVE_BLIP blip1_as4
TURN_PHONE_OFF Ray_phone1
TURN_PHONE_OFF Ray_phone2
TURN_PHONE_OFF Ray_phone3
TURN_PHONE_OFF Ray_phone4
DELETE_OBJECT phone_1_obj
DELETE_OBJECT phone_2_obj
DELETE_OBJECT phone_3_obj
DELETE_OBJECT phone_4_obj
rays_cutscene_flag = 0
FREEZE_ONSCREEN_TIMER FALSE
MISSION_HAS_FINISHED
RETURN
		


MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************asuka mission 5******************************** 
// ********************************************Kill Tanner**********************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_asuka5

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_asuka5_failed
ENDIF

GOSUB mission_cleanup_asuka5

MISSION_END
 
// Variables for mission

VAR_INT blip1_as5 blip2_as5 blip3_as5

VAR_INT tanner_car got_to_coord_once old_tanner_health

VAR_INT wdadd5 tanner cleared_timer_once_asuka5

VAR_INT test_tanner_health_counter2 test_tanner_health_counter 

VAR_FLOAT test_tanner_health_float

// ****************************************Mission Start************************************

mission_start_asuka5:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_asuka_mission = 1
SCRIPT_NAME asuka5
WAIT 0

SET_MAX_WANTED_LEVEL 5

cleared_timer_once_asuka5 = 0
got_to_coord_once = 0

{

LOAD_SPECIAL_MODEL cut_obj2	NOTE
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
REQUEST_MODEL condo_ivy
REQUEST_MODEL kmricndo01


LOAD_ALL_MODELS_NOW
 
WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED condo_ivy
OR NOT HAS_MODEL_LOADED	kmricndo01
	WAIT 0

ENDWHILE


LOAD_CUTSCENE A5_K2FT
SET_CUTSCENE_OFFSET 523.102 -636.96 15.616

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT cut_obj2 cs_note
SET_CUTSCENE_ANIM cs_note NOTE

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CLEAR_AREA 523.6 -639.4 16.6 1.0 TRUE
SET_PLAYER_COORDINATES player 523.6 -639.4 16.0

SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time


WHILE cs_time < 2220
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM5_A ) 10000 1 

WHILE cs_time < 4363
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM5_B ) 10000 1 

WHILE cs_time < 11558
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM5_C ) 10000 1 

WHILE cs_time < 16227
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( AM5_D ) 10000 1 

WHILE cs_time < 17342
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

WHILE cs_time < 17666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED condo_ivy
MARK_MODEL_AS_NO_LONGER_NEEDED kmricndo01

REQUEST_MODEL CAR_ESPERANTO
LOAD_SPECIAL_CHARACTER 1 tanner
		    
	WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1 
	OR NOT HAS_MODEL_LOADED CAR_ESPERANTO
		WAIT 0
	ENDWHILE

	LOAD_MISSION_AUDIO A5_A

	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE


//START MISSION

CREATE_CAR CAR_ESPERANTO 420.9 -1396.5 26.0 tanner_car //TEST INDUSTRIAL!!!!!!!!!
SET_CAR_HEADING tanner_car 90.0
SET_CAR_HEALTH tanner_car 600
SET_CAR_ONLY_DAMAGED_BY_PLAYER tanner_car TRUE
LOCK_CAR_DOORS tanner_car CARLOCK_LOCKOUT_PLAYER_ONLY
SET_CAR_STAYS_IN_CURRENT_LEVEL tanner_car TRUE
SET_CAR_AVOID_LEVEL_TRANSITIONS tanner_car TRUE

ADD_BLIP_FOR_COORD 414.0 -1378.0 -100.0 blip1_as5
CHANGE_BLIP_DISPLAY blip1_as5 BLIP_ONLY

	WHILE NOT IS_PLAYER_STOPPED_IN_AREA_3D Player 411.8 -1375.3 25.6 417.0 -1381.9 28.6 TRUE
		WAIT 0

			IF IS_CAR_DEAD tanner_car
				GOTO mission_asuka5_failed	
			ENDIF

			IF NOT IS_CAR_HEALTH_GREATER tanner_car 599
			OR NOT IS_CAR_IN_AREA_2D tanner_car	417.1 -1398.0 425.4 -1394.9 FALSE
				PRINT_NOW ( AM5_1 ) 5000 1
				GOTO mission_asuka5_failed 
			ENDIF


	ENDWHILE

REMOVE_BLIP blip1_as5

// when going to kill tanner, dont path here
DISPLAY_RADAR 2 // PATHING OFF

ADD_BLIP_FOR_CAR tanner_car blip2_as5

SET_PLAYER_CONTROL Player Off
CLEAR_AREA 427.9 -1392.7 21.1 20.0 TRUE
SET_POLICE_IGNORE_PLAYER Player On
SWITCH_WIDESCREEN ON

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 436.5 -1399.8 33.7 tanner	//TEST INDUSTRIAL!!!!!!!!
SET_CHAR_RUNNING tanner TRUE

SET_FIXED_CAMERA_POSITION 437.4 -1387.4 30.9 0.0 0.0 0.0 //TEST INDUSTRIAL!!!!!!!!
POINT_CAMERA_AT_CHAR tanner FIXED JUMP_CUT

TIMERB = 0
SET_CHAR_OBJ_RUN_TO_COORD tanner 435.7 -1388.8

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED tanner
		WAIT 0

			IF IS_CHAR_DEAD tanner
				GOTO mission_asuka5_passed
			ENDIF

			IF IS_CAR_DEAD tanner_car
				GOTO mission_asuka5_failed	
			ENDIF

			IF TIMERB > 10000
				IF NOT IS_CHAR_DEAD	lips
					SET_CHAR_COORDINATES tanner 435.7 -1388.8 -100.0
				ENDIF
			ENDIF

	ENDWHILE

TIMERB = 0
SET_CHAR_OBJ_RUN_TO_COORD tanner 423.5 -1388.8

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED tanner
		WAIT 0

			IF IS_CHAR_DEAD tanner
				GOTO mission_asuka5_passed
			ENDIF

			IF IS_CAR_DEAD tanner_car
				GOTO mission_asuka5_failed	
			ENDIF

			IF TIMERB > 10000
				IF NOT IS_CHAR_DEAD	lips
					SET_CHAR_COORDINATES tanner 427.3 -1388.6 25.0
				ENDIF
			ENDIF

	ENDWHILE

TIMERB = 0
SET_CHAR_OBJ_RUN_TO_COORD tanner 423.6 -1393.1

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED tanner
		WAIT 0

			IF IS_CHAR_DEAD tanner
				GOTO mission_asuka5_passed
			ENDIF

			IF IS_CAR_DEAD tanner_car
				GOTO mission_asuka5_failed	
			ENDIF

			IF TIMERB > 10000
				IF NOT IS_CHAR_DEAD	lips
					SET_CHAR_COORDINATES tanner 423.6 -1393.1 25.0
				ENDIF
			ENDIF

	ENDWHILE


SET_FIXED_CAMERA_POSITION 436.0 -1390.8 31.0 0.0 0.0 0.0 //TEST INDUSTRIAL!!!!!!!!
POINT_CAMERA_AT_CHAR tanner FIXED INTERPOLATION

SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER tanner tanner_car

	WHILE NOT IS_CHAR_IN_CAR tanner tanner_car 
		 WAIT 0
		   
			IF IS_CHAR_DEAD tanner
				GOTO mission_asuka5_passed
			ENDIF

			IF IS_CAR_DEAD tanner_car
				GOTO mission_asuka5_failed	
			ENDIF

	ENDWHILE

	IF IS_CHAR_DEAD tanner
		GOTO mission_asuka5_passed
	ENDIF


CLEAR_AREA 427.9 -1392.7 21.1 20.0 TRUE
POINT_CAMERA_AT_CAR tanner_car FIXED INTERPOLATION

DISPLAY_ONSCREEN_COUNTER_WITH_STRING test_tanner_health_counter COUNTER_DISPLAY_BAR (DAM)

GOSUB tanner_health

CAR_GOTO_COORDINATES_ACCURATE tanner_car 319.9 -1388.6 -100.0
SET_CAR_MISSION tanner_car MISSION_GOTOCOORDS_STRAIGHT_ACCURATE
SET_CAR_CRUISE_SPEED tanner_car 20.0
SET_CAR_DRIVING_STYLE tanner_car 2

WAIT 1000

	RESTORE_CAMERA_JUMPCUT
	SET_PLAYER_CONTROL Player ON
	SET_POLICE_IGNORE_PLAYER Player OFF
	SWITCH_WIDESCREEN OFF

IF NOT IS_CAR_DEAD tanner_car

	WHILE IS_CAR_HEALTH_GREATER tanner_car 599
		WAIT 0

			IF IS_CHAR_DEAD tanner
				GOTO mission_asuka5_passed
			ENDIF

			IF IS_CAR_DEAD tanner_car
			AND cleared_timer_once_asuka5 = 0
				CLEAR_ONSCREEN_COUNTER test_tanner_health_counter
				cleared_timer_once_asuka5 = 1	
			ENDIF

			IF NOT LOCATE_CAR_2D tanner_car 319.9 -1388.6 8.0 8.0 FALSE
				IF got_to_coord_once = 0 
					CAR_GOTO_COORDINATES_ACCURATE tanner_car 319.9 -1388.6 -100.0
					SET_CAR_MISSION tanner_car MISSION_GOTOCOORDS_STRAIGHT_ACCURATE
				ENDIF
			ELSE
				CAR_WANDER_RANDOMLY tanner_car
				got_to_coord_once = 1
			ENDIF

			IF IS_CAR_UPSIDEDOWN tanner_car
			AND IS_CAR_STOPPED tanner_car
				GOTO tanner_shits_it
			ENDIF

			GOSUB tanner_health

	ENDWHILE

ENDIF

	IF IS_CHAR_DEAD tanner
		GOTO mission_asuka5_passed
	ENDIF

	IF IS_CAR_DEAD tanner_car
	AND cleared_timer_once_asuka5 = 0
		CLEAR_ONSCREEN_COUNTER test_tanner_health_counter
		cleared_timer_once_asuka5 = 1	
	ENDIF

PLAY_MISSION_AUDIO
SET_CAR_CRUISE_SPEED tanner_car 30.0
ALTER_WANTED_LEVEL_NO_DROP Player 3

IF NOT IS_CAR_DEAD tanner_car
	GET_CAR_HEALTH tanner_car old_tanner_health
ENDIF

	WHILE IS_CAR_HEALTH_GREATER tanner_car 300
		WAIT 0
		
			IF IS_CHAR_DEAD	tanner
				GOTO mission_asuka5_passed
			ENDIF

			IF IS_CAR_DEAD tanner_car
			AND cleared_timer_once_asuka5 = 0
				CLEAR_ONSCREEN_COUNTER test_tanner_health_counter
				cleared_timer_once_asuka5 = 1	
			ENDIF

			IF NOT LOCATE_CAR_2D tanner_car 319.9 -1388.6 6.0 6.0 FALSE
				IF got_to_coord_once = 0 
					CAR_GOTO_COORDINATES_ACCURATE tanner_car 319.9 -1388.6 -100.0
					SET_CAR_MISSION tanner_car MISSION_GOTOCOORDS_STRAIGHT_ACCURATE
				ENDIF
			ELSE
				CAR_WANDER_RANDOMLY tanner_car
				got_to_coord_once = 1
			ENDIF

			IF IS_CAR_UPSIDEDOWN tanner_car
			AND IS_CAR_STOPPED tanner_car
				GOTO tanner_shits_it
			ENDIF

			GOSUB tanner_health

	ENDWHILE

tanner_shits_it:

	IF IS_CHAR_DEAD tanner
		GOTO mission_asuka5_passed
	ENDIF

	CLEAR_ONSCREEN_COUNTER test_tanner_health_counter

REMOVE_BLIP blip2_as5
LOCK_CAR_DOORS tanner_car CARLOCK_UNLOCKED
SET_CHAR_OBJ_LEAVE_CAR tanner tanner_car
ADD_BLIP_FOR_CHAR tanner blip3_as5
SET_CAR_CRUISE_SPEED tanner_car 0.0
SET_CAR_MISSION tanner_car MISSION_STOP_FOREVER

	WHILE IS_CHAR_IN_CAR tanner tanner_car 
	 	WAIT 0
	 	
 		IF IS_CHAR_DEAD	tanner
			GOTO mission_asuka5_passed
		ENDIF  

		IF IS_CAR_DEAD tanner_car
		AND cleared_timer_once_asuka5 = 0
			CLEAR_ONSCREEN_COUNTER test_tanner_health_counter
			cleared_timer_once_asuka5 = 1	
		ENDIF
		
	ENDWHILE

	IF IS_CHAR_DEAD tanner
		GOTO mission_asuka5_passed
	ENDIF

	SET_CHAR_ONLY_DAMAGED_BY_PLAYER tanner True

	IF IS_CAR_DEAD tanner_car
	AND cleared_timer_once_asuka5 = 0
		CLEAR_ONSCREEN_COUNTER test_tanner_health_counter
		cleared_timer_once_asuka5 = 1	
	ENDIF

SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS tanner Player
SET_ANIM_GROUP_FOR_CHAR tanner ANIM_PANIC_CHUNKYPED 

	WHILE NOT IS_CHAR_DEAD tanner 
		WAIT 0

		IF IS_CAR_DEAD tanner_car
		AND cleared_timer_once_asuka5 = 0
			CLEAR_ONSCREEN_COUNTER test_tanner_health_counter
			cleared_timer_once_asuka5 = 1	
		ENDIF

	ENDWHILE


GOTO mission_asuka5_passed

}	   		

// Mission asuka5 failed

mission_asuka5_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
RETURN

   

// mission asuka5 passed

mission_asuka5_passed:

flag_asuka_mission5_passed = 1
PLAY_MISSION_PASSED_TUNE 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 20000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
ADD_SCORE player 20000
REMOVE_BLIP asuka_contact_blip
REGISTER_MISSION_PASSED	AM5
PLAYER_MADE_PROGRESS 1
RETURN
		


// mission cleanup

mission_cleanup_asuka5:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_asuka_mission = 0
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_ESPERANTO
UNLOAD_SPECIAL_CHARACTER 1
IF NOT IS_CHAR_DEAD	tanner
	REMOVE_CHAR_ELEGANTLY tanner
ENDIF
REMOVE_BLIP blip1_as5
REMOVE_BLIP blip2_as5
REMOVE_BLIP blip3_as5
CLEAR_ONSCREEN_COUNTER test_tanner_health_counter
MISSION_HAS_FINISHED
RETURN
		


tanner_health:

{
GET_PLAYER_CHAR player script_controlled_player
IF NOT IS_CAR_DEAD tanner_car
	GET_CAR_HEALTH tanner_car test_tanner_health_counter

	IF test_tanner_health_counter < old_tanner_health
		ALTER_WANTED_LEVEL_NO_DROP Player 3
	ENDIF 

	old_tanner_health = test_tanner_health_counter

	test_tanner_health_counter2 = 600 - test_tanner_health_counter

	IF test_tanner_health_counter2 > 400
	    test_tanner_health_counter2 = 400
	ENDIF

	test_tanner_health_counter = test_tanner_health_counter2 / 3

ENDIF

RETURN

}
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************Kenji mission 1********************************* 
// ******************************************KANBU BUST OUT*********************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME kenji1

// Mission start stuff

GOSUB mission_start_kenji1

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_kenji1_failed
	ENDIF

GOSUB mission_cleanup_kenji1

MISSION_END
 
// Variables for mission

VAR_INT mission_cop_car_km1

VAR_INT radar_blip_coord1_km1

VAR_INT radar_blip_coord2_km1

VAR_INT radar_blip_coord3_km1

VAR_INT flag_player_had_car_message_km1

VAR_INT flag_player_had_bomb_message_km1

VAR_INT	flag_player_got_cops_message_km1

VAR_INT yakuza_ped1_km1

VAR_INT mission_car_km1

VAR_INT flag_player_wanted_level_changed

VAR_INT flag_blip_on_yakuza_ped1_km1

VAR_INT radar_blip_ped1_km1

VAR_INT flag_car_got_bomb_km1

VAR_INT total_counter_km1

VAR_INT	counter_bomb_km1

VAR_INT	counter_police_km1

VAR_INT car_km1 //Car at end at dojo

VAR_INT flag_had_bomb_message_km1

VAR_INT flag_blip_on_km1

VAR_INT flag_area_bomb_message_km1

VAR_INT police_alarm

VAR_INT spray_blip_km1

VAR_INT flag_spray_blip_on_km1

VAR_INT flag_bomb_km1

VAR_INT cell_beating

VAR_INT debris1

VAR_INT debris2

VAR_INT debris3

VAR_INT debris4

VAR_FLOAT debris1_x

VAR_FLOAT debris1_y

VAR_FLOAT debris1_z

VAR_FLOAT debris2_x

VAR_FLOAT debris2_y

VAR_FLOAT debris2_z

VAR_FLOAT debris3_x

VAR_FLOAT debris3_y

VAR_FLOAT debris3_z

VAR_FLOAT debris4_x

VAR_FLOAT debris4_y

VAR_FLOAT debris4_z

VAR_INT flag_dojo_blip_on

VAR_INT flag_player_wanted

VAR_INT flag_kanbu_in_group

VAR_INT sphere_km1

VAR_INT flag_player_had_dome_message_km1

VAR_INT flag_played_cop_radio_km1

// ****************************************Mission Start************************************

mission_start_kenji1:

flag_player_on_mission = 1

flag_player_on_kenji_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_player_had_car_message_km1 = 0

flag_player_had_bomb_message_km1 = 0

flag_player_got_cops_message_km1 = 0

flag_player_wanted_level_changed = 0

flag_blip_on_yakuza_ped1_km1 = 0

flag_car_got_bomb_km1 = 0

total_counter_km1 = 0

counter_bomb_km1 = 0

counter_police_km1 = 0

flag_had_bomb_message_km1 = 0

flag_blip_on_km1 = 0

blob_flag = 1

flag_area_bomb_message_km1 = 0

flag_spray_blip_on_km1 = 0

flag_bomb_km1 = 0

debris1_x = 0.0

debris1_y = 0.0

debris1_z = 0.0

debris2_x = 0.0

debris2_y = 0.0

debris2_z = 0.0

debris3_x = 0.0

debris3_y = 0.0

debris3_z = 0.0

debris4_x = 0.0

debris4_y = 0.0

debris4_z = 0.0

flag_dojo_blip_on = 0

flag_player_wanted = 0

flag_kanbu_in_group = 0

flag_player_had_dome_message_km1 = 0

flag_played_cop_radio_km1 = 0


{

IF flag_need_wall_change_km1 = 1
	SWAP_NEAREST_BUILDING_MODEL 328.026 -1090.262 26.941 2.0 police_celhole police_cell_wall
	flag_need_wall_change_km1 = 0
ENDIF

// ****************************************START OF CUTSCENE********************************

/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_kenji1_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( KM1 ) 15000 2 //"Kanbu Bust out"

SWITCH_STREAMING OFF
*/

// Cutscene stuff

LOAD_SPECIAL_CHARACTER 1 KENJI
REQUEST_MODEL PED_GANG_YAKUZA_A
REQUEST_MODEL casino_garden 

LOAD_SPECIAL_MODEL cut_obj1 KENJIH 
LOAD_SPECIAL_MODEL cut_obj2 PLAYERH

/*
WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE
*/

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED PED_GANG_YAKUZA_A 
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED casino_garden
	 
	WAIT 0

ENDWHILE

//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor FALSE	

LOAD_CUTSCENE k1_kbo

SET_CUTSCENE_OFFSET 476.380 -1382.168 67.347

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_kenji

SET_CUTSCENE_ANIM cs_kenji kenji

CREATE_CUTSCENE_OBJECT PED_GANG_YAKUZA_A cs_yakuza

SET_CUTSCENE_ANIM cs_yakuza gang07

CREATE_CUTSCENE_HEAD cs_kenji CUT_OBJ1 cs_kenjihead

SET_CUTSCENE_HEAD_ANIM cs_kenjihead kenji

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CLEAR_AREA 459.1 -1413.0 25.11 1.0 TRUE 

SET_PLAYER_COORDINATES player 459.1 -1413.0 25.11
							   
SET_PLAYER_HEADING player 132.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 8392
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM1_A ) 10000 1 //"My sister speaks highly of you,"

WHILE cs_time < 9918
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM1_E ) 10000 1 //"though I am yet to be convinced that a gaijin can offer anything but disappointment. We shall see..."

WHILE cs_time < 13732
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM1_B ) 10000 1 //"Perhaps you could help deal with a situation that has me at a disadvantage."

WHILE cs_time < 17547
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM1_F ) 10000 1 //"Of course failure has it's own disgrace."

WHILE cs_time < 20683
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM1_C ) 10000 1 //"A Yakuza Kanbu is in custody awaiting transfer for trial."

WHILE cs_time < 23650
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM1_G ) 10000 1 //"He is a valued member of the family."

WHILE cs_time < 25430
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM1_H ) 10000 1 //"Break him out of custody and get him to the dojo."

WHILE cs_time < 28749
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( KM1_H )
 
WHILE cs_time < 31200
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 


//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED casino_garden 

// *******************************************END OF CUTSCENE*******************************

PRINT_NOW ( KM1_1 ) 5000 1 //"Steal a cop car!"

REQUEST_MODEL rubble01
REQUEST_MODEL rubble02
LOAD_MISSION_AUDIO K1_A

WHILE NOT HAS_MODEL_LOADED rubble01
OR NOT HAS_MODEL_LOADED rubble02
OR NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0
	
ENDWHILE 

// waiting for the player to be in a cop car

ADD_CONTINUOUS_SOUND 326.4 -1092.4 26.0 SOUND_POLICE_CELL_BEATING_LOOP_L cell_beating

WHILE NOT IS_PLAYER_IN_MODEL player CAR_POLICE

	WAIT 0
   
ENDWHILE

STORE_CAR_PLAYER_IS_IN player mission_cop_car_km1

PRINT_NOW ( KM1_2 ) 5000 1 //"Get the car rigged with a bomb!"

ADD_SPHERE 373.9 -576.4 25.1 4.0 sphere_km1

ADD_SPRITE_BLIP_FOR_COORD 380.0 -577.0 25.1 RADAR_SPRITE_BOMB radar_blip_coord1_km1 

// waiting for the cop car to be rigged

WHILE NOT flag_car_got_bomb_km1 = 1

	WAIT 0
	
	IF IS_PLAYER_IN_MODEL player CAR_POLICE

		STORE_CAR_PLAYER_IS_IN player mission_cop_car_km1

		IF flag_player_had_car_message_km1 = 1
			ADD_SPRITE_BLIP_FOR_COORD 380.0 -577.0 25.1 RADAR_SPRITE_BOMB radar_blip_coord1_km1

			IF flag_player_had_dome_message_km1 = 0 
				ADD_SPHERE 373.9 -576.4 25.1 4.0 sphere_km1
			ENDIF

			flag_player_had_car_message_km1 = 0
		ENDIF

		IF IS_CAR_ARMED_WITH_BOMB mission_cop_car_km1 CARBOMB_TIMED
			flag_car_got_bomb_km1 = 1
		ELSE

			IF flag_had_bomb_message_km1 = 0
				PRINT_NOW ( KM1_2 ) 5000 1 //"Get the car rigged with a bomb!"
				flag_had_bomb_message_km1 = 1
			ENDIF

		ENDIF

	ELSE

		IF flag_player_had_car_message_km1 = 0
			PRINT_NOW ( KM1_4 ) 7000 1 //"Get a cop car and get on with the mission"
			REMOVE_BLIP radar_blip_coord1_km1
			REMOVE_SPHERE sphere_km1
			flag_player_had_car_message_km1 = 1
		ENDIF

		flag_had_bomb_message_km1 = 0

 	ENDIF

	IF LOCATE_PLAYER_IN_CAR_2D player 373.9 -576.4 2.0 2.0 FALSE
		
		IF flag_player_had_dome_message_km1 = 0
			PRINT_HELP ( KM1_13 ) //"Drive the car...
			REMOVE_SPHERE sphere_km1
			flag_player_had_dome_message_km1 = 1
		ENDIF

	ELSE
		flag_player_had_dome_message_km1 = 0
	ENDIF

		
	    
ENDWHILE

REMOVE_BLIP radar_blip_coord1_km1

REMOVE_SPHERE sphere_km1

PRINT_NOW ( KM1_5 ) 7000 1 //"Okay now go to the police station

ADD_BLIP_FOR_COORD 327.0 -1086.0 -100.0 radar_blip_coord2_km1

blob_flag = 1

flag_blip_on_km1 = 1
 				  	   
// waiting for the player to activate the car bomb and the car to be in the area

blob_flag = 1

WHILE counter_bomb_km1 = 0

	WAIT 0

	IF flag_area_bomb_message_km1 = 0

		IF IS_PLAYER_IN_MODEL player CAR_POLICE
	
			STORE_CAR_PLAYER_IS_IN player mission_cop_car_km1
								
			flag_player_had_car_message_km1 = 0
																	
			IF IS_CAR_ARMED_WITH_BOMB mission_cop_car_km1 CARBOMB_TIMED
			OR IS_CAR_ARMED_WITH_BOMB mission_cop_car_km1 CARBOMB_TIMEDACTIVE

				IF flag_player_had_bomb_message_km1 = 1
					REMOVE_BLIP radar_blip_coord1_km1  // bombshop
					flag_player_had_bomb_message_km1 = 0
				ENDIF

				IF flag_blip_on_km1 = 0
					ADD_BLIP_FOR_COORD 327.0 -1086.0 -100.0 radar_blip_coord2_km1 // police station
					flag_blip_on_km1 = 1
					blob_flag = 1
				ENDIF
								
				IF IS_CAR_IN_AREA_3D mission_cop_car_km1 331.7 -1091.0 24.0 323.7 -1078.3 33.0 blob_flag

					IF flag_bomb_km1 = 0
					    
						PRINT_HELP ( KM1_8A ) //"Press circle to detonate the bomb, remember to get out of the way!"
												
						flag_bomb_km1 = 1

					ENDIF
	
					IF IS_CAR_ARMED_WITH_BOMB mission_cop_car_km1 CARBOMB_TIMEDACTIVE
						counter_bomb_km1 = 1
						flag_area_bomb_message_km1 = 1
					ELSE
						flag_area_bomb_message_km1 = 0
						//counter_bomb_km1 = 0
					ENDIF

				ENDIF
			   			
			ELSE
							
				IF flag_area_bomb_message_km1 = 0

					IF flag_player_had_bomb_message_km1 = 0
						PRINT_NOW ( KM1_6 ) 7000 1 //"Get a bomb fitted to the car!"
						ADD_SPRITE_BLIP_FOR_COORD 380.0 -577.0 25.1 RADAR_SPRITE_BOMB radar_blip_coord1_km1 //bombshop
						flag_player_had_bomb_message_km1 = 1
					
						IF flag_blip_on_km1 = 1
							REMOVE_BLIP radar_blip_coord2_km1  // police station
							flag_blip_on_km1 = 0
							blob_flag = 0
						ENDIF
				   					
					ENDIF

				ENDIF
																											 						
			ENDIF

		ELSE

			blob_flag = 0
			
			IF flag_player_had_car_message_km1 = 0
				PRINT_NOW ( KM1_4 ) 7000 1 //"Get a cop car and get on with the mission"
				REMOVE_BLIP radar_blip_coord2_km1  // Police station
				flag_blip_on_km1 = 0
				flag_player_had_car_message_km1 = 1
			ENDIF
						
			IF flag_player_had_bomb_message_km1 = 1
		   		REMOVE_BLIP radar_blip_coord1_km1  // bombshop
				flag_player_had_bomb_message_km1 = 0
			ENDIF	

		ENDIF
    
    ENDIF
    	
ENDWHILE

CLEAR_HELP

REMOVE_BLIP radar_blip_coord2_km1  // police station 

// Waiting for the player to destroy the car outside the cell

WHILE NOT IS_EXPLOSION_IN_AREA EXPLOSION_CAR 323.3 -1072.6 24.0 335.5 -1094.0 33.0
	
	IF IS_CAR_DEAD mission_cop_car_km1
		PRINT_NOW ( KM1_11 ) 5000 1 //"You have alerted the cops"
		ALTER_WANTED_LEVEL_NO_DROP player 3
		GOTO mission_kenji1_failed
	ENDIF

	WAIT 0
	   	
ENDWHILE

IF NOT IS_CAR_DEAD mission_cop_car_km1
	PRINT_NOW ( KM1_11 ) 5000 1 //"You have alerted the cops"
	ALTER_WANTED_LEVEL_NO_DROP player 3
	GOTO mission_kenji1_failed
ELSE
      
   GOSUB wall_explosion
    
ENDIF

REMOVE_SOUND cell_beating 

ADD_CONTINUOUS_SOUND 328.418 -1088.174 28.3 SOUND_BANK_ALARM_LOOP_L police_alarm

CLEAR_AREA 327.0 -1086.0 -100.0 4.0 TRUE

SWAP_NEAREST_BUILDING_MODEL 328.026 -1090.262 26.941 2.0 police_cell_wall police_celhole

flag_need_wall_change_km1 = 1 // If player fails the wall needs to be changed back 

REMOVE_BLIP radar_blip_coord2_km1

WAIT 500

CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A 328.2 -1092.2 24.9 yakuza_ped1_km1

SET_CHAR_RUNNING yakuza_ped1_km1 TRUE  

CLEAR_CHAR_THREAT_SEARCH yakuza_ped1_km1

SET_PLAYER_AS_LEADER yakuza_ped1_km1 player

PRINT_NOW ( KM1_12 ) 7000 1 //"Get him to the dojo but get rid of the cops first!"

ALTER_WANTED_LEVEL_NO_DROP player 3

ADD_SPRITE_BLIP_FOR_COORD 379.0 -493.8 25.2 RADAR_SPRITE_SPRAY spray_blip_km1

// waiting for the player to get rid of his wanted level

timera = 0

WHILE IS_WANTED_LEVEL_GREATER player 0

	WAIT 0
	
	IF flag_played_cop_radio_km1 = 0

		IF timera > 2000
			PLAY_MISSION_AUDIO
			flag_played_cop_radio_km1 = 1
		ENDIF
		
	ENDIF	
	
	IF IS_CHAR_DEAD yakuza_ped1_km1
		PRINT_NOW ( KM1_10 ) 5000 1 //"The Yakuza Kanbu is dead!"
		GOTO mission_kenji1_failed
	ENDIF
		
	IF NOT IS_CHAR_IN_PLAYERS_GROUP yakuza_ped1_km1 player
		
		IF flag_blip_on_yakuza_ped1_km1 = 0
			PRINT_NOW ( HEY6 ) 5000 1 //You have left the Yakuza Kanbu behind go and get him!"
			ADD_BLIP_FOR_CHAR yakuza_ped1_km1 radar_blip_ped1_km1
			REMOVE_BLIP spray_blip_km1
			flag_blip_on_yakuza_ped1_km1 = 1
		ENDIF
				
	ENDIF	
				
	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player yakuza_ped1_km1 8.0 8.0 FALSE
	AND flag_blip_on_yakuza_ped1_km1 = 1
		SET_PLAYER_AS_LEADER yakuza_ped1_km1 player
		ADD_SPRITE_BLIP_FOR_COORD 379.0 -493.8 25.2 RADAR_SPRITE_SPRAY spray_blip_km1
		REMOVE_BLIP radar_blip_ped1_km1
	   	flag_blip_on_yakuza_ped1_km1 = 0
	ENDIF
	
ENDWHILE

REMOVE_BLIP spray_blip_km1  

PRINT_NOW ( KM1_3 ) 7000 1 //"Get me to the Dojo!"

ADD_BLIP_FOR_COORD 105.6 -1292.68 -100.0 radar_blip_coord3_km1

flag_dojo_blip_on = 1

LOAD_MISSION_AUDIO k1_b

// Waiting for the player to be back at the safehouse

blob_flag = 1

WHILE NOT LOCATE_STOPPED_PLAYER_ANY_MEANS_2D player 105.6 -1292.68 3.0 4.0 blob_flag
OR NOT LOCATE_STOPPED_CHAR_ANY_MEANS_2D yakuza_ped1_km1 105.6 -1292.68 3.0 4.0 FALSE
OR NOT HAS_MISSION_AUDIO_LOADED
OR IS_WANTED_LEVEL_GREATER player 0

	WAIT 0
	
	IF IS_CHAR_DEAD yakuza_ped1_km1
		PRINT_NOW ( KM1_10 ) 5000 1 //"The Yakuza Kanbu is dead!"
		GOTO mission_kenji1_failed
	ENDIF
	   
   	IF NOT IS_CHAR_IN_PLAYERS_GROUP yakuza_ped1_km1 player
		
		IF flag_blip_on_yakuza_ped1_km1 = 0
			PRINT_NOW ( HEY6 ) 5000 1 //You have left the Yakuza Kanbu behind go and get him!"
			ADD_BLIP_FOR_CHAR yakuza_ped1_km1 radar_blip_ped1_km1
			flag_blip_on_yakuza_ped1_km1 = 1
			blob_flag = 0
		ENDIF

		IF flag_spray_blip_on_km1 = 1
			REMOVE_BLIP spray_blip_km1
			flag_spray_blip_on_km1 = 0
			flag_player_got_cops_message_km1 = 0
		ENDIF 
				
	ENDIF	
				
	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player yakuza_ped1_km1 8.0 8.0 FALSE
	AND flag_blip_on_yakuza_ped1_km1 = 1
		SET_PLAYER_AS_LEADER yakuza_ped1_km1 player
		REMOVE_BLIP radar_blip_ped1_km1
	   	flag_blip_on_yakuza_ped1_km1 = 0
		blob_flag = 1
	ENDIF
	   		
   	IF IS_WANTED_LEVEL_GREATER player 0
				
   		IF flag_player_got_cops_message_km1 = 0

			IF flag_blip_on_yakuza_ped1_km1 = 0
   				PRINT_NOW ( WANTED1 ) 7000 1 //"Get rid of the cops!"
				ADD_SPRITE_BLIP_FOR_COORD 379.0 -493.8 25.2 RADAR_SPRITE_SPRAY spray_blip_km1 
   				flag_player_got_cops_message_km1 = 1
				flag_spray_blip_on_km1 = 1
			ENDIF

		ENDIF
	ELSE
	 	flag_player_got_cops_message_km1 = 0

		IF flag_spray_blip_on_km1 = 1
			REMOVE_BLIP spray_blip_km1
			flag_spray_blip_on_km1 = 0
		ENDIF

	ENDIF

	IF flag_spray_blip_on_km1 = 0

		IF flag_blip_on_yakuza_ped1_km1 = 0

			IF flag_dojo_blip_on = 0
				ADD_BLIP_FOR_COORD 105.6 -1292.68 -100.0 radar_blip_coord3_km1
				PRINT_NOW ( KM1_3 ) 7000 1 //"Get me to the Dojo!"
				blob_flag = 1
				flag_dojo_blip_on = 1
			ENDIF

		ENDIF

	ENDIF

	IF flag_dojo_blip_on = 1
		
		IF flag_spray_blip_on_km1 = 1
		OR flag_blip_on_yakuza_ped1_km1 = 1
			REMOVE_BLIP radar_blip_coord3_km1
			blob_flag = 0
			flag_dojo_blip_on = 0
		ENDIF
		
	ENDIF  

ENDWHILE

REMOVE_BLIP radar_blip_coord3_km1

SET_PLAYER_CONTROL player OFF

SET_POLICE_IGNORE_PLAYER player ON

SET_EVERYONE_IGNORE_PLAYER player ON

SWITCH_WIDESCREEN ON

LEAVE_GROUP yakuza_ped1_km1

PLAY_MISSION_AUDIO

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CHAR_DEAD yakuza_ped1_km1
		PRINT_NOW ( KM1_10 ) 5000 1 //"The Yakuza Kanbu is dead!"
		GOTO mission_kenji1_failed
	ENDIF
	
ENDWHILE

SET_FIXED_CAMERA_POSITION 93.45 -1279.27 35.08 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 94.19 -1279.91 34.79 JUMP_CUT

SET_CHAR_RUNNING yakuza_ped1_km1 FALSE

// Tells ped to get out of car 

IF IS_CHAR_IN_ANY_CAR yakuza_ped1_km1

	STORE_CAR_CHAR_IS_IN yakuza_ped1_km1 car_km1
	
	SET_CHAR_OBJ_LEAVE_CAR yakuza_ped1_km1 car_km1
	
	WHILE IS_CHAR_IN_CAR yakuza_ped1_km1 car_km1
		
		WAIT 0

		IF IS_CHAR_DEAD yakuza_ped1_km1
			PRINT_NOW ( KM1_10 ) 5000 1 //"The Yakuza Kanbu is dead!"
			GOTO mission_kenji1_failed
		ENDIF

		IF IS_CAR_DEAD car_km1
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			GOTO mission_kenji1_failed
		ENDIF

	ENDWHILE

ENDIF

CLEAR_AREA 111.05 -1274.75 25.16 6.0 TRUE

SET_CHAR_OBJ_RUN_TO_COORD yakuza_ped1_km1 111.05 -1274.75

timerb = 0

WHILE NOT LOCATE_CHAR_ON_FOOT_3D yakuza_ped1_km1 111.05 -1274.75 25.16 2.0 2.0 2.0 FALSE

	WAIT 0

	IF IS_CHAR_DEAD yakuza_ped1_km1
		PRINT_NOW ( KM1_10 ) 5000 1 //"The Yakuza Kanbu is dead!"
		GOTO mission_kenji1_failed
	ENDIF

	IF timerb >= 8000

		IF NOT LOCATE_CHAR_ON_FOOT_3D yakuza_ped1_km1 111.05 -1274.75 25.16 2.0 2.0 2.0 FALSE
			REMOVE_CHAR_ELEGANTLY yakuza_ped1_km1
			GOTO mission_bloke_got_stuck_km1
		ENDIF
		
	ENDIF  
			
ENDWHILE

mission_bloke_got_stuck_km1:

DELETE_CHAR yakuza_ped1_km1

SWITCH_WIDESCREEN OFF

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

SET_EVERYONE_IGNORE_PLAYER player OFF

RESTORE_CAMERA_JUMPCUT

GOTO mission_kenji1_passed
	   		


// Mission Kemuri1 failed

mission_kenji1_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN

   

// mission Kemuri1 passed

mission_kenji1_passed:

flag_kenji_mission1_passed = 1
REGISTER_MISSION_PASSED ( KM1 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( m_pass ) 30000 5000 1 //"Mission Passed"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 30000
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT kenji_mission2_loop
RETURN
		


// mission cleanup

mission_cleanup_kenji1:

flag_player_on_mission = 0
flag_player_on_kenji_mission = 0
REMOVE_SOUND police_alarm
REMOVE_SOUND cell_beating
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_A
MARK_MODEL_AS_NO_LONGER_NEEDED rubble01
MARK_MODEL_AS_NO_LONGER_NEEDED rubble02 
REMOVE_BLIP radar_blip_coord1_km1
REMOVE_BLIP radar_blip_coord2_km1
REMOVE_BLIP radar_blip_coord3_km1
REMOVE_BLIP radar_blip_ped1_km1
REMOVE_BLIP spray_blip_km1
REMOVE_SPHERE sphere_km1
MISSION_HAS_FINISHED
RETURN
		


wall_explosion:

ADD_EXPLOSION 328.1 -1087.5 27.7 EXPLOSION_HELI
ADD_MOVING_PARTICLE_EFFECT POBJECT_FIREBALL_AND_SMOKE 328.1 -1088.3 26.0 0.0 0.0 0.0 4.0 0 0 0 3000
CREATE_OBJECT rubble02 328.1 -1084.1 27.0 debris1
CREATE_OBJECT rubble02 328.5 -1084.7 27.0 debris2
CREATE_OBJECT rubble01 326.6 -1083.7 26.0 debris3
CREATE_OBJECT rubble01 330.0 -1084.4 27.0 debris4
SET_OBJECT_DYNAMIC debris1 TRUE
SET_OBJECT_DYNAMIC debris2 TRUE
SET_OBJECT_DYNAMIC debris3 TRUE
SET_OBJECT_DYNAMIC debris4 TRUE 
SET_OBJECT_VELOCITY debris1 3.0 16.0 15.0
SET_OBJECT_VELOCITY debris2 -5.0 10.0 5.0
SET_OBJECT_VELOCITY debris3 7.0 7.0 7.0
SET_OBJECT_VELOCITY debris4 -4.0 13.0 10.0

RETURN

}	

MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************Kenji mission 2********************************* 
// ****************************************Gone In 30 Seconds*******************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME kenji2

// Mission start stuff

GOSUB mission_start_kenji2

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_kenji2_failed
	ENDIF

GOSUB mission_cleanup_kenji2

MISSION_END
 
// Variables For Mission

VAR_INT car_to_steal1_km2  //Testarossa

VAR_INT car_to_steal2_km2  //Viper

VAR_INT car_to_steal3_km2  //Boxter

VAR_INT car_to_steal4_km2 //Diablo

VAR_INT car_to_steal5_km2  //Offroad

VAR_INT radar_blip_coord1_km2

VAR_INT radar_blip_car1_km2

VAR_INT radar_blip_car2_km2

VAR_INT radar_blip_car3_km2

VAR_INT radar_blip_car4_km2

VAR_INT radar_blip_car5_km2

VAR_INT timer_km2

VAR_INT flag_player_damage_message_car1_km2 

VAR_INT flag_player_damage_message_car2_km2

VAR_INT flag_player_damage_message_car3_km2

VAR_INT flag_player_damage_message_car4_km2

VAR_INT flag_player_damage_message_car5_km2

VAR_INT flag_car1_in_garage

VAR_INT flag_car2_in_garage

VAR_INT flag_car3_in_garage

VAR_INT flag_car4_in_garage

VAR_INT flag_car5_in_garage

VAR_INT counter_number_of_cars_in_garage_km2

VAR_INT flag_blip_car1_on

VAR_INT flag_blip_car2_on

VAR_INT flag_blip_car3_on

VAR_INT flag_blip_car4_on

VAR_INT flag_blip_car5_on

VAR_INT flag_car1_destroyed

VAR_INT flag_car2_destroyed

VAR_INT flag_car3_destroyed

VAR_INT flag_car4_destroyed

VAR_INT flag_car5_destroyed

VAR_INT flag_garage_no_blip_car1_km2

VAR_INT flag_garage_no_blip_car2_km2

VAR_INT flag_garage_no_blip_car3_km2

VAR_INT flag_garage_no_blip_car4_km2

VAR_INT flag_garage_no_blip_car5_km2

VAR_INT flag_spray_blip_on_car1_km2

VAR_INT flag_spray_blip_on_car2_km2

VAR_INT flag_spray_blip_on_car3_km2

VAR_INT flag_spray_blip_on_car4_km2

VAR_INT flag_spray_blip_on_car5_km2

VAR_INT spray_blip_km2

VAR_INT flag_player_had_garage_car1_message

VAR_INT flag_player_had_garage_car2_message

VAR_INT flag_player_had_garage_car3_message

VAR_INT flag_player_had_garage_car4_message

VAR_INT flag_player_had_garage_car5_message  

// ****************************************Mission Start************************************

mission_start_kenji2:

flag_player_on_mission = 1

flag_player_on_kenji_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_player_damage_message_car1_km2 = 0

flag_player_damage_message_car2_km2 = 0

flag_player_damage_message_car3_km2 = 0

flag_player_damage_message_car4_km2 = 0

flag_player_damage_message_car5_km2 = 0

flag_car1_in_garage = 0

flag_car2_in_garage = 0

flag_car3_in_garage = 0

flag_car4_in_garage = 0

flag_car5_in_garage = 0

counter_number_of_cars_in_garage_km2 = 0

flag_blip_car1_on = 0

flag_blip_car2_on = 0

flag_blip_car3_on = 0

flag_blip_car4_on = 0

flag_blip_car5_on = 0

flag_car1_destroyed = 0

flag_car2_destroyed = 0

flag_car3_destroyed = 0

flag_car4_destroyed = 0

flag_car5_destroyed = 0

flag_garage_no_blip_car1_km2 = 0

flag_garage_no_blip_car2_km2 = 0

flag_garage_no_blip_car3_km2 = 0

flag_garage_no_blip_car4_km2 = 0

flag_garage_no_blip_car5_km2 = 0

flag_spray_blip_on_car1_km2 = 0

flag_spray_blip_on_car2_km2 = 0

flag_spray_blip_on_car3_km2 = 0

flag_spray_blip_on_car4_km2 = 0

flag_spray_blip_on_car5_km2 = 0

//timer_km2 = 601000  //10 mins for Obbe, Les

timer_km2 = 361000  //6 mins

flag_player_had_garage_car1_message = 0

flag_player_had_garage_car2_message = 0

flag_player_had_garage_car3_message = 0

flag_player_had_garage_car4_message = 0

flag_player_had_garage_car5_message = 0

{
// ****************************************START OF CUTSCENE********************************

/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_kenji2_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( KM2 ) 15000 2 //"Gone in Sixty"

SWITCH_STREAMING OFF
*/
 
// Cutscene stuff

LOAD_SPECIAL_CHARACTER 1 KENJI
LOAD_SPECIAL_MODEL cut_obj1 KENJIH 
LOAD_SPECIAL_MODEL cut_obj2 PLAYERH
LOAD_SPECIAL_MODEL cut_obj3 MINNOTE
REQUEST_MODEL casino_garden 

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED casino_garden
	 
	WAIT 0

ENDWHILE

//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor FALSE	

LOAD_CUTSCENE k2_gis

SET_CUTSCENE_OFFSET 476.380 -1382.168 67.347

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_kenji

SET_CUTSCENE_ANIM cs_kenji kenji

//CREATE_CUTSCENE_OBJECT PED_GANG_YAKUZA_A cs_yakuza

//SET_CUTSCENE_ANIM cs_yakuza gang07

CREATE_CUTSCENE_HEAD cs_kenji CUT_OBJ1 cs_kenjihead

SET_CUTSCENE_HEAD_ANIM cs_kenjihead kenji

CREATE_CUTSCENE_OBJECT cut_obj3 cs_note

SET_CUTSCENE_ANIM cs_note MINNOTE

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CLEAR_AREA 459.1 -1413.0 25.11 1.0 TRUE 

SET_PLAYER_COORDINATES player 459.1 -1413.0 25.11
							   
SET_PLAYER_HEADING player 132.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 3902
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM2_A ) 10000 1 //"It is impossible to over-estimate the importance of etiquette in this line of work."

WHILE cs_time < 8570
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM2_B ) 10000 1 //"To my eternal shame, a man once did me a favor and I have never had the opportunity to repay his kindness."

WHILE cs_time < 15119
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM2_C ) 10000 1 //"The man's weakness is motor cars and he has requested that we acquire him certain models for his collection."

WHILE cs_time < 21459
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM2_D ) 10000 1 //"Needless to say, we must give him the cars as a gift, to repay the debt that is owed to him."

WHILE cs_time < 27033
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM2_E ) 10000 1 //"You must obtain the cars on the list and deliver them to a garage behind the car park in Newport. My honor demands it.

WHILE cs_time < 33164
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM2_F ) 10000 1 //"My honor demands it."

WHILE cs_time < 34918
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( KM2_F )

WHILE cs_time < 39333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 


//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED casino_garden

// **************************************END OF CUSTSCENE***********************************

REQUEST_MODEL CAR_CHEETAH //car1 to steal 

REQUEST_MODEL CAR_STINGER  // car3 to steal

REQUEST_MODEL CAR_INFERNUS  // car4 to steal

//REQUEST_MODEL CAR_BANSHEE // car2 to steal

//REQUEST_MODEL CAR_LANDSTALKER  // car5 to steal

WHILE NOT HAS_MODEL_LOADED CAR_CHEETAH
OR NOT HAS_MODEL_LOADED CAR_STINGER
OR NOT HAS_MODEL_LOADED CAR_INFERNUS
//OR NOT HAS_MODEL_LOADED CAR_LANDSTALKER
//OR NOT HAS_MODEL_LOADED CAR_BANSHEE

	WAIT 0

ENDWHILE

PRINT_NOW ( KM2_3 ) 5000 1 //"~g~Remember the ~r~cars~g~ have to be in mint condition to be accepted by the ~p~garage~g~."

ADD_BLIP_FOR_CONTACT_POINT 375.0 -506.9 -100.0 radar_blip_coord1_km2

// creates car1 the testarossa

CREATE_CAR CAR_CHEETAH 348.3 -0.5 -100.0 car_to_steal1_km2

SET_CAR_HEADING car_to_steal1_km2 270.0

CHANGE_CAR_COLOUR car_to_steal1_km2 CARCOLOUR_RED4 CARCOLOUR_RED4

SET_CAN_RESPRAY_CAR car_to_steal1_km2 FALSE

ADD_BLIP_FOR_CAR car_to_steal1_km2 radar_blip_car1_km2

flag_blip_car1_on = 1

/*

// creates car2 the viper

CREATE_CAR CAR_BANSHEE 211.2 -312.4 15.5 car_to_steal2_km2

CHANGE_CAR_COLOUR car_to_steal2_km2 CARCOLOUR_RED4 CARCOLOUR_RED4

SET_CAN_RESPRAY_CAR car_to_steal2_km2 FALSE

ADD_BLIP_FOR_CAR car_to_steal2_km2 radar_blip_car2_km2

SET_CAR_HEADING car_to_steal2_km2 90.0 

flag_blip_car2_on = 1
*/

// creates car3 the boxster

CREATE_CAR CAR_STINGER -71.1 -1467.4 25.1 car_to_steal3_km2

CHANGE_CAR_COLOUR car_to_steal3_km2 CARCOLOUR_RED4 CARCOLOUR_RED4

SET_CAN_RESPRAY_CAR car_to_steal3_km2 FALSE

ADD_BLIP_FOR_CAR car_to_steal3_km2 radar_blip_car3_km2

SET_CAR_HEADING car_to_steal3_km2 270.0 

flag_blip_car3_on = 1

// creates car4 the Diablo

CREATE_CAR CAR_INFERNUS -61.7 -358.4 15.2 car_to_steal4_km2

CHANGE_CAR_COLOUR car_to_steal4_km2 CARCOLOUR_RED4 CARCOLOUR_RED4

SET_CAN_RESPRAY_CAR car_to_steal4_km2 FALSE

ADD_BLIP_FOR_CAR car_to_steal4_km2 radar_blip_car4_km2

SET_CAR_HEADING car_to_steal4_km2 90.0 

flag_blip_car4_on = 1


/*
// creates car5 the 4X4

CREATE_CAR CAR_LANDSTALKER 200.7 -1006.2 25.1 car_to_steal5_km2

CHANGE_CAR_COLOUR car_to_steal5_km2 CARCOLOUR_RED4 CARCOLOUR_RED4

SET_CAN_RESPRAY_CAR car_to_steal5_km2 FALSE

ADD_BLIP_FOR_CAR car_to_steal5_km2 radar_blip_car5_km2

SET_CAR_HEADING car_to_steal5_km2 90.0 

flag_blip_car5_on = 1

*/

DISPLAY_ONSCREEN_TIMER timer_km2

// waiting for all 5 vehicles to be in the range

WHILE timer_km2 > 0

	WAIT 0
	
 	IF counter_number_of_cars_in_garage_km2 = 3
		GOTO mission_kenji2_passed
	ENDIF
   
// if player in car checks for car damage and blip stuff

// checks for car 1

IF flag_car1_in_garage = 0

	IF IS_CAR_IN_MISSION_GARAGE garage_km2 // Testarossa
	AND flag_garage_no_blip_car1_km2 = 1
		flag_car1_destroyed = 1
		++ counter_number_of_cars_in_garage_km2
		ADD_ONE_OFF_SOUND 380.3 -506.8 26.1 SOUND_PART_MISSION_COMPLETE
		PRINT_NOW ( KM2_2 ) 5000 1 //"Car delivered"
		IF NOT IS_CAR_DEAD car_to_steal1_km2
			DELETE_CAR car_to_steal1_km2
		ENDIF
		flag_car1_in_garage = 1
	ENDIF


	IF flag_car1_destroyed = 0
				
		IF IS_CAR_DEAD car_to_steal1_km2
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			flag_car1_destroyed = 1
			GOTO mission_kenji2_failed
		ELSE
		
			IF IS_CAR_UPSIDEDOWN car_to_steal1_km2
			AND IS_CAR_STOPPED car_to_steal1_km2
				PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
				GOTO mission_kenji2_failed
			ENDIF
			
		ENDIF 										  
					
		IF IS_CAR_STOPPED_IN_AREA_3D car_to_steal1_km2 377.3 -511.4 25.1132 383.7 -502.0 30.0 FALSE

			IF NOT IS_CAR_VISIBLY_DAMAGED car_to_steal1_km2
				flag_garage_no_blip_car1_km2 = 1
			ENDIF

			IF DOES_GARAGE_CONTAIN_CAR garage_km2 car_to_steal1_km2

				IF flag_player_had_garage_car1_message = 0
					PRINT_NOW ( GARAGE1 ) 5000 1 //"Get out of the vehicle and walk outside!" 
					flag_player_had_garage_car1_message = 1

					// reset route to garage
					REMOVE_BLIP radar_blip_coord1_km2
					ADD_BLIP_FOR_CONTACT_POINT 375.0 -506.9 -100.0 radar_blip_coord1_km2
				ENDIF

			ELSE
				flag_player_had_garage_car1_message = 0
			ENDIF

		ELSE
			flag_garage_no_blip_car1_km2 = 0
		ENDIF
								
		IF IS_PLAYER_IN_CAR player car_to_steal1_km2
						
			IF flag_blip_car1_on = 1
				REMOVE_BLIP radar_blip_car1_km2

				// route back to the garage
				REMOVE_BLIP radar_blip_coord1_km2
				ADD_BLIP_FOR_COORD 375.0 -506.9 -100.0 radar_blip_coord1_km2

				flag_blip_car1_on = 0
			ENDIF

				IF IS_CAR_VISIBLY_DAMAGED car_to_steal1_km2 

					IF flag_player_damage_message_car1_km2 = 0
						PRINT_NOW ( KM2_1 ) 7000 1 //"Get the car reapaired the boss wants it mint!"
						SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 -1
						flag_player_damage_message_car1_km2 = 1
					ENDIF

					IF flag_spray_blip_on_car1_km2 = 0
						ADD_SPRITE_BLIP_FOR_COORD 379.0 -493.8 25.2 RADAR_SPRITE_SPRAY spray_blip_km2
						flag_spray_blip_on_car1_km2 = 1
					ENDIF
										
				ELSE
										
					SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 car_to_steal1_km2

					flag_player_damage_message_car1_km2 = 0

					IF flag_spray_blip_on_car1_km2 = 1
						REMOVE_BLIP spray_blip_km2
						flag_spray_blip_on_car1_km2 = 0
					ENDIF
									   				   
				ENDIF
		ELSE

			flag_player_damage_message_car1_km2 = 0
						
			IF flag_spray_blip_on_car1_km2 = 1
				REMOVE_BLIP spray_blip_km2
				flag_spray_blip_on_car1_km2 = 0
			ENDIF
									
			IF flag_blip_car1_on = 0

				IF flag_garage_no_blip_car1_km2 = 0
					ADD_BLIP_FOR_CAR car_to_steal1_km2 radar_blip_car1_km2

					// reset route to garage
					REMOVE_BLIP radar_blip_coord1_km2
					ADD_BLIP_FOR_CONTACT_POINT 375.0 -506.9 -100.0 radar_blip_coord1_km2

					SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 -1
					flag_blip_car1_on = 1
				ENDIF

			ENDIF
				
		ENDIF
	
	ENDIF

ENDIF


/*

// checks for car 2

IF flag_car2_in_garage = 0

	IF IS_CAR_IN_MISSION_GARAGE garage_km2 // Viper
	AND flag_garage_no_blip_car2_km2 = 1
		flag_car2_destroyed = 1
		++ counter_number_of_cars_in_garage_km2
		ADD_ONE_OFF_SOUND 380.3 -506.8 26.1 SOUND_PART_MISSION_COMPLETE
		PRINT_NOW ( KM2_2 ) 5000 1 //"Car delivered"
		flag_car2_in_garage = 1
	ENDIF

	IF flag_car2_destroyed = 0

		IF IS_CAR_DEAD car_to_steal2_km2
			 PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			flag_car2_destroyed = 1
			GOTO mission_kenji2_failed
		ELSE

			IF IS_CAR_UPSIDEDOWN car_to_steal2_km2
			AND IS_CAR_STOPPED car_to_steal2_km2 
				 PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
				GOTO mission_kenji2_failed
			ENDIF

		ENDIF

		IF IS_CAR_STOPPED_IN_AREA_3D car_to_steal2_km2 377.3 -511.4 25.1132 383.7 -502.0 30.0 FALSE

			IF NOT IS_CAR_VISIBLY_DAMAGED car_to_steal2_km2 
				flag_garage_no_blip_car2_km2 = 1
			ENDIF

			IF DOES_GARAGE_CONTAIN_CAR garage_km2 car_to_steal2_km2

				IF flag_player_had_garage_car2_message = 0
					PRINT_NOW ( GARAGE1 ) 5000 1 //"Get out of the vehicle and walk outside!" 
					flag_player_had_garage_car2_message = 1

					// reset route to garage
					REMOVE_BLIP radar_blip_coord1_km2
					ADD_BLIP_FOR_CONTACT_POINT 375.0 -506.9 -100.0 radar_blip_coord1_km2
				ENDIF

			ELSE
				flag_player_had_garage_car2_message = 0
			ENDIF

		ELSE
			flag_garage_no_blip_car2_km2 = 0
		ENDIF

						
		IF IS_PLAYER_IN_CAR player car_to_steal2_km2
			
			IF flag_blip_car2_on = 1
				REMOVE_BLIP radar_blip_car2_km2
				flag_blip_car2_on = 0

				// route back to the garage
				REMOVE_BLIP radar_blip_coord1_km2
				ADD_BLIP_FOR_COORD 375.0 -506.9 -100.0 radar_blip_coord1_km2
			ENDIF

				IF IS_CAR_VISIBLY_DAMAGED car_to_steal2_km2 
										
					IF flag_player_damage_message_car2_km2 = 0
						PRINT_NOW ( KM2_1 ) 7000 1 //"Get the car reapaired the boss wants it mint!"
						SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 -1
						flag_player_damage_message_car2_km2 = 1
					ENDIF

					IF flag_spray_blip_on_car2_km2 = 0
						ADD_SPRITE_BLIP_FOR_COORD 379.0 -493.8 25.2 RADAR_SPRITE_SPRAY spray_blip_km2
						flag_spray_blip_on_car2_km2 = 1
					ENDIF
				   				   					
				ELSE

					SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 car_to_steal2_km2
					flag_player_damage_message_car2_km2 = 0

					IF flag_spray_blip_on_car2_km2 = 1
						REMOVE_BLIP spray_blip_km2
						flag_spray_blip_on_car2_km2 = 0
					ENDIF
								
				ENDIF
   		ELSE
			flag_player_damage_message_car2_km2 = 0

			IF flag_spray_blip_on_car2_km2 = 1
				REMOVE_BLIP spray_blip_km2
				flag_spray_blip_on_car2_km2 = 0
			ENDIF

			IF flag_blip_car2_on = 0

				IF flag_garage_no_blip_car2_km2 = 0
					ADD_BLIP_FOR_CAR car_to_steal2_km2 radar_blip_car2_km2
					SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 -1
					flag_blip_car2_on = 1

					// reset route to garage
					REMOVE_BLIP radar_blip_coord1_km2
					ADD_BLIP_FOR_CONTACT_POINT 375.0 -506.9 -100.0 radar_blip_coord1_km2
				ENDIF
				
			ENDIF

		ENDIF

	ENDIF
	
ENDIF

*/


// checks for car 3

IF flag_car3_in_garage = 0

	IF IS_CAR_IN_MISSION_GARAGE garage_km2 // Boxter
	AND flag_garage_no_blip_car3_km2 = 1
		flag_car3_destroyed = 1
		++ counter_number_of_cars_in_garage_km2
		ADD_ONE_OFF_SOUND 380.3 -506.8 26.1 SOUND_PART_MISSION_COMPLETE
		PRINT_NOW ( KM2_2 ) 5000 1 //"Car delivered"
		IF NOT IS_CAR_DEAD car_to_steal3_km2
			DELETE_CAR car_to_steal3_km2
		ENDIF
		flag_car3_in_garage = 1
	ENDIF

	IF flag_car3_destroyed = 0

		IF IS_CAR_DEAD car_to_steal3_km2
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			flag_car3_destroyed = 1
			GOTO mission_kenji2_failed
		ELSE

			IF IS_CAR_UPSIDEDOWN car_to_steal3_km2
			AND IS_CAR_STOPPED car_to_steal3_km2
				PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
				GOTO mission_kenji2_failed
			ENDIF

		ENDIF

		IF IS_CAR_STOPPED_IN_AREA_3D car_to_steal3_km2 377.3 -511.4 25.1132 383.7 -502.0 30.0 FALSE

			IF NOT IS_CAR_VISIBLY_DAMAGED car_to_steal3_km2
				flag_garage_no_blip_car3_km2 = 1
			ENDIF

			IF DOES_GARAGE_CONTAIN_CAR garage_km2 car_to_steal3_km2
			
				IF flag_player_had_garage_car3_message = 0
					PRINT_NOW ( GARAGE1 ) 5000 1 //"Get out of the vehicle and walk outside!" 
					flag_player_had_garage_car3_message = 1

					// reset route to garage
					REMOVE_BLIP radar_blip_coord1_km2
					ADD_BLIP_FOR_CONTACT_POINT 375.0 -506.9 -100.0 radar_blip_coord1_km2
				ENDIF

			ELSE
				flag_player_had_garage_car3_message = 0
			ENDIF

		ELSE
			flag_garage_no_blip_car3_km2 = 0
		ENDIF

						
			IF IS_PLAYER_IN_CAR player car_to_steal3_km2
								
				IF flag_blip_car3_on = 1
					REMOVE_BLIP radar_blip_car3_km2
					flag_blip_car3_on = 0

					// route back to the garage
					REMOVE_BLIP radar_blip_coord1_km2
					ADD_BLIP_FOR_COORD 375.0 -506.9 -100.0 radar_blip_coord1_km2
				ENDIF
					  
					IF IS_CAR_VISIBLY_DAMAGED car_to_steal3_km2 
					
						IF flag_player_damage_message_car3_km2 = 0
							PRINT_NOW ( KM2_1 ) 7000 1 //"Get the car reapaired the boss wants it mint!"
							SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 -1
							flag_player_damage_message_car3_km2 = 1
						ENDIF
						
						IF flag_spray_blip_on_car3_km2 = 0
							ADD_SPRITE_BLIP_FOR_COORD 379.0 -493.8 25.2 RADAR_SPRITE_SPRAY spray_blip_km2
							flag_spray_blip_on_car3_km2 = 1
						ENDIF	

					ELSE
					   
						SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 car_to_steal3_km2
						flag_player_damage_message_car3_km2 = 0

						IF flag_spray_blip_on_car3_km2 = 1
							REMOVE_BLIP spray_blip_km2
							flag_spray_blip_on_car3_km2 = 0
						ENDIF

					ENDIF
			ELSE
				flag_player_damage_message_car3_km2 = 0

				IF flag_spray_blip_on_car3_km2 = 1
					REMOVE_BLIP spray_blip_km2
					flag_spray_blip_on_car3_km2 = 0
				ENDIF

				IF flag_blip_car3_on = 0

					IF flag_garage_no_blip_car3_km2 = 0
						ADD_BLIP_FOR_CAR car_to_steal3_km2 radar_blip_car3_km2
						SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 -1
						flag_blip_car3_on = 1

						// reset route to garage
						REMOVE_BLIP radar_blip_coord1_km2
						ADD_BLIP_FOR_CONTACT_POINT 375.0 -506.9 -100.0 radar_blip_coord1_km2
					ENDIF

				ENDIF

			ENDIF

	ENDIF
		
ENDIF


// checks for car 4

IF flag_car4_in_garage = 0

	IF IS_CAR_IN_MISSION_GARAGE garage_km2 // Diablo
	AND flag_garage_no_blip_car4_km2 = 1
		flag_car4_destroyed = 1
		++ counter_number_of_cars_in_garage_km2
		ADD_ONE_OFF_SOUND 380.3 -506.8 26.1 SOUND_PART_MISSION_COMPLETE
		PRINT_NOW ( KM2_2 ) 5000 1 //"Car delivered"
		IF NOT IS_CAR_DEAD car_to_steal4_km2
			DELETE_CAR car_to_steal4_km2
		ENDIF
		flag_car4_in_garage = 1
	ENDIF

	IF flag_car4_destroyed = 0

		IF IS_CAR_DEAD car_to_steal4_km2
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			flag_car4_destroyed = 1
			GOTO mission_kenji2_failed
		ELSE

			IF IS_CAR_UPSIDEDOWN car_to_steal4_km2
			AND IS_CAR_STOPPED car_to_steal4_km2
				PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
				GOTO mission_kenji2_failed
			ENDIF

		ENDIF

		IF IS_CAR_STOPPED_IN_AREA_3D car_to_steal4_km2 377.3 -511.4 25.1132 383.7 -502.0 30.0 FALSE

			IF NOT IS_CAR_VISIBLY_DAMAGED car_to_steal4_km2
				flag_garage_no_blip_car4_km2 = 1
			ENDIF

			IF DOES_GARAGE_CONTAIN_CAR garage_km2 car_to_steal4_km2

				IF flag_player_had_garage_car4_message = 0
					PRINT_NOW ( GARAGE1 ) 5000 1 //"Get out of the vehicle and walk outside!" 
					flag_player_had_garage_car4_message = 1

					// reset route to garage
					REMOVE_BLIP radar_blip_coord1_km2
					ADD_BLIP_FOR_CONTACT_POINT 375.0 -506.9 -100.0 radar_blip_coord1_km2
				ENDIF

			ELSE
				flag_player_had_garage_car4_message = 0
			ENDIF

		ELSE
			flag_garage_no_blip_car4_km2 = 0
		ENDIF
						
			IF IS_PLAYER_IN_CAR player car_to_steal4_km2
								
				IF flag_blip_car4_on = 1
					REMOVE_BLIP radar_blip_car4_km2
					flag_blip_car4_on = 0

					// route back to the garage
					REMOVE_BLIP radar_blip_coord1_km2
					ADD_BLIP_FOR_COORD 375.0 -506.9 -100.0 radar_blip_coord1_km2
				ENDIF
				  
				IF IS_CAR_VISIBLY_DAMAGED car_to_steal4_km2

					IF flag_player_damage_message_car4_km2 = 0
						PRINT_NOW ( KM2_1 ) 7000 1 //"Get the car reapaired the boss wants it mint!"
						SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 -1
						flag_player_damage_message_car4_km2 = 1
					ENDIF

					IF flag_spray_blip_on_car4_km2 = 0
						ADD_SPRITE_BLIP_FOR_COORD 379.0 -493.8 25.2 RADAR_SPRITE_SPRAY spray_blip_km2
						flag_spray_blip_on_car4_km2 = 1
					ENDIF
																			   
				ELSE

					SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 car_to_steal4_km2
					flag_player_damage_message_car4_km2 = 0

					IF flag_spray_blip_on_car4_km2 = 1
						REMOVE_BLIP spray_blip_km2
						flag_spray_blip_on_car4_km2 = 0
					ENDIF
					
				ENDIF
			ELSE
				flag_player_damage_message_car4_km2 = 0

				IF flag_spray_blip_on_car4_km2 = 1
					REMOVE_BLIP spray_blip_km2
					flag_spray_blip_on_car4_km2 = 0
				ENDIF

				IF flag_blip_car4_on = 0

					IF flag_garage_no_blip_car4_km2 = 0
						ADD_BLIP_FOR_CAR car_to_steal4_km2 radar_blip_car4_km2
						SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 -1
						flag_blip_car4_on = 1

						// reset route to garage
						REMOVE_BLIP radar_blip_coord1_km2
						ADD_BLIP_FOR_CONTACT_POINT 375.0 -506.9 -100.0 radar_blip_coord1_km2
					ENDIF		
				ENDIF
			ENDIF
	ENDIF

ENDIF

/*

// checks for car 5

IF flag_car5_in_garage = 0

	IF IS_CAR_IN_MISSION_GARAGE garage_km2 // Offroad
	AND flag_garage_no_blip_car5_km2 = 1
		flag_car5_destroyed = 1
		++ counter_number_of_cars_in_garage_km2
		ADD_ONE_OFF_SOUND 380.3 -506.8 26.1 SOUND_PART_MISSION_COMPLETE
		PRINT_NOW ( KM2_2 ) 5000 1 //"Car delivered"
		flag_car5_in_garage = 1
	ENDIF


	IF flag_car5_destroyed = 0

		IF IS_CAR_DEAD car_to_steal5_km2
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
			flag_car5_destroyed = 1
			GOTO mission_kenji2_failed
		ELSE

			IF IS_CAR_UPSIDEDOWN car_to_steal5_km2
			AND IS_CAR_STOPPED car_to_steal5_km2
				PRINT_NOW ( UPSIDE ) 5000 1 //You've flipped your wheels!"
				GOTO mission_kenji2_failed
			ENDIF

		ENDIF

		IF IS_CAR_STOPPED_IN_AREA_3D car_to_steal5_km2 377.3 -511.4 25.1132 383.7 -502.0 30.0 FALSE
			
			IF NOT IS_CAR_VISIBLY_DAMAGED car_to_steal5_km2
				flag_garage_no_blip_car5_km2 = 1
			ENDIF

			IF DOES_GARAGE_CONTAIN_CAR garage_km2 car_to_steal5_km2
			
				IF flag_player_had_garage_car5_message = 0
					PRINT_NOW ( GARAGE1 ) 5000 1 //"Get out of the vehicle and walk outside!" 
					flag_player_had_garage_car5_message = 1

					// reset route to garage
					REMOVE_BLIP radar_blip_coord1_km2
					ADD_BLIP_FOR_CONTACT_POINT 375.0 -506.9 -100.0 radar_blip_coord1_km2
				ENDIF

			ELSE
				flag_player_had_garage_car5_message = 0
			ENDIF

		ELSE
			flag_garage_no_blip_car5_km2 = 0
		ENDIF

						
			IF IS_PLAYER_IN_CAR player car_to_steal5_km2
								
				IF flag_blip_car5_on = 1
					REMOVE_BLIP radar_blip_car5_km2
					flag_blip_car5_on = 0

					// route back to the garage
					REMOVE_BLIP radar_blip_coord1_km2
					ADD_BLIP_FOR_COORD 375.0 -506.9 -100.0 radar_blip_coord1_km2
				ENDIF
			   	 
				IF IS_CAR_VISIBLY_DAMAGED car_to_steal5_km2
					
					IF flag_player_damage_message_car5_km2 = 0
						PRINT_NOW ( KM2_1 ) 7000 1 //"Get the car reapaired the boss wants it mint!"
						SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 -1
						flag_player_damage_message_car5_km2 = 1
					ENDIF

					IF flag_spray_blip_on_car5_km2 = 0
						ADD_SPRITE_BLIP_FOR_COORD 379.0 -493.8 25.2 RADAR_SPRITE_SPRAY spray_blip_km2
						flag_spray_blip_on_car5_km2 = 1
					ENDIF
																				
				ELSE

					SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 car_to_steal5_km2
					flag_player_damage_message_car5_km2 = 0
					
					IF flag_spray_blip_on_car5_km2 = 1
						REMOVE_BLIP spray_blip_km2
						flag_spray_blip_on_car5_km2 = 0
					ENDIF

				ENDIF
			ELSE
				flag_player_damage_message_car5_km2 = 0

				IF flag_spray_blip_on_car5_km2 = 1
					REMOVE_BLIP spray_blip_km2
					flag_spray_blip_on_car5_km2 = 0
				ENDIF

				IF flag_blip_car5_on = 0

					IF flag_garage_no_blip_car5_km2 = 0
						ADD_BLIP_FOR_CAR car_to_steal5_km2 radar_blip_car5_km2
						SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 -1
						flag_blip_car5_on = 1

						// reset route to garage
						REMOVE_BLIP radar_blip_coord1_km2
						ADD_BLIP_FOR_CONTACT_POINT 375.0 -506.9 -100.0 radar_blip_coord1_km2
					ENDIF
									
				ENDIF
			 
		  	ENDIF
	ENDIF
	
ENDIF

*/
		
ENDWHILE
	
PRINT_NOW ( OUTTIME ) 5000 1 //"Out of time!"
GOTO mission_kenji2_failed
	   		


// Mission Kenji5 failed

mission_kenji2_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN

   

// mission Kenji5 passed

mission_kenji2_passed:

flag_kenji_mission2_passed = 1
REGISTER_MISSION_PASSED ( KM2 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( m_pass ) 25000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 25000
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT kenji_mission3_loop
RETURN
		


// mission cleanup

mission_cleanup_kenji2:

flag_player_on_mission = 0
flag_player_on_kenji_mission = 0
SET_TARGET_CAR_FOR_MISSION_GARAGE garage_km2 -1
CLEAR_ONSCREEN_TIMER timer_km2
REMOVE_BLIP radar_blip_coord1_km2
REMOVE_BLIP radar_blip_car1_km2
//REMOVE_BLIP radar_blip_car2_km2
REMOVE_BLIP radar_blip_car3_km2
REMOVE_BLIP radar_blip_car4_km2
//REMOVE_BLIP radar_blip_car5_km2
REMOVE_BLIP spray_blip_km2
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_CHEETAH
//MARK_MODEL_AS_NO_LONGER_NEEDED CAR_BANSHEE
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STINGER
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_INFERNUS
//MARK_MODEL_AS_NO_LONGER_NEEDED CAR_LANDSTALKER
MISSION_HAS_FINISHED
RETURN
	
}
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************Kenji Mission 3********************************* 
// *******************************************Deal Steal************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME kenji3

// Mission start stuff

GOSUB mission_start_kenji3

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_kenji3_failed
	ENDIF

GOSUB mission_cleanup_kenji3

MISSION_END
 
// Variables for mission

VAR_INT colombian_car1_km3

VAR_INT colombian_car2_km3

VAR_INT colombian1_km3

VAR_INT colombian2_km3

VAR_INT colombian5_km3

VAR_INT colombian6_km3

VAR_INT yakuza1_km3

VAR_INT counter_number_of_yardies_dead_km3

VAR_INT radar_blip_yardie_car_km3

VAR_INT radar_blip_ped1_km3

VAR_INT radar_blip_coord2_km3

VAR_INT flag_player_had_car_message_km3

VAR_INT flag_player_had_repair_message_km3

VAR_INT flag_player_been_bad_km3

VAR_INT radar_blip_colombian_car1_km3

VAR_INT radar_blip_colombian_car2_km3

VAR_INT radar_blip_colombian1_km3

VAR_INT radar_blip_colombian2_km3

VAR_INT radar_blip_colombian5_km3

VAR_INT radar_blip_colombian6_km3

VAR_INT counter_number_of_colombians_killed_km3

VAR_INT counter_all_colombian_cars_dead_km3

VAR_INT flag_colombian1_dead_km3

VAR_INT flag_colombian2_dead_km3

VAR_INT flag_colombian5_dead_km3

VAR_INT flag_colombian6_dead_km3

VAR_INT flag_colombian_car1_dead_km3

VAR_INT flag_colombian_car2_dead_km3

VAR_INT car_km3 // TEST TO COME OUT

VAR_INT flag_yakuza1_km3_dead

VAR_INT car2_km3

VAR_INT car3_km3

VAR_INT car_cut_km3

VAR_INT car_yardie

VAR_INT flag_blip_on_yakuza_km3

VAR_INT flag_yakuza_message_km3

VAR_INT flag_bloke_in_car_km3

VAR_INT flag_car1_created_km3

VAR_INT flag_car2_created_km3

VAR_INT money_km3

VAR_INT radar_blip_money_km3

VAR_INT money_been_picked_up_km3

VAR_INT radar_blip_coord3_km3

VAR_INT flag_money_created_km3

VAR_INT flag_go_for_player_km3

VAR_INT flag_trap_audio_removed_km3

VAR_INT flag_helper_not_in_car_km3

// ****************************************Mission Start************************************

mission_start_kenji3:

flag_player_on_mission = 1

flag_player_on_kenji_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_player_had_car_message_km3 = 0

flag_player_been_bad_km3 = 0

counter_number_of_colombians_killed_km3 = 0

counter_all_colombian_cars_dead_km3 = 0

flag_colombian1_dead_km3 = 0

flag_colombian2_dead_km3 = 0

flag_colombian5_dead_km3 = 0

flag_colombian6_dead_km3 = 0

flag_colombian_car1_dead_km3 = 0

flag_colombian_car2_dead_km3 = 0

flag_yakuza1_km3_dead = 0

flag_blip_on_yakuza_km3 = 0

blob_flag = 1

flag_yakuza_message_km3 = 0

flag_bloke_in_car_km3 = 0

flag_car1_created_km3 = 0

flag_car2_created_km3 = 0

money_been_picked_up_km3 = 0

flag_money_created_km3 = 0

flag_go_for_player_km3 = 0

flag_trap_audio_removed_km3 = 0

flag_helper_not_in_car_km3 = 0

SWITCH_ROADS_OFF 121.814 -46.429 14.0 363.858 54.312 20.0
SWITCH_PED_ROADS_OFF 121.814 -46.429 14.0 363.858 54.312 20.0

{

// ****************************************START OF CUTSCENE********************************

/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_kenji3_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( KM3 ) 15000 2  //"Kenji Mission 3"

SWITCH_STREAMING OFF
*/

// Cutscene stuff

LOAD_SPECIAL_CHARACTER 1 KENJI
REQUEST_MODEL PED_GANG_YAKUZA_A 
LOAD_SPECIAL_MODEL cut_obj1 KENJIH 
LOAD_SPECIAL_MODEL cut_obj2 PLAYERH
REQUEST_MODEL casino_garden 

/*
WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE
*/

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED PED_GANG_YAKUZA_A 
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED casino_garden
	
	WAIT 0

ENDWHILE

//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor FALSE	

LOAD_CUTSCENE k3_ds

SET_CUTSCENE_OFFSET 476.380 -1382.168 67.347

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_kenji

SET_CUTSCENE_ANIM cs_kenji kenji

CREATE_CUTSCENE_OBJECT PED_GANG_YAKUZA_A cs_yakuza

SET_CUTSCENE_ANIM cs_yakuza gang07

CREATE_CUTSCENE_HEAD cs_kenji CUT_OBJ1 cs_kenjihead

SET_CUTSCENE_HEAD_ANIM cs_kenjihead kenji

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CLEAR_AREA 459.1 -1413.0 25.11 1.0 TRUE 

SET_PLAYER_COORDINATES player 459.1 -1413.0 25.11
							   
SET_PLAYER_HEADING player 132.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 1533
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM3_A ) 10000 1 //"When trouble looms, the fool turns his back, while the wise man faces it down."

WHILE cs_time < 6549
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM3_B ) 10000 1 //"The Colombian Cartel have ignored repeated requests to leave our interests in Liberty well alone."

WHILE cs_time < 11426
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM3_C ) 10000 1 //"Now they are negotiating terms with the Jamaicans in order to humiliate us further."

WHILE cs_time < 15676
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM3_D ) 10000 1 //"They are finalizing a deal across town. Take some of my men, steal a Yardie car and go pay your respects to the Colombians."

WHILE cs_time < 17697
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM3_F ) 10000 1 //"Take one of my men, steal a Yardie car and go pay your respects to the Colombians."

WHILE cs_time < 22086
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM3_E ) 10000 1 //"Our honor demands that you leave no one alive."

WHILE cs_time < 24442
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( KM3_E )

WHILE cs_time < 25000//24666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 


//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED casino_garden


// *******************************************END OF CUTSCENE*******************************

REQUEST_MODEL CAR_YARDIE

REQUEST_MODEL CAR_COLUMB

REQUEST_MODEL PED_GANG_YARDIE_A

REQUEST_MODEL PED_GANG_COLOMBIAN_A

WHILE NOT HAS_MODEL_LOADED CAR_YARDIE
OR NOT HAS_MODEL_LOADED PED_GANG_YARDIE_A
OR NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_A
OR NOT HAS_MODEL_LOADED CAR_COLUMB
 	
	WAIT 0

ENDWHILE
 
PRINT_NOW ( KM3_1 ) 7000 1 //"First go and get the yardie car!"

// waiting for the player to steal a yardie car

LOAD_MISSION_AUDIO K3_A

WHILE NOT IS_PLAYER_IN_MODEL player CAR_YARDIE
OR NOT HAS_MISSION_AUDIO_LOADED
	
	WAIT 0
		   
ENDWHILE

PRINT_NOW ( KM3_2 ) 7000 1 //"Good now pick up the boys in the yardie car, press the horn to get them into the car!"

// yakuza bloke 1

CREATE_CHAR PEDTYPE_CIVMALE PED_GANG_YAKUZA_A 99.6 -414.3 -100.0 yakuza1_km3

CLEAR_CHAR_THREAT_SEARCH yakuza1_km3

SET_CHAR_PERSONALITY yakuza1_km3 PEDSTAT_TOUGH_GUY

SET_CHAR_HEADING yakuza1_km3 0.0

GIVE_WEAPON_TO_CHAR yakuza1_km3 WEAPONTYPE_UZI 30000 // sets weapon to infinate ammo

ADD_BLIP_FOR_CHAR yakuza1_km3 radar_blip_ped1_km3

// waiting for the player to reach the yakuza gang members

WHILE NOT LOCATE_PLAYER_IN_CAR_CHAR_3D player yakuza1_km3 8.0 8.0 8.0 FALSE
OR NOT IS_PLAYER_IN_MODEL player CAR_YARDIE
OR NOT IS_PLAYER_STOPPED player

	WAIT 0

	IF IS_CHAR_DEAD yakuza1_km3
		PRINT_NOW ( KM3_10 ) 5000 1 //"The contact is dead!"
		flag_yakuza1_km3_dead = 1
		GOTO mission_kenji3_failed
	ENDIF 
		
	IF NOT IS_PLAYER_IN_MODEL player CAR_YARDIE
	AND flag_player_had_car_message_km3 = 0
		PRINT_NOW ( KM3_8 ) 7000 1 //"Get a Yardie car and get on with the mission!"
		REMOVE_BLIP radar_blip_ped1_km3
		flag_player_had_car_message_km3 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_MODEL player CAR_YARDIE
	AND flag_player_had_car_message_km3 = 1
		ADD_BLIP_FOR_CHAR yakuza1_km3 radar_blip_ped1_km3
		flag_player_had_car_message_km3 = 0
		blob_flag = 1
	ENDIF

	IF IS_PLAYER_IN_MODEL player CAR_YARDIE
		STORE_CAR_PLAYER_IS_IN player car_yardie
	ENDIF 

ENDWHILE

SET_PLAYER_AS_LEADER yakuza1_km3 player
REMOVE_BLIP radar_blip_ped1_km3

// waiting for the yakuza guy to get into the players car and give his message

WHILE NOT IS_CHAR_IN_CAR yakuza1_km3 car_yardie     //LOCATE_PLAYER_IN_CAR_CHAR_3D player yakuza1_km3 1.0 1.0 3.0 FALSE
OR NOT IS_PLAYER_IN_MODEL player CAR_YARDIE         //Changed from locate because it allowed the player to proceed with the car on top of the contact  
//OR NOT IS_PLAYER_STOPPED player
	
		WAIT 0

		IF IS_PLAYER_IN_MODEL player CAR_YARDIE
			STORE_CAR_PLAYER_IS_IN player car_yardie
		ENDIF 

		IF IS_CHAR_DEAD yakuza1_km3
			PRINT_NOW ( KM3_10 ) 5000 1 //"The contact is dead!"
			flag_yakuza1_km3_dead = 1
			GOTO mission_kenji3_failed
		ENDIF 
		
		IF NOT IS_PLAYER_IN_MODEL player CAR_YARDIE
		AND flag_player_had_car_message_km3 = 0
			PRINT_NOW ( KM3_8 ) 7000 1 //"Get a Yardie car and get on with the mission!"
			REMOVE_BLIP radar_blip_ped1_km3
			flag_player_had_car_message_km3 = 1
			blob_flag = 0
		ENDIF

		IF IS_PLAYER_IN_MODEL player CAR_YARDIE
		AND flag_player_had_car_message_km3 = 1
			ADD_BLIP_FOR_CHAR yakuza1_km3 radar_blip_ped1_km3
			flag_player_had_car_message_km3 = 0
			blob_flag = 1
		ENDIF

		IF NOT IS_CHAR_IN_PLAYERS_GROUP yakuza1_km3 player
		AND flag_yakuza_message_km3 = 0
			PRINT_NOW ( HEY9 ) 5000 1 //"You have not got the information from the contact go back and get it."
			ADD_BLIP_FOR_CHAR yakuza1_km3 radar_blip_ped1_km3
			flag_yakuza_message_km3 = 1
		ENDIF
	
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player yakuza1_km3 8.0 8.0 FALSE
		AND flag_yakuza_message_km3 = 1
			SET_PLAYER_AS_LEADER yakuza1_km3 player
			REMOVE_BLIP radar_blip_ped1_km3
			flag_yakuza_message_km3 = 0
		ENDIF
ENDWHILE

REMOVE_BLIP radar_blip_ped1_km3

PRINT_NOW ( KM3_3 ) 5000 1 //"Okay the meeting is being held at XXXXXXX!"

ADD_BLIP_FOR_COORD 231.1 -26.3 -100.0 radar_blip_coord2_km3

// Colombian car 1

CREATE_CAR CAR_COLUMB 230.3 -42.2 -100.0 colombian_car1_km3

SET_CAR_HEADING colombian_car1_km3 0.0

SET_CAR_ONLY_DAMAGED_BY_PLAYER colombian_car1_km3 TRUE

CHANGE_CAR_LOCK colombian_car1_km3 CARLOCK_LOCKOUT_PLAYER_ONLY

flag_car1_created_km3 = 1

// Colombian car 2 

CREATE_CAR CAR_COLUMB 235.9 -41.3 -100.0 colombian_car2_km3

SET_CAR_HEADING colombian_car2_km3 0.0

SET_CAR_ONLY_DAMAGED_BY_PLAYER colombian_car2_km3 TRUE

CHANGE_CAR_LOCK colombian_car2_km3 CARLOCK_LOCKOUT_PLAYER_ONLY

flag_car2_created_km3 = 1

// creates colombian 1 in car 1

CREATE_CHAR_INSIDE_CAR colombian_car1_km3 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A colombian1_km3

GIVE_WEAPON_TO_CHAR colombian1_km3 WEAPONTYPE_CHAINGUN 30000  //AK47 set to infinate ammo

CLEAR_CHAR_THREAT_SEARCH colombian1_km3

CAR_SET_IDLE colombian_car1_km3

// creates colombian 2 in car 1

CREATE_CHAR_AS_PASSENGER colombian_car1_km3 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 0 colombian2_km3

GIVE_WEAPON_TO_CHAR colombian2_km3 WEAPONTYPE_UZI 30000  //set to infinate ammo

CLEAR_CHAR_THREAT_SEARCH colombian2_km3

// creates colombian 5 in car 2

CREATE_CHAR_INSIDE_CAR colombian_car2_km3 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A colombian5_km3

GIVE_WEAPON_TO_CHAR colombian5_km3 WEAPONTYPE_UZI 30000  //set to infinate ammo

CAR_SET_IDLE colombian_car2_km3

CLEAR_CHAR_THREAT_SEARCH colombian5_km3

// creates colombian 6 in car 2

CREATE_CHAR_AS_PASSENGER colombian_car2_km3 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 0 colombian6_km3

GIVE_WEAPON_TO_CHAR colombian6_km3 WEAPONTYPE_CHAINGUN 30000  //AK47 set to infinate ammo

CLEAR_CHAR_THREAT_SEARCH colombian6_km3

// waiting for the player to get to the meeting

blob_flag = 1

WHILE NOT LOCATE_STOPPED_PLAYER_IN_CAR_2D player 231.1 -26.3 6.0 6.0 blob_flag
OR NOT IS_PLAYER_IN_MODEL player CAR_YARDIE

	WAIT 0

IF flag_yakuza1_km3_dead = 0 

	IF IS_CHAR_DEAD yakuza1_km3
		flag_yakuza1_km3_dead = 1
	ELSE

		IF NOT IS_CHAR_IN_PLAYERS_GROUP yakuza1_km3 player
		AND flag_blip_on_yakuza_km3 = 0
			PRINT_NOW ( HEY7 ) 5000 1 //"You have left your contact behind go and get him!"
			ADD_BLIP_FOR_CHAR yakuza1_km3 radar_blip_ped1_km3
			REMOVE_BLIP radar_blip_coord2_km3
			flag_blip_on_yakuza_km3 = 1
			blob_flag = 0
		ENDIF
	
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player yakuza1_km3 8.0 8.0 FALSE
		AND flag_blip_on_yakuza_km3 = 1
			SET_PLAYER_AS_LEADER yakuza1_km3 player
			REMOVE_BLIP radar_blip_ped1_km3
	  		ADD_BLIP_FOR_COORD 231.1 -26.3 -100.0 radar_blip_coord2_km3
			flag_blip_on_yakuza_km3 = 0
			blob_flag = 1
		ENDIF

	ENDIF

ENDIF

	IF NOT LOCATE_CAR_3D colombian_car1_km3 230.3 -42.2 16.0 1.0 1.0 1.0 FALSE
		PRINT_NOW ( KM3_14 ) 7000 1 //"You have been seen the deals off"
		GOSUB attack_player
   		GOTO mission_kenji3_failed
	ENDIF

	IF NOT LOCATE_CAR_3D colombian_car2_km3 235.9 -41.3 16.0 1.0 1.0 1.0 FALSE
		PRINT_NOW ( KM3_14 ) 7000 1 //"You have been seen the deals off"
		GOSUB attack_player
   		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CAR_DEAD colombian_car1_km3
		flag_colombian_car1_dead_km3 = 1
		PRINT_NOW ( KM3_11 ) 5000 1 //"The Cartel have been attacked and the briefcase has not been recovered.!"
		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CAR_DEAD colombian_car2_km3
		flag_colombian_car2_dead_km3 = 1
		PRINT_NOW ( KM3_11 ) 5000 1 //"The Cartel have been attacked and the briefcase has not been recovered.!
		GOTO mission_kenji3_failed
	ENDIF
	
	IF IS_CHAR_DEAD colombian1_km3
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF	

	IF IS_CHAR_DEAD colombian2_km3
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF
      
	IF IS_CHAR_DEAD colombian5_km3
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CHAR_DEAD colombian6_km3
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF
   	   
	IF NOT IS_PLAYER_IN_MODEL player CAR_YARDIE
	AND flag_player_had_car_message_km3 = 0
		PRINT_NOW ( KM3_8 ) 7000 1 //"Get a Yardie car and get on with the mission!
		REMOVE_BLIP radar_blip_coord2_km3
		flag_player_had_car_message_km3 = 1
		blob_flag = 0
	ENDIF

	IF IS_PLAYER_IN_MODEL player CAR_YARDIE
	AND flag_player_had_car_message_km3 = 1
		ADD_BLIP_FOR_COORD 231.1 -26.3 -100.0 radar_blip_coord2_km3
		flag_player_had_car_message_km3 = 0
		blob_flag = 1
	ENDIF

	IF LOCATE_PLAYER_ANY_MEANS_2D player 231.1 -26.3 10.0 10.0 FALSE

   		IF NOT IS_PLAYER_IN_MODEL player CAR_YARDIE
		OR IS_PLAYER_SHOOTING player
			PRINT_NOW ( KM3_14 ) 7000 1 //"You have been seen the deals off"
			GOSUB attack_player
   			GOTO mission_kenji3_failed
		ENDIF

	ENDIF
		    
ENDWHILE

REMOVE_BLIP radar_blip_coord2_km3

IF flag_colombian_car1_dead_km3 = 0
	SET_CAR_ONLY_DAMAGED_BY_PLAYER colombian_car1_km3 FALSE
ENDIF

IF flag_colombian_car2_dead_km3 = 0
	SET_CAR_ONLY_DAMAGED_BY_PLAYER colombian_car2_km3 FALSE
ENDIF 

PRINT_NOW ( KM3_5 ) 7000 1 //"Press the horn to get the deal going, as soon as the Columbians are out of the car kill them all!"

// waiting for the player to press the horn

blob_flag = 1

WHILE NOT IS_PLAYER_PRESSING_HORN player
OR NOT LOCATE_STOPPED_PLAYER_IN_CAR_2D player 231.1 -26.3 6.0 6.0 blob_flag
OR NOT IS_PLAYER_IN_MODEL player CAR_YARDIE

	WAIT 0

IF flag_yakuza1_km3_dead = 0
	
	IF IS_CHAR_DEAD yakuza1_km3
		flag_yakuza1_km3_dead = 1
	ELSE

		IF NOT IS_CHAR_IN_PLAYERS_GROUP yakuza1_km3 player
		AND flag_blip_on_yakuza_km3 = 0
			PRINT_NOW ( HEY7 ) 5000 1 //"You have left your contact behind go and get him!"
			ADD_BLIP_FOR_CHAR yakuza1_km3 radar_blip_ped1_km3
			REMOVE_BLIP radar_blip_coord2_km3
			flag_blip_on_yakuza_km3 = 1
			blob_flag = 0
		ENDIF
	
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player yakuza1_km3 8.0 8.0 FALSE
		AND flag_blip_on_yakuza_km3 = 1
			SET_PLAYER_AS_LEADER yakuza1_km3 player
			REMOVE_BLIP radar_blip_ped1_km3
	  		ADD_BLIP_FOR_COORD 231.1 -26.3 -100.0 radar_blip_coord2_km3
			flag_blip_on_yakuza_km3 = 0
			blob_flag = 1
		ENDIF

		SET_CHAR_THREAT_SEARCH yakuza1_km3 THREAT_GANG_COLOMBIAN

	ENDIF
	
ENDIF
	
	IF NOT LOCATE_CAR_3D colombian_car1_km3 230.3 -42.2 16.0 1.0 1.0 1.0 FALSE
		PRINT_NOW ( KM3_14 ) 7000 1 //"You have been seen the deals off"
		GOSUB attack_player
   		GOTO mission_kenji3_failed
	ENDIF

	IF NOT LOCATE_CAR_3D colombian_car2_km3 235.9 -41.3 16.0 1.0 1.0 1.0 FALSE
		PRINT_NOW ( KM3_14 ) 7000 1 //"You have been seen the deals off"
		GOSUB attack_player
   		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CAR_DEAD colombian_car1_km3
		flag_colombian_car1_dead_km3 = 1
		PRINT_NOW ( KM3_11 ) 5000 1 //"The vehicle's KM3_11!
		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CAR_DEAD colombian_car2_km3
		flag_colombian_car2_dead_km3 = 1
		PRINT_NOW ( KM3_11 ) 5000 1 //"The vehicle's KM3_11!
		GOTO mission_kenji3_failed
	ENDIF
	
	IF IS_CHAR_DEAD colombian1_km3
		flag_colombian1_dead_km3 = 1
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CHAR_DEAD colombian2_km3
		flag_colombian2_dead_km3 = 1
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CHAR_DEAD colombian5_km3		 
		flag_colombian5_dead_km3 = 1
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CHAR_DEAD colombian6_km3
		flag_colombian6_dead_km3 = 1
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF

	IF LOCATE_PLAYER_ANY_MEANS_2D player 231.1 -26.3 10.0 10.0 FALSE

   		IF NOT IS_PLAYER_IN_MODEL player CAR_YARDIE
		OR IS_PLAYER_SHOOTING player
			PRINT_NOW ( KM3_14 ) 7000 1 //"You have been seen the deals off"
			GOSUB attack_player
   			GOTO mission_kenji3_failed
		ENDIF

	ENDIF
    	
ENDWHILE

CLEAR_THIS_PRINT ( KM3_5 )

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

SET_POLICE_IGNORE_PLAYER player ON

SET_EVERYONE_IGNORE_PLAYER player ON

CLEAR_AREA 252.0 -45.75 20.8 1.0 TRUE 

SET_FIXED_CAMERA_POSITION 252.0 -45.75 20.8 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 251.1 -45.2 20.6 JUMP_CUT

SET_CHAR_OBJ_LEAVE_CAR colombian1_km3 colombian_car1_km3

SET_CHAR_OBJ_LEAVE_CAR colombian2_km3 colombian_car1_km3

SET_CHAR_OBJ_LEAVE_CAR colombian5_km3 colombian_car2_km3

SET_CHAR_OBJ_LEAVE_CAR colombian6_km3 colombian_car2_km3

IF NOT IS_CAR_DEAD colombian_car1_km3 
	CHANGE_CAR_LOCK colombian_car1_km3 CARLOCK_UNLOCKED
ENDIF

IF NOT IS_CAR_DEAD colombian_car2_km3
	CHANGE_CAR_LOCK colombian_car2_km3 CARLOCK_UNLOCKED
ENDIF   

// waiting for the guys to get out of the car

WHILE IS_CHAR_IN_CAR colombian1_km3 colombian_car1_km3
AND IS_CHAR_IN_CAR colombian2_km3 colombian_car1_km3
AND IS_CHAR_IN_CAR colombian5_km3 colombian_car2_km3
AND IS_CHAR_IN_CAR colombian6_km3 colombian_car2_km3

	WAIT 0

IF flag_yakuza1_km3_dead = 0 

	IF IS_CHAR_DEAD yakuza1_km3
		flag_yakuza1_km3_dead = 1
	ENDIF

ENDIF

	IF IS_CAR_DEAD colombian_car1_km3
		flag_colombian_car1_dead_km3 = 1
		PRINT_NOW ( KM3_11 ) 5000 1 //"The Cartel have been attacked and the briefcase has not been recovered."
		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CAR_DEAD colombian_car2_km3
		flag_colombian_car2_dead_km3 = 1
		PRINT_NOW ( KM3_11 ) 5000 1 //"The Cartel have been attacked and the briefcase has not been recovered."
		GOTO mission_kenji3_failed
	ENDIF
	
	IF IS_CHAR_DEAD colombian1_km3
		flag_colombian1_dead_km3 = 1
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CHAR_DEAD colombian2_km3
		flag_colombian2_dead_km3 = 1
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CHAR_DEAD colombian5_km3
		flag_colombian5_dead_km3 = 1
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF

	IF IS_CHAR_DEAD colombian6_km3
		flag_colombian6_dead_km3 = 1
		PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
		GOTO mission_kenji3_failed
	ENDIF

ENDWHILE

//IF NOT IS_CHAR_DEAD colombian2_km3 
//	POINT_CAMERA_AT_CHAR colombian2_km3 FOLLOWPED JUMP_CUT 
//ENDIF

IF flag_colombian2_dead_km3 = 0

	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT colombian2_km3 233.3 -37.1

	WHILE NOT IS_CHAR_OBJECTIVE_PASSED colombian2_km3
	
		WAIT 0

		IF flag_yakuza1_km3_dead = 0 

			IF IS_CHAR_DEAD yakuza1_km3
				flag_yakuza1_km3_dead = 1
			ENDIF

		ENDIF
	   
		IF IS_CAR_DEAD colombian_car1_km3
			flag_colombian_car1_dead_km3 = 1
			PRINT_NOW ( KM3_11 ) 5000 1 //"The Cartel have been attacked and the briefcase has not been recovered."
			GOTO mission_kenji3_failed
		ENDIF

		IF IS_CAR_DEAD colombian_car2_km3
			flag_colombian_car2_dead_km3 = 1
			PRINT_NOW ( KM3_11 ) 5000 1 //"The Cartel have been attacked and the briefcase has not been recovered."
			GOTO mission_kenji3_failed
		ENDIF
	
		IF IS_CHAR_DEAD colombian1_km3
			flag_colombian1_dead_km3 = 1
			PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
			GOTO mission_kenji3_failed
		ENDIF

		IF IS_CHAR_DEAD colombian2_km3
			flag_colombian2_dead_km3 = 1
			PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
			GOTO mission_kenji3_failed
		ENDIF

		IF IS_CHAR_DEAD colombian5_km3
			flag_colombian5_dead_km3 = 1
			PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
			GOTO mission_kenji3_failed
		ENDIF

		IF IS_CHAR_DEAD colombian6_km3
			flag_colombian6_dead_km3 = 1
			PRINT_NOW ( KM3_9 ) 5000 1 //"One of the Colombians is dead, the deals off."
			GOTO mission_kenji3_failed
		ENDIF

	ENDWHILE
	
	CREATE_PICKUP briefcase PICKUP_ONCE 233.7 -36.0 15.8 money_km3

	flag_money_created_km3 = 1
		
	
ENDIF

SWITCH_WIDESCREEN OFF

RESTORE_CAMERA_JUMPCUT

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

SET_EVERYONE_IGNORE_PLAYER player OFF 

PRINT_NOW ( KM3_12 ) 5000 1 //"Kill all of the Colombians, destroy the vehicles and recover the briefcase."

timera = 0

WHILE flag_go_for_player_km3 = 0
			
	WAIT 0

	IF timera >= 2000 //GS-SC: Have the enemies react more quickly
		flag_go_for_player_km3 = 1
	ENDIF
	
	IF flag_yakuza1_km3_dead = 0 

		IF IS_CHAR_DEAD yakuza1_km3
			flag_yakuza1_km3_dead = 1
		ELSE

			IF flag_helper_not_in_car_km3 = 0 
			
				IF IS_CHAR_IN_ANY_CAR yakuza1_km3
					STORE_CAR_CHAR_IS_IN yakuza1_km3 car3_km3

					IF NOT IS_CAR_DEAD car3_km3
						LEAVE_GROUP yakuza1_km3 
						SET_CHAR_OBJ_LEAVE_CAR yakuza1_km3 car3_km3
					ENDIF

				ELSE
					flag_helper_not_in_car_km3 = 1
				ENDIF

			ENDIF
					
			IF flag_helper_not_in_car_km3 = 1 
				SET_CHAR_THREAT_SEARCH yakuza1_km3 THREAT_GANG_COLOMBIAN
				SET_CHAR_PERSONALITY yakuza1_km3 PEDSTAT_TOUGH_GUY
			ENDIF
						
		ENDIF

	ENDIF
	   
	IF flag_colombian1_dead_km3 = 0

		IF IS_CHAR_DEAD colombian1_km3
			++ counter_number_of_colombians_killed_km3
			flag_go_for_player_km3 = 1
			flag_colombian1_dead_km3 = 1
		ENDIF

	ENDIF

	IF flag_colombian2_dead_km3 = 0

		IF IS_CHAR_DEAD colombian2_km3
			++ counter_number_of_colombians_killed_km3
			flag_go_for_player_km3 = 1
			flag_colombian2_dead_km3 = 1
		ENDIF

	ENDIF

 	IF flag_colombian5_dead_km3 = 0

		IF IS_CHAR_DEAD colombian5_km3
			++ counter_number_of_colombians_killed_km3
			flag_go_for_player_km3 = 1
			flag_colombian5_dead_km3 = 1
		ENDIF 

	ENDIF

	IF flag_colombian6_dead_km3 = 0

		IF IS_CHAR_DEAD colombian6_km3
			++ counter_number_of_colombians_killed_km3
			flag_go_for_player_km3 = 1
			flag_colombian6_dead_km3 = 1
		ENDIF

	ENDIF

   
	IF flag_colombian_car1_dead_km3 = 0

		IF IS_CAR_DEAD colombian_car1_km3
			++ counter_all_colombian_cars_dead_km3
			flag_go_for_player_km3 = 1
			flag_colombian_car1_dead_km3 = 1
		ENDIF

	ENDIF

	IF flag_colombian_car2_dead_km3 = 0

		IF IS_CAR_DEAD colombian_car2_km3
			++ counter_all_colombian_cars_dead_km3
			flag_go_for_player_km3 = 1
			flag_colombian_car2_dead_km3 = 1
		ENDIF

	ENDIF

	IF NOT IS_PLAYER_IN_MODEL player CAR_YARDIE
		flag_go_for_player_km3 = 1
	ENDIF

	IF NOT LOCATE_PLAYER_ANY_MEANS_2D player 231.1 -26.3 6.0 6.0 FALSE
		flag_go_for_player_km3 = 1
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_2D player 231.1 -26.3 6.0 6.0 FALSE
	
		IF IS_PLAYER_SHOOTING player
			flag_go_for_player_km3 = 1
		ENDIF
		
	ENDIF
	
	IF money_been_picked_up_km3 = 0

		IF HAS_PICKUP_BEEN_COLLECTED money_km3
			PRINT_NOW ( KM4_8 ) 5000 1 //"Briefcase collected!"
			flag_go_for_player_km3 = 1
			money_been_picked_up_km3 = 1
		ENDIF

	ENDIF	 	
	
ENDWHILE
 

kill_player_km3:

PLAY_MISSION_AUDIO

PRINT_NOW ( KM3_7 ) 7000 1 //"Hey... your not who we were expecting!"

// briefcase

IF money_been_picked_up_km3 = 0 
	ADD_BLIP_FOR_PICKUP money_km3 radar_blip_money_km3
ENDIF

// car 1

IF flag_colombian_car1_dead_km3 = 0 
	ADD_BLIP_FOR_CAR colombian_car1_km3 radar_blip_colombian_car1_km3
ENDIF

// car 2

IF flag_colombian_car2_dead_km3 = 0 
	ADD_BLIP_FOR_CAR colombian_car2_km3 radar_blip_colombian_car2_km3
ENDIF

// colombian1

IF flag_colombian1_dead_km3 = 0

	SET_CHAR_THREAT_SEARCH colombian1_km3 THREAT_PLAYER1

	SET_CHAR_THREAT_SEARCH colombian1_km3 THREAT_GANG_YAKUZA

	SET_CHAR_PERSONALITY colombian1_km3 PEDSTAT_TOUGH_GUY

	//SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT colombian1_km3 player

	ADD_BLIP_FOR_CHAR colombian1_km3 radar_blip_colombian1_km3

ENDIF

// colombian2

IF flag_colombian2_dead_km3 = 0

	SET_CHAR_THREAT_SEARCH colombian2_km3 THREAT_PLAYER1

	SET_CHAR_THREAT_SEARCH colombian2_km3 THREAT_GANG_YAKUZA

	SET_CHAR_PERSONALITY colombian2_km3 PEDSTAT_TOUGH_GUY

	//SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT colombian2_km3 player

	ADD_BLIP_FOR_CHAR colombian2_km3 radar_blip_colombian2_km3

ENDIF


// colombian5

IF flag_colombian5_dead_km3 = 0
	
	ADD_BLIP_FOR_CHAR colombian5_km3 radar_blip_colombian5_km3

	SET_CHAR_THREAT_SEARCH colombian5_km3 THREAT_PLAYER1

	SET_CHAR_THREAT_SEARCH colombian5_km3 THREAT_GANG_YAKUZA

	SET_CHAR_PERSONALITY colombian5_km3 PEDSTAT_TOUGH_GUY

	//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colombian5_km3 player
	
ENDIF

// colombian6

IF flag_colombian6_dead_km3 = 0
	
	ADD_BLIP_FOR_CHAR colombian6_km3 radar_blip_colombian6_km3

	SET_CHAR_THREAT_SEARCH colombian6_km3 THREAT_PLAYER1

	SET_CHAR_THREAT_SEARCH colombian6_km3 THREAT_GANG_YAKUZA

	SET_CHAR_PERSONALITY colombian6_km3 PEDSTAT_TOUGH_GUY

	//SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT colombian6_km3 player
	 
ENDIF

timerb = 0

// waiting for all the columbains and their cars to be destroyed

WHILE NOT counter_number_of_colombians_killed_km3 = 4
OR NOT counter_all_colombian_cars_dead_km3 = 2
OR NOT money_been_picked_up_km3 = 1

	WAIT 0

	IF flag_trap_audio_removed_km3 = 0

		IF HAS_MISSION_AUDIO_FINISHED
			CLEAR_THIS_PRINT ( KM3_7 )
			flag_trap_audio_removed_km3 = 1
		ENDIF

	ENDIF

	IF money_been_picked_up_km3 = 0

		IF HAS_PICKUP_BEEN_COLLECTED money_km3
			PRINT_NOW ( KM4_8 ) 5000 1 //"Briefcase collected!"
			REMOVE_BLIP radar_blip_money_km3
			money_been_picked_up_km3 = 1
		ENDIF

	ENDIF


	IF flag_yakuza1_km3_dead = 0 

		IF IS_CHAR_DEAD yakuza1_km3
			flag_yakuza1_km3_dead = 1
		ELSE

			IF flag_helper_not_in_car_km3 = 0 
			
				IF IS_CHAR_IN_ANY_CAR yakuza1_km3
					STORE_CAR_CHAR_IS_IN yakuza1_km3 car3_km3

					IF NOT IS_CAR_DEAD car3_km3
						LEAVE_GROUP yakuza1_km3 
						SET_CHAR_OBJ_LEAVE_CAR yakuza1_km3 car3_km3
					ENDIF

				ELSE
					flag_helper_not_in_car_km3 = 1
				ENDIF
							
			ENDIF

			IF flag_helper_not_in_car_km3 = 1 
				SET_CHAR_THREAT_SEARCH yakuza1_km3 THREAT_GANG_COLOMBIAN
				SET_CHAR_PERSONALITY yakuza1_km3 PEDSTAT_TOUGH_GUY
			ENDIF
			
		ENDIF

	ENDIF

	IF counter_number_of_colombians_killed_km3 = 4
		
		IF NOT IS_CHAR_DEAD yakuza1_km3

			IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player yakuza1_km3 20.0 20.0 FALSE
				SET_PLAYER_AS_LEADER yakuza1_km3 player
			ENDIF
	
		ENDIF

	ENDIF

	IF flag_colombian1_dead_km3 = 0

		IF IS_CHAR_DEAD colombian1_km3
			REMOVE_BLIP radar_blip_colombian1_km3
			++ counter_number_of_colombians_killed_km3
			flag_colombian1_dead_km3 = 1
		ENDIF

	ENDIF

	IF flag_colombian2_dead_km3 = 0

		IF IS_CHAR_DEAD colombian2_km3
			REMOVE_BLIP radar_blip_colombian2_km3
			++ counter_number_of_colombians_killed_km3
			flag_colombian2_dead_km3 = 1
		ENDIF

	ENDIF

 	IF flag_colombian5_dead_km3 = 0

		IF IS_CHAR_DEAD colombian5_km3
			REMOVE_BLIP radar_blip_colombian5_km3
			++ counter_number_of_colombians_killed_km3
			flag_colombian5_dead_km3 = 1
		ENDIF 

	ENDIF

	IF flag_colombian6_dead_km3 = 0

		IF IS_CHAR_DEAD colombian6_km3
			REMOVE_BLIP radar_blip_colombian6_km3
			++ counter_number_of_colombians_killed_km3
			flag_colombian6_dead_km3 = 1
		ENDIF

	ENDIF

   
	IF flag_colombian_car1_dead_km3 = 0

		IF IS_CAR_DEAD colombian_car1_km3
			REMOVE_BLIP radar_blip_colombian_car1_km3
			++ counter_all_colombian_cars_dead_km3
			flag_colombian_car1_dead_km3 = 1
		ENDIF

	ENDIF

	IF flag_colombian_car2_dead_km3 = 0

		IF IS_CAR_DEAD colombian_car2_km3
			REMOVE_BLIP radar_blip_colombian_car2_km3
			++ counter_all_colombian_cars_dead_km3
			flag_colombian_car2_dead_km3 = 1
		ENDIF

	ENDIF

ENDWHILE

IF NOT IS_CHAR_DEAD yakuza1_km3

	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player yakuza1_km3 20.0 20.0 FALSE
		SET_PLAYER_AS_LEADER yakuza1_km3 player
	ENDIF
	
ENDIF  

PRINT_NOW ( KM3_13 ) 5000 1 //"Take the briefcase back to the casino."

ADD_BLIP_FOR_COORD 452.3 -1465.8 17.6 radar_blip_coord3_km3

blob_flag = 1 

WHILE NOT LOCATE_STOPPED_PLAYER_ANY_MEANS_3D player 452.3 -1465.8 17.6 4.0 4.0 4.0 blob_flag

	WAIT 0
      
ENDWHILE

REMOVE_BLIP radar_blip_coord3_km3

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

SET_POLICE_IGNORE_PLAYER player ON

SET_EVERYONE_IGNORE_PLAYER player ON

GET_PLAYER_CHAR player script_controlled_player

IF IS_PLAYER_IN_ANY_CAR player

	STORE_CAR_PLAYER_IS_IN player car_cut_km3
	SET_CHAR_OBJ_LEAVE_CAR script_controlled_player car_cut_km3
	
	WHILE IS_PLAYER_IN_CAR player car_cut_km3
	
		WAIT 0

		IF IS_CAR_DEAD car_cut_km3
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicles wrecked!"
			GOTO mission_kenji3_failed
		ENDIF 
		
	ENDWHILE
	
ENDIF

SET_FIXED_CAMERA_POSITION 420.41 -1479.59 26.13 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 420.87 -1478.75 26.38 JUMP_CUT

SET_PLAYER_COORDINATES player 425.85 -1477.16 -100.0

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT script_controlled_player 428.57 -1465.01

WHILE NOT IS_CHAR_OBJECTIVE_PASSED script_controlled_player

	WAIT 0
	
ENDWHILE

SET_FADING_COLOUR 0 0 0

DO_FADE 1000 FADE_OUT

WHILE GET_FADING_STATUS

	WAIT 0
	
ENDWHILE

SET_PLAYER_COORDINATES player 426.81 -1486.40 17.64

SET_PLAYER_HEADING player 180.0

RESTORE_CAMERA_JUMPCUT

SET_CAMERA_IN_FRONT_OF_PLAYER 

SET_FADING_COLOUR 0 0 0

DO_FADE 1000 FADE_IN

WHILE GET_FADING_STATUS

	WAIT 0
	
ENDWHILE

SWITCH_WIDESCREEN OFF

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

SET_EVERYONE_IGNORE_PLAYER player OFF
  

}

GOTO mission_kenji3_passed
 

// Mission Kenji3 failed

mission_kenji3_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN

   

// mission Kenji3 passed

mission_kenji3_passed:

flag_kenji_mission3_passed = 1
REGISTER_MISSION_PASSED ( KM3 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( m_pass ) 25000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 25000
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT kenji_mission4_loop
RETURN
		


// mission cleanup

mission_cleanup_kenji3:

flag_player_on_mission = 0
flag_player_on_kenji_mission = 0

IF NOT IS_CAR_DEAD colombian_car1_km3 

	IF flag_colombian_car1_dead_km3 = 0
		CHANGE_CAR_LOCK colombian_car1_km3 CARLOCK_UNLOCKED
		SET_CAR_ONLY_DAMAGED_BY_PLAYER colombian_car1_km3 FALSE
	ENDIF

ENDIF

IF NOT IS_CAR_DEAD colombian_car2_km3

	IF flag_colombian_car2_dead_km3 = 0
		CHANGE_CAR_LOCK colombian_car2_km3 CARLOCK_UNLOCKED
		SET_CAR_ONLY_DAMAGED_BY_PLAYER colombian_car2_km3 FALSE
	ENDIF

ENDIF

IF flag_money_created_km3 = 1

	IF money_been_picked_up_km3 = 0
		REMOVE_PICKUP money_km3
	ENDIF

ENDIF

MARK_MODEL_AS_NO_LONGER_NEEDED CAR_YARDIE
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_COLUMB
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YARDIE_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
REMOVE_BLIP radar_blip_ped1_km3
REMOVE_BLIP radar_blip_coord2_km3
REMOVE_BLIP radar_blip_colombian_car1_km3
REMOVE_BLIP radar_blip_colombian_car2_km3
REMOVE_BLIP radar_blip_colombian1_km3
REMOVE_BLIP radar_blip_colombian2_km3
REMOVE_BLIP radar_blip_colombian5_km3
REMOVE_BLIP radar_blip_colombian6_km3
REMOVE_BLIP radar_blip_money_km3
REMOVE_BLIP radar_blip_coord3_km3
MISSION_HAS_FINISHED
RETURN
	

attack_player:

// colombian1

IF flag_colombian1_dead_km3 = 0

	SET_CHAR_THREAT_SEARCH colombian1_km3 THREAT_PLAYER1

	SET_CHAR_THREAT_SEARCH colombian1_km3 THREAT_GANG_YAKUZA

	SET_CHAR_PERSONALITY colombian1_km3 PEDSTAT_TOUGH_GUY

	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colombian1_km3 player

ENDIF

// colombian2

IF flag_colombian2_dead_km3 = 0

	SET_CHAR_THREAT_SEARCH colombian2_km3 THREAT_PLAYER1

	SET_CHAR_THREAT_SEARCH colombian2_km3 THREAT_GANG_YAKUZA

	SET_CHAR_PERSONALITY colombian2_km3 PEDSTAT_TOUGH_GUY

	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colombian2_km3 player

ENDIF


// colombian5

IF flag_colombian5_dead_km3 = 0
	
	SET_CHAR_THREAT_SEARCH colombian5_km3 THREAT_PLAYER1

	SET_CHAR_THREAT_SEARCH colombian5_km3 THREAT_GANG_YAKUZA

	SET_CHAR_PERSONALITY colombian5_km3 PEDSTAT_TOUGH_GUY

	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colombian5_km3 player   
	
ENDIF

// colombian6

IF flag_colombian6_dead_km3 = 0
	
	SET_CHAR_THREAT_SEARCH colombian6_km3 THREAT_PLAYER1

	SET_CHAR_THREAT_SEARCH colombian6_km3 THREAT_GANG_YAKUZA

	SET_CHAR_PERSONALITY colombian6_km3 PEDSTAT_TOUGH_GUY

	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colombian6_km3 player	
		 
ENDIF

RETURN
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************Kenji mission 4********************************* 
// *********************************************"Shima"*************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME kenji4

// Mission start stuff

GOSUB mission_start_kenji4

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_kenji4_failed
	ENDIF

GOSUB mission_cleanup_kenji4

MISSION_END
 
// Variables for mission

VAR_INT briefcase1_km4

VAR_INT briefcase2_km4

VAR_INT briefcase3_km4

VAR_INT hispanic1_km4

VAR_INT hispanic2_km4

VAR_INT hispanic3_km4

VAR_INT hispanic4_km4

VAR_INT hispanic5_km4

VAR_INT hispanic6_km4

VAR_INT radar_blip_coord2_km4

VAR_INT radar_blip_coord3_km4

VAR_INT radar_blip_coord4_km4

VAR_INT radar_blip_coord5_km4

VAR_INT radar_blip_ped_km4

VAR_INT radar_blip_coord1_km4

VAR_INT counter_number_of_hispanics_dead

VAR_INT flag_hispanic1_km4_dead

VAR_INT flag_hispanic2_km4_dead

VAR_INT flag_hispanic3_km4_dead

VAR_INT flag_hispanic4_km4_dead

VAR_INT flag_hispanic5_km4_dead

VAR_INT flag_hispanic6_km4_dead

VAR_INT flag_briefcase3_pickedup_km4

VAR_INT flag_hispanic1_hate_player_km4

VAR_INT flag_hispanic2_hate_player_km4

VAR_INT flag_hispanic3_hate_player_km4

VAR_INT flag_hispanic4_hate_player_km4

VAR_INT flag_hispanic5_hate_player_km4

VAR_INT radar_blip_diablo1_km4

VAR_INT radar_blip_diablo2_km4

VAR_INT radar_blip_diablo3_km4

VAR_INT radar_blip_diablo4_km4

VAR_INT radar_blip_diablo5_km4

VAR_INT radar_blip_dummy1_km4

VAR_INT radar_blip_dummy2_km4

VAR_INT radar_blip_dummy3_km4

VAR_INT radar_blip_dummy4_km4

VAR_INT radar_blip_dummy5_km4

VAR_INT flag_player_had_message_km4

VAR_INT car_km4

VAR_INT flag_briefcase1_created_km4

VAR_INT flag_briefcase2_created_km4

VAR_INT flag_briefcase3_created_km4

VAR_INT flag_briefcase1_collected_km4

VAR_INT flag_briefcase2_collected_km4

VAR_INT flag_briefcase3_collected_km4

VAR_INT radar_blip_coord6_km4

VAR_INT car_cut_km4

// ****************************************Mission Start************************************

mission_start_kenji4:

flag_player_on_mission = 1

flag_player_on_kenji_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

counter_number_of_hispanics_dead = 0

flag_hispanic1_km4_dead = 0

flag_hispanic2_km4_dead = 0

flag_hispanic3_km4_dead = 0

flag_hispanic4_km4_dead = 0

flag_hispanic5_km4_dead = 0

flag_hispanic6_km4_dead = 0

flag_briefcase3_pickedup_km4 = 0

flag_hispanic1_hate_player_km4 = 0

flag_hispanic2_hate_player_km4 = 0

flag_hispanic3_hate_player_km4 = 0

flag_hispanic4_hate_player_km4 = 0

flag_hispanic5_hate_player_km4 = 0

switch_gang_diablo_off = 1

flag_player_had_message_km4 = 0

flag_briefcase1_created_km4 = 0

flag_briefcase2_created_km4 = 0

flag_briefcase3_created_km4 = 0

flag_briefcase1_collected_km4 = 0

flag_briefcase2_collected_km4 = 0

flag_briefcase3_collected_km4 = 0

SWAP_NEAREST_BUILDING_MODEL -88.371 -487.666 15.166 50.0 convstore01 convstre_dmge01

{
// ****************************************START OF CUTSCENE********************************

/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_kenji4_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( KM4 ) 15000 2  //"SHIMA"

SWITCH_STREAMING OFF
*/

// Cutscene stuff

LOAD_SPECIAL_CHARACTER 1 KENJI
REQUEST_MODEL PED_GANG_YAKUZA_A 
LOAD_SPECIAL_MODEL cut_obj1 KENJIH 
LOAD_SPECIAL_MODEL cut_obj2 PLAYERH
REQUEST_MODEL casino_garden

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED PED_GANG_YAKUZA_A 
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED casino_garden
	
	WAIT 0

ENDWHILE

LOAD_CUTSCENE k4_shi

SET_CUTSCENE_OFFSET 476.380 -1382.168 67.347

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_kenji

SET_CUTSCENE_ANIM cs_kenji kenji

CREATE_CUTSCENE_OBJECT PED_GANG_YAKUZA_A cs_yakuza

SET_CUTSCENE_ANIM cs_yakuza gang07

CREATE_CUTSCENE_HEAD cs_kenji CUT_OBJ1 cs_kenjihead

SET_CUTSCENE_HEAD_ANIM cs_kenjihead kenji

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CLEAR_AREA 459.1 -1413.0 25.11 1.0 TRUE 

SET_PLAYER_COORDINATES player 459.1 -1413.0 25.11
							   
SET_PLAYER_HEADING player 132.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 3580
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM4_A ) 10000 1 //"To be truly strong, it is important that you never show weakness."

WHILE cs_time < 8316
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM4_B ) 10000 1 //"The business's that are fortunate enough to have our protection settle their accounts today."

WHILE cs_time < 13513
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM4_C ) 10000 1 //"Please go and collect the money immediately, so we can enter it into the casino accounts."

WHILE cs_time < 17808
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( KM4_C )

WHILE cs_time < 18333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 


UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED casino_garden

// *******************************************END OF CUTSCENE*******************************

REQUEST_MODEL PED_GANG_DIABLO_A

WHILE NOT HAS_MODEL_LOADED PED_GANG_DIABLO_A

	WAIT 0

ENDWHILE

CREATE_PICKUP briefcase pickup_once 236.8 -1580.0 25.7 briefcase1_km4

flag_briefcase1_created_km4 = 1

ADD_BLIP_FOR_PICKUP briefcase1_km4 radar_blip_coord2_km4 

// waits for the player to get the first briefcase

WHILE NOT HAS_PICKUP_BEEN_COLLECTED briefcase1_km4 

	WAIT 0
      
ENDWHILE

flag_briefcase1_collected_km4 = 1

PRINT_NOW ( KM4_8 ) 5000 1 //"Briefcase collected!"

REMOVE_BLIP radar_blip_coord2_km4

CREATE_PICKUP briefcase pickup_once 119.56 -1110.51 25.66 briefcase2_km4

flag_briefcase2_created_km4 = 1

ADD_BLIP_FOR_PICKUP briefcase2_km4 radar_blip_coord3_km4 

// creates Diablo 6 who is by the second briefcase

CREATE_CHAR PEDTYPE_CIVMALE PED_GANG_DIABLO_A 122.2 -1113.2 25.2 hispanic6_km4

GIVE_WEAPON_TO_CHAR hispanic6_km4 WEAPONTYPE_UZI 30000  // sets weapon to have infinate bullets

CLEAR_CHAR_THREAT_SEARCH hispanic6_km4

TURN_CHAR_TO_FACE_COORD hispanic6_km4 120.6 -1111.8 -100.0

// waiting for the player to get the second briefcase

SET_PED_DENSITY park DAY 0
SET_PED_DENSITY park NIGHT 0

WHILE NOT HAS_PICKUP_BEEN_COLLECTED briefcase2_km4

	WAIT 0
      
	IF flag_hispanic6_km4_dead = 0

		IF IS_CHAR_DEAD hispanic6_km4
			flag_hispanic6_km4_dead = 1
		ELSE
			IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player hispanic6_km4 10.0 10.0 FALSE
				SET_CHAR_THREAT_SEARCH hispanic6_km4 THREAT_PLAYER1 
				SET_CHAR_PERSONALITY hispanic6_km4 PEDSTAT_TOUGH_GUY
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS hispanic6_km4 player
			ENDIF
		
		ENDIF
		
	ENDIF 

ENDWHILE

flag_briefcase2_collected_km4 = 1

PRINT_NOW ( KM4_8 ) 5000 1 //"Briefcase collected!"

REMOVE_BLIP radar_blip_coord3_km4

ADD_BLIP_FOR_COORD -91.5 -484.2 15.2 radar_blip_coord5_km4

WHILE NOT LOCATE_STOPPED_PLAYER_ANY_MEANS_3D player -91.5 -484.2 15.2 4.0 4.0 3.0 TRUE

	WAIT 0
       	
ENDWHILE

SWITCH_WIDESCREEN ON

REMOVE_BLIP radar_blip_coord5_km4

SET_PLAYER_CONTROL player OFF

CLEAR_AREA -91.0 -488.9 18.7 2.0 TRUE

SET_POLICE_IGNORE_PLAYER player ON

SET_EVERYONE_IGNORE_PLAYER player ON

SET_FIXED_CAMERA_POSITION -87.33 -502.99 21.33 0.0 0.0 0.0

POINT_CAMERA_AT_POINT -87.37 -502.06 20.97 JUMP_CUT

GET_PLAYER_CHAR player script_controlled_player

IF IS_PLAYER_IN_ANY_CAR player

	STORE_CAR_PLAYER_IS_IN player car_km4
			
	SET_CHAR_OBJ_LEAVE_CAR script_controlled_player car_km4

	WHILE IS_CHAR_IN_CAR script_controlled_player car_km4

		WAIT 0
	   	   
		IF IS_CAR_DEAD car_km4
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicles dead!"
			GOTO mission_kenji4_failed
		ENDIF
			

	ENDWHILE

ENDIF

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT script_controlled_player -92.07 -488.84

timerb = 0

	WHILE timerb < 1000

		WAIT 0

	ENDWHILE

// **************************************CUT SCENE WITH SHOP KEEPER*************************

GET_GAME_TIMER breakout_timer_start

breakout_diff = 0

WHILE NOT CAN_PLAYER_START_MISSION Player
AND breakout_diff < 5000	//	if player is not in control after 5 secs do the cutscene anyway

	WAIT 0

	GET_GAME_TIMER breakout_timer

	breakout_diff = breakout_timer - breakout_timer_start
	
ENDWHILE

MAKE_PLAYER_SAFE_FOR_CUTSCENE player

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

// Cutscene stuff

LOAD_SPECIAL_CHARACTER 2 KEEPER
LOAD_SPECIAL_MODEL cut_obj1 KEEPERH 
LOAD_SPECIAL_MODEL cut_obj2 PLAYERH
LOAD_SPECIAL_MODEL CUT_OBJ3 SHDOOR 

WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE

CHAR_SET_IDLE script_controlled_player

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS -117.66 -565.7 10.0 12.34 -396.77 20.0

LOAD_ALL_MODELS_NOW	

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj1

	WAIT 0

ENDWHILE

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE -88.3 -487.6 15.1 6.0 convstore01_door FALSE	

LOAD_CUTSCENE k4_shi2

SET_CUTSCENE_OFFSET -88.1829 -491.4236 15.1439  //Proper one

//SET_CUTSCENE_OFFSET -90.1829 -491.4236 15.143  // Test one

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_keeper

SET_CUTSCENE_ANIM cs_keeper keeper

CREATE_CUTSCENE_OBJECT cut_obj3 cs_shopdoor

SET_CUTSCENE_ANIM cs_shopdoor shdoor

CREATE_CUTSCENE_HEAD cs_keeper CUT_OBJ1 cs_keeperhead

SET_CUTSCENE_HEAD_ANIM cs_keeperhead keeper

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CLEAR_AREA -93.01 -489.43 15.16 1.0 TRUE
 
SET_PLAYER_COORDINATES player -93.01 -489.43 15.16

SET_PLAYER_HEADING player 101.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2690
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM4_1 ) 10000 1 //"I can't pay you and I wouldn't pay you if I could!"

WHILE cs_time < 4898
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM4_9 ) 10000 1 //"Some young gang just jacked out the place, they took everything."

WHILE cs_time < 7467
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( KM4_2 ) 10000 1 //"You guys are useless."

WHILE cs_time < 8511
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE					

PRINT_NOW ( KM4_10 ) 10000 1 //"What kind of Yakuza are you anyway?"

WHILE cs_time < 10710
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE	

CLEAR_THIS_PRINT ( KM4_10 )

WHILE cs_time < 11000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_RUBBISH ON

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

SET_CAMERA_BEHIND_PLAYER

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE -88.3 -487.6 15.1 6.0 convstore01_door TRUE

UNLOAD_SPECIAL_CHARACTER 2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3

SET_PED_DENSITY_MULTIPLIER 1.0


// **********************************END OF CUTSCENE WITH SHOPKEEPER************************

SWITCH_WIDESCREEN OFF

SET_POLICE_IGNORE_PLAYER player OFF

SET_PLAYER_CONTROL player ON

SET_PED_DENSITY park DAY 1
SET_PED_DENSITY park NIGHT 1

SET_EVERYONE_IGNORE_PLAYER player OFF

ADD_BLIP_FOR_COORD_OLD 938.0 -180.0 -100.0 5 BOTH radar_blip_coord1_km4

CHANGE_BLIP_SCALE radar_blip_coord1_km4 3

ADD_BLIP_FOR_COORD_OLD 930.0 -190.0 -100.0 1 BOTH radar_blip_dummy1_km4

CHANGE_BLIP_SCALE radar_blip_dummy1_km4 3 

ADD_BLIP_FOR_COORD_OLD 931.0 -184.0 -100.0 1 BOTH radar_blip_dummy2_km4

CHANGE_BLIP_SCALE radar_blip_dummy2_km4 3

ADD_BLIP_FOR_COORD_OLD 943.0 -182.0 -100.0 1 BOTH radar_blip_dummy3_km4

CHANGE_BLIP_SCALE radar_blip_dummy3_km4 3

ADD_BLIP_FOR_COORD_OLD 943.0 -190.0 -100.0 1 BOTH radar_blip_dummy4_km4

CHANGE_BLIP_SCALE radar_blip_dummy4_km4 3

ADD_BLIP_FOR_COORD_OLD 939.0 -183.0 -100.0 1 BOTH radar_blip_dummy5_km4

CHANGE_BLIP_SCALE radar_blip_dummy5_km4 3

PRINT_NOW ( KM4_4 ) 7000 1 //"Punish the gang responsible and retrieve the protection money!"

// creates the final briefcase and the hispanics

WHILE NOT IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL

	WAIT 0
         
ENDWHILE

CREATE_PICKUP briefcase pickup_once 938.0 -180.0 4.5 briefcase3_km4

flag_briefcase3_created_km4 = 1

ADD_BLIP_FOR_PICKUP briefcase3_km4 radar_blip_coord4_km4 

REMOVE_BLIP radar_blip_coord1_km4

// hispanic 1

CREATE_CHAR PEDTYPE_GANG_DIABLO PED_GANG_DIABLO_A 930.0 -190.0 -100.0 hispanic1_km4

ADD_BLIP_FOR_CHAR hispanic1_km4 radar_blip_diablo1_km4

REMOVE_BLIP radar_blip_dummy1_km4 

GIVE_WEAPON_TO_CHAR hispanic1_km4 WEAPONTYPE_UZI 30000  // sets weapon to have infinate bullets

CLEAR_CHAR_THREAT_SEARCH hispanic1_km4

SET_CHAR_PERSONALITY hispanic1_km4 PEDSTAT_TOUGH_GUY

// hispanic 2

CREATE_CHAR PEDTYPE_GANG_DIABLO PED_GANG_DIABLO_A 931.0 -184.0 -100.0 hispanic2_km4

ADD_BLIP_FOR_CHAR hispanic2_km4 radar_blip_diablo2_km4

REMOVE_BLIP radar_blip_dummy2_km4

GIVE_WEAPON_TO_CHAR hispanic2_km4 WEAPONTYPE_UZI 30000 // sets weapon to have infinate bullets

CLEAR_CHAR_THREAT_SEARCH hispanic2_km4

SET_CHAR_PERSONALITY hispanic2_km4 PEDSTAT_TOUGH_GUY

// hispanic 3

CREATE_CHAR PEDTYPE_GANG_DIABLO PED_GANG_DIABLO_A 943.0 -182.0 -100.0 hispanic3_km4

ADD_BLIP_FOR_CHAR hispanic3_km4 radar_blip_diablo3_km4

REMOVE_BLIP radar_blip_dummy3_km4

GIVE_WEAPON_TO_CHAR hispanic3_km4 WEAPONTYPE_UZI 30000 // sets weapon to have infinate bullets

CLEAR_CHAR_THREAT_SEARCH hispanic3_km4

SET_CHAR_PERSONALITY hispanic3_km4 PEDSTAT_TOUGH_GUY

// hispanic 4

CREATE_CHAR PEDTYPE_GANG_DIABLO PED_GANG_DIABLO_A 943.0 -190.0 -100.0 hispanic4_km4

ADD_BLIP_FOR_CHAR hispanic4_km4 radar_blip_diablo4_km4

REMOVE_BLIP radar_blip_dummy4_km4

GIVE_WEAPON_TO_CHAR hispanic4_km4 WEAPONTYPE_UZI 30000 // sets weapon to have infinate bullets

CLEAR_CHAR_THREAT_SEARCH hispanic4_km4

SET_CHAR_PERSONALITY hispanic4_km4 PEDSTAT_TOUGH_GUY

// hispanic 5

CREATE_CHAR PEDTYPE_GANG_DIABLO PED_GANG_DIABLO_A 939.0 -183.0 -100.0 hispanic5_km4

ADD_BLIP_FOR_CHAR hispanic5_km4 radar_blip_diablo5_km4

SET_CHAR_SUFFERS_CRITICAL_HITS hispanic1_km4 TRUE  // This script command was unused and has been hijacked to set targeting priority!
SET_CHAR_SUFFERS_CRITICAL_HITS hispanic2_km4 TRUE
SET_CHAR_SUFFERS_CRITICAL_HITS hispanic3_km4 TRUE
SET_CHAR_SUFFERS_CRITICAL_HITS hispanic4_km4 TRUE
SET_CHAR_SUFFERS_CRITICAL_HITS hispanic5_km4 TRUE

REMOVE_BLIP radar_blip_dummy5_km4

GIVE_WEAPON_TO_CHAR hispanic5_km4 WEAPONTYPE_UZI 30000 // sets weapon to have infinate bullets

CLEAR_CHAR_THREAT_SEARCH hispanic5_km4

SET_CHAR_PERSONALITY hispanic5_km4 PEDSTAT_TOUGH_GUY


WHILE flag_briefcase3_pickedup_km4 = 0
OR counter_number_of_hispanics_dead < 5

	WAIT 0

	IF flag_hispanic1_km4_dead = 0

		IF IS_CHAR_DEAD hispanic1_km4
			REMOVE_BLIP radar_blip_diablo1_km4
			++ counter_number_of_hispanics_dead
			flag_hispanic1_km4_dead = 1
		ENDIF

	ENDIF

	IF flag_hispanic2_km4_dead = 0

		IF IS_CHAR_DEAD hispanic2_km4
			REMOVE_BLIP radar_blip_diablo2_km4
			++ counter_number_of_hispanics_dead
			flag_hispanic2_km4_dead = 1
		ENDIF

	ENDIF

	IF flag_hispanic3_km4_dead = 0

		IF IS_CHAR_DEAD hispanic3_km4
			REMOVE_BLIP radar_blip_diablo3_km4
			++ counter_number_of_hispanics_dead
			flag_hispanic3_km4_dead = 1
		ENDIF

	ENDIF

	IF flag_hispanic4_km4_dead = 0

		IF IS_CHAR_DEAD hispanic4_km4
			REMOVE_BLIP radar_blip_diablo4_km4
			++ counter_number_of_hispanics_dead
			flag_hispanic4_km4_dead = 1
		ENDIF

	ENDIF

	IF flag_hispanic5_km4_dead = 0

		IF IS_CHAR_DEAD hispanic5_km4
			REMOVE_BLIP radar_blip_diablo5_km4
			++ counter_number_of_hispanics_dead
			flag_hispanic5_km4_dead = 1
		ENDIF

	ENDIF
         
	IF flag_briefcase3_pickedup_km4 = 0 

		IF HAS_PICKUP_BEEN_COLLECTED briefcase3_km4
			REMOVE_BLIP radar_blip_coord4_km4
			PRINT_NOW ( KM4_8 ) 5000 1 //"Briefcase collected!"
			flag_briefcase3_collected_km4 = 1
			flag_briefcase3_pickedup_km4 = 1
		ENDIF

	ENDIF

	IF LOCATE_PLAYER_ANY_MEANS_3D player 940.0 -185.0 4.2 25.0 25.0 10.0 FALSE
			
		IF flag_hispanic1_km4_dead = 0
		AND flag_hispanic1_hate_player_km4 = 0
			SET_CHAR_THREAT_SEARCH hispanic1_km4 THREAT_PLAYER1
			TURN_CHAR_TO_FACE_PLAYER hispanic1_km4 player
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS hispanic1_km4 player 
			flag_hispanic1_hate_player_km4 = 1 
		ENDIF

		IF flag_hispanic2_km4_dead = 0
		AND flag_hispanic2_hate_player_km4 = 0
			SET_CHAR_THREAT_SEARCH hispanic2_km4 THREAT_PLAYER1
			TURN_CHAR_TO_FACE_PLAYER hispanic2_km4 player
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS hispanic2_km4 player 
			flag_hispanic2_hate_player_km4 = 1
		ENDIF

		IF flag_hispanic3_km4_dead = 0
		AND flag_hispanic3_hate_player_km4 = 0
			SET_CHAR_THREAT_SEARCH hispanic3_km4 THREAT_PLAYER1
			TURN_CHAR_TO_FACE_PLAYER hispanic3_km4 player
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS hispanic3_km4 player
			flag_hispanic3_hate_player_km4 = 1 
		ENDIF

		IF flag_hispanic4_km4_dead = 0
		AND flag_hispanic4_hate_player_km4 = 0
			SET_CHAR_THREAT_SEARCH hispanic4_km4 THREAT_PLAYER1
			TURN_CHAR_TO_FACE_PLAYER hispanic4_km4 player
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS hispanic4_km4 player
			flag_hispanic4_hate_player_km4 = 1 
		ENDIF

		IF flag_hispanic5_km4_dead = 0
		AND flag_hispanic5_hate_player_km4 = 0
			SET_CHAR_THREAT_SEARCH hispanic5_km4 THREAT_PLAYER1
			TURN_CHAR_TO_FACE_PLAYER hispanic5_km4 player
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS hispanic5_km4 player
			flag_hispanic5_hate_player_km4 = 1 
		ENDIF
						
	ENDIF
			
ENDWHILE

PRINT_NOW ( KM4_11 ) 5000 1 //"Take the money back to the casino!"

ADD_BLIP_FOR_COORD 452.3 -1465.8 17.6 radar_blip_coord6_km4

blob_flag = 1 

WHILE NOT LOCATE_STOPPED_PLAYER_ANY_MEANS_3D player 452.3 -1465.8 17.6 4.0 4.0 4.0 blob_flag

	WAIT 0
  
ENDWHILE

REMOVE_BLIP radar_blip_coord6_km4

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

SET_POLICE_IGNORE_PLAYER player ON

SET_EVERYONE_IGNORE_PLAYER player ON

GET_PLAYER_CHAR player script_controlled_player

IF IS_PLAYER_IN_ANY_CAR player

	STORE_CAR_PLAYER_IS_IN player car_cut_km4
	SET_CHAR_OBJ_LEAVE_CAR script_controlled_player car_cut_km4
	
	WHILE IS_PLAYER_IN_CAR player car_cut_km4
	
		WAIT 0

		IF IS_CAR_DEAD car_cut_km4
			PRINT_NOW ( WRECKED ) 5000 1 //"The vehicles wrecked!"
			GOTO mission_kenji4_failed
		ENDIF 
		
	ENDWHILE
	
ENDIF

SET_FIXED_CAMERA_POSITION 420.41 -1479.59 26.13 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 420.87 -1478.75 26.38 JUMP_CUT

SET_PLAYER_COORDINATES player 425.85 -1477.16 -100.0

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT script_controlled_player 428.57 -1465.01

WHILE NOT IS_CHAR_OBJECTIVE_PASSED script_controlled_player

	WAIT 0
	
ENDWHILE

SET_FADING_COLOUR 0 0 0

DO_FADE 1000 FADE_OUT

WHILE GET_FADING_STATUS

	WAIT 0
	
ENDWHILE

SET_PLAYER_COORDINATES player 426.81 -1486.40 17.64

SET_PLAYER_HEADING player 180.0

RESTORE_CAMERA_JUMPCUT

SET_CAMERA_IN_FRONT_OF_PLAYER 

SET_FADING_COLOUR 0 0 0

DO_FADE 1000 FADE_IN

WHILE GET_FADING_STATUS

	WAIT 0
	
ENDWHILE

SWITCH_WIDESCREEN OFF

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

SET_EVERYONE_IGNORE_PLAYER player OFF

}

GOTO mission_kenji4_passed
	   		


// Mission Kenji3 failed

mission_kenji4_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

RETURN

   

// mission Kenji3 passed

mission_kenji4_passed:

flag_kenji_mission4_passed = 1
REGISTER_MISSION_PASSED ( KM4 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( m_pass ) 10000 5000 1  //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 10000
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT kenji_mission5_loop
RETURN
		


// mission cleanup

mission_cleanup_kenji4:

flag_player_on_mission = 0
flag_player_on_kenji_mission = 0
switch_gang_diablo_off = 0

IF flag_briefcase1_created_km4 = 1

	IF flag_briefcase1_collected_km4 = 0
		REMOVE_PICKUP briefcase1_km4
	ENDIF

ENDIF

IF flag_briefcase2_created_km4 = 1

	IF flag_briefcase2_collected_km4 = 0
		REMOVE_PICKUP briefcase2_km4
	ENDIF

ENDIF

IF flag_briefcase3_created_km4 = 1

	IF flag_briefcase3_collected_km4 = 0
		REMOVE_PICKUP briefcase3_km4
	ENDIF

ENDIF

REMOVE_BLIP radar_blip_diablo1_km4
REMOVE_BLIP radar_blip_diablo2_km4
REMOVE_BLIP radar_blip_diablo3_km4
REMOVE_BLIP radar_blip_diablo4_km4
REMOVE_BLIP radar_blip_diablo5_km4
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_DIABLO_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_A
REMOVE_BLIP radar_blip_coord2_km4
REMOVE_BLIP radar_blip_coord3_km4
REMOVE_BLIP radar_blip_coord4_km4
REMOVE_BLIP radar_blip_coord5_km4
REMOVE_BLIP radar_blip_coord1_km4
REMOVE_BLIP radar_blip_coord6_km4
REMOVE_BLIP radar_blip_dummy1_km4
REMOVE_BLIP radar_blip_dummy2_km4
REMOVE_BLIP radar_blip_dummy3_km4
REMOVE_BLIP radar_blip_dummy4_km4
REMOVE_BLIP radar_blip_dummy5_km4
SET_PED_DENSITY park DAY 1
SET_PED_DENSITY park NIGHT 1
MISSION_HAS_FINISHED
RETURN
	
MISSION_START
// *****************************************************************************************
// *******************************   Kenji Mission 5   ************************************* 
// *******************************     Smack Down      *************************************
// *****************************************************************************************
// *** Kenji wants you to hit the Yardies pushing Spank for the Cartel. They're dotted   ***
// *** about Liberty dealing in gangs or from vehicles. The player must race round the 	 ***
// *** city splattering and killing all the dealers within a time limit. Occasionally 	 ***
// *** they may have a 'backup vehicle' that will give chase to make the mission harder. ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_kenji5

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_kenji5_failed
ENDIF

GOSUB mission_cleanup_kenji5

MISSION_END
 
// Variables For Mission

VAR_INT number_of_peds ped_2_exists ped_2_blip ped_2 delete_oldest_ped_time	on_screen_counter_flag
VAR_INT ped_3_exists ped_3_blip ped_3 ped_4_exists ped_4_blip ped_4 dead_peds minimum_kills	reward_kills
VAR_INT ped_1_time ped_2_time ped_3_time ped_4_time oldest_ped_time oldest_ped random_direction
VAR_INT ped_1_blip ped_1_exists ped_1
VAR_INT ped_5_blip ped_5_exists ped_5 ped_5_time
VAR_INT ped_6_blip ped_6_exists ped_6 ped_6_time
VAR_INT ped_7_blip ped_7_exists ped_7 ped_7_time			 cs_yakuza2
VAR_INT ped_8_blip ped_8_exists ped_8 ped_8_time
VAR_INT ped_9_blip ped_9_exists ped_9 ped_9_time
VAR_INT ped_10_blip ped_10_exists ped_10 ped_10_time
VAR_INT ped_11_blip ped_11_exists ped_11 ped_11_time
VAR_INT ped_12_blip ped_12_exists ped_12 ped_12_time
VAR_INT ped_13_blip ped_13_exists ped_13 ped_13_time
VAR_INT ped_14_blip ped_14_exists ped_14 ped_14_time
VAR_INT ped_15_blip ped_15_exists ped_15 ped_15_time

VAR_FLOAT ped_15_x ped_15_y ped_15_z 
VAR_FLOAT ped_14_x ped_14_y ped_14_z 
VAR_FLOAT ped_13_x ped_13_y ped_13_z 
VAR_FLOAT ped_12_x ped_12_y ped_12_z 
VAR_FLOAT ped_11_x ped_11_y ped_11_z 
VAR_FLOAT ped_10_x ped_10_y ped_10_z 
VAR_FLOAT ped_9_x ped_9_y ped_9_z 
VAR_FLOAT ped_8_x ped_8_y ped_8_z 
VAR_FLOAT ped_7_x ped_7_y ped_7_z 
VAR_FLOAT ped_6_x ped_6_y ped_6_z 
VAR_FLOAT ped_5_x ped_5_y ped_5_z 
VAR_FLOAT ped_1_x ped_1_y ped_1_z 
VAR_FLOAT ped_2_x ped_2_y ped_2_z ped_3_x ped_3_y ped_3_z 
VAR_FLOAT ped_4_x ped_4_y ped_4_z random_commercial_x random_commercial_y garbage_x	garbage_y garbage_z
VAR_FLOAT difference_x difference_y sum_diff distance

// ****************************************Mission Start************************************

mission_start_kenji5:

flag_player_on_mission = 1
flag_player_on_kenji_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

SCRIPT_NAME kenji5

number_of_peds 			= 0
ped_2_exists 			= 0
delete_oldest_ped_time	= 0
on_screen_counter_flag  = 0
ped_3_exists  			= 0
ped_4_exists 			= 0
dead_peds  				= 0
minimum_kills  			= 0
ped_1_time  			= 0
ped_2_time  			= 0
ped_3_time 	 			= 0
ped_4_time  			= 0
oldest_ped_time  		= 0
oldest_ped  			= 0
random_direction 		= 0
ped_1_exists 			= 0
ped_5_exists  			= 0
ped_5_time 				= 0
ped_6_exists  			= 0
ped_6_time 				= 0
ped_7_exists  			= 0
ped_7_time 				= 0
ped_8_exists  			= 0
ped_8_time  			= 0
ped_9_exists  			= 0
ped_9_time				= 0
ped_10_exists  			= 0
ped_10_time	 			= 0
ped_11_exists  			= 0
ped_11_time	 			= 0
ped_12_exists  			= 0
ped_12_time				= 0
ped_13_exists  			= 0
ped_13_time	 			= 0
ped_14_exists  			= 0
ped_14_time	 			= 0
ped_15_exists  			= 0
ped_15_time	 			= 0

minimum_kills = 8
{
// ****************************************START OF CUTSCENE********************************

/*
SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_kenji5_failed
ENDIF

SWITCH_STREAMING OFF

PRINT_BIG KM5 15000 2 // "SMACK DOWN"
*/

LOAD_SPECIAL_CHARACTER 1 KENJI
REQUEST_MODEL PED_GANG_YAKUZA_A
REQUEST_MODEL PED_GANG_YAKUZA_B
REQUEST_MODEL PED_GANG_YARDIE_A
LOAD_SPECIAL_MODEL cut_obj1 KENJIH
REQUEST_MODEL casino_garden 

/*
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
*/

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED PED_GANG_YAKUZA_A 
OR NOT HAS_MODEL_LOADED PED_GANG_YAKUZA_B
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED casino_garden
	WAIT 0
ENDWHILE

LOAD_CUTSCENE K5_SD

SET_CUTSCENE_OFFSET 476.380 -1382.168 67.347

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_kenji
SET_CUTSCENE_ANIM cs_kenji kenji

CREATE_CUTSCENE_OBJECT PED_GANG_YAKUZA_A cs_yakuza
SET_CUTSCENE_ANIM cs_yakuza gang07

CREATE_CUTSCENE_OBJECT PED_GANG_YAKUZA_B cs_yakuza2
SET_CUTSCENE_ANIM cs_yakuza2 gang08

CREATE_CUTSCENE_HEAD cs_kenji cut_obj1 cs_kenjihead
SET_CUTSCENE_HEAD_ANIM cs_kenjihead kenji

//CREATE_CUTSCENE_HEAD cs_player cut_obj2 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CLEAR_AREA 459.1 -1413.0 25.11 1.0 TRUE 
SET_PLAYER_COORDINATES player 459.1 -1413.0 25.11							   
SET_PLAYER_HEADING player 132.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 6121
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW KM5_A 7000 1 //"YOU! How fitting you should choose this moment to show your worthless face!"

WHILE cs_time < 11088
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW KM5_B 7000 1 //"It would appear your attempts to dissuade the Jamaicans"

WHILE cs_time < 13770
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW KM5_B1 7000 1 //"from becoming bed fellows with the Cartel were wholly inadequate!"

WHILE cs_time < 17324
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW KM5_C 7000 1 //"Yardie pushers line Liberty's streets selling packets of SPANK like they were selling hotdogs!"

WHILE cs_time < 22060
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW KM5_D 7000 1 //"Those Cartel pigs are laughing at us, at me!" 

WHILE cs_time < 24716
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW KM5_E 7000 1 //"I will give you one last chance to prove my sister's faith in you to be well founded!"

WHILE cs_time < 29220
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW KM5_F 7000 1 //"Run these scumbags into the ground and wash your shame in rivers of our enemies' blood!!!"

WHILE cs_time < 33666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_STREAMING ON

SWITCH_RUBBISH ON

DO_FADE 1500 FADE_IN 

SET_CAMERA_IN_FRONT_OF_PLAYER

//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_B
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED casino_garden 

// *******************************************END OF CUTSCENE*******************************


WHILE NOT HAS_MODEL_LOADED PED_GANG_YARDIE_A
	WAIT 0
ENDWHILE

DISPLAY_RADAR 2 // PATHING OFF

GOTO main_part_of_script

create_random_ped://///////////////////////////////////////////////////////////////////////////

IF delete_oldest_ped_time > 10000
	delete_oldest_ped_time = delete_oldest_ped_time - 5000
ENDIF

IF ped_1_exists = 0	
	generate_coord_ped_1:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_1_x ped_1_y ped_1_z
	difference_x = garbage_x - ped_1_x
	difference_y = garbage_y - ped_1_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_1
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_1_x ped_1_y ped_1_z GREEN BLIP_ONLY ped_1_blip
	CHANGE_BLIP_SCALE ped_1_blip 3
	ped_1_exists = 1
	GET_GAME_TIMER ped_1_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_2_exists = 0	
	generate_coord_ped_2:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_2_x ped_2_y ped_2_z
	difference_x = garbage_x - ped_2_x
	difference_y = garbage_y - ped_2_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_2
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_2_x ped_2_y ped_2_z GREEN BLIP_ONLY ped_2_blip
	CHANGE_BLIP_SCALE ped_2_blip 3
	ped_2_exists = 1
	GET_GAME_TIMER ped_2_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_3_exists = 0	
	generate_coord_ped_3:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_3_x ped_3_y ped_3_z
	difference_x = garbage_x - ped_3_x
	difference_y = garbage_y - ped_3_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_3
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_3_x ped_3_y ped_3_z GREEN BLIP_ONLY ped_3_blip
	CHANGE_BLIP_SCALE ped_3_blip 3
	ped_3_exists = 1
	GET_GAME_TIMER ped_3_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_4_exists = 0	
	generate_coord_ped_4:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_4_x ped_4_y ped_4_z
	difference_x = garbage_x - ped_4_x
	difference_y = garbage_y - ped_4_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_4
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_4_x ped_4_y ped_4_z GREEN BLIP_ONLY ped_4_blip
	CHANGE_BLIP_SCALE ped_4_blip 3
	ped_4_exists = 1
	GET_GAME_TIMER ped_4_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_5_exists = 0	
	generate_coord_ped_5:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_5_x ped_5_y ped_5_z
	difference_x = garbage_x - ped_5_x
	difference_y = garbage_y - ped_5_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_5
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_5_x ped_5_y ped_5_z GREEN BLIP_ONLY ped_5_blip
	CHANGE_BLIP_SCALE ped_5_blip 3
	ped_5_exists = 1
	GET_GAME_TIMER ped_5_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_6_exists = 0	
	generate_coord_ped_6:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_6_x ped_6_y ped_6_z
	difference_x = garbage_x - ped_6_x
	difference_y = garbage_y - ped_6_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_6
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_6_x ped_6_y ped_6_z GREEN BLIP_ONLY ped_6_blip
	CHANGE_BLIP_SCALE ped_6_blip 3
	ped_6_exists = 1
	GET_GAME_TIMER ped_6_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_7_exists = 0	
	generate_coord_ped_7:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_7_x ped_7_y ped_7_z
	difference_x = garbage_x - ped_7_x
	difference_y = garbage_y - ped_7_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_7
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_7_x ped_7_y ped_7_z GREEN BLIP_ONLY ped_7_blip
	CHANGE_BLIP_SCALE ped_7_blip 3
	ped_7_exists = 1
	GET_GAME_TIMER ped_7_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_8_exists = 0	
	generate_coord_ped_8:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_8_x ped_8_y ped_8_z
	difference_x = garbage_x - ped_8_x
	difference_y = garbage_y - ped_8_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_8
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_8_x ped_8_y ped_8_z GREEN BLIP_ONLY ped_8_blip
	CHANGE_BLIP_SCALE ped_8_blip 3
	ped_8_exists = 1
	GET_GAME_TIMER ped_8_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_9_exists = 0	
	generate_coord_ped_9:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_9_x ped_9_y ped_9_z
	difference_x = garbage_x - ped_9_x
	difference_y = garbage_y - ped_9_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_9
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_9_x ped_9_y ped_9_z GREEN BLIP_ONLY ped_9_blip
	CHANGE_BLIP_SCALE ped_9_blip 3
	ped_9_exists = 1
	GET_GAME_TIMER ped_9_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_10_exists = 0	
	generate_coord_ped_10:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_10_x ped_10_y ped_10_z
	difference_x = garbage_x - ped_10_x
	difference_y = garbage_y - ped_10_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_10
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_10_x ped_10_y ped_10_z GREEN BLIP_ONLY ped_10_blip
	CHANGE_BLIP_SCALE ped_10_blip 3
	ped_10_exists = 1
	GET_GAME_TIMER ped_10_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_11_exists = 0	
	generate_coord_ped_11:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_11_x ped_11_y ped_11_z
	difference_x = garbage_x - ped_11_x
	difference_y = garbage_y - ped_11_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_11
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_11_x ped_11_y ped_11_z GREEN BLIP_ONLY ped_11_blip
	CHANGE_BLIP_SCALE ped_11_blip 3
	ped_11_exists = 1
	GET_GAME_TIMER ped_11_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_12_exists = 0	
	generate_coord_ped_12:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_12_x ped_12_y ped_12_z
	difference_x = garbage_x - ped_12_x
	difference_y = garbage_y - ped_12_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_12
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_12_x ped_12_y ped_12_z GREEN BLIP_ONLY ped_12_blip
	CHANGE_BLIP_SCALE ped_12_blip 3
	ped_12_exists = 1
	GET_GAME_TIMER ped_12_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_13_exists = 0	
	generate_coord_ped_13:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_13_x ped_13_y ped_13_z
	difference_x = garbage_x - ped_13_x
	difference_y = garbage_y - ped_13_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_13
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_13_x ped_13_y ped_13_z GREEN BLIP_ONLY ped_13_blip
	CHANGE_BLIP_SCALE ped_13_blip 3
	ped_13_exists = 1
	GET_GAME_TIMER ped_13_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_14_exists = 0	
	generate_coord_ped_14:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_14_x ped_14_y ped_14_z
	difference_x = garbage_x - ped_14_x
	difference_y = garbage_y - ped_14_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_14
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_14_x ped_14_y ped_14_z GREEN BLIP_ONLY ped_14_blip
	CHANGE_BLIP_SCALE ped_14_blip 3
	ped_14_exists = 1
	GET_GAME_TIMER ped_14_time
	++ number_of_peds
	RETURN
ENDIF

IF ped_15_exists = 0	
	generate_coord_ped_15:
	GENERATE_RANDOM_FLOAT_IN_RANGE -173.0 460.0 random_commercial_x
	GENERATE_RANDOM_FLOAT_IN_RANGE -1627.0 100.0 random_commercial_y
	GET_PLAYER_COORDINATES player garbage_x	garbage_y garbage_z
	GET_CLOSEST_CHAR_NODE random_commercial_x random_commercial_y garbage_z ped_15_x ped_15_y ped_15_z
	difference_x = garbage_x - ped_15_x
	difference_y = garbage_y - ped_15_y
	difference_x = difference_x * difference_x
	difference_y = difference_y * difference_y
	sum_diff = difference_x + difference_y
	SQRT sum_diff distance
	IF distance < 110.0
		GOTO generate_coord_ped_15
	ENDIF
	ADD_BLIP_FOR_COORD_OLD ped_15_x ped_15_y ped_15_z GREEN BLIP_ONLY ped_15_blip
	CHANGE_BLIP_SCALE ped_15_blip 3
	ped_15_exists = 1
	GET_GAME_TIMER ped_15_time
	++ number_of_peds
	RETURN
ENDIF

RETURN


main_part_of_script:///////////////////////////////////////////////////////////////////////////

ped_1_x	= 39.3
ped_1_y	= -880.6
ped_1_z	= 34.0

ped_2_x	= -55.4331
ped_2_y	= -974.3467
ped_2_z	= 25.4

delete_oldest_ped_time = 80000

ADD_BLIP_FOR_COORD_OLD ped_1_x ped_1_y ped_1_z GREEN BLIP_ONLY ped_1_blip
CHANGE_BLIP_SCALE ped_1_blip 3

ADD_BLIP_FOR_COORD_OLD ped_2_x ped_2_y ped_2_z GREEN BLIP_ONLY ped_2_blip
CHANGE_BLIP_SCALE ped_2_blip 3

PRINT_NOW KM5_6 5000 1 //"You must murder at least 8 Yardie dealers."
PRINT_SOON KM5_7 6000 1	//"Kill them quickly!  Once they've pushed their SPANK they're off the streets."

DISPLAY_ONSCREEN_COUNTER_WITH_STRING dead_peds COUNTER_DISPLAY_NUMBER KILLS

ped_1_exists = 1
ped_2_exists = 1
number_of_peds = 2
TIMERA = 0

WHILE number_of_peds > 0
	
	WAIT 0
	
	IF dead_peds > 0
		IF TIMERA > delete_oldest_ped_time
			TIMERA = 0
			GOSUB delete_oldest_ped
		ENDIF
	ENDIF
	
	IF ped_1_exists > 0
		IF ped_1_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_1_x ped_1_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_1_x ped_1_y ped_1_z ped_1
    			GIVE_WEAPON_TO_CHAR	ped_1 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_1 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_1 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_1 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_1 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_1 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_1 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_1 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_1 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_1 random_direction
				REMOVE_BLIP ped_1_blip
				ADD_BLIP_FOR_CHAR_OLD ped_1 GREEN BOTH ped_1_blip
				CHANGE_BLIP_SCALE ped_1_blip 3
				ped_1_exists = 2
			ENDIF
		ENDIF
		IF ped_1_exists = 2
			IF IS_CHAR_DEAD ped_1
				REMOVE_BLIP ped_1_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_1
				ped_1_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				IF on_screen_counter_flag = 0
					PRINT_SOON KM5_7 6000 1	//"Kill them quickly!  Once they've pushed their SPANK they're off the streets."
					TIMERA = 0
					on_screen_counter_flag = 1
				ENDIF
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_1_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_1 90.0 90.0 0
					GET_CHAR_COORDINATES ped_1 ped_1_x ped_1_y ped_1_z
					REMOVE_BLIP ped_1_blip
					ADD_BLIP_FOR_COORD_OLD ped_1_x ped_1_y ped_1_z GREEN BLIP_ONLY ped_1_blip
					CHANGE_BLIP_SCALE ped_1_blip 3
					DELETE_CHAR ped_1
					ped_1_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_2_exists > 0
		IF ped_2_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_2_x ped_2_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_2_x ped_2_y ped_2_z ped_2
    			GIVE_WEAPON_TO_CHAR	ped_2 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_2 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_2 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_2 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_2 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_2 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_2 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_2 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_2 TRUE
				REMOVE_BLIP ped_2_blip
				ADD_BLIP_FOR_CHAR_OLD ped_2 GREEN BOTH ped_2_blip
				CHANGE_BLIP_SCALE ped_2_blip 3
				ped_2_exists = 2
			ENDIF
		ENDIF
		IF ped_2_exists = 2
			IF IS_CHAR_DEAD ped_2
				REMOVE_BLIP ped_2_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_2
				ped_2_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				IF on_screen_counter_flag = 0
					PRINT_SOON KM5_7 6000 1	//"Kill them quickly!  Once they've pushed their SPANK they're off the streets."
					TIMERA = 0
					on_screen_counter_flag = 1
				ENDIF
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_2_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_2 90.0 90.0 0
					GET_CHAR_COORDINATES ped_2 ped_2_x ped_2_y ped_2_z
					REMOVE_BLIP ped_2_blip
					ADD_BLIP_FOR_COORD_OLD ped_2_x ped_2_y ped_2_z GREEN BLIP_ONLY ped_2_blip
					CHANGE_BLIP_SCALE ped_2_blip 3
					DELETE_CHAR ped_2
					ped_2_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_3_exists > 0
		IF ped_3_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_3_x ped_3_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_3_x ped_3_y ped_3_z ped_3
    			GIVE_WEAPON_TO_CHAR	ped_3 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_3 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_3 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_3 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_3 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_3 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_3 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_3 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_3 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_3 random_direction
				REMOVE_BLIP ped_3_blip
				ADD_BLIP_FOR_CHAR_OLD ped_3 GREEN BOTH ped_3_blip
				CHANGE_BLIP_SCALE ped_3_blip 3
				ped_3_exists = 2
			ENDIF
		ENDIF
		IF ped_3_exists = 2
			IF IS_CHAR_DEAD ped_3
				REMOVE_BLIP ped_3_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_3
				ped_3_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_3_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_3 90.0 90.0 0
					GET_CHAR_COORDINATES ped_3 ped_3_x ped_3_y ped_3_z
					REMOVE_BLIP ped_3_blip
					ADD_BLIP_FOR_COORD_OLD ped_3_x ped_3_y ped_3_z GREEN BLIP_ONLY ped_3_blip
					CHANGE_BLIP_SCALE ped_3_blip 3
					DELETE_CHAR ped_3
					ped_3_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_4_exists > 0
		IF ped_4_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_4_x ped_4_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_4_x ped_4_y ped_4_z ped_4
    			GIVE_WEAPON_TO_CHAR	ped_4 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_4 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_4 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_4 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_4 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_4 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_4 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_4 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_4 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_4 random_direction
				REMOVE_BLIP ped_4_blip
				ADD_BLIP_FOR_CHAR_OLD ped_4 GREEN BOTH ped_4_blip
				CHANGE_BLIP_SCALE ped_4_blip 3
				ped_4_exists = 2
			ENDIF
		ENDIF
		IF ped_4_exists = 2
			IF IS_CHAR_DEAD ped_4
				REMOVE_BLIP ped_4_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_4
				ped_4_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_4_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_4 90.0 90.0 0
					GET_CHAR_COORDINATES ped_4 ped_4_x ped_4_y ped_4_z
					REMOVE_BLIP ped_4_blip
					ADD_BLIP_FOR_COORD_OLD ped_4_x ped_4_y ped_4_z GREEN BLIP_ONLY ped_4_blip
					CHANGE_BLIP_SCALE ped_4_blip 3
					DELETE_CHAR ped_4
					ped_4_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_5_exists > 0
		IF ped_5_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_5_x ped_5_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_5_x ped_5_y ped_5_z ped_5
    			GIVE_WEAPON_TO_CHAR	ped_5 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_5 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_5 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_5 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_5 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_5 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_5 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_5 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_5 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_5 random_direction
				REMOVE_BLIP ped_5_blip
				ADD_BLIP_FOR_CHAR_OLD ped_5 GREEN BOTH ped_5_blip
				CHANGE_BLIP_SCALE ped_5_blip 3
				ped_5_exists = 2
			ENDIF
		ENDIF
		IF ped_5_exists = 2
			IF IS_CHAR_DEAD ped_5
				REMOVE_BLIP ped_5_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_5
				ped_5_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_5_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_5 90.0 90.0 0
					GET_CHAR_COORDINATES ped_5 ped_5_x ped_5_y ped_5_z
					REMOVE_BLIP ped_5_blip
					ADD_BLIP_FOR_COORD_OLD ped_5_x ped_5_y ped_5_z GREEN BLIP_ONLY ped_5_blip
					CHANGE_BLIP_SCALE ped_5_blip 3
					DELETE_CHAR ped_5
					ped_5_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_6_exists > 0
		IF ped_6_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_6_x ped_6_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_6_x ped_6_y ped_6_z ped_6
    			GIVE_WEAPON_TO_CHAR	ped_6 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_6 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_6 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_6 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_6 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_6 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_6 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_6 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_6 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_6 random_direction
				REMOVE_BLIP ped_6_blip
				ADD_BLIP_FOR_CHAR_OLD ped_6 GREEN BOTH ped_6_blip
				CHANGE_BLIP_SCALE ped_6_blip 3
				ped_6_exists = 2
			ENDIF
		ENDIF
		IF ped_6_exists = 2
			IF IS_CHAR_DEAD ped_6
				REMOVE_BLIP ped_6_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_6
				ped_6_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_6_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_6 90.0 90.0 0
					GET_CHAR_COORDINATES ped_6 ped_6_x ped_6_y ped_6_z
					REMOVE_BLIP ped_6_blip
					ADD_BLIP_FOR_COORD_OLD ped_6_x ped_6_y ped_6_z GREEN BLIP_ONLY ped_6_blip
					CHANGE_BLIP_SCALE ped_6_blip 3
					DELETE_CHAR ped_6
					ped_6_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_7_exists > 0
		IF ped_7_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_7_x ped_7_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_7_x ped_7_y ped_7_z ped_7
    			GIVE_WEAPON_TO_CHAR	ped_7 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_7 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_7 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_7 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_7 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_7 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_7 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_7 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_7 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_7 random_direction
				REMOVE_BLIP ped_7_blip
				ADD_BLIP_FOR_CHAR_OLD ped_7 GREEN BOTH ped_7_blip
				CHANGE_BLIP_SCALE ped_7_blip 3
				ped_7_exists = 2
			ENDIF
		ENDIF
		IF ped_7_exists = 2
			IF IS_CHAR_DEAD ped_7
				REMOVE_BLIP ped_7_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_7
				ped_7_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_7_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_7 90.0 90.0 0
					GET_CHAR_COORDINATES ped_7 ped_7_x ped_7_y ped_7_z
					REMOVE_BLIP ped_7_blip
					ADD_BLIP_FOR_COORD_OLD ped_7_x ped_7_y ped_7_z GREEN BLIP_ONLY ped_7_blip
					CHANGE_BLIP_SCALE ped_7_blip 3
					DELETE_CHAR ped_7
					ped_7_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_8_exists > 0
		IF ped_8_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_8_x ped_8_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_8_x ped_8_y ped_8_z ped_8
    			GIVE_WEAPON_TO_CHAR	ped_8 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_8 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_8 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_8 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_8 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_8 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_8 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_8 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_8 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_8 random_direction
				REMOVE_BLIP ped_8_blip
				ADD_BLIP_FOR_CHAR_OLD ped_8 GREEN BOTH ped_8_blip
				CHANGE_BLIP_SCALE ped_8_blip 3
				ped_8_exists = 2
			ENDIF
		ENDIF
		IF ped_8_exists = 2
			IF IS_CHAR_DEAD ped_8
				REMOVE_BLIP ped_8_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_8
				ped_8_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_8_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_8 90.0 90.0 0
					GET_CHAR_COORDINATES ped_8 ped_8_x ped_8_y ped_8_z
					REMOVE_BLIP ped_8_blip
					ADD_BLIP_FOR_COORD_OLD ped_8_x ped_8_y ped_8_z GREEN BLIP_ONLY ped_8_blip
					CHANGE_BLIP_SCALE ped_8_blip 3
					DELETE_CHAR ped_8
					ped_8_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_9_exists > 0
		IF ped_9_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_9_x ped_9_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_9_x ped_9_y ped_9_z ped_9
    			GIVE_WEAPON_TO_CHAR	ped_9 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_9 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_9 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_9 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_9 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_9 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_9 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_9 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_9 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_9 random_direction
				REMOVE_BLIP ped_9_blip
				ADD_BLIP_FOR_CHAR_OLD ped_9 GREEN BOTH ped_9_blip
				CHANGE_BLIP_SCALE ped_9_blip 3
				ped_9_exists = 2
			ENDIF
		ENDIF
		IF ped_9_exists = 2
			IF IS_CHAR_DEAD ped_9
				REMOVE_BLIP ped_9_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_9
				ped_9_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_9_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_9 90.0 90.0 0
					GET_CHAR_COORDINATES ped_9 ped_9_x ped_9_y ped_9_z
					REMOVE_BLIP ped_9_blip
					ADD_BLIP_FOR_COORD_OLD ped_9_x ped_9_y ped_9_z GREEN BLIP_ONLY ped_9_blip
					CHANGE_BLIP_SCALE ped_9_blip 3
					DELETE_CHAR ped_9
					ped_9_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_10_exists > 0
		IF ped_10_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_10_x ped_10_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_10_x ped_10_y ped_10_z ped_10
    			GIVE_WEAPON_TO_CHAR	ped_10 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_10 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_10 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_10 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_10 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_10 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_10 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_10 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_10 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_10 random_direction
				REMOVE_BLIP ped_10_blip
				ADD_BLIP_FOR_CHAR_OLD ped_10 GREEN BOTH ped_10_blip
				CHANGE_BLIP_SCALE ped_10_blip 3
				ped_10_exists = 2
			ENDIF
		ENDIF
		IF ped_10_exists = 2
			IF IS_CHAR_DEAD ped_10
				REMOVE_BLIP ped_10_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_10
				ped_10_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_10_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_10 90.0 90.0 0
					GET_CHAR_COORDINATES ped_10 ped_10_x ped_10_y ped_10_z
					REMOVE_BLIP ped_10_blip
					ADD_BLIP_FOR_COORD_OLD ped_10_x ped_10_y ped_10_z GREEN BLIP_ONLY ped_10_blip
					CHANGE_BLIP_SCALE ped_10_blip 3
					DELETE_CHAR ped_10
					ped_10_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_11_exists > 0
		IF ped_11_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_11_x ped_11_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_11_x ped_11_y ped_11_z ped_11
    			GIVE_WEAPON_TO_CHAR	ped_11 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_11 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_11 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_11 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_11 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_11 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_11 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_11 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_11 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_11 random_direction
				REMOVE_BLIP ped_11_blip
				ADD_BLIP_FOR_CHAR_OLD ped_11 GREEN BOTH ped_11_blip
				CHANGE_BLIP_SCALE ped_11_blip 3
				ped_11_exists = 2
			ENDIF
		ENDIF
		IF ped_11_exists = 2
			IF IS_CHAR_DEAD ped_11
				REMOVE_BLIP ped_11_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_11
				ped_11_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_11_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_11 90.0 90.0 0
					GET_CHAR_COORDINATES ped_11 ped_11_x ped_11_y ped_11_z
					REMOVE_BLIP ped_11_blip
					ADD_BLIP_FOR_COORD_OLD ped_11_x ped_11_y ped_11_z GREEN BLIP_ONLY ped_11_blip
					CHANGE_BLIP_SCALE ped_11_blip 3
					DELETE_CHAR ped_11
					ped_11_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_12_exists > 0
		IF ped_12_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_12_x ped_12_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_12_x ped_12_y ped_12_z ped_12
    			GIVE_WEAPON_TO_CHAR	ped_12 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_12 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_12 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_12 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_12 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_12 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_12 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_12 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_12 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_12 random_direction
				REMOVE_BLIP ped_12_blip
				ADD_BLIP_FOR_CHAR_OLD ped_12 GREEN BOTH ped_12_blip
				CHANGE_BLIP_SCALE ped_12_blip 3
				ped_12_exists = 2
			ENDIF
		ENDIF
		IF ped_12_exists = 2
			IF IS_CHAR_DEAD ped_12
				REMOVE_BLIP ped_12_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_12
				ped_12_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_12_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_12 90.0 90.0 0
					GET_CHAR_COORDINATES ped_12 ped_12_x ped_12_y ped_12_z
					REMOVE_BLIP ped_12_blip
					ADD_BLIP_FOR_COORD_OLD ped_12_x ped_12_y ped_12_z GREEN BLIP_ONLY ped_12_blip
					CHANGE_BLIP_SCALE ped_12_blip 3
					DELETE_CHAR ped_12
					ped_12_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_13_exists > 0
		IF ped_13_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_13_x ped_13_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_13_x ped_13_y ped_13_z ped_13
    			GIVE_WEAPON_TO_CHAR	ped_13 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_13 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_13 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_13 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_13 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_13 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_13 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_13 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_13 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_13 random_direction
				REMOVE_BLIP ped_13_blip
				ADD_BLIP_FOR_CHAR_OLD ped_13 GREEN BOTH ped_13_blip
				CHANGE_BLIP_SCALE ped_13_blip 3
				ped_13_exists = 2
			ENDIF
		ENDIF
		IF ped_13_exists = 2
			IF IS_CHAR_DEAD ped_13
				REMOVE_BLIP ped_13_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_13
				ped_13_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_13_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_13 90.0 90.0 0
					GET_CHAR_COORDINATES ped_13 ped_13_x ped_13_y ped_13_z
					REMOVE_BLIP ped_13_blip
					ADD_BLIP_FOR_COORD_OLD ped_13_x ped_13_y ped_13_z GREEN BLIP_ONLY ped_13_blip
					CHANGE_BLIP_SCALE ped_13_blip 3
					DELETE_CHAR ped_13
					ped_13_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_14_exists > 0
		IF ped_14_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_14_x ped_14_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_14_x ped_14_y ped_14_z ped_14
    			GIVE_WEAPON_TO_CHAR	ped_14 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_14 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_14 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_14 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_14 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_14 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_14 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_14 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_14 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_14 random_direction
				REMOVE_BLIP ped_14_blip
				ADD_BLIP_FOR_CHAR_OLD ped_14 GREEN BOTH ped_14_blip
				CHANGE_BLIP_SCALE ped_14_blip 3
				ped_14_exists = 2
			ENDIF
		ENDIF
		IF ped_14_exists = 2
			IF IS_CHAR_DEAD ped_14
				REMOVE_BLIP ped_14_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_14
				ped_14_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_14_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_14 90.0 90.0 0
					GET_CHAR_COORDINATES ped_14 ped_14_x ped_14_y ped_14_z
					REMOVE_BLIP ped_14_blip
					ADD_BLIP_FOR_COORD_OLD ped_14_x ped_14_y ped_14_z GREEN BLIP_ONLY ped_14_blip
					CHANGE_BLIP_SCALE ped_14_blip 3
					DELETE_CHAR ped_14
					ped_14_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF ped_15_exists > 0
		IF ped_15_exists = 1
			IF LOCATE_PLAYER_ANY_MEANS_2D player ped_15_x ped_15_y 90.0 90.0 0
				CREATE_CHAR	PEDTYPE_GANG_YARDIE PED_GANG_YARDIE_A ped_15_x ped_15_y ped_15_z ped_15
    			GIVE_WEAPON_TO_CHAR	ped_15 WEAPONTYPE_UZI 999
				SET_CHAR_PERSONALITY ped_15 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH ped_15 THREAT_GUN
				SET_CHAR_THREAT_SEARCH ped_15 THREAT_FAST_CAR
				SET_CHAR_THREAT_SEARCH ped_15 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH ped_15 THREAT_PLAYER2
				SET_CHAR_THREAT_SEARCH ped_15 THREAT_PLAYER3
				SET_CHAR_THREAT_SEARCH ped_15 THREAT_PLAYER4
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER ped_15 TRUE
				GENERATE_RANDOM_INT_IN_RANGE 0 8 random_direction
				CHAR_WANDER_DIR ped_15 random_direction
				REMOVE_BLIP ped_15_blip
				ADD_BLIP_FOR_CHAR_OLD ped_15 GREEN BOTH ped_15_blip
				CHANGE_BLIP_SCALE ped_15_blip 3
				ped_15_exists = 2
			ENDIF
		ENDIF
		IF ped_15_exists = 2
			IF IS_CHAR_DEAD ped_15
				REMOVE_BLIP ped_15_blip
				MARK_CHAR_AS_NO_LONGER_NEEDED ped_15
				ped_15_exists = 0
				++ dead_peds
				-- number_of_peds
				PRINT_NOW KM5_1 2000 1 // "One down, two more to kill."
				GOSUB create_random_ped
				GOSUB create_random_ped
			ENDIF
			IF ped_15_exists = 2
				IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ped_15 90.0 90.0 0
					GET_CHAR_COORDINATES ped_15 ped_15_x ped_15_y ped_15_z
					REMOVE_BLIP ped_15_blip
					ADD_BLIP_FOR_COORD_OLD ped_15_x ped_15_y ped_15_z GREEN BLIP_ONLY ped_15_blip
					CHANGE_BLIP_SCALE ped_15_blip 3
					DELETE_CHAR ped_15
					ped_15_exists = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

ENDWHILE

IF dead_peds > minimum_kills
OR dead_peds = minimum_kills
	GOTO mission_kenji5_passed
ELSE
	GOTO mission_kenji5_failed
ENDIF


delete_oldest_ped://///////////////////////////////////////////////////////////////////////////

oldest_ped = 0

GET_GAME_TIMER oldest_ped_time

IF ped_1_exists = 1
AND ped_1_time < oldest_ped_time
	oldest_ped = 1
	oldest_ped_time = ped_1_time
ENDIF

IF ped_2_exists = 1
AND ped_2_time < oldest_ped_time
	oldest_ped = 2
	oldest_ped_time = ped_2_time
ENDIF

IF ped_3_exists = 1
AND ped_3_time < oldest_ped_time
	oldest_ped = 3
	oldest_ped_time = ped_3_time
ENDIF

IF ped_4_exists = 1
AND ped_4_time < oldest_ped_time
	oldest_ped = 4
	oldest_ped_time = ped_4_time
ENDIF

IF ped_5_exists = 1
AND ped_5_time < oldest_ped_time
	oldest_ped = 5
	oldest_ped_time = ped_5_time
ENDIF

IF ped_6_exists = 1
AND ped_6_time < oldest_ped_time
	oldest_ped = 6
	oldest_ped_time = ped_6_time
ENDIF

IF ped_7_exists = 1
AND ped_7_time < oldest_ped_time
	oldest_ped = 7
	oldest_ped_time = ped_7_time
ENDIF

IF ped_8_exists = 1
AND ped_8_time < oldest_ped_time
	oldest_ped = 8
	oldest_ped_time = ped_8_time
ENDIF

IF ped_9_exists = 1
AND ped_9_time < oldest_ped_time
	oldest_ped = 9
	oldest_ped_time = ped_9_time
ENDIF

IF ped_10_exists = 1
AND ped_10_time < oldest_ped_time
	oldest_ped = 10
	oldest_ped_time = ped_10_time
ENDIF

IF ped_11_exists = 1
AND ped_11_time < oldest_ped_time
	oldest_ped = 11
	oldest_ped_time = ped_11_time
ENDIF

IF ped_12_exists = 1
AND ped_12_time < oldest_ped_time
	oldest_ped = 12
	oldest_ped_time = ped_12_time
ENDIF

IF ped_13_exists = 1
AND ped_13_time < oldest_ped_time
	oldest_ped = 13
	oldest_ped_time = ped_13_time
ENDIF

IF ped_14_exists = 1
AND ped_14_time < oldest_ped_time
	oldest_ped = 14
	oldest_ped_time = ped_14_time
ENDIF

IF ped_15_exists = 1
AND ped_15_time < oldest_ped_time
	oldest_ped = 15
	oldest_ped_time = ped_15_time
ENDIF

///////////////////////////////////////

IF oldest_ped = 1
	REMOVE_BLIP ped_1_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_1
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_1_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 2
	REMOVE_BLIP ped_2_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_2
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_2_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 3
	REMOVE_BLIP ped_3_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_3
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_3_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 4
	REMOVE_BLIP ped_4_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_4
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_4_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 5
	REMOVE_BLIP ped_5_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_5
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_5_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 6
	REMOVE_BLIP ped_6_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_6
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_6_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 7
	REMOVE_BLIP ped_7_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_7
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_7_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 8
	REMOVE_BLIP ped_8_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_8
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_8_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 9
	REMOVE_BLIP ped_9_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_9
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_9_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 10
	REMOVE_BLIP ped_10_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_10
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_10_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 11
	REMOVE_BLIP ped_11_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_11
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_11_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 12
	REMOVE_BLIP ped_12_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_12
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_12_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 13
	REMOVE_BLIP ped_13_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_13
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_13_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 14
	REMOVE_BLIP ped_14_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_14
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_14_exists = 0
	-- number_of_peds
ENDIF

IF oldest_ped = 15
	REMOVE_BLIP ped_15_blip
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_15
	PRINT_NOW KM5_2 2000 1 // "A Yardie has gone to ground."
	ped_15_exists = 0
	-- number_of_peds
ENDIF

RETURN

}

// Mission Kenji5 failed

mission_kenji5_failed:
PRINT_BIG ( M_FAIL ) 5000 1
PRINT_WITH_NUMBER_NOW KM5_3 minimum_kills 3000 1 // "You failed to kill at least ~1~ yardies."
RETURN

   

// mission Kenji5 passed

mission_kenji5_passed:

flag_kenji_mission5_passed = 1
PRINT_WITH_NUMBER_BIG m_pass 10000 5000 1
ADD_SCORE player 10000
IF dead_peds = 8
	PRINT_WITH_NUMBER_NOW KM5_4 dead_peds 3000 1 // "Congratulations you killed ~1~ Yardies."
ELSE
	reward_kills = dead_peds - minimum_kills
	reward_kills = reward_kills * 1000
	PRINT_WITH_2_NUMBERS_NOW KM5_5 dead_peds reward_kills 3000 1 // "Congratulations you killed ~1~ Yardies."
	// 3master - wow did they forget to add the bonus here??
	ADD_SCORE player reward_kills
ENDIF	
CLEAR_WANTED_LEVEL player
REGISTER_MISSION_PASSED	KM5
PLAY_MISSION_PASSED_TUNE 1
PLAYER_MADE_PROGRESS 1
REMOVE_BLIP kenji_contact_blip
RETURN
		


// mission cleanup

mission_cleanup_kenji5:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_kenji_mission = 0

REMOVE_BLIP ped_1_blip
REMOVE_BLIP ped_2_blip
REMOVE_BLIP ped_3_blip
REMOVE_BLIP ped_4_blip
REMOVE_BLIP ped_5_blip
REMOVE_BLIP ped_6_blip
REMOVE_BLIP ped_7_blip
REMOVE_BLIP ped_8_blip

REMOVE_BLIP ped_9_blip
REMOVE_BLIP ped_10_blip
REMOVE_BLIP ped_11_blip
REMOVE_BLIP ped_12_blip
REMOVE_BLIP ped_13_blip
REMOVE_BLIP ped_14_blip
REMOVE_BLIP ped_15_blip

CLEAR_ONSCREEN_COUNTER dead_peds

MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YARDIE_A

MISSION_HAS_FINISHED

RETURN
		


MISSION_START
// *****************************************************************************************
// ************************************ Ray mission 1  ************************************* 
// ************************************ Silent Witness *************************************
// *****************************************************************************************
// *** There was a witness to Salvatore's murder, kill him! Go to the witness protection ***
// *** house and flush him out by throwing a grenade through the window. The witness and ***
// *** some police escorts run out and leg it in a car, chase them and kill them.		 ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_ray1

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_ray1_failed
ENDIF

GOSUB mission_cleanup_ray1

MISSION_END
 
// Variables for mission

VAR_INT get_away_car police_guard1 police_guard2 the_witness ray1_blip burning_cop
VAR_INT police_guard3 fire_1 fire_2 fire_3 fire_4 wanted_lvl_flag_r1 game_timer_r1 game_timer_start_r1
VAR_INT	car_moving_stuck_flag getaway_stuck_flag get_away_car_health game_timer_current_r1
VAR_INT mfail_timer mfail_timer_current mfail_timer_started	mfail_timer_reset_flag carlock_flag

VAR_FLOAT get_away_car_x get_away_car_y get_away_car_z

// ****************************************Mission Start************************************

mission_start_ray1:

flag_player_on_mission 		= 1
flag_player_on_ray_mission 	= 1
rays_cutscene_flag = 1

REGISTER_MISSION_GIVEN

WAIT 0

SCRIPT_NAME ray1

wanted_lvl_flag_r1 	   = 0
game_timer_r1 		   = 0
game_timer_start_r1	   = 0
car_moving_stuck_flag  = 0
getaway_stuck_flag 	   = 0
get_away_car_health    = 1000
game_timer_current_r1  = 0
get_away_car_x 		   = 0.0
get_away_car_y 		   = 0.0
get_away_car_z		   = 0.0
mfail_timer 		   = 0
mfail_timer_current    = 0
mfail_timer_started	   = 0
mfail_timer_reset_flag = 0
carlock_flag		   = 0
{
// ****************************************START OF CUTSCENE********************************

/*
SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_ray1_failed
ENDIF

SWITCH_STREAMING OFF

PRINT_BIG RM1 15000 2 //"Silence the sneak"
*/

LOAD_SPECIAL_CHARACTER 1 ray
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 RAYH
REQUEST_MODEL toilet

/*
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
*/

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED toilet
	WAIT 0
ENDWHILE

CLEAR_AREA 39.0 -723.5 22.0 1.0 TRUE

SET_PLAYER_COORDINATES player 39.0 -723.5 22.0

SET_PLAYER_HEADING player 90.0

LOAD_CUTSCENE r1_sw

SET_CUTSCENE_OFFSET 39.424 -726.677 21.692

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_ray
SET_CUTSCENE_ANIM cs_ray ray

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_ray CUT_OBJ2 cs_rayhead
SET_CUTSCENE_HEAD_ANIM cs_rayhead ray

DO_FADE 1500 FADE_IN
SET_NEAR_CLIP 0.2

START_CUTSCENE

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2070
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM1_A 8000 1 //"That scum bag McAffrey he took more bribes than anyone, and now he's gone too far."

WHILE cs_time < 6097
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM1_B 8000 1 //"Reckons he'll get an honorable discharge if he turns states evidence."

WHILE cs_time < 9509
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM1_C 8000 1 //"He just squealed."

WHILE cs_time < 11019
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM1_D	8000 1 //"He's under armed protection in a WitSec property down Newport some apartment behind the car park."

WHILE cs_time < 16109
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM1_E	8000 1 //"Torch the place and that should flush 'em out, then make sure he never talks to no one."

WHILE cs_time < 21333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

GIVE_WEAPON_TO_PLAYER player WEAPONTYPE_GRENADE 12

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

DO_FADE 0 FADE_OUT
SET_NEAR_CLIP 0.9

SET_CAMERA_BEHIND_PLAYER

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED toilet
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2

REQUEST_MODEL PED_LI_MAN2
REQUEST_MODEL CAR_SENTINEL

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED PED_LI_MAN2
OR NOT HAS_MODEL_LOADED	CAR_SENTINEL
	WAIT 0
ENDWHILE

SWITCH_STREAMING ON
DO_FADE 1500 FADE_IN 

rays_cutscene_flag = 0

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

// ******************************************END OF CUTSCENE********************************

REQUEST_MODEL safehouse

ADD_BLIP_FOR_COORD 378.0 -443.2 29.9 ray1_blip

PRINT_NOW RM1_1 5000 1 //"Check out the witness protection house."

WHILE NOT IS_PLAYER_STOPPED_IN_AREA_2D player 330.35 -471.43 375.982 -431.119 0
	WAIT 0
ENDWHILE

SET_PLAYER_CONTROL player OFF
SWITCH_WIDESCREEN ON
SET_EVERYONE_IGNORE_PLAYER player TRUE
SET_ALL_CARS_CAN_BE_DAMAGED FALSE
SET_FIXED_CAMERA_POSITION 373.29 -444.714 28.537 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 374.1447 -444.2669 28.8032 INTERPOLATION

WAIT 3000

SET_PLAYER_CONTROL player ON
SWITCH_WIDESCREEN OFF
SET_EVERYONE_IGNORE_PLAYER player FALSE
SET_ALL_CARS_CAN_BE_DAMAGED TRUE
RESTORE_CAMERA

LOAD_MISSION_AUDIO R1_A

get_away_car  = 0
police_guard1 = 0
police_guard2 = 0

WHILE NOT IS_PROJECTILE_IN_AREA 376.5 -445.2 28.1 380.1 -441.2 31.7 // THE WINDOW
	
	WAIT 0

	GET_AMMO_IN_PLAYER_WEAPON player WEAPONTYPE_GRENADE get_away_car
	GET_AMMO_IN_PLAYER_WEAPON player WEAPONTYPE_ROCKET police_guard1
	get_away_car +=	police_guard1

	IF police_guard2 = 0
		IF get_away_car = 0
			PRINT_NOW RM1_4 5000 1//"You have run out of grenades! Get some more from ammunation"
			REMOVE_BLIP	ray1_blip
			ADD_SPRITE_BLIP_FOR_COORD 345.5 -713.5 26.1 RADAR_SPRITE_WEAPON ray1_blip
			police_guard2 = 1
		ENDIF
	ENDIF

	IF police_guard2 = 1
		IF get_away_car > 0
			PRINT_NOW RM1_5 5000 1//"Get back to the safehouse and torch it"
			REMOVE_BLIP	ray1_blip
			ADD_BLIP_FOR_COORD 378.0 -443.2 29.9 ray1_blip
			police_guard2 = 0
		ENDIF
	ENDIF

ENDWHILE

DESTROY_PROJECTILES_IN_AREA 376.1 -445.2 28.1 380.1 -441.2 31.7

SET_PLAYER_CONTROL player OFF
SWITCH_WIDESCREEN ON
SET_EVERYONE_IGNORE_PLAYER player TRUE
SET_ALL_CARS_CAN_BE_DAMAGED FALSE
SET_FIXED_CAMERA_POSITION 373.29 -444.714 28.537 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 374.1447 -444.2669 28.8032 INTERPOLATION

WAIT 100

ADD_EXPLOSION 378.0 -443.5 28.9 EXPLOSION_GRENADE

WAIT 500

START_SCRIPT_FIRE 377.0 -444.0 28.1 fire_1
START_SCRIPT_FIRE 377.0 -443.0 28.1 fire_2
START_SCRIPT_FIRE 379.0 -444.0 28.1 fire_3
START_SCRIPT_FIRE 379.0 -443.0 28.1 fire_4
SET_SCRIPT_FIRE_AUDIO fire_1 TRUE
SET_SCRIPT_FIRE_AUDIO fire_2 FALSE
SET_SCRIPT_FIRE_AUDIO fire_3 FALSE
SET_SCRIPT_FIRE_AUDIO fire_4 FALSE

WAIT 250

CREATE_CHAR PEDTYPE_CIVMALE	PED_COP 378.0584 -444.7376 28.3 burning_cop

WAIT 250

ADD_PARTICLE_EFFECT POBJECT_DARK_SMOKE 377.0 -441.6 28.9 0
ADD_PARTICLE_EFFECT POBJECT_DARK_SMOKE 378.0 -443.3 28.9 0

WAIT 800

ADD_PARTICLE_EFFECT POBJECT_DARK_SMOKE 376.0 -443.35 30.0 0

WAIT 500

ADD_PARTICLE_EFFECT POBJECT_DARK_SMOKE 376.0 -442.7  30.0 0
ADD_PARTICLE_EFFECT POBJECT_DARK_SMOKE 376.0 -443.8  30.0 0

WAIT 1500

SET_PLAYER_CONTROL player ON
SWITCH_WIDESCREEN OFF
SET_EVERYONE_IGNORE_PLAYER player FALSE
SET_ALL_CARS_CAN_BE_DAMAGED TRUE
RESTORE_CAMERA_JUMPCUT
SET_CAMERA_BEHIND_PLAYER

//get_away_car  = 0
//police_guard1 = 0
//police_guard2 = 0

CREATE_CAR CAR_SENTINEL 380.0 -437.5 21.1 get_away_car // IN GARAGE
SET_CAR_HEADING get_away_car 90.0
LOCK_CAR_DOORS get_away_car CARLOCK_LOCKOUT_PLAYER_ONLY
SET_CAR_STRONG get_away_car TRUE

CREATE_CHAR_INSIDE_CAR get_away_car PEDTYPE_CIVMALE PED_COP police_guard1
CREATE_CHAR_AS_PASSENGER get_away_car PEDTYPE_CIVMALE PED_LI_MAN2 1 the_witness

CREATE_CHAR PEDTYPE_CIVMALE PED_COP 376.5428 -435.1743 20.0837 police_guard2
GIVE_WEAPON_TO_CHAR police_guard2 WEAPONTYPE_CHAINGUN 5000
SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	police_guard2 374.0 -435.1743

CREATE_CHAR PEDTYPE_CIVMALE PED_COP 376.5428 -439.7169 20.0837 police_guard3
GIVE_WEAPON_TO_CHAR police_guard3 WEAPONTYPE_CHAINGUN 5000
SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	police_guard3 374.0 -439.7169

DEACTIVATE_GARAGE witsec_garage
ACTIVATE_GARAGE witsec_garage

REMOVE_BLIP ray1_blip

SET_CAR_CRUISE_SPEED get_away_car 20.0
SET_CAR_DRIVING_STYLE get_away_car 2
CAR_WANDER_RANDOMLY	get_away_car
SET_CAR_AVOID_LEVEL_TRANSITIONS get_away_car TRUE

// disable pathing when killing the witness
DISPLAY_RADAR 2 // PATHING OFF

PRINT_NOW RM1_2 5000 1 //"Take out the witness!"

GET_GAME_TIMER game_timer_start_r1

WHILE IS_CHAR_STILL_ALIVE the_witness

	IF NOT IS_CHAR_DEAD police_guard2
		IF NOT IS_CHAR_IN_AREA_2D police_guard2 375.0 -441.5 386.0 -434.0	0
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT police_guard2 player
		ENDIF
	ENDIF
			
	IF NOT IS_CHAR_DEAD police_guard3
		IF NOT IS_CHAR_IN_AREA_2D police_guard3 375.0 -441.5 386.0 -434.0	0
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT police_guard3 player
		ENDIF
	ENDIF
			
	IF wanted_lvl_flag_r1 = 0
		GET_GAME_TIMER game_timer_current_r1
		game_timer_r1 = game_timer_current_r1 - game_timer_start_r1
		IF game_timer_r1 > 3000
			ALTER_WANTED_LEVEL_NO_DROP player 2
			ADD_BLIP_FOR_CHAR the_witness ray1_blip
			IF HAS_MISSION_AUDIO_LOADED
				PLAY_MISSION_AUDIO
			ENDIF
			wanted_lvl_flag_r1 = 1
		ENDIF
	ENDIF

	IF wanted_lvl_flag_r1 = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player the_witness 160.0 160.0 0
		AND NOT IS_CHAR_ON_SCREEN the_witness
			IF mfail_timer_reset_flag = 0
				REMOVE_BLIP	ray1_blip
				GET_GAME_TIMER mfail_timer_started
				mfail_timer_reset_flag = 1
			ENDIF

			IF mfail_timer_reset_flag = 1
				GET_GAME_TIMER mfail_timer_current
				mfail_timer = mfail_timer_current - mfail_timer_started
				IF mfail_timer > 4000
					IF NOT IS_CHAR_ON_SCREEN the_witness
						mfail_timer_reset_flag = 0
						DELETE_CHAR the_witness
						PRINT_NOW RM1_3 5000 1 //"McAffrey got away!"
						GOTO mission_ray1_failed
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		IF mfail_timer_reset_flag = 1
			IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player the_witness 160.0 160.0 0
			OR IS_CHAR_ON_SCREEN the_witness
				REMOVE_BLIP	ray1_blip
				ADD_BLIP_FOR_CHAR the_witness ray1_blip
				mfail_timer_reset_flag = 0
			ENDIF
		ENDIF
	ENDIF

	IF NOT IS_CHAR_IN_ANY_CAR the_witness
		SET_CHAR_OBJ_FLEE_PLAYER_ON_FOOT_ALWAYS	the_witness player
	ENDIF

	IF NOT IS_CAR_DEAD get_away_car
		
		IF IS_CHAR_IN_CAR the_witness get_away_car

			IF carlock_flag = 0
				IF NOT LOCATE_CAR_2D get_away_car 380.0 -437.5 40.0 40.0 0
					LOCK_CAR_DOORS get_away_car CARLOCK_UNLOCKED
					SET_CAR_CRUISE_SPEED get_away_car 40.0
					SET_CAR_STRONG get_away_car FALSE
					IF IS_CAR_HEALTH_GREATER get_away_car 800
						SET_CAR_HEALTH get_away_car 800
					ENDIF
					carlock_flag = 1
				ENDIF
			ENDIF
		
			IF IS_CAR_UPSIDEDOWN get_away_car
			AND IS_CAR_STOPPED get_away_car
				SET_CHAR_OBJ_LEAVE_CAR the_witness get_away_car
				IF NOT IS_CHAR_DEAD police_guard1
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT police_guard1 player
					GIVE_WEAPON_TO_CHAR police_guard1 WEAPONTYPE_CHAINGUN 5000
				ENDIF
			ENDIF

			IF IS_PLAYER_IN_CAR player get_away_car
				SET_CHAR_OBJ_LEAVE_CAR the_witness get_away_car
				IF NOT IS_CHAR_DEAD police_guard1
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT police_guard1 player
					GIVE_WEAPON_TO_CHAR police_guard1 WEAPONTYPE_CHAINGUN 5000
				ENDIF
			ENDIF

			GET_CAR_HEALTH get_away_car get_away_car_health
			IF get_away_car_health < 200
				SET_CHAR_OBJ_LEAVE_CAR the_witness get_away_car
				IF NOT IS_CHAR_DEAD police_guard1
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT police_guard1 player
					GIVE_WEAPON_TO_CHAR police_guard1 WEAPONTYPE_CHAINGUN 5000
				ENDIF
			ENDIF

			IF IS_CAR_STOPPED get_away_car
				IF getaway_stuck_flag = 0
					TIMERA = 0
					getaway_stuck_flag = 1
				ENDIF

				IF getaway_stuck_flag = 1
					IF TIMERA > 5000
						SET_CHAR_OBJ_LEAVE_CAR the_witness get_away_car
						IF NOT IS_CHAR_DEAD police_guard1
							SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT police_guard1 player
							GIVE_WEAPON_TO_CHAR police_guard1 WEAPONTYPE_CHAINGUN 5000
						ENDIF
					ENDIF
				ENDIF
			ENDIF

			IF NOT IS_CAR_STOPPED get_away_car
				getaway_stuck_flag = 0
			ENDIF

			IF LOCATE_CAR_2D get_away_car get_away_car_x get_away_car_y 3.0 3.0 0
				IF car_moving_stuck_flag = 0
					TIMERB = 0
					car_moving_stuck_flag = 1
				ENDIF

				IF car_moving_stuck_flag = 1
					IF TIMERB > 8000
						SET_CHAR_OBJ_LEAVE_CAR the_witness get_away_car
						IF NOT IS_CHAR_DEAD police_guard1
							SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT police_guard1 player
							GIVE_WEAPON_TO_CHAR police_guard1 WEAPONTYPE_CHAINGUN 5000
						ENDIF
					ENDIF
				ENDIF			
			ELSE
				GET_CAR_COORDINATES get_away_car get_away_car_x get_away_car_y get_away_car_z
				car_moving_stuck_flag = 0
			ENDIF
		ENDIF
	ENDIF

	WAIT 0
														 
ENDWHILE

GOTO mission_ray1_passed
}	   		
	
// Mission Ray 1 failed

mission_ray1_failed:
PRINT_BIG M_FAIL 5000 1
RETURN

   

// mission Ray 1 passed

mission_ray1_passed:

flag_ray_mission1_passed = 1
PRINT_WITH_NUMBER_BIG M_PASS 30000 5000 1
ADD_SCORE player 30000
CLEAR_WANTED_LEVEL player
PLAY_MISSION_PASSED_TUNE 1
REGISTER_MISSION_PASSED	RM1
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT ray_mission2_loop
RETURN
		


// mission cleanup

mission_cleanup_ray1:

DISPLAY_RADAR 3 // PATHING ON

REMOVE_BLIP ray1_blip

REMOVE_PARTICLE_EFFECTS_IN_AREA 372.0 -449.0 25.0 383.0 -436.0 33.0

MARK_MODEL_AS_NO_LONGER_NEEDED PED_LI_MAN2
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SENTINEL
MARK_MODEL_AS_NO_LONGER_NEEDED safehouse

flag_player_on_mission = 0
flag_player_on_ray_mission = 0
REMOVE_ALL_SCRIPT_FIRES
MISSION_HAS_FINISHED
RETURN
		


MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************Ray mission 2*********************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_ray2
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_ray2_failed
ENDIF
GOSUB mission_cleanup_ray2
MISSION_END
 
// Variables for mission

VAR_INT blip_warehouse_rm2
VAR_FLOAT wh_x_rm2 wh_y_rm2 wh2_x_rm2 wh2_y_rm2
VAR_FLOAT phils_defcon_x phils_defcon_y phils_defcon_z
//VAR_FLOAT phils_defcon_minx phils_defcon_miny phils_defcon_maxx phils_defcon_maxy
VAR_INT flag_phil_in_area flag_phil_arrived

//VAR_INT phils_m16 phils_uzi phils_shotgun
VAR_INT phils_molotov phils_rocket phils_m16 phils_uzi phils_shotgun phils_armour
VAR_INT flag_m16_gone flag_uzi_gone flag_rocket_gone flag_shotgun_gone
VAR_INT flag_molotov_gone
VAR_FLOAT m16_x m16_y
VAR_FLOAT uzi_x uzi_y
VAR_FLOAT rocket_x rocket_y rocket_z
VAR_FLOAT molotov_x molotov_y molotov_z
VAR_FLOAT shotgun_x shotgun_y

VAR_INT player_rm2 player_car_rm2
VAR_INT phil phil_truck_1 phil_truck_2 blip_phil
//VAR_INT phil_truck_3 
VAR_INT flag_phil_dead flag_trucks

VAR_INT varmint_1 varmint_2 varmint_3
VAR_INT varmint_4 varmint_5 varmint_6
VAR_INT varmint_7 varmint_8 varmint_9
VAR_INT varmint_10 varmint_11 varmint_12

VAR_INT blip_v1 blip_v2 blip_v3 blip_v4
VAR_INT blip_v5 blip_v6 blip_v7 blip_v8
VAR_INT blip_v9 blip_v10 blip_v11 blip_v12

VAR_INT flag_v1_dead flag_v2_dead flag_v3_dead
VAR_INT flag_v4_dead flag_v5_dead flag_v6_dead
VAR_INT flag_v7_dead flag_v8_dead flag_v9_dead
VAR_INT flag_v10_dead flag_v11_dead flag_v12_dead
VAR_INT counter_dead_varmints
//VAR_INT condition_1
VAR_INT flag_cartel_arrived flag_sneaky_1 flag_sneaky_2 //flag_camera


VAR_INT sentinel1_rm2 stallion1_rm2 perenial1_rm2
VAR_INT stallion_bailout sentinel_bailout perenial_bailout
VAR_INT flag_stallion_arrived flag_sentinel_arrived flag_perenial_arrived
VAR_INT flag_stallion_created flag_sentinel_created flag_perenial_created
VAR_INT flag_launch_perenial flag_launch_stallion
//VAR_INT flag_launch_sentinel 
VAR_INT blip_stallion1 blip_perenial1 blip_sentinel1

VAR_FLOAT varmint_gen1_x varmint_gen1_y
//VAR_FLOAT varmint_gen2_x varmint_gen2_y
//VAR_FLOAT varmint_gen3_x varmint_gen3_y

VAR_FLOAT stage_1_x stage_1_y
VAR_FLOAT stage_2_x stage_2_y
VAR_FLOAT stage_3_x stage_3_y
VAR_INT	timer_dif_rm2 timer_now_rm2 timer_start_rm2
 

//VAR_FLOAT player_rm2_x player_rm2_y player_rm2_z

VAR_INT flag_audio flag_gate
// ****************************************Mission Start************************************

mission_start_ray2:
REGISTER_MISSION_GIVEN
SCRIPT_NAME ray2 
//	PRINT_BIG ( RM2 ) 15000 2

DISPLAY_RADAR 5 // PATHING ENABLE SWITCHED OFF

// *****************************************Set Flags************************************


flag_player_on_mission = 1

flag_player_on_ray_mission = 1

flag_player_on_phil_mission = 1

rays_cutscene_flag = 1

WAIT 0

/*
IF NOT rays_camera_1 = 0
OR NOT rays_camera_2 = 0
OR NOT rays_camera_3 = 0
	RESTORE_CAMERA_JUMPCUT
	rays_camera_1 = 0
	rays_camera_2 = 0
	rays_camera_3 = 0
ENDIF
*/
//set flags

flag_m16_gone = 0
flag_uzi_gone = 0
flag_rocket_gone = 0
flag_shotgun_gone = 0
flag_molotov_gone = 0

flag_phil_in_area = 0
flag_phil_arrived = 0
flag_phil_dead = 0

flag_trucks = 0

flag_v1_dead = 0
flag_v2_dead = 0
flag_v3_dead = 0
flag_v4_dead = 0
flag_v5_dead = 0
flag_v6_dead = 0
flag_v7_dead = 0
flag_v8_dead = 0
flag_v9_dead = 0
flag_v10_dead = 0
flag_v11_dead = 0
flag_v12_dead = 0
counter_dead_varmints = 0
//condition_1 = 0

flag_cartel_arrived = 0
//flag_camera = 0

stallion_bailout = 0
sentinel_bailout = 0
perenial_bailout = 0
flag_stallion_arrived = 0
flag_sentinel_arrived = 0
flag_perenial_arrived = 0

flag_stallion_created = 0
flag_sentinel_created = 0
flag_perenial_created = 0

flag_launch_stallion = 0
//flag_launch_sentinel = 0
flag_launch_perenial = 0

flag_sneaky_1 = 0
flag_sneaky_2 = 0

flag_audio = 0
flag_gate = 0
// *******************************************Set Coord*****************************************

wh_x_rm2 = 137.15
wh_y_rm2 = 192.43
wh2_x_rm2 = 121.5
wh2_y_rm2 = 214.6

varmint_gen1_x = 174.0
varmint_gen1_y = 170.0


stage_3_x = 153.0
stage_3_y = 220.0
stage_1_x = 172.0
stage_1_y = 207.0
stage_2_x = 152.0
stage_2_y = 204.0


phils_defcon_x = 136.5
phils_defcon_y = 176.7
phils_defcon_z = 11.6
/*
phils_defcon_minx = 119.0
phils_defcon_miny = 168.0
phils_defcon_maxx = 146.0
phils_defcon_maxy = 198.0
*/
m16_x = 145.5
m16_y = 170.0
uzi_x = 143.5
uzi_y = 170.0
shotgun_x = 141.5
shotgun_y = 170.0
rocket_x = 126.98
rocket_y = 198.24
rocket_z = 14.53
molotov_x = 126.98
molotov_y = 191.73
molotov_z = 14.53


// ****************************************START OF CUTSCENE********************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_ray2_failed
ENDIF
 
SET_FADING_COLOUR 0 0 0
 
DO_FADE 250 FADE_OUT
 
PRINT_BIG RM2 15000 2 //"Arms Shortage"

SWITCH_STREAMING OFF
*/
 
LOAD_SPECIAL_CHARACTER 1 ray
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 RAYH
REQUEST_MODEL toilet 
/*
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
*/

LOAD_ALL_MODELS_NOW
 
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED toilet
 WAIT 0
ENDWHILE

//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor FALSE 
 
LOAD_CUTSCENE r2_ap

SWITCH_STREAMING ON
 
SET_CUTSCENE_OFFSET 39.424 -726.677 21.692
 
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player
 
CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_ray
SET_CUTSCENE_ANIM cs_ray ray
 
CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player
 
CREATE_CUTSCENE_HEAD cs_ray CUT_OBJ2 cs_rayhead
SET_CUTSCENE_HEAD_ANIM cs_rayhead ray
 
//CREATE_CUTSCENE_OBJECT cut_obj1 cs_ludoor
//SET_CUTSCENE_ANIM cs_ludoor LUDOOR
 
//SET_PLAYER_COORDINATES player 38.7 -725.7 22.0
 
//SET_PLAYER_HEADING player 270.0
 

CLEAR_AREA 39.0 -723.5 22.0 1.0 TRUE

SET_PLAYER_COORDINATES player 39.0 -723.5 22.0

SET_PLAYER_HEADING player 90.0

DO_FADE 250 FADE_IN

SET_NEAR_CLIP 0.2
 
START_CUTSCENE
SWITCH_STREAMING OFF
SWITCH_RUBBISH OFF
 
// Displays cutscene text
 
GET_CUTSCENE_TIME cs_time

WHILE cs_time < 6426
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM2_A1 10000 1 //"Hey kid, over here!"
 
WHILE cs_time < 8218
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW RM2_A 10000 1 //"An old army buddy of mine runs a business up in Rockford."
 
WHILE cs_time < 11093
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW RM2_B 10000 1 //"We saw action in Nicaragua, back when this country knew what it was doing."
 
WHILE cs_time < 14634
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW RM2_C 10000 1 //"Some Cartel scum roughed him up yesterday and said they'd be back for some of his stock today.

WHILE cs_time < 20938
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM2_D 10000 1 //"He could do with some back-up and in return he'll give you knock-down rates on any hardware you buy."

WHILE cs_time < 26599
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM2_D1 10000 1 //"I'd go myself but the old siatica's playing up again -cough cough- so, eerr, good luck."
 
WHILE cs_time < 38333
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
DO_FADE 1000 FADE_OUT
 
 
WHILE NOT HAS_CUTSCENE_FINISHED
 WAIT 0
ENDWHILE
 
//DO_FADE 1000 FADE_IN 
 
CLEAR_PRINTS

WHILE GET_FADING_STATUS
 WAIT 0
ENDWHILE
 
CLEAR_CUTSCENE
 
DO_FADE 0 FADE_OUT
 
SET_CAMERA_BEHIND_PLAYER
SET_NEAR_CLIP 0.9
 
WAIT 500
 
DO_FADE 1000 FADE_IN 
 
//WHILE GET_FADING_STATUS
// WAIT 0
//ENDWHILE
 
//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE
 
UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED toilet

SWITCH_STREAMING ON 
SWITCH_RUBBISH ON
rays_cutscene_flag = 0
// ******************************************END OF CUTSCENE********************************

// Mission stuff goes here

ADD_BLIP_FOR_COORD wh_x_rm2 wh_y_rm2 -100.0 blip_warehouse_rm2

//------------------REQUEST_MODELS ------------------------------

REQUEST_MODEL PED_GANG_COLOMBIAN_A
WHILE NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_A
	WAIT 0
ENDWHILE

LOAD_SPECIAL_CHARACTER 1 dealer
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
	WAIT 0
ENDWHILE

REQUEST_MODEL PED_GANG_COLOMBIAN_B 
WHILE NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_B
	WAIT 0
ENDWHILE

REQUEST_MODEL CAR_COLUMB
WHILE NOT HAS_MODEL_LOADED CAR_COLUMB
	WAIT 0
ENDWHILE
/* 
REQUEST_MODEL CAR_STALLION
WHILE NOT HAS_MODEL_LOADED CAR_STALLION
	WAIT 0
ENDWHILE
 
REQUEST_MODEL CAR_PERENNIAL
WHILE NOT HAS_MODEL_LOADED CAR_PERENNIAL
	WAIT 0
ENDWHILE
*/ 
REQUEST_MODEL CAR_BARRACKS
WHILE NOT HAS_MODEL_LOADED CAR_BARRACKS
	WAIT 0
ENDWHILE

REQUEST_MODEL CAR_RHINO
WHILE NOT HAS_MODEL_LOADED CAR_RHINO
	WAIT 0
ENDWHILE
/*
REQUEST_MODEL CAR_PATRIOT
WHILE NOT HAS_MODEL_LOADED CAR_PATRIOT
	WAIT 0
ENDWHILE
*/






//------------------WAITING FOR PLAYER TO ARRIVE---------------------------------------

WHILE NOT LOCATE_PLAYER_ANY_MEANS_2D player wh_x_rm2 wh_y_rm2 4.0 4.0 true
//AND NOT LOCATE_PLAYER_ANY_MEANS_2D player wh2_x_rm2 wh2_y_rm2 2.0 2.0 false
	WAIT 0
	
	IF IS_PLAYER_IN_ZONE player HOSPI_2
	AND flag_trucks = 0

		//--------------------CREATE PHIL'S TRUCKS---------------------------------------------

		CREATE_CAR CAR_RHINO 132.0 173.9 11.6 phil_truck_1
		SET_CAR_HEADING phil_truck_1 0.0
		CAR_SET_IDLE phil_truck_1
		SET_CAR_PROOFS phil_truck_1 TRUE FALSE FALSE FALSE FALSE
		LOCK_CAR_DOORS phil_truck_1 CARLOCK_LOCKED

		CREATE_CAR CAR_BARRACKS 133.56 208.76 11.93 phil_truck_2
		SET_CAR_HEADING phil_truck_2 180.0
		CAR_SET_IDLE phil_truck_2
		SET_CAR_PROOFS phil_truck_2 TRUE FALSE FALSE FALSE FALSE
		LOCK_CAR_DOORS phil_truck_2 CARLOCK_LOCKED
		/*
		CREATE_CAR CAR_PATRIOT 141.23 192.52 11.6 phil_truck_3
		SET_CAR_HEADING phil_truck_3 60.0 
		CAR_SET_IDLE phil_truck_3
		SET_CAR_PROOFS phil_truck_3 TRUE FALSE FALSE FALSE FALSE
		LOCK_CAR_DOORS phil_truck_3 CARLOCK_LOCKED
		*/
		flag_trucks = 1
	ENDIF
	IF flag_gate = 0
		IF gate2_sfx1 = 0
			ADD_ONE_OFF_SOUND 147.249 207.323 10.599 SOUND_GATE_START_CLUNK
			gate2_sfx1 = 1
		ENDIF

		WHILE NOT SLIDE_OBJECT phils_compnd_gate 147.249 214.823 10.599 0.0 0.1 0.0 FALSE
			WAIT 0
		ENDWHILE

		IF not_clunked_yet = 1
			gate_sfx2 = 0
			not_clunked_yet = 0
		ENDIF

		IF gate2_sfx2 = 0
			ADD_ONE_OFF_SOUND 147.249 214.823 10.599 SOUND_GATE_STOP_CLUNK
			gate2_sfx2 = 1
		ENDIF
		flag_gate = 1
	ENDIF

ENDWHILE

//--------------------PLAYER ARRIVED (CUTSCENE)------------------------------------------
//-----------------------CREATE PHIL-------------------

CLEAR_AREA phils_defcon_x phils_defcon_y 11.5 20.0 true
CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 phils_defcon_x phils_defcon_y phils_defcon_z phil
SET_CHAR_HEADING phil 360.0
GIVE_WEAPON_TO_CHAR phil WEAPONTYPE_M16 200
ADD_ARMOUR_TO_CHAR phil 100
SET_CHAR_PERSONALITY phil PEDSTAT_TOUGH_GUY
CLEAR_CHAR_THREAT_SEARCH phil
SET_CHAR_THREAT_SEARCH phil THREAT_GANG_COLOMBIAN
SET_CHAR_STAY_IN_SAME_PLACE phil true
//CHAR_SET_IDLE phil


//-----------------------CREATE PHIL'S 'SUPPLIES'-------------------------------------

CREATE_PICKUP_WITH_AMMO WEAPON_M16 PICKUP_ONCE 60 m16_x m16_y 11.5 phils_m16
CREATE_PICKUP WEAPON_UZI PICKUP_ONCE uzi_x uzi_y 11.5 phils_uzi
CREATE_PICKUP WEAPON_SHOTGUN PICKUP_ONCE shotgun_x shotgun_y 11.5 phils_shotgun
CREATE_PICKUP WEAPON_ROCKET PICKUP_ONCE rocket_x rocket_y rocket_z phils_rocket
CREATE_PICKUP WEAPON_MOLOTOV PICKUP_ONCE molotov_x molotov_y molotov_z phils_molotov
CREATE_PICKUP bodyarmour PICKUP_ON_STREET_SLOW 121.16 194.92 11.53 phils_armour


REMOVE_BLIP blip_warehouse_rm2

SET_PLAYER_CONTROL player off
GET_PLAYER_CHAR player player_rm2
SET_FIXED_CAMERA_POSITION 141.5 184.5 12.5 0.0 0.0 0.0
SWITCH_WIDESCREEN on

IF IS_PLAYER_IN_ANY_CAR player
	STORE_CAR_PLAYER_IS_IN player player_car_rm2
	APPLY_BRAKES_TO_PLAYERS_CAR player on
	CAR_SET_IDLE player_car_rm2
	POINT_CAMERA_AT_CAR player_car_rm2 FIXED JUMP_CUT
	SET_CHAR_OBJ_LEAVE_CAR player_rm2 player_car_rm2
	WHILE IS_CHAR_IN_CAR player_rm2 player_car_rm2
		WAIT 0
		IF IS_CAR_DEAD player_car_rm2
			GOTO bibble
		ENDIF
	ENDWHILE
ENDIF

POINT_CAMERA_AT_CHAR player_rm2 FIXED JUMP_CUT

bibble:


WAIT 0

phils_defcon_y = phils_defcon_y + 3.0
SET_CHAR_OBJ_RUN_TO_COORD player_rm2 phils_defcon_x phils_defcon_y


WHILE NOT LOCATE_PLAYER_ANY_MEANS_2D player phils_defcon_x phils_defcon_y 2.0 2.0 false
	WAIT 0
ENDWHILE
//SET_CHAR_OBJ_NO_OBJ player_rm2


LOAD_MISSION_AUDIO R2_A
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO peedle
	ENDIF
ENDWHILE
SET_MISSION_AUDIO_POSITION phils_defcon_x phils_defcon_y phils_defcon_z
PLAY_MISSION_AUDIO
PRINT_NOW (RM2_E) 4000 1 //"Ray phoned ahead....but I thought there'd be more of you.
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO peedle
	ENDIF
ENDWHILE


LOAD_MISSION_AUDIO R2_B
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO peedle
	ENDIF
ENDWHILE
SET_MISSION_AUDIO_POSITION phils_defcon_x phils_defcon_y phils_defcon_z
PLAY_MISSION_AUDIO
PRINT_NOW (RM2_E1) 4000 1 //"I can't believe the yellow bastard's left me without proper cover again!"
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO peedle
	ENDIF
ENDWHILE


LOAD_MISSION_AUDIO R2_C
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO peedle
	ENDIF
ENDWHILE
SET_MISSION_AUDIO_POSITION phils_defcon_x phils_defcon_y phils_defcon_z
PLAY_MISSION_AUDIO
PRINT_NOW (RM2_F) 4000 1 //"Well three arms are better than one, so grab whatever you need."
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO peedle
	ENDIF
ENDWHILE


LOAD_MISSION_AUDIO R2_D
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO peedle
	ENDIF
ENDWHILE
SET_MISSION_AUDIO_POSITION phils_defcon_x phils_defcon_y phils_defcon_z
PLAY_MISSION_AUDIO
PRINT_NOW (RM2_F1) 4000 1 //"Those Colombians will be here any minute."
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO peedle
	ENDIF
ENDWHILE

peedle:
CLEAR_MISSION_AUDIO

CLEAR_PRINTS
SET_PLAYER_CONTROL player on
RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN off

GET_GAME_TIMER timer_start_rm2
GET_GAME_TIMER timer_now_rm2
timer_dif_rm2 = timer_now_rm2 - timer_start_rm2

//-------GIVE PLAYER TIME TO GET PICKUPS WITHOUT LEAVING COMPOUND-------
CLEAR_AREA varmint_gen1_x varmint_gen1_y 11.5 20.0 true
CLEAR_AREA stage_3_x stage_3_y 11.5 20.0 true
CLEAR_AREA stage_1_x stage_1_y 11.5 20.0 true
CLEAR_AREA stage_2_x stage_2_y 11.5 20.0 true

/*IF NOT IS_CAR_DEAD phil_truck_3
	LOCK_CAR_DOORS phil_truck_3 CARLOCK_UNLOCKED
ENDIF*/
IF NOT IS_CAR_DEAD phil_truck_2
	LOCK_CAR_DOORS phil_truck_2 CARLOCK_UNLOCKED
ENDIF

WHILE timer_dif_rm2 < 25000
AND IS_PLAYER_IN_AREA_2D player 119.0 167.0 147.0 246.0 false
	WAIT 0
	GOSUB pickups
	IF IS_PLAYER_IN_AREA_2D player 147.0 198.0 156.0 208.0 false
		GOTO herring
	ENDIF
	IF IS_PLAYER_IN_ANY_CAR player
		GOTO herring
	ENDIF

	GET_GAME_TIMER timer_now_rm2
	timer_dif_rm2 = timer_now_rm2 - timer_start_rm2
	IF IS_CHAR_DEAD phil
		flag_phil_dead = 1
		GOTO mission_ray2_failed
	ENDIF

ENDWHILE

herring:
//----LOAD PHIL'S SOUND BITE-----------------------------------------

LOAD_MISSION_AUDIO R2_E
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE

//-----------------MAIN LOOP-----------------------------------------

GET_GAME_TIMER timer_start_rm2

WHILE counter_dead_varmints < 12
	
	WAIT 0
	
	GET_GAME_TIMER timer_now_rm2
	timer_dif_rm2 = timer_now_rm2 - timer_start_rm2

	GOSUB pickups


	//--------sentinel gen stuff--------------------------------------------
	
	IF timer_dif_rm2 > 2000
	AND flag_sentinel_created = 0
		CREATE_CAR CAR_COLUMB varmint_gen1_x varmint_gen1_y -100.0 sentinel1_rm2
		SET_CAR_ONLY_DAMAGED_BY_PLAYER sentinel1_rm2 TRUE
		LOCK_CAR_DOORS sentinel1_rm2 CARLOCK_LOCKED
		ADD_BLIP_FOR_CAR sentinel1_rm2 blip_sentinel1
		CREATE_CHAR_INSIDE_CAR sentinel1_rm2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B varmint_1
		CREATE_CHAR_AS_PASSENGER sentinel1_rm2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 0 varmint_2
		CREATE_CHAR_AS_PASSENGER sentinel1_rm2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 1 varmint_3
		CREATE_CHAR_AS_PASSENGER sentinel1_rm2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 2 varmint_4
		SET_CAR_CRUISE_SPEED sentinel1_rm2 10.0
		SET_CAR_DRIVING_STYLE sentinel1_rm2 3
		CAR_GOTO_COORDINATES_ACCURATE sentinel1_rm2 stage_1_x stage_1_y 11.6
		flag_sentinel_created = 1
	ENDIF

	IF flag_launch_stallion = 0
	AND flag_sentinel_created = 1
		IF NOT IS_CAR_DEAD sentinel1_rm2
			IF LOCATE_CAR_2D sentinel1_rm2 stage_1_x stage_1_y 4.0 4.0 false
				CAR_GOTO_COORDINATES_ACCURATE sentinel1_rm2 stage_2_x stage_2_y 11.6
				flag_launch_stallion = 1
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_launch_stallion = 1
	AND flag_sentinel_created = 1
		IF NOT IS_CAR_DEAD sentinel1_rm2
			IF LOCATE_CAR_2D sentinel1_rm2 stage_2_x stage_2_y 4.0 4.0 false
				flag_launch_stallion = 2
				flag_sentinel_arrived = 1
				SET_CAR_ONLY_DAMAGED_BY_PLAYER sentinel1_rm2 FALSE
				LOCK_CAR_DOORS sentinel1_rm2 CARLOCK_UNLOCKED
				IF flag_cartel_arrived < 2
					flag_cartel_arrived = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_sentinel_created = 1
		IF IS_CAR_DEAD sentinel1_rm2
			flag_launch_stallion = 1
			REMOVE_BLIP blip_sentinel1
		ELSE
			IF NOT IS_CAR_HEALTH_GREATER sentinel1_rm2 950
				flag_sentinel_arrived = 1
				IF flag_launch_stallion = 0
					flag_launch_stallion = 1
				ENDIF
				IF flag_cartel_arrived = 0
					flag_cartel_arrived = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	//-----stallion gen stuff------------------------------------------------
	
	IF timer_dif_rm2 > 4000
	AND flag_stallion_created = 0
	AND flag_launch_stallion > 0
		CREATE_CAR CAR_COLUMB varmint_gen1_x varmint_gen1_y -100.0 stallion1_rm2
		SET_CAR_ONLY_DAMAGED_BY_PLAYER stallion1_rm2 TRUE
		LOCK_CAR_DOORS stallion1_rm2 CARLOCK_LOCKED
		ADD_BLIP_FOR_CAR stallion1_rm2 blip_stallion1
		CREATE_CHAR_INSIDE_CAR stallion1_rm2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A varmint_5
		CREATE_CHAR_AS_PASSENGER stallion1_rm2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 0 varmint_6
		SET_CAR_CRUISE_SPEED stallion1_rm2 10.0
		SET_CAR_DRIVING_STYLE  stallion1_rm2 3
		CAR_GOTO_COORDINATES_ACCURATE stallion1_rm2 stage_1_x stage_1_y 11.6
		flag_stallion_created = 1
	ENDIF

	IF flag_launch_perenial = 0
	AND flag_stallion_created = 1
		IF NOT IS_CAR_DEAD stallion1_rm2
			IF LOCATE_CAR_2D stallion1_rm2 stage_1_x stage_1_y 4.0 4.0 false
				CAR_GOTO_COORDINATES_ACCURATE stallion1_rm2 stage_3_x stage_3_y 11.6
				flag_launch_perenial = 1
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_launch_perenial = 1
	AND flag_stallion_created = 1
		IF NOT IS_CAR_DEAD stallion1_rm2
			IF LOCATE_CAR_2D stallion1_rm2 stage_3_x stage_3_y 4.0 4.0 false
				flag_launch_perenial = 2
				flag_stallion_arrived = 1
				SET_CAR_ONLY_DAMAGED_BY_PLAYER stallion1_rm2 FALSE
				LOCK_CAR_DOORS stallion1_rm2 CARLOCK_UNLOCKED
				IF flag_cartel_arrived < 2
					flag_cartel_arrived = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF flag_stallion_created = 1
		IF IS_CAR_DEAD stallion1_rm2
			flag_launch_perenial = 1
			REMOVE_BLIP blip_stallion1
		ELSE
			IF NOT IS_CAR_HEALTH_GREATER stallion1_rm2 950
				flag_stallion_arrived = 1
				IF flag_cartel_arrived = 0
					flag_cartel_arrived = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
	//-----perenial gen stuff-----------------------------------------------
	
	IF timer_dif_rm2 > 6000
	AND flag_perenial_created = 0
	AND flag_launch_perenial > 0
		CREATE_CAR CAR_COLUMB varmint_gen1_x varmint_gen1_y -100.0 perenial1_rm2
		SET_CAR_ONLY_DAMAGED_BY_PLAYER perenial1_rm2 TRUE
		LOCK_CAR_DOORS perenial1_rm2 CARLOCK_LOCKED
		ADD_BLIP_FOR_CAR perenial1_rm2 blip_perenial1
		CREATE_CHAR_INSIDE_CAR perenial1_rm2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B varmint_7
		CREATE_CHAR_AS_PASSENGER perenial1_rm2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 0 varmint_8
		CREATE_CHAR_AS_PASSENGER perenial1_rm2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 1 varmint_9
		CREATE_CHAR_AS_PASSENGER perenial1_rm2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 2 varmint_10
		SET_CAR_CRUISE_SPEED perenial1_rm2 10.0
		SET_CAR_DRIVING_STYLE  perenial1_rm2 3
		CAR_GOTO_COORDINATES_ACCURATE perenial1_rm2 stage_1_x stage_1_y 11.6
		flag_perenial_created = 1
	ENDIF

	
	IF flag_perenial_created = 1
		IF NOT IS_CAR_DEAD perenial1_rm2
			IF LOCATE_CAR_2D perenial1_rm2 stage_1_x stage_1_y 4.0 4.0 false
				flag_perenial_arrived = 1
				SET_CAR_ONLY_DAMAGED_BY_PLAYER perenial1_rm2 FALSE
				LOCK_CAR_DOORS perenial1_rm2 CARLOCK_UNLOCKED
				IF flag_cartel_arrived < 2
					flag_cartel_arrived = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF flag_perenial_created = 1	
		IF IS_CAR_DEAD perenial1_rm2
			REMOVE_BLIP blip_perenial1
		ELSE
			IF NOT IS_CAR_HEALTH_GREATER perenial1_rm2 950
				flag_perenial_arrived = 1
				IF flag_cartel_arrived = 0
					flag_cartel_arrived = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	//----------------Sneaky backstab----------------------------------------

	IF flag_cartel_arrived > 0
	AND timer_dif_rm2 > 12000
		IF flag_sneaky_1 = 0
			IF NOT IS_POINT_ON_SCREEN 121.3 217.7 11.5 2.5
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 121.3 235.7 11.5 varmint_11
				GIVE_WEAPON_TO_CHAR varmint_11 WEAPONTYPE_CHAINGUN 80
				ADD_ARMOUR_TO_CHAR varmint_11 100
				ADD_BLIP_FOR_CHAR_OLD varmint_11 1 BLIP_ONLY blip_v11
				//SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT varmint_11 player
				SET_CHAR_OBJ_RUN_TO_COORD varmint_11 phils_defcon_x phils_defcon_y
				SET_CHAR_THREAT_SEARCH varmint_11 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH varmint_11 THREAT_SPECIAL
				SET_CHAR_HEED_THREATS varmint_11 true
				flag_sneaky_1 = 1
			ENDIF
		ENDIF
		IF flag_sneaky_2 = 0
			IF NOT IS_POINT_ON_SCREEN 121.3 241.6 11.5 2.5
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 121.3 241.6 11.5 varmint_12
				GIVE_WEAPON_TO_CHAR varmint_12 WEAPONTYPE_SHOTGUN 20
				ADD_ARMOUR_TO_CHAR varmint_12 100
				ADD_BLIP_FOR_CHAR_OLD varmint_12 1 BLIP_ONLY blip_v12
				SET_CHAR_OBJ_RUN_TO_COORD varmint_12 124.15 184.7
				SET_CHAR_THREAT_SEARCH varmint_12 THREAT_PLAYER1
				SET_CHAR_THREAT_SEARCH varmint_12 THREAT_SPECIAL
				SET_CHAR_HEED_THREATS varmint_12 true
				/*IF NOT IS_CHAR_DEAD phil
					SET_CHAR_OBJ_KILL_CHAR_ON_FOOT varmint_12 phil
				ENDIF*/
				flag_sneaky_2 = 1
			ENDIF
		ENDIF
	ENDIF
	
	IF IS_CHAR_DEAD phil
		flag_phil_dead = 1
		GOTO mission_ray2_failed
	ENDIF

	IF flag_cartel_arrived = 1
		SET_MISSION_AUDIO_POSITION phils_defcon_x phils_defcon_y phils_defcon_z
		PLAY_MISSION_AUDIO		
		PRINT_NOW (RM2_K) 4000 1 //"SHIT They're here! LOCK'N'LOAD!!"
		flag_cartel_arrived = 2
		/*WHILE NOT SLIDE_OBJECT phils_compnd_gate 147.249 214.323 10.599 0.0 0.1 0.0 FALSE
			WAIT 0
		ENDWHILE*/
	ENDIF

	GOSUB varmint_deaths

	GOSUB big_bailout_routine

ENDWHILE

//-------All Cartel Varmints dead-----------------------------------------------
IF NOT IS_CHAR_DEAD phil
	SET_CHAR_HEALTH phil 5
ENDIF

IF NOT IS_CHAR_DEAD phil
	SET_CHAR_STAY_IN_SAME_PLACE phil true
	GET_CHAR_COORDINATES phil phils_defcon_x phils_defcon_y phils_defcon_z
	IF NOT LOCATE_PLAYER_ANY_MEANS_2D player phils_defcon_x phils_defcon_y 2.0 2.0 false
		PRINT_NOW (RM2_G) 2500 1 //"Go check on Phil!"
		ADD_BLIP_FOR_CHAR phil blip_phil
		WHILE NOT LOCATE_PLAYER_ANY_MEANS_2D player phils_defcon_x phils_defcon_y 2.0 2.0 false
			WAIT 0
			IF IS_CHAR_DEAD phil
				flag_phil_dead = 1
				REMOVE_BLIP blip_phil
				GOTO mission_ray2_failed
			ENDIF
		ENDWHILE
	ENDIF
ENDIF

IF IS_CHAR_DEAD phil
	flag_phil_dead = 1
	REMOVE_BLIP blip_phil
	GOTO mission_ray2_failed
ELSE
	SET_CHAR_HEALTH phil 100
ENDIF

REMOVE_BLIP blip_phil

SET_PLAYER_CONTROL player off
SWITCH_WIDESCREEN on
SET_FIXED_CAMERA_POSITION 134.6 184.7 11.16 0.0 0.0 0.0

IF IS_PLAYER_IN_ANY_CAR player
	STORE_CAR_PLAYER_IS_IN player player_car_rm2
	APPLY_BRAKES_TO_PLAYERS_CAR player on
	CAR_SET_IDLE player_car_rm2
	POINT_CAMERA_AT_CAR player_car_rm2 FIXED JUMP_CUT
	SET_CHAR_OBJ_LEAVE_CAR player_rm2 player_car_rm2
	WHILE IS_CHAR_IN_CAR player_rm2 player_car_rm2
		WAIT 0
		IF IS_CAR_DEAD player_car_rm2
			GOTO boobble
		ENDIF
		IF IS_CHAR_DEAD phil
			flag_phil_dead = 1
			REMOVE_BLIP blip_phil
			GOTO mission_ray2_failed
		ENDIF
	ENDWHILE
ENDIF

boobble:

//GET_PLAYER_COORDINATES player player_rm2_x player_rm2_y player_rm2_z
GET_PLAYER_CHAR player player_rm2

IF NOT IS_CHAR_DEAD phil
	TURN_CHAR_TO_FACE_CHAR phil player_rm2 
	POINT_CAMERA_AT_CHAR phil FIXED JUMP_CUT
ENDIF

//TURN_CHAR_TO_FACE_CHAR player_rm2 phil
//TURN_CHAR_TO_FACE_CHAR phil player_rm2
//CHAR_LOOK_AT_CHAR_ALWAYS player_rm2 phil

LOAD_MISSION_AUDIO R2_F
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE
SET_MISSION_AUDIO_POSITION phils_defcon_x phils_defcon_y phils_defcon_z
PLAY_MISSION_AUDIO
PRINT_NOW (RM2_L) 4000 1// Heh-hey! If I'd teamed up with you in Nicaragua maybe I'd still have my arm!
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
ENDWHILE

IF flag_m16_gone = 0
	REMOVE_PICKUP phils_m16
ENDIF
IF flag_shotgun_gone = 0
	REMOVE_PICKUP phils_shotgun
ENDIF
IF flag_uzi_gone = 0
	REMOVE_PICKUP phils_uzi
ENDIF
IF flag_molotov_gone = 0
	REMOVE_PICKUP phils_molotov
ENDIF
IF flag_rocket_gone = 0
	REMOVE_PICKUP phils_rocket
ENDIF

IF flag_ray_mission2_passed = 0
	REMOVE_PICKUP phils_armour
ENDIF

m16_x = 145.5
m16_y = 170.0
uzi_x = 143.5
uzi_y = 170.0
shotgun_x = 141.5
shotgun_y = 170.0
CREATE_PICKUP WEAPON_M16 PICKUP_IN_SHOP m16_x m16_y 11.5 phils_m16
CREATE_PICKUP WEAPON_SHOTGUN PICKUP_IN_SHOP uzi_x uzi_y 11.5 phils_uzi
CREATE_PICKUP WEAPON_ROCKET PICKUP_IN_SHOP shotgun_x shotgun_y 11.5 phils_shotgun
flag_m16_gone = 1
flag_uzi_gone = 1
flag_shotgun_gone = 1

LOAD_MISSION_AUDIO R2_G
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE
SET_MISSION_AUDIO_POSITION phils_defcon_x phils_defcon_y phils_defcon_z
PLAY_MISSION_AUDIO
PRINT_NOW (RM2_M) 5000 1// If you need any firepower just drop by and take what you need from the lockers, leave the cash under the bench
SET_FIXED_CAMERA_POSITION 143.5 179.0 11.5 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 144.0 170.7 11.5 JUMP_CUT
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
ENDWHILE



LOAD_MISSION_AUDIO R2_H
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE
SET_MISSION_AUDIO_POSITION phils_defcon_x phils_defcon_y phils_defcon_z
PLAY_MISSION_AUDIO
PRINT_NOW (RM2_N) 3000 1// Now get out of here, I'll handle the cops
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
ENDWHILE

POINT_CAMERA_AT_PLAYER player FIXED INTERPOLATION
WAIT 2000

//ALTER_WANTED_LEVEL_NO_DROP player 3

IF NOT IS_CHAR_DEAD phil
	SET_CHAR_OBJ_NO_OBJ phil 
	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT phil 144.0 174.4
ENDIF

WHILE flag_phil_arrived = 0
	WAIT 0
	IF NOT IS_CHAR_DEAD phil
		IF LOCATE_CHAR_ON_FOOT_2D phil 144.0 174.4 1.0 1.0 false
		 flag_phil_arrived = 1
		ENDIF
	ELSE
		GOTO mission_ray2_failed
	ENDIF
ENDWHILE

DELETE_CHAR phil
SWITCH_WIDESCREEN off
RESTORE_CAMERA_JUMPCUT 
SET_PLAYER_CONTROL player on

GOTO mission_ray2_passed
	   		



// Mission Ray2 failed

mission_ray2_failed:

IF flag_phil_dead = 1
	PRINT_NOW (RM2_H) 3000 1 //Phil has been killed!!
ENDIF

PRINT_BIG ( M_FAIL ) 2000 1

RETURN

   

// mission Ray2 passed

mission_ray2_passed:

IF flag_m16_gone = 0
	REMOVE_PICKUP phils_m16
	flag_m16_gone = 1
ENDIF
IF flag_shotgun_gone = 0
	REMOVE_PICKUP phils_shotgun
	flag_shotgun_gone = 1
ENDIF
IF flag_uzi_gone = 0
	REMOVE_PICKUP phils_uzi
	flag_uzi_gone = 1
ENDIF
IF flag_molotov_gone = 0
	REMOVE_PICKUP phils_molotov
	flag_molotov_gone = 1
ENDIF
IF flag_rocket_gone = 0
	REMOVE_PICKUP phils_rocket
	flag_rocket_gone = 1
ENDIF


flag_ray_mission2_passed = 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
CLEAR_WANTED_LEVEL player
ADD_SCORE player 10000
REGISTER_MISSION_PASSED RM2
PLAYER_MADE_PROGRESS 1 
START_NEW_SCRIPT ray_mission3_loop
RETURN
		


// mission cleanup

mission_cleanup_ray2:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_ray_mission = 0
flag_player_on_phil_mission = 0

SET_PLAYER_CONTROL player on
SWITCH_WIDESCREEN off
RESTORE_CAMERA_JUMPCUT 


MARK_MODEL_AS_NO_LONGER_NEEDED PED_SPECIAL1 
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_RHINO 
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_PATRIOT 

MARK_MODEL_AS_NO_LONGER_NEEDED CAR_BARRACKS 
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SENTINEL 
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STALLION
//MARK_MODEL_AS_NO_LONGER_NEEDED CAR_PERENNIAL 
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A 
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_B

UNLOAD_SPECIAL_CHARACTER 1

REMOVE_BLIP blip_warehouse_rm2
REMOVE_BLIP blip_sentinel1
REMOVE_BLIP blip_stallion1
REMOVE_BLIP blip_perenial1

GOSUB blip_removal_rm2

IF flag_m16_gone = 0
	REMOVE_PICKUP phils_m16
ENDIF
IF flag_shotgun_gone = 0
	REMOVE_PICKUP phils_shotgun
ENDIF
IF flag_uzi_gone = 0
	REMOVE_PICKUP phils_uzi
ENDIF
IF flag_molotov_gone = 0
	REMOVE_PICKUP phils_molotov
ENDIF
IF flag_rocket_gone = 0
	REMOVE_PICKUP phils_rocket
ENDIF

IF flag_ray_mission2_passed = 0
	REMOVE_PICKUP phils_armour
ENDIF

MISSION_HAS_FINISHED
RETURN
		

//---------------------------GOSUBS----------------GOSUBS---------------------------actuallydon'tchaknow


//-------------------------------BAILOUT----------------------------------------------

big_bailout_routine:

	IF stallion_bailout = 0
	AND flag_stallion_arrived = 1
				
		IF NOT IS_CHAR_DEAD varmint_5
			IF NOT IS_CAR_DEAD	stallion1_rm2
				SET_CHAR_OBJ_LEAVE_CAR varmint_5 stallion1_rm2
				WHILE IS_CHAR_IN_CAR varmint_5 stallion1_rm2
					WAIT 0
					IF IS_CAR_DEAD stallion1_rm2
						GOTO plook2
					ENDIF
					IF IS_CHAR_DEAD varmint_5
						GOTO plook1
					ENDIF
				ENDWHILE
				IF NOT IS_CHAR_DEAD varmint_5
					ADD_BLIP_FOR_CHAR_OLD varmint_5 1 BLIP_ONLY blip_v5
					ADD_ARMOUR_TO_CHAR varmint_5 100
					GIVE_WEAPON_TO_CHAR varmint_5 WEAPONTYPE_UZI 60
					SET_CHAR_OBJ_RUN_TO_COORD varmint_5 wh_x_rm2 wh_y_rm2
					SET_CHAR_THREAT_SEARCH varmint_5 THREAT_PLAYER1
					SET_CHAR_THREAT_SEARCH varmint_5 THREAT_SPECIAL
					SET_CHAR_HEED_THREATS varmint_5 true
					//SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT varmint_5 player
				ENDIF
			ENDIF
		ENDIF

		plook1:

		IF NOT IS_CHAR_DEAD varmint_6
			IF NOT IS_CAR_DEAD	stallion1_rm2
				SET_CHAR_OBJ_LEAVE_CAR varmint_6 stallion1_rm2
				WHILE IS_CHAR_IN_CAR varmint_6 stallion1_rm2
					WAIT 0
					IF IS_CAR_DEAD stallion1_rm2
						GOTO plook2
					ENDIF
					IF IS_CHAR_DEAD varmint_6
						GOTO plook2
					ENDIF
				ENDWHILE
				IF NOT IS_CHAR_DEAD varmint_6
				//AND NOT IS_CHAR_DEAD phil
					ADD_BLIP_FOR_CHAR_OLD varmint_6 1 BLIP_ONLY blip_v6
					GIVE_WEAPON_TO_CHAR varmint_6 WEAPONTYPE_UZI 60
					SET_CHAR_OBJ_RUN_TO_COORD varmint_6 wh_x_rm2 wh_y_rm2
					SET_CHAR_THREAT_SEARCH varmint_6 THREAT_PLAYER1
					SET_CHAR_THREAT_SEARCH varmint_6 THREAT_SPECIAL
					SET_CHAR_HEED_THREATS varmint_6 true
					//SET_CHAR_OBJ_KILL_CHAR_ON_FOOT varmint_6 phil
				ENDIF
			ENDIF
		ENDIF

		plook2:
		REMOVE_BLIP blip_stallion1
		stallion_bailout = 1
	
	ENDIF


	IF sentinel_bailout = 0
	AND flag_sentinel_arrived = 1
		
		IF NOT IS_CHAR_DEAD varmint_1
			IF NOT IS_CAR_DEAD	sentinel1_rm2
				SET_CHAR_OBJ_LEAVE_CAR varmint_1 sentinel1_rm2
				WHILE IS_CHAR_IN_CAR varmint_1 sentinel1_rm2
					WAIT 0
					IF IS_CAR_DEAD sentinel1_rm2
						GOTO plook6
					ENDIF
					IF IS_CHAR_DEAD varmint_1
						GOTO plook3
					ENDIF
				ENDWHILE
				IF NOT IS_CHAR_DEAD varmint_1
					ADD_BLIP_FOR_CHAR_OLD varmint_1 1 BLIP_ONLY blip_v1
					GIVE_WEAPON_TO_CHAR varmint_1 WEAPONTYPE_SHOTGUN 20
					SET_CHAR_OBJ_RUN_TO_COORD varmint_1 wh_x_rm2 wh_y_rm2
					SET_CHAR_THREAT_SEARCH varmint_1 THREAT_PLAYER1
					SET_CHAR_THREAT_SEARCH varmint_1 THREAT_SPECIAL
					SET_CHAR_HEED_THREATS varmint_1 true
					//SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT varmint_1 player
				ENDIF
			ENDIF
		ENDIF

		plook3:
		IF NOT IS_CHAR_DEAD varmint_2
			IF NOT IS_CAR_DEAD	sentinel1_rm2
				SET_CHAR_OBJ_LEAVE_CAR varmint_2 sentinel1_rm2
				WHILE IS_CHAR_IN_CAR varmint_2 sentinel1_rm2
					WAIT 0
					IF IS_CAR_DEAD sentinel1_rm2
						GOTO plook6
					ENDIF
					IF IS_CHAR_DEAD varmint_2
						GOTO plook4
					ENDIF
				ENDWHILE
				IF NOT IS_CHAR_DEAD varmint_2
				//AND NOT IS_CHAR_DEAD phil
					ADD_BLIP_FOR_CHAR_OLD varmint_2 1 BLIP_ONLY blip_v2
					GIVE_WEAPON_TO_CHAR varmint_2 WEAPONTYPE_SHOTGUN 20
					SET_CHAR_OBJ_RUN_TO_COORD varmint_2 wh_x_rm2 wh_y_rm2
					SET_CHAR_THREAT_SEARCH varmint_2 THREAT_PLAYER1
					SET_CHAR_THREAT_SEARCH varmint_2 THREAT_SPECIAL
					SET_CHAR_HEED_THREATS varmint_2 true
					//SET_CHAR_OBJ_KILL_CHAR_ON_FOOT varmint_2 phil
				ENDIF
			ENDIF
		ENDIF

		plook4:
		IF NOT IS_CHAR_DEAD varmint_3
			IF NOT IS_CAR_DEAD	sentinel1_rm2
				SET_CHAR_OBJ_LEAVE_CAR varmint_3 sentinel1_rm2
				WHILE IS_CHAR_IN_CAR varmint_3 sentinel1_rm2
					WAIT 0
					IF IS_CAR_DEAD sentinel1_rm2
						GOTO plook6
					ENDIF
					IF IS_CHAR_DEAD varmint_3
						GOTO plook5
					ENDIF
				ENDWHILE
				IF NOT IS_CHAR_DEAD varmint_3
				//AND NOT IS_CHAR_DEAD phil
					ADD_BLIP_FOR_CHAR_OLD varmint_3 1 BLIP_ONLY blip_v3
					GIVE_WEAPON_TO_CHAR varmint_3 WEAPONTYPE_CHAINGUN 80
					SET_CHAR_OBJ_RUN_TO_COORD varmint_3 140.0 209.5
					SET_CHAR_THREAT_SEARCH varmint_3 THREAT_PLAYER1
					SET_CHAR_THREAT_SEARCH varmint_3 THREAT_SPECIAL
					SET_CHAR_HEED_THREATS varmint_3 true
					//SET_CHAR_OBJ_KILL_CHAR_ON_FOOT varmint_3 phil
				ENDIF
			ENDIF
		ENDIF

		plook5:
		IF NOT IS_CHAR_DEAD varmint_4
			IF NOT IS_CAR_DEAD	sentinel1_rm2
				SET_CHAR_OBJ_LEAVE_CAR varmint_4 sentinel1_rm2
				WHILE IS_CHAR_IN_CAR varmint_4 sentinel1_rm2
					WAIT 0
					IF IS_CAR_DEAD sentinel1_rm2
						GOTO plook6
					ENDIF
					IF IS_CHAR_DEAD varmint_4
						GOTO plook6
					ENDIF
				ENDWHILE
				IF NOT IS_CHAR_DEAD varmint_4
					ADD_BLIP_FOR_CHAR_OLD varmint_4 1 BLIP_ONLY blip_v4
					ADD_ARMOUR_TO_CHAR varmint_4 100
					GIVE_WEAPON_TO_CHAR varmint_4 WEAPONTYPE_MOLOTOV 5
					SET_CHAR_OBJ_RUN_TO_COORD varmint_4 wh_x_rm2 wh_y_rm2
					SET_CHAR_THREAT_SEARCH varmint_4 THREAT_PLAYER1
					SET_CHAR_THREAT_SEARCH varmint_4 THREAT_SPECIAL
					SET_CHAR_HEED_THREATS varmint_4 true
					//SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT varmint_4 player
				ENDIF
			ENDIF
		ENDIF

		plook6:
		REMOVE_BLIP blip_sentinel1 
		sentinel_bailout = 1
	ENDIF

	IF perenial_bailout = 0
	AND flag_perenial_arrived = 1
		
		IF NOT IS_CHAR_DEAD varmint_7
			IF NOT IS_CAR_DEAD perenial1_rm2
				SET_CHAR_OBJ_LEAVE_CAR varmint_7 perenial1_rm2
				WHILE IS_CHAR_IN_CAR varmint_7 perenial1_rm2
					WAIT 0
					IF IS_CAR_DEAD perenial1_rm2
						GOTO plook10
					ENDIF
					IF IS_CHAR_DEAD varmint_7
						GOTO plook7
					ENDIF
				ENDWHILE
				IF NOT IS_CHAR_DEAD varmint_7
					ADD_BLIP_FOR_CHAR_OLD varmint_7 1 BLIP_ONLY blip_v7
					GIVE_WEAPON_TO_CHAR varmint_7 WEAPONTYPE_SHOTGUN 10
					SET_CHAR_OBJ_RUN_TO_COORD varmint_7 wh_x_rm2 wh_y_rm2
					SET_CHAR_THREAT_SEARCH varmint_7 THREAT_PLAYER1
					SET_CHAR_THREAT_SEARCH varmint_7 THREAT_SPECIAL
					SET_CHAR_HEED_THREATS varmint_7 true
					//SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT varmint_7 player
				ENDIF
			ENDIF
		ENDIF

		plook7:
		IF NOT IS_CHAR_DEAD varmint_8
			IF NOT IS_CAR_DEAD perenial1_rm2
				SET_CHAR_OBJ_LEAVE_CAR varmint_8 perenial1_rm2
				WHILE IS_CHAR_IN_CAR varmint_8 perenial1_rm2
					WAIT 0
					IF IS_CAR_DEAD perenial1_rm2
						GOTO plook10
					ENDIF
					IF IS_CHAR_DEAD varmint_8
						GOTO plook8
					ENDIF
				ENDWHILE
				IF NOT IS_CHAR_DEAD varmint_8
				//AND NOT IS_CHAR_DEAD phil
					ADD_BLIP_FOR_CHAR_OLD varmint_8 1 BLIP_ONLY blip_v8
					GIVE_WEAPON_TO_CHAR varmint_8 WEAPONTYPE_CHAINGUN 45
					SET_CHAR_OBJ_RUN_TO_COORD varmint_8 129.7 199.8
					SET_CHAR_THREAT_SEARCH varmint_8 THREAT_PLAYER1
					SET_CHAR_THREAT_SEARCH varmint_8 THREAT_SPECIAL
					SET_CHAR_HEED_THREATS varmint_8 true
					//SET_CHAR_OBJ_KILL_CHAR_ON_FOOT varmint_8 phil
				ENDIF
			ENDIF
		ENDIF
					
		plook8:
		IF NOT IS_CHAR_DEAD varmint_9
			IF NOT IS_CAR_DEAD perenial1_rm2
				SET_CHAR_OBJ_LEAVE_CAR varmint_9 perenial1_rm2
				WHILE IS_CHAR_IN_CAR varmint_9 perenial1_rm2
					WAIT 0
					IF IS_CAR_DEAD perenial1_rm2
						GOTO plook10
					ENDIF
					IF IS_CHAR_DEAD varmint_9
						GOTO plook9
					ENDIF
				ENDWHILE
				IF NOT IS_CHAR_DEAD varmint_9
				//AND NOT IS_CHAR_DEAD phil
					ADD_BLIP_FOR_CHAR_OLD varmint_9 1 BLIP_ONLY blip_v9
					GIVE_WEAPON_TO_CHAR varmint_9 WEAPONTYPE_PISTOL 30
					SET_CHAR_OBJ_RUN_TO_COORD varmint_9 wh_x_rm2 wh_y_rm2
					SET_CHAR_THREAT_SEARCH varmint_9 THREAT_PLAYER1
					SET_CHAR_THREAT_SEARCH varmint_9 THREAT_SPECIAL
					SET_CHAR_HEED_THREATS varmint_9 true
					//SET_CHAR_OBJ_KILL_CHAR_ON_FOOT varmint_9 phil
				ENDIF
			ENDIF
		ENDIF
					
		plook9:
		IF NOT IS_CHAR_DEAD varmint_10
			IF NOT IS_CAR_DEAD perenial1_rm2
				SET_CHAR_OBJ_LEAVE_CAR varmint_10 perenial1_rm2
				WHILE IS_CHAR_IN_CAR varmint_10 perenial1_rm2
					WAIT 0
					IF IS_CAR_DEAD perenial1_rm2
						GOTO plook10
					ENDIF
					IF IS_CHAR_DEAD varmint_10
						GOTO plook10
					ENDIF
				ENDWHILE
				IF NOT IS_CHAR_DEAD varmint_10
					ADD_BLIP_FOR_CHAR_OLD varmint_10 1 BLIP_ONLY blip_v10
					GIVE_WEAPON_TO_CHAR varmint_10 WEAPONTYPE_SHOTGUN 20
					ADD_ARMOUR_TO_CHAR varmint_10 100
					SET_CHAR_OBJ_RUN_TO_COORD varmint_10 wh_x_rm2 wh_y_rm2
					SET_CHAR_THREAT_SEARCH varmint_10 THREAT_PLAYER1
					SET_CHAR_THREAT_SEARCH varmint_10 THREAT_SPECIAL
					SET_CHAR_HEED_THREATS varmint_10 true
					//SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT varmint_10 player
				ENDIF
			ENDIF
		ENDIF
					
		plook10:
		REMOVE_BLIP blip_perenial1
		perenial_bailout = 1
	ENDIF


RETURN

//-------------------VARMINT DEATHS-----------------------------------------

varmint_deaths:

	IF flag_sentinel_created = 1	
		IF flag_v1_dead = 0
			IF IS_CHAR_DEAD varmint_1
				flag_v1_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v1
			ENDIF
		ENDIF

		IF flag_v2_dead = 0
			IF IS_CHAR_DEAD varmint_2
				flag_v2_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v2
			ENDIF
		ENDIF

		IF flag_v3_dead = 0
			IF IS_CHAR_DEAD varmint_3
				flag_v3_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v3
			ENDIF
		ENDIF

		IF flag_v4_dead = 0
			IF IS_CHAR_DEAD varmint_4
				flag_v4_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v4
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_stallion_created = 1
		IF flag_v5_dead = 0
			IF IS_CHAR_DEAD varmint_5
				flag_v5_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v5
			ENDIF
		ENDIF

		IF flag_v6_dead = 0
			IF IS_CHAR_DEAD varmint_6
				flag_v6_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v6
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_perenial_created = 1
		IF flag_v7_dead = 0
			IF IS_CHAR_DEAD varmint_7
				flag_v7_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v7
			ENDIF
		ENDIF

		IF flag_v8_dead = 0
			IF IS_CHAR_DEAD varmint_8
				flag_v8_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v8
			ENDIF
		ENDIF

		IF flag_v9_dead = 0
			IF IS_CHAR_DEAD varmint_9
				flag_v9_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v9
			ENDIF
		ENDIF

		IF flag_v10_dead = 0
			IF IS_CHAR_DEAD varmint_10
				flag_v10_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v10
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_sneaky_1 = 1
		IF flag_v11_dead = 0
			IF IS_CHAR_DEAD varmint_11
				flag_v11_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v11
			ENDIF
		ENDIF
	ENDIF
	IF flag_sneaky_2 = 1
		IF flag_v12_dead = 0
			IF IS_CHAR_DEAD varmint_12
				flag_v12_dead = 1
				++ counter_dead_varmints
				REMOVE_BLIP blip_v12
			ENDIF
		ENDIF
	ENDIF


RETURN

//---------------PICKUPS------------------------

pickups:

	IF flag_m16_gone = 0
		IF HAS_PICKUP_BEEN_COLLECTED phils_m16
			//GIVE_WEAPON_TO_PLAYER player WEAPONTYPE_M16 80
			SET_CURRENT_PLAYER_WEAPON player WEAPONTYPE_M16
			flag_m16_gone = 1
		ENDIF
	ENDIF
	
	IF flag_uzi_gone = 0
		IF HAS_PICKUP_BEEN_COLLECTED phils_uzi
			//GIVE_WEAPON_TO_PLAYER player WEAPONTYPE_UZI 100
			SET_CURRENT_PLAYER_WEAPON player WEAPONTYPE_UZI
			flag_uzi_gone = 1
		ENDIF
	ENDIF		
	
	IF flag_rocket_gone = 0
		IF HAS_PICKUP_BEEN_COLLECTED phils_rocket
			//GIVE_WEAPON_TO_PLAYER player WEAPONTYPE_ROCKET 3
			SET_CURRENT_PLAYER_WEAPON player WEAPONTYPE_ROCKET
			flag_rocket_gone = 1
		ENDIF
	ENDIF		
	
	IF flag_shotgun_gone = 0
		IF HAS_PICKUP_BEEN_COLLECTED phils_shotgun
			//GIVE_WEAPON_TO_PLAYER player WEAPONTYPE_SHOTGUN 100
			SET_CURRENT_PLAYER_WEAPON player WEAPONTYPE_SHOTGUN
			flag_shotgun_gone = 1
		ENDIF
	ENDIF

	IF flag_molotov_gone = 0
		IF HAS_PICKUP_BEEN_COLLECTED phils_molotov
			//GIVE_WEAPON_TO_PLAYER player WEAPONTYPE_SHOTGUN 100
			SET_CURRENT_PLAYER_WEAPON player WEAPONTYPE_MOLOTOV
			flag_molotov_gone = 1
		ENDIF
	ENDIF

RETURN


//------blip removal-------------------------------

blip_removal_rm2:

	REMOVE_BLIP blip_v1
	REMOVE_BLIP blip_v2
	REMOVE_BLIP blip_v3
	REMOVE_BLIP blip_v4
	REMOVE_BLIP blip_v5
	REMOVE_BLIP blip_v6
	REMOVE_BLIP blip_v7
	REMOVE_BLIP blip_v8
	REMOVE_BLIP blip_v9
	REMOVE_BLIP blip_v10
	REMOVE_BLIP blip_v11
	REMOVE_BLIP blip_v12

RETURN
MISSION_START
// *****************************************************************************************
// ************************************ Ray mission 3 **************************************
// ************************************ Evidence Dash **************************************
// *****************************************************************************************
// *** The Internal Affairs are aware of Ray's activities, but are unable to get any 	 ***
// *** evidence until now. They have just raided one of Ray's old haunts and are leaving ***
// *** with the evidence. The player must chase them down and ram them with his car, when*** 
// *** their vehicle is rammed one of the packages will roll off the back. The player 	 ***
// *** must grab that first and then go get the next package off them. There will be 8 to*** 
// *** retrieve. Once the player has the stash he must get it back to his hideout.		 ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_ray3

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_ray3_failed
ENDIF

GOSUB mission_cleanup_ray3

MISSION_END
 
// Variables for mission

VAR_INT	rays_evidence_blip timera_reset_flag evidence_1	evidence_2 evidence_3 evidence_4 evidence_5 evidence_6 //evidence_7 evidence_8 evidence_9
VAR_INT	ia_car_rm3 ia_car_driver_1 wanted_level_change //stored_wanted_level
VAR_INT	wdadd6 ia_have_evidence_flag	players_car	prosecution_car_blip timer_for_speed reset_for_timer
VAR_INT temporary_health_var ia_car_previous_health ia_car_current_health
VAR_INT red green red_increase_flag red_decrease_flag green_increase_flag green_decrease_flag
VAR_INT amount_of_evidence_player_has amount_damage_ia_drop_evidence drop_one_flag drop_evidence get_coords_flag
VAR_INT timerc_reset_flag_r3 timerc_current_r3 timerc_started_r3 timerc_r3
VAR_INT timerd_reset_flag_r3 timerd_current_r3 timerd_started_r3 timerd_r3

VAR_FLOAT ia_start_x ia_start_y ia_start_z ia_car_x ia_car_y ia_car_z warp_heading
VAR_FLOAT object_current_coords_x object_current_coords_y object_current_coords_z car_stuck_x car_stuck_y car_stuck_z

// ****************************************Mission Start************************************

mission_start_ray3:

flag_player_on_mission = 1
flag_player_on_ray_mission = 1
rays_cutscene_flag = 1

REGISTER_MISSION_GIVEN

// objective is to ram a bunch of cars. dont need pathing here
DISPLAY_RADAR 2 // PATHING OFF

WAIT 0

SCRIPT_NAME ray3

ia_start_x = -53.0
ia_start_y = -1380.5
ia_start_z = 26.0

amount_damage_ia_drop_evidence = 1

wanted_level_change = 1

drop_one_flag = 0
drop_evidence = 0

green = 250
red = 0
red_increase_flag = 0
red_decrease_flag = 0
green_increase_flag = 0
green_decrease_flag	= 0

timera_reset_flag = 0
ia_have_evidence_flag = 0
temporary_health_var  = 0
ia_car_previous_health = 0
ia_car_current_health = 0
amount_of_evidence_player_has = 0
get_coords_flag = 0
timerc_reset_flag_r3 = 0
timerd_reset_flag_r3 = 0
timerd_current_r3 = 0
timerd_started_r3 = 0
timerd_r3 = 0

timer_for_speed = 0
reset_for_timer = 0

object_current_coords_x = 0.0
object_current_coords_y = 0.0
object_current_coords_z	= 0.0

LOAD_SPECIAL_CHARACTER 1 ray			   
{
// ****************************************START OF CUTSCENE********************************

/*
SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_ray3_failed
ENDIF

SWITCH_STREAMING OFF

PRINT_BIG RM3 15000 2 //"Evidence Dash"
*/

LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 RAYH
REQUEST_MODEL toilet

/*
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
*/

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED toilet
	WAIT 0
ENDWHILE

CLEAR_AREA 39.0 -723.5 22.0 1.0 TRUE

SET_PLAYER_COORDINATES player 39.0 -723.5 22.0

SET_PLAYER_HEADING player 90.0

LOAD_CUTSCENE r3_ed

SET_CUTSCENE_OFFSET 39.424 -726.677 21.692

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_ray

SET_CUTSCENE_ANIM cs_ray ray

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_ray CUT_OBJ2 cs_rayhead
SET_CUTSCENE_HEAD_ANIM cs_rayhead ray

//SET_PLAYER_COORDINATES player 38.7 -725.7 22.0
//
//SET_PLAYER_HEADING player 270.0

DO_FADE 1500 FADE_IN

SET_NEAR_CLIP 0.2

START_CUTSCENE

SWITCH_STREAMING OFF
// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 10381
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM3_A 10000 1 //"I know a real important man in town, a soft touch

WHILE cs_time < 13529
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM3_H 10000 1 //"with shall we say, exotic tastes and the money to indulge them.

WHILE cs_time < 17950
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM3_B 10000 1 //"He's involved in a legal matter and the prosecution has some rather embarrassing photos of him..."

WHILE cs_time < 23502
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM3_C 10000 1 //"...at a morgue party or something."

WHILE cs_time < 26180
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM3_D 10000 1 //"The evidence is being driven across town."

WHILE cs_time < 29179
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM3_E 10000 1 //"You are going to have to ram the car and collect each bit of evidence as it falls out."

WHILE cs_time < 34865
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM3_F	10000 1 //"When you've got it all, leave it in the car and torch it."  

WHILE cs_time < 39290
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM3_G	10000 1 //"We're both gonna do well out of this."

WHILE cs_time < 41666 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

//DO_FADE 1000 FADE_IN 

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

DO_FADE 0 FADE_OUT
SET_NEAR_CLIP 0.9

SET_PLAYER_HEADING player 90.0
SET_CAMERA_BEHIND_PLAYER

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED toilet
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2

REQUEST_MODEL files
REQUEST_MODEL CAR_BOBCAT
REQUEST_MODEL PED_B_MAN3

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED CAR_BOBCAT
OR NOT HAS_MODEL_LOADED PED_B_MAN3
OR NOT HAS_MODEL_LOADED files
	WAIT 0
ENDWHILE

DO_FADE 1500 FADE_IN 

SWITCH_STREAMING ON

rays_cutscene_flag = 0

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

// ******************************************END OF CUTSCENE********************************

CREATE_CAR CAR_BOBCAT ia_start_x ia_start_y ia_start_z ia_car_rm3
SET_CAR_AVOID_LEVEL_TRANSITIONS ia_car_rm3 TRUE
SET_CAR_WATERTIGHT ia_car_rm3 TRUE
CREATE_CHAR_INSIDE_CAR ia_car_rm3 PEDTYPE_CIVMALE PED_B_MAN3 ia_car_driver_1
//SET_CHAR_AVOID_LEVEL_TRANSITIONS ia_car_driver_1 TRUE
SET_CHAR_CANT_BE_DRAGGED_OUT ia_car_driver_1 TRUE
SET_CAR_ONLY_DAMAGED_BY_PLAYER ia_car_rm3 TRUE
SET_UPSIDEDOWN_CAR_NOT_DAMAGED ia_car_rm3 TRUE
SET_CAR_PROOFS ia_car_rm3 TRUE TRUE 	TRUE 	FALSE 	TRUE 
SET_CAR_CRUISE_SPEED ia_car_rm3 20.0
SET_CAR_DRIVING_STYLE ia_car_rm3 2
CAR_WANDER_RANDOMLY ia_car_rm3
ADD_BLIP_FOR_CAR ia_car_rm3 prosecution_car_blip
LOCK_CAR_DOORS ia_car_rm3 CARLOCK_LOCKED

IF flag_player_on_mission = 0
	ADD_BLIP_FOR_CHAR ia_car_driver_1 rays_evidence_blip
ENDIF

GET_CAR_COORDINATES ia_car_rm3 car_stuck_x car_stuck_y car_stuck_z
GET_CAR_COORDINATES ia_car_rm3 ia_car_x ia_car_y ia_car_z
ia_car_z += 3.0
CREATE_OBJECT files ia_car_x ia_car_y ia_car_z evidence_1
ia_car_z += 1.0
CREATE_OBJECT files ia_car_x ia_car_y ia_car_z evidence_2
ia_car_z += 1.0
CREATE_OBJECT files ia_car_x ia_car_y ia_car_z evidence_3
ia_car_z += 1.0
CREATE_OBJECT files ia_car_x ia_car_y ia_car_z evidence_4
ia_car_z += 1.0
CREATE_OBJECT files ia_car_x ia_car_y ia_car_z evidence_5
ia_car_z += 1.0
CREATE_OBJECT files ia_car_x ia_car_y ia_car_z evidence_6

SET_OBJECT_COLLISION evidence_1 FALSE
SET_OBJECT_COLLISION evidence_2 FALSE
SET_OBJECT_COLLISION evidence_3 FALSE
SET_OBJECT_COLLISION evidence_4 FALSE
SET_OBJECT_COLLISION evidence_5 FALSE
SET_OBJECT_COLLISION evidence_6 FALSE

PLACE_OBJECT_RELATIVE_TO_CAR evidence_1 ia_car_rm3  0.3 -1.7 -0.1
PLACE_OBJECT_RELATIVE_TO_CAR evidence_2 ia_car_rm3  0.3 -1.2 -0.1
PLACE_OBJECT_RELATIVE_TO_CAR evidence_3 ia_car_rm3 -0.3 -1.2 -0.1
PLACE_OBJECT_RELATIVE_TO_CAR evidence_4 ia_car_rm3  0.3 -0.7 -0.1
PLACE_OBJECT_RELATIVE_TO_CAR evidence_5 ia_car_rm3 -0.3 -0.7 -0.1
PLACE_OBJECT_RELATIVE_TO_CAR evidence_6 ia_car_rm3 -0.3 -1.7 -0.1

//SWITCH_ROADS_OFF -90.0 -791.0 24.0 -56.0 -587.0 36.0
//SWITCH_ROADS_OFF 320.0 -948.0 30.0 350.0 -913.0 40.0
//SWITCH_ROADS_OFF 251.0 -46.0 -21.0 320.0 68.0 27.0

ia_have_evidence_flag = 1

evidence_loop:///////////////////////////////////////////////////////////////////////////////////////////////////////

WAIT 0

IF IS_CAR_DEAD ia_car_rm3
	IF IS_CAR_IN_WATER ia_car_rm3
		IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D player ia_car_rm3 50.0 50.0 0
			IF NOT IS_CAR_ON_SCREEN ia_car_rm3
				GET_CAR_COORDINATES ia_car_rm3 ia_car_x ia_car_y ia_car_z
				GET_CLOSEST_CAR_NODE_WITH_HEADING ia_car_x ia_car_y ia_car_z ia_car_x ia_car_y ia_car_z warp_heading
				IF NOT IS_POINT_ON_SCREEN ia_car_x ia_car_y ia_car_z 3.0
					SET_CAR_COORDINATES ia_car_rm3 ia_car_x ia_car_y ia_car_z
					SET_CAR_HEADING	ia_car_rm3 warp_heading
				ENDIF
			ENDIF
		ELSE
			PRINT_NOW RM3_6 5000 1 //"The evidence will be washed up all over Liberty!"
			GOTO mission_ray3_failed
		ENDIF
	ELSE
		GOTO mission_ray3_passed
	ENDIF
ENDIF

IF IS_CAR_UPSIDEDOWN ia_car_rm3
AND IS_CAR_STOPPED ia_car_rm3

	IF NOT IS_CAR_ON_SCREEN ia_car_rm3
		GET_CAR_COORDINATES ia_car_rm3 ia_car_x ia_car_y ia_car_z
		GET_CLOSEST_CAR_NODE_WITH_HEADING ia_car_x ia_car_y ia_car_z ia_car_x ia_car_y ia_car_z warp_heading
		IF NOT IS_POINT_ON_SCREEN ia_car_x ia_car_y ia_car_z 3.0
			SET_CAR_COORDINATES ia_car_rm3 ia_car_x ia_car_y ia_car_z
			SET_CAR_HEADING	ia_car_rm3 warp_heading
		ENDIF
	ELSE
		IF NOT drop_evidence = 6
			GOSUB create_another_car
		ENDIF
	ENDIF
ENDIF

IF timera_reset_flag = 1
	IF NOT IS_CAR_STOPPED ia_car_rm3
		timera_reset_flag = 0
	ENDIF
ENDIF
		
IF IS_CAR_STOPPED ia_car_rm3
	IF timera_reset_flag = 0
		TIMERA = 0
		timera_reset_flag = 1
	ENDIF

	IF TIMERA > 5000
	AND timera_reset_flag = 1
		IF NOT IS_CAR_ON_SCREEN ia_car_rm3
			GET_CAR_COORDINATES ia_car_rm3 ia_car_x ia_car_y ia_car_z
			GET_CLOSEST_CAR_NODE_WITH_HEADING ia_car_x ia_car_y ia_car_z ia_car_x ia_car_y ia_car_z warp_heading
			IF NOT IS_POINT_ON_SCREEN ia_car_x ia_car_y ia_car_z 4.0
				SET_CAR_COORDINATES ia_car_rm3 ia_car_x ia_car_y ia_car_z
				SET_CAR_HEADING	ia_car_rm3 warp_heading
				timera_reset_flag = 0
			ENDIF
		ELSE
			IF NOT drop_evidence = 6
				GOSUB create_another_car
			ENDIF
		ENDIF
	ENDIF
ENDIF

IF LOCATE_CAR_3D ia_car_rm3	car_stuck_x car_stuck_y car_stuck_z 4.0 4.0 4.0 0
	IF timerc_reset_flag_r3 = 0
		GET_GAME_TIMER timerc_started_r3
		timerc_reset_flag_r3 = 1
	ENDIF

	IF timerc_reset_flag_r3 = 1
		GET_GAME_TIMER timerc_current_r3
		timerc_r3 = timerc_current_r3 - timerc_started_r3
		IF timerc_r3 > 8000
			IF NOT IS_CAR_ON_SCREEN ia_car_rm3
				GET_CAR_COORDINATES ia_car_rm3 ia_car_x ia_car_y ia_car_z
				GET_CLOSEST_CAR_NODE_WITH_HEADING ia_car_x ia_car_y ia_car_z ia_car_x ia_car_y ia_car_z warp_heading
				IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY ia_car_x ia_car_y ia_car_z 4.0 4.0 4.0
					IF NOT IS_POINT_ON_SCREEN ia_car_x ia_car_y ia_car_z 4.0
						SET_CAR_COORDINATES ia_car_rm3 ia_car_x ia_car_y ia_car_z
						SET_CAR_HEADING	ia_car_rm3 warp_heading
						timerc_reset_flag_r3 = 0
					ENDIF
				ENDIF
			ELSE
				IF NOT drop_evidence = 6
					GOSUB create_another_car
				ENDIF
			ENDIF
		ENDIF
	ENDIF
ENDIF

IF NOT LOCATE_CAR_3D ia_car_rm3	car_stuck_x car_stuck_y car_stuck_z 4.0 4.0 4.0 0
	GET_CAR_COORDINATES ia_car_rm3 car_stuck_x car_stuck_y car_stuck_z
	timerc_reset_flag_r3 = 0
ENDIF

GET_GAME_TIMER timer_for_speed
timer_for_speed -= reset_for_timer
IF timer_for_speed > 1000
	GET_GAME_TIMER reset_for_timer
	IF LOCATE_PLAYER_ANY_MEANS_CAR_2D player ia_car_rm3 20.0 20.0 0
		SET_CAR_CRUISE_SPEED ia_car_rm3 50.0
	ELSE
		IF LOCATE_PLAYER_ANY_MEANS_CAR_2D player ia_car_rm3 50.0 50.0 0
			SET_CAR_CRUISE_SPEED ia_car_rm3 41.0
		ELSE
			IF LOCATE_PLAYER_ANY_MEANS_CAR_2D player ia_car_rm3 90.0 90.0 0
				SET_CAR_CRUISE_SPEED ia_car_rm3 34.0
			ELSE
				IF LOCATE_PLAYER_ANY_MEANS_CAR_2D player ia_car_rm3 130.0 130.0 0
					SET_CAR_CRUISE_SPEED ia_car_rm3 28.0
				ELSE
					SET_CAR_CRUISE_SPEED ia_car_rm3 20.0
				ENDIF
			ENDIF
		ENDIF
	ENDIF
ENDIF

IF ia_have_evidence_flag = 0
	
	IF TIMERB > 500
		IF LOCATE_PLAYER_ANY_MEANS_3D player object_current_coords_x object_current_coords_y object_current_coords_z 1.5 1.5 1.5 0
			GOSUB evidence_collected
		ENDIF
	ENDIF
	
	IF TIMERB > 10000
		IF LOCATE_PLAYER_ANY_MEANS_2D player object_current_coords_x object_current_coords_y 1.5 1.5 0
			GOSUB evidence_collected
		ENDIF
	ENDIF
	
	IF TIMERB > 120000
		IF LOCATE_PLAYER_ANY_MEANS_2D player object_current_coords_x object_current_coords_y 30.0 30.0 0
			GOSUB evidence_collected
		ENDIF
	ENDIF
ENDIF

ia_car_previous_health = ia_car_current_health
GET_CAR_HEALTH ia_car_rm3 ia_car_current_health		  
IF ia_have_evidence_flag = 1
	IF IS_CAR_UPRIGHT ia_car_rm3
		temporary_health_var = ia_car_previous_health - amount_damage_ia_drop_evidence
		IF temporary_health_var > ia_car_current_health
			PRINT_NOW ( RM3_4 ) 3000 1 //"IA HAVE DROPPED THE EVIDENCE"
			SET_CAR_HEALTH ia_car_rm3 1000
			ia_car_current_health = 1000
			ia_car_previous_health = 1000
			ia_have_evidence_flag = 0
			drop_one_flag = 0
			get_coords_flag = 1
		ENDIF
	ENDIF
ENDIF

IF ia_have_evidence_flag = 0
AND drop_one_flag = 0
	drop_evidence++
	REMOVE_BLIP rays_evidence_blip
	IF drop_evidence = 1
		PLACE_OBJECT_RELATIVE_TO_CAR evidence_1 ia_car_rm3 0.3 -1.7 0.2
		ADD_BLIP_FOR_OBJECT evidence_1 rays_evidence_blip
		SET_OBJECT_COLLISION evidence_1 TRUE
		SET_OBJECT_DYNAMIC evidence_1 TRUE
		ADD_TO_OBJECT_VELOCITY evidence_1 0.0 0.0 16.0
		MAKE_OBJECT_TARGETTABLE evidence_1
		ALTER_WANTED_LEVEL_NO_DROP player 2
		SET_CAR_CRUISE_SPEED ia_car_rm3 100.0
		SET_CAR_DRIVING_STYLE ia_car_rm3 2
		// Play sound for police scanner here
		TIMERB = 0
	ENDIF
	IF drop_evidence = 2
		PLACE_OBJECT_RELATIVE_TO_CAR evidence_2 ia_car_rm3 0.3 -1.2 0.2
		ADD_BLIP_FOR_OBJECT evidence_2 rays_evidence_blip
		SET_OBJECT_COLLISION evidence_2 TRUE
		SET_OBJECT_DYNAMIC evidence_2 TRUE
		ADD_TO_OBJECT_VELOCITY evidence_2 0.0 0.0 16.0
		MAKE_OBJECT_TARGETTABLE evidence_2
		TIMERB = 0
	ENDIF
	IF drop_evidence = 3
		PLACE_OBJECT_RELATIVE_TO_CAR evidence_3 ia_car_rm3 -0.3 -1.2 0.2
		ADD_BLIP_FOR_OBJECT evidence_3 rays_evidence_blip
		SET_OBJECT_COLLISION evidence_3 TRUE
		SET_OBJECT_DYNAMIC evidence_3 TRUE
		ADD_TO_OBJECT_VELOCITY evidence_3 0.0 0.0 16.0
		MAKE_OBJECT_TARGETTABLE evidence_3
		TIMERB = 0
	ENDIF
	IF drop_evidence = 4
		PLACE_OBJECT_RELATIVE_TO_CAR evidence_4 ia_car_rm3 0.3 -0.7 0.2
		ADD_BLIP_FOR_OBJECT evidence_4 rays_evidence_blip
		SET_OBJECT_COLLISION evidence_4 TRUE
		SET_OBJECT_DYNAMIC evidence_4 TRUE
		ADD_TO_OBJECT_VELOCITY evidence_4 0.0 0.0 16.0
		MAKE_OBJECT_TARGETTABLE evidence_4
		TIMERB = 0
	ENDIF
	IF drop_evidence = 5
		PLACE_OBJECT_RELATIVE_TO_CAR evidence_5 ia_car_rm3 -0.3 -0.7 0.2
		ADD_BLIP_FOR_OBJECT evidence_5 rays_evidence_blip
		SET_OBJECT_COLLISION evidence_5 TRUE
		SET_OBJECT_DYNAMIC evidence_5 TRUE
		ADD_TO_OBJECT_VELOCITY evidence_5 0.0 0.0 16.0
		MAKE_OBJECT_TARGETTABLE evidence_5
		TIMERB = 0
	ENDIF
	IF drop_evidence = 6
		PLACE_OBJECT_RELATIVE_TO_CAR evidence_6 ia_car_rm3 -0.3 -1.7 0.2
		ADD_BLIP_FOR_OBJECT evidence_6 rays_evidence_blip
		SET_OBJECT_COLLISION evidence_6 TRUE
		SET_OBJECT_DYNAMIC evidence_6 TRUE
		ADD_TO_OBJECT_VELOCITY evidence_6 0.0 0.0 16.0
		MAKE_OBJECT_TARGETTABLE evidence_6
		REMOVE_BLIP	prosecution_car_blip
		TIMERB = 0
	ENDIF
	drop_one_flag = 1
ENDIF

IF get_coords_flag = 1
	IF drop_evidence = 1
		GET_OBJECT_COORDINATES evidence_1 object_current_coords_x object_current_coords_y object_current_coords_z
	ENDIF
	IF drop_evidence = 2
		GET_OBJECT_COORDINATES evidence_2 object_current_coords_x object_current_coords_y object_current_coords_z
	ENDIF
	IF drop_evidence = 3
		GET_OBJECT_COORDINATES evidence_3 object_current_coords_x object_current_coords_y object_current_coords_z
	ENDIF
	IF drop_evidence = 4
		GET_OBJECT_COORDINATES evidence_4 object_current_coords_x object_current_coords_y object_current_coords_z
	ENDIF
	IF drop_evidence = 5
		GET_OBJECT_COORDINATES evidence_5 object_current_coords_x object_current_coords_y object_current_coords_z
	ENDIF
	IF drop_evidence = 6
		GET_OBJECT_COORDINATES evidence_6 object_current_coords_x object_current_coords_y object_current_coords_z
	ENDIF
ENDIF

IF ia_have_evidence_flag = 0

	IF red = 0
		red_decrease_flag = 0	
		red_increase_flag = 1
	ENDIF
	
	IF red = 250
		red_decrease_flag = 1	
		red_increase_flag = 0
	ENDIF	
		
	IF red_increase_flag = 1
		red	= red + 10
	ENDIF

	IF red_decrease_flag = 1
		red = red - 10
	ENDIF

	IF green = 0
		green_decrease_flag = 0	
		green_increase_flag = 1
	ENDIF
	
	IF green = 250
		green_decrease_flag = 1	
		green_increase_flag = 0
	ENDIF	
		
	IF green_increase_flag = 1
		green = green + 10
	ENDIF

	IF green_decrease_flag = 1
		green = green - 10
	ENDIF
	
	DRAW_CORONA object_current_coords_x object_current_coords_y object_current_coords_z 0.5 CORONATYPE_CIRCLE FLARETYPE_NONE red green 0

ENDIF

IF drop_evidence < 1
	PLACE_OBJECT_RELATIVE_TO_CAR evidence_1 ia_car_rm3 0.3 -1.7 -0.1
ENDIF

IF drop_evidence < 2
	PLACE_OBJECT_RELATIVE_TO_CAR evidence_2 ia_car_rm3 0.3 -1.2 -0.1
ENDIF

IF drop_evidence < 3
	PLACE_OBJECT_RELATIVE_TO_CAR evidence_3 ia_car_rm3 -0.3 -1.2 -0.1
ENDIF

IF drop_evidence < 4
	PLACE_OBJECT_RELATIVE_TO_CAR evidence_4 ia_car_rm3 0.3 -0.7 -0.1
ENDIF

IF drop_evidence < 5
	PLACE_OBJECT_RELATIVE_TO_CAR evidence_5 ia_car_rm3 -0.3 -0.7 -0.1
ENDIF
	
IF drop_evidence < 6
	PLACE_OBJECT_RELATIVE_TO_CAR evidence_6 ia_car_rm3 -0.3 -1.7 -0.1
ENDIF
	
IF amount_of_evidence_player_has = 6
	REMOVE_BLIP rays_evidence_blip
	
	PRINT_NOW RM3_1 5000 1
	
	WHILE NOT IS_PLAYER_IN_ANY_CAR player
		WAIT 0
	ENDWHILE
	
	STORE_CAR_PLAYER_IS_IN player players_car
	
	WHILE IS_PLAYER_IN_ANY_CAR player
		WAIT 0
	ENDWHILE
	
	IF NOT IS_CAR_DEAD players_car
		ADD_BLIP_FOR_CAR players_car rays_evidence_blip
		CLEAR_ONSCREEN_COUNTER amount_of_evidence_player_has
		PRINT_NOW RM3_7 5000 1	// "Now torch the car!"
		WHILE NOT IS_CAR_DEAD players_car
			WAIT 0
		ENDWHILE
		
		GOTO mission_ray3_passed
	ELSE
		GOTO mission_ray3_passed
	ENDIF
ENDIF

GOTO evidence_loop///////////////////////////////////////////////////////////////////////////////////////


// Mission Ray3 failed

mission_ray3_failed:
PRINT_BIG ( m_fail ) 5000 1
RETURN

   

// mission Ray3 passed

mission_ray3_passed:

flag_ray_mission3_passed = 1
PRINT_WITH_NUMBER_BIG M_PASS 10000 5000 1
ADD_SCORE player 10000
CLEAR_WANTED_LEVEL player
REGISTER_MISSION_PASSED	RM3
PLAY_MISSION_PASSED_TUNE 1
PLAYER_MADE_PROGRESS 1
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 86.1 -1548.7 28.3 RADAR_SPRITE_DON love_contact_blip
START_NEW_SCRIPT ray_mission4_loop
START_NEW_SCRIPT love_mission1_loop
RETURN
		


// mission cleanup

mission_cleanup_ray3:

DISPLAY_RADAR 3 // PATHING ON

//SWITCH_ROADS_ON -90.0 -791.0 24.0 -56.0 -587.0 36.0
//SWITCH_ROADS_ON 195.0 -948.0 24.0 280.0 -913.0 40.0
//SWITCH_ROADS_ON 251.0 -46.0 -21.0 320.0 68.0 27.0
REMOVE_BLIP	rays_evidence_blip
REMOVE_BLIP	prosecution_car_blip
CLEAR_ONSCREEN_COUNTER amount_of_evidence_player_has
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_BOBCAT
MARK_MODEL_AS_NO_LONGER_NEEDED PED_B_MAN3
MARK_MODEL_AS_NO_LONGER_NEEDED DONKEYMAG
flag_player_on_mission = 0
flag_player_on_ray_mission = 0

MISSION_HAS_FINISHED
RETURN
		

create_another_car:
	
IF timerd_reset_flag_r3 = 0
	GET_GAME_TIMER timerd_started_r3
	timerd_reset_flag_r3 = 1
ENDIF

IF timerd_reset_flag_r3 = 1
	GET_GAME_TIMER timerd_current_r3
	timerd_r3 = timerd_current_r3 - timerd_started_r3
	IF timerd_r3 > 15000
		PRINT_NOW RM3_8 5000 1 //"That car is a decoy!!"
		REMOVE_BLIP	prosecution_car_blip
		MARK_CAR_AS_NO_LONGER_NEEDED ia_car_rm3
		MARK_CHAR_AS_NO_LONGER_NEEDED ia_car_driver_1
		IF LOCATE_PLAYER_ANY_MEANS_2D player ia_start_x ia_start_y 150.0 150.0 0
			CREATE_CAR CAR_BOBCAT 254.8355 -667.3972 25.3 ia_car_rm3
		ELSE
			CREATE_CAR CAR_BOBCAT ia_start_x ia_start_y ia_start_z ia_car_rm3
		ENDIF
		CREATE_CHAR_INSIDE_CAR ia_car_rm3 PEDTYPE_CIVMALE PED_B_MAN3 ia_car_driver_1
		SET_CAR_WATERTIGHT ia_car_rm3 TRUE
		SET_CHAR_CANT_BE_DRAGGED_OUT ia_car_driver_1 TRUE
		SET_CAR_ONLY_DAMAGED_BY_PLAYER ia_car_rm3 TRUE
		SET_UPSIDEDOWN_CAR_NOT_DAMAGED ia_car_rm3 TRUE
		SET_CAR_PROOFS ia_car_rm3 TRUE TRUE TRUE FALSE TRUE 
		SET_CAR_CRUISE_SPEED ia_car_rm3 100.0
		SET_CAR_DRIVING_STYLE ia_car_rm3 2
		CAR_WANDER_RANDOMLY ia_car_rm3
		ADD_BLIP_FOR_CAR ia_car_rm3 prosecution_car_blip
		LOCK_CAR_DOORS ia_car_rm3 CARLOCK_LOCKED
		SET_CAR_AVOID_LEVEL_TRANSITIONS ia_car_rm3 TRUE
		timerd_reset_flag_r3 = 0
	ENDIF
ENDIF

RETURN


evidence_collected:

REMOVE_BLIP rays_evidence_blip
get_coords_flag = 0
ADD_ONE_OFF_SOUND object_current_coords_x object_current_coords_y object_current_coords_z SOUND_EVIDENCE_PICKUP
IF drop_evidence = 1
	DELETE_OBJECT evidence_1
	DISPLAY_ONSCREEN_COUNTER_WITH_STRING amount_of_evidence_player_has COUNTER_DISPLAY_NUMBER COLLECT
ENDIF
IF drop_evidence = 2
	DELETE_OBJECT evidence_2
ENDIF
IF drop_evidence = 3
	DELETE_OBJECT evidence_3
ENDIF
IF drop_evidence = 4
	DELETE_OBJECT evidence_4
ENDIF
IF drop_evidence = 5
	DELETE_OBJECT evidence_5
ENDIF
IF drop_evidence = 6
	DELETE_OBJECT evidence_6
ENDIF
++ amount_of_evidence_player_has
PRINT_WITH_NUMBER_NOW RM3_5 amount_of_evidence_player_has 5000 1 //"You have ~1~ evidence packages."
ia_have_evidence_flag = 1
TIMERB = 0

RETURN
}
MISSION_START
// *****************************************************************************************
// *********************************** Ray Mission 4 ***************************************
// *********************************** Gone Fishing	 ***************************************
// *****************************************************************************************
// *** Ray's partner is going to turn State's Evidence. He goes night fishing on the     ***
// *** Lighthouse Rock. The player will have to use a boat to get to him.  This boat will***
// *** have guns, and that is how the player must kill Ray's partner. Ray's partner will ***
// *** also have a weapon of his own, as he flees he will be dropping barrels of 		 ***
// *** explosives into the water and the path of the player.							 ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_ray4

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_ray4_failed
ENDIF

GOSUB mission_cleanup_ray4

MISSION_END
 
// Variables for mission

VAR_INT rays_partner partners_car partners_boat partners_blip players_boat_with_guns players_boat_with_guns_blip timer_reset_flag_r4
VAR_INT partners_boat_health random_int gotaway_timer gotaway_timer_current gotaway_timer_started partner_on_foot_counter
VAR_INT mine_current_timer last_mine_dropped_timer temporary_time_mine fish_target barrel2_a barrel2_b 
VAR_INT gotaway_timer_reset_flag boat_speed_flag boat_node_counter partners_car_is_dead shoot_at_player_flag partner_on_foot_flag
VAR_INT fishy_1 fishy_2 fishy_3 fishy_4 fishy_5 fishy_6 fishy_7 fishy_8 fishy_9 fishy_10 partners_boat_health2 goto_mission_ray4_failed
VAR_INT timerc_r4 timerc_current_r4 timerc_started_r4 timerc_reset_flag_r4 exit_boat_flag

VAR_FLOAT partner_x partner_y partner_z	partners_boat_speed	player_x player_y player_z fish_target_x fish_target_y fish_target_z
VAR_FLOAT vector_x vector_y temp_vector_x temp_vector_y	temp_distance distance_between_boats partners_boat_forward_x partners_boat_forward_y
VAR_FLOAT temp_dot_product_x temp_dot_product_y	dot_product	temp_x temp_y distance_resultA	distance_resultB
VAR_FLOAT sniper_object_a_x sniper_object_a_y 

VAR_FLOAT boat_node_x boat_node_y node_0_x node_0_y node_1_x node_1_y node_2_x node_2_y node_3_x node_3_y node_4_x node_4_y node_5_x node_5_y
VAR_FLOAT node_6_x node_6_y node_7_x node_7_y node_8_x node_8_y node_9_x node_9_y node_10_x node_10_y node_11_x node_11_y
VAR_FLOAT partner_stuck_x partner_stuck_y partner_stuck_z

// ****************************************Mission Start************************************

mission_start_ray4:

flag_player_on_mission = 1
flag_player_on_ray_mission = 1
rays_cutscene_flag = 1

REGISTER_MISSION_GIVEN

WAIT 0

SCRIPT_NAME ray4

mine_current_timer = 0
last_mine_dropped_timer = 0
temporary_time_mine = 0
random_int = 0
boat_speed_flag	= 0
boat_node_counter = 2
partners_car_is_dead = 0
shoot_at_player_flag = 0
gotaway_timer_reset_flag = 0
partner_on_foot_counter = 0
partner_on_foot_flag = 0
partner_on_foot_counter = 0
goto_mission_ray4_failed = 0
timer_reset_flag_r4 = 0
timerc_r4 = 0
timerc_current_r4 = 0
timerc_started_r4 = 0
timerc_reset_flag_r4 = 0
exit_boat_flag = 0

partner_stuck_x	= 0.0
partner_stuck_y	= 0.0
partner_stuck_z	= 0.0

node_0_x = 1405.4507 
node_0_y = -598.6941

node_1_x = 1710.1085
node_1_y = -371.7377

node_2_x = 1713.1384
node_2_y = -498.4113

node_3_x = 1632.3
node_3_y = -601.5

node_4_x = 1619.8263
node_4_y = -764.9598

node_5_x = 1653.3024
node_5_y = -822.3922

node_6_x = 1681.7670
node_6_y = -775.2837

node_7_x = 1682.8789
node_7_y = -590.4975

node_8_x = 1577.6987
node_8_y = -498.9852

node_9_x = 1576.3445
node_9_y = -361.7413

node_10_x = 1568.4171
node_10_y = -249.0114

node_11_x = 1628.1332
node_11_y = -195.5839

{
// ****************************************START OF CUTSCENE********************************

/*
SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_ray4_failed
ENDIF

SWITCH_STREAMING OFF

PRINT_BIG RM4 15000 2 //"Gone Fishing"
*/

LOAD_SPECIAL_CHARACTER 1 ray
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 RAYH
LOAD_SPECIAL_MODEL cut_obj3 BOGDOOR
REQUEST_MODEL toilet

/*
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
*/

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED toilet
	WAIT 0
ENDWHILE

CLEAR_AREA 39.0 -723.5 22.0 1.0 TRUE

SET_PLAYER_COORDINATES player 39.0 -723.5 22.0

SET_PLAYER_HEADING player 90.0

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 47.322 -732.055 22.846 4.0 toilet_cubicle_dr2 FALSE

LOAD_CUTSCENE r4_gf

SET_CUTSCENE_OFFSET 39.424 -726.677 21.692

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_ray

SET_CUTSCENE_ANIM cs_ray ray

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_ray CUT_OBJ2 cs_rayhead
SET_CUTSCENE_HEAD_ANIM cs_rayhead ray

CREATE_CUTSCENE_OBJECT cut_obj3 cs_ludoor
SET_CUTSCENE_ANIM cs_ludoor BOGDOOR

SWITCH_RUBBISH OFF
DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON

SET_NEAR_CLIP 0.2

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 4285
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM4_A 4000 1 //"I think my partner's a rat."

WHILE cs_time < 6389
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM4_B 4000 1 //"We gotta shut him up permanently."

WHILE cs_time < 8524
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM4_C 4000 1 //"He goes fishing out of his boat near the lighthouse on Portland Rock most nights."

WHILE cs_time < 13026
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM4_D	4000 1 //"Steal a police boat and make sure his back stabbing plans are sunk!"

WHILE cs_time < 17497
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM4_E	4000 1 //"I want him sleeping with the fishes not eating them."

WHILE cs_time < 21000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

SWITCH_STREAMING ON
SWITCH_RUBBISH ON

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

DO_FADE 0 FADE_OUT

SET_NEAR_CLIP 0.9

FORCE_WEATHER_NOW WEATHER_SUNNY

SET_CAMERA_BEHIND_PLAYER

WAIT 500

rays_cutscene_flag = 0

DO_FADE 1500 FADE_IN 

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 47.322 -732.055 22.846 4.0 toilet_cubicle_dr2 TRUE

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED toilet
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj3

// ******************************************END OF CUTSCENE********************************

REQUEST_MODEL BOAT_PREDATOR
REQUEST_MODEL BOAT_GHOST 
REQUEST_MODEL CAR_SENTINEL 
REQUEST_MODEL CAR_RCBANDIT 

WHILE NOT HAS_MODEL_LOADED BOAT_PREDATOR
OR NOT HAS_MODEL_LOADED BOAT_GHOST
OR NOT HAS_MODEL_LOADED CAR_SENTINEL
OR NOT HAS_MODEL_LOADED CAR_RCBANDIT
	WAIT 0
ENDWHILE

CREATE_CAR BOAT_PREDATOR 837.0 -1115.6 -0.2 players_boat_with_guns

SET_CAR_HEADING players_boat_with_guns 140.0
ADD_BLIP_FOR_CAR players_boat_with_guns players_boat_with_guns_blip

PRINT_NOW RM4_1 5000 1 //"Go steal a boat."

/////////////////////////
/////////////////////////
//SET_PLAYER_COORDINATES player 833.88 -1114.9 6.0
//WAIT 1500
//
//IF NOT IS_CAR_DEAD players_boat_with_guns
//ENDIF
//
//WARP_PLAYER_INTO_CAR player	players_boat_with_guns
/////////////////////////
/////////////////////////

WHILE NOT IS_PLAYER_IN_MODEL player BOAT_PREDATOR
	WAIT 0
ENDWHILE

REMOVE_BLIP	players_boat_with_guns_blip

//CREATE_CAR BOAT_GHOST 1695.0 -381.5 -1.3 partners_boat
CREATE_CAR BOAT_GHOST 1695.0 -381.5 -1.4 partners_boat
SET_CAR_STRONG partners_boat TRUE

CREATE_OBJECT barrel2 837.0 -1115.6 10.0 barrel2_a
CREATE_OBJECT barrel2 837.0 -1115.6 20.0 barrel2_b
//CREATE_OBJECT faketarget 837.0 -1115.6 30.0 sniper_object

SET_OBJECT_COLLISION barrel2_a OFF
SET_OBJECT_COLLISION barrel2_b OFF
//SET_OBJECT_COLLISION sniper_object OFF
SET_OBJECT_DYNAMIC barrel2_a FALSE
SET_OBJECT_DYNAMIC barrel2_b FALSE
//SET_OBJECT_DYNAMIC sniper_object FALSE

PLACE_OBJECT_RELATIVE_TO_CAR barrel2_a partners_boat -0.3 -2.5 0.2
PLACE_OBJECT_RELATIVE_TO_CAR barrel2_b partners_boat 0.3 -2.5 0.2

PRINT_NOW RM4_2 5000 1 //"Get to the lighthouse and 'rub out' Ray's partner!"

GET_CAR_HEALTH partners_boat partners_boat_health

ADD_BLIP_FOR_CAR_OLD partners_boat GREEN BOTH partners_blip
CHANGE_BLIP_SCALE partners_blip 3

/////////////////////////
/////////////////////////
//SET_PLAYER_COORDINATES PLAYER 1694.0 -589.0 0.0
/////////////////////////
/////////////////////////

WHILE NOT LOCATE_PLAYER_ANY_MEANS_2D player 1700.0 -383.0 180.0 180.0 0
AND NOT partners_boat_health < 980
	
	WAIT 0
	
	IF IS_CAR_DEAD partners_boat
		GOTO mission_ray4_passed
	ENDIF

	GET_CAR_HEALTH partners_boat partners_boat_health

	GOSUB object_placement

ENDWHILE

GET_CAR_HEADING	partners_boat distance_resultB
GET_CAR_COORDINATES	partners_boat partner_x	partner_y partner_z
GET_CAR_FORWARD_X partners_boat partners_boat_forward_x
GET_CAR_FORWARD_Y partners_boat partners_boat_forward_y
temp_dot_product_x = 0.0 * partners_boat_forward_y  //change both of these to move on the vehicles x axis
temp_dot_product_y = 0.0 * partners_boat_forward_x //

temp_x = 1.8 * partners_boat_forward_x //change both of these to move on the vehicles y axis
temp_y = 1.8 * partners_boat_forward_y //

vector_x = temp_dot_product_x - temp_x
vector_y = temp_dot_product_y - temp_y

vector_x = vector_x + partner_x 
vector_y = vector_y + partner_y

partner_z += 0.4

distance_resultB -= 90.0

IF distance_resultB < 0.0
	distance_resultB += 360.0
ENDIF

REMOVE_BLIP	partners_blip
CREATE_CHAR PEDTYPE_CIVMALE PED_MALE1 vector_x vector_y partner_z rays_partner
SET_CHAR_HEADING rays_partner distance_resultB
SET_CHAR_STAY_IN_SAME_PLACE rays_partner TRUE
CLEAR_CHAR_THREAT_SEARCH rays_partner
ADD_ARMOUR_TO_CHAR rays_partner 100
SET_CHAR_WAIT_STATE rays_partner WAITSTATE_PLAYANIM_DUCK 1700

TIMERA = 0
WHILE TIMERA < 1200
	WAIT 0
	GOSUB object_placement
ENDWHILE

SWITCH_WIDESCREEN ON
SET_PLAYER_CONTROL player OFF
SET_EVERYONE_IGNORE_PLAYER player ON
SET_ALL_CARS_CAN_BE_DAMAGED FALSE
IF IS_PLAYER_IN_ANY_CAR player 
	IF IS_PLAYER_IN_MODEL player BOAT_PREDATOR
	OR IS_PLAYER_IN_MODEL player BOAT_REEFER
	OR IS_PLAYER_IN_MODEL player BOAT_GHOST
		MARK_CAR_AS_NO_LONGER_NEEDED players_boat_with_guns
		STORE_CAR_PLAYER_IS_IN player players_boat_with_guns
		ANCHOR_BOAT players_boat_with_guns TRUE
	ENDIF
	APPLY_BRAKES_TO_PLAYERS_CAR player ON
ENDIF

IF IS_CHAR_DEAD rays_partner
	GOTO mission_ray4_passed
ENDIF
IF IS_CAR_DEAD partners_boat
	GOTO mission_ray4_passed
ENDIF

GET_CAR_COORDINATES	partners_boat partner_x	partner_y partner_z
GET_CAR_FORWARD_X partners_boat partners_boat_forward_x
GET_CAR_FORWARD_Y partners_boat partners_boat_forward_y
temp_dot_product_x = -5.0  * partners_boat_forward_y  //change both of these to move on the vehicles x axis
temp_dot_product_y = 5.0 * partners_boat_forward_x //

temp_x = 3.8 * partners_boat_forward_x //change both of these to move on the vehicles y axis
temp_y = 3.8 * partners_boat_forward_y //

vector_x = temp_dot_product_x - temp_x
vector_y = temp_dot_product_y - temp_y

vector_x = vector_x + partner_x 
vector_y = vector_y + partner_y

partner_z += 2.0

SET_FIXED_CAMERA_POSITION vector_x vector_y partner_z 0.0 0.0 0.0
POINT_CAMERA_AT_CHAR rays_partner FIXED JUMP_CUT

TIMERA = 0
WHILE TIMERA < 1500
	WAIT 0
	GOSUB object_placement
ENDWHILE

IF IS_CHAR_DEAD rays_partner
	GOTO mission_ray4_passed
ENDIF
IF IS_CAR_DEAD partners_boat
	GOTO mission_ray4_passed
ENDIF

SET_CHAR_WAIT_STATE rays_partner WAITSTATE_CROSS_ROAD_LOOK 1600

GET_CAR_COORDINATES	partners_boat partner_x	partner_y partner_z
GET_CAR_FORWARD_X partners_boat partners_boat_forward_x
GET_CAR_FORWARD_Y partners_boat partners_boat_forward_y
temp_dot_product_x = 25.0  * partners_boat_forward_y  //change both of these to move on the vehicles x axis
temp_dot_product_y = -25.0 * partners_boat_forward_x //

temp_x = 1.8 * partners_boat_forward_x //change both of these to move on the vehicles y axis
temp_y = 1.8 * partners_boat_forward_y //

vector_x = temp_dot_product_x - temp_x
vector_y = temp_dot_product_y - temp_y

vector_x = vector_x + partner_x 
vector_y = vector_y + partner_y

partner_z = -2.0

TIMERA = 0
WHILE TIMERA < 1600
	WAIT 0
	GOSUB object_placement
ENDWHILE

IF IS_CHAR_DEAD rays_partner
	GOTO mission_ray4_passed
ENDIF

IF IS_CAR_DEAD partners_boat
	GOTO mission_ray4_passed
ENDIF

CREATE_CAR CAR_RCBANDIT vector_x vector_y partner_z fish_target
GIVE_WEAPON_TO_CHAR	rays_partner WEAPONTYPE_GRENADE 20
SET_CHAR_OBJ_NO_OBJ rays_partner
SET_CHAR_WAIT_STATE rays_partner WAITSTATE_FALSE 100
SET_CHAR_OBJ_DESTROY_CAR rays_partner fish_target
GET_CAR_COORDINATES	fish_target fish_target_x fish_target_y fish_target_z

partner_x =	fish_target_x -	2.0
partner_y =	fish_target_y -	2.0
partner_z =	fish_target_z -	2.0
temp_x += 2.0
vector_x += 2.0
vector_y += 1.0

WHILE NOT IS_PROJECTILE_IN_AREA partner_x partner_y partner_z temp_x vector_x vector_y // THE WINDOW
	WAIT 0

	GOSUB object_placement

	IF IS_CHAR_DEAD rays_partner
		GOTO mission_ray4_passed
	ENDIF

	IF IS_CAR_DEAD partners_boat
		GOTO mission_ray4_passed
	ENDIF

	IF IS_CAR_DEAD fish_target
	ENDIF

	SET_CAR_COORDINATES	fish_target	fish_target_x fish_target_y fish_target_z

ENDWHILE

SET_CHAR_OBJ_NO_OBJ rays_partner
DESTROY_PROJECTILES_IN_AREA partner_x partner_y partner_z temp_x vector_x vector_y

GET_CAR_COORDINATES	fish_target partner_x partner_y partner_z
partner_z += 1.0
fish_target_x =	partner_x
fish_target_y =	partner_y
fish_target_z =	partner_z
POINT_CAMERA_AT_POINT fish_target_x fish_target_y fish_target_z INTERPOLATION
DELETE_CAR fish_target

TIMERA = 0
WHILE TIMERA < 300
	WAIT 0
	GOSUB object_placement
ENDWHILE

partner_z = 0.0
ADD_EXPLOSION partner_x partner_y partner_z EXPLOSION_GRENADE
partner_z = 0.3
//ADD_PARTICLE_EFFECT POBJECT_CAR_WATER_SPLASH partner_x partner_y partner_z TRUE

IF IS_CAR_DEAD partners_boat
	GOTO mission_ray4_passed
ENDIF

GET_CAR_COORDINATES	partners_boat partner_x	partner_y partner_z
GET_CAR_FORWARD_X partners_boat partners_boat_forward_x
GET_CAR_FORWARD_Y partners_boat partners_boat_forward_y
temp_dot_product_x = 30.0  * partners_boat_forward_y  //change both of these to move on the vehicles x axis
temp_dot_product_y = -30.0 * partners_boat_forward_x //

temp_x = 2.2 * partners_boat_forward_x //change both of these to move on the vehicles y axis
temp_y = 2.2 * partners_boat_forward_y //

vector_x = temp_dot_product_x - temp_x
vector_y = temp_dot_product_y - temp_y

vector_x = vector_x + partner_x 
vector_y = vector_y + partner_y

partner_z += 1.5

TIMERA = 0
WHILE TIMERA < 1000
	WAIT 0
	GOSUB object_placement
ENDWHILE

fish_target_z -= 0.2
SET_FIXED_CAMERA_POSITION vector_x vector_y partner_z 0.0 0.0 0.0
POINT_CAMERA_AT_POINT fish_target_x fish_target_y fish_target_z JUMP_CUT

TIMERA = 0
WHILE TIMERA < 1500
	WAIT 0
	GOSUB object_placement
ENDWHILE

fish_target_z = -0.5
partner_x = fish_target_x
partner_y = fish_target_y
partner_z = fish_target_z

fish_target_x = partner_x - 0.2
fish_target_y = partner_y - 0.2
fish_target_z = partner_z

CREATE_OBJECT fish01 fish_target_x fish_target_y fish_target_z fishy_1
SET_OBJECT_DYNAMIC fishy_1 TRUE
ADD_TO_OBJECT_VELOCITY fishy_1 0.0 0.0 1.0
GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 temp_x
SET_OBJECT_HEADING fishy_1 temp_x

TIMERA = 0
WHILE TIMERA < 600
	WAIT 0
	GOSUB object_placement
ENDWHILE

fish_target_x += 0.9
fish_target_y += 0.3

GENERATE_RANDOM_FLOAT_IN_RANGE -4.0 2.0 temp_x
fish_target_x = partner_x + temp_x
GENERATE_RANDOM_FLOAT_IN_RANGE -3.0 3.0 temp_x
fish_target_y = partner_y + temp_x

CREATE_OBJECT fish01 fish_target_x fish_target_y fish_target_z fishy_2
SET_OBJECT_DYNAMIC fishy_2 TRUE
ADD_TO_OBJECT_VELOCITY fishy_2 0.0 0.0 1.0
GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 temp_x
SET_OBJECT_HEADING fishy_2 temp_x

TIMERA = 0
WHILE TIMERA < 200
	WAIT 0
	GOSUB object_placement
ENDWHILE

GENERATE_RANDOM_FLOAT_IN_RANGE -4.0 2.0 temp_x
fish_target_x = partner_x + temp_x
GENERATE_RANDOM_FLOAT_IN_RANGE -3.0 3.0 temp_x
fish_target_y = partner_y + temp_x

CREATE_OBJECT fish01 fish_target_x fish_target_y fish_target_z fishy_3
SET_OBJECT_DYNAMIC fishy_3 TRUE
ADD_TO_OBJECT_VELOCITY fishy_3 0.0 0.0 1.0
GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 temp_x
SET_OBJECT_HEADING fishy_3 temp_x

TIMERA = 0
WHILE TIMERA < 400
	WAIT 0
	GOSUB object_placement
ENDWHILE

GENERATE_RANDOM_FLOAT_IN_RANGE -4.0 2.0 temp_x
fish_target_x = partner_x + temp_x
GENERATE_RANDOM_FLOAT_IN_RANGE -3.0 3.0 temp_x
fish_target_y = partner_y + temp_x

CREATE_OBJECT fish01 fish_target_x fish_target_y fish_target_z fishy_4
SET_OBJECT_DYNAMIC fishy_4 TRUE
ADD_TO_OBJECT_VELOCITY fishy_4 0.0 0.0 1.0
GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 temp_x
SET_OBJECT_HEADING fishy_4 temp_x

TIMERA = 0
WHILE TIMERA < 100
	WAIT 0
	GOSUB object_placement
ENDWHILE

GENERATE_RANDOM_FLOAT_IN_RANGE -4.0 2.0 temp_x
fish_target_x = partner_x + temp_x
GENERATE_RANDOM_FLOAT_IN_RANGE -3.0 3.0 temp_x
fish_target_y = partner_y + temp_x

CREATE_OBJECT fish01 fish_target_x fish_target_y fish_target_z fishy_5
SET_OBJECT_DYNAMIC fishy_5 TRUE
ADD_TO_OBJECT_VELOCITY fishy_5 0.0 0.0 1.0
GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 temp_x
SET_OBJECT_HEADING fishy_5 temp_x

TIMERA = 0
WHILE TIMERA < 300
	WAIT 0
	GOSUB object_placement
ENDWHILE

GENERATE_RANDOM_FLOAT_IN_RANGE -4.0 2.0 temp_x
fish_target_x = partner_x + temp_x
GENERATE_RANDOM_FLOAT_IN_RANGE -3.0 3.0 temp_x
fish_target_y = partner_y + temp_x

CREATE_OBJECT fish01 fish_target_x fish_target_y fish_target_z fishy_6
SET_OBJECT_DYNAMIC fishy_6 TRUE
ADD_TO_OBJECT_VELOCITY fishy_6 0.0 0.0 1.0
GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 temp_x
SET_OBJECT_HEADING fishy_6 temp_x

TIMERA = 0
WHILE TIMERA < 200
	WAIT 0
	GOSUB object_placement
ENDWHILE

GENERATE_RANDOM_FLOAT_IN_RANGE -4.0 2.0 temp_x
fish_target_x = partner_x + temp_x
GENERATE_RANDOM_FLOAT_IN_RANGE -3.0 3.0 temp_x
fish_target_y = partner_y + temp_x

CREATE_OBJECT fish01 fish_target_x fish_target_y fish_target_z fishy_7
SET_OBJECT_DYNAMIC fishy_7 TRUE
ADD_TO_OBJECT_VELOCITY fishy_7 0.0 0.0 1.0
GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 temp_x
SET_OBJECT_HEADING fishy_7 temp_x

TIMERA = 0
WHILE TIMERA < 120
	WAIT 0
	GOSUB object_placement
ENDWHILE

GENERATE_RANDOM_FLOAT_IN_RANGE -4.0 2.0 temp_x
fish_target_x = partner_x + temp_x
GENERATE_RANDOM_FLOAT_IN_RANGE -3.0 3.0 temp_x
fish_target_y = partner_y + temp_x

CREATE_OBJECT fish01 fish_target_x fish_target_y fish_target_z fishy_8
SET_OBJECT_DYNAMIC fishy_8 TRUE
ADD_TO_OBJECT_VELOCITY fishy_8 0.0 0.0 1.0
GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 temp_x
SET_OBJECT_HEADING fishy_8 temp_x

TIMERA = 0
WHILE TIMERA < 70
	WAIT 0
	GOSUB object_placement
ENDWHILE

GENERATE_RANDOM_FLOAT_IN_RANGE -4.0 2.0 temp_x
fish_target_x = partner_x + temp_x
GENERATE_RANDOM_FLOAT_IN_RANGE -3.0 3.0 temp_x
fish_target_y = partner_y + temp_x

CREATE_OBJECT fish01 fish_target_x fish_target_y fish_target_z fishy_9
SET_OBJECT_DYNAMIC fishy_9 TRUE
ADD_TO_OBJECT_VELOCITY fishy_9 0.0 0.0 1.0
GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 temp_x
SET_OBJECT_HEADING fishy_9 temp_x

TIMERA = 0
WHILE TIMERA < 35
	WAIT 0
	GOSUB object_placement
ENDWHILE

GENERATE_RANDOM_FLOAT_IN_RANGE -4.0 2.0 temp_x
fish_target_x = partner_x + temp_x
GENERATE_RANDOM_FLOAT_IN_RANGE -3.0 3.0 temp_x
fish_target_y = partner_y + temp_x

CREATE_OBJECT fish01 fish_target_x fish_target_y fish_target_z fishy_10
SET_OBJECT_DYNAMIC fishy_10 TRUE
ADD_TO_OBJECT_VELOCITY fishy_10 0.0 0.0 1.0
GENERATE_RANDOM_FLOAT_IN_RANGE 0.0 359.9 temp_x
SET_OBJECT_HEADING fishy_10 temp_x

TIMERA = 0
WHILE TIMERA < 2500
	WAIT 0
	GOSUB object_placement
ENDWHILE

IF IS_CHAR_DEAD rays_partner
	GOTO mission_ray4_passed
ENDIF

POINT_CAMERA_AT_CHAR rays_partner FIXED INTERPOLATION

TIMERA = 0
WHILE TIMERA < 200
	WAIT 0
	GOSUB object_placement
ENDWHILE

IF IS_CAR_DEAD partners_boat
	GOTO mission_ray4_passed
ENDIF

GET_CAR_COORDINATES	partners_boat partner_x	partner_y partner_z
GET_CAR_FORWARD_X partners_boat partners_boat_forward_x
GET_CAR_FORWARD_Y partners_boat partners_boat_forward_y
temp_dot_product_x = 10.0  * partners_boat_forward_y  //change both of these to move on the vehicles x axis
temp_dot_product_y = -10.0 * partners_boat_forward_x //

temp_x = 2.2 * partners_boat_forward_x //change both of these to move on the vehicles y axis
temp_y = 2.2 * partners_boat_forward_y //

vector_x = temp_dot_product_x - temp_x
vector_y = temp_dot_product_y - temp_y

vector_x = vector_x + partner_x 
vector_y = vector_y + partner_y

partner_z += 2.0

fish_target_z -= 0.2
SET_FIXED_CAMERA_POSITION vector_x vector_y partner_z 0.0 0.0 0.0

TIMERA = 0
WHILE TIMERA < 800
	WAIT 0
	GOSUB object_placement
ENDWHILE

IF IS_CHAR_DEAD rays_partner
	GOTO mission_ray4_passed
ENDIF

CHAR_LOOK_AT_PLAYER_ALWAYS rays_partner player

TIMERA = 0
WHILE TIMERA < 600
	WAIT 0
	GOSUB object_placement
ENDWHILE

IF IS_CHAR_DEAD rays_partner
	GOTO mission_ray4_passed
ENDIF

STOP_CHAR_LOOKING rays_partner

IF IS_CHAR_DEAD rays_partner
	GOTO mission_ray4_passed
ENDIF

IF IS_CAR_DEAD partners_boat
	GOTO mission_ray4_passed
ENDIF

GET_CAR_COORDINATES	partners_boat partner_x	partner_y partner_z

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT	rays_partner partner_x	partner_y

TIMERA = 0
WHILE TIMERA < 1000
	WAIT 0
	GOSUB object_placement
ENDWHILE

IF IS_CHAR_DEAD rays_partner
	GOTO mission_ray4_passed
ENDIF

IF IS_CAR_DEAD partners_boat
	GOTO mission_ray4_passed
ENDIF

DELETE_CHAR	rays_partner
CREATE_CHAR_INSIDE_CAR partners_boat PEDTYPE_CIVMALE PED_MALE1 rays_partner
SET_CHAR_THREAT_SEARCH rays_partner THREAT_PLAYER1
SET_CHAR_PERSONALITY rays_partner PEDSTAT_TOUGH_GUY
SET_CHAR_HEALTH	rays_partner 300
ADD_BLIP_FOR_CHAR rays_partner partners_blip

SWITCH_WIDESCREEN OFF
SET_PLAYER_CONTROL player ON
SET_EVERYONE_IGNORE_PLAYER player FALSE
SET_ALL_CARS_CAN_BE_DAMAGED TRUE
APPLY_BRAKES_TO_PLAYERS_CAR player OFF
IF IS_CAR_STILL_ALIVE players_boat_with_guns
	ANCHOR_BOAT players_boat_with_guns FALSE
ENDIF
RESTORE_CAMERA

CREATE_CAR CAR_SENTINEL 1329.8947 -641.7307 11.1765	partners_car
SET_CAR_HEADING partners_car 180.8517

BOAT_GOTO_COORDS partners_boat node_2_x node_2_y 0.0
boat_node_x = node_2_x
boat_node_y	= node_2_y

GET_GAME_TIMER mine_current_timer
GET_GAME_TIMER last_mine_dropped_timer

GET_CAR_HEALTH partners_boat partners_boat_health
partners_boat_health = partners_boat_health - 250
partners_boat_health = partners_boat_health * 100
partners_boat_health = partners_boat_health / 750
partners_boat_health2 = partners_boat_health
partners_boat_health = 100 - partners_boat_health2
DISPLAY_ONSCREEN_COUNTER_WITH_STRING partners_boat_health COUNTER_DISPLAY_BAR DAM

boat_looop://///////////////////////////////////////////////////////////////////////////////

WAIT 0

IF IS_CHAR_DEAD rays_partner
	IF DOES_OBJECT_EXIST barrel2_a
		GET_OBJECT_COORDINATES barrel2_a fish_target_x fish_target_y fish_target_z
		ADD_EXPLOSION fish_target_x fish_target_y fish_target_z EXPLOSION_GRENADE
		DELETE_OBJECT barrel2_a
	ENDIF
	IF DOES_OBJECT_EXIST barrel2_b
		GET_OBJECT_COORDINATES barrel2_b fish_target_x fish_target_y fish_target_z
		ADD_EXPLOSION fish_target_x fish_target_y fish_target_z EXPLOSION_GRENADE
		DELETE_OBJECT barrel2_b
	ENDIF
	GOTO mission_ray4_passed
ENDIF

IF partner_on_foot_flag = -1
	IF NOT IS_CAR_DEAD partners_boat
		IF DOES_OBJECT_EXIST barrel2_a
		AND DOES_OBJECT_EXIST barrel2_b
			GOSUB object_placement
		ENDIF
	ENDIF
	IF TIMERA > 500
		TIMERA = 0
		IF IS_PLAYER_IN_ANY_CAR player
			MARK_CAR_AS_NO_LONGER_NEEDED players_boat_with_guns
			STORE_CAR_PLAYER_IS_IN player players_boat_with_guns
			SET_CHAR_ACCURACY rays_partner 100
			SET_CHAR_OBJ_DESTROY_CAR rays_partner players_boat_with_guns
		ELSE
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT rays_partner player
		ENDIF
	ENDIF
ENDIF

IF partner_on_foot_flag = 0
	IF NOT IS_CAR_DEAD partners_boat

		IF DOES_OBJECT_EXIST barrel2_a
		AND DOES_OBJECT_EXIST barrel2_b
			GOSUB object_placement
		ENDIF

		GOSUB boat_health_counter

		IF boat_node_counter > 0
			
			GOSUB drop_mines

			IF boat_speed_flag = 1
				IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D player partners_boat 100.0 100.0 0
					SET_BOAT_CRUISE_SPEED partners_boat 25.0
					boat_speed_flag = 0
				ENDIF
			ENDIF

			IF boat_speed_flag = 0
				IF LOCATE_PLAYER_ANY_MEANS_CAR_2D player partners_boat 80.0 80.0 0
					SET_BOAT_CRUISE_SPEED partners_boat 35.0
					boat_speed_flag = 1
				ENDIF
			ENDIF
		ENDIF

		IF NOT boat_node_counter = 0
			IF LOCATE_CAR_2D partners_boat boat_node_x boat_node_y 5.0 5.0 0
				GOSUB select_boat_node
				BOAT_GOTO_COORDS partners_boat boat_node_x boat_node_y 0.0
			ENDIF
		ENDIF
		
		IF boat_node_counter = 0
			IF DOES_OBJECT_EXIST barrel2_a
				GET_OBJECT_COORDINATES barrel2_a fish_target_x fish_target_y fish_target_z
				DELETE_OBJECT barrel2_a
				DROP_NAUTICAL_MINE fish_target_x fish_target_y fish_target_z
			ENDIF
			IF DOES_OBJECT_EXIST barrel2_b
				GET_OBJECT_COORDINATES barrel2_b fish_target_x fish_target_y fish_target_z
				DELETE_OBJECT barrel2_b
				DROP_NAUTICAL_MINE fish_target_x fish_target_y fish_target_z
			ENDIF
			IF IS_CHAR_STOPPED_IN_AREA_2D rays_partner 1364.1 -614.512 1473.801 -560.223 0
				GOSUB exit_boat
				partner_on_foot_flag = 1
			ENDIF
		ENDIF
			
		IF LOCATE_CAR_3D partners_boat partner_stuck_x partner_stuck_y partner_stuck_z 4.0 4.0 4.0 0
			IF timerc_reset_flag_r4 = 0
				GET_GAME_TIMER timerc_started_r4
				timerc_reset_flag_r4 = 1
			ENDIF

			IF timerc_reset_flag_r4 = 1
				GET_GAME_TIMER timerc_current_r4
				timerc_r4 = timerc_current_r4 - timerc_started_r4
				IF timerc_r4 > 8000
					IF IS_CHAR_IN_AREA_2D rays_partner 1608.0 -536.0 1684.0 -472.0 0//ROCKY ISLAND
						GOSUB exit_boat
						SET_CHAR_STAY_IN_SAME_PLACE	rays_partner TRUE
						IF IS_PLAYER_IN_ANY_CAR player
							MARK_CAR_AS_NO_LONGER_NEEDED players_boat_with_guns
							STORE_CAR_PLAYER_IS_IN player players_boat_with_guns
							SET_CHAR_ACCURACY rays_partner 100
							SET_CHAR_OBJ_DESTROY_CAR rays_partner players_boat_with_guns
						ELSE
							SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT rays_partner player
						ENDIF
						timerc_reset_flag_r4 = 1
						partner_on_foot_flag = -1
					ELSE
						GET_CAR_COORDINATES	partners_boat fish_target_x fish_target_y fish_target_z
						GET_GROUND_Z_FOR_3D_COORD fish_target_x fish_target_y fish_target_z	fish_target_z
						IF NOT fish_target_z = 0.0000
							GOSUB exit_boat
							SET_CHAR_STAY_IN_SAME_PLACE	rays_partner TRUE
							IF IS_PLAYER_IN_ANY_CAR player
								MARK_CAR_AS_NO_LONGER_NEEDED players_boat_with_guns
								STORE_CAR_PLAYER_IS_IN player players_boat_with_guns
								SET_CHAR_ACCURACY rays_partner 100
								SET_CHAR_OBJ_DESTROY_CAR rays_partner players_boat_with_guns
							ELSE
								SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT rays_partner player
							ENDIF
							timerc_reset_flag_r4 = 1
							partner_on_foot_flag = -1
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF

		IF NOT LOCATE_CAR_3D partners_boat partner_stuck_x partner_stuck_y partner_stuck_z 4.0 4.0 4.0 0
			GET_CAR_COORDINATES partners_boat partner_stuck_x partner_stuck_y partner_stuck_z
			timerc_reset_flag_r4 = 0
		ENDIF

	ELSE
		IF DOES_OBJECT_EXIST barrel2_a
			GET_OBJECT_COORDINATES barrel2_a fish_target_x fish_target_y fish_target_z
			ADD_EXPLOSION fish_target_x fish_target_y fish_target_z EXPLOSION_GRENADE
			DELETE_OBJECT barrel2_a
		ENDIF
		IF DOES_OBJECT_EXIST barrel2_b
			GET_OBJECT_COORDINATES barrel2_b fish_target_x fish_target_y fish_target_z
			ADD_EXPLOSION fish_target_x fish_target_y fish_target_z EXPLOSION_GRENADE
			DELETE_OBJECT barrel2_b
		ENDIF
	ENDIF
ENDIF

IF partner_on_foot_flag = 1

	GOSUB partner_escape_checks
	IF goto_mission_ray4_failed = 1
		GOTO mission_ray4_failed
	ENDIF

	IF partner_on_foot_counter = 0
		IF NOT IS_PLAYER_IN_AREA_2D player 1364.1 -614.512 1473.801 -560.223 0
			SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1453.4 -583.39
			shoot_at_player_flag = 1
		ELSE
			SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1365.7308 -617.1476
		ENDIF
		partner_on_foot_counter = 1
	ENDIF
	
	IF shoot_at_player_flag > 0
		IF shoot_at_player_flag = 1
			IF LOCATE_CHAR_ON_FOOT_2D rays_partner 1453.4 -583.39 1.0 1.0 0
				IF NOT IS_PLAYER_IN_AREA_2D player 1364.1 -614.512 1473.801 -560.223 0
					IF IS_PLAYER_IN_ANY_CAR	player
						MARK_CAR_AS_NO_LONGER_NEEDED players_boat_with_guns
						STORE_CAR_PLAYER_IS_IN player players_boat_with_guns
						SET_CHAR_ACCURACY rays_partner 100
						SET_CHAR_STAY_IN_SAME_PLACE rays_partner TRUE
						//SET_CHAR_HEED_THREATS rays_partner TRUE
						SET_CHAR_OBJ_DESTROY_CAR rays_partner players_boat_with_guns
					ENDIF
				ENDIF
				shoot_at_player_flag = 2
			ENDIF
		ENDIF

		IF shoot_at_player_flag = 2
			IF IS_PLAYER_IN_AREA_2D player 1364.1 -614.512 1473.801 -560.223 0
				SET_CHAR_STAY_IN_SAME_PLACE rays_partner FALSE
				//SET_CHAR_HEED_THREATS rays_partner FALSE
				SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1365.7308 -617.1476
				partner_on_foot_counter = 2
				shoot_at_player_flag = 0
			ENDIF
		ENDIF
	ENDIF

	IF NOT partners_boat_health = -1
		GET_CHAR_HEALTH	rays_partner partners_boat_health
		IF partners_boat_health < 250
			SET_CHAR_HEED_THREATS rays_partner TRUE
			partners_boat_health = -1
		ENDIF
	ENDIF

	IF partner_on_foot_counter = 1
		IF shoot_at_player_flag = 0
			IF LOCATE_CHAR_ON_FOOT_2D rays_partner 1365.7308 -617.1476 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1344.5702 -617.2876
				partner_on_foot_counter = 2
			ENDIF
		ENDIF
	ENDIF

	IF partner_on_foot_counter = 2
		IF LOCATE_CHAR_ON_FOOT_2D rays_partner 1344.5702 -617.2876 1.0 1.0 0
			SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1340.5314 -614.0313
			partner_on_foot_counter = 3
		ENDIF
	ENDIF

	IF partner_on_foot_counter = 3
		IF LOCATE_CHAR_ON_FOOT_2D rays_partner 1340.5314 -614.0313 1.0 1.0 0
			SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1336.6632 -616.9997
			partner_on_foot_counter = 4
		ENDIF
	ENDIF

	IF partner_on_foot_counter = 4
		IF LOCATE_CHAR_ON_FOOT_2D rays_partner 1336.6632 -616.9997 1.0 1.0 0
			SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1333.7664 -631.9993
			partner_on_foot_counter = 5
		ENDIF
	ENDIF

	IF partner_on_foot_counter = 5
		IF LOCATE_CHAR_ON_FOOT_2D rays_partner 1333.7664 -631.9993 1.0 1.0 0
			SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1332.7195 -636.8160
			partner_on_foot_counter = 6
		ENDIF
	ENDIF

	IF partner_on_foot_counter = 6
		IF LOCATE_CHAR_ON_FOOT_2D rays_partner 1332.7195 -636.8160 1.0 1.0 0
			IF IS_CAR_DEAD partners_car
				SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1331.7894 -678.1871
				partners_car_is_dead = 1
			ELSE
				SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER rays_partner partners_car
				partners_car_is_dead = -1
			ENDIF
			partner_on_foot_counter = 7
		ENDIF
	ENDIF

	IF partners_car_is_dead = 1
		IF partner_on_foot_counter = 7
			IF LOCATE_CHAR_ON_FOOT_2D rays_partner 1331.7894 -678.1871 1.0 1.0 0  
				SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1331.3925 -709.0771
				partner_on_foot_counter = 8
			ENDIF
		ENDIF

		IF partner_on_foot_counter = 8
			IF LOCATE_CHAR_ON_FOOT_2D rays_partner 1331.3925 -709.0771 1.0 1.0 0  
				SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1325.6399 -710.9251
				partner_on_foot_counter = 9
			ENDIF
		ENDIF

		IF partner_on_foot_counter = 9
			IF LOCATE_CHAR_ON_FOOT_2D rays_partner 1325.6399 -710.9251 1.0 1.0 0  
				SET_CHAR_OBJ_RUN_TO_COORD rays_partner 1309.8854 -695.2979
				partner_on_foot_counter = 10
			ENDIF
		ENDIF

		IF partner_on_foot_counter = 10
			IF LOCATE_CHAR_ON_FOOT_2D rays_partner 1309.8854 -695.2979 1.0 1.0 0  
				GOSUB steal_a_car
				partner_on_foot_counter = 11
			ENDIF
		ENDIF

		IF partner_on_foot_counter = 11
			IF IS_CHAR_IN_ANY_CAR rays_partner
				MARK_CAR_AS_NO_LONGER_NEEDED partners_car
				STORE_CAR_CHAR_IS_IN rays_partner partners_car
				SET_CAR_ONLY_DAMAGED_BY_PLAYER partners_car TRUE
				SET_CAR_CRUISE_SPEED partners_car 50.0
				SET_CAR_DRIVING_STYLE partners_car 2
				CAR_WANDER_RANDOMLY	partners_car
				SET_CAR_AVOID_LEVEL_TRANSITIONS partners_car TRUE
				SET_UPSIDEDOWN_CAR_NOT_DAMAGED partners_car TRUE
				partner_on_foot_flag = 2
			ENDIF
		ENDIF
	ENDIF

	IF partners_car_is_dead = -1
		IF partner_on_foot_counter = 7
			IF IS_CHAR_IN_ANY_CAR rays_partner
				MARK_CAR_AS_NO_LONGER_NEEDED partners_car
				STORE_CAR_CHAR_IS_IN rays_partner partners_car
				SET_CAR_ONLY_DAMAGED_BY_PLAYER partners_car TRUE
				SET_CAR_CRUISE_SPEED partners_car 30.0
				SET_CAR_DRIVING_STYLE partners_car 3
				CAR_GOTO_COORDINATES_ACCURATE partners_car 1331.2119 -662.4428 11.0086
				partner_on_foot_counter = 8
			ENDIF
		ENDIF

		IF NOT IS_CAR_DEAD partners_car
			IF partner_on_foot_counter = 8
				IF LOCATE_CHAR_IN_CAR_2D rays_partner 1331.2119 -662.4428 5.0 5.0 0
					CAR_GOTO_COORDINATES_ACCURATE partners_car 1331.2119 -685.2106 11.3431
					partner_on_foot_counter = 9
				ENDIF
			ENDIF

			IF partner_on_foot_counter = 9
				IF LOCATE_CHAR_IN_CAR_2D rays_partner 1331.2119 -685.2106 5.0 5.0 0
					CAR_GOTO_COORDINATES_ACCURATE partners_car 1331.0211 -696.5710 12.2865
					partner_on_foot_counter = 10
				ENDIF
			ENDIF

			IF partner_on_foot_counter = 10
				IF LOCATE_CHAR_IN_CAR_2D rays_partner 1331.0211 -696.5710 5.0 5.0 0
					CAR_GOTO_COORDINATES_ACCURATE partners_car 1331.3907 -715.4436 14.2220
					partner_on_foot_counter = 11
				ENDIF
			ENDIF

			IF partner_on_foot_counter = 11
				IF LOCATE_CHAR_IN_CAR_2D rays_partner 1331.3907 -715.4436 5.0 5.0 0
					MARK_CAR_AS_NO_LONGER_NEEDED partners_car
					STORE_CAR_CHAR_IS_IN rays_partner partners_car
					SET_CAR_ONLY_DAMAGED_BY_PLAYER partners_car TRUE
					SET_CAR_CRUISE_SPEED partners_car 50.0
					SET_CAR_DRIVING_STYLE partners_car 2
					CAR_WANDER_RANDOMLY	partners_car
					SET_CAR_AVOID_LEVEL_TRANSITIONS partners_car TRUE
					SET_UPSIDEDOWN_CAR_NOT_DAMAGED partners_car TRUE
					partner_on_foot_flag = 2
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
	IF IS_CHAR_IN_ANY_CAR rays_partner
	AND partner_on_foot_flag = 3
		MARK_CAR_AS_NO_LONGER_NEEDED partners_car
		STORE_CAR_CHAR_IS_IN rays_partner partners_car
		SET_CAR_ONLY_DAMAGED_BY_PLAYER partners_car TRUE
		SET_CAR_CRUISE_SPEED partners_car 50.0
		SET_CAR_DRIVING_STYLE partners_car 2
		CAR_WANDER_RANDOMLY	partners_car
		SET_CAR_AVOID_LEVEL_TRANSITIONS partners_car TRUE
		SET_UPSIDEDOWN_CAR_NOT_DAMAGED partners_car TRUE
		partner_on_foot_flag = 2
	ENDIF
		
	IF partner_on_foot_flag = 2
		IF NOT IS_CHAR_IN_ANY_CAR rays_partner
			GOSUB steal_a_car
			//SET_CHAR_HEED_THREATS rays_partner TRUE
			partner_on_foot_flag = 3
		ENDIF
	ENDIF
	
	IF partner_on_foot_flag = 2
		IF NOT IS_CAR_DEAD partners_car
			IF TIMERB > 1000
				TIMERB = 0
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player rays_partner 30.0 30.0 0
					SET_CAR_CRUISE_SPEED partners_car 50.0
				ELSE
					IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player rays_partner 80.0 80.0 0
						SET_CAR_CRUISE_SPEED partners_car 40.0
					ELSE
						SET_CAR_CRUISE_SPEED partners_car 30.0
					ENDIF
				ENDIF
			ENDIF
			
			IF IS_CAR_STOPPED partners_car
				IF timer_reset_flag_r4 = 0
					TIMERA = 0
					timer_reset_flag_r4 = 1
				ENDIF

				IF TIMERA > 8000
				AND timer_reset_flag_r4 = 1
					IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player rays_partner 120.0 120.0 0
						SET_CHAR_OBJ_LEAVE_CAR rays_partner partners_car
						timer_reset_flag_r4 = 0
					ELSE
						IF NOT IS_CAR_ON_SCREEN partners_car
							GET_CAR_COORDINATES partners_car partner_x partner_y partner_z
							GET_CLOSEST_CAR_NODE_WITH_HEADING partner_x partner_y partner_z partner_x partner_y partner_z distance_between_boats
							IF NOT IS_POINT_ON_SCREEN partner_x partner_y partner_z 4.0
								SET_CAR_COORDINATES partners_car partner_x partner_y partner_z
								SET_CAR_HEADING	partners_car distance_between_boats
								timer_reset_flag_r4 = 0
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF
					
			IF IS_CAR_UPSIDEDOWN partners_car
			AND IS_CAR_STOPPED partners_car
				IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player rays_partner 120.0 120.0 0
					SET_CHAR_OBJ_LEAVE_CAR rays_partner partners_car
					SET_UPSIDEDOWN_CAR_NOT_DAMAGED partners_car FALSE
				ELSE
					IF NOT IS_CAR_ON_SCREEN partners_car
						GET_CAR_COORDINATES partners_car partner_x partner_y partner_z
						GET_CLOSEST_CAR_NODE_WITH_HEADING partner_x partner_y partner_z partner_x partner_y partner_z distance_between_boats
						IF NOT IS_POINT_ON_SCREEN partner_x partner_y partner_z 4.0
							SET_CAR_COORDINATES partners_car partner_x partner_y partner_z
							SET_CAR_HEADING	partners_car distance_between_boats
						ENDIF
					ENDIF
				ENDIF
			ENDIF

			IF LOCATE_CAR_3D partners_car partner_stuck_x partner_stuck_y partner_stuck_z 4.0 4.0 4.0 0
				IF timerc_reset_flag_r4 = 0
					GET_GAME_TIMER timerc_started_r4
					timerc_reset_flag_r4 = 1
				ENDIF

				IF timerc_reset_flag_r4 = 1
					GET_GAME_TIMER timerc_current_r4
					timerc_r4 = timerc_current_r4 - timerc_started_r4
					IF timerc_r4 > 8000
						IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player rays_partner 120.0 120.0 0
							SET_CHAR_OBJ_LEAVE_CAR rays_partner partners_car
							timerc_reset_flag_r4 = 0
						ELSE
							GET_CAR_COORDINATES partners_car partner_x partner_y partner_z
							GET_CLOSEST_CAR_NODE_WITH_HEADING partner_x partner_y partner_z partner_x partner_y partner_z distance_between_boats
							IF NOT IS_POINT_OBSCURED_BY_A_MISSION_ENTITY partner_x partner_y partner_z 4.0 4.0 4.0
								IF NOT IS_POINT_ON_SCREEN partner_x partner_y partner_z 4.0
									SET_CAR_COORDINATES partners_car partner_x partner_y partner_z
									SET_CAR_HEADING	partners_car distance_between_boats
									timerc_reset_flag_r4 = 0
								ENDIF
							ENDIF
						ENDIF
					ENDIF
				ENDIF
			ENDIF

			IF NOT LOCATE_CAR_3D partners_car partner_stuck_x partner_stuck_y partner_stuck_z 4.0 4.0 4.0 0
				GET_CAR_COORDINATES partners_car partner_stuck_x partner_stuck_y partner_stuck_z
				timerc_reset_flag_r4 = 0
			ENDIF

			IF NOT IS_CAR_HEALTH_GREATER partners_car 400
				SET_CHAR_OBJ_LEAVE_CAR rays_partner partners_car
			ENDIF
		ENDIF
	ENDIF 
ENDIF 

GOTO boat_looop/////////////////////////////////////////////////////////////////////////////


// Mission Ray4 failed

mission_ray4_failed:
PRINT_BIG M_FAIL 5000 1
RETURN

   

// mission Ray4 passed

mission_ray4_passed:

flag_ray_mission4_passed = 1
PRINT_WITH_NUMBER_BIG M_PASS 15000 2000 1
ADD_SCORE player 15000
CLEAR_WANTED_LEVEL player
REGISTER_MISSION_PASSED	RM4
PLAY_MISSION_PASSED_TUNE 1
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT ray_mission5_loop
RETURN
		


// mission cleanup

mission_cleanup_ray4:
					 
REMOVE_BLIP partners_blip
REMOVE_BLIP players_boat_with_guns_blip
CLEAR_ONSCREEN_COUNTER partners_boat_health
MARK_MODEL_AS_NO_LONGER_NEEDED BOAT_PREDATOR
MARK_MODEL_AS_NO_LONGER_NEEDED BOAT_GHOST
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SENTINEL
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_RCBANDIT
flag_player_on_mission = 0
flag_player_on_ray_mission = 0
MISSION_HAS_FINISHED
RETURN
		

object_placement:///////////////////////////////////////////////////////////////////////

IF NOT IS_CAR_DEAD partners_boat
	PLACE_OBJECT_RELATIVE_TO_CAR barrel2_a partners_boat -0.5 -3.8 1.1
	PLACE_OBJECT_RELATIVE_TO_CAR barrel2_b partners_boat 0.5 -3.8 1.1
ENDIF

RETURN//////////////////////////////////////////////////////////////////////////////////


drop_mines://///////////////////////////////////////////////////////////////////////////

	GET_GAME_TIMER mine_current_timer
	temporary_time_mine = mine_current_timer - last_mine_dropped_timer
	IF temporary_time_mine > 2000
		GENERATE_RANDOM_INT_IN_RANGE 0 4 random_int
		GET_GAME_TIMER last_mine_dropped_timer
		IF random_int = 2
			GET_CAR_SPEED partners_boat partners_boat_speed
			
			GET_PLAYER_COORDINATES player player_x player_y player_z
			
			GET_CAR_COORDINATES	partners_boat partner_x	partner_y partner_z
			IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player rays_partner 5.0 5.0 0
				IF partners_boat_speed > 12.0
					vector_x = partner_x - player_x
					vector_y = partner_y - player_y
					temp_vector_x = vector_x * vector_x
					temp_vector_y = vector_y * vector_y
					temp_distance = temp_vector_x + temp_vector_y
					SQRT temp_distance distance_between_boats
					
					IF distance_between_boats < 60.0
						GET_CAR_FORWARD_X partners_boat partners_boat_forward_x
						GET_CAR_FORWARD_Y partners_boat partners_boat_forward_y
						vector_x = vector_x / distance_between_boats
						vector_y = vector_y / distance_between_boats
						temp_dot_product_x = vector_x * partners_boat_forward_x
						temp_dot_product_y = vector_y * partners_boat_forward_y
						dot_product	= temp_dot_product_x + temp_dot_product_y
						
						IF dot_product > -0.5 
							DROP_NAUTICAL_MINE partner_x partner_y partner_z
							temp_x = partner_x
							temp_y = partner_y
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN//////////////////////////////////////////////////////////////////////////////////


exit_boat://////////////////////////////////////////////////////////////////////////////

	IF exit_boat_flag = 0
		BOAT_STOP partners_boat
		GET_CAR_COORDINATES	partners_boat partner_x	partner_y partner_z
		GET_CAR_FORWARD_X partners_boat partners_boat_forward_x
		GET_CAR_FORWARD_Y partners_boat partners_boat_forward_y

		temp_dot_product_x = 3.0 * partners_boat_forward_y  //change both of these to move on the vehicles x axis
		temp_dot_product_y = -3.0 * partners_boat_forward_x //

		temp_x = 0.3 * partners_boat_forward_x //change both of these to move on the vehicles y axis
		temp_y = 0.3 * partners_boat_forward_y //

		vector_x = temp_dot_product_x - temp_x
		vector_y = temp_dot_product_y - temp_y

		vector_x = vector_x + partner_x 
		vector_y = vector_y + partner_y

		temp_dot_product_x = -3.0 * partners_boat_forward_y //change both of these to move on the vehicles x axis
		temp_dot_product_y = 3.0 * partners_boat_forward_x  //

		temp_x = 0.3 * partners_boat_forward_x //change both of these to move on the vehicles y axis
		temp_y = 0.3 * partners_boat_forward_y //

		temp_vector_x = temp_dot_product_x - temp_x
		temp_vector_y = temp_dot_product_y - temp_y

		temp_vector_x = temp_vector_x + partner_x 
		temp_vector_y = temp_vector_y + partner_y

		GET_PLAYER_COORDINATES player sniper_object_a_x sniper_object_a_y dot_product

		partner_x = sniper_object_a_x - vector_x
		partner_y = sniper_object_a_y - vector_y
		partner_x = partner_x * partner_x
		partner_y = partner_y * partner_y
		dot_product = partner_x + partner_y
		SQRT dot_product distance_resultA

		partner_x = sniper_object_a_x - temp_vector_x
		partner_y = sniper_object_a_y - temp_vector_y
		partner_x = partner_x * partner_x
		partner_y = partner_y * partner_y
		dot_product = partner_x + partner_y
		SQRT dot_product distance_resultB

		IF distance_resultA	< distance_resultB
			GET_GROUND_Z_FOR_3D_COORD vector_x vector_y partner_z dot_product //temp_x
			temp_x = partner_z + 15.0
			GET_GROUND_Z_FOR_3D_COORD vector_x vector_y temp_x temp_x
			IF temp_x > dot_product
				dot_product = temp_x + 1.0
			ENDIF
			IF NOT dot_product = 0.0000
				WARP_CHAR_FROM_CAR_TO_COORD	rays_partner vector_x vector_y partner_z
				SET_CHAR_HEADING rays_partner 90.0
			ELSE
				WARP_CHAR_FROM_CAR_TO_COORD	rays_partner temp_vector_x temp_vector_y partner_z
				SET_CHAR_HEADING rays_partner 90.0
			ENDIF
		ELSE
			GET_GROUND_Z_FOR_3D_COORD temp_vector_x temp_vector_y partner_z dot_product
			IF NOT dot_product = 0.0000
				WARP_CHAR_FROM_CAR_TO_COORD	rays_partner temp_vector_x temp_vector_y partner_z
				SET_CHAR_HEADING rays_partner 90.0
			ELSE
				WARP_CHAR_FROM_CAR_TO_COORD	rays_partner vector_x vector_y partner_z
				SET_CHAR_HEADING rays_partner 90.0
			ENDIF
		ENDIF
		GIVE_WEAPON_TO_CHAR rays_partner WEAPONTYPE_CHAINGUN 9999
		SET_CHAR_RUNNING rays_partner TRUE
		CLEAR_ONSCREEN_COUNTER partners_boat_health
		exit_boat_flag = 1
	ENDIF

RETURN//////////////////////////////////////////////////////////////////////////////////


boat_health_counter:////////////////////////////////////////////////////////////////////

	GET_CAR_HEALTH partners_boat partners_boat_health
	partners_boat_health = partners_boat_health - 250
	partners_boat_health = partners_boat_health * 100
	partners_boat_health = partners_boat_health / 750
	partners_boat_health2 = partners_boat_health
	partners_boat_health = 100 - partners_boat_health2

RETURN//////////////////////////////////////////////////////////////////////////////////


steal_a_car:////////////////////////////////////////////////////////////////////////////

	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player rays_partner 100.0 100.0 0
		SET_CHAR_OBJ_STEAL_ANY_CAR rays_partner
	ELSE
		GET_CLOSEST_CAR_NODE_WITH_HEADING 1309.8854 -695.2979 15.3830 partner_x	partner_y partner_z dot_product
		MARK_CAR_AS_NO_LONGER_NEEDED partners_car
		CREATE_CAR CAR_SENTINEL	partner_x partner_y partner_z partners_car
		SET_CAR_HEADING	partners_car dot_product
		SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER rays_partner partners_car
	ENDIF

RETURN//////////////////////////////////////////////////////////////////////////////////

select_boat_node:///////////////////////////////////////////////////////////////////////

	IF boat_node_counter = 1
		IF partners_boat_health < 50
			boat_node_x = node_11_x
			boat_node_y = node_11_y
			boat_node_counter = 11
		ELSE
			boat_node_x = node_2_x
			boat_node_y = node_2_y
			boat_node_counter = 2
		ENDIF
		RETURN
	ENDIF

	IF boat_node_counter = 2
		boat_node_x = node_3_x
		boat_node_y	= node_3_y
		boat_node_counter = 3
		RETURN
	ENDIF

	IF boat_node_counter = 3
		IF partners_boat_health < 50
			boat_node_x = node_4_x
			boat_node_y	= node_4_y
			boat_node_counter = 4
		ELSE
			boat_node_x = node_0_x
			boat_node_y	= node_0_y
			boat_node_counter = 0
			SET_BOAT_CRUISE_SPEED partners_boat 35.0
			boat_speed_flag = -100
		ENDIF
		RETURN
	ENDIF

	IF boat_node_counter = 4
		boat_node_x = node_5_x
		boat_node_y = node_5_y
		boat_node_counter = 5
		RETURN
	ENDIF

	IF boat_node_counter = 5
		boat_node_x = node_6_x
		boat_node_y = node_6_y
		boat_node_counter = 6
		RETURN
	ENDIF

	IF boat_node_counter = 6
		boat_node_x = node_7_x
		boat_node_y = node_7_y
		boat_node_counter = 7
		RETURN
	ENDIF

	IF boat_node_counter = 7
		IF partners_boat_health < 50
			boat_node_x = node_8_x
			boat_node_y = node_8_y
			boat_node_counter = 8
		ELSE
			boat_node_x = node_3_x
			boat_node_y = node_3_y
			boat_node_counter = 3
		ENDIF
		RETURN
	ENDIF

	IF boat_node_counter = 8
		IF partners_boat_health < 50
			boat_node_x = node_1_x
			boat_node_y = node_1_y
			boat_node_counter = 1
		ELSE
			boat_node_x = node_3_x
			boat_node_y = node_3_y
			boat_node_counter = 3
		ENDIF
		RETURN
	ENDIF

	IF boat_node_counter = 9
		IF partners_boat_health < 50
			boat_node_x = node_2_x
			boat_node_y = node_2_y
			boat_node_counter = 2
		ELSE
			boat_node_x = node_8_x
			boat_node_y = node_8_y
			boat_node_counter = 8
		ENDIF
		RETURN
	ENDIF

	IF boat_node_counter = 10
		boat_node_x = node_9_x
		boat_node_y = node_9_y
		boat_node_counter = 9
		RETURN
	ENDIF

	IF boat_node_counter = 11
		boat_node_x = node_10_x
		boat_node_y = node_10_y
		boat_node_counter = 10
		RETURN
	ENDIF

RETURN//////////////////////////////////////////////////////////////////////////////////


partner_escape_checks://////////////////////////////////////////////////////////////////
	
	IF NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player rays_partner 160.0 160.0 0
	AND NOT IS_CHAR_ON_SCREEN rays_partner
		IF gotaway_timer_reset_flag = 0
			REMOVE_BLIP	partners_blip
			GET_GAME_TIMER gotaway_timer_started
			gotaway_timer_reset_flag = 1
		ENDIF

		IF gotaway_timer_reset_flag = 1
			GET_GAME_TIMER gotaway_timer_current
			gotaway_timer = gotaway_timer_current - gotaway_timer_started
			IF gotaway_timer > 8000
				IF NOT IS_CHAR_ON_SCREEN rays_partner
					gotaway_timer_reset_flag = 0
					DELETE_CHAR rays_partner
					PRINT_NOW RM4_3 5000 1 //"Ray's partner has escaped!"
					goto_mission_ray4_failed = 1
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF gotaway_timer_reset_flag = 1
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player rays_partner 160.0 160.0 0
		OR IS_CHAR_ON_SCREEN rays_partner
			REMOVE_BLIP	partners_blip
			ADD_BLIP_FOR_CHAR rays_partner partners_blip
			gotaway_timer_reset_flag = 0
		ENDIF
	ENDIF

RETURN//////////////////////////////////////////////////////////////////////////////////
}
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************Ray mission 5******************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_ray5
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_ray5_failed
ENDIF
GOSUB mission_cleanup_ray5
MISSION_END
 
// Variables for mission

VAR_INT ambulance_rc5 ambulance_health flag_redalert

VAR_INT injured_cop_rc5 cop_driver bodycast_health
VAR_INT swat1_rc5 swat2_rc5 swat3_rc5 swat4_rc5
VAR_INT swatvan1 swatvan2
VAR_INT blip_ambulance_rc5 flag_bodycast_clear flag_police_trigger

VAR_INT blip_injured_cop_rc5 zed_value random_ray5 flag_random_ray5

VAR_FLOAT amb_rc5_x amb_rc5_y amb_rc5_z
VAR_FLOAT ic_x ic_y ic_z

// ****************************************Mission Start************************************

mission_start_ray5:
REGISTER_MISSION_GIVEN

// objective is following a car, dont path here
DISPLAY_RADAR 2 // PATHING OFF

SCRIPT_NAME ray5 
flag_player_on_mission = 1
flag_player_on_ray_mission = 1

rays_cutscene_flag = 1

WAIT 0

//PRINT_BIG ( RM5 ) 15000 2


flag_bodycast_clear = 0
flag_redalert = 0
flag_random_ray5 = 0
flag_police_trigger = 0

flag_audio = 0

ambulance_health = 0


// ****************************************START OF CUTSCENE********************************
//SET_PLAYER_CONTROL player OFF
//SWITCH_WIDESCREEN ON

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_ray5_failed
ENDIF
 
SET_FADING_COLOUR 0 0 0
 
DO_FADE 250 FADE_OUT
 
PRINT_BIG RM5 15000 2 //"Plaster Blaster"

SWITCH_STREAMING OFF
*/
 
LOAD_SPECIAL_CHARACTER 1 ray
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 RAYH
REQUEST_MODEL toilet

/*
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
*/

LOAD_ALL_MODELS_NOW
 
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED toilet
 WAIT 0
ENDWHILE

//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 47.322 -732.055 22.846 4.0 toilet_cubicle_dr2 FALSE
 
LOAD_CUTSCENE r5_pb

SWITCH_STREAMING ON
 
SET_CUTSCENE_OFFSET 39.424 -726.677 21.692
 
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player
 
CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_ray
SET_CUTSCENE_ANIM cs_ray ray
 
CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player
 
CREATE_CUTSCENE_HEAD cs_ray CUT_OBJ2 cs_rayhead
SET_CUTSCENE_HEAD_ANIM cs_rayhead ray
 
//CREATE_CUTSCENE_OBJECT cut_obj3 cs_ludoor
//SET_CUTSCENE_ANIM cs_ludoor LUDOOR
 
//SET_PLAYER_COORDINATES player 38.7 -725.7 22.0
 
//SET_PLAYER_HEADING player 270.0

CLEAR_AREA 39.0 -723.5 22.0 1.0 TRUE

SET_PLAYER_COORDINATES player 39.0 -723.5 22.0

SET_PLAYER_HEADING player 90.0
 
DO_FADE 1500 FADE_IN
//SET_NEAR_CLIP 0.2

 
START_CUTSCENE
SWITCH_RUBBISH OFF
 
// Displays cutscene text
 
GET_CUTSCENE_TIME cs_time
 
WHILE cs_time < 919
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW RM5_A 2000 1 //"You useless bastard!"

 
WHILE cs_time < 3082
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW RM5_A1 4500 1 //"You messed up! My ass is on the line and you can't hurt a god damned fly."
 
WHILE cs_time < 7840
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW RM5_B 3000 1 //"I paid you good money to kill that witness and he ain't dead!"

WHILE cs_time < 10868
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW RM5_B1 2000 1 //"And today he's gonna make a Federal Deposition!"
 
WHILE cs_time < 13138
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW RM5_C 4000 1 //"He's being moved any second now from the Carson General Hospital up in Rockford.

WHILE cs_time < 17626
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM5_D 2500 1 //"so go do the job you were paid for!"
 
WHILE cs_time < 24333
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
DO_FADE 1500 FADE_OUT
 
WHILE NOT HAS_CUTSCENE_FINISHED
 WAIT 0
ENDWHILE
 
 
CLEAR_PRINTS

WHILE GET_FADING_STATUS
 WAIT 0
ENDWHILE
 
CLEAR_CUTSCENE
 
DO_FADE 0 FADE_OUT
 
SET_CAMERA_BEHIND_PLAYER
 
WAIT 500
 
DO_FADE 1500 FADE_IN 
//SET_NEAR_CLIP 0.9
 
//WHILE GET_FADING_STATUS
// WAIT 0
//ENDWHILE
 
//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 47.322 -732.055 22.846 4.0 toilet_cubicle_dr2 TRUE
 
UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED toilet

//SET_PLAYER_CONTROL player ON
//SWITCH_WIDESCREEN OFF
SWITCH_STREAMING ON
SWITCH_RUBBISH ON
 
rays_cutscene_flag = 0
// ******************************************END OF CUTSCENE********************************


REQUEST_MODEL CAR_AMBULANCE
REQUEST_MODEL CAR_ENFORCER
REQUEST_MODEL PED_COP
REQUEST_MODEL PED_SWAT
WHILE NOT HAS_MODEL_LOADED  CAR_AMBULANCE
OR NOT HAS_MODEL_LOADED PED_COP
OR NOT HAS_MODEL_LOADED PED_SWAT
OR NOT HAS_MODEL_LOADED CAR_ENFORCER
	WAIT 0
ENDWHILE


// Mission stuff goes here
CREATE_CAR CAR_ENFORCER 417.8 -1064.0 26.4 swatvan1
SET_CAR_HEADING	swatvan1 50.0
CAR_SET_IDLE swatvan1
SWITCH_CAR_SIREN swatvan1 ON

CREATE_CAR CAR_ENFORCER 335.4 -1185.2 26.4 swatvan2
SET_CAR_HEADING	swatvan2 150.0
CAR_SET_IDLE swatvan2
SWITCH_CAR_SIREN swatvan2 ON

CREATE_CHAR PEDTYPE_CIVMALE PED_SWAT 414.6 -1060.3 26.2 swat1_rc5
SET_CHAR_HEADING swat1_rc5 0.0
CLEAR_CHAR_THREAT_SEARCH swat1_rc5
SET_CHAR_THREAT_SEARCH swat1_rc5 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR swat1_rc5 WEAPONTYPE_M16 100
SET_CURRENT_CHAR_WEAPON swat1_rc5 WEAPONTYPE_M16
SET_CHAR_STAY_IN_SAME_PLACE swat1_rc5 true
ADD_ARMOUR_TO_CHAR swat1_rc5 100

CREATE_CHAR PEDTYPE_CIVMALE PED_SWAT 365.0 -1146.7 23.0 swat2_rc5
SET_CHAR_HEADING swat2_rc5 270.0
CLEAR_CHAR_THREAT_SEARCH swat2_rc5
SET_CHAR_THREAT_SEARCH swat2_rc5 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR swat2_rc5 WEAPONTYPE_M16 100
SET_CURRENT_CHAR_WEAPON swat2_rc5 WEAPONTYPE_M16
SET_CHAR_STAY_IN_SAME_PLACE swat2_rc5 true
ADD_ARMOUR_TO_CHAR swat2_rc5 100

CREATE_CHAR PEDTYPE_CIVMALE PED_SWAT 331.5 -1184.1 26.2 swat3_rc5
SET_CHAR_HEADING swat3_rc5 100.0
CLEAR_CHAR_THREAT_SEARCH swat3_rc5
SET_CHAR_THREAT_SEARCH swat3_rc5 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR swat3_rc5 WEAPONTYPE_M16 100
SET_CURRENT_CHAR_WEAPON swat3_rc5 WEAPONTYPE_M16
SET_CHAR_STAY_IN_SAME_PLACE swat3_rc5 true
ADD_ARMOUR_TO_CHAR swat3_rc5 100

CREATE_CHAR PEDTYPE_CIVMALE PED_SWAT 336.0 -1122.0 26.0 swat4_rc5
SET_CHAR_HEADING swat4_rc5 230.0
CLEAR_CHAR_THREAT_SEARCH swat4_rc5
SET_CHAR_THREAT_SEARCH swat4_rc5 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR swat4_rc5 WEAPONTYPE_M16 100
SET_CURRENT_CHAR_WEAPON swat4_rc5 WEAPONTYPE_M16
SET_CHAR_STAY_IN_SAME_PLACE swat4_rc5 true
ADD_ARMOUR_TO_CHAR swat4_rc5 100

LOAD_MISSION_AUDIO R5_A

amb_generator:

ambulance_health = 0
DISPLAY_ONSCREEN_COUNTER_WITH_STRING ambulance_health COUNTER_DISPLAY_BAR DAM

CREATE_CAR CAR_AMBULANCE 387.3 4.5 11.4 ambulance_rc5
ADD_BLIP_FOR_CAR ambulance_rc5 blip_ambulance_rc5
CREATE_CHAR_INSIDE_CAR ambulance_rc5 PEDTYPE_COP PED_COP cop_driver
LOCK_CAR_DOORS ambulance_rc5 CARLOCK_LOCKED
SET_CAR_HEADING ambulance_rc5 166.0
SET_CAR_CRUISE_SPEED ambulance_rc5 20.0
SET_CAR_DRIVING_STYLE ambulance_rc5 0
SET_CAR_ONLY_DAMAGED_BY_PLAYER ambulance_rc5 true
//SWITCH_CAR_SIREN ambulance_rc5 ON
GET_CAR_HEALTH ambulance_rc5 ambulance_health
GENERATE_RANDOM_INT random_ray5

IF random_ray5 < 21846
	CAR_GOTO_COORDINATES ambulance_rc5 -148.93 18.04 26.5
ENDIF

IF random_ray5 > 21845
AND random_ray5 < 43691
	CAR_GOTO_COORDINATES ambulance_rc5 402.88 -404.88 26.5
	flag_random_ray5 = 1
ENDIF

IF random_ray5 > 43690
	CAR_GOTO_COORDINATES ambulance_rc5 -13.2 -804.7 26.5
	flag_random_ray5 = 2
ENDIF


//-----ambulance travels to one of three way points


WHILE flag_redalert = 0
	WAIT 0
	IF NOT IS_CAR_DEAD ambulance_rc5
		GET_CAR_COORDINATES ambulance_rc5 amb_rc5_x amb_rc5_y amb_rc5_z
		GET_CAR_HEALTH ambulance_rc5 ambulance_health
		ambulance_health = ambulance_health * -1
		ambulance_health = ambulance_health + 1000
		//ambulance_health = ambulance_health / 10
		//ambulance_health = ambulance_health * 5

		IF flag_random_ray5 = 0
			IF LOCATE_CAR_2D ambulance_rc5 -148.93 18.04 15.0 15.0 false
				CAR_GOTO_COORDINATES ambulance_rc5 405.2 -1137.7 26.0 //---amb goto penultimate waypoint
				flag_random_ray5 = 3
			ENDIF
		ENDIF
		
		IF flag_random_ray5 = 1
			IF LOCATE_CAR_2D ambulance_rc5 402.88 -404.88 15.0 15.0 false
				CAR_GOTO_COORDINATES ambulance_rc5 405.2 -1137.7 26.0 //---amb goto penultimate waypoint
				flag_random_ray5 = 3
			ENDIF
		ENDIF
		
		IF flag_random_ray5 = 2
			IF LOCATE_CAR_2D ambulance_rc5 -13.2 -804.7 15.0 15.0 false
				CAR_GOTO_COORDINATES ambulance_rc5 405.2 -1137.7 26.0 //---amb goto penultimate waypoint
				flag_random_ray5 = 3
			ENDIF
		ENDIF
		
		IF flag_random_ray5 = 3
			IF LOCATE_CAR_2D ambulance_rc5 405.2 -1137.7 15.0 15.0 false
				flag_redalert = 1
				CAR_GOTO_COORDINATES ambulance_rc5 362.0 -1138.0 23.0 //----amb goto final destination
				SET_CAR_CRUISE_SPEED ambulance_rc5 15.0
				SET_CAR_DRIVING_STYLE ambulance_rc5 0
			ENDIF
		ENDIF

		IF IS_CAR_ON_SCREEN ambulance_rc5
			SET_CAR_ONLY_DAMAGED_BY_PLAYER ambulance_rc5 false
		ELSE
			SET_CAR_ONLY_DAMAGED_BY_PLAYER ambulance_rc5 true
		ENDIF
	
	ELSE
		PRINT_NOW (RM5_3) 2500 1 //---ambulance was decoy!!
		MARK_CAR_AS_NO_LONGER_NEEDED ambulance_rc5
		MARK_CHAR_AS_NO_LONGER_NEEDED cop_driver
		REMOVE_BLIP blip_ambulance_rc5
		CLEAR_ONSCREEN_COUNTER ambulance_health
		flag_random_ray5 = 0
		flag_police_trigger = 0
		GOTO amb_generator
	ENDIF

	IF LOCATE_PLAYER_ANY_MEANS_2D player amb_rc5_x amb_rc5_y 25.0 25.0 false //---player taken the bait ---police close in
		IF NOT IS_CAR_DEAD ambulance_rc5
			PRINT_NOW (RM5_2) 3000 1
			SET_CAR_CRUISE_SPEED ambulance_rc5 28.0
			SET_CAR_DRIVING_STYLE ambulance_rc5 3
			CAR_GOTO_COORDINATES ambulance_rc5 405.2 -1137.7 26.0
			PLAY_MISSION_AUDIO
			SWITCH_CAR_SIREN ambulance_rc5 ON
			ALTER_WANTED_LEVEL_NO_DROP player 2 
			flag_redalert = 1
			flag_police_trigger = 1
		ENDIF
	ENDIF
	
	GOSUB swat_team

ENDWHILE

//------either; player has 'been spotted'-police despatched
//------OR; ambulance has reached penultimate way point

WHILE flag_redalert = 1
	WAIT 0
	
	IF NOT IS_CAR_DEAD ambulance_rc5
		GET_CAR_HEALTH ambulance_rc5 ambulance_health
		ambulance_health = ambulance_health * -1
		ambulance_health = ambulance_health + 1000
		//ambulance_health = ambulance_health / 10
		//ambulance_health = ambulance_health * 5

		IF NOT IS_CAR_HEALTH_GREATER ambulance_rc5 900 //---ambulance damaged enough to force bailout
		//OR IS_CAR_STUCK_ON_ROOF ambulance_rc5
			GOTO injured_cop_bailout
		ENDIF
		
		IF LOCATE_CAR_2D ambulance_rc5 405.2 -1137.7 15.0 15.0 false
			SET_CAR_CRUISE_SPEED ambulance_rc5 10.0
			flag_redalert = 2
			CAR_GOTO_COORDINATES ambulance_rc5 362.0 -1138.0 23.0 //----amb goto final destination
			SET_CAR_CRUISE_SPEED ambulance_rc5 15.0
			SET_CAR_DRIVING_STYLE ambulance_rc5 0
		ENDIF
		
		IF IS_CAR_ON_SCREEN ambulance_rc5
			SET_CAR_ONLY_DAMAGED_BY_PLAYER ambulance_rc5 false
		ELSE
			SET_CAR_ONLY_DAMAGED_BY_PLAYER ambulance_rc5 true
		ENDIF
	
	ELSE
		PRINT_NOW (RM5_3) 2500 1 //---ambulance was decoy!!
		MARK_CAR_AS_NO_LONGER_NEEDED ambulance_rc5
		MARK_CHAR_AS_NO_LONGER_NEEDED cop_driver
		REMOVE_BLIP blip_ambulance_rc5
		CLEAR_ONSCREEN_COUNTER ambulance_health
		flag_random_ray5 = 0
		flag_police_trigger = 0
		GOTO amb_generator
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_2D player amb_rc5_x amb_rc5_y 25.0 25.0 false //---player taken the bait ---police close in
	AND flag_police_trigger = 0
		IF NOT IS_CAR_DEAD ambulance_rc5
			PRINT_NOW (RM5_2) 3000 1
			SET_CAR_CRUISE_SPEED ambulance_rc5 28.0
			SET_CAR_DRIVING_STYLE ambulance_rc5 3
			CAR_GOTO_COORDINATES ambulance_rc5 405.2 -1137.7 26.0
			PLAY_MISSION_AUDIO
			SWITCH_CAR_SIREN ambulance_rc5 ON
			ALTER_WANTED_LEVEL_NO_DROP player 2 
			flag_redalert = 1
			flag_police_trigger = 1
		ENDIF
	ENDIF

	GOSUB swat_team

ENDWHILE


//----ambulance has reached penultimate waypoint

WHILE flag_redalert = 2
	WAIT 0
	IF NOT IS_CAR_DEAD ambulance_rc5
		GET_CAR_HEALTH ambulance_rc5 ambulance_health
		ambulance_health = ambulance_health * -1
		ambulance_health = ambulance_health + 1000
		//ambulance_health = ambulance_health / 10
		//ambulance_health = ambulance_health * 5

		IF LOCATE_CAR_2D ambulance_rc5 362.0 -1138.0 5.0 5.0 true 
			flag_redalert = 3
			SET_CAR_CRUISE_SPEED ambulance_rc5 0.0
			SET_CAR_DRIVING_STYLE ambulance_rc5 0
			SWITCH_CAR_SIREN ambulance_rc5 OFF
			CAR_SET_IDLE ambulance_rc5 //---ambulance has reached destination without bailout -mission failed
		ENDIF
		
		IF NOT IS_CAR_HEALTH_GREATER ambulance_rc5 900
		//OR IS_CAR_STUCK_ON_ROOF ambulance_rc5
			GOTO injured_cop_bailout
		ENDIF
		
		IF IS_CAR_ON_SCREEN ambulance_rc5
			SET_CAR_ONLY_DAMAGED_BY_PLAYER ambulance_rc5 false
		ELSE
			SET_CAR_ONLY_DAMAGED_BY_PLAYER ambulance_rc5 true
		ENDIF

	ELSE
		PRINT_NOW (RM5_3) 2500 1 //---ambulance was decoy!!
		MARK_CAR_AS_NO_LONGER_NEEDED ambulance_rc5
		MARK_CHAR_AS_NO_LONGER_NEEDED cop_driver
		REMOVE_BLIP blip_ambulance_rc5
		CLEAR_ONSCREEN_COUNTER ambulance_health
		flag_random_ray5 = 0
		flag_redalert = 0
		GOTO amb_generator
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_2D player amb_rc5_x amb_rc5_y 25.0 25.0 false //---player taken the bait ---police close in
	AND flag_police_trigger = 0
		PRINT_NOW (RM5_2) 3000 1
		ALTER_WANTED_LEVEL_NO_DROP player 2 
		flag_police_trigger = 1
	ENDIF
	
	GOSUB swat_team

ENDWHILE


GOTO mission_ray5_failed


injured_cop_bailout:
REMOVE_BLIP blip_ambulance_rc5
GET_CAR_COORDINATES ambulance_rc5 amb_rc5_x amb_rc5_y amb_rc5_z
amb_rc5_z = amb_rc5_z + 2.5
CREATE_OBJECT bodycast amb_rc5_x amb_rc5_y amb_rc5_z injured_cop_rc5
SET_OBJECT_COLLISION injured_cop_rc5 TRUE
SET_OBJECT_DYNAMIC injured_cop_rc5 true
MAKE_OBJECT_TARGETTABLE injured_cop_rc5
ADD_TO_OBJECT_VELOCITY injured_cop_rc5 0.0 0.0 5.0
ADD_BLIP_FOR_OBJECT injured_cop_rc5 blip_injured_cop_rc5
ALTER_WANTED_LEVEL_NO_DROP player 3
CLEAR_ONSCREEN_COUNTER ambulance_health

 
/*
WHILE flag_bodycast_clear = 0
	WAIT 0
	GET_OBJECT_COORDINATES injured_cop_rc5 ic_x ic_y ic_z
	IF NOT IS_CAR_DEAD ambulance_rc5
		IF NOT LOCATE_CAR_3D  ambulance_rc5 ic_x ic_y ic_z 5.0 5.0 5.0 false
			SET_OBJECT_COLLISION injured_cop_rc5 TRUE
			flag_bodycast_clear = 1
		ENDIF
	ELSE
		SET_OBJECT_COLLISION injured_cop_rc5 TRUE
		flag_bodycast_clear = 1		
	ENDIF
ENDWHILE
*/
DISPLAY_ONSCREEN_COUNTER_WITH_STRING bodycast_health COUNTER_DISPLAY_BAR DAM
			
PRINT_NOW (RM5_6) 3000 1


WHILE NOT HAS_OBJECT_BEEN_DAMAGED injured_cop_rc5

	WAIT 0

	GET_OBJECT_COORDINATES injured_cop_rc5 ic_x ic_y ic_z
	SET_MISSION_AUDIO_POSITION ic_x ic_y ic_z
	GET_BODY_CAST_HEALTH bodycast_health
	bodycast_health = bodycast_health * -1
	bodycast_health = bodycast_health + 1000
	bodycast_health = bodycast_health / 10
	
	
	IF flag_audio = 0
		PLAY_MISSION_AUDIO
	ENDIF
	
	IF HAS_MISSION_AUDIO_FINISHED
		flag_audio = 1
	ENDIF

	//zed_value =# ic_z
	//PRINT_WITH_NUMBER_NOW ( Z ) zed_value 1000 1

	IF IS_CURRENT_PLAYER_WEAPON player WEAPONTYPE_PISTOL
	AND NOT IS_PLAYER_IN_ANY_CAR player
		PRINT (RM5_4) 500 1//bullets won't get through that armoured plaster!!
	ENDIF
	IF IS_CURRENT_PLAYER_WEAPON player WEAPONTYPE_UZI
	AND NOT IS_PLAYER_IN_ANY_CAR player
		PRINT (RM5_4) 500 1
	ENDIF
	IF IS_CURRENT_PLAYER_WEAPON player WEAPONTYPE_SHOTGUN
	AND NOT IS_PLAYER_IN_ANY_CAR player
		PRINT (RM5_4) 500 1
	ENDIF
	IF IS_CURRENT_PLAYER_WEAPON player WEAPONTYPE_M16
	AND NOT IS_PLAYER_IN_ANY_CAR player
		PRINT (RM5_4) 500 1
	ENDIF
	IF IS_CURRENT_PLAYER_WEAPON player WEAPONTYPE_CHAINGUN
	AND NOT IS_PLAYER_IN_ANY_CAR player
		PRINT (RM5_4) 500 1
	ENDIF
	IF IS_CURRENT_PLAYER_WEAPON player WEAPONTYPE_FLAMETHROWER
	AND NOT IS_PLAYER_IN_ANY_CAR player
		PRINT (RM5_5) 500 1//That Plaster's flame retardent!!
	ENDIF
	IF IS_CURRENT_PLAYER_WEAPON player WEAPONTYPE_MOLOTOV
	AND NOT IS_PLAYER_IN_ANY_CAR player
		PRINT (RM5_5) 500 1
	ENDIF
	IF ic_z < 1.0
		PRINT_NOW (RM5_8) 3000 1//witness has drowned!!
		GOTO quentin
	ENDIF 

	GOSUB swat_team

ENDWHILE

quentin:

REMOVE_BLIP blip_injured_cop_rc5

GOTO mission_ray5_passed
	   		



// Mission Ray5 failed

mission_ray5_failed:

PRINT_NOW RM5_7 3000 1 //Witness has been delivered!!

PRINT_BIG ( M_FAIL ) 2000 1

RETURN

   

// mission Ray5 passed

mission_ray5_passed:

flag_ray_mission5_passed = 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
CLEAR_WANTED_LEVEL player
ADD_SCORE player 10000
REGISTER_MISSION_PASSED RM5
PLAYER_MADE_PROGRESS 1 

IF NOT flag_love_mission3_passed = 1
    REMOVE_BLIP ray_contact_blip
ELSE
	START_NEW_SCRIPT ray_mission6_loop
ENDIF

RETURN
		


// mission cleanup

mission_cleanup_ray5:

DISPLAY_RADAR 3 // PATHING ON

CLEAR_ONSCREEN_COUNTER ambulance_health
CLEAR_ONSCREEN_COUNTER bodycast_health

flag_player_on_mission = 0
flag_player_on_ray_mission = 0

MARK_OBJECT_AS_NO_LONGER_NEEDED injured_cop_rc5

MARK_CHAR_AS_NO_LONGER_NEEDED swat1_rc5
MARK_CHAR_AS_NO_LONGER_NEEDED swat2_rc5
MARK_CHAR_AS_NO_LONGER_NEEDED swat3_rc5
MARK_CHAR_AS_NO_LONGER_NEEDED swat4_rc5
MARK_CHAR_AS_NO_LONGER_NEEDED cop_driver

MARK_MODEL_AS_NO_LONGER_NEEDED CAR_AMBULANCE
MARK_MODEL_AS_NO_LONGER_NEEDED PED_SWAT
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_ENFORCER
REMOVE_BLIP blip_ambulance_rc5

MISSION_HAS_FINISHED
RETURN
		

//------GOSUBS------------------------------

swat_team:

	IF IS_PLAYER_IN_AREA_3D player 366.0 -1146.0 21.0 396.0 -1134.0 28.0 false
		IF NOT IS_CHAR_DEAD swat1_rc5
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS swat1_rc5 player
		ENDIF
		IF NOT IS_CHAR_DEAD swat2_rc5
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS swat2_rc5 player
		ENDIF
	ENDIF
	IF IS_PLAYER_IN_AREA_3D player 318.0 -1170.0 22.0 366.0 -1120.0 25.0 false
		IF NOT IS_CHAR_DEAD swat1_rc5
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS swat1_rc5 player
		ENDIF
		IF NOT IS_CHAR_DEAD swat2_rc5
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS swat2_rc5 player
		ENDIF
		IF NOT IS_CHAR_DEAD swat3_rc5
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS swat3_rc5 player
		ENDIF
		IF NOT IS_CHAR_DEAD swat4_rc5
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS swat4_rc5 player
		ENDIF
	ENDIF

RETURN
MISSION_START
// *****************************************************************************************
// ************************************   Ray 6    ***************************************** 
// ************************************ Marked Man *****************************************
// *****************************************************************************************
// *** The CIA is making money from Cartel deals and is concerned that the Yakuza are 	 ***
// *** hindering the operation. They've discovered that Ray is helping them and they've  ***
// *** decided to 'rub him out'. Ray is running scared and needs a ride to the airport.  ***
// *** His contact point is empty, but the player will get a pager message. The player is*** 
// *** followed by the C.I.A Ray is dressed in a Hawaiian shirt and has two cases packed.*** 
// *** He's booked on a flight (timed mission). The CIA give chase.						 ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_ray6

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_ray6_failed
ENDIF

GOSUB mission_cleanup_ray6

MISSION_END
 
// Variables for mission

VAR_INT	time_till_flight flag_blip_on_ray rays_blip	total_cia player_death_car airport_door_flag door1_closed door2_closed
VAR_INT cia_1 cia_1_flag
VAR_INT cia_2 cia_2_flag
VAR_INT cia_3 cia_3_flag
VAR_INT cia_4 cia_4_flag
VAR_INT cia_5 cia_5_flag
VAR_INT cia_6 cia_6_flag
VAR_INT cia_7 cia_7_flag
VAR_INT cia_8 cia_8_flag
VAR_INT cia_9 cia_9_flag
VAR_INT cia_10 cia_10_flag
VAR_INT cia_11 cia_11_flag
VAR_INT cia_12 cia_12_flag
VAR_INT cia_13 cia_13_flag
VAR_INT cia_14 cia_14_flag
VAR_INT cia_15 cia_15_flag
VAR_INT cia_16 cia_16_flag
VAR_INT cia_17 cia_17_flag
VAR_INT	rays_prize_car rays_prize_weapon1 rays_prize_weapon2 rays_prize_weapon3 rays_prize_weapon4 rays_cash pickups_created_rm6


// ****************************************Mission Start************************************

mission_start_ray6:

flag_player_on_mission 	   = 1
flag_player_on_ray_mission = 1
rays_cutscene_flag = 1

REGISTER_MISSION_GIVEN

WAIT 0

SCRIPT_NAME ray6

time_till_flight = 211000
flag_blip_on_ray = 0
airport_door_flag = 0
door1_closed = 0
door2_closed = 0
total_cia = 0
pickups_created_rm6 = 0
cia_1_flag  = 0
cia_2_flag  = 0
cia_3_flag  = 0
cia_4_flag  = 0
cia_5_flag  = 0
cia_6_flag  = 0
cia_7_flag  = 0
cia_8_flag  = 0
cia_9_flag  = 0
cia_10_flag = 0
cia_11_flag = 0
cia_12_flag = 0
cia_13_flag = 0
cia_14_flag = 0
cia_15_flag = 0
cia_16_flag = 0
cia_17_flag = 0

// ****************************************START OF CUTSCENE********************************

//SET_FADING_COLOUR 0 0 0
//
//DO_FADE 1500 FADE_OUT
//
//IF CAN_PLAYER_START_MISSION player
//	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
//ELSE
//	GOTO mission_ray6_failed
//ENDIF
//
//PRINT_BIG RM6 15000 2 //"Marked Man"

LOAD_SPECIAL_CHARACTER 1 ray
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 RAYH
REQUEST_MODEL toilet

//WHILE GET_FADING_STATUS
//	WAIT 0
//ENDWHILE

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED toilet
	WAIT 0
ENDWHILE

CLEAR_AREA 39.0 -723.5 22.0 1.0 TRUE

SET_PLAYER_COORDINATES player 39.0 -723.5 22.0

SET_PLAYER_HEADING player 90.0

LOAD_CUTSCENE r6_mm

SET_CUTSCENE_OFFSET 39.424 -726.677 21.692

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_ray

SET_CUTSCENE_ANIM cs_ray ray

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_ray CUT_OBJ2 cs_rayhead
SET_CUTSCENE_HEAD_ANIM cs_rayhead ray

//SET_PLAYER_COORDINATES player 38.7 -725.7 22.0
//
//SET_PLAYER_HEADING player 270.0

DO_FADE 1500 FADE_IN

SET_NEAR_CLIP 0.2

START_CUTSCENE

SWITCH_STREAMING OFF
SWITCH_RUBBISH OFF
// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 1807
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM6_A 4000 1 //"You weren't followed? Good."

WHILE cs_time < 4920
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM6_B 4000 1 //"This is it, I'm in way over my fucking head and I'm starting to fucking drown here!"

WHILE cs_time < 8597
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM6_C 4000 1 //"The CIA seem to have a vested interest in SPANK"

WHILE cs_time < 11482
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM6_C1 4000 1 //"and they don't like us fucking with the Cartel!"

WHILE cs_time < 14220
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM6_D	4000 1 //"I'm a marked man, so I'm getting out of here."

WHILE cs_time < 17464
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW RM6_E	4000 1 //"Get me to my flight at the airport and I'll make it worth your while!!"

WHILE cs_time < 21666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

DO_FADE 0 FADE_OUT
SET_NEAR_CLIP 0.9

SET_CAMERA_BEHIND_PLAYER

MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2
MARK_MODEL_AS_NO_LONGER_NEEDED toilet
REQUEST_MODEL PED_B_MAN3

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED PED_B_MAN3
	WAIT 0
ENDWHILE

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 38.7 -727.7 22.0 ray
ADD_ARMOUR_TO_CHAR ray 100

SET_PLAYER_AS_LEADER ray player

SWITCH_STREAMING ON
DO_FADE 1500 FADE_IN 
rays_cutscene_flag = 0

// ******************************************END OF CUTSCENE********************************

DISPLAY_ONSCREEN_TIMER time_till_flight

ADD_BLIP_FOR_COORD -739.0 -583.0 -100.0 rays_blip

IF IS_CHAR_DEAD ray
	PRINT_NOW RM6_6 5000 1//"~r~Ray is dead!"
	GOTO mission_ray6_failed
ENDIF

SET_CHAR_RUNNING ray TRUE 

PRINT_NOW RM6_5 15000 1 //"The CIA have the bridge under surveillance, find another route across."

WHILE NOT LOCATE_STOPPED_CHAR_ANY_MEANS_2D ray -738.3010 -582.8834 8.0 8.0 1
	
	WAIT 0

	IF IS_CHAR_DEAD	ray
		PRINT_NOW RM6_6 5000 1//"~r~Ray is dead!"
		GOTO mission_ray6_failed
	ENDIF
	
	IF time_till_flight < 1
		PRINT_NOW RM6_7 5000 1//"~r~Ray has missed his flight."
		GOTO mission_ray6_failed
	ENDIF

	////////	

	IF total_cia < 16
		IF cia_1_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -25.8545 -612.5001 100.0 100.0 0 // Commercial End of lift bridge
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -25.8545 -612.5001 42.1683 cia_1
				SET_CHAR_HEADING cia_1 239.6049
				GIVE_WEAPON_TO_CHAR cia_1 WEAPONTYPE_M16 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_1 TRUE
				CHAR_SET_IDLE cia_1
				SET_CHAR_PERSONALITY cia_1 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_1 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_1 TRUE
				ADD_ARMOUR_TO_CHAR cia_1 100
				++ total_cia
				cia_1_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_1_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -25.8545 -612.5001 100.0 100.0 0
			DELETE_CHAR cia_1
			-- total_cia
			cia_1_flag = 0
		ENDIF
	ENDIF

	IF cia_1_flag = 1
		IF IS_CHAR_DEAD cia_1
			cia_1_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_1 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_1 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_1 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_1	player
			ENDIF
		ENDIF
	ENDIF

	////////

	IF total_cia < 16
		IF cia_2_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -24.0225 -630.3363 100.0 100.0 0 // Commercial End of lift bridge
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -24.0225 -630.3363 42.1125 cia_2
				SET_CHAR_HEADING cia_2 293.6046
				GIVE_WEAPON_TO_CHAR cia_2 WEAPONTYPE_M16 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_2 TRUE
				CHAR_SET_IDLE cia_2
				SET_CHAR_PERSONALITY cia_2 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_2 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_2 TRUE
				ADD_ARMOUR_TO_CHAR cia_2 100
				++ total_cia
				cia_2_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_2_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -24.0225 -630.3363 100.0 100.0 0
			DELETE_CHAR cia_2
			-- total_cia
			cia_2_flag = 0
		ENDIF
	ENDIF

	IF cia_2_flag = 1
		IF IS_CHAR_DEAD cia_2
			cia_2_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_2 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_2 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_2 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_2	player
			ENDIF
		ENDIF
	ENDIF

	////////

	IF total_cia < 16
		IF cia_3_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -35.1159 -632.8395 100.0 100.0 0 // Commercial End of lift bridge
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -35.1159 -632.8395 42.4257 cia_3
				SET_CHAR_HEADING cia_3 255.4109
				GIVE_WEAPON_TO_CHAR cia_3 WEAPONTYPE_M16 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_3 TRUE
				CHAR_SET_IDLE cia_3
				SET_CHAR_PERSONALITY cia_3 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_3 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_3 TRUE
				ADD_ARMOUR_TO_CHAR cia_3 100
				++ total_cia
				cia_3_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_3_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -35.1159 -632.8395 100.0 100.0 0
			DELETE_CHAR cia_3
			-- total_cia
			cia_3_flag = 0
		ENDIF
	ENDIF

	IF cia_3_flag = 1
		IF IS_CHAR_DEAD cia_3
			cia_3_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_3 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_3 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_3 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_3	player
			ENDIF
		ENDIF
	ENDIF
			
	////////

	IF total_cia < 16
		IF cia_4_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -24.3022 -650.4634 100.0 100.0 0 // Commercial End of lift bridge
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -24.3022 -650.4634 46.5876 cia_4
				SET_CHAR_HEADING cia_4 344.2893
				GIVE_WEAPON_TO_CHAR cia_4 WEAPONTYPE_M16 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_4 TRUE
				CHAR_SET_IDLE cia_4
				SET_CHAR_PERSONALITY cia_4 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_4 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_4 TRUE
				ADD_ARMOUR_TO_CHAR cia_4 100
				++ total_cia
				cia_4_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_4_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -24.3022 -650.4634 100.0 100.0 0
			DELETE_CHAR cia_4
			-- total_cia
			cia_4_flag = 0
		ENDIF
	ENDIF

	IF cia_4_flag = 1
		IF IS_CHAR_DEAD cia_4
			cia_4_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_4 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_4 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_4 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_4	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_5_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -217.9545 -630.4070 100.0 100.0 0 // Commercial End of lift bridge, by lift bit
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -217.9545 -630.4070 45.9975 cia_5
				SET_CHAR_HEADING cia_5 344.2893
				GIVE_WEAPON_TO_CHAR cia_5 WEAPONTYPE_M16 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_5 TRUE
				CHAR_SET_IDLE cia_5
				SET_CHAR_PERSONALITY cia_5 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_5 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_5 TRUE
				ADD_ARMOUR_TO_CHAR cia_5 100
				++ total_cia
				cia_5_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_5_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -217.9545 -630.4070 100.0 100.0 0
			DELETE_CHAR cia_5
			-- total_cia
			cia_5_flag = 0
		ENDIF
	ENDIF

	IF cia_5_flag = 1
		IF IS_CHAR_DEAD cia_5
			cia_5_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_5 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_5 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_5 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_5	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_6_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -212.4922 -632.7455 100.0 100.0 0 // Commercial End of lift bridge, by lift bit
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -212.4922 -632.7455 45.9514 cia_6
				SET_CHAR_HEADING cia_6 247.0256
				GIVE_WEAPON_TO_CHAR cia_6 WEAPONTYPE_M16 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_6 TRUE
				CHAR_SET_IDLE cia_6
				SET_CHAR_PERSONALITY cia_6 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_6 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_6 TRUE
				ADD_ARMOUR_TO_CHAR cia_6 100
				++ total_cia
				cia_6_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_6_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -212.4922 -632.7455 100.0 100.0 0
			DELETE_CHAR cia_6
			-- total_cia
			cia_6_flag = 0
		ENDIF
	ENDIF

	IF cia_6_flag = 1
		IF IS_CHAR_DEAD cia_6
			cia_6_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_6 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_6 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_6 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_6	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_7_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -437.0927 -612.5157 100.0 100.0 0 // Suburban End of lift bridge, by lift bit
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -437.0927 -612.5157 44.5994 cia_7
				SET_CHAR_HEADING cia_7 247.0256
				GIVE_WEAPON_TO_CHAR cia_7 WEAPONTYPE_M16 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_7 TRUE
				CHAR_SET_IDLE cia_7
				SET_CHAR_PERSONALITY cia_7 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_7 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_7 TRUE
				ADD_ARMOUR_TO_CHAR cia_7 100
				++ total_cia
				cia_7_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_7_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -437.0927 -612.5157 100.0 100.0 0
			DELETE_CHAR cia_7
			-- total_cia
			cia_7_flag = 0
		ENDIF
	ENDIF

	IF cia_7_flag = 1
		IF IS_CHAR_DEAD cia_7
			cia_7_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_7 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_7 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_7 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_7	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_8_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -534.6777 -631.2995 100.0 100.0 0 // Suburban End of lift bridge
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -534.6777 -631.2995 42.2770 cia_8
				SET_CHAR_HEADING cia_8 247.0256
				GIVE_WEAPON_TO_CHAR cia_8 WEAPONTYPE_M16 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_8 TRUE
				CHAR_SET_IDLE cia_8
				SET_CHAR_PERSONALITY cia_8 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_8 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_8 TRUE
				ADD_ARMOUR_TO_CHAR cia_8 100
				++ total_cia
				cia_8_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_8_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -534.6777 -631.2995 100.0 100.0 0
			DELETE_CHAR cia_8
			-- total_cia
			cia_8_flag = 0
		ENDIF
	ENDIF

	IF cia_8_flag = 1
		IF IS_CHAR_DEAD cia_8
			cia_8_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_8 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_8 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_8 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_8	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_9_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -523.4218 -650.3831 100.0 100.0 0 // Suburban End of lift bridge
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -523.4218 -650.3831 42.5261 cia_9
				SET_CHAR_HEADING cia_9 316.7352
				GIVE_WEAPON_TO_CHAR cia_9 WEAPONTYPE_M16 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_9 TRUE
				CHAR_SET_IDLE cia_9
				SET_CHAR_PERSONALITY cia_9 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_9 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_9 TRUE
				ADD_ARMOUR_TO_CHAR cia_9 100
				++ total_cia
				cia_9_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_9_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -523.4218 -650.3831 100.0 100.0 0
			DELETE_CHAR cia_9
			-- total_cia
			cia_9_flag = 0
		ENDIF
	ENDIF

	IF cia_9_flag = 1
		IF IS_CHAR_DEAD cia_9
			cia_9_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_9 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_9 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_9 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_9	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_10_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -628.0785 -498.4106 100.0 100.0 0 // ontop of tunnel exit out
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -628.0785 -498.4106 22.3884 cia_10
				SET_CHAR_HEADING cia_10 76.5552
				GIVE_WEAPON_TO_CHAR cia_10 WEAPONTYPE_UZI 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_10 TRUE
				CHAR_SET_IDLE cia_10
				SET_CHAR_PERSONALITY cia_10 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_10 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_10 TRUE
				ADD_ARMOUR_TO_CHAR cia_10 100
				++ total_cia
				cia_10_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_10_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -628.0785 -498.4106 100.0 100.0 0
			DELETE_CHAR cia_10
			-- total_cia
			cia_10_flag = 0
		ENDIF
	ENDIF

	IF cia_10_flag = 1
		IF IS_CHAR_DEAD cia_10
			cia_10_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_10 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_10 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_10 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_10	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_11_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -637.6517 -501.7922 100.0 100.0 0 // ontop of tunnel exit out
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -637.6517 -501.7922 22.3455 cia_11
				SET_CHAR_HEADING cia_11 76.5552
				GIVE_WEAPON_TO_CHAR cia_11 WEAPONTYPE_UZI 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_11 TRUE
				CHAR_SET_IDLE cia_11
				SET_CHAR_PERSONALITY cia_11 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_11 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_11 TRUE
				ADD_ARMOUR_TO_CHAR cia_11 100
				++ total_cia
				cia_11_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_11_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -637.6517 -501.7922 100.0 100.0 0
			DELETE_CHAR cia_11
			-- total_cia
			cia_11_flag = 0
		ENDIF
	ENDIF

	IF cia_11_flag = 1
		IF IS_CHAR_DEAD cia_11
			cia_11_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_11 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_11 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_11 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_11	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_12_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -692.3098 -563.0333 100.0 100.0 0 // ontop of tunnel exit in
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -692.3098 -563.0333 21.5110 cia_12
				SET_CHAR_HEADING cia_12 344.2857
				GIVE_WEAPON_TO_CHAR cia_12 WEAPONTYPE_UZI 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_12 TRUE
				CHAR_SET_IDLE cia_12
				SET_CHAR_PERSONALITY cia_12 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_12 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_12 TRUE
				ADD_ARMOUR_TO_CHAR cia_12 100
				++ total_cia
				cia_12_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_12_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -692.3098 -563.0333 100.0 100.0 0
			DELETE_CHAR cia_12
			-- total_cia
			cia_12_flag = 0
		ENDIF
	ENDIF

	IF cia_12_flag = 1
		IF IS_CHAR_DEAD cia_12
			cia_12_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_12 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_12 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_12 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_12	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_13_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -671.1359 -540.5952 100.0 100.0 0 //Suburban End of lift bridge by tunnel exit in
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -671.1359 -540.5952 22.9211 cia_13
				SET_CHAR_HEADING cia_13 281.8996
				GIVE_WEAPON_TO_CHAR cia_13 WEAPONTYPE_UZI 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_13 TRUE
				CHAR_SET_IDLE cia_13
				SET_CHAR_PERSONALITY cia_13 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_13 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_13 TRUE
				ADD_ARMOUR_TO_CHAR cia_13 100
				++ total_cia
				cia_13_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_13_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -671.1359 -540.5952 100.0 100.0 0
			DELETE_CHAR cia_13
			-- total_cia
			cia_13_flag = 0
		ENDIF
	ENDIF

	IF cia_13_flag = 1
		IF IS_CHAR_DEAD cia_13
			cia_13_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_13 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_13 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_13 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_13	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_14_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -638.4215 -419.2620 100.0 100.0 0 //Opposite turning into the airport
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -638.4215 -419.2620 17.8198 cia_14
				SET_CHAR_HEADING cia_14 113.6173
				GIVE_WEAPON_TO_CHAR cia_14 WEAPONTYPE_UZI 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_14 TRUE
				CHAR_SET_IDLE cia_14
				SET_CHAR_PERSONALITY cia_14 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_14 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_14 TRUE
				ADD_ARMOUR_TO_CHAR cia_14 100
				++ total_cia
				cia_14_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_14_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -638.4215 -419.2620 100.0 100.0 0
			DELETE_CHAR cia_14
			-- total_cia
			cia_14_flag = 0
		ENDIF
	ENDIF

	IF cia_14_flag = 1
		IF IS_CHAR_DEAD cia_14
			cia_14_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_14 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_14 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_14 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_14	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_15_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -655.3353 -404.4556 100.0 100.0 0 //On concrete island	opposite turning into the airport
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -655.3353 -404.4556 17.8198 cia_15
				SET_CHAR_HEADING cia_15 191.1247
				GIVE_WEAPON_TO_CHAR cia_15 WEAPONTYPE_UZI 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_15 TRUE
				CHAR_SET_IDLE cia_15
				SET_CHAR_PERSONALITY cia_15 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_15 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_15 TRUE
				ADD_ARMOUR_TO_CHAR cia_15 100
				++ total_cia
				cia_15_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_15_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -655.3353 -404.4556 100.0 100.0 0
			DELETE_CHAR cia_15
			-- total_cia
			cia_15_flag = 0
		ENDIF
	ENDIF

	IF cia_15_flag = 1
		IF IS_CHAR_DEAD cia_15
			cia_15_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_15 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_15 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_15 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_15	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_16_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -677.0261 -425.0470 100.0 100.0 0 // up on grass by airport turning
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -677.0261 -425.0470 18.5140 cia_16
				SET_CHAR_HEADING cia_16 265.4145
				GIVE_WEAPON_TO_CHAR cia_16 WEAPONTYPE_UZI 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_16 TRUE
				CHAR_SET_IDLE cia_16
				SET_CHAR_PERSONALITY cia_16 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_16 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_16 TRUE
				ADD_ARMOUR_TO_CHAR cia_16 100
				++ total_cia
				cia_16_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_16_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -677.0261 -425.0470 100.0 100.0 0
			DELETE_CHAR cia_16
			-- total_cia
			cia_16_flag = 0
		ENDIF
	ENDIF

	IF cia_16_flag = 1
		IF IS_CHAR_DEAD cia_16
			cia_16_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_16 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_16 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_16 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_16	player
			ENDIF
		ENDIF
	ENDIF
	
	////////

	IF total_cia < 16
		IF cia_17_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -679.1292 -485.1575 100.0 100.0 0 //on wall by tunnel exit in
				CREATE_CHAR PEDTYPE_CIVMALE PED_B_MAN3 -679.1292 -485.1575 18.2578 cia_17
				SET_CHAR_HEADING cia_17 260.2034
				GIVE_WEAPON_TO_CHAR cia_17 WEAPONTYPE_UZI 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	cia_17 TRUE
				CHAR_SET_IDLE cia_17
				SET_CHAR_PERSONALITY cia_17 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH cia_17 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE cia_17 TRUE
				ADD_ARMOUR_TO_CHAR cia_17 100
				++ total_cia
				cia_17_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF cia_17_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -679.1292 -485.1575 100.0 100.0 0
			DELETE_CHAR cia_17
			-- total_cia
			cia_17_flag = 0
		ENDIF
	ENDIF

	IF cia_17_flag = 1
		IF IS_CHAR_DEAD cia_17
			cia_17_flag = 2
		ELSE
			IF LOCATE_PLAYER_IN_CAR_CHAR_2D	player cia_17 40.0 40.0 0
				STORE_CAR_PLAYER_IS_IN player player_death_car
				SET_CHAR_OBJ_DESTROY_CAR cia_17 player_death_car
			ENDIF
			IF LOCATE_PLAYER_ON_FOOT_CHAR_2D player cia_17 40.0 40.0 0
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT cia_17	player
			ENDIF
		ENDIF
	ENDIF

	////////
	
	IF NOT IS_CHAR_IN_PLAYERS_GROUP ray player
	AND flag_blip_on_ray = 0
		PRINT_NOW RM6_8 5000 1 //"You have left Ray behind, go back and get him."
		REMOVE_BLIP rays_blip
		ADD_BLIP_FOR_CHAR ray rays_blip
		flag_blip_on_ray = 1
	ENDIF

	IF flag_blip_on_ray = 1
		IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ray 8.0 8.0 FALSE
			SET_PLAYER_AS_LEADER ray player
			REMOVE_BLIP rays_blip
			ADD_BLIP_FOR_COORD -739.0 -583.0 8.0 rays_blip
			flag_blip_on_ray = 0
		ENDIF
	ENDIF

ENDWHILE

REMOVE_BLIP	rays_blip

CLEAR_ONSCREEN_TIMER time_till_flight

SET_PLAYER_CONTROL player OFF
SET_EVERYONE_IGNORE_PLAYER player ON
//SET_ALL_CARS_CAN_BE_DAMAGED FALSE
SWITCH_WIDESCREEN ON
SET_FIXED_CAMERA_POSITION -732.0104 -571.0955 14.0482 0.0 0.0 0.0
POINT_CAMERA_AT_CHAR ray FIXED JUMP_CUT

IF NOT IS_CHAR_IN_ANY_CAR ray
OR NOT IS_PLAYER_IN_ANY_CAR player
	TURN_CHAR_TO_FACE_PLAYER ray player
	GET_PLAYER_CHAR player script_controlled_player
	TURN_CHAR_TO_FACE_CHAR script_controlled_player	ray
ENDIF

LOAD_MISSION_AUDIO R6_A

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
	
	IF IS_CHAR_DEAD	ray
		PRINT_NOW RM6_6 5000 1//"~r~Ray is dead!"
		GOTO mission_ray6_failed
	ENDIF

ENDWHILE

PLAY_MISSION_AUDIO
PRINT_NOW RM6_1 5000 1	//"Here's a key to a lock-up."

WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
	
	IF IS_CHAR_DEAD	ray
		PRINT_NOW RM6_6 5000 1//"~r~Ray is dead!"
		GOTO mission_ray6_failed
	ENDIF

ENDWHILE

LOAD_MISSION_AUDIO R6_A1

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
	
	IF IS_CHAR_DEAD	ray
		PRINT_NOW RM6_6 5000 1//"~r~Ray is dead!"
		GOTO mission_ray6_failed
	ENDIF

ENDWHILE

PLAY_MISSION_AUDIO
PRINT_NOW RM6_2 5000 1	//"You'll find some cash and some 'supplies' I'd stashed in case things got tight."

WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
	
	IF IS_CHAR_DEAD	ray
		PRINT_NOW RM6_6 5000 1//"~r~Ray is dead!"
		GOTO mission_ray6_failed
	ENDIF

ENDWHILE

LOAD_MISSION_AUDIO R6_B

WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
	
	IF IS_CHAR_DEAD	ray
		PRINT_NOW RM6_6 5000 1//"~r~Ray is dead!"
		GOTO mission_ray6_failed
	ENDIF

ENDWHILE

PLAY_MISSION_AUDIO
PRINT_NOW RM6_3 5000 1	//"See y'around."

IF IS_CHAR_IN_ANY_CAR ray
	LEAVE_GROUP ray
	STORE_CAR_CHAR_IS_IN ray player_death_car
	SET_CHAR_OBJ_LEAVE_CAR ray player_death_car
ENDIF

WHILE NOT airport_door_flag = 6
OR NOT door1_closed = 0
OR NOT door2_closed = 0

	WAIT 0

	IF NOT airport_door_flag = 6
		IF IS_CHAR_DEAD	ray
			PRINT_NOW RM6_6 5000 1//"~r~Ray is dead!"
			GOTO mission_ray6_failed
		ENDIF
	ENDIF

	IF airport_door_flag = 0
		IF NOT IS_CHAR_IN_ANY_CAR ray
			LEAVE_GROUP ray
			SET_CHAR_OBJ_RUN_TO_COORD ray -744.7192 -586.4615
			SET_FIXED_CAMERA_POSITION -751.3805 -603.0235 11.4096 0.0 0.0 0.0
			POINT_CAMERA_AT_CHAR ray FIXED JUMP_CUT
			airport_door_flag = 1
		ENDIF
	ENDIF

	IF airport_door_flag = 1
		IF LOCATE_CHAR_ON_FOOT_2D ray -744.7192 -586.4615 1.5 1.5 0
			SET_CHAR_OBJ_RUN_TO_COORD ray -757.1901 -587.2930
			airport_door_flag = 2
		ENDIF
	ENDIF

	IF airport_door_flag = 2
		IF LOCATE_CHAR_ON_FOOT_2D ray -757.1901 -587.2930 1.5 1.5 0
			SET_CHAR_OBJ_RUN_TO_COORD ray -768.0753 -599.4160
			airport_door_flag = 3
		ENDIF
	ENDIF

	IF airport_door_flag = 3
		IF LOCATE_CHAR_ON_FOOT_2D ray -768.0753 -599.4160 1.5 1.5 0
			SET_CHAR_OBJ_RUN_TO_COORD ray -772.6748 -600.3857
			airport_door_flag = 4
		ENDIF
	ENDIF

	IF airport_door_flag > 3 //open doors here
	AND door1_closed = 0
		IF SLIDE_OBJECT airportdoor1 -770.414 -597.865 11.847 0.1 0.1 0.1 0
			door1_closed = 1
		ENDIF
	ENDIF

	IF airport_door_flag > 3 //open doors here
	AND door2_closed = 0
		IF SLIDE_OBJECT airportdoor2 -770.414 -602.885 11.847 0.1 0.1 0.1 0
			door2_closed = 1
		ENDIF
	ENDIF

	IF airport_door_flag = 4
		IF LOCATE_CHAR_ON_FOOT_2D ray -772.6748 -600.3857 1.5 1.5 0
			SET_CHAR_OBJ_RUN_TO_COORD ray -772.6249 -604.7247
			airport_door_flag = 5
		ENDIF
	ENDIF

	IF airport_door_flag > 4 //CLOSE doors here
	AND	door1_closed = 1
		IF NOT IS_PLAYER_IN_AREA_2D player -773.75 -605.205 -768.76 -595.613 0 
			IF SLIDE_OBJECT airportdoor1 -770.414 -599.292 11.847 0.1 0.1 0.1 0
				door1_closed = 0
			ENDIF
		ENDIF
	ENDIF

	IF airport_door_flag > 4 //CLOSE doors here
	AND	door2_closed = 1
		IF NOT IS_PLAYER_IN_AREA_2D player -773.75 -605.205 -768.76 -595.613 0 
			IF SLIDE_OBJECT airportdoor2 -770.414 -601.369 11.846 0.1 0.1 0.1 0
				door2_closed = 0
			ENDIF
		ENDIF
	ENDIF

	IF airport_door_flag = 5
		IF LOCATE_CHAR_ON_FOOT_2D ray -772.6249 -604.7247 1.5 1.5 0
			SET_PLAYER_CONTROL player ON
			SWITCH_WIDESCREEN OFF
			SET_CAMERA_BEHIND_PLAYER
			RESTORE_CAMERA_JUMPCUT
			DELETE_CHAR ray
			airport_door_flag = 6
		ENDIF
	ENDIF

ENDWHILE

PRINT_NOW RM6_4 5000 1 //GO TO THE LOCKUP TO GET YOUR REWARD

ADD_BLIP_FOR_COORD 241.1441 -997.7660 20.9853 rays_blip

REQUEST_MODEL CAR_PATRIOT

WHILE NOT LOCATE_PLAYER_ANY_MEANS_2D PLAYER 241.1441 -997.7660 50.0 50.0 0
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED CAR_PATRIOT
	WAIT 0
ENDWHILE

CREATE_CAR CAR_PATRIOT 241.1441 -997.7660 20.9853 rays_prize_car
//SET_CAR_COLOUR 256 256/WHITE
//SET_CAR_CANT_BE_RESPRAYED
//SET_CAR_DO_NOT_DELETE	maybe
SET_CAR_HEADING rays_prize_car 270.0
SET_CAR_PROOFS rays_prize_car TRUE FALSE FALSE FALSE FALSE
SET_CAR_STRONG rays_prize_car TRUE	
CREATE_PICKUP_WITH_AMMO WEAPON_M16 PICKUP_ONCE 1000 244.0506 -993.9206 21.0 rays_prize_weapon1
CREATE_PICKUP_WITH_AMMO WEAPON_FLAME PICKUP_ONCE 1000 237.3226 -998.5697 21.0 rays_prize_weapon2  
CREATE_PICKUP_WITH_AMMO WEAPON_ROCKET PICKUP_ONCE 25 243.8931 -995.5624 21.0 rays_prize_weapon3  
CREATE_PICKUP_WITH_AMMO WEAPON_SNIPER PICKUP_ONCE 50 241.2706 -993.6790 21.0 rays_prize_weapon4  
CREATE_MONEY_PICKUP 238.9743 -993.6944 21.0 20000 rays_cash

pickups_created_rm6 = 1 

WHILE NOT LOCATE_PLAYER_ANY_MEANS_2D PLAYER 230.2258 -996.4656 2.0 2.0 0
	WAIT 0
ENDWHILE

OPEN_GARAGE	rays_prize_garage

ADD_PAGER_MESSAGE RM6_666 140 666 1	//"Take care of my armoured Cheetah, I had it modified to be bullet proof. See you in Miami, Ray"

WAIT 13000

GOTO mission_ray6_passed
	   		
	
// Mission Ray 6 failed

mission_ray6_failed:

IF pickups_created_rm6 = 1
	REMOVE_PICKUP rays_prize_weapon1
	REMOVE_PICKUP rays_prize_weapon2
	REMOVE_PICKUP rays_prize_weapon3
	REMOVE_PICKUP rays_prize_weapon4
	REMOVE_PICKUP rays_cash
	DELETE_CAR rays_prize_car
	pickups_created_rm6 = 0
ENDIF
REMOVE_CHAR_ELEGANTLY ray
PRINT_BIG M_FAIL 5000 1
RETURN
   

// mission Ray 6 passed

mission_ray6_passed:

flag_ray_mission6_passed = 1
PRINT_WITH_NUMBER_BIG M_PASS 20000 2000 1
ADD_SCORE player 20000
CLEAR_WANTED_LEVEL player
REGISTER_MISSION_PASSED	RM6
PLAY_MISSION_PASSED_TUNE 1
PLAYER_MADE_PROGRESS 1
REMOVE_BLIP ray_contact_blip
RETURN
		


// mission cleanup

mission_cleanup_ray6:

flag_player_on_mission = 0
flag_player_on_ray_mission = 0

IF DOES_OBJECT_EXIST airportdoor1
	SET_OBJECT_COORDINATES airportdoor1 -770.414 -599.292 11.847
ENDIF

IF DOES_OBJECT_EXIST airportdoor2
	SET_OBJECT_COORDINATES airportdoor2 -770.414 -601.369 11.846
ENDIF

IF IS_PLAYER_IN_AREA_2D player -773.75 -605.205 -768.76 -595.613 0
	SET_PLAYER_COORDINATES player -767.8299 -600.3843 11.0
	SET_PLAYER_HEADING player 270.0
ENDIF

CLEAR_ONSCREEN_TIMER time_till_flight
REMOVE_BLIP	rays_blip

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED PED_B_MAN3
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_CHEETAH
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_PATRIOT

MISSION_HAS_FINISHED
RETURN
		


MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************Love Mission 1********************************* 
// **********************************Save The Old Japanese Gentleman************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

SCRIPT_NAME love1

// Mission start stuff

GOSUB mission_start_love1

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_love1_failed
	ENDIF

GOSUB mission_cleanup_love1

MISSION_END
 
// Variables For Mission

VAR_INT car_love1

VAR_INT car_love2  // Any car the ojg might be in

VAR_INT ojg_love1

VAR_INT baddie1_love1

VAR_INT baddie2_love1

VAR_INT baddie3_love1

VAR_INT baddie4_love1

VAR_INT baddie5_love1

VAR_INT baddie6_love1

VAR_INT garage_baddie1_love1

VAR_INT garage_baddie2_love1

VAR_INT garage_baddie3_love1

VAR_INT garage_baddie4_love1

VAR_INT garage_baddie5_love1

VAR_INT garage_baddie6_love1

VAR_INT radar_blip_ped1_love1

VAR_INT flag_ojg_in_group

VAR_INT radar_blip_coord1_love1

VAR_INT flag_blip_on_ojg_love1

VAR_INT car2_love1

VAR_INT flag_baddie1_dead_love1

VAR_INT flag_baddie2_dead_love1

VAR_INT flag_baddie3_dead_love1

VAR_INT flag_baddie4_dead_love1

VAR_INT flag_baddie5_dead_love1

VAR_INT flag_baddie6_dead_love1

VAR_INT flag_garage_baddie1_dead_love1

VAR_INT flag_garage_baddie2_dead_love1

VAR_INT flag_garage_baddie3_dead_love1

VAR_INT flag_garage_baddie4_dead_love1

VAR_INT flag_garage_baddie5_dead_love1

VAR_INT flag_garage_baddie6_dead_love1

VAR_INT flag_garage1_open

VAR_INT flag_garage2_open

VAR_INT flag_garage3_open

VAR_INT flag_garage4_open

VAR_INT flag_garage5_open

VAR_INT radar_blip_coord2_love1

VAR_INT ogg_position

VAR_INT garage_car1_love1

VAR_INT garage_car2_love1

VAR_INT flag_had_garage_message_love1

VAR_INT	ojg_in_area

VAR_INT flag_ojg_dead

VAR_INT flag_player_in_area_love1
		
VAR_INT flag_player_got_car_message_love1

VAR_INT flag_message_car_again 

VAR_INT flag_ojg_in_area

VAR_INT flag_kill_player_love1

VAR_INT flag_baddie3_in_area_love1

VAR_INT flag_baddie4_in_area_love1

VAR_INT flag_baddie5_in_area_love1

VAR_INT flag_baddie6_in_area_love1

VAR_INT flag_baddie1_in_area_love1

VAR_INT flag_baddie2_in_area_love1

 
// ****************************************Mission Start************************************

mission_start_love1:

flag_player_on_mission = 1

flag_player_on_kenji_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_ojg_in_group = 0

flag_blip_on_ojg_love1 = 0

flag_baddie1_dead_love1 = 0

flag_baddie2_dead_love1 = 0

flag_baddie3_dead_love1 = 0

flag_baddie4_dead_love1 = 0

flag_baddie5_dead_love1 = 0

flag_baddie6_dead_love1 = 0

flag_garage_baddie1_dead_love1 = 0

flag_garage_baddie2_dead_love1 = 0

flag_garage_baddie3_dead_love1 = 0

flag_garage_baddie4_dead_love1 = 0

flag_garage_baddie5_dead_love1 = 0

flag_garage_baddie6_dead_love1 = 0

flag_garage1_open = 0

flag_garage2_open = 0

flag_garage3_open = 0

flag_garage4_open = 0

flag_garage5_open = 0

ogg_position = 0

flag_had_garage_message_love1 = 0

ojg_in_area = 0

flag_ojg_dead = 0

flag_player_in_area_love1 = 0
		
flag_player_got_car_message_love1 = 0

flag_message_car_again = 0

blob_flag = 1

flag_ojg_in_area = 0

flag_baddie1_in_area_love1 = 0

flag_baddie2_in_area_love1 = 0

flag_baddie3_in_area_love1 = 0

flag_baddie4_in_area_love1 = 0

flag_baddie5_in_area_love1 = 0

flag_baddie6_in_area_love1 = 0



{

IF flag_failed_love1 = 1

	CLOSE_GARAGE garage1_love1

	CLOSE_GARAGE garage2_love1

	CLOSE_GARAGE garage3_love1

	CLOSE_GARAGE garage4_love1

	CLOSE_GARAGE garage5_love1

ENDIF

flag_failed_love1 = 0

flag_kill_player_love1 = 0

// ****************************************START OF CUTSCENE********************************

/*
IF CAN_PLAYER_START_MISSION player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
ELSE
	GOTO mission_love1_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( LOVE1 ) 15000 2  //"Resue the Old Oriental Gentleman"

SWITCH_STREAMING OFF
*/

// Cutscene stuff

LOAD_SPECIAL_CHARACTER 1 LOVE2
REQUEST_MODEL tshrorckgrdn
REQUEST_MODEL tshrorckgrdn_alfas
LOAD_SPECIAL_MODEL cut_obj1 LOVEH 
LOAD_SPECIAL_MODEL cut_obj2 PLAYERH

/*
WHILE GET_FADING_STATUS

	WAIT 0

ENDWHILE
*/

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED tshrorckgrdn
OR NOT HAS_MODEL_LOADED tshrorckgrdn_alfas

	WAIT 0

ENDWHILE

//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor FALSE	

LOAD_CUTSCENE d1_stog

SET_CUTSCENE_OFFSET 85.2162 -1532.9093 243.5422

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player

SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_love

SET_CUTSCENE_ANIM cs_love love2

CREATE_CUTSCENE_HEAD cs_love CUT_OBJ1 cs_lovehead

SET_CUTSCENE_HEAD_ANIM cs_lovehead love

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ2 cs_playerhead

SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CLEAR_AREA 83.1 -1548.7 27.3 1.0 TRUE 

SET_PLAYER_COORDINATES player 83.1 -1548.7 27.3

SET_PLAYER_HEADING player 90.0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 4111
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LOVE1_A ) 10000 1 //"First of all, let me thank you for dealing with that personal matter."

WHILE cs_time < 7246
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LOVE1_F ) 10000 1 //"People will read something into anything these days."

WHILE cs_time < 10311
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LOVE1_B ) 10000 1 //"Experience has taught me that a man like you can be very loyal for the right price,"

WHILE cs_time < 14533
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LOVE1_H ) 10000 1 //"but groups of men get greedy."

WHILE cs_time < 17000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LOVE1_C ) 10000 1 //"A valued resource, an old oriental gentleman I know,"

WHILE cs_time < 20000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LOVE1_I ) 10000 1 //"has been kept hostage by some South Americans in Aspatria."

WHILE cs_time < 23188 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LOVE1_D ) 10000 1 //"They're trying to extort additional funds from me but I don't believe in re-negotiation."

WHILE cs_time < 28008 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LOVE1_E ) 10000 1 //"A deal is a deal, so they'll not see a penny from me.

WHILE cs_time < 32454 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( LOVE1_G ) 10000 1 //"Go and rescue my friend, do whatever it takes."

WHILE cs_time < 35034 
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( LOVE1_G )

WHILE cs_time < 38333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

DO_FADE 1500 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

SWITCH_STREAMING ON

SWITCH_RUBBISH ON

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

SET_CAMERA_BEHIND_PLAYER

//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 890.9 -416.9 15.0 6.0 backdoor TRUE

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2

MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn

MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn_alfas 


// *******************************************END OF CUTSCENE*******************************

REQUEST_MODEL PED_GANG_COLOMBIAN_A

REQUEST_MODEL CAR_COLUMB

LOAD_SPECIAL_CHARACTER 2 OJG

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_A
OR NOT HAS_MODEL_LOADED CAR_COLUMB

	WAIT 0

ENDWHILE

PRINT_NOW ( LOVE1_1 ) 7000 1 //"Get a columbian gang car, you'll need it to infiltrate the hideout."

// Waiting for the player to be in a colombian car
  
WHILE NOT IS_PLAYER_IN_MODEL player CAR_COLUMB

	WAIT 0

ENDWHILE

ADD_BLIP_FOR_COORD 52.0 -343.0 -100.0 radar_blip_coord2_love1

// Random munber stuff to generate OGG position

GENERATE_RANDOM_INT_IN_RANGE 2 6 ogg_position

IF ogg_position = 2

	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 25.2 -340.3 15.1 ojg_love1

	CLEAR_CHAR_THREAT_SEARCH ojg_love1

	TURN_CHAR_TO_FACE_COORD ojg_love1 57.0 -314.0 -100.0
	
	CHAR_SET_IDLE ojg_love1

ENDIF

IF ogg_position = 3

	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 26.3 -339.7 15.1 ojg_love1

	CLEAR_CHAR_THREAT_SEARCH ojg_love1

   	TURN_CHAR_TO_FACE_COORD ojg_love1 29.0 -339.0 -100.0
	
	CHAR_SET_IDLE ojg_love1

ENDIF

IF ogg_position = 4

	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 25.5 -350.4 15.1 ojg_love1

	CLEAR_CHAR_THREAT_SEARCH ojg_love1

	TURN_CHAR_TO_FACE_COORD ojg_love1 29.0 -350.0 -100.0
	
	CHAR_SET_IDLE ojg_love1

ENDIF

IF ogg_position = 5

	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 47.0 -386.0 15.1 ojg_love1

	CLEAR_CHAR_THREAT_SEARCH ojg_love1

	TURN_CHAR_TO_FACE_COORD ojg_love1 47.0 -381.0 16.0
	
	CHAR_SET_IDLE ojg_love1

ENDIF

PRINT_NOW ( LOVE1_2 ) 7000 1 //"Rescue the Old Japanese Gentleman."

CREATE_CAR CAR_COLUMB 26.2 -365.5 15.1 garage_car1_love1

SET_CAR_HEADING garage_car1_love1 270.0

CREATE_CAR CAR_COLUMB 73.6 -352.7 15.1 garage_car2_love1

SET_CAR_HEADING garage_car2_love1 270.0


// Creates the first guard he follows route 0

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 71.0 -332.0 -100.0 baddie1_love1

SET_CHAR_THREAT_SEARCH baddie1_love1 threat_player1

GIVE_WEAPON_TO_CHAR baddie1_love1  WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

SET_CHAR_PERSONALITY baddie1_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR baddie1_love1 100

TURN_CHAR_TO_FACE_COORD baddie1_love1 72.0 -318.0 -100.0

ADD_ROUTE_POINT 0 71.0 -319.0 -100.0

ADD_ROUTE_POINT 0 71.0 -332.0 -100.0 

SET_CHAR_OBJ_FOLLOW_ROUTE baddie1_love1 0 FOLLOW_ROUTE_LOOP

// Creates the second guard he follows route 1

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 61.0 -318.0 -100.0 baddie2_love1

SET_CHAR_THREAT_SEARCH baddie2_love1 threat_player1

GIVE_WEAPON_TO_CHAR baddie2_love1  WEAPONTYPE_CHAINGUN 30000 // sets weapon to infinate ammo

SET_CHAR_PERSONALITY baddie2_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR baddie2_love1 100

TURN_CHAR_TO_FACE_COORD baddie2_love1 61.0 -335.0 -100.0

ADD_ROUTE_POINT 1 61.0 -318.0 -100.0

ADD_ROUTE_POINT 1 61.0 -335.0 -100.0

SET_CHAR_OBJ_FOLLOW_ROUTE baddie2_love1 1 FOLLOW_ROUTE_LOOP

// Creates the third guard - does not patrol

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 42.0 -375.0 -100.0 baddie3_love1

SET_CHAR_THREAT_SEARCH baddie3_love1 threat_player1

GIVE_WEAPON_TO_CHAR baddie3_love1 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

SET_CHAR_PERSONALITY baddie3_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR baddie3_love1 100

TURN_CHAR_TO_FACE_COORD baddie3_love1 42.0 -373.0 -100.0

// Creates the fourth guard - does not patrol

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 52.0 -375.0 -100.0 baddie4_love1

SET_CHAR_THREAT_SEARCH baddie4_love1 threat_player1

GIVE_WEAPON_TO_CHAR baddie4_love1 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

SET_CHAR_PERSONALITY baddie4_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR baddie4_love1 100

TURN_CHAR_TO_FACE_COORD baddie4_love1 52.0 -371.0 -100.0

// Creates the fifth guard - does not patrol

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 32.0 -345.0 -100.0 baddie5_love1

SET_CHAR_THREAT_SEARCH baddie5_love1 threat_player1

GIVE_WEAPON_TO_CHAR baddie5_love1 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

SET_CHAR_PERSONALITY baddie5_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR baddie5_love1 100

TURN_CHAR_TO_FACE_COORD baddie5_love1 -30.0 -367.0 -100.0

// Creates the sixth guard - does not patrol

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 33.0 -328.0 -100.0 baddie6_love1

SET_CHAR_THREAT_SEARCH baddie6_love1 threat_player1

GIVE_WEAPON_TO_CHAR baddie6_love1 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

SET_CHAR_PERSONALITY baddie6_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR baddie6_love1 100

TURN_CHAR_TO_FACE_COORD baddie6_love1 35.0 -328.0 -100.0

// Garage guard1 in garage 2

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 55.87 -312.77 15.1 garage_baddie1_love1

CLEAR_CHAR_THREAT_SEARCH garage_baddie1_love1

GIVE_WEAPON_TO_CHAR garage_baddie1_love1 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

SET_CHAR_PERSONALITY garage_baddie1_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR garage_baddie1_love1 100

TURN_CHAR_TO_FACE_COORD garage_baddie1_love1 56.0 -321.0 -100.0

// Garage guard2 in garage 2

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 58.24 -312.77 15.1 garage_baddie2_love1

CLEAR_CHAR_THREAT_SEARCH garage_baddie2_love1

GIVE_WEAPON_TO_CHAR garage_baddie2_love1 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

SET_CHAR_PERSONALITY garage_baddie2_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR garage_baddie2_love1 100

TURN_CHAR_TO_FACE_COORD garage_baddie2_love1 56.0 -321.0 -100.0

// Garage guard3 in garage 1

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 66.26 -309.99 15.1 garage_baddie3_love1

CLEAR_CHAR_THREAT_SEARCH garage_baddie3_love1

GIVE_WEAPON_TO_CHAR garage_baddie3_love1 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

SET_CHAR_PERSONALITY garage_baddie3_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR garage_baddie3_love1 100

TURN_CHAR_TO_FACE_COORD garage_baddie3_love1 65.37 -316.30 -100.0

// Garage guard4 in garage 3

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 28.64 -339.83 15.1 garage_baddie4_love1

CLEAR_CHAR_THREAT_SEARCH garage_baddie4_love1

GIVE_WEAPON_TO_CHAR garage_baddie4_love1 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

SET_CHAR_PERSONALITY garage_baddie4_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR garage_baddie4_love1 100

TURN_CHAR_TO_FACE_COORD garage_baddie4_love1 35.26 -339.72 -100.0


// Garage guard5 in garage 4

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 29.8 -350.5 15.1 garage_baddie5_love1

CLEAR_CHAR_THREAT_SEARCH garage_baddie5_love1

GIVE_WEAPON_TO_CHAR garage_baddie5_love1 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

SET_CHAR_PERSONALITY garage_baddie5_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR garage_baddie5_love1 100

TURN_CHAR_TO_FACE_COORD garage_baddie5_love1 34.6 -350.0 -100.0

// Garage guard6 in garage 5

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 46.7 -379.3 15.1 garage_baddie6_love1

CLEAR_CHAR_THREAT_SEARCH garage_baddie6_love1

GIVE_WEAPON_TO_CHAR garage_baddie6_love1 WEAPONTYPE_CHAINGUN 30000 // AK47 sets weapon to infinate ammo

SET_CHAR_PERSONALITY garage_baddie6_love1 PEDSTAT_TOUGH_GUY

//ADD_ARMOUR_TO_CHAR garage_baddie6_love1 100

TURN_CHAR_TO_FACE_COORD garage_baddie6_love1 47.1 -375.9 -100.0

blob_flag = 0

// waiting for the player to get the OGG to Loves

WHILE NOT LOCATE_STOPPED_CHAR_ANY_MEANS_2D ojg_love1 49.0 -1550.0 3.0 4.0 blob_flag

	WAIT 0

	IF IS_CHAR_DEAD ojg_love1
		PRINT_NOW ( LOVE1_6 ) 5000 1 //"The Old Oriental Gentleman is dead!"
		GOTO mission_love1_failed
	ENDIF

// Checks to see while the player is not in the compound if he is in a colombian car or not

	
  IF flag_ojg_in_group = 0
	IF flag_player_in_area_love1 = 0
		
		IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB

			IF flag_player_got_car_message_love1 = 0
				PRINT_NOW ( LOVE1_5 ) 5000 1 //"Get a colombian car and get on with the mission."
				REMOVE_BLIP radar_blip_coord2_love1
				flag_player_got_car_message_love1 = 1
			ENDIF

		ELSE
			
			IF flag_player_got_car_message_love1 = 1
				ADD_BLIP_FOR_COORD 52.0 -343.0 -100.0 radar_blip_coord2_love1
				flag_player_got_car_message_love1 = 0
			ENDIF
		
		ENDIF 
		
	ENDIF

// Checks to see if the player has located close enough to the player to be set into his group	

	

		IF IS_PLAYER_IN_AREA_3D player 92.2 -329.4 15.0 96.4 -315.8 18.0 FALSE

			IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
			AND flag_message_car_again = 0
				//PRINT_NOW ( LOVE1_5 ) 5000 1 //"Get a colombian car and get on with the mission
				PRINT_NOW ( LOVE1_7 ) 5000 1 //"The gate will only open for a Colombian Car.
				flag_message_car_again = 1
			ENDIF

		ELSE
			flag_message_car_again = 0
		ENDIF

 	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ojg_love1 3.0 3.0 FALSE
		SET_PLAYER_AS_LEADER ojg_love1 player
		PRINT_NOW ( LOVE1_3 ) 7000 1 //"Thanks get me back to loves!"
		REMOVE_BLIP radar_blip_coord2_love1
		ADD_BLIP_FOR_COORD 49.1 -1550.5 -100.0 radar_blip_coord1_love1
		blob_flag = 1 
		flag_ojg_in_group = 1
	ENDIF
  ENDIF				
	 

// Checks for the normal guards in the compound
		 	
	IF flag_baddie1_dead_love1 = 0

		IF IS_CHAR_DEAD baddie1_love1
			flag_kill_player_love1 = 1
			flag_baddie1_dead_love1 = 1
		ENDIF

	ENDIF

	IF flag_baddie2_dead_love1 = 0

		IF IS_CHAR_DEAD baddie2_love1
			flag_kill_player_love1 = 1
			flag_baddie2_dead_love1 = 1
		ENDIF

	ENDIF

	IF flag_baddie3_dead_love1 = 0

		IF IS_CHAR_DEAD baddie3_love1
			flag_kill_player_love1 = 1
			flag_baddie3_dead_love1 = 1
		ENDIF

	ENDIF

	IF flag_baddie4_dead_love1 = 0

		IF IS_CHAR_DEAD baddie4_love1
		   flag_kill_player_love1 = 1
		   flag_baddie4_dead_love1 = 1
		ENDIF

	ENDIF

	IF flag_baddie5_dead_love1 = 0

		IF IS_CHAR_DEAD baddie5_love1
			flag_kill_player_love1 = 1
			flag_baddie5_dead_love1 = 1
		ENDIF

	ENDIF

	IF flag_baddie6_dead_love1 = 0

		IF IS_CHAR_DEAD baddie6_love1
			flag_kill_player_love1 = 1
			flag_baddie6_dead_love1 = 1
		ENDIF

	ENDIF

// Checks to see if the garage door is open and if the guards are still alive sets them to kill the player

	IF flag_garage_baddie1_dead_love1 = 0

		IF IS_CHAR_DEAD garage_baddie1_love1
			flag_garage_baddie1_dead_love1 = 1
		ELSE

			IF flag_garage2_open = 1
				SET_CHAR_THREAT_SEARCH garage_baddie1_love1 THREAT_PLAYER1
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS garage_baddie1_love1 player
			ENDIF

		ENDIF

	ENDIF

	IF flag_garage_baddie2_dead_love1 = 0

		IF IS_CHAR_DEAD garage_baddie2_love1
			flag_garage_baddie2_dead_love1 = 1
		ELSE

			IF flag_garage2_open = 1
				SET_CHAR_THREAT_SEARCH garage_baddie2_love1 THREAT_PLAYER1
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS garage_baddie2_love1 player
			ENDIF

		ENDIF

	ENDIF

	IF flag_garage_baddie3_dead_love1 = 0

		IF IS_CHAR_DEAD garage_baddie3_love1
			flag_garage_baddie3_dead_love1 = 1
		ELSE

			IF flag_garage1_open = 1
				SET_CHAR_THREAT_SEARCH garage_baddie3_love1 THREAT_PLAYER1
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS garage_baddie3_love1 player
			ENDIF

		ENDIF

	ENDIF

	IF flag_garage_baddie4_dead_love1 = 0

		IF IS_CHAR_DEAD garage_baddie4_love1
			flag_garage_baddie4_dead_love1 = 1
		ELSE

			IF flag_garage3_open = 1
				SET_CHAR_THREAT_SEARCH garage_baddie4_love1 THREAT_PLAYER1
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS garage_baddie4_love1 player
			ENDIF

		ENDIF

	ENDIF


	IF flag_garage_baddie5_dead_love1 = 0

		IF IS_CHAR_DEAD garage_baddie5_love1
			flag_garage_baddie5_dead_love1 = 1
		ELSE

			IF flag_garage4_open = 1
				SET_CHAR_THREAT_SEARCH garage_baddie5_love1 THREAT_PLAYER1
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS garage_baddie5_love1 player
			ENDIF

			ENDIF

	ENDIF

	IF flag_garage_baddie6_dead_love1 = 0

		IF IS_CHAR_DEAD garage_baddie6_love1
			flag_garage_baddie6_dead_love1 = 1
		ELSE

			IF flag_garage5_open = 1
				SET_CHAR_THREAT_SEARCH garage_baddie6_love1 THREAT_PLAYER1
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS garage_baddie6_love1 player
			ENDIF

		ENDIF

	ENDIF
	
// Checks to see if the player is in the colombian compound and if the guards are alive sets them to kill the player
 	  
	IF FLAG_OJG_IN_GROUP = 0

		IF IS_PLAYER_IN_AREA_3D player 31.0 -317.0 14.0 91.0 -394.0 25.0 FALSE
			flag_kill_player_love1 = 1
	
		ELSE
			IF flag_kill_player_love1 = 1
				flag_player_in_area_love1 = 0
				FLAG_HAD_GARAGE_MESSAGE_LOVE1 = 0
				FLAG_KILL_PLAYER_LOVE1 = 0
		
				IF IS_PLAYER_IN_MODEL player CAR_COLUMB
					FLAG_PLAYER_GOT_CAR_MESSAGE_LOVE1 = 1
				ENDIF
			ENDIF	
		ENDIF	
	ENDIF

	IF flag_kill_player_love1 = 1
		flag_player_in_area_love1 = 1

		IF FLAG_OJG_IN_GROUP = 0
			IF flag_had_garage_message_love1 = 0
				REMOVE_BLIP radar_blip_coord2_love1
				PRINT_NOW ( LOVE1_4 ) 7000 1 //"Walk towards the garages, the Old Oriental Gentleman is in one of them."
				flag_had_garage_message_love1 = 1
			ENDIF
		ENDIF

		IF flag_baddie1_dead_love1 = 0
		
			IF NOT IS_CHAR_DEAD baddie1_love1
			
				IF flag_baddie1_in_area_love1 = 0
					SET_CHAR_OBJ_RUN_TO_COORD baddie1_love1 72.5 -321.9
					flag_baddie1_in_area_love1 = 1
				ENDIF
				
				IF flag_baddie1_in_area_love1 = 1
				
					IF LOCATE_CHAR_ANY_MEANS_2D baddie1_love1 72.5 -321.9 0.5 0.5 FALSE
						SET_CHAR_OBJ_GUARD_SPOT baddie1_love1 72.5 -321.9 15.17
						TURN_CHAR_TO_FACE_PLAYER baddie1_love1 player   
				    	SET_CHAR_STAY_IN_SAME_PLACE baddie1_love1 TRUE
					ENDIF

				ENDIF

			ENDIF

		ENDIF
					
		IF flag_baddie2_dead_love1 = 0

			IF NOT IS_CHAR_DEAD baddie2_love1

				IF flag_baddie2_in_area_love1 = 0
					SET_CHAR_OBJ_RUN_TO_COORD baddie2_love1 66.5 -332.0
					flag_baddie2_in_area_love1 = 1
				ENDIF

				IF flag_baddie2_in_area_love1 = 1
		
					IF LOCATE_CHAR_ANY_MEANS_2D baddie2_love1 66.5 -332.0 0.5 0.5 FALSE
						SET_CHAR_OBJ_GUARD_SPOT baddie2_love1 66.5 -332.0 15.17
						TURN_CHAR_TO_FACE_PLAYER baddie2_love1 player   
				    	SET_CHAR_STAY_IN_SAME_PLACE baddie2_love1 TRUE
					ENDIF
					
				ENDIF
				
			ENDIF	
						
		ENDIF

		IF flag_baddie3_dead_love1 = 0

			IF NOT IS_CHAR_DEAD baddie3_love1

				IF flag_baddie3_in_area_love1 = 0
					SET_CHAR_OBJ_RUN_TO_COORD baddie3_love1 44.4 -360.7
					flag_baddie3_in_area_love1 = 1
				ENDIF
						
				IF flag_baddie3_in_area_love1 = 1

					IF LOCATE_CHAR_ANY_MEANS_2D baddie3_love1 44.4 -360.7 0.5 0.5 FALSE
						SET_CHAR_OBJ_RUN_TO_COORD baddie3_love1 47.9 -360.1
						flag_baddie3_in_area_love1 = 2
					ENDIF
				
				ENDIF
			
				IF flag_baddie3_in_area_love1 = 2
			
					IF LOCATE_CHAR_ANY_MEANS_2D baddie3_love1 47.9 -360.1 0.5 0.5 FALSE
						SET_CHAR_OBJ_GUARD_SPOT baddie3_love1 47.9 -360.1 15.1
						TURN_CHAR_TO_FACE_PLAYER baddie3_love1 player   
				    	SET_CHAR_STAY_IN_SAME_PLACE baddie3_love1 TRUE
					ENDIF

				ENDIF

			ENDIF
						
		ENDIF

		IF flag_baddie4_dead_love1 = 0
		
			IF NOT IS_CHAR_DEAD baddie4_love1

				IF flag_baddie4_in_area_love1 = 0
					SET_CHAR_OBJ_RUN_TO_COORD baddie4_love1 57.0 -365.3
					flag_baddie4_in_area_love1 = 1
				ENDIF
				
				IF flag_baddie4_in_area_love1 = 1
				
					IF LOCATE_CHAR_ANY_MEANS_2D baddie4_love1 57.0 -365.3 0.5 0.5 FALSE
						SET_CHAR_OBJ_GUARD_SPOT baddie4_love1 57.0 -365.3 15.1
						TURN_CHAR_TO_FACE_PLAYER baddie4_love1 player   
				    	SET_CHAR_STAY_IN_SAME_PLACE baddie4_love1 TRUE
					ENDIF
					
				ENDIF
				
			ENDIF  
			
		ENDIF

		IF flag_baddie5_dead_love1 = 0
			
			IF NOT IS_CHAR_DEAD baddie5_love1
			
				IF flag_baddie5_in_area_love1 = 0
					SET_CHAR_OBJ_RUN_TO_COORD baddie5_love1 38.7 -345.1
					flag_baddie5_in_area_love1 = 1
				ENDIF
				
				IF flag_baddie5_in_area_love1 = 1
				
					IF LOCATE_CHAR_ANY_MEANS_2D baddie5_love1 38.7 -345.1 0.5 0.5 FALSE
						SET_CHAR_OBJ_RUN_TO_COORD baddie5_love1 45.8 -344.3
						flag_baddie5_in_area_love1 = 2
					ENDIF

				ENDIF

				IF flag_baddie5_in_area_love1 = 2
				
					IF LOCATE_CHAR_ANY_MEANS_2D baddie5_love1 45.8 -344.3 0.5 0.5 FALSE
						SET_CHAR_OBJ_GUARD_SPOT baddie5_love1 45.8 -344.3 15.1
						TURN_CHAR_TO_FACE_PLAYER baddie5_love1 player   
				     	SET_CHAR_STAY_IN_SAME_PLACE baddie5_love1 TRUE
					ENDIF

				ENDIF

			ENDIF
			  			
		ENDIF

		IF flag_baddie6_dead_love1 = 0

			IF NOT IS_CHAR_DEAD baddie6_love1
			
				IF flag_baddie6_in_area_love1 = 0
					SET_CHAR_OBJ_RUN_TO_COORD baddie6_love1 37.3 -331.0
					flag_baddie6_in_area_love1 = 1
				ENDIF
				
				IF flag_baddie6_in_area_love1 = 1
				
					IF LOCATE_CHAR_ANY_MEANS_2D baddie6_love1 37.3 -331.0 0.5 0.5 FALSE
						SET_CHAR_OBJ_RUN_TO_COORD baddie6_love1 42.5 -331.8
						flag_baddie6_in_area_love1 = 2
					ENDIF

				ENDIF

				IF flag_baddie6_in_area_love1 = 2

					IF LOCATE_CHAR_ANY_MEANS_2D baddie6_love1 42.5 -331.8 0.5 0.5 FALSE
						SET_CHAR_OBJ_GUARD_SPOT baddie6_love1 42.5 -331.8 15.1
						TURN_CHAR_TO_FACE_PLAYER baddie6_love1 player   
				     	SET_CHAR_STAY_IN_SAME_PLACE baddie6_love1 TRUE
					ENDIF
					
				ENDIF
				 
			ENDIF 
			
		ENDIF

// Checks for garage1

		IF IS_PLAYER_IN_AREA_ON_FOOT_3D player 63.01 -317.50 13.0 69.28 -321.73 20.0 FALSE
			
			IF flag_garage1_open = 0
				OPEN_GARAGE garage1_love1
				flag_garage1_open = 1
			ENDIF

		ENDIF
				
// Checks for garage2

		IF IS_PLAYER_IN_AREA_ON_FOOT_3D player 53.7 -317.56 13.0 61.0 -320.46 20.0 FALSE
			
			IF flag_garage2_open = 0
			    OPEN_GARAGE	garage2_love1
				flag_garage2_open = 1
			ENDIF

		ENDIF
	   	   
// Checks for garage3

		IF IS_PLAYER_IN_AREA_ON_FOOT_3D player 31.8 -344.4 13.0 35.1 -335.6 20.0 FALSE
			
			IF flag_garage3_open = 0
				OPEN_GARAGE	garage3_love1
				flag_garage3_open = 1
			ENDIF
			
		ENDIF
						 
// Checks for garage4		

		IF IS_PLAYER_IN_AREA_ON_FOOT_3D player 31.41 -355.6 13.0 34.21 -344.81 20.0 FALSE
			
			IF flag_garage4_open = 0
				OPEN_GARAGE	garage4_love1
				flag_garage4_open = 1
			ENDIF

		ENDIF

		
// Checks for garage5

		IF IS_PLAYER_IN_AREA_ON_FOOT_3D player 52.9 -376.3 13.0 42.0 -373.2 20.0 FALSE
			
			IF flag_garage5_open = 0
				OPEN_GARAGE	garage5_love1
				flag_garage5_open = 1
			ENDIF

		ENDIF
						
	ENDIF

// Checks to see if the OGG is in the players group and does the group breaking stuff
			
IF flag_ojg_in_group = 1

	IF IS_CHAR_DEAD ojg_love1
		PRINT_NOW ( LOVE1_6 ) 5000 1 //"The Old Oriental Gentleman is dead!"
		GOTO mission_love1_failed
	ENDIF
	
	IF NOT IS_CHAR_IN_PLAYERS_GROUP ojg_love1 player 
	AND flag_blip_on_ojg_love1 = 0
		PRINT_NOW ( HEY8 ) 5000 1 //"You have left the Old Oriental Gentleman behind go and get him!"
		ADD_BLIP_FOR_CHAR ojg_love1 radar_blip_ped1_love1
		REMOVE_BLIP radar_blip_coord1_love1
		flag_blip_on_ojg_love1 = 1
		blob_flag = 0
	ENDIF 

	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player ojg_love1 8.0 8.0 FALSE 
	AND flag_blip_on_ojg_love1 = 1
		SET_PLAYER_AS_LEADER ojg_love1 player
		PRINT_NOW ( LOVE1_3 ) 7000 1 //"Thanks get me back to loves!"
		REMOVE_BLIP radar_blip_ped1_love1
		ADD_BLIP_FOR_COORD 49.1 -1550.5 -100.0 radar_blip_coord1_love1
		flag_blip_on_ojg_love1 = 0
		blob_flag = 1
	ENDIF
	
ENDIF	

ENDWHILE

REMOVE_BLIP radar_blip_coord1_love1

LEAVE_GROUP ojg_love1

SWITCH_WIDESCREEN ON

SET_PLAYER_CONTROL player OFF

SET_POLICE_IGNORE_PLAYER player ON

SET_EVERYONE_IGNORE_PLAYER player ON

// Checks to see if the OJG is in a car, if so orders him to get out 

IF IS_CHAR_IN_ANY_CAR ojg_love1

	STORE_CAR_CHAR_IS_IN ojg_love1 car2_love1

	SET_CHAR_OBJ_LEAVE_CAR ojg_love1 car2_love1

	WHILE IS_CHAR_IN_ANY_CAR ojg_love1

		WAIT 0

		IF IS_CHAR_DEAD ojg_love1
			PRINT_NOW ( LOVe1_6 ) 5000 1 //"The Old Oriental Gentleman is dead!"
			GOTO mission_love1_failed
		ENDIF

	ENDWHILE

ENDIF

// Tells the OJG to go into Loves buildings

SET_CHAR_OBJ_RUN_TO_COORD ojg_love1 59.5 -1548.7

timerb = 0

WHILE timerb < 1500

	WAIT 0

	IF IS_CHAR_DEAD ojg_love1
		PRINT_NOW ( LOVe1_6 ) 5000 1 //"The Old Oriental Gentleman is dead!"
		GOTO mission_love1_failed
	ENDIF

ENDWHILE


SET_CHAR_COORDINATES ojg_love1 82.9 -1548.9 27.2 
SET_CHAR_HEADING ojg_love1 270.0

SET_CHAR_OBJ_GOTO_COORD_ON_FOOT ojg_love1 98.7 -1548.8

SET_FIXED_CAMERA_POSITION 77.5 -1548.8 28.2 0.0 0.0 0.0

POINT_CAMERA_AT_POINT 93.9 -1548.9 28.3 JUMP_CUT

timerb = 0

WHILE NOT LOCATE_CHAR_ON_FOOT_3D ojg_love1 98.7 -1548.8 27.3 0.5 0.5 4.0 FALSE

	WAIT 0

	IF IS_CHAR_DEAD ojg_love1
		PRINT_NOW ( LOVe1_6 ) 5000 1 //"The Old Oriental Gentleman is dead!"
		GOTO mission_love1_failed
	ENDIF

	IF timerb >= 8000

		IF NOT LOCATE_CHAR_ON_FOOT_3D ojg_love1 98.7 -1548.8 27.3 0.5 0.5 4.0 FALSE
			REMOVE_CHAR_ELEGANTLY ojg_love1
			GOTO mission_bloke_stuck_love1
		ENDIF
		
	ENDIF

ENDWHILE
 
mission_bloke_stuck_love1:

CHAR_SET_IDLE ojg_love1

RESTORE_CAMERA_JUMPCUT

REMOVE_CHAR_ELEGANTLY ojg_love1

SWITCH_WIDESCREEN OFF

SET_PLAYER_CONTROL player ON

SET_POLICE_IGNORE_PLAYER player OFF

SET_EVERYONE_IGNORE_PLAYER player OFF
}

GOTO mission_love1_passed


// Mission Kenji5 failed

mission_love1_failed:

// close the garages on a fail or they'll stay open on the next attempt
IF flag_garage1_open = 1
	CLOSE_GARAGE garage1_love1
	flag_garage1_open = 0
ENDIF
IF flag_garage2_open = 1
	CLOSE_GARAGE garage2_love1
	flag_garage2_open = 0
ENDIF
IF flag_garage3_open = 1
	CLOSE_GARAGE garage3_love1
	flag_garage3_open = 0
ENDIF
IF flag_garage4_open = 1
	CLOSE_GARAGE garage4_love1
	flag_garage4_open = 0
ENDIF
IF flag_garage5_open = 1
	CLOSE_GARAGE garage5_love1
	flag_garage5_open = 0
ENDIF

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
flag_failed_love1 = 1

RETURN

   

// mission Kenji5 passed

mission_love1_passed:

flag_love_mission1_passed = 1
REGISTER_MISSION_PASSED ( LOVE1 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( m_pass ) 40000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 40000
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT love_mission2_loop
RETURN
		


// mission cleanup

mission_cleanup_love1:

flag_player_on_mission = 0
flag_player_on_love_mission = 0
REMOVE_ROUTE 0
REMOVE_ROUTE 1

IF IS_PLAYER_PLAYING Player  // This check is required (at least to debug mission jump here).
    SET_PLAYER_CONTROL player ON
ENDIF

MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_COLUMB
REMOVE_BLIP radar_blip_ped1_love1
REMOVE_BLIP radar_blip_coord1_love1
REMOVE_BLIP radar_blip_coord2_love1

IF NOT IS_CHAR_DEAD baddie1_love1 
	SET_CHAR_STAY_IN_SAME_PLACE baddie1_love1 FALSE
ENDIF

IF NOT IS_CHAR_DEAD baddie2_love1 
	SET_CHAR_STAY_IN_SAME_PLACE baddie2_love1 FALSE
ENDIF

IF NOT IS_CHAR_DEAD baddie3_love1 
	SET_CHAR_STAY_IN_SAME_PLACE baddie3_love1 FALSE
ENDIF

IF NOT IS_CHAR_DEAD baddie4_love1 
	SET_CHAR_STAY_IN_SAME_PLACE baddie4_love1 FALSE
ENDIF

IF NOT IS_CHAR_DEAD baddie5_love1 
	SET_CHAR_STAY_IN_SAME_PLACE baddie5_love1 FALSE
ENDIF

IF NOT IS_CHAR_DEAD baddie6_love1 
	SET_CHAR_STAY_IN_SAME_PLACE baddie6_love1 FALSE
ENDIF

MISSION_HAS_FINISHED
RETURN
		


MISSION_START
// *****************************************************************************************
// *********************************    Love mission 2   *********************************** 
// *********************************  Assassinate Kenji  ***********************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_love2
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_love2_failed
ENDIF

GOSUB mission_cleanup_love2

MISSION_END
 
// Variables for mission


VAR_FLOAT carpark_minx carpark_miny carpark_maxx carpark_maxy
VAR_FLOAT carpark_minz carpark_maxz

VAR_INT blip_carpark blip_kenji_love2
VAR_INT flag_carpark_blip

//VAR_INT test_car_love2//test stuff

VAR_INT flag_kenji_dead flag_yak_created_love2 flag_wanted_love2 flag_kenji_look
VAR_INT flag_message flag_yak_attack_love2 flag_player_clear flag_kenji_cut
VAR_INT timer_kenji_cut_start timer_kenji_cut_dif timer_kenji_cut_now

VAR_INT kenji_car_love2 yak_car_1_love2 yak_car_2_love2
VAR_INT yak_1_love2 yak_2_love2 yak_3_love2 yak_4_love2
VAR_INT yak_5_love2 yak_6_love2 yak_7_love2 yak_8_love2
VAR_INT counter_kenji_guards_dead
VAR_INT flag_1_dead_love2 flag_2_dead_love2 flag_3_dead_love2 flag_4_dead_love2
VAR_INT flag_5_dead_love2 flag_6_dead_love2 flag_7_dead_love2 flag_8_dead_love2
//VAR_INT flag_1_dead_love2 flag_1_dead_love2 flag_1_dead_love2 flag_1_dead_love2

//VAR_INT yak_9_love2 yak_10_love2 yak_11_love2 yak_12_love2

//VAR_INT kenji


//+++++++++++++++++++++++++++CREATE PEDS GOSUB++++++++++++++++++++++++++++++++++++++++++++
create_yakuza:

IF flag_yak_created_love2 = 0
		CREATE_CAR CAR_YAKUZA 302.0 -550.0 37.0 kenji_car_love2
		SET_CAR_HEADING kenji_car_love2 90.0
		CAR_SET_IDLE kenji_car_love2
		SET_CAR_ONLY_DAMAGED_BY_PLAYER kenji_car_love2 False

		CREATE_CAR CAR_STRETCH 291.4 -547.0 37.0 yak_car_1_love2
		SET_CAR_HEADING yak_car_1_love2 320.0
		CAR_SET_IDLE yak_car_1_love2
		SET_CAR_ONLY_DAMAGED_BY_PLAYER yak_car_1_love2 False
	
		CREATE_CAR CAR_YAKUZA 294.6 -558.0 37.0 yak_car_2_love2
		SET_CAR_HEADING yak_car_2_love2 96.0
		CAR_SET_IDLE yak_car_2_love2
		SET_CAR_ONLY_DAMAGED_BY_PLAYER yak_car_2_love2 False
		
		CREATE_CAR CAR_STRETCH 299.4 -540.0 37.0 yak_car_1_love2
		SET_CAR_HEADING yak_car_1_love2 296.0
		CAR_SET_IDLE yak_car_1_love2
		SET_CAR_ONLY_DAMAGED_BY_PLAYER yak_car_1_love2 False

		CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A 286.4 -543.5 37.0 yak_1_love2
		SET_CHAR_HEADING yak_1_love2 180.0
		//SET_CHAR_OBJ_GUARD_AREA yak_1_love2 267.7 -592.0 306.0 -480.0

		CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_B 304.5 -544.3 37.0 yak_2_love2
		SET_CHAR_HEADING yak_2_love2 40.0
		//SET_CHAR_OBJ_GUARD_AREA yak_2_love2 MinX MinY MaxX MaxY
		ADD_ARMOUR_TO_CHAR yak_2_love2 100

		CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A 299.25 -534.0 37.0 yak_3_love2
		SET_CHAR_HEADING yak_3_love2 20.0
		//SET_CHAR_OBJ_GUARD_AREA yak_3_love2 MinX MinY MaxX MaxY

		CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_B 295.0 -562.0 37.0 yak_4_love2
		SET_CHAR_HEADING yak_4_love2 180.0
		//SET_CHAR_OBJ_GUARD_AREA yak_4_love2 MinX MinY MaxX MaxY

		CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A 295.0 -544.0 37.0 yak_5_love2
		SET_CHAR_HEADING yak_5_love2 15.0
		//SET_CHAR_OBJ_GUARD_AREA yak_5_love2 267.7 -592.0 306.0 -480.0
		ADD_ARMOUR_TO_CHAR yak_5_love2 100

		CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_B 300.0 -556.0 37.0 yak_6_love2
		SET_CHAR_HEADING yak_6_love2 160.0
		//SET_CHAR_OBJ_GUARD_AREA yak_4_love2 MinX MinY MaxX MaxY
		
		CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_B 301.0 -516.0 37.0 yak_7_love2
		SET_CHAR_HEADING yak_7_love2 45.0
		//SET_CHAR_OBJ_GUARD_AREA yak_4_love2 MinX MinY MaxX MaxY
		
		CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_B 273.0 -570.0 37.0 yak_8_love2
		SET_CHAR_HEADING yak_8_love2 260.0
		//SET_CHAR_OBJ_GUARD_AREA yak_4_love2 MinX MinY MaxX MaxY

		GIVE_WEAPON_TO_CHAR yak_1_love2 WEAPONTYPE_M16 80
		GIVE_WEAPON_TO_CHAR yak_2_love2 WEAPONTYPE_UZI 60
		GIVE_WEAPON_TO_CHAR yak_3_love2 WEAPONTYPE_UZI 60
		SET_CHAR_ACCURACY yak_3_love2 40
		GIVE_WEAPON_TO_CHAR yak_4_love2 WEAPONTYPE_UZI 60
		SET_CHAR_ACCURACY yak_4_love2 40
		GIVE_WEAPON_TO_CHAR yak_5_love2 WEAPONTYPE_UZI 60
		SET_CHAR_ACCURACY yak_5_love2 40
		GIVE_WEAPON_TO_CHAR yak_6_love2 WEAPONTYPE_UZI 60
		GIVE_WEAPON_TO_CHAR yak_7_love2 WEAPONTYPE_SHOTGUN 25
		GIVE_WEAPON_TO_CHAR yak_8_love2 WEAPONTYPE_UZI 60
		SET_CHAR_ACCURACY yak_8_love2 40

		SET_CHAR_THREAT_SEARCH yak_1_love2 THREAT_PLAYER1
		SET_CHAR_THREAT_SEARCH yak_2_love2 THREAT_PLAYER1
		SET_CHAR_THREAT_SEARCH yak_3_love2 THREAT_PLAYER1
		SET_CHAR_THREAT_SEARCH yak_4_love2 THREAT_PLAYER1
		SET_CHAR_THREAT_SEARCH yak_5_love2 THREAT_PLAYER1
		SET_CHAR_THREAT_SEARCH yak_6_love2 THREAT_PLAYER1
		SET_CHAR_THREAT_SEARCH yak_7_love2 THREAT_PLAYER1
		SET_CHAR_THREAT_SEARCH yak_8_love2 THREAT_PLAYER1

		CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 304.2 -543.1 36.3 kenji
		SET_CHAR_HEADING kenji 140.0
		SET_CHAR_THREAT_SEARCH kenji THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR kenji WEAPONTYPE_UZI 60
		ADD_ARMOUR_TO_CHAR kenji 100
		ADD_BLIP_FOR_CHAR kenji blip_kenji_love2
		SET_CHAR_STAY_IN_SAME_PLACE kenji true
		flag_yak_created_love2 = 1
	ENDIF


RETURN



player_wanted_love2:

	IF flag_yak_created_love2 = 1
	AND flag_wanted_love2 = 0
		IF IS_CHAR_DEAD yak_1_love2
			ALTER_WANTED_LEVEL_NO_DROP player 3
			flag_wanted_love2 = 1
		ENDIF
		IF IS_CHAR_DEAD yak_2_love2
			ALTER_WANTED_LEVEL_NO_DROP player 3
			flag_wanted_love2 = 1
		ENDIF
		IF IS_CHAR_DEAD yak_3_love2
			ALTER_WANTED_LEVEL_NO_DROP player 3
			flag_wanted_love2 = 1
		ENDIF
		IF IS_CHAR_DEAD yak_4_love2
			ALTER_WANTED_LEVEL_NO_DROP player 3
			flag_wanted_love2 = 1
		ENDIF
		IF IS_CHAR_DEAD yak_5_love2
			ALTER_WANTED_LEVEL_NO_DROP player 3
			flag_wanted_love2 = 1
		ENDIF
		IF IS_CHAR_DEAD yak_6_love2
			ALTER_WANTED_LEVEL_NO_DROP player 3
			flag_wanted_love2 = 1
		ENDIF
		IF IS_CHAR_DEAD yak_7_love2
			ALTER_WANTED_LEVEL_NO_DROP player 3
			flag_wanted_love2 = 1
		ENDIF
		IF IS_CHAR_DEAD yak_8_love2
			ALTER_WANTED_LEVEL_NO_DROP player 3
			flag_wanted_love2 = 1
		ENDIF

	ENDIF


RETURN




// ****************************************Mission Start************************************

mission_start_love2:
REGISTER_MISSION_GIVEN
SCRIPT_NAME love2 
flag_player_on_mission = 1
flag_player_on_love_mission = 1
WAIT 0

flag_carpark_blip = 0
flag_kenji_dead = 0
flag_message = 0
flag_yak_created_love2 = 0
flag_wanted_love2 = 0
flag_yak_attack_love2 = 0
flag_player_clear = 0
flag_kenji_cut = 0
flag_kenji_look = 0

flag_1_dead_love2 = 0
flag_2_dead_love2 = 0
flag_3_dead_love2 = 0
flag_4_dead_love2 = 0
flag_5_dead_love2 = 0
flag_6_dead_love2 = 0
flag_7_dead_love2 = 0
flag_8_dead_love2 = 0

counter_kenji_guards_dead = 0

carpark_minx = 265.5
carpark_miny = -610.5
carpark_maxx = 345.5
carpark_maxy = -479.5

carpark_minz = 32.5
carpark_maxz = 50.0

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_love2_failed
ENDIF

SET_FADING_COLOUR 0 0 0
 
DO_FADE 1500 FADE_OUT
 
PRINT_BIG ( LOVE2 ) 15000 2	//"Love Mission 2"

SWITCH_STREAMING OFF
*/

REQUEST_MODEL tshrorckgrdn
REQUEST_MODEL tshrorckgrdn_alfas

WHILE NOT HAS_MODEL_LOADED tshrorckgrdn_alfas
OR NOT HAS_MODEL_LOADED tshrorckgrdn
 WAIT 0
ENDWHILE

// ****************************************START OF CUTSCENE********************************
 
LOAD_SPECIAL_CHARACTER 1 love
//LOAD_SPECIAL_CHARACTER 2 butler

LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 LOVEH
//LOAD_SPECIAL_MODEL cut_obj3 BUTLERH 

/*
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
*/

LOAD_ALL_MODELS_NOW


WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
//OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
//OR NOT HAS_MODEL_LOADED cut_obj3
 WAIT 0
ENDWHILE

 
LOAD_CUTSCENE d2_kk

SWITCH_STREAMING ON
 
SET_CUTSCENE_OFFSET 85.2162 -1532.9093 243.5422
 
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player
 
CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_love
SET_CUTSCENE_ANIM cs_love love

//CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_butler
//SET_CUTSCENE_ANIM cs_butler butler
 
CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player
 
CREATE_CUTSCENE_HEAD cs_love CUT_OBJ2 cs_lovehead
SET_CUTSCENE_HEAD_ANIM cs_lovehead love

//CREATE_CUTSCENE_HEAD cs_butler CUT_OBJ3 cs_butlerhead
//SET_CUTSCENE_HEAD_ANIM cs_butlerhead butler
  
SET_PLAYER_COORDINATES player 85.0 -1548.2 28.3
 
SET_PLAYER_HEADING player 90.0
 
DO_FADE 250 FADE_IN

SWITCH_RUBBISH OFF 

START_CUTSCENE
//SWITCH_STREAMING OFF
 
// Displays cutscene text
 
GET_CUTSCENE_TIME cs_time

WHILE cs_time < 5434
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW (LOVE2_A) 4000 1	//"Nothing drives down real estate prices like a good old fashi etc..."
//MESSAGE_WAIT 3000 true
 
WHILE cs_time < 9893
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (LOVE2_B) 4500 1	//"....but that might be going too far in this etc."
//MESSAGE_WAIT 3000 true
 
WHILE cs_time < 14631
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (LOVE2_C) 4000 1	//"I want you to kill the Yakuza WAKA-gashira, Kenji Kasen."
//MESSAGE_WAIT 3000 true
 
WHILE cs_time < 18811
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (LOVE2_D) 3000 1	//"I've learned .....t the top of the multi-story carpark in Newport."
//MESSAGE_WAIT 3000 true

WHILE cs_time < 21947
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW (LOVE2_E) 3500 1	//"The Yakuza must blame.....Steal a Cartel car and take out Kenji!"
//MESSAGE_WAIT 3000 true

WHILE cs_time < 26266
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW (LOVE2_F) 3500 1	//"The Yakuza must blame.....Steal a Cartel car and take out Kenji!"
//MESSAGE_WAIT 3000 true

WHILE cs_time < 30656
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW (LOVE2_G) 3000 1	//"The Yakuza must blame.....Steal a Cartel car and take out Kenji!"
//MESSAGE_WAIT 3000 true

WHILE cs_time < 33442
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW (LOVE2_H) 4500 1	//"The Yakuza must blame.....Steal a Cartel car and take out Kenji!"
//MESSAGE_WAIT 3000 true

WHILE cs_time < 41066
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

 
DO_FADE 1500 FADE_OUT
 
WHILE NOT HAS_CUTSCENE_FINISHED
 WAIT 0
ENDWHILE
  
CLEAR_PRINTS

WHILE GET_FADING_STATUS
 WAIT 0
ENDWHILE
 
CLEAR_CUTSCENE
 
DO_FADE 0 FADE_OUT
 
SET_CAMERA_BEHIND_PLAYER
 
WAIT 500
 
DO_FADE 1500 FADE_IN 
 
//WHILE GET_FADING_STATUS
// WAIT 0
//ENDWHILE
 
//SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE
 
UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3

MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn
MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn_alfas

//SWITCH_STREAMING ON 
SWITCH_RUBBISH ON
// ******************************************END OF CUTSCENE********************************

/*
//++++++++++++++++++++++++++++++++++++++++++++CUT SCENE++++++++++++++++++++++++++++++++++

PRINT_BIG ( LOVE2 ) 15000 2	//"Love Mission 2"

SET_PLAYER_CONTROL player OFF
 
DO_FADE 1500 FADE_OUT
 
WAIT 1500
 
SWITCH_WIDESCREEN ON
 
SET_PLAYER_COORDINATES player 114.24 -1543.31 246.03
//SET_PLAYER_HEADING player Heading 
 
LOAD_SPECIAL_CHARACTER 1 misty
 
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
 WAIT 0
ENDWHILE
 
CREATE_CHAR PEDTYPE_CIVMALE PED_SPECIAL1 126.6 -1556.5 246.39 love
TURN_CHAR_TO_FACE_PLAYER love player
 
DO_FADE 1500 FADE_IN
 
WAIT 1500
 
GET_PLAYER_CHAR player script_controlled_player

IF IS_CHAR_DEAD love
	GOTO mission_love2_failed 
ENDIF

SET_CHAR_OBJ_GOTO_CHAR_ON_FOOT script_controlled_player love
 
WHILE NOT LOCATE_PLAYER_ON_FOOT_CHAR_2D player love 3.0 3.0 0
	WAIT 0
	IF IS_CHAR_DEAD love
		GOTO mission_love2_failed 
	ENDIF

ENDWHILE
 
TURN_CHAR_TO_FACE_PLAYER love player
TURN_CHAR_TO_FACE_CHAR script_controlled_player love
 
PRINT_NOW (LOVE2_A) 3000 1	//"Nothing drives down real estate prices like a good old fashi etc..."
MESSAGE_WAIT 3000 true
PRINT_NOW (LOVE2_B) 3000 1	//"....but that might be going too far in this etc."
MESSAGE_WAIT 3000 true
PRINT_NOW (LOVE2_C) 3000 1	//"I want you to kill the Yakuza WAKA-gashira, Kenji Kasen."
MESSAGE_WAIT 3000 true
PRINT_NOW (LOVE2_D) 3000 1	//"I've learned .....t the top of the multi-story carpark in Newport."
MESSAGE_WAIT 3000 true
PRINT_NOW (LOVE2_E) 3000 1	//"The Yakuza must blame.....Steal a Cartel car and take out Kenji!"
MESSAGE_WAIT 3000 true
*/
/* 
SET_CHAR_OBJ_GOTO_COORD_ON_FOOT script_controlled_player 114.24 -1543.31
 
WHILE NOT IS_CHAR_OBJECTIVE_PASSED script_controlled_player
 WAIT 0
ENDWHILE

//SET_CHAR_OBJ_NO_OBJ script_controlled_player
 
DO_FADE 1500 FADE_OUT
WAIT 1500
 
SWITCH_WIDESCREEN OFF
SET_PLAYER_COORDINATES player 85.1 -1548.8 28.3
//SET_PLAYER_HEADING player Heading
 
DELETE_CHAR love
UNLOAD_SPECIAL_CHARACTER 1
 
DO_FADE 1500 FADE_IN
WAIT 1500
 
SET_PLAYER_CONTROL player ON



//++++++++++++++++++++++++++++++++++++++++++++++++CUTSCENE OVER+++++++++++++++++++++++++++++
*/


LOAD_SPECIAL_CHARACTER 1 kenji
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
	WAIT 0
ENDWHILE

REQUEST_MODEL PED_GANG_YAKUZA_A
WHILE NOT HAS_MODEL_LOADED PED_GANG_YAKUZA_A
	WAIT 0
ENDWHILE

REQUEST_MODEL PED_GANG_YAKUZA_B
WHILE NOT HAS_MODEL_LOADED PED_GANG_YAKUZA_B
	WAIT 0
ENDWHILE

REQUEST_MODEL CAR_YAKUZA
WHILE NOT HAS_MODEL_LOADED CAR_YAKUZA
	WAIT 0
ENDWHILE

REQUEST_MODEL CAR_STRETCH
WHILE NOT HAS_MODEL_LOADED CAR_STRETCH
	WAIT 0
ENDWHILE

LOAD_MISSION_AUDIO LO2_A

/*
REQUEST_MODEL CAR_COLUMB//test stuff
WHILE NOT HAS_MODEL_LOADED CAR_COLUMB
	WAIT 0
ENDWHILE

PRINT_NOW (LOVE2_3) 3000 1//test stuff
CREATE_CAR CAR_COLUMB 54.0 -1625.0 -100.0 test_car_love2//test stuff
CAR_SET_IDLE test_car_love2//test stuff
*/

//While loop 1: player not at carpark AND player not in CAR_COLUMB

while_loop_1:
	WHILE flag_kenji_dead = 0
		WAIT 0
		IF IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			flag_message = 3
			GOTO while_loop_4
		ENDIF
		
		IF IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND NOT IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			flag_message = 1
			GOTO while_loop_2
		ENDIF
		
		IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			flag_message = 2
			GOTO while_loop_3
		ENDIF
		IF flag_message = 0
			PRINT_NOW (LOVE2_1) 6000 1 //"Go and steal a Colombian Gangcar!"
			WAIT 3000
			flag_message = 1
		ENDIF



	ENDWHILE

		   		
//While loop 2: player not at carpark AND player in CAR_COLUMB

while_loop_2:
	WHILE flag_kenji_dead = 0
		WAIT 0
		IF IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			flag_message = 3
			GOTO while_loop_4
		ENDIF
		
		IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND NOT IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			flag_message = 0
			GOTO while_loop_1
		ENDIF
		
		IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			flag_message = 2
			GOTO while_loop_3
		ENDIF
		IF flag_message = 1
			PRINT_NOW (LOVE2_2) 4000 1 //"Now get to the multi-storey in Newport and kill Kenji!"
			WAIT 3000
			flag_message = 0
		ENDIF

		IF flag_carpark_blip = 0
			ADD_BLIP_FOR_COORD 305.0 -545.0 30.0 blip_carpark
			flag_carpark_blip = 1
		ENDIF



	ENDWHILE

//While loop 3: player at carpark AND NOT in CAR_COLUMB

while_loop_3:
	IF flag_carpark_blip = 1
		REMOVE_BLIP blip_carpark
		flag_carpark_blip = 0
	ENDIF

	WHILE flag_kenji_dead = 0
		WAIT 0
		IF IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			flag_message = 3
			GOTO while_loop_4
		ENDIF
		
		IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND NOT IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			flag_message = 0
			GOTO while_loop_1
		ENDIF
		
		IF IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND NOT IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			flag_message = 1
			GOTO while_loop_2
		ENDIF

		IF flag_message = 2
			PRINT_NOW (LOVE2_3) 3000 1	//If you proceed without a Cartel car you will be identified!
			flag_message = 0
		ENDIF

		IF NOT IS_PLAYER_IN_ANY_CAR player 
		AND IS_PLAYER_IN_AREA_3D player carpark_minx carpark_miny carpark_minz carpark_maxx carpark_maxy carpark_maxz false
			PRINT_NOW (LOVE2_4) 3000 1 //The Yakuza have identified you!
			IF flag_yak_created_love2 = 1
				IF NOT IS_CHAR_DEAD kenji
				AND NOT IS_CAR_DEAD kenji_car_love2
					SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER kenji kenji_car_love2
				ENDIF
			ENDIF
			GOTO mission_love2_failed
		ENDIF
		
		IF IS_PLAYER_IN_AREA_3D player carpark_minx carpark_miny 35.0 carpark_maxx carpark_maxy carpark_maxz false
			IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
				PRINT_NOW (LOVE2_4) 3000 1 //The Yakuza have identified you!
				IF flag_yak_created_love2 = 1
					IF NOT IS_CHAR_DEAD kenji
					AND NOT IS_CAR_DEAD kenji_car_love2
						SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER kenji kenji_car_love2
					ENDIF
				ENDIF
				GOTO mission_love2_failed
			ENDIF
		ENDIF
					
		
		GOSUB create_yakuza
		GOSUB player_wanted_love2	
		
		IF flag_wanted_love2 = 1
			PLAY_MISSION_AUDIO
			flag_wanted_love2 = 2
		ENDIF

		 
	ENDWHILE

//While loop 4: player at carpark AND in CAR_COLUMB

while_loop_4:
	IF flag_carpark_blip = 1
		REMOVE_BLIP blip_carpark
		flag_carpark_blip = 0
	ENDIF
	
	WHILE flag_kenji_dead = 0
		WAIT 0
		
		IF IS_PLAYER_IN_MODEL player CAR_COLUMB
			STORE_CAR_PLAYER_IS_IN player player_car
			SET_CAR_STRONG player_car true
		ENDIF
		/*
		IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND IS_PLAYER_IN_AREA_3D	player carpark_minx carpark_miny carpark_minz carpark_maxx carpark_maxy carpark_maxz false
			PRINT_NOW (LOVE2_4) 3000 1 //The Yakuza have identified you!
			GOTO mission_love2_failed
		ENDIF
		*/
		IF flag_yak_attack_love2 = 0
		AND IS_PLAYER_IN_AREA_3D	player carpark_minx carpark_miny carpark_minz carpark_maxx carpark_maxy carpark_maxz false
			IF NOT IS_CHAR_DEAD yak_7_love2
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS yak_7_love2 player
			ENDIF
			IF NOT IS_CHAR_DEAD yak_8_love2
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS yak_8_love2 player
			ENDIF 
			flag_yak_attack_love2 = 1 
		ENDIF

		IF NOT IS_PLAYER_IN_ANY_CAR player 
		AND IS_PLAYER_IN_AREA_3D player carpark_minx carpark_miny carpark_minz carpark_maxx carpark_maxy carpark_maxz false
			PRINT_NOW (LOVE2_4) 3000 1 //The Yakuza have identified you!
			IF flag_yak_created_love2 = 1
				IF NOT IS_CHAR_DEAD kenji
				AND NOT IS_CAR_DEAD kenji_car_love2
					SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER kenji kenji_car_love2
				ENDIF
			ENDIF
			GOTO mission_love2_failed
		ENDIF
		
		IF IS_PLAYER_IN_AREA_3D player carpark_minx carpark_miny 35.0 carpark_maxx carpark_maxy carpark_maxz false
			IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
				PRINT_NOW (LOVE2_4) 3000 1 //The Yakuza have identified you!
				IF flag_yak_created_love2 = 1
					IF NOT IS_CHAR_DEAD kenji
					AND NOT IS_CAR_DEAD kenji_car_love2
						SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER kenji kenji_car_love2
					ENDIF
				ENDIF
				GOTO mission_love2_failed
			ELSE
				IF NOT IS_CHAR_DEAD kenji
					TURN_CHAR_TO_FACE_PLAYER kenji player
				ENDIF
			ENDIF
		ENDIF

		IF IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND NOT IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			IF NOT IS_CHAR_DEAD yak_7_love2
				SET_CHAR_OBJ_NO_OBJ yak_7_love2
			ENDIF
			IF NOT IS_CHAR_DEAD yak_8_love2
				SET_CHAR_OBJ_NO_OBJ yak_8_love2
			ENDIF
			flag_yak_attack_love2 = 0
			flag_message = 1
			GOTO while_loop_2
		ENDIF
		
		IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND NOT IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			flag_message = 0
			GOTO while_loop_1
		ENDIF
		
		IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND IS_PLAYER_IN_AREA_2D player carpark_minx carpark_miny carpark_maxx carpark_maxy false
			flag_message = 2
			GOTO while_loop_3
		ENDIF
		
		
		IF flag_yak_created_love2 = 1
		AND flag_kenji_cut = 0
		AND IS_PLAYER_IN_MODEL player CAR_COLUMB
			IF IS_PLAYER_IN_AREA_3D player 317.2 -603.5 33.0 332.0 -593.1 35.0 false
				flag_kenji_cut = 1
				GOSUB kenji_cut
			ENDIF
			IF IS_PLAYER_IN_AREA_3D player 317.2 -506.3 33.0 332.0 -497.3 35.0 false
				flag_kenji_cut = 2
				GOSUB kenji_cut
			ENDIF
		ENDIF

		GOSUB create_yakuza
		GOSUB player_wanted_love2	
		
		IF flag_wanted_love2 = 1
			PLAY_MISSION_AUDIO
			flag_wanted_love2 = 2
		ENDIF
		
		GOSUB yak_death_count

		IF IS_CHAR_DEAD kenji
			flag_kenji_dead = 1
			REMOVE_BLIP blip_kenji_love2
		ENDIF

	ENDWHILE

	WHILE flag_player_clear = 0
		WAIT 0
		
		IF flag_kenji_dead = 1
			PRINT_NOW (LOVE2_5) 3000 1//Kenji is dead!! Get out of NEWPORT and dump the Cartel car!!
			flag_kenji_dead = 2
		ENDIF
		
		GOSUB yak_death_count

		IF counter_kenji_guards_dead = 8
			PRINT_NOW (LOVE2_6) 3000 1//You've killed all the witnesses!!
			GOTO mission_love2_failed
		ENDIF

		IF NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND IS_PLAYER_IN_AREA_3D player carpark_minx carpark_miny carpark_minz carpark_maxx carpark_maxy carpark_maxz false
			PRINT_NOW (LOVE2_4) 3000 1 //The Yakuza have identified you!
			GOTO mission_love2_failed
		ENDIF
		
		IF NOT IS_PLAYER_IN_ZONE player COM_EAS
		AND IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND flag_kenji_dead = 2
			PRINT_NOW (LOVE2_7) 3000 1 //Now dump the car!
			flag_kenji_dead = 3
		ENDIF

		IF IS_PLAYER_IN_ZONE player COM_EAS
		AND NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
		AND flag_kenji_dead = 2
			PRINT_NOW (LOVE2_8) 3000 1 //Now get out of Newport!
			flag_kenji_dead = 3
		ENDIF
		
		IF NOT IS_PLAYER_IN_ZONE player COM_EAS
		AND NOT IS_PLAYER_IN_MODEL player CAR_COLUMB
			flag_player_clear = 1
		ENDIF

	ENDWHILE


GOTO mission_love2_passed

// Mission Love 2 failed

mission_love2_failed:

PRINT_BIG ( M_FAIL ) 2000 1
REMOVE_BLIP blip_kenji_love2
REMOVE_CHAR_ELEGANTLY kenji

RETURN

   

// mission Love 2 passed

mission_love2_passed:

flag_love_mission2_passed = 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 30000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
CLEAR_WANTED_LEVEL player
ADD_SCORE player 30000
REGISTER_MISSION_PASSED LOVE2
PLAYER_MADE_PROGRESS 1 
REMOVE_BLIP kenji_contact_blip
START_NEW_SCRIPT love_mission3_loop

RETURN
		


// mission cleanup

mission_cleanup_love2:


IF flag_carpark_blip = 1
	REMOVE_BLIP blip_carpark
ENDIF

REMOVE_BLIP blip_kenji_love2
REMOVE_CHAR_ELEGANTLY kenji


UNLOAD_SPECIAL_CHARACTER 1

RESTORE_CAMERA_JUMPCUT
SET_PLAYER_CONTROL player on
SWITCH_WIDESCREEN off

flag_player_on_mission = 0
flag_player_on_love_mission = 0

MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_B
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STRETCH
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_YAKUZA

MISSION_HAS_FINISHED
RETURN

//-----------------------------GOSUBS--------------------------------------

yak_death_count:

	IF IS_CHAR_DEAD yak_1_love2
	AND flag_1_dead_love2 = 0
		++ counter_kenji_guards_dead
		flag_1_dead_love2 = 1
	ENDIF
	IF IS_CHAR_DEAD yak_2_love2
	AND flag_2_dead_love2 = 0
		++ counter_kenji_guards_dead
		flag_2_dead_love2 = 1
	ENDIF
	IF IS_CHAR_DEAD yak_3_love2
	AND flag_3_dead_love2 = 0
		++ counter_kenji_guards_dead
		flag_3_dead_love2 = 1
	ENDIF
	IF IS_CHAR_DEAD yak_4_love2
	AND flag_4_dead_love2 = 0
		++ counter_kenji_guards_dead
		flag_4_dead_love2 = 1
	ENDIF
	IF IS_CHAR_DEAD yak_5_love2
	AND flag_5_dead_love2 = 0
		++ counter_kenji_guards_dead
		flag_5_dead_love2 = 1
	ENDIF
	IF IS_CHAR_DEAD yak_6_love2
	AND flag_6_dead_love2 = 0
		++ counter_kenji_guards_dead
		flag_6_dead_love2 = 1
	ENDIF
	IF IS_CHAR_DEAD yak_7_love2
	AND flag_7_dead_love2 = 0
		++ counter_kenji_guards_dead
		flag_7_dead_love2 = 1
	ENDIF
	IF IS_CHAR_DEAD yak_8_love2
	AND flag_8_dead_love2 = 0
		++ counter_kenji_guards_dead
		flag_8_dead_love2 = 1
	ENDIF

RETURN	

   

kenji_cut:

	IF flag_kenji_cut = 1
		APPLY_BRAKES_TO_PLAYERS_CAR player On
		SWITCH_WIDESCREEN on
		SET_PLAYER_CONTROL player off
		SET_FIXED_CAMERA_POSITION 303.11 -542.44 37.1 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT 303.67 -543.36 36.92 JUMP_CUT
		GET_GAME_TIMER timer_kenji_cut_start
		timer_kenji_cut_dif = timer_kenji_cut_start - timer_kenji_cut_start
		WHILE timer_kenji_cut_dif < 7500
			WAIT 0
			//PRINT_WITH_NUMBER_NOW ( Z ) timer_kenji_cut_dif 1000 1
			GET_GAME_TIMER timer_kenji_cut_now
			timer_kenji_cut_dif = timer_kenji_cut_now - timer_kenji_cut_start
			IF timer_kenji_cut_dif > 1000
			AND flag_kenji_look = 0
				IF NOT IS_CHAR_DEAD kenji
				AND NOT IS_CHAR_DEAD yak_2_love2
					//CHAR_LOOK_AT_CHAR_ALWAYS kenji yak_3_love2
					SET_CHAR_WAIT_STATE kenji WAITSTATE_CROSS_ROAD_LOOK 4000
					SET_CHAR_WAIT_STATE yak_2_love2 WAITSTATE_PLAYANIM_CHAT 4000
					flag_kenji_look = 1
				ENDIF
			ENDIF
			IF timer_kenji_cut_dif > 2500
			AND flag_kenji_cut = 1
				/*IF NOT IS_CHAR_DEAD kenji
					STOP_CHAR_LOOKING kenji
				ENDIF*/
				IF NOT IS_CHAR_DEAD yak_3_love2
					POINT_CAMERA_AT_CHAR yak_3_love2 FIXED INTERPOLATION
				ENDIF
				flag_kenji_cut = 3
			ENDIF
			IF timer_kenji_cut_dif > 5000
			AND flag_kenji_cut = 3
				IF NOT IS_CHAR_DEAD yak_1_love2
					POINT_CAMERA_AT_CHAR yak_1_love2 FIXED INTERPOLATION
					flag_kenji_cut = 4
				ENDIF
			ENDIF
			
		ENDWHILE
		RESTORE_CAMERA_JUMPCUT
		SET_PLAYER_CONTROL player on
		SWITCH_WIDESCREEN off
	ENDIF
	
	IF flag_kenji_cut = 2
		APPLY_BRAKES_TO_PLAYERS_CAR player On
		SWITCH_WIDESCREEN on
		SET_PLAYER_CONTROL player off
		SET_FIXED_CAMERA_POSITION 303.32 -544.7 37.09 0.0 0.0 0.0 
		POINT_CAMERA_AT_POINT 303.83 -543.85 36.96 JUMP_CUT
		GET_GAME_TIMER timer_kenji_cut_start
		timer_kenji_cut_dif = timer_kenji_cut_start - timer_kenji_cut_start
		WHILE timer_kenji_cut_dif < 7500
			WAIT 0
			//PRINT_WITH_NUMBER_NOW ( Z ) timer_kenji_cut_dif 1000 1
			GET_GAME_TIMER timer_kenji_cut_now
			timer_kenji_cut_dif = timer_kenji_cut_now - timer_kenji_cut_start
			IF timer_kenji_cut_dif > 1000
			AND flag_kenji_look = 0
				IF NOT IS_CHAR_DEAD kenji
				AND NOT IS_CHAR_DEAD yak_2_love2
					//CHAR_LOOK_AT_CHAR_ALWAYS kenji yak_1_love2
					SET_CHAR_WAIT_STATE kenji WAITSTATE_CROSS_ROAD_LOOK 4000
					SET_CHAR_WAIT_STATE yak_2_love2 WAITSTATE_PLAYANIM_CHAT 4000
					flag_kenji_look = 1
				ENDIF
			ENDIF
			IF timer_kenji_cut_dif > 2500
			AND flag_kenji_cut = 2			
				/*IF NOT IS_CHAR_DEAD kenji
					STOP_CHAR_LOOKING kenji
				ENDIF*/
				IF NOT IS_CHAR_DEAD yak_1_love2
					POINT_CAMERA_AT_CHAR yak_1_love2 FIXED INTERPOLATION
				ENDIF
				flag_kenji_cut = 3
			ENDIF
			IF timer_kenji_cut_dif > 5000
			AND flag_kenji_cut = 3
				IF NOT IS_CHAR_DEAD yak_4_love2
					POINT_CAMERA_AT_CHAR yak_4_love2 FIXED INTERPOLATION
					flag_kenji_cut = 4
				ENDIF
			ENDIF 	
		ENDWHILE
		RESTORE_CAMERA_JUMPCUT
		SET_PLAYER_CONTROL player on
		SWITCH_WIDESCREEN off

	ENDIF




RETURN


MISSION_START
// *****************************************************************************************
// *********************************    Love mission 3   *********************************** 
// ********************************* A Drop in the Ocean ***********************************
// *****************************************************************************************
// *** The Player must pick up several packages that will be dropped from a Cessna into  ***
// *** the bay that night. The player will use a boat to collect them. It is a decoy	 ***
// *** (player does not know this at this time) so the police are aware of them. As soon ***
// *** has the player has picked up the first package the police chopper will be on him. ***
// *** Once the player has collected them all he must get them back to land and to his 	 ***
// *** hideout in a car with the ensuing police chase. 									 ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_love3

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_love3_failed
ENDIF

GOSUB mission_cleanup_love3

MISSION_END
 
// Variables for mission

VAR_INT players_boat /*garage_flag_l3 player_car_l3*/ players_boat_blip	police_boat_flag police_boat
VAR_INT plane_blip random_int_l3 counter_display_flag plane_timer police_boat_driver police_rating
VAR_INT float_packge_01	float_packge_02 float_packge_03 float_packge_04 float_packge_05 float_packge_06
VAR_INT drug_current_timer temporary_time_drug last_drug_dropped_timer package_numbers cs_ojg
VAR_INT packge_01 packge_02	packge_03 packge_04	packge_05 packge_06	packages_collected

VAR_INT plane_blip_1 plane_blip_2 plane_blip_3 plane_blip_4 plane_blip_5 plane_blip_6
VAR_FLOAT PlaneX PlaneY PlaneZ
VAR_FLOAT package_1_x package_1_y
VAR_FLOAT package_2_x package_2_y 
VAR_FLOAT package_3_x package_3_y 
VAR_FLOAT package_4_x package_4_y 
VAR_FLOAT package_5_x package_5_y 
VAR_FLOAT package_6_x package_6_y 

// ****************************************Mission Start************************************

mission_start_love3:

flag_player_on_mission = 1
flag_player_on_love_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

SCRIPT_NAME love3

drug_current_timer 	    = 0
temporary_time_drug     = 0
last_drug_dropped_timer = 0
package_numbers			= 0
packages_collected 		= 0
police_boat_flag		= 0
police_rating			= 0

packge_01 	= 0
packge_02	= 0
packge_03 	= 0
packge_04	= 0
packge_05 	= 0
packge_06	= 0

counter_display_flag = 0
//garage_flag_l3 = 0

PlaneX = 0.0
PlaneY = 0.0
PlaneZ = 0.0

// ****************************************START OF CUTSCENE********************************

LOAD_SPECIAL_CHARACTER 1 love2
LOAD_SPECIAL_CHARACTER 2 ojg2
LOAD_SPECIAL_MODEL cut_obj1 LOVEH
REQUEST_MODEL tshrorckgrdn
REQUEST_MODEL tshrorckgrdn_alfas

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED tshrorckgrdn_alfas
OR NOT HAS_MODEL_LOADED tshrorckgrdn
	WAIT 0
ENDWHILE

LOAD_CUTSCENE D3_ADO

SET_CUTSCENE_OFFSET 85.2162 -1532.9093 243.5422

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_love
SET_CUTSCENE_ANIM cs_love love2

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_ojg
SET_CUTSCENE_ANIM cs_ojg ojg2

CREATE_CUTSCENE_HEAD cs_love cut_obj1 cs_lovehead
SET_CUTSCENE_HEAD_ANIM cs_lovehead love

CLEAR_AREA 82.44 -1548.49 28.0 2.0 TRUE

SET_PLAYER_COORDINATES player 82.44 -1548.49 28.0

SET_PLAYER_HEADING player 90.0

DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON
SWITCH_RUBBISH OFF

START_CUTSCENE

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 12262
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE3_A 5000 1//"In these days of moral hypocrisy certain valuable commodities can be hard to import."

WHILE cs_time < 16652
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE3_B 5000 1//"On it's approach to Liberty airport tonight, a light aircraft will pass over the bay."

WHILE cs_time < 20065
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE3_C 5000 1//"It will drop several packages into the water."

WHILE cs_time < 22434
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE3_D 5000 1//"Make sure you pick them up before anyone else does."

WHILE cs_time < 25333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

DO_FADE 0 FADE_OUT

REQUEST_MODEL PLANE_DEADDODO 
REQUEST_MODEL BOAT_SPEEDER
REQUEST_MODEL BOAT_PREDATOR
REQUEST_MODEL CAR_STINGER

LOAD_ALL_MODELS_NOW

SET_CAMERA_BEHIND_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN 

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn
MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn_alfas

// ******************************************END OF CUTSCENE********************************


WHILE NOT HAS_MODEL_LOADED PLANE_DEADDODO 
OR NOT HAS_MODEL_LOADED BOAT_SPEEDER
OR NOT HAS_MODEL_LOADED BOAT_PREDATOR
OR NOT HAS_MODEL_LOADED CAR_STINGER
	WAIT 0
ENDWHILE

CREATE_CAR BOAT_SPEEDER 837.0 -1115.6 -0.2 players_boat
SET_CAR_HEADING players_boat 140.0
VAR_INT stinger

CREATE_CAR CAR_STINGER 500.0 -648.6 16.3 stinger 

ADD_BLIP_FOR_CAR players_boat players_boat_blip

PRINT_NOW LOVE3_1 5000 1

START_DRUG_DROP_OFF

IF flag_player_on_mission = 0  						   // IMPOSSIBLE IF STATEMENT
	ADD_BLIP_FOR_COORD PlaneX PlaneY PlaneZ plane_blip // JUST SO I CAN REMOVE THE 
ENDIF												   // BLIP BEFORE ADDING IT

WAIT 1000

plane_timer = 120000

DISPLAY_ONSCREEN_TIMER plane_timer

plane_drop_loop:

WAIT 0

IF HAS_DROP_OFF_PLANE_BEEN_SHOT_DOWN
	PRINT_NOW LOVE3_4 5000 1
	GOTO mission_love3_failed
ENDIF

IF plane_timer = 0
	CLEAR_ONSCREEN_TIMER plane_timer 
	PRINT_NOW LOVE3_5 5000 1// "The plane is now in range."
	plane_timer = -1000
ENDIF

IF IS_PLAYER_IN_MODEL player BOAT_PREDATOR
OR IS_PLAYER_IN_MODEL player BOAT_SPEEDER
OR IS_PLAYER_IN_MODEL player BOAT_REEFER
	REMOVE_BLIP players_boat_blip
ENDIF

REMOVE_BLIP plane_blip

IF package_numbers < 6
	FIND_DROP_OFF_PLANE_COORDINATES PlaneX PlaneY PlaneZ
	//ADD_BLIP_FOR_COORD_OLD PlaneX PlaneY PlaneZ 4 BLIP_ONLY plane_blip
	//CHANGE_BLIP_SCALE plane_blip 3
	GET_GAME_TIMER drug_current_timer
	temporary_time_drug = drug_current_timer - last_drug_dropped_timer
	IF temporary_time_drug > 7000
		GET_GAME_TIMER last_drug_dropped_timer
		IF PlaneX < 750.0
		AND PlaneX > 615.0
		AND PlaneY < 650.0
		AND PlaneY > -1213.0
			GET_GAME_TIMER last_drug_dropped_timer
			IF package_numbers = 0
				ADD_BLIP_FOR_COORD_OLD PlaneX PlaneY PlaneZ 4 BLIP_ONLY plane_blip_1
				CHANGE_BLIP_SCALE plane_blip_1 3
				CREATE_FLOATING_PACKAGE PlaneX PlaneY PlaneZ float_packge_01
				package_1_x = PlaneX
				package_1_y = PlaneY
				packge_01 = 1
			ENDIF
			IF package_numbers = 1
				ADD_BLIP_FOR_COORD_OLD PlaneX PlaneY PlaneZ 4 BLIP_ONLY plane_blip_2
				CHANGE_BLIP_SCALE plane_blip_2 3
				CREATE_FLOATING_PACKAGE PlaneX PlaneY PlaneZ float_packge_02
				package_2_x = PlaneX
				package_2_y = PlaneY
				packge_02 = 1
			ENDIF
			IF package_numbers = 2
				ADD_BLIP_FOR_COORD_OLD PlaneX PlaneY PlaneZ 4 BLIP_ONLY plane_blip_3
				CHANGE_BLIP_SCALE plane_blip_3 3
				CREATE_FLOATING_PACKAGE PlaneX PlaneY PlaneZ float_packge_03
				package_3_x = PlaneX
				package_3_y = PlaneY
				packge_03 = 1
			ENDIF
			IF package_numbers = 3
				ADD_BLIP_FOR_COORD_OLD PlaneX PlaneY PlaneZ 4 BLIP_ONLY plane_blip_4
				CHANGE_BLIP_SCALE plane_blip_4 3
				CREATE_FLOATING_PACKAGE PlaneX PlaneY PlaneZ float_packge_04
				package_4_x = PlaneX
				package_4_y = PlaneY
				packge_04 = 1
			ENDIF
			IF package_numbers = 4
				ADD_BLIP_FOR_COORD_OLD PlaneX PlaneY PlaneZ 4 BLIP_ONLY plane_blip_5
				CHANGE_BLIP_SCALE plane_blip_5 3
				CREATE_FLOATING_PACKAGE PlaneX PlaneY PlaneZ float_packge_05
				package_5_x = PlaneX
				package_5_y = PlaneY
				packge_05 = 1
			ENDIF
			IF package_numbers = 5
				ADD_BLIP_FOR_COORD_OLD PlaneX PlaneY PlaneZ 4 BLIP_ONLY plane_blip_6
				CHANGE_BLIP_SCALE plane_blip_6 3
				CREATE_FLOATING_PACKAGE PlaneX PlaneY PlaneZ float_packge_06
				package_6_x = PlaneX
				package_6_y = PlaneY
				packge_06 = 1
			ENDIF
			package_numbers++
		ENDIF
	ENDIF
ENDIF
	
IF packge_01 > 0
AND	packages_collected < 6
	PRINT_WITH_NUMBER_NOW LOVE3_3 package_numbers 5000 1 //"The plane has dropped ~1~ of 8 packages."
ENDIF

IF packge_01 = 1
	IF HAS_PICKUP_BEEN_COLLECTED float_packge_01
		REMOVE_BLIP plane_blip_1
		ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_EVIDENCE_PICKUP
		++packages_collected
		IF counter_display_flag = 0
			DISPLAY_ONSCREEN_COUNTER_WITH_STRING packages_collected COUNTER_DISPLAY_NUMBER COLLECT 
			counter_display_flag = 1
		ENDIF
		police_rating += 1
		ALTER_WANTED_LEVEL_NO_DROP player police_rating
		packge_01 = 2
	ENDIF
ENDIF

IF packge_02 = 1
	IF HAS_PICKUP_BEEN_COLLECTED float_packge_02
		REMOVE_BLIP plane_blip_2
		ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_EVIDENCE_PICKUP
		++packages_collected
		IF counter_display_flag = 0
			DISPLAY_ONSCREEN_COUNTER_WITH_STRING packages_collected COUNTER_DISPLAY_NUMBER COLLECT 
			counter_display_flag = 1
		ENDIF
		police_rating += 1
		ALTER_WANTED_LEVEL_NO_DROP player police_rating
		packge_02 = 2
	ENDIF
ENDIF

IF packge_03 = 1
	IF HAS_PICKUP_BEEN_COLLECTED float_packge_03
		REMOVE_BLIP plane_blip_3
		ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_EVIDENCE_PICKUP
		++packages_collected
		IF counter_display_flag = 0
			DISPLAY_ONSCREEN_COUNTER_WITH_STRING packages_collected COUNTER_DISPLAY_NUMBER COLLECT 
			counter_display_flag = 1
		ENDIF
		//police_rating += 1  // GSSC: Drop difficulty level by lowering highest wanted level 
		//ALTER_WANTED_LEVEL_NO_DROP player police_rating
		packge_03 = 2
	ENDIF
ENDIF

IF packge_04 = 1
	IF HAS_PICKUP_BEEN_COLLECTED float_packge_04
		REMOVE_BLIP plane_blip_4
		ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_EVIDENCE_PICKUP
		++packages_collected
		IF counter_display_flag = 0
			DISPLAY_ONSCREEN_COUNTER_WITH_STRING packages_collected COUNTER_DISPLAY_NUMBER COLLECT 
			counter_display_flag = 1
		ENDIF
		police_rating += 1
		ALTER_WANTED_LEVEL_NO_DROP player police_rating
		packge_04 = 2
	ENDIF
ENDIF

IF packge_05 = 1
	IF HAS_PICKUP_BEEN_COLLECTED float_packge_05
		REMOVE_BLIP plane_blip_5
		ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_EVIDENCE_PICKUP
		++packages_collected
		IF counter_display_flag = 0
			DISPLAY_ONSCREEN_COUNTER_WITH_STRING packages_collected COUNTER_DISPLAY_NUMBER COLLECT 
			counter_display_flag = 1
		ENDIF
		//police_rating += 1
		//ALTER_WANTED_LEVEL_NO_DROP player police_rating
		packge_05 = 2
	ENDIF
ENDIF

IF packge_06 = 1
	IF HAS_PICKUP_BEEN_COLLECTED float_packge_06
		REMOVE_BLIP plane_blip_6
		ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_EVIDENCE_PICKUP
		++packages_collected
		IF counter_display_flag = 0
			DISPLAY_ONSCREEN_COUNTER_WITH_STRING packages_collected COUNTER_DISPLAY_NUMBER COLLECT 
			counter_display_flag = 1
		ENDIF
		police_rating += 1
		ALTER_WANTED_LEVEL_NO_DROP player police_rating
		packge_06 = 2
	ENDIF
ENDIF

IF packge_06 > 0
	IF police_boat_flag = 0
		IF NOT IS_POINT_ON_SCREEN 560.5223 -474.0232 -0.2 5.0
			CREATE_CAR BOAT_PREDATOR 560.5223 -474.0232 -0.2 police_boat
			CREATE_CHAR_INSIDE_CAR police_boat PEDTYPE_CIVMALE PED_COP police_boat_driver
			SET_CAR_HEADING police_boat 179.7861
			BOAT_GOTO_COORDS police_boat package_6_x package_6_y 0.0
			police_boat_flag = 1
		ENDIF
	ENDIF
	IF NOT IS_CAR_DEAD police_boat
		IF police_boat_flag = 1
			IF LOCATE_CAR_2D police_boat package_6_x package_6_y 4.0 4.0 0
				IF packge_06 = 1
					REMOVE_PICKUP float_packge_01
					REMOVE_PICKUP float_packge_02
					REMOVE_PICKUP float_packge_03
					REMOVE_PICKUP float_packge_04
					REMOVE_PICKUP float_packge_05
					REMOVE_PICKUP float_packge_06
					PRINT_NOW LOVE3_6 5000 1// "~r~The Police got the the package first!"
					BOAT_GOTO_COORDS police_boat 641.5550 594.6697 0.0
					SET_BOAT_CRUISE_SPEED police_boat 100.0
					GOTO mission_love3_failed
				ELSE
					BOAT_GOTO_COORDS police_boat package_5_x package_5_y 0.0
					police_boat_flag = 2
				ENDIF
			ENDIF
		ENDIF
		IF police_boat_flag = 2
			IF LOCATE_CAR_2D police_boat package_5_x package_5_y 4.0 4.0 0
				IF packge_05 = 1
					REMOVE_PICKUP float_packge_01
					REMOVE_PICKUP float_packge_02
					REMOVE_PICKUP float_packge_03
					REMOVE_PICKUP float_packge_04
					REMOVE_PICKUP float_packge_05
					REMOVE_PICKUP float_packge_06
					PRINT_NOW LOVE3_6 5000 1// "~r~The Police got the the package first!"
					BOAT_GOTO_COORDS police_boat 641.5550 594.6697 0.0
					SET_BOAT_CRUISE_SPEED police_boat 100.0
					GOTO mission_love3_failed
				ELSE
					BOAT_GOTO_COORDS police_boat package_4_x package_4_y 0.0
					police_boat_flag = 3
				ENDIF
			ENDIF
		ENDIF
		IF police_boat_flag = 3
			IF LOCATE_CAR_2D police_boat package_4_x package_4_y 4.0 4.0 0
				IF packge_04 = 1
					REMOVE_PICKUP float_packge_01
					REMOVE_PICKUP float_packge_02
					REMOVE_PICKUP float_packge_03
					REMOVE_PICKUP float_packge_04
					REMOVE_PICKUP float_packge_05
					REMOVE_PICKUP float_packge_06
					PRINT_NOW LOVE3_6 5000 1// "~r~The Police got the the package first!"
					BOAT_GOTO_COORDS police_boat 641.5550 594.6697 0.0
					SET_BOAT_CRUISE_SPEED police_boat 100.0
					GOTO mission_love3_failed
				ELSE
					BOAT_GOTO_COORDS police_boat package_3_x package_3_y 0.0
					police_boat_flag = 4
				ENDIF
			ENDIF
		ENDIF
		IF police_boat_flag = 4
			IF LOCATE_CAR_2D police_boat package_3_x package_3_y 4.0 4.0 0
				IF packge_03 = 1
					REMOVE_PICKUP float_packge_01
					REMOVE_PICKUP float_packge_02
					REMOVE_PICKUP float_packge_03
					REMOVE_PICKUP float_packge_04
					REMOVE_PICKUP float_packge_05
					REMOVE_PICKUP float_packge_06
					PRINT_NOW LOVE3_6 5000 1// "~r~The Police got the the package first!"
					BOAT_GOTO_COORDS police_boat 641.5550 594.6697 0.0
					SET_BOAT_CRUISE_SPEED police_boat 100.0
					GOTO mission_love3_failed
				ELSE
					BOAT_GOTO_COORDS police_boat package_2_x package_2_y 0.0
					police_boat_flag = 5
				ENDIF
			ENDIF
		ENDIF
		IF police_boat_flag = 5
			IF LOCATE_CAR_2D police_boat package_2_x package_2_y 4.0 4.0 0
				IF packge_02 = 1
					REMOVE_PICKUP float_packge_01
					REMOVE_PICKUP float_packge_02
					REMOVE_PICKUP float_packge_03
					REMOVE_PICKUP float_packge_04
					REMOVE_PICKUP float_packge_05
					REMOVE_PICKUP float_packge_06
					PRINT_NOW LOVE3_6 5000 1// "~r~The Police got the the package first!"
					BOAT_GOTO_COORDS police_boat 641.5550 594.6697 0.0
					SET_BOAT_CRUISE_SPEED police_boat 100.0
					GOTO mission_love3_failed
				ELSE
					BOAT_GOTO_COORDS police_boat package_1_x package_1_y 0.0
					police_boat_flag = 6
				ENDIF
			ENDIF
		ENDIF
		IF police_boat_flag = 6
			IF LOCATE_CAR_2D police_boat package_1_x package_1_y 4.0 4.0 0
				IF packge_01 = 1
					REMOVE_PICKUP float_packge_01
					REMOVE_PICKUP float_packge_02
					REMOVE_PICKUP float_packge_03
					REMOVE_PICKUP float_packge_04
					REMOVE_PICKUP float_packge_05
					REMOVE_PICKUP float_packge_06
					PRINT_NOW LOVE3_6 5000 1// "~r~The Police got the the package first!"
					BOAT_GOTO_COORDS police_boat 641.5550 594.6697 0.0
					SET_BOAT_CRUISE_SPEED police_boat 100.0
					GOTO mission_love3_failed
				ELSE
					BOAT_GOTO_COORDS police_boat 641.5550 594.6697 0.0
					police_boat_flag = 99
				ENDIF
			ENDIF
		ENDIF
	ENDIF
ENDIF

IF packages_collected = 6
	PRINT_NOW LOVE3_2 5000 1 // "You have them all.  Take the package to Donald Love"
	REMOVE_BLIP	plane_blip
	ADD_BLIP_FOR_COORD 87.3 -1548.6 27.255 plane_blip //130.0 -1585.0 26.0
	temporary_time_drug = 0
	GOTO garage_loop_l3
ENDIF

GOTO plane_drop_loop
	   		
garage_loop_l3:

WHILE NOT IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
	WAIT 0
ENDWHILE

WHILE NOT LOCATE_STOPPED_PLAYER_ON_FOOT_3D Player 87.3 -1548.6 28.3 2.0 1.0 2.0 1
	WAIT 0
ENDWHILE

SET_PLAYER_CONTROL player OFF

SET_EVERYONE_IGNORE_PLAYER player ON
SET_ALL_CARS_CAN_BE_DAMAGED FALSE
CLEAR_WANTED_LEVEL player

SET_FIXED_CAMERA_POSITION 81.3343 -1540.0887 27.7976 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 81.8719 -1540.9318 27.8039 JUMP_CUT

SWITCH_WIDESCREEN ON

GET_PLAYER_CHAR player script_controlled_player

SET_CHAR_OBJ_RUN_TO_COORD script_controlled_player 87.4588 -1548.7035
{
TIMERA = 0

WHILE NOT LOCATE_PLAYER_ON_FOOT_2D player 87.4588 -1548.7035 1.0 1.0 0
	WAIT 0
	IF TIMERA > 3000
		GOTO get_out_of_loop_l3
	ENDIF
ENDWHILE
}
get_out_of_loop_l3:

SET_CHAR_OBJ_RUN_TO_COORD script_controlled_player 98.7615 -1548.6489

DO_FADE 1000 FADE_OUT

CLEAR_AREA 87.3 -1548.6 28.3 2.0 0

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SET_CHAR_OBJ_NO_OBJ	script_controlled_player
CHAR_SET_IDLE script_controlled_player
SET_CHAR_OBJ_RUN_TO_COORD script_controlled_player 81.2603 -1548.9347
SET_CHAR_OBJ_NO_OBJ	script_controlled_player
CHAR_SET_IDLE script_controlled_player

WAIT 250

SET_PLAYER_COORDINATES player 81.2603 -1548.9347 27.4
SET_PLAYER_HEADING player 90.0
RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN OFF
SET_PLAYER_CONTROL player ON
SET_CAMERA_IN_FRONT_OF_PLAYER
SET_EVERYONE_IGNORE_PLAYER player OFF
SET_ALL_CARS_CAN_BE_DAMAGED TRUE

DO_FADE 1000 FADE_IN

GOTO mission_love3_passed

// Mission love 3 failed

mission_love3_failed:
PRINT_BIG M_FAIL 5000 1
RETURN

   

// mission love 3 passed

mission_love3_passed:

USE_TEXT_COMMANDS 109 // HACKED achievement unlock // OFFSHORE_DELIVERY

flag_love_mission3_passed = 1
flag_commercial_passed = 1
COMMERCIAL_PASSED

IF DOES_OBJECT_EXIST subway_gate_suburban1
	DELETE_OBJECT subway_gate_suburban1
ENDIF
IF DOES_OBJECT_EXIST subway_gate_suburban2
	DELETE_OBJECT subway_gate_suburban2
ENDIF
IF DOES_OBJECT_EXIST tunnel_gate_suburban
	DELETE_OBJECT tunnel_gate_suburban
ENDIF

IF DOES_OBJECT_EXIST helix_barrier
	DELETE_OBJECT helix_barrier
ENDIF

SWITCH_ROADS_ON 496.7 75.5 -30.0 484.0 44.2 0.0 //tunnel to suburbia
SWITCH_ROADS_ON -46.8 -648.0 39.0 -69.1 -614.0 50.0 //Commercial to Suburbia Bridge

IF flag_ray_mission5_passed = 1
	ADD_SPRITE_BLIP_FOR_CONTACT_POINT 38.8 -725.4 -100.0 RADAR_SPRITE_RAY ray_contact_blip
	START_NEW_SCRIPT ray_mission6_loop
ENDIF

PRINT_WITH_NUMBER_BIG M_PASS 10000 5000 1
ADD_SCORE player 10000
CLEAR_WANTED_LEVEL player
REGISTER_MISSION_PASSED	LOVE3
PLAY_MISSION_PASSED_TUNE 1
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT love_mission4_loop
START_NEW_SCRIPT hood_phone_start
RETURN
		


// mission cleanup

mission_cleanup_love3:

flag_player_on_mission = 0
flag_player_on_love_mission = 0

CLEAR_ONSCREEN_TIMER plane_timer
CLEAR_ONSCREEN_COUNTER packages_collected
MARK_MODEL_AS_NO_LONGER_NEEDED BOAT_SPEEDER
MARK_MODEL_AS_NO_LONGER_NEEDED PLANE_DEADDODO
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_STINGER
//SET_TARGET_CAR_FOR_MISSION_GARAGE loves_garage -1
REMOVE_BLIP	players_boat_blip
REMOVE_BLIP	plane_blip
REMOVE_BLIP	plane_blip_1
REMOVE_BLIP	plane_blip_2
REMOVE_BLIP	plane_blip_3
REMOVE_BLIP	plane_blip_4
REMOVE_BLIP	plane_blip_5
REMOVE_BLIP	plane_blip_6
MISSION_HAS_FINISHED
RETURN
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************YARDIE MISSION ONE DRUG RUSH******************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_yd1
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_yd1_failed
ENDIF
GOSUB mission_cleanup_yd1
MISSION_END

 
// Variables for mission

VAR_INT hot_rod_1 hot_rod_2 hot_rod_3
VAR_INT player_car wanted_yd1

VAR_INT street_racer_1 street_racer_2 street_racer_3


VAR_INT blip_hot_rod_3 blip_hot_rod_2 blip_hot_rod_1

VAR_INT blip_rush_destination flag_random_yd1 random_yd1

VAR_INT blip_start_yd1

VAR_FLOAT start_x start_y

VAR_FLOAT finish_x finish_y

VAR_FLOAT x_sum y_sum x_sum_player y_sum_player

VAR_FLOAT hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_1_dist
VAR_FLOAT hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_2_dist
VAR_FLOAT hot_rod_3_x hot_rod_3_y hot_rod_3_z
VAR_FLOAT hot_rod_heading

VAR_FLOAT player_car_x player_car_y player_car_z player_dist

VAR_INT counter_rush_start counter_hotrods
VAR_INT flag_hotrod1_start flag_hotrod2_start flag_hotrod3_start 

VAR_INT flag_drive_mode_1 flag_drive_mode_2 flag_drive_mode_3

VAR_INT flag_leader

VAR_INT counter_player_points reward_yd1 

VAR_INT counter_nonplayer1_points counter_nonplayer2_points counter_nonplayer3_points

VAR_INT counter_finish
VAR_INT flag_corona_yd1

VAR_INT counter_placing counter_joint_placing

VAR_INT timer_reset_hr1 timer_reset_hr2 timer_reset_hr3
VAR_INT timer_start_hr1 timer_start_hr2 timer_start_hr3
VAR_INT timer_current_hr1 timer_current_hr2 timer_current_hr3
VAR_INT hr1_time_dif hr2_time_dif hr3_time_dif

// ****************************************Mission Start************************************

mission_start_yd1:
REGISTER_MISSION_GIVEN
SCRIPT_NAME yard1 
flag_player_on_mission = 1
flag_player_on_yardie_mission = 1

WAIT 0

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_yd1_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

//SWITCH_STREAMING OFF

PRINT_BIG ( YD1 ) 15000 2 //"Yardie Mission 1"	 

TIMERA = 0

WHILE TIMERA < 1500					  
	WAIT 0

ENDWHILE
*/

// ******************************************CUTSCENE***************************************



{

SET_PED_DENSITY_MULTIPLIER 0.0
SET_POLICE_IGNORE_PLAYER player on

//WHILE NOT HAS_MODEL_LOADED cut_obj1
//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE YD_PH1
SET_CUTSCENE_OFFSET 121.0 -272.3 15.25
CLEAR_AREA_OF_CHARS 100.5 -250.0 0.0 130.5 -290.0 25.0
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player

//CLEAR_AREA 1219.5 -321.1 27.5 1.0 TRUE
//SET_PLAYER_COORDINATES player 1219.5 -321.1 26.4

//SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

//SWITCH_STREAMING OFF
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2237
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( YD1_A ) 10000 1 

WHILE cs_time < 3791
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD1_A1 ) 10000 1 

WHILE cs_time < 8312
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD1_B ) 10000 1 

WHILE cs_time < 12880
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD1_C ) 10000 1 

WHILE cs_time < 15965
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD1_D ) 10000 1 

WHILE cs_time < 20462
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD1_D1 ) 10000 1 
/*

WHILE cs_time < 24139
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_G ) 10000 1 

WHILE cs_time < 28919
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_H ) 10000 1 
*/
WHILE cs_time < 25166
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE



DO_FADE 1500 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

SWITCH_STREAMING ON
CLEAR_PRINTS
CLEAR_CUTSCENE
//SET_CAMERA_IN_FRONT_OF_PLAYER
SET_PED_DENSITY_MULTIPLIER 1.0
SET_POLICE_IGNORE_PLAYER player off
WAIT 500

DO_FADE 1500 FADE_IN
}

//------------LOCATION VARIABLES---(NB: ALL LOCATIONS SHOULD HAVE X Y & Z IN FINISHED SCRIPT!!)-----------------------------------------------------

finish_x = 107.0

finish_y = -288.0

start_x = 50.0

start_y = 70.0

flag_corona_yd1 = 0
flag_hotrod1_start = 0
flag_hotrod2_start = 0
flag_hotrod3_start = 0


counter_rush_start = 0
counter_hotrods = 0
counter_player_points = 0
counter_nonplayer1_points = 0
counter_nonplayer2_points = 0
counter_nonplayer3_points = 0
counter_finish = 0
counter_placing = 0
counter_joint_placing = 0

ADD_BLIP_FOR_COORD start_x start_y -100.0 blip_start_yd1

flag_leader = 0
flag_random_yd1 = 0

REQUEST_MODEL PED_MALE2
REQUEST_MODEL CAR_PATRIOT
REQUEST_MODEL CAR_CHEETAH
REQUEST_MODEL CAR_BOBCAT

WHILE NOT HAS_MODEL_LOADED PED_MALE2
OR NOT HAS_MODEL_LOADED CAR_PATRIOT
OR NOT HAS_MODEL_LOADED CAR_CHEETAH
OR NOT HAS_MODEL_LOADED CAR_BOBCAT

WAIT 1000

ENDWHILE



// --------Mission stuff goes here-----------------------------------------------------

is_player_there:

IF IS_PLAYER_STOPPED_IN_AREA_IN_CAR_2D player 45.0 65.0 55.0 75.0 true
	STORE_CAR_PLAYER_IS_IN player player_car
	GOTO player_is_there   
ENDIF

IF LOCATE_PLAYER_ON_FOOT_2D player start_x start_y 5.0 5.0 false
	PRINT_NOW ( YD1_G) 2000 1
ENDIF
WAIT 0

GOTO is_player_there

player_is_there:

// dont path the race stuff
DISPLAY_RADAR 2 // PATHING OFF

STORE_WANTED_LEVEL player wanted_yd1
CLEAR_WANTED_LEVEL player

REMOVE_BLIP blip_start_yd1

SET_PLAYER_CONTROL player off
LOCK_CAR_DOORS player_car CARLOCK_LOCKED
SET_FIXED_CAMERA_POSITION 66.7 51.0 18.0 0.0 0.0 0.0
DO_FADE 1500 FADE_OUT
WAIT 1500
POINT_CAMERA_AT_PLAYER player FIXED JUMP_CUT
SWITCH_WIDESCREEN on

SET_FADING_COLOUR 0 0 0
DO_FADE 1500 FADE_IN
WAIT 1500
 

CLEAR_AREA 90.0 50.0 16.0 20.0 true
CLEAR_AREA 93.0 57.0 16.0 20.0 true
CLEAR_AREA 78.0 50.0 16.0 20.0 true
CLEAR_AREA 93.0 43.0 16.0 20.0 true

SET_CAR_DENSITY_MULTIPLIER 0.0
SET_PED_DENSITY_MULTIPLIER 0.0

WAIT 2000

POINT_CAMERA_AT_POINT 90.0 50.0 16.0 INTERPOLATION

CLEAR_AREA 102.0 90.0 16.0 20.0 true
CREATE_CAR CAR_PATRIOT 102.0 90.0 16.0 hot_rod_1
CREATE_CHAR_INSIDE_CAR hot_rod_1 PEDTYPE_CIVMALE PED_MALE2 street_racer_1
SET_CAR_WATERTIGHT hot_rod_1 true
SET_UPSIDEDOWN_CAR_NOT_DAMAGED hot_rod_1 true
LOCK_CAR_DOORS hot_rod_1 CARLOCK_LOCKED
SET_CAR_HEADING hot_rod_1 190.0
SET_CAR_CRUISE_SPEED hot_rod_1 20.0
SET_CAR_DRIVING_STYLE hot_rod_1 0
CAR_GOTO_COORDINATES_ACCURATE hot_rod_1 93.0 57.0 16.0

CLEAR_AREA 75.0 76.0 16.0 20.0 true
CREATE_CAR CAR_CHEETAH 75.0 76.0 16.0 hot_rod_2
CREATE_CHAR_INSIDE_CAR hot_rod_2 PEDTYPE_CIVMALE PED_MALE2 street_racer_2
SET_CAR_WATERTIGHT hot_rod_2 true
SET_UPSIDEDOWN_CAR_NOT_DAMAGED hot_rod_2 true
LOCK_CAR_DOORS hot_rod_2 CARLOCK_LOCKED
SET_CAR_HEADING hot_rod_2 220.0
SET_CAR_CRUISE_SPEED hot_rod_2 20.0
SET_CAR_DRIVING_STYLE hot_rod_2 0
CAR_GOTO_COORDINATES_ACCURATE hot_rod_2 78.0 50.0 16.0

CLEAR_AREA 108.0 3.0 16.0 20.0 true
CREATE_CAR CAR_BOBCAT 108.0 3.0 16.0 hot_rod_3
CREATE_CHAR_INSIDE_CAR hot_rod_3 PEDTYPE_CIVMALE PED_MALE2 street_racer_3
SET_CAR_WATERTIGHT hot_rod_3 true
SET_UPSIDEDOWN_CAR_NOT_DAMAGED hot_rod_3 true
LOCK_CAR_DOORS hot_rod_3 CARLOCK_LOCKED
//SET_CAR_HEADING hot_rod_3 360.0
SET_CAR_CRUISE_SPEED hot_rod_3 10.0
SET_CAR_DRIVING_STYLE hot_rod_3 0
CAR_GOTO_COORDINATES_ACCURATE hot_rod_3 93.0 43.0 16.0

ADD_BLIP_FOR_CAR hot_rod_3 blip_hot_rod_3
ADD_BLIP_FOR_CAR hot_rod_2 blip_hot_rod_2
ADD_BLIP_FOR_CAR hot_rod_1 blip_hot_rod_1

PRINT_NOW ( YD1_E ) 3000 2


ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination


WHILE counter_hotrods < 3

	WAIT 0

	IF NOT IS_CAR_DEAD hot_rod_1
		IF LOCATE_CAR_2D hot_rod_1 93.0 57.0 3.0 3.0 false
		AND flag_hotrod1_start = 0
			CAR_SET_IDLE hot_rod_1
			flag_hotrod1_start = 1
			++ counter_hotrods
		ENDIF
	ENDIF
	SET_CAR_HEALTH hot_rod_1 1000

	IF NOT IS_CAR_DEAD hot_rod_2
		IF LOCATE_CAR_2D hot_rod_2 78.0 50.0 3.0 3.0 false
		AND flag_hotrod2_start = 0
			CAR_SET_IDLE hot_rod_2
			flag_hotrod2_start = 1
			++ counter_hotrods
		ENDIF
	ENDIF
	SET_CAR_HEALTH hot_rod_2 1000

	IF NOT IS_CAR_DEAD hot_rod_3
		IF LOCATE_CAR_2D hot_rod_3 93.0 43.0 3.0 3.0 false
		AND flag_hotrod3_start = 0
			CAR_SET_IDLE hot_rod_3
			flag_hotrod3_start = 1
			++ counter_hotrods
		ENDIF
	ENDIF
	SET_CAR_HEALTH hot_rod_3 1000

ENDWHILE

WAIT 1500

SET_FADING_COLOUR 0 0 0
DO_FADE 1500 FADE_OUT
WAIT 1500

RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN off
ALTER_WANTED_LEVEL player wanted_yd1

DO_FADE 1500 FADE_IN
WAIT 1500

IF NOT IS_CAR_DEAD player_car
	LOCK_CAR_DOORS player_car CARLOCK_UNLOCKED
ENDIF

SET_CAR_DENSITY_MULTIPLIER 1.0
SET_PED_DENSITY_MULTIPLIER 1.0

//----------------GENERATE ROUTE FLAG--------------------------------------------

GENERATE_RANDOM_INT random_yd1

IF random_yd1 > 21845
AND random_yd1 < 43691
	flag_random_yd1 = 1
ENDIF

IF random_yd1 > 43690
	flag_random_yd1 = 2
ENDIF

//-----------TURN OFF TUNNEL NODES-------------------------


SWITCH_ROADS_OFF 500.0 60.0 -25.0 600.0 140.0 0.0
SWITCH_ROADS_OFF -400.0 60.0 -25.0 -300.0 140.0 0.0

//-----------------RACE COUNTDOWN-----------------------------------------------


IF IS_PLAYER_IN_ANY_CAR player
	STORE_CAR_PLAYER_IS_IN player player_car
ENDIF

WHILE NOT IS_CAR_DEAD player_car
AND LOCATE_CAR_2D player_car start_x start_y 10.0 10.0 false
		WAIT 1000
		IF counter_rush_start = 4
			GOTO and_its_go_go_go
		ENDIF

		IF counter_rush_start = 3
			PRINT_BIG ( YD1GO ) 1000 4
			++ counter_rush_start
			SET_PLAYER_CONTROL player on
			ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_RACE_START_GO
		ENDIF
		
		IF counter_rush_start = 2
			PRINT_BIG ( YD1_1 ) 1000 4
			++ counter_rush_start
			ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_RACE_START_1
		ENDIF
		
		IF counter_rush_start = 1
			PRINT_BIG ( YD1_2 ) 1000 4
			++ counter_rush_start
			ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_RACE_START_2
		ENDIF

		IF counter_rush_start = 0
			PRINT_BIG ( YD1_3 ) 1000 4
			++ counter_rush_start
			ADD_ONE_OFF_SOUND 0.0 0.0 0.0 SOUND_RACE_START_3
		ENDIF
ENDWHILE	   

	   
PRINT_NOW ( YD1_F ) 4000 2


//-------------------RACE START-------------------------------------------------------------

and_its_go_go_go:

GOSUB driving_style_car_1
GOSUB driving_style_car_2
GOSUB driving_style_car_3


//------------------MAIN LOOP--------------------------------------------------------------

main_loop:

IF flag_corona_yd1 = 0
	DRAW_CORONA finish_x finish_y -100.0 2.0 CORONATYPE_CIRCLE FLARETYPE_NONE 200 120 120
/*ELSE
	DRAW_CORONA finish_x finish_y 16.1 2.0 CORONATYPE_HEX FLARETYPE_NONE 0 200 200*/
ENDIF

IF IS_PLAYER_IN_ANY_CAR player


		STORE_CAR_PLAYER_IS_IN player player_car

	
		GET_CAR_COORDINATES player_car player_car_x player_car_y player_car_z
		
		x_sum = finish_x - player_car_x

		y_sum = finish_y - player_car_y

		x_sum = x_sum * x_sum

		y_sum = y_sum * y_sum

		player_dist = x_sum + y_sum

		
		
		
	IF NOT IS_CAR_DEAD hot_rod_1
	OR IS_CAR_IN_WATER hot_rod_1

		IF NOT IS_CHAR_DEAD	street_racer_1
		AND NOT IS_PLAYER_IN_CAR player hot_rod_1

			GET_CAR_COORDINATES hot_rod_1 hot_rod_1_x hot_rod_1_y hot_rod_1_z

			IF hot_rod_1_z < 0.0 //no collision warp
				GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_heading
				//GET_CLOSEST_CAR_NODE hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_1_x hot_rod_1_y hot_rod_1_z
				IF NOT IS_POINT_ON_SCREEN hot_rod_1_x hot_rod_1_y hot_rod_1_z 3.0
					SET_CAR_COORDINATES hot_rod_1 hot_rod_1_x hot_rod_1_y hot_rod_1_z
					SET_CAR_HEADING hot_rod_1 hot_rod_heading
				ENDIF
			ENDIF

			IF NOT IS_CAR_HEALTH_GREATER hot_rod_1 450
				SET_CAR_HEALTH hot_rod_1 600
			ENDIF

			IF IS_CAR_UPSIDEDOWN hot_rod_1
			AND IS_CAR_STOPPED hot_rod_1
				SET_CHAR_OBJ_LEAVE_CAR street_racer_1 hot_rod_1
				IF NOT IS_CAR_ON_SCREEN hot_rod_1
					GET_CAR_COORDINATES hot_rod_1 hot_rod_1_x hot_rod_1_y hot_rod_1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_heading
					//GET_CLOSEST_CAR_NODE hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_1_x hot_rod_1_y hot_rod_1_z
					IF NOT IS_POINT_ON_SCREEN hot_rod_1_x hot_rod_1_y hot_rod_1_z 3.0
						SET_CAR_COORDINATES hot_rod_1 hot_rod_1_x hot_rod_1_y hot_rod_1_z
						SET_CAR_HEADING hot_rod_1 hot_rod_heading
						DELETE_CHAR street_racer_1
						CREATE_CHAR_INSIDE_CAR hot_rod_1 PEDTYPE_CIVMALE PED_MALE2 street_racer_1
					ENDIF
				ENDIF
			ENDIF

			IF IS_CAR_IN_WATER hot_rod_1
				//PRINT_BIG (Y1_TEST) 2000 1//CAR IN WATER!!
				IF NOT IS_CAR_ON_SCREEN hot_rod_1
					GET_CAR_COORDINATES hot_rod_1 hot_rod_1_x hot_rod_1_y hot_rod_1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_heading
					//GET_CLOSEST_CAR_NODE hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_1_x hot_rod_1_y hot_rod_1_z
					IF NOT IS_POINT_ON_SCREEN hot_rod_1_x hot_rod_1_y hot_rod_1_z 3.0
						SET_CAR_COORDINATES hot_rod_1 hot_rod_1_x hot_rod_1_y hot_rod_1_z
						SET_CAR_HEADING hot_rod_1 hot_rod_heading
						DELETE_CHAR street_racer_1
						CREATE_CHAR_INSIDE_CAR hot_rod_1 PEDTYPE_CIVMALE PED_MALE2 street_racer_1
					ENDIF
				ENDIF
			ENDIF

			IF timer_reset_hr1 = 1
				IF NOT IS_CAR_STOPPED hot_rod_1
					timer_reset_hr1 = 0
				ENDIF
			ENDIF
					
			IF IS_CAR_STOPPED hot_rod_1
				IF timer_reset_hr1 = 0
					GET_GAME_TIMER timer_start_hr1
					timer_reset_hr1 = 1
				ENDIF

				IF timer_reset_hr1 = 1
					GET_GAME_TIMER timer_current_hr1
					hr1_time_dif = timer_current_hr1 - timer_start_hr1
				ENDIF

				IF hr1_time_dif > 4000
					IF NOT IS_CAR_ON_SCREEN hot_rod_1
						GET_CAR_COORDINATES hot_rod_1 hot_rod_1_x hot_rod_1_y hot_rod_1_z
						GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_heading
						//GET_CLOSEST_CAR_NODE hot_rod_1_x hot_rod_1_y hot_rod_1_z hot_rod_1_x hot_rod_1_y hot_rod_1_z
						IF NOT IS_POINT_ON_SCREEN hot_rod_1_x hot_rod_1_y hot_rod_1_z 3.0
							SET_CAR_COORDINATES hot_rod_1 hot_rod_1_x hot_rod_1_y hot_rod_1_z
							SET_CAR_HEADING hot_rod_1 hot_rod_heading
							timer_reset_hr1 = 0
						ENDIF
					ENDIF
				ENDIF
			ENDIF

		
		
			GET_CAR_COORDINATES hot_rod_1 hot_rod_1_x hot_rod_1_y hot_rod_1_z

			x_sum = finish_x - hot_rod_1_x

			y_sum = finish_y - hot_rod_1_y
		
			x_sum = x_sum * x_sum

			y_sum = y_sum * y_sum

			hot_rod_1_dist = x_sum + y_sum
		
			IF hot_rod_1_dist > player_dist
				SET_CAR_MISSION hot_rod_1 2 //MISSION_RAMPLAYER_FARAWAY
			ENDIF

			IF player_dist > hot_rod_1_dist
				GOSUB driving_style_car_1
			ENDIF
		ELSE
			CAR_SET_IDLE hot_rod_1
		ENDIF
	ENDIF

	   		
		

	IF NOT IS_CAR_DEAD hot_rod_2
	OR IS_CAR_IN_WATER hot_rod_2

		IF NOT IS_CHAR_DEAD street_racer_2
		AND NOT IS_PLAYER_IN_CAR player hot_rod_2

			GET_CAR_COORDINATES hot_rod_2 hot_rod_2_x hot_rod_2_y hot_rod_2_z

			IF hot_rod_2_z < 0.0 //no collision warp
				GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_heading
				//GET_CLOSEST_CAR_NODE hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_2_x hot_rod_2_y hot_rod_2_z
				IF NOT IS_POINT_ON_SCREEN hot_rod_2_x hot_rod_2_y hot_rod_2_z 3.0
					SET_CAR_COORDINATES hot_rod_2 hot_rod_2_x hot_rod_2_y hot_rod_2_z
					SET_CAR_HEADING hot_rod_2 hot_rod_heading
				ENDIF
			ENDIF
				
			IF NOT IS_CAR_HEALTH_GREATER hot_rod_2 450
				SET_CAR_HEALTH hot_rod_2 600
			ENDIF

			IF IS_CAR_UPSIDEDOWN hot_rod_2
			AND IS_CAR_STOPPED hot_rod_2
				SET_CHAR_OBJ_LEAVE_CAR street_racer_2 hot_rod_2
				IF NOT IS_CAR_ON_SCREEN hot_rod_2
					GET_CAR_COORDINATES hot_rod_2 hot_rod_2_x hot_rod_2_y hot_rod_2_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_heading
					//GET_CLOSEST_CAR_NODE hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_2_x hot_rod_2_y hot_rod_2_z
					IF NOT IS_POINT_ON_SCREEN hot_rod_2_x hot_rod_2_y hot_rod_2_z 3.0
						SET_CAR_COORDINATES hot_rod_2 hot_rod_2_x hot_rod_2_y hot_rod_2_z
						SET_CAR_HEADING hot_rod_2 hot_rod_heading
						DELETE_CHAR street_racer_2
						CREATE_CHAR_INSIDE_CAR hot_rod_2 PEDTYPE_CIVMALE PED_MALE2 street_racer_2
					ENDIF
				ENDIF
			ENDIF

			IF IS_CAR_IN_WATER hot_rod_2
				//PRINT_BIG (Y1_TEST) 2000 1
				IF NOT IS_CAR_ON_SCREEN hot_rod_2
					GET_CAR_COORDINATES hot_rod_2 hot_rod_2_x hot_rod_2_y hot_rod_2_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_heading
					//GET_CLOSEST_CAR_NODE hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_2_x hot_rod_2_y hot_rod_2_z
					IF NOT IS_POINT_ON_SCREEN hot_rod_2_x hot_rod_2_y hot_rod_2_z 3.0
						SET_CAR_COORDINATES hot_rod_2 hot_rod_2_x hot_rod_2_y hot_rod_2_z
						SET_CAR_HEADING hot_rod_2 hot_rod_heading
						DELETE_CHAR street_racer_2
						CREATE_CHAR_INSIDE_CAR hot_rod_2 PEDTYPE_CIVMALE PED_MALE2 street_racer_2
					ENDIF
				ENDIF
			ENDIF

			IF timer_reset_hr2 = 1
				IF NOT IS_CAR_STOPPED hot_rod_2
					timer_reset_hr2 = 0
				ENDIF
			ENDIF
					
			IF IS_CAR_STOPPED hot_rod_2
				IF timer_reset_hr2 = 0
					GET_GAME_TIMER timer_start_hr2
					timer_reset_hr2 = 1
				ENDIF

				IF timer_reset_hr2 = 1
					GET_GAME_TIMER timer_current_hr2
					hr2_time_dif = timer_current_hr2 - timer_start_hr2
				ENDIF

				IF hr2_time_dif > 4000
					IF NOT IS_CAR_ON_SCREEN hot_rod_2
						GET_CAR_COORDINATES hot_rod_2 hot_rod_2_x hot_rod_2_y hot_rod_2_z
						GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_heading
						//GET_CLOSEST_CAR_NODE hot_rod_2_x hot_rod_2_y hot_rod_2_z hot_rod_2_x hot_rod_2_y hot_rod_2_z
						IF NOT IS_POINT_ON_SCREEN hot_rod_2_x hot_rod_2_y hot_rod_2_z 3.0
							SET_CAR_COORDINATES hot_rod_2 hot_rod_2_x hot_rod_2_y hot_rod_2_z
							SET_CAR_HEADING hot_rod_2 hot_rod_heading
							timer_reset_hr2 = 0
						ENDIF
					ENDIF
				ENDIF
			ENDIF


			GET_CAR_COORDINATES hot_rod_2 hot_rod_2_x hot_rod_2_y hot_rod_2_z
			
			x_sum = finish_x - hot_rod_2_x

			y_sum = finish_y - hot_rod_2_y

			x_sum = x_sum * x_sum

			y_sum = y_sum * y_sum

			hot_rod_2_dist = x_sum + y_sum



			IF hot_rod_2_dist > player_dist 
				SET_CAR_MISSION hot_rod_2 2 //RAMPLAYER_FARAWAY
			ENDIF

			
			IF player_dist > hot_rod_2_dist
				GOSUB driving_style_car_2
			ENDIF
		ELSE
			CAR_SET_IDLE hot_rod_2
		ENDIF
	ENDIF
	
	IF NOT IS_CAR_DEAD hot_rod_3
	OR IS_CAR_IN_WATER hot_rod_3

		IF NOT IS_CHAR_DEAD street_racer_3
		AND NOT IS_PLAYER_IN_CAR player hot_rod_3

			GET_CAR_COORDINATES hot_rod_3 hot_rod_3_x hot_rod_3_y hot_rod_3_z
			
			IF hot_rod_3_z < 0.0 //no collision warp
				GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_heading
				//GET_CLOSEST_CAR_NODE hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_3_x hot_rod_3_y hot_rod_3_z
				IF NOT IS_POINT_ON_SCREEN hot_rod_3_x hot_rod_3_y hot_rod_3_z 3.0
					SET_CAR_COORDINATES hot_rod_3 hot_rod_3_x hot_rod_3_y hot_rod_3_z
					SET_CAR_HEADING hot_rod_3 hot_rod_heading
				ENDIF
			ENDIF
				
			IF NOT IS_CAR_HEALTH_GREATER hot_rod_3 450
				SET_CAR_HEALTH hot_rod_3 600
			ENDIF

			IF IS_CAR_UPSIDEDOWN hot_rod_3
			AND IS_CAR_STOPPED hot_rod_3
				SET_CHAR_OBJ_LEAVE_CAR street_racer_3 hot_rod_3
				IF NOT IS_CAR_ON_SCREEN hot_rod_3
					GET_CAR_COORDINATES hot_rod_3 hot_rod_3_x hot_rod_3_y hot_rod_3_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_heading
					//GET_CLOSEST_CAR_NODE hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_3_x hot_rod_3_y hot_rod_3_z
					IF NOT IS_POINT_ON_SCREEN hot_rod_3_x hot_rod_3_y hot_rod_3_z 3.0
						SET_CAR_COORDINATES hot_rod_3 hot_rod_3_x hot_rod_3_y hot_rod_3_z
						SET_CAR_HEADING hot_rod_3 hot_rod_heading
						DELETE_CHAR street_racer_3
						CREATE_CHAR_INSIDE_CAR hot_rod_3 PEDTYPE_CIVMALE PED_MALE2 street_racer_3
					ENDIF
				ENDIF
			ENDIF

			IF IS_CAR_IN_WATER hot_rod_3
				//PRINT_BIG (Y1_TEST) 2000 1
				IF NOT IS_CAR_ON_SCREEN hot_rod_3
					GET_CAR_COORDINATES hot_rod_3 hot_rod_3_x hot_rod_3_y hot_rod_3_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_heading
					//GET_CLOSEST_CAR_NODE hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_3_x hot_rod_3_y hot_rod_3_z
					IF NOT IS_POINT_ON_SCREEN hot_rod_3_x hot_rod_3_y hot_rod_3_z 3.0
						SET_CAR_COORDINATES hot_rod_3 hot_rod_3_x hot_rod_3_y hot_rod_3_z
						SET_CAR_HEADING hot_rod_3 hot_rod_heading
						DELETE_CHAR street_racer_3
						CREATE_CHAR_INSIDE_CAR hot_rod_3 PEDTYPE_CIVMALE PED_MALE2 street_racer_3
					ENDIF
				ENDIF
			ENDIF

			IF timer_reset_hr3 = 1
				IF NOT IS_CAR_STOPPED hot_rod_3
					timer_reset_hr3 = 0
				ENDIF
			ENDIF
					
			IF IS_CAR_STOPPED hot_rod_3
				IF timer_reset_hr3 = 0
					GET_GAME_TIMER timer_start_hr3
					timer_reset_hr3 = 1
				ENDIF

				IF timer_reset_hr3 = 1
					GET_GAME_TIMER timer_current_hr3
					hr3_time_dif = timer_current_hr3 - timer_start_hr3
				ENDIF

				IF hr3_time_dif > 4000
					IF NOT IS_CAR_ON_SCREEN hot_rod_3
						GET_CAR_COORDINATES hot_rod_3 hot_rod_3_x hot_rod_3_y hot_rod_3_z
						GET_CLOSEST_CAR_NODE_WITH_HEADING hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_heading
						//GET_CLOSEST_CAR_NODE hot_rod_3_x hot_rod_3_y hot_rod_3_z hot_rod_3_x hot_rod_3_y hot_rod_3_z
						IF NOT IS_POINT_ON_SCREEN hot_rod_3_x hot_rod_3_y hot_rod_3_z 3.0
							SET_CAR_COORDINATES hot_rod_3 hot_rod_3_x hot_rod_3_y hot_rod_3_z
							SET_CAR_HEADING hot_rod_3 hot_rod_heading
							timer_reset_hr3 = 0
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ELSE
			CAR_SET_IDLE hot_rod_3
		ENDIF
	ENDIF
	
ENDIF	
		
IF NOT IS_PLAYER_IN_ANY_CAR player
	GOSUB driving_style_car_1
	GOSUB driving_style_car_2
	GOSUB driving_style_car_3
ENDIF


IF LOCATE_PLAYER_IN_CAR_2D player finish_x finish_y 6.0 6.0 false 
	GOSUB player_points
ENDIF

IF NOT IS_CAR_DEAD hot_rod_1
	IF LOCATE_CAR_2D hot_rod_1 finish_x finish_y 6.0 6.0 false
		GOSUB nonplayer_points_1
	ENDIF
ENDIF

IF NOT IS_CAR_DEAD hot_rod_2
	IF LOCATE_CAR_2D hot_rod_2 finish_x finish_y 6.0 6.0 false
		GOSUB nonplayer_points_2
	ENDIF
ENDIF

IF NOT IS_CAR_DEAD hot_rod_3
	IF LOCATE_CAR_2D hot_rod_3 finish_x finish_y 6.0 6.0 false
		GOSUB nonplayer_points_3
	ENDIF
ENDIF

WAIT 0

GOSUB driving_style_car_3

IF counter_finish = 15
	GOTO race_finished
ENDIF

GOTO main_loop




//------------------------------RACE FINISHED---------------------------------------------

race_finished:

IF counter_player_points = counter_nonplayer1_points
	++ counter_joint_placing
ENDIF

IF counter_player_points = counter_nonplayer2_points
	++ counter_joint_placing
ENDIF

IF counter_player_points = counter_nonplayer3_points
	++ counter_joint_placing
ENDIF

IF counter_player_points > counter_nonplayer1_points
	++ counter_placing
ENDIF

IF counter_player_points > counter_nonplayer2_points
	++ counter_placing
ENDIF

IF counter_player_points > counter_nonplayer3_points
	++ counter_placing
ENDIF

IF counter_placing = 3
	GOTO mission_yd1_passed
ENDIF

IF counter_placing < 3
	GOTO mission_yd1_failed
ENDIF



// --------------------------Race failed-----------------------------------------------

mission_yd1_failed:


PRINT_BIG ( M_FAIL ) 2000 1

WAIT 2000

IF counter_joint_placing = 0
	IF counter_placing = 2
		PRINT_WITH_NUMBER_NOW (Y1_2ND) counter_player_points 4000 1
		WAIT 2000
	ENDIF

	IF counter_placing = 1
		PRINT_WITH_NUMBER_NOW (Y1_3RD) counter_player_points 4000 1
		WAIT 2000
	ENDIF

	IF counter_placing = 0
		PRINT_WITH_NUMBER_NOW (Y1_LAST) counter_player_points 4000 1
		WAIT 2000
	ENDIF
ENDIF


IF counter_joint_placing = 1
	IF counter_placing = 2
		PRINT_WITH_NUMBER_NOW (Y1_J1ST) counter_player_points 4000 1
		WAIT 2000
	ENDIF

	IF counter_placing = 1
		PRINT_WITH_NUMBER_NOW (Y1_J2ND) counter_player_points 4000 1
		WAIT 2000
	ENDIF

	IF counter_placing = 0
		PRINT_WITH_NUMBER_NOW (Y1JLAST) counter_player_points 4000 1
		WAIT 2000
	ENDIF
ENDIF

IF counter_joint_placing = 2
	IF counter_placing = 1
		PRINT_WITH_NUMBER_NOW (Y1_J1ST) counter_player_points 4000 1
		WAIT 2000
	ENDIF

	IF counter_placing = 0
		PRINT_WITH_NUMBER_NOW (Y1JLAST) counter_player_points 4000 1
		WAIT 2000
	ENDIF
ENDIF

RETURN
   




// Race passed

mission_yd1_passed:

IF flag_yardie_mission4_passed = 0
	REGISTER_MISSION_PASSED YD1
	PLAYER_MADE_PROGRESS 1 
	flag_yardie_mission1_passed = 1
	START_NEW_SCRIPT yardie_mission2_loop
ENDIF

reward_yd1 = 1000 * counter_player_points
PRINT_WITH_NUMBER_BIG ( M_PASS ) reward_yd1 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
PRINT_WITH_NUMBER_NOW (Y1_1ST) counter_player_points 4000 1
CLEAR_WANTED_LEVEL player
ADD_SCORE player reward_yd1
REGISTER_HIGHEST_SCORE 0 counter_player_points

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		


// mission cleanup

mission_cleanup_yd1:

DISPLAY_RADAR 3 // PATHING ON

RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN off
//SET_PLAYER_CONTROL player on

REMOVE_BLIP blip_hot_rod_1
REMOVE_BLIP blip_hot_rod_2
REMOVE_BLIP blip_hot_rod_3
REMOVE_BLIP blip_start_yd1

MARK_MODEL_AS_NO_LONGER_NEEDED PED_MALE2
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_PATRIOT
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_CHEETAH
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_BOBCAT

SWITCH_ROADS_ON 500.0 60.0 -25.0 600.0 140.0 0.0
SWITCH_ROADS_ON -400.0 60.0 -25.0 -300.0 140.0 0.0

flag_player_on_mission = 0
flag_player_on_ray_mission = 0

//DELETE_CHAR street_racer_1

REMOVE_BLIP blip_rush_destination

MISSION_HAS_FINISHED
RETURN
		

//---------------------------GOSUBS-----------------------------------------------

driving_style_car_1:
	IF NOT IS_CAR_DEAD hot_rod_1
		SET_CAR_CRUISE_SPEED hot_rod_1 40.0
		SET_CAR_DRIVING_STYLE hot_rod_1 3
		CAR_GOTO_COORDINATES_ACCURATE hot_rod_1 finish_x finish_y -1.0
		flag_drive_mode_1 = 0
	ENDIF
RETURN

driving_style_car_2:
	IF NOT IS_CAR_DEAD hot_rod_2 
		SET_CAR_CRUISE_SPEED hot_rod_2 45.0
		SET_CAR_DRIVING_STYLE hot_rod_2 2
		CAR_GOTO_COORDINATES_ACCURATE hot_rod_2 finish_x finish_y -1.0
		flag_drive_mode_2 = 0
	ENDIF
RETURN

driving_style_car_3:
	IF NOT IS_CAR_DEAD hot_rod_3
		SET_CAR_CRUISE_SPEED hot_rod_3 35.0
		SET_CAR_DRIVING_STYLE hot_rod_3 2
		CAR_GOTO_COORDINATES_ACCURATE hot_rod_3 finish_x finish_y -1.0
		flag_drive_mode_3 = 0
	ENDIF
RETURN


player_points:
	++ counter_player_points
	++ counter_finish
	//ADD_SCORE player 1000
	//PRINT_BIG ( YD1_BON ) 1000 4
	PRINT_WITH_NUMBER_BIG (YD1_CNT) counter_player_points 2000 4
	ADD_ONE_OFF_SOUND player_car_x player_car_y player_car_z SOUND_PART_MISSION_COMPLETE
	GOSUB finish_coord_generator
RETURN

nonplayer_points_1:
	++ counter_nonplayer1_points
	++ counter_finish
	ADD_ONE_OFF_SOUND player_car_x player_car_y player_car_z SOUND_PART_MISSION_COMPLETE
	GOSUB finish_coord_generator
RETURN

nonplayer_points_2:
	++ counter_nonplayer2_points
	++ counter_finish
	ADD_ONE_OFF_SOUND player_car_x player_car_y player_car_z SOUND_PART_MISSION_COMPLETE
	GOSUB finish_coord_generator
RETURN

nonplayer_points_3:
	++ counter_nonplayer3_points
	++ counter_finish
	ADD_ONE_OFF_SOUND player_car_x player_car_y player_car_z SOUND_PART_MISSION_COMPLETE
	GOSUB finish_coord_generator
RETURN



//----------------FINISH COORD GENERATOR--------------------------------------

finish_coord_generator:


IF flag_random_yd1 = 0

	IF counter_finish = 1
		REMOVE_BLIP blip_rush_destination
		finish_x = 106.0
		finish_y = -403.36
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
		//flag_corona_yd1 = 1
	ENDIF

	IF counter_finish = 2
		REMOVE_BLIP blip_rush_destination
		finish_x = 86.8
		finish_y = -538.6
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
		//flag_corona_yd1 = 0
	ENDIF

	IF counter_finish = 3
		REMOVE_BLIP blip_rush_destination
		finish_x = 173.5
		finish_y = -696.6
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 4
		REMOVE_BLIP blip_rush_destination
		finish_x = 165.0
		finish_y = -886.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 5
		REMOVE_BLIP blip_rush_destination
		finish_x = 78.5
		finish_y = -945.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 6
		REMOVE_BLIP blip_rush_destination
		finish_x = -69.4
		finish_y = -926.2
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF


	IF counter_finish = 7
		REMOVE_BLIP blip_rush_destination
		finish_x = 207.8
		finish_y = -1041.5
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF


	IF counter_finish = 8
		REMOVE_BLIP blip_rush_destination
		finish_x = 49.1
		finish_y = -1034.1
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 9
		REMOVE_BLIP blip_rush_destination
		finish_x = 74.3
		finish_y = -920.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 10
		REMOVE_BLIP blip_rush_destination
		finish_x = 105.5
		finish_y = -1095.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 11
		REMOVE_BLIP blip_rush_destination
		finish_x = -114.0
		finish_y = -499.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 12
		REMOVE_BLIP blip_rush_destination
		finish_x = -10.79
		finish_y = -463.1
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 13
		REMOVE_BLIP blip_rush_destination
		finish_x = 346.0
		finish_y = -1211.4
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF
	/*
	IF counter_finish = 14
		REMOVE_BLIP blip_rush_destination
		finish_x = 524.3
		finish_y = -519.6
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 15
		REMOVE_BLIP blip_rush_destination
		finish_x = 530.4
		finish_y = -55.2
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 16
		REMOVE_BLIP blip_rush_destination
		finish_x = 548.5
		finish_y = -370.5
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 17
		REMOVE_BLIP blip_rush_destination
		finish_x = 69.8
		finish_y = 107.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 18
		REMOVE_BLIP blip_rush_destination
		finish_x = -41.6 
		finish_y = -1353.5
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF
	*/
	IF counter_finish = 14
		REMOVE_BLIP blip_rush_destination
		finish_x = start_x
		finish_y = start_y
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 15
		REMOVE_BLIP blip_rush_destination
	ENDIF

ENDIF

IF flag_random_yd1 = 1

	IF counter_finish = 1
		REMOVE_BLIP blip_rush_destination
		finish_x = 173.5
		finish_y = -696.6
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 2
		REMOVE_BLIP blip_rush_destination
		finish_x = -114.0
		finish_y = -499.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 3
		REMOVE_BLIP blip_rush_destination
		finish_x = -10.79
		finish_y = -463.1
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 4
		REMOVE_BLIP blip_rush_destination
		finish_x = 78.5
		finish_y = -945.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 5
		REMOVE_BLIP blip_rush_destination
		finish_x = -69.4
		finish_y = -926.2
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 6
		REMOVE_BLIP blip_rush_destination
		finish_x = -73.4
		finish_y = -1013.6
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 7
		REMOVE_BLIP blip_rush_destination
		finish_x = 207.8
		finish_y = -1041.5
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 8
		REMOVE_BLIP blip_rush_destination
		finish_x = 86.8
		finish_y = -538.6
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
		//flag_corona_yd1 = 0
	ENDIF

	IF counter_finish = 9
		REMOVE_BLIP blip_rush_destination
		finish_x = 49.1
		finish_y = -1034.1
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 10
		REMOVE_BLIP blip_rush_destination
		finish_x = 74.3
		finish_y = -920.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 11
		REMOVE_BLIP blip_rush_destination
		finish_x = 105.5
		finish_y = -1095.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF


	IF counter_finish = 12
		REMOVE_BLIP blip_rush_destination
		finish_x = 346.0
		finish_y = -1211.4
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF


	IF counter_finish = 13
		REMOVE_BLIP blip_rush_destination
		finish_x = -8.4
		finish_y = -803.2
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF
	/*
	IF counter_finish = 14
		REMOVE_BLIP blip_rush_destination
		finish_x = 548.5
		finish_y = -370.5
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 15
		REMOVE_BLIP blip_rush_destination
		finish_x = 165.0
		finish_y = -886.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 16
		REMOVE_BLIP blip_rush_destination
		finish_x = 69.8
		finish_y = 107.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 17
		REMOVE_BLIP blip_rush_destination
		finish_x = -41.6 
		finish_y = -1353.5
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 18
		REMOVE_BLIP blip_rush_destination
		finish_x = 106.0
		finish_y = -403.36
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
		//flag_corona_yd1 = 1
	ENDIF
	*/
	IF counter_finish = 14
		REMOVE_BLIP blip_rush_destination
		finish_x = start_x
		finish_y = start_y
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 15
		REMOVE_BLIP blip_rush_destination
	ENDIF
ENDIF

IF flag_random_yd1 = 2

	IF counter_finish = 14
		REMOVE_BLIP blip_rush_destination
		finish_x = start_x
		finish_y = start_y
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF
	/*
	IF counter_finish = 18
		REMOVE_BLIP blip_rush_destination
		finish_x = -10.79
		finish_y = -463.1
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 17
		REMOVE_BLIP blip_rush_destination
		finish_x = 78.5
		finish_y = -945.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 16
		REMOVE_BLIP blip_rush_destination
		finish_x = -69.4
		finish_y = -926.2
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 15
		REMOVE_BLIP blip_rush_destination
		finish_x = 524.3
		finish_y = -519.6
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 14
		REMOVE_BLIP blip_rush_destination
		finish_x = 172.8
		finish_y = -1066.9
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF
	*/
	IF counter_finish = 13
		REMOVE_BLIP blip_rush_destination
		finish_x = 86.8
		finish_y = -538.6
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
		//flag_corona_yd1 = 0
	ENDIF

	IF counter_finish = 12
		REMOVE_BLIP blip_rush_destination
		finish_x = 49.1
		finish_y = -1034.1
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 11
		REMOVE_BLIP blip_rush_destination
		finish_x = 74.3
		finish_y = -920.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 10
		REMOVE_BLIP blip_rush_destination
		finish_x = 105.5
		finish_y = -1095.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF


	IF counter_finish = 9
		REMOVE_BLIP blip_rush_destination
		finish_x = 346.0
		finish_y = -1211.4
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF


	IF counter_finish = 8
		REMOVE_BLIP blip_rush_destination
		finish_x = -8.4
		finish_y = -803.2
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 7
		REMOVE_BLIP blip_rush_destination
		finish_x = 251.5
		finish_y = -208.5
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 6
		REMOVE_BLIP blip_rush_destination
		finish_x = 165.0
		finish_y = -886.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 5
		REMOVE_BLIP blip_rush_destination
		finish_x = -72.5
		finish_y = -803.0
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 4
		REMOVE_BLIP blip_rush_destination
		finish_x = -41.6 
		finish_y = -1353.5
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 3
		REMOVE_BLIP blip_rush_destination
		finish_x = 106.0
		finish_y = -403.36
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
		//flag_corona_yd1 = 1
	ENDIF

	IF counter_finish = 2
		REMOVE_BLIP blip_rush_destination
		finish_x = 122.1
		finish_y = -932.0 
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 1
		REMOVE_BLIP blip_rush_destination
		finish_x = 173.5
		finish_y = -696.6
		ADD_BLIP_FOR_COORD finish_x finish_y -100.0 blip_rush_destination
	ENDIF

	IF counter_finish = 15
		REMOVE_BLIP blip_rush_destination
	ENDIF
ENDIF

RETURN


MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************YARDIE MISSION 2******************************** 
// *****************************************************************************************
// ********************************************'UZI RIDER'**********************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_yd2
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_yd2_failed
ENDIF
GOSUB mission_cleanup_yd2

MISSION_END
 
// Variables for mission

VAR_INT gang_car_yd2

VAR_INT chaperone_1 chaperone_2

VAR_INT body_count_yd2

VAR_INT player_yd2 wanted_yd2 flag_clear

VAR_INT blip_driveby_yd2

VAR_INT flag_upsidedown flag_chap_1_n&v flag_chap_2_n&v flag_out_of_car_message

VAR_INT	driveby_total_1 driveby_total_2
VAR_INT timer_dif_yd2 timer_start_yd2 timer_now_yd2	
	

VAR_FLOAT driveby_x driveby_y

VAR_FLOAT yd2turf_x yd2turf_y

VAR_FLOAT y2_x y2_y y2_z
//VAR_FLOAT yd2_x yd2_y yd2_z
//VAR_FLOAT chap_1_x chap_1_y chap_1_z
//VAR_FLOAT chap_2_x chap_2_y chap_2_z


// ****************************************Mission Start************************************

mission_start_yd2:
REGISTER_MISSION_GIVEN
SCRIPT_NAME yard2 
flag_player_on_mission = 1
flag_player_on_yardie_mission = 1
WAIT 0

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_yd2_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

//SWITCH_STREAMING OFF

PRINT_BIG ( YD2 ) 15000 2 //"Yardie Mission 1"	 

TIMERA = 0

WHILE TIMERA < 1500					  
	WAIT 0

ENDWHILE
*/

// ******************************************CUTSCENE***************************************



{

SET_PED_DENSITY_MULTIPLIER 0.0
SET_POLICE_IGNORE_PLAYER player on


//WHILE NOT HAS_MODEL_LOADED cut_obj1
//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE YD_PH2
SET_CUTSCENE_OFFSET 121.0 -272.3 15.25
CLEAR_AREA_OF_CHARS 100.5 -250.0 0.0 130.5 -290.0 25.0
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player

//CLEAR_AREA 1219.5 -321.1 27.5 1.0 TRUE
//SET_PLAYER_COORDINATES player 1219.5 -321.1 26.4

//SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

//SWITCH_STREAMING OFF
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( YD2_A ) 10000 1 

WHILE cs_time < 4581
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD2_A1 ) 10000 1 

WHILE cs_time < 7135
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD2_B ) 10000 1 

WHILE cs_time < 10431
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD2_B1 ) 10000 1 
/*
WHILE cs_time < 13770
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD2_D ) 10000 1 

WHILE cs_time < 18676
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD2_D1 ) 10000 1 


WHILE cs_time < 24139
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_G ) 10000 1 

WHILE cs_time < 28919
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_H ) 10000 1 
*/
WHILE cs_time < 13900
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE



DO_FADE 1500 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE


SWITCH_STREAMING ON
CLEAR_PRINTS
CLEAR_CUTSCENE
//SET_CAMERA_IN_FRONT_OF_PLAYER

}

WAIT 0

REQUEST_MODEL CAR_PERENNIAL
REQUEST_MODEL PED_GANG_YARDIE_A
REQUEST_MODEL PED_GANG_YARDIE_B

WHILE NOT HAS_MODEL_LOADED CAR_PERENNIAL
OR NOT HAS_MODEL_LOADED PED_GANG_YARDIE_A
OR NOT HAS_MODEL_LOADED PED_GANG_YARDIE_B
	WAIT 0
ENDWHILE

//PRINT_BIG ( YD2 ) 15000 2

timer_dif_yd2 = 0
flag_out_of_car_message = 0
flag_upsidedown = 0
flag_chap_1_n&v = 0
flag_chap_2_n&v = 0
flag_clear = 0
body_count_yd2 = 0
driveby_total_1 = 0
driveby_total_2 = 0

RESET_NUM_OF_MODELS_KILLED_BY_PLAYER

//------------COORDS-----------------------

driveby_x = 940.0
driveby_y = -220.0

yd2turf_x = 231.0
yd2turf_y = -531.0

//------------------CUTSCENE-------------------------------
STORE_WANTED_LEVEL player wanted_yd2
CLEAR_WANTED_LEVEL player

SET_PLAYER_CONTROL player off
GET_PLAYER_CHAR player player_yd2

SET_FIXED_CAMERA_POSITION 117.3 -266.3 17.0 0.0 0.0 0.0
POINT_CAMERA_AT_PLAYER player FIXED JUMP_CUT
SWITCH_WIDESCREEN on

//clear traffic--------------------------

   // SETUP_ZONE_CAR_INFO STADIUM DAY   (10) (0 0 0) 0 0 0 0 20 300 300 300 0 0 0
   // SETUP_ZONE_CAR_INFO STADIUM NIGHT ( 7) (0 0 0) 0 0 0 0 10 300 300 300 0 0 0

SET_CAR_DENSITY_MULTIPLIER 0.0

/*
PRINT_NOW ( YD2_A ) 4000 1//I need to see if you're capable of doing my dirty work
WAIT 4000

PRINT_NOW ( YD2_B ) 4000 1//A couple of my boys will be there to meet you and take you for a ride.
WAIT 4000
*/
// Mission stuff goes here

//DO_FADE 1500 FADE_OUT
//WAIT 1500

CLEAR_AREA 4.2 -310.1 16.0 40.0 true
CLEAR_AREA 97.0 -285.5 16.0 50.0 true

DO_FADE 1500 FADE_IN
WAIT 1500

CREATE_CAR CAR_PERENNIAL 4.2 -310.1 16.0 gang_car_yd2
SET_CAR_HEADING gang_car_yd2 0.0
SET_CAR_ONLY_DAMAGED_BY_PLAYER gang_car_yd2 True

CREATE_CHAR_INSIDE_CAR gang_car_yd2 PEDTYPE_CIVMALE PED_GANG_YARDIE_A chaperone_1
CREATE_CHAR_AS_PASSENGER gang_car_yd2 PEDTYPE_CIVMALE PED_GANG_YARDIE_B 0 chaperone_2


CAR_GOTO_COORDINATES gang_car_yd2 113.0 -272.0 16.0
SET_CAR_CRUISE_SPEED gang_car_yd2 25.0
SET_CAR_DRIVING_STYLE gang_car_yd2 3



IF NOT IS_CAR_DEAD gang_car_yd2
	POINT_CAMERA_AT_CAR gang_car_yd2 FIXED INTERPOLATION
ENDIF

WHILE NOT LOCATE_STOPPED_CAR_2D gang_car_yd2 113.0 -272.0 5.0 5.0 false
	WAIT 0
	IF IS_CAR_DEAD gang_car_yd2
		GOTO mission_yd2_failed_assert
	ENDIF
	IF flag_clear = 0
		CLEAR_AREA 115.0 -272.0 16.0 10.0 true
		flag_clear = 1
	ENDIF
ENDWHILE

TURN_CHAR_TO_FACE_COORD player_yd2 115.0 -272.0 16.0 

IF NOT IS_CAR_DEAD gang_car_yd2
	CAR_SET_IDLE gang_car_yd2
	IF NOT IS_CHAR_DEAD chaperone_2
	AND NOT IS_CHAR_DEAD chaperone_1
		SET_CHAR_OBJ_LEAVE_CAR chaperone_1 gang_car_yd2
		SET_CHAR_OBJ_LEAVE_CAR chaperone_2 gang_car_yd2
	ENDIF
ENDIF

IF NOT IS_CHAR_DEAD chaperone_2
AND NOT IS_CHAR_DEAD chaperone_1
AND NOT IS_CAR_DEAD gang_car_yd2
	WHILE IS_CHAR_IN_CAR chaperone_2 gang_car_yd2
	OR IS_CHAR_IN_CAR chaperone_1 gang_Car_yd2
		WAIT 0
		IF IS_CHAR_DEAD chaperone_2
		OR IS_CHAR_DEAD chaperone_1
		OR IS_CAR_DEAD gang_car_yd2
			GOTO mission_yd2_failed_assert
		ENDIF
	ENDWHILE
ELSE
	GOTO mission_yd2_failed_assert
ENDIF

IF NOT IS_CHAR_DEAD	chaperone_2
	POINT_CAMERA_AT_CHAR chaperone_2 FIXED INTERPOLATION
ENDIF

IF NOT IS_CHAR_DEAD	chaperone_1
AND NOT IS_CHAR_DEAD player_yd2
	CHAR_LOOK_AT_CHAR_ALWAYS chaperone_1 player_yd2
ENDIF

plinky_yd2:

WAIT 0

GET_PLAYER_COORDINATES player y2_x y2_y y2_z

IF NOT IS_CHAR_DEAD chaperone_2
AND NOT IS_CHAR_DEAD chaperone_1
	SET_CHAR_HEALTH	chaperone_1 100
	SET_CHAR_HEALTH chaperone_2 100
	//y2_x = y2_x + 1.0
	y2_y = y2_y - 1.0
	SET_CHAR_OBJ_GOTO_COORD_ON_FOOT chaperone_2 y2_x y2_y
	SET_CHAR_OBJ_WAIT_ON_FOOT chaperone_1
	//GET_CHAR_COORDINATES chaperone_2 yd2_x yd2_y yd2_z
	CHAR_LOOK_AT_CHAR_ALWAYS chaperone_2 player_yd2
	CHAR_LOOK_AT_CHAR_ALWAYS player_yd2 chaperone_2
	IF NOT LOCATE_CHAR_ON_FOOT_2D chaperone_2 y2_X y2_Y 2.0 2.0 false
		GOTO plinky_yd2
	ENDIF
ELSE
	GOTO mission_yd2_failed_assert
ENDIF

IF NOT IS_CHAR_DEAD chaperone_2
	TURN_CHAR_TO_FACE_PLAYER chaperone_2 player
	TURN_CHAR_TO_FACE_CHAR player_yd2 chaperone_2 
	SET_CHAR_OBJ_WAIT_ON_FOOT chaperone_2
ELSE
	GOTO mission_yd2_failed_assert
ENDIF

LOAD_MISSION_AUDIO YD2_A
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO poodle
	ENDIF
ENDWHILE
PLAY_MISSION_AUDIO
PRINT_NOW ( YD2_C ) 10000 1//We're going for a little ride into Hepburn Heights, Whack us some Diablo's.
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO poodle
	ENDIF
ENDWHILE
CLEAR_PRINTS

IF NOT IS_CHAR_DEAD chaperone_1
	SET_CHAR_HEALTH	chaperone_1 100
ENDIF
IF NOT IS_CHAR_DEAD chaperone_2
	SET_CHAR_HEALTH	chaperone_2 100
ENDIF

LOAD_MISSION_AUDIO YD2_B
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO poodle
	ENDIF
ENDWHILE
PLAY_MISSION_AUDIO
PRINT_NOW (YD2_D ) 10000 1//You do the driving and shooting. We'll make sure you don't get cold feet
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO poodle
	ENDIF
ENDWHILE
CLEAR_PRINTS

IF NOT IS_CHAR_DEAD chaperone_1
	SET_CHAR_HEALTH	chaperone_1 100
ENDIF
IF NOT IS_CHAR_DEAD chaperone_2
	SET_CHAR_HEALTH	chaperone_2 100
ENDIF

LOAD_MISSION_AUDIO YD2_C
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO poodle
	ENDIF
ENDWHILE
PLAY_MISSION_AUDIO
PRINT_NOW (YD2_CC) 10000 1//Here, you'll need a 'piece'
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
	IF IS_BUTTON_PRESSED PAD1 CROSS
		GOTO poodle
	ENDIF
ENDWHILE
CLEAR_PRINTS

poodle:
STOP_CHAR_LOOKING player_yd2
//SET_CHAR_OBJ_NO_OBJ player_yd2
//SET_PLAYER_CONTROL player on

GIVE_WEAPON_TO_PLAYER player WEAPONTYPE_UZI 150
WAIT 1000
SET_CURRENT_PLAYER_WEAPON player WEAPONTYPE_UZI

WHILE NOT IS_CURRENT_PLAYER_WEAPON player WEAPONTYPE_UZI
	WAIT 0
ENDWHILE
	

//SET_PLAYER_CONTROL player off

POINT_CAMERA_AT_PLAYER player FIXED INTERPOLATION

IF NOT IS_CHAR_DEAD chaperone_1
	SET_CHAR_HEALTH	chaperone_1 100
	STOP_CHAR_LOOKING  chaperone_1
	IF NOT IS_CAR_DEAD gang_car_yd2
		SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER chaperone_1 gang_car_yd2
	ENDIF
ENDIF
IF NOT IS_CHAR_DEAD chaperone_2
	SET_CHAR_HEALTH	chaperone_2 100
	CHAR_LOOK_AT_CHAR_ALWAYS chaperone_2 player_yd2
ENDIF

SET_RADIO_CHANNEL JAH_RADIO 0

IF NOT IS_CAR_DEAD gang_car_yd2
	SET_CHAR_OBJ_ENTER_CAR_AS_DRIVER player_yd2 gang_car_yd2
ELSE
	GOTO mission_yd2_failed_assert
ENDIF

WHILE NOT IS_CHAR_IN_CAR player_yd2 gang_car_yd2
	WAIT 0
	IF IS_CAR_DEAD gang_car_yd2
		GOTO mission_yd2_failed_assert
	ENDIF
	
	IF NOT IS_CHAR_DEAD chaperone_1
		SET_CHAR_HEALTH	chaperone_1 100
	ENDIF
	IF NOT IS_CHAR_DEAD chaperone_2
		SET_CHAR_HEALTH	chaperone_2 100
	ENDIF
ENDWHILE

IF NOT IS_CAR_DEAD gang_car_yd2
AND NOT IS_CHAR_DEAD chaperone_2
AND NOT IS_CHAR_DEAD chaperone_1
	STOP_CHAR_LOOKING chaperone_1
	STOP_CHAR_LOOKING chaperone_2
	SET_CHAR_OBJ_ENTER_CAR_AS_PASSENGER chaperone_2 gang_car_yd2

	WHILE NOT IS_CHAR_IN_CAR chaperone_2 gang_car_yd2
	OR NOT IS_CHAR_IN_CAR chaperone_1 gang_car_yd2
		WAIT 0
		IF IS_CHAR_DEAD chaperone_2
		OR IS_CHAR_DEAD chaperone_1
		OR IS_CAR_DEAD gang_car_yd2
			GOTO mission_yd2_failed_assert
		ENDIF
		IF NOT IS_CHAR_DEAD chaperone_1
			SET_CHAR_HEALTH	chaperone_1 100
		ENDIF
		IF NOT IS_CHAR_DEAD chaperone_2
			SET_CHAR_HEALTH	chaperone_2 100
		ENDIF
	ENDWHILE
	//LOCK_CAR_DOORS gang_car_yd2 CARLOCK_LOCKED
ELSE
	GOTO mission_yd2_failed_assert
ENDIF

IF NOT IS_CAR_DEAD gang_car_yd2
	SET_CAR_ONLY_DAMAGED_BY_PLAYER gang_car_yd2 false
	//LOCK_CAR_DOORS gang_car_yd2 CARLOCK_LOCKED
ENDIF

IF NOT IS_CHAR_DEAD chaperone_1
	SET_CHAR_CANT_BE_DRAGGED_OUT chaperone_1 TRUE
	SET_CHAR_STAYS_IN_CURRENT_LEVEL chaperone_1 FALSE
ENDIF
IF NOT IS_CHAR_DEAD chaperone_2
	SET_CHAR_CANT_BE_DRAGGED_OUT chaperone_2 TRUE
	SET_CHAR_STAYS_IN_CURRENT_LEVEL chaperone_2 FALSE
ENDIF

RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN off
SET_PLAYER_CONTROL player on

LOAD_MISSION_AUDIO YD2_C1
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE
PLAY_MISSION_AUDIO
PRINT_SOON ( YD2_E ) 4000 1//Let's drive!!
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
ENDWHILE

ADD_BLIP_FOR_COORD driveby_x driveby_y -100.0 blip_driveby_yd2

SET_PED_DENSITY_MULTIPLIER 1.0
SET_POLICE_IGNORE_PLAYER player off


//----reset traffic density--------------------------

SET_CAR_DENSITY_MULTIPLIER 1.0

//---------------------SET PED DENSITIES----------------------------------------------------

SETUP_ZONE_PED_INFO	TOWERS DAY   (15) 0 0 700 (0 0 0 0) 20 
SETUP_ZONE_PED_INFO TOWERS NIGHT (10) 0 0 800 (0 0 0 0) 10


//-----------------------GETTING TO THE HIT-------------------------------------------------

ALTER_WANTED_LEVEL player wanted_yd2

getting_there:

IF NOT IS_CAR_DEAD gang_car_yd2
	WHILE NOT IS_PLAYER_IN_ZONE player TOWERS
		WAIT 0

		IF NOT IS_CAR_DEAD gang_car_yd2
			IF IS_CAR_UPSIDEDOWN gang_car_yd2
			AND IS_CAR_STOPPED gang_car_yd2
				flag_upsidedown = 1
				GOTO mission_yd2_failed
			ENDIF
			IF NOT IS_CAR_HEALTH_GREATER gang_car_yd2 250 //NB!! Add Sub spray shop
				IF NOT LOCATE_CAR_3D gang_car_yd2 379.0 -493.7 26.2 15.0 15.0 15.0 false//comm spray shop
				AND NOT LOCATE_CAR_3D gang_car_yd2 925.4 -358.7 10.8 15.0 15.0 15.0 false//ind spray shop
					flag_upsidedown = 1
					GOTO mission_yd2_failed
				ENDIF
			ENDIF

			IF NOT IS_PLAYER_IN_CAR player gang_car_yd2
				flag_upsidedown = 2
				GOSUB player_out_of_car
				IF NOT IS_CAR_DEAD gang_car_yd2
					IF NOT IS_PLAYER_IN_CAR player gang_car_yd2
						flag_upsidedown = 2
						GOTO mission_yd2_failed
					ENDIF
				ELSE
					GOTO mission_yd2_failed_assert
				ENDIF
				LOCK_CAR_DOORS gang_car_yd2 CARLOCK_LOCKED
			ENDIF
		ELSE
			GOTO mission_yd2_failed_assert
		ENDIF

	ENDWHILE
ELSE
	GOTO mission_yd2_failed_assert
ENDIF

LOAD_MISSION_AUDIO YD2_F
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE
PLAY_MISSION_AUDIO
PRINT_NOW (YD2_G1) 2500 1//Hepburn Heights -Diablo turf.
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
ENDWHILE

LOAD_MISSION_AUDIO YD2_G
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE
PLAY_MISSION_AUDIO
PRINT_SOON (YD2_G2) 2500 1 //"Whack us five Diablos, but remember; you don't leave this car!"
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
ENDWHILE


//------------------------------THE HIT-----------------------------------------------------------------

REMOVE_BLIP blip_driveby_yd2 
DISPLAY_ONSCREEN_COUNTER_WITH_STRING body_count_yd2 COUNTER_DISPLAY_NUMBER KILLS

WHILE body_count_yd2 < 10

	WAIT 0
		IF NOT IS_CAR_DEAD gang_car_yd2
			IF IS_CAR_UPSIDEDOWN gang_car_yd2
			AND IS_CAR_STOPPED gang_car_yd2
				flag_upsidedown = 1
				GOTO mission_yd2_failed
			ENDIF
			IF NOT IS_CAR_HEALTH_GREATER gang_car_yd2 250 //NB!! Add Sub spray shop
				IF NOT LOCATE_CAR_3D gang_car_yd2 379.0 -493.7 26.2 15.0 15.0 15.0 false//comm spray shop
				AND NOT LOCATE_CAR_3D gang_car_yd2 925.4 -358.7 10.8 15.0 15.0 15.0 false//ind spray shop
					flag_upsidedown = 1
					GOTO mission_yd2_failed
				ENDIF
			ENDIF
			IF NOT IS_PLAYER_IN_CAR player gang_car_yd2
				GOSUB player_out_of_car
				IF NOT IS_CAR_DEAD gang_car_yd2
					IF NOT IS_PLAYER_IN_CAR player gang_car_yd2
						flag_upsidedown = 2
						GOTO mission_yd2_failed
					ENDIF
				ELSE
					GOTO mission_yd2_failed_assert
				ENDIF
			ENDIF
		ELSE
			GOTO mission_yd2_failed_assert
		ENDIF

		GET_NUM_OF_MODELS_KILLED_BY_PLAYER PED_GANG_DIABLO_A driveby_total_1
		GET_NUM_OF_MODELS_KILLED_BY_PLAYER PED_GANG_DIABLO_B driveby_total_2
		body_count_yd2 = driveby_total_1 + driveby_total_2
		/*
		IF body_count_yd2 > 1
			SET_GANG_PLAYER_ATTITUDE GANG_DIABLO HATES player
			SET_GANG_WEAPONS GANG_DIABLO WEAPONTYPE_BASEBALLBAT WEAPONTYPE_UZI
		ELSE
			SET_GANG_PLAYER_ATTITUDE GANG_DIABLO NEUTRAL player
		ENDIF
		*/
ENDWHILE


//------------------------------------BACK TO YARDIE TURF-------------------------------------------------------
LOAD_MISSION_AUDIO YD2_H
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE
PLAY_MISSION_AUDIO
PRINT_NOW (YD2_H) 2500 1//"OK, Get us back to Yardie turf, GO GO GO!!"
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
ENDWHILE

CLEAR_ONSCREEN_COUNTER body_count_yd2

back_to_yardie_turf:

ADD_BLIP_FOR_COORD yd2turf_x yd2turf_y 26.0 blip_driveby_yd2

IF NOT IS_CAR_DEAD gang_car_yd2
	WHILE NOT LOCATE_STOPPED_CAR_3D gang_car_yd2 yd2turf_x yd2turf_y 26.0 5.0 5.0 5.0 true   
		WAIT 0

			IF NOT IS_CAR_DEAD gang_car_yd2
				IF IS_CAR_UPSIDEDOWN gang_car_yd2
				AND IS_CAR_STOPPED gang_car_yd2
					flag_upsidedown = 1
					GOTO mission_yd2_failed
				ENDIF
				IF NOT IS_CAR_HEALTH_GREATER gang_car_yd2 250 //NB!! Add Sub spray shop
					IF NOT LOCATE_CAR_3D gang_car_yd2 379.0 -493.7 26.2 15.0 15.0 15.0 false//comm spray shop
					AND NOT LOCATE_CAR_3D gang_car_yd2 925.4 -358.7 10.8 15.0 15.0 15.0 false//ind spray shop
						flag_upsidedown = 1
						GOTO mission_yd2_failed
					ENDIF
				ENDIF
				IF NOT IS_PLAYER_IN_CAR player gang_car_yd2
					GOSUB player_out_of_car
					IF NOT IS_CAR_DEAD gang_car_yd2
						IF NOT IS_PLAYER_IN_CAR player gang_car_yd2
							flag_upsidedown = 2
							GOTO mission_yd2_failed
						ENDIF
					ELSE
						GOTO mission_yd2_failed_assert
					ENDIF
				ENDIF
			ELSE
				GOTO mission_yd2_failed_assert
			ENDIF
	ENDWHILE
ELSE
	GOTO mission_yd2_failed_assert
ENDIF
/*
PRINT_NOW (YD2_I) 4000 1//"OK, stop and drop us off."

//REMOVE_BLIP blip_driveby_yd2

IF NOT IS_CAR_DEAD gang_car_yd2
	WHILE NOT IS_CAR_STOPPED_IN_AREA_2D gang_car_yd2 yd2turf_x yd2turf_y 5.0 5.0 true

		WAIT 0
		IF NOT IS_CAR_DEAD gang_car_yd2
			IF NOT LOCATE_CAR_2D gang_car_yd2 yd2turf_x yd2turf_y 30.0 30.0 false
				PRINT_SOON (YD2_J) 4000 1//HEY! Where you going? Get us back to our turf!
				GOTO back_to_yardie_turf
			ENDIF
			IF IS_CAR_UPSIDEDOWN gang_car_yd2
			AND IS_CAR_STOPPED gang_car_yd2
				flag_upsidedown = 1
				GOTO mission_yd2_failed
			ENDIF
			IF NOT IS_CAR_HEALTH_GREATER gang_car_yd2 50
				flag_upsidedown = 1
				GOTO mission_yd2_failed
			ENDIF
			IF NOT IS_PLAYER_IN_CAR player gang_car_yd2
				GOSUB player_out_of_car
				IF NOT IS_CAR_DEAD gang_car_yd2
					IF NOT IS_PLAYER_IN_CAR player gang_car_yd2
						flag_upsidedown = 2
						GOTO mission_yd2_failed
					ENDIF
				ELSE
					GOTO mission_yd2_failed_assert
				ENDIF
			ENDIF
		ELSE
			GOTO mission_yd2_failed_assert
		ENDIF

	ENDWHILE
ELSE
	GOTO mission_yd2_failed_assert
ENDIF
*/
SET_PLAYER_CONTROL player off

IF NOT IS_CHAR_DEAD chaperone_1
AND NOT IS_CHAR_DEAD chaperone_2
AND NOT IS_CAR_DEAD	gang_car_yd2
	SET_CAR_HEALTH gang_car_yd2 850
	SET_CHAR_OBJ_LEAVE_CAR chaperone_1 gang_car_yd2
	SET_CHAR_OBJ_LEAVE_CAR chaperone_2 gang_car_yd2
ELSE
	GOTO mission_yd2_failed_assert
ENDIF

LOAD_MISSION_AUDIO YD2_OK
WHILE NOT HAS_MISSION_AUDIO_LOADED
	WAIT 0
ENDWHILE
PLAY_MISSION_AUDIO
PRINT_NOW (YD2_L) 6000 1//"ok, you're the kinda man we like as friends, now. Ya irie, man. Real shoota."
WHILE NOT HAS_MISSION_AUDIO_FINISHED
	WAIT 0
ENDWHILE

SET_PLAYER_CONTROL player on

GOTO mission_yd2_passed
	   		


// Mission Yardie2 failed


mission_yd2_failed:

IF NOT IS_CHAR_DEAD chaperone_1
AND NOT IS_CAR_DEAD	gang_car_yd2
	SET_CHAR_OBJ_LEAVE_CAR chaperone_1 gang_car_yd2
ENDIF
IF NOT IS_CHAR_DEAD chaperone_2
AND NOT IS_CAR_DEAD	gang_car_yd2
	SET_CHAR_OBJ_LEAVE_CAR chaperone_2 gang_car_yd2
ENDIF

IF flag_upsidedown = 1
	LOAD_MISSION_AUDIO YD2_D
	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE
	PLAY_MISSION_AUDIO
	PRINT_NOW (YD2_M) 4000 1//"He's wrecked my car!! Waste him!!"
ENDIF

IF flag_upsidedown = 2
	LOAD_MISSION_AUDIO YD2_E
	WHILE NOT HAS_MISSION_AUDIO_LOADED
		WAIT 0
	ENDWHILE
	PLAY_MISSION_AUDIO
	PRINT_NOW (YD2_F) 4000 1//"He's bailing out on us!"
ENDIF

IF NOT IS_CHAR_DEAD chaperone_1
AND NOT IS_CAR_DEAD gang_car_yd2
	WHILE IS_CHAR_IN_CAR chaperone_1 gang_car_yd2
		WAIT 0
		IF IS_CHAR_DEAD chaperone_1
			GOTO boddle
		ENDIF
		IF IS_CAR_DEAD gang_car_yd2
			GOTO boddle
		ENDIF
	ENDWHILE
ENDIF

boddle:
IF NOT IS_CHAR_DEAD chaperone_2
AND NOT IS_CAR_DEAD gang_car_yd2
	WHILE IS_CHAR_IN_CAR chaperone_2 gang_car_yd2
		WAIT 0
		IF IS_CHAR_DEAD chaperone_2
			GOTO mission_yd2_failed_assert
		ENDIF
		IF IS_CAR_DEAD gang_car_yd2
			GOTO mission_yd2_failed_assert
		ENDIF
	ENDWHILE
ENDIF

IF NOT IS_CHAR_DEAD chaperone_1
	GIVE_WEAPON_TO_CHAR chaperone_1 WEAPONTYPE_SHOTGUN 10
	WHILE NOT IS_CURRENT_CHAR_WEAPON chaperone_1 WEAPONTYPE_SHOTGUN
		WAIT 0
		IF IS_CHAR_DEAD	chaperone_1
			GOTO oink
		ENDIF
	ENDWHILE
	IF NOT IS_CHAR_DEAD chaperone_1
		TURN_CHAR_TO_FACE_PLAYER chaperone_1 player
		IF IS_PLAYER_IN_ZONE player TOWERS
			SET_CHAR_THREAT_SEARCH chaperone_1 THREAT_GANG_DIABLO
		ENDIF
		SET_CHAR_THREAT_SEARCH chaperone_1 THREAT_PLAYER1
	ENDIF
ENDIF

oink:

IF NOT IS_CHAR_DEAD chaperone_2
	GIVE_WEAPON_TO_CHAR chaperone_2 WEAPONTYPE_UZI 30
	WHILE NOT IS_CURRENT_CHAR_WEAPON chaperone_2 WEAPONTYPE_UZI
		WAIT 0
		IF IS_CHAR_DEAD	chaperone_2
			GOTO poink
		ENDIF
	ENDWHILE
	IF NOT IS_CHAR_DEAD chaperone_2
		TURN_CHAR_TO_FACE_PLAYER chaperone_2 player
		IF IS_PLAYER_IN_ZONE player TOWERS
			SET_CHAR_THREAT_SEARCH chaperone_2 THREAT_GANG_DIABLO
		ENDIF
		SET_CHAR_THREAT_SEARCH chaperone_2 THREAT_PLAYER1
	ENDIF
ENDIF

poink:
/*
//Yardies chase player off!!

WHILE NOT IS_PLAYER_DEAD player
	WAIT 0
	IF NOT IS_CHAR_DEAD	chaperone_1
		GET_CHAR_COORDINATES chaperone_1 chap_1_x chap_1_y chap_1_z
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player chap_1_x chap_1_y 30.0 30.0 false
			MARK_CHAR_AS_NO_LONGER_NEEDED chaperone_1
			flag_chap_1_n&v = 1
		ENDIF
	ELSE
		flag_chap_1_n&v = 1
	ENDIF
	IF NOT IS_CHAR_DEAD	chaperone_2
		GET_CHAR_COORDINATES chaperone_2 chap_2_x chap_2_y chap_2_z
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player chap_2_x chap_2_y 30.0 30.0 false
			MARK_CHAR_AS_NO_LONGER_NEEDED chaperone_2
			flag_chap_2_n&v = 1
		ENDIF
	ELSE
		flag_chap_2_n&v = 1
	ENDIF
	IF flag_chap_1_n&v = 1
	AND flag_chap_2_n&v = 1
		GOTO mission_yd2_failed_assert
	ENDIF

ENDWHILE
*/		
mission_yd2_failed_assert:

PRINT_BIG ( M_FAIL ) 2000 1

RETURN   

// mission yd2 passed

mission_yd2_passed:

flag_yardie_mission2_passed = 1

IF NOT IS_CHAR_DEAD chaperone_1
AND NOT IS_CHAR_DEAD chaperone_2
AND NOT IS_CAR_DEAD	gang_car_yd2
	WHILE IS_CHAR_IN_CAR chaperone_1 gang_car_yd2
	OR IS_CHAR_IN_CAR chaperone_2 gang_car_yd2
		WAIT 0
		IF IS_CHAR_DEAD chaperone_1
		OR IS_CHAR_DEAD chaperone_2
		OR IS_CAR_DEAD	gang_car_yd2
			GOTO filby
		ENDIF
	ENDWHILE
ELSE
	GOTO filby
ENDIF

filby:
IF NOT IS_CHAR_DEAD	chaperone_1
	SET_CHAR_OBJ_FLEE_ON_FOOT_TILL_SAFE chaperone_1
ENDIF
IF NOT IS_CHAR_DEAD	chaperone_2
	SET_CHAR_OBJ_FLEE_ON_FOOT_TILL_SAFE chaperone_2
ENDIF


PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
CLEAR_WANTED_LEVEL player
ADD_SCORE player 10000
REGISTER_MISSION_PASSED YD2
PLAYER_MADE_PROGRESS 1 
SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_DIABLO THREAT_PLAYER1
START_NEW_SCRIPT yardie_mission3_loop

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		

			   
// mission cleanup

mission_cleanup_yd2:

REMOVE_BLIP blip_driveby_yd2

flag_player_on_mission = 0
flag_player_on_yardie_mission = 0
CLEAR_ONSCREEN_COUNTER body_count_yd2
REMOVE_BLIP blip_driveby_yd2
//SET_PLAYER_CONTROL player on
SWITCH_WIDESCREEN off
RESTORE_CAMERA_JUMPCUT
IF NOT IS_CAR_DEAD gang_car_yd2
	LOCK_CAR_DOORS gang_car_yd2 CARLOCK_UNLOCKED
ENDIF
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YARDIE_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YARDIE_B

MARK_MODEL_AS_NO_LONGER_NEEDED CAR_PERENNIAL

//------------RESTORE PED DENSITIES---------------------------------------

SETUP_ZONE_PED_INFO	TOWERS DAY   (15) 0 0 300 (0 0 0 0) 20 
SETUP_ZONE_PED_INFO TOWERS NIGHT (10) 0 0 500 (0 0 0 0) 10

MISSION_HAS_FINISHED
RETURN
		
//-----------------------------GOSUBS----------------------------------------------

player_out_of_car:
	IF NOT IS_CAR_DEAD gang_car_yd2
		LOCK_CAR_DOORS gang_car_yd2 CARLOCK_UNLOCKED
	ENDIF
	WHILE timer_dif_yd2 < 7500
		WAIT 0
		IF NOT IS_CAR_DEAD gang_car_yd2
			IF NOT IS_CAR_HEALTH_GREATER gang_car_yd2 250 //NB!! Add Sub spray shop
				IF NOT LOCATE_CAR_3D gang_car_yd2 379.0 -493.7 26.2 15.0 15.0 15.0 false//comm spray shop
				AND NOT LOCATE_CAR_3D gang_car_yd2 925.4 -358.7 10.8 15.0 15.0 15.0 false//ind spray shop
					flag_upsidedown = 1
					GOTO mission_yd2_failed
				ENDIF
			ENDIF
			IF flag_out_of_car_message = 0
				LOAD_MISSION_AUDIO YD2_ASS
				WHILE NOT HAS_MISSION_AUDIO_LOADED
					WAIT 0
				ENDWHILE
				PLAY_MISSION_AUDIO
				PRINT_NOW (YD2_N) 3000 1//you got five seconds to get back in this car.
				flag_out_of_car_message = 1
				GET_GAME_TIMER timer_start_yd2
			ENDIF
			GET_GAME_TIMER timer_now_yd2
			timer_dif_yd2 = timer_now_yd2 - timer_start_yd2
			
			IF NOT IS_CAR_DEAD gang_car_yd2
				IF IS_PLAYER_IN_CAR player gang_car_yd2
					flag_out_of_car_message = 0
					RETURN
				ENDIF
			ENDIF
		ENDIF
	ENDWHILE
	
	LOCK_CAR_DOORS gang_car_yd2 CARLOCK_LOCKED

RETURN
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************YARDIE MISSION ******************************** 
// *****************************************************************************************
// ***************************************'GANG CAR ROUND_UP'*******************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_yd3
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_yd3_failed
ENDIF
GOSUB mission_cleanup_yd3

MISSION_END
 
// Variables for mission

VAR_INT gangcar_yd3

VAR_INT flag_player_in_diablocar flag_player_in_mafiacar flag_player_in_yakuzacar //flag_player_in_any_gangcar
VAR_INT flag_diablo_delivered_yd3 flag_yakuzacar_delivered_yd3 flag_mafia_delivered_yd3
VAR_INT loop_2_passport
VAR_INT counter_cars_yd3
//VAR_INT garage_yd3
VAR_INT blip_garage_yd3
VAR_INT flag_dam_message flag_garage_message flag_already_boosted_message
VAR_INT flag_messages //flag_gangcar_flipped flag_blip_garage flag_blip_spray

//VAR_FLOAT garage_min_x_yd3 garage_min_y_yd3
//VAR_FLOAT garage_max_x_yd3 garage_max_y_yd3
VAR_FLOAT blip_x_yd3 blip_y_yd3
//VAR_FLOAT gangcar_x gangcar_y gangcar_z


// ****************************************Mission Start************************************

mission_start_yd3:
REGISTER_MISSION_GIVEN
SCRIPT_NAME yard3 
flag_player_on_mission = 1
flag_player_on_yardie_mission = 1

WAIT 0

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_yd3_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

//SWITCH_STREAMING OFF

PRINT_BIG ( YD3 ) 15000 2 //"Yardie Mission 1"	 

TIMERA = 0

WHILE TIMERA < 1500					  
	WAIT 0

ENDWHILE
*/

// ******************************************CUTSCENE***************************************



{

SET_PED_DENSITY_MULTIPLIER 0.0
SET_POLICE_IGNORE_PLAYER player on

//WHILE NOT HAS_MODEL_LOADED cut_obj1
//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE YD_PH3
SET_CUTSCENE_OFFSET 121.0 -272.3 15.25
CLEAR_AREA_OF_CHARS 100.5 -250.0 0.0 130.5 -290.0 25.0
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player

//CLEAR_AREA 1219.5 -321.1 27.5 1.0 TRUE
//SET_PLAYER_COORDINATES player 1219.5 -321.1 26.4

//SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( YD3_A ) 10000 1 

WHILE cs_time < 3700
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD3_A1 ) 10000 1 

WHILE cs_time < 6370
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD3_B ) 10000 1 

WHILE cs_time < 8658
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD3_B1 ) 10000 1 

WHILE cs_time < 10408
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD3_B2 ) 10000 1 

WHILE cs_time < 13950
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD3_C ) 10000 1 

WHILE cs_time < 16920
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD3_C1 ) 10000 1 
/*

WHILE cs_time < 28919
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_H ) 10000 1 
*/
WHILE cs_time < 20066
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE



DO_FADE 1500 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

SWITCH_STREAMING ON
CLEAR_PRINTS
CLEAR_CUTSCENE
//SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

DO_FADE 1500 FADE_IN
SET_PED_DENSITY_MULTIPLIER 1.0
SET_POLICE_IGNORE_PLAYER player off

}


//PRINT_BIG ( YD3 ) 15000 2

WAIT 1000


counter_cars_yd3 = 0
/*

blip_x_yd3 = 1217.0
blip_y_yd3 = -243.5


garage_min_x_yd3 = 1213.0   
garage_min_y_yd3 = -241.0
garage_max_x_yd3 = 1221.0
garage_max_y_yd3 = -245.5

garage_min_x_yd3 = 257.0   
garage_min_y_yd3 = -803.0
garage_max_x_yd3 = 263.0
garage_max_y_yd3 = -795.0*/

blip_x_yd3 = 260.0
blip_y_yd3 = -798.0

loop_2_passport = 0

flag_player_in_diablocar = 0
flag_player_in_mafiacar = 0
flag_player_in_yakuzacar = 0
//flag_player_in_any_gangcar = 0

flag_diablo_delivered_yd3 = 0
flag_yakuzacar_delivered_yd3 = 0
flag_mafia_delivered_yd3 = 0

flag_dam_message = 0
flag_garage_message = 0
flag_already_boosted_message = 0

//flag_gangcar_flipped = 0
flag_messages = 0
//flag_blip_garage = 0
//flag_blip_spray = 0

//PRINT_NOW ( YD3_A ) 4000 1 //"We want you to boost some gang cars so we can do hits on our enemies' turf and set them at each other's throats."
//MESSAGE_WAIT 4000 1
//PRINT_NOW ( YD3_B ) 4000 1 //"We want a Mafia beamer, a Triad van and a Diablo stallion so we can hit any gang in Portland."
//MESSAGE_WAIT 4000 1
//PRINT_NOW ( YD3_C ) 4000 1 //"Drop them off at <location> and remember, they're no use to us wrecked!!"

//SET_GARAGE garage_min_x_yd3 garage_min_y_yd3 26.8 garage_max_x_yd3 garage_max_y_yd3 31.8 GARAGE_MISSION garage_yd3

ADD_BLIP_FOR_COORD blip_x_yd3 blip_y_yd3 -100.0 blip_garage_yd3
 
// Mission stuff goes here


loop_1:

//WHILE counter_cars_yd3 < 3

	WAIT 0
	GOSUB blippage

	IF IS_PLAYER_IN_ANY_CAR player

		IF IS_PLAYER_IN_MODEL player CAR_DIABLOS 
			IF flag_diablo_delivered_yd3 = 0
				STORE_CAR_PLAYER_IS_IN player gangcar_yd3
				SET_CAN_RESPRAY_CAR gangcar_yd3 False
				flag_player_in_diablocar = 1
				flag_player_in_mafiacar = 0
				flag_player_in_yakuzacar = 0
				GOSUB damage_check
			ENDIF
			IF flag_diablo_delivered_yd3 = 1
			AND flag_already_boosted_message = 0
				PRINT_NOW ( YD3_E ) 3000 1 //You've already boosted a diablo gangcar!
				flag_already_boosted_message = 1
			ENDIF
		ENDIF

		IF IS_PLAYER_IN_MODEL player CAR_MAFIA
			IF flag_mafia_delivered_yd3 = 0
				STORE_CAR_PLAYER_IS_IN player gangcar_yd3
				SET_CAN_RESPRAY_CAR gangcar_yd3 False
				flag_player_in_diablocar = 0
				flag_player_in_mafiacar = 1
				flag_player_in_yakuzacar = 0
				GOSUB damage_check
			ENDIF
			IF flag_mafia_delivered_yd3 = 1
			AND flag_already_boosted_message = 0
				PRINT_NOW ( YD3_F ) 3000 1 //You've already boosted a mafia gangcar!
				flag_already_boosted_message = 1
			ENDIF
		ENDIF

		IF IS_PLAYER_IN_MODEL player CAR_YAKUZA
			IF flag_yakuzacar_delivered_yd3 = 0
				STORE_CAR_PLAYER_IS_IN player gangcar_yd3
				SET_CAN_RESPRAY_CAR gangcar_yd3 False
				flag_player_in_diablocar = 0
				flag_player_in_mafiacar = 0
				flag_player_in_yakuzacar = 1
				GOSUB damage_check
			ENDIF

			IF flag_yakuzacar_delivered_yd3 = 1
			AND flag_already_boosted_message = 0
				PRINT_NOW (YD3_G) 3000 1 //You've already boosted a Triad fish van!
				flag_already_boosted_message = 1
			ENDIF
		ENDIF

	ELSE
		flag_dam_message = 0
		flag_garage_message = 0
		flag_already_boosted_message = 0
		//loop_2_passport = 0
	ENDIF

	IF loop_2_passport = 0
		GOTO loop_1
	ENDIF
	
	//flag_messages = 0

loop_2:

	GOSUB damage_check
	IF IS_CAR_IN_MISSION_GARAGE garage_yd3

	//IF IS_CAR_IN_AREA_2D gangcar_yd3 garage_min_x_yd3 garage_min_y_yd3 garage_max_x_yd3 garage_max_y_yd3 false
	//AND NOT IS_PLAYER_IN_AREA_2D player garage_min_x_yd3 garage_min_y_yd3 garage_max_x_yd3 garage_max_y_yd3 false
	//AND IS_CAR_HEALTH_GREATER gangcar_yd3 800

		//GOSUB blippage

		

		IF flag_player_in_diablocar = 1
		AND flag_diablo_delivered_yd3 = 0 
			flag_diablo_delivered_yd3 = 1
			++ counter_cars_yd3
			flag_player_in_diablocar = 0
			//flag_player_in_any_gangcar = 0

			loop_2_passport = 0
			PRINT_NOW (YD3_H) 3000 1 //Diablo gangcar boosted!
			ADD_ONE_OFF_SOUND 260.0 -790.0 28.0 SOUND_PART_MISSION_COMPLETE
		ENDIF

		IF flag_player_in_mafiacar = 1
		AND flag_mafia_delivered_yd3 = 0 
			flag_mafia_delivered_yd3 = 1
			++ counter_cars_yd3
			flag_player_in_mafiacar = 0
			//flag_player_in_any_gangcar = 0
			
			loop_2_passport = 0
			PRINT_NOW (YD3_I) 3000 1 //Mafia gangcar boosted!
			ADD_ONE_OFF_SOUND 260.0 -790.0 28.0 SOUND_PART_MISSION_COMPLETE
		ENDIF

	   	IF flag_player_in_yakuzacar = 1
		AND flag_yakuzacar_delivered_yd3 = 0 
			++ counter_cars_yd3
			flag_yakuzacar_delivered_yd3 = 1
			flag_player_in_yakuzacar = 0
			//flag_player_in_any_gangcar = 0

			loop_2_passport = 0
			PRINT_NOW (YD3_J) 3000 1 //Triad gangcar boosted!
			ADD_ONE_OFF_SOUND 260.0 -790.0 28.0 SOUND_PART_MISSION_COMPLETE
		ENDIF

	ENDIF
	
	IF NOT IS_CAR_DEAD gangcar_yd3
		IF IS_CAR_IN_AREA_2D gangcar_yd3 garage_min_x_yd3 garage_min_y_yd3 garage_max_x_yd3 garage_max_y_yd3 false
		AND NOT IS_PLAYER_IN_AREA_2D player garage_min_x_yd3 garage_min_y_yd3 garage_max_x_yd3 garage_max_y_yd3 false
		AND NOT IS_CAR_HEALTH_GREATER gangcar_yd3 800
			MARK_CAR_AS_NO_LONGER_NEEDED gangcar_yd3
		ENDIF
	ENDIF

	IF counter_cars_yd3 < 3
		GOTO loop_1
	ENDIF

	   		
	GOTO mission_yd3_passed


// Mission Yardie3 failed

mission_yd3_failed:

PRINT_BIG ( M_FAIL ) 2000 1
RETURN

   

// mission yd3 passed

mission_yd3_passed:

flag_yardie_mission3_passed = 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
CLEAR_WANTED_LEVEL player
ADD_SCORE player 10000
REGISTER_MISSION_PASSED YD3
PLAYER_MADE_PROGRESS 1 
START_NEW_SCRIPT yardie_mission4_loop

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		


// mission cleanup

mission_cleanup_yd3:
REMOVE_BLIP blip_garage_yd3
SET_TARGET_CAR_FOR_MISSION_GARAGE garage_yd3 -1

flag_player_on_mission = 0
flag_player_on_yardie_mission = 0
MISSION_HAS_FINISHED
RETURN
		
// ******************GOSUBS***********************************

blippage:

	IF flag_dam_message = 1

			IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
				REMOVE_BLIP blip_garage_yd3
				ADD_SPRITE_BLIP_FOR_COORD 925.3 -359.2 11.0 RADAR_SPRITE_SPRAY blip_garage_yd3
				//flag_blip_spray = 1
			ENDIF
			IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
				REMOVE_BLIP blip_garage_yd3
				ADD_SPRITE_BLIP_FOR_COORD 380.4 -493.8 26.2 RADAR_SPRITE_SPRAY blip_garage_yd3
				//flag_blip_spray = 1
			ENDIF
			IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
				REMOVE_BLIP blip_garage_yd3
				ADD_SPRITE_BLIP_FOR_COORD -1142.1 34.0 59.0 RADAR_SPRITE_SPRAY blip_garage_yd3
				//flag_blip_spray = 1
			ENDIF

	ELSE
		REMOVE_BLIP blip_garage_yd3
		ADD_BLIP_FOR_COORD blip_x_yd3 blip_y_yd3 -100.0 blip_garage_yd3
	ENDIF

RETURN



damage_check:

	IF IS_PLAYER_IN_ANY_CAR player
		IF NOT IS_CAR_DEAD gangcar_yd3
			IF IS_PLAYER_IN_CAR player gangcar_yd3
				IF IS_CAR_HEALTH_GREATER gangcar_yd3 900
				OR NOT IS_CAR_VISIBLY_DAMAGED gangcar_yd3
					IF flag_garage_message = 0
						PRINT_NOW (YD3_L) 3000 1 //Now take it to the garage!
						SET_TARGET_CAR_FOR_MISSION_GARAGE garage_yd3 gangcar_yd3
						flag_garage_message = 1
						flag_dam_message = 0
						loop_2_passport = 1
					ENDIF
				ELSE
					IF flag_dam_message = 0
						PRINT_NOW (YD3_K) 3000 1 //The car's nearly wrecked! Get it repaired!
						SET_TARGET_CAR_FOR_MISSION_GARAGE garage_yd3 -1
						flag_dam_message = 1
						flag_garage_message = 0
						loop_2_passport = 0
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN

MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// *****************************************Yardie mission 4******************************** 
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_yardie4
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_yd4_failed
ENDIF
GOSUB mission_cleanup_yardie4
MISSION_END
 
// Variables for mission

VAR_INT abandoned_car_y4 flag_van1_arrived

VAR_INT timer_y4

VAR_INT blip_abandoned_car_y4

VAR_INT gen1_van gen2_van gen3_van gen4_van

VAR_INT human_bomb_1
//VAR_INT human_bomb_2
//VAR_INT human_bomb_3
VAR_INT human_bomb_4
//VAR_INT human_bomb_5
//VAR_INT human_bomb_6
VAR_INT human_bomb_7
//VAR_INT human_bomb_8
VAR_INT human_bomb_9
VAR_INT human_bomb_demo

VAR_INT blip_bomber_1 blip_bomber_4 blip_bomber_7 blip_bomber_9

VAR_INT flag_bomb1_active
VAR_INT flag_bomb4_active
VAR_INT flag_bomb7_active
VAR_INT flag_bomb9_active

//VAR_INT counter_bomb1 counter_bomb4 counter_bomb7
//VAR_INT counter_bomb9

//VAR_INT bomber_collective_1 bomber_collective_2 bomber_collective_3


//CO-ORD VARIABLES*****************************************************

VAR_FLOAT gen1_x gen1_y //gen1_z
VAR_FLOAT gen2_x gen2_y //gen2_z
VAR_FLOAT gen3_x gen3_y //gen3_z
VAR_FLOAT gen4_x gen4_y //gen4_z

VAR_FLOAT abandoned_car_x abandoned_car_y //abandoned_car_z

VAR_FLOAT y4_x y4_y y4_z

VAR_FLOAT bomb_x bomb_y bomb_z
VAR_FLOAT bomb4_x bomb4_y bomb4_z
VAR_FLOAT bomb7_x bomb7_y bomb7_z
VAR_FLOAT bomb9_x bomb9_y bomb9_z




// ****************************************Mission Start************************************

mission_start_yardie4:
REGISTER_MISSION_GIVEN
SCRIPT_NAME yard4 
flag_player_on_mission = 1
flag_player_on_yardie_mission = 1

WAIT 0

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_yd4_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

//SWITCH_STREAMING OFF

PRINT_BIG ( YD4 ) 15000 2 //"Yardie Mission 4"	 

TIMERA = 0

WHILE TIMERA < 1500					  
	WAIT 0
ENDWHILE
*/

// ******************************************CUTSCENE***************************************



{

SET_PED_DENSITY_MULTIPLIER 0.0
SET_POLICE_IGNORE_PLAYER player on

//WHILE NOT HAS_MODEL_LOADED cut_obj1
//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE YD_PH4
SET_CUTSCENE_OFFSET 121.0 -272.3 15.25
CLEAR_AREA_OF_CHARS 100.5 -250.0 0.0 130.5 -290.0 25.0
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player

//CLEAR_AREA 1219.5 -321.1 27.5 1.0 TRUE
//SET_PLAYER_COORDINATES player 1219.5 -321.1 26.4

//SET_PLAYER_HEADING player 180.0

DO_FADE 1500 FADE_IN

//SWITCH_STREAMING OFF
START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( YD4_A ) 10000 1 

WHILE cs_time < 3000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD4_A1 ) 10000 1 

WHILE cs_time < 5322
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD4_A2 ) 10000 1 
/*
WHILE cs_time < 10759
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD4_C ) 10000 1 

WHILE cs_time < 13770
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD4_D ) 10000 1 

WHILE cs_time < 18676
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( YD4_D1 ) 10000 1 


WHILE cs_time < 24139
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_G ) 10000 1 

WHILE cs_time < 28919
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( DIAB2_H ) 10000 1 
*/
WHILE cs_time < 8600
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE



DO_FADE 1500 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

SWITCH_STREAMING ON
CLEAR_PRINTS
CLEAR_CUTSCENE
//SET_CAMERA_IN_FRONT_OF_PLAYER

WAIT 500

SET_PED_DENSITY_MULTIPLIER 1.0
SET_POLICE_IGNORE_PLAYER player off

DO_FADE 1500 FADE_IN
}



flag_van1_arrived = 0

flag_bomb1_active = 0
flag_bomb4_active = 0
flag_bomb7_active = 0
flag_bomb9_active = 0
gen1_x = -113.62
gen1_y = -1420.5
gen2_x = -90.54
gen2_y = -1480.0
gen3_x = -38.4
gen3_y = -1447.0
gen4_x = -53.2
gen4_y = -1501.0

//counter_bomb1 = 0
//counter_bomb4 = 0
//counter_bomb7 = 0
//counter_bomb9 = 0


abandoned_car_x = -71.5
abandoned_car_y = -1471.0


REQUEST_MODEL CAR_ESPERANTO
REQUEST_MODEL CAR_PONY
WHILE NOT HAS_MODEL_LOADED CAR_ESPERANTO
OR NOT HAS_MODEL_LOADED CAR_PONY
	WAIT 0
ENDWHILE

LOAD_SPECIAL_CHARACTER 1 bomber
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
	WAIT 0
ENDWHILE


//PRINT_BIG ( YD4 ) 15000 2

//WAIT 1000




//PRINT_NOW ( YD4_A ) 8000 2

//WAIT 8000

timer_y4 = 90000

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

DISPLAY_ONSCREEN_TIMER timer_y4

create_car_yd5:

CREATE_CAR CAR_ESPERANTO abandoned_car_x abandoned_car_y -100.0 abandoned_car_y4
SET_CAR_HEADING abandoned_car_y4 270.0
CAR_SET_IDLE abandoned_car_y4
ADD_BLIP_FOR_CAR abandoned_car_y4 blip_abandoned_car_y4

CREATE_CAR CAR_PONY gen2_x gen2_y 27.0 gen2_van
SET_CAR_HEADING gen2_van 345.0
CAR_SET_IDLE gen2_van
LOCK_CAR_DOORS gen2_van CARLOCK_LOCKOUT_PLAYER_ONLY


// Mission stuff goes here

IF NOT IS_CAR_DEAD abandoned_car_y4
	WHILE NOT IS_PLAYER_IN_CAR player abandoned_car_y4
		WAIT 0
		IF timer_y4 < 1
			PRINT_NOW (taxi2) 3000 1
			GOTO mission_yd4_failed
		ENDIF
		IF IS_CAR_DEAD abandoned_car_y4
			PRINT_NOW (WRECKED) 3000 1
			GOTO mission_yd4_failed
		ENDIF
	ENDWHILE
ELSE
	PRINT_NOW (WRECKED) 3000 1
	GOTO mission_yd4_failed
ENDIF

REMOVE_BLIP blip_abandoned_car_y4
SET_PLAYER_CONTROL player Off 
CLEAR_ONSCREEN_TIMER timer_y4

CLEAR_AREA -113.4 -1431.5 26.0 20.0 true

CREATE_CAR CAR_PONY gen1_x gen1_y 26.2 gen1_van
SET_CAR_HEADING gen1_van 180.0
CAR_SET_IDLE gen1_van
LOCK_CAR_DOORS gen1_van CARLOCK_LOCKOUT_PLAYER_ONLY
CREATE_CHAR_AS_PASSENGER gen1_van PEDTYPE_SPECIAL PED_SPECIAL1 0 human_bomb_demo

CREATE_CAR CAR_PONY gen3_x gen3_y 26.2 gen3_van
SET_CAR_HEADING gen3_van 90.0
CAR_SET_IDLE gen3_van
LOCK_CAR_DOORS gen3_van CARLOCK_LOCKOUT_PLAYER_ONLY

CREATE_CAR CAR_PONY gen4_x gen4_y 26.2 gen4_van
SET_CAR_HEADING gen4_van 90.0
CAR_SET_IDLE gen4_van
LOCK_CAR_DOORS gen4_van CARLOCK_LOCKOUT_PLAYER_ONLY


SET_FIXED_CAMERA_POSITION -82.0 -1472.0 27.5 0.0 0.0 0.0
IF NOT IS_CAR_DEAD abandoned_car_y4
	POINT_CAMERA_AT_CAR abandoned_car_y4 FIXED JUMP_CUT
ENDIF
//POINT_CAMERA_AT_PLAYER player FIXED JUMP_CUT
SWITCH_WIDESCREEN on


PRINT_NOW (YD4_B ) 3500 2
MESSAGE_WAIT 3500 true

PRINT_NOW (YD4_C) 3500 2
MESSAGE_WAIT 3500 true

PRINT_NOW (YD4_D) 2500 2
MESSAGE_WAIT 2500 true

IF NOT IS_CAR_DEAD gen1_van
	CAR_GOTO_COORDINATES_ACCURATE gen1_van -113.2 -1442.5 26.2
	POINT_CAMERA_AT_CAR gen1_van FIXED INTERPOLATION
ENDIF
IF NOT IS_CAR_DEAD gen3_van
	CAR_GOTO_COORDINATES gen3_van -53.5 -1446.7 26.2
ENDIF

WHILE flag_van1_arrived = 0
	WAIT 0
	IF NOT IS_CAR_DEAD gen1_van
		IF  LOCATE_CAR_2D gen1_van -113.2 -1442.5 4.0 4.0 false
			flag_van1_arrived = 1
		ENDIF
	ELSE
		GOTO mission_yd4_failed
	ENDIF
ENDWHILE 

IF NOT IS_CAR_DEAD gen1_van
AND NOT IS_CHAR_DEAD human_bomb_demo
	SET_CHAR_OBJ_LEAVE_CAR human_bomb_demo gen1_van
	WHILE IS_CHAR_IN_CAR human_bomb_demo gen1_van
		WAIT 0
		IF NOT IS_CHAR_DEAD human_bomb_demo
			GET_CHAR_COORDINATES human_bomb_demo bomb_z bomb_y bomb_z
		ENDIF
		IF IS_CHAR_DEAD human_bomb_demo
			GOTO selkirk
		ENDIF
		IF IS_CAR_DEAD gen1_van
			GOTO selkirk
		ENDIF
	ENDWHILE
ENDIF

SET_CHAR_HEADING human_bomb_demo 180.0 
SET_FIXED_CAMERA_POSITION -115.76 -1455.0 25.9 0.0 0.0 0.0
CHAR_SET_IDLE human_bomb_demo
POINT_CAMERA_AT_CHAR human_bomb_demo FIXED JUMP_CUT
//SET_CAMERA_ZOOM CAM_ZOOM_TWO
PRINT_NOW (YD4_1) 3000 1

IF NOT IS_CHAR_DEAD human_bomb_demo
	SET_CHAR_OBJ_RUN_TO_COORD human_bomb_demo -114.5 -1452.4
	WHILE NOT LOCATE_CHAR_ON_FOOT_2D human_bomb_demo -114.5 -1452.4 3.0 3.0 0
		WAIT 0
		IF NOT IS_CHAR_DEAD human_bomb_demo
			GET_CHAR_COORDINATES human_bomb_demo bomb_x bomb_y bomb_z
		ELSE
			GOTO selkirk
		ENDIF
	ENDWHILE
ENDIF

WAIT 3000

IF NOT IS_CHAR_DEAD human_bomb_demo
GET_PLAYER_COORDINATES player y4_x y4_y y4_z
POINT_CAMERA_AT_CHAR human_bomb_demo FOLLOWPED INTERPOLATION
	SET_CHAR_OBJ_RUN_TO_COORD human_bomb_demo y4_x y4_y
	WHILE NOT LOCATE_CHAR_ON_FOOT_2D human_bomb_demo y4_x y4_y 5.0 5.0 0
		WAIT 0
		IF NOT IS_CHAR_DEAD human_bomb_demo
			GET_CHAR_COORDINATES human_bomb_demo bomb_x bomb_y bomb_z
		ENDIF
		IF IS_CHAR_DEAD human_bomb_demo
			GOTO selkirk
		ENDIF
	ENDWHILE
ENDIF

selkirk:
ADD_EXPLOSION bomb_x bomb_y bomb_z EXPLOSION_GRENADE
ADD_ONE_OFF_SOUND bomb_x bomb_y bomb_z sound_test_1
SHAKE_CAM 500

WAIT 1000

RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN off
SET_PLAYER_CONTROL player on
WAIT 0
MARK_CHAR_AS_NO_LONGER_NEEDED human_bomb_demo
PRINT_NOW (YD4_2) 3000 1

// Bomber generation loop

GOTO le_loop_de_mort

// GENERATORS*****GENERATORS*****GENERATORS*****GENERATORS*****GENERATORS*****GENERATORS*****

//111111111111111111111111111111111111111111111111111111111111111111111
generator_1_easy:
			
IF NOT IS_CAR_DEAD gen1_van

	CREATE_CHAR_AS_PASSENGER gen1_van PEDTYPE_SPECIAL PED_SPECIAL1 0 human_bomb_1
	flag_bomb1_active = 1
	SET_CHAR_OBJ_LEAVE_CAR human_bomb_1 gen1_van
	ADD_BLIP_FOR_CHAR human_bomb_1 blip_bomber_1

	WHILE IS_CHAR_IN_CAR human_bomb_1 gen1_van
		GET_CHAR_COORDINATES human_bomb_1 bomb_x bomb_y bomb_z
		WAIT 0
		IF IS_CHAR_DEAD human_bomb_1
		OR IS_CAR_DEAD gen1_van
			RETURN
		ENDIF
	ENDWHILE
ENDIF

RETURN




//222222222222222222222222222222222222222222222222222222222222222222222222
generator_2_easy:

IF NOT IS_CAR_DEAD gen2_van

	CREATE_CHAR_AS_PASSENGER gen2_van PEDTYPE_SPECIAL PED_SPECIAL1 0 human_bomb_4
	flag_bomb4_active = 1
	SET_CHAR_OBJ_LEAVE_CAR human_bomb_4 gen2_van
	ADD_BLIP_FOR_CHAR human_bomb_4 blip_bomber_4


	WHILE IS_CHAR_IN_CAR human_bomb_4 gen2_van
		GET_CHAR_COORDINATES human_bomb_4 bomb4_x bomb4_y bomb4_z
		WAIT 0
		IF IS_CHAR_DEAD human_bomb_4
		OR IS_CAR_DEAD gen2_van
			RETURN
		ENDIF
	ENDWHILE
ENDIF

RETURN

//333333333333333333333333333333333333333333333333333333333333333333333333
generator_3_easy:

IF NOT IS_CAR_DEAD gen3_van

	CREATE_CHAR_AS_PASSENGER gen3_van PEDTYPE_SPECIAL PED_SPECIAL1 0 human_bomb_7
	flag_bomb7_active = 1
	SET_CHAR_OBJ_LEAVE_CAR human_bomb_7 gen3_van
	ADD_BLIP_FOR_CHAR human_bomb_7 blip_bomber_7

	WHILE IS_CHAR_IN_CAR human_bomb_7 gen3_van
		GET_CHAR_COORDINATES human_bomb_7 bomb7_x bomb7_y bomb7_z
		WAIT 0
		IF IS_CHAR_DEAD human_bomb_7
		OR IS_CAR_DEAD gen3_van
			RETURN
		ENDIF
	ENDWHILE
ENDIF

RETURN

//444444444444444444444444444444444444444444444444444444444444444444444444
generator_4_easy:

IF NOT IS_CAR_DEAD gen4_van

	CREATE_CHAR_AS_PASSENGER gen4_van PEDTYPE_SPECIAL PED_SPECIAL1 0 human_bomb_9
	flag_bomb9_active = 1
	SET_CHAR_OBJ_LEAVE_CAR human_bomb_9 gen4_van
	ADD_BLIP_FOR_CHAR human_bomb_9 blip_bomber_9

	WHILE IS_CHAR_IN_CAR human_bomb_9 gen4_van
		GET_CHAR_COORDINATES human_bomb_9 bomb9_x bomb9_y bomb9_z
		WAIT 0
		IF IS_CHAR_DEAD human_bomb_9
		OR IS_CAR_DEAD gen4_van
			RETURN
		ENDIF
	ENDWHILE
ENDIF

RETURN

// MAIN LOOP*****MAIN LOOP*****MAIN LOOP*****MAIN LOOP*****MAIN LOOP*****MAIN LOOP*****MAIN LOOP*****MAIN LOOP*****MAIN LOOP*****

le_loop_de_mort:

WAIT 0


IF flag_bomb1_active = 0
	GOSUB generator_1_easy
ELSE
	IF NOT IS_CHAR_DEAD	human_bomb_1
		GET_PLAYER_COORDINATES player y4_x y4_y y4_z
		SET_CHAR_OBJ_RUN_TO_COORD human_bomb_1 y4_x y4_y
		GET_CHAR_COORDINATES human_bomb_1 bomb_x bomb_y bomb_z
		CLEAR_CHAR_THREAT_SEARCH human_bomb_1
		IF LOCATE_CHAR_ANY_MEANS_3D human_bomb_1 y4_x y4_y y4_z 3.0 3.0 4.0 0
		OR NOT IS_CHAR_HEALTH_GREATER human_bomb_1 95
		   GOSUB detonate_1
		   MARK_CHAR_AS_NO_LONGER_NEEDED human_bomb_1
		   flag_bomb1_active = 0	
		   GOSUB generator_1_easy
		ENDIF
	ELSE
		GOSUB detonate_1
		MARK_CHAR_AS_NO_LONGER_NEEDED human_bomb_1
		flag_bomb1_active = 0	
	ENDIF
ENDIF


IF flag_bomb4_active = 0
	GOSUB generator_2_easy
ELSE
	IF NOT IS_CHAR_DEAD human_bomb_4
		GET_PLAYER_COORDINATES player y4_x y4_y y4_z
		SET_CHAR_OBJ_RUN_TO_COORD human_bomb_4 y4_x y4_y
		GET_CHAR_COORDINATES human_bomb_4 bomb4_x bomb4_y bomb4_z
		CLEAR_CHAR_THREAT_SEARCH human_bomb_4
		IF LOCATE_CHAR_ANY_MEANS_3D human_bomb_4 y4_x y4_y y4_z 3.0 3.0 4.0 0
		OR NOT IS_CHAR_HEALTH_GREATER human_bomb_4 95
		   GOSUB detonate_4	
		   MARK_CHAR_AS_NO_LONGER_NEEDED human_bomb_4
		   flag_bomb4_active = 0
		ENDIF
	ELSE
		GOSUB detonate_4
		MARK_CHAR_AS_NO_LONGER_NEEDED human_bomb_4
		flag_bomb4_active = 0	
	ENDIF
ENDIF


IF flag_bomb7_active = 0
	GOSUB generator_3_easy
ELSE
	IF NOT IS_CHAR_DEAD human_bomb_7
		GET_PLAYER_COORDINATES player y4_x y4_y y4_z
		SET_CHAR_OBJ_RUN_TO_COORD human_bomb_7 y4_x y4_y
		GET_CHAR_COORDINATES human_bomb_7 bomb7_x bomb7_y bomb7_z
		CLEAR_CHAR_THREAT_SEARCH human_bomb_7
		IF LOCATE_CHAR_ANY_MEANS_3D human_bomb_7 y4_x y4_y y4_z 3.0 3.0 4.0 0
		OR NOT IS_CHAR_HEALTH_GREATER human_bomb_7 95
		   GOSUB detonate_7
		   MARK_CHAR_AS_NO_LONGER_NEEDED human_bomb_7
		   flag_bomb7_active = 0
		ENDIF
	ELSE
		GOSUB detonate_7
		MARK_CHAR_AS_NO_LONGER_NEEDED human_bomb_7
		flag_bomb7_active = 0	
	ENDIF
ENDIF


IF flag_bomb9_active = 0
	GOSUB generator_4_easy
ELSE
	IF NOT IS_CHAR_DEAD human_bomb_9
		GET_PLAYER_COORDINATES player y4_x y4_y y4_z
		GET_CHAR_COORDINATES human_bomb_9 bomb9_x bomb9_y bomb9_z
		CLEAR_CHAR_THREAT_SEARCH human_bomb_9
		SET_CHAR_OBJ_RUN_TO_COORD human_bomb_9 y4_x y4_y
		IF LOCATE_CHAR_ANY_MEANS_3D human_bomb_9 y4_x y4_y y4_z 3.0 3.0 4.0 0
		OR NOT IS_CHAR_HEALTH_GREATER human_bomb_9 95
		   GOSUB detonate_9
		   MARK_CHAR_AS_NO_LONGER_NEEDED human_bomb_9
		   flag_bomb9_active = 0
		ENDIF
	ELSE
		GOSUB detonate_9
		MARK_CHAR_AS_NO_LONGER_NEEDED human_bomb_9
		flag_bomb9_active = 0	
	ENDIF
ENDIF


IF IS_CAR_DEAD gen1_van
AND IS_CAR_DEAD gen2_van
AND IS_CAR_DEAD gen3_van
AND IS_CAR_DEAD gen4_van
	IF IS_CHAR_DEAD human_bomb_1
	AND IS_CHAR_DEAD human_bomb_4
	AND IS_CHAR_DEAD human_bomb_7
	AND IS_CHAR_DEAD human_bomb_9
		GOTO mission_yardie4_passed
	ENDIF
ENDIF

GOTO le_loop_de_mort


// DETONATIONS*****DETONATIONS*****DETONATIONS*****DETONATIONS*****DETONATIONS*****DETONATIONS*****DETONATIONS*****

detonate_1:
	IF flag_bomb1_active = 1
		ADD_EXPLOSION bomb_x bomb_y bomb_z EXPLOSION_GRENADE
		ADD_ONE_OFF_SOUND bomb_x bomb_y bomb_z sound_test_1
		SHAKE_CAM 500
		flag_bomb1_active = 0
		REMOVE_BLIP blip_bomber_1

	ENDIF
RETURN

detonate_4:
	IF flag_bomb4_active = 1
		ADD_EXPLOSION bomb4_x bomb4_y bomb4_z EXPLOSION_GRENADE
		ADD_ONE_OFF_SOUND bomb4_x bomb4_y bomb4_z sound_test_1
		SHAKE_CAM 500		  
		REMOVE_BLIP blip_bomber_4

	ENDIF
RETURN

detonate_7:
	IF flag_bomb7_active = 1
		ADD_EXPLOSION bomb7_x bomb7_y bomb7_z EXPLOSION_GRENADE
		ADD_ONE_OFF_SOUND bomb7_x bomb7_y bomb7_z sound_test_1
		SHAKE_CAM 500
		flag_bomb7_active = 0
		REMOVE_BLIP blip_bomber_7

	ENDIF
RETURN

detonate_9:
	IF flag_bomb9_active = 1
		ADD_EXPLOSION bomb9_x bomb9_y bomb9_z EXPLOSION_GRENADE
		ADD_ONE_OFF_SOUND bomb9_x bomb9_y bomb9_z sound_test_1
		SHAKE_CAM 500
		flag_bomb9_active = 0
		REMOVE_BLIP blip_bomber_9

	ENDIF
RETURN








	   		



// Mission yardie4 failed

mission_yd4_failed:

PRINT_BIG ( M_FAIL ) 2000 1

RETURN

   

// mission yardie4 passed

mission_yardie4_passed:

USE_TEXT_COMMANDS 111 // HACKED achievement unlock // A_GIFT_FROM_THE_KING

flag_yardie_mission4_passed = 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
CLEAR_WANTED_LEVEL player
ADD_SCORE player 10000
REGISTER_MISSION_PASSED YD4
PLAYER_MADE_PROGRESS 1 
SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_YARDIE THREAT_PLAYER1

REMOVE_BLIP	yardie_contact_blip
START_NEW_SCRIPT yardie_mission1_loop
flag_yardie_mission1_passed = 0

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		


// mission cleanup

mission_cleanup_yardie4:

flag_player_on_mission = 0

flag_player_on_yardie_mission = 0
REMOVE_BLIP blip_abandoned_car_y4
REMOVE_BLIP blip_bomber_1
REMOVE_BLIP blip_bomber_4
REMOVE_BLIP blip_bomber_7
REMOVE_BLIP blip_bomber_9
CLEAR_ONSCREEN_TIMER timer_y4
UNLOAD_SPECIAL_CHARACTER 1 
MARK_MODEL_AS_NO_LONGER_NEEDED PED_SPECIAL1
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_ESPERANTO
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_PONY
MISSION_HAS_FINISHED
RETURN
		
MISSION_START
// *****************************************************************************************
// *********************************  Love Mission 4  **************************************
// ********************************* Grand Theft Aero **************************************
// *****************************************************************************************
// *** The real packages are still in the Cessna, which is at the airport. 				 ***
// *** When the player arrives he will see a Palantic Construction vans drive away. 	 ***
// *** As he gets closer there are some Colombians inside the hangar, seeing the player  ***
// *** they will attack. After the player has killed them, he will go into the hangar to ***
// *** find out that the package is not there. The player must go to to the building 	 ***
// *** site. There the player will have to fight his way through the Colombians to 		 ***
// *** Catalina & Miguel and the packages.                                               ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_love4

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_love4_failed
ENDIF

GOSUB mission_cleanup_love4

MISSION_END
 
// Variables for mission

//VAR_INT flag_player_on_love_mission flag_love_mission4_passed// TEST VARS

VAR_INT love_4_blip	goon_in_hangar1_blip goon_in_hangar2_blip goon_in_hangar3_blip goon_in_hangar4_blip																			
VAR_INT van1_driver goon_in_hangar1 goon_in_hangar2 goon_in_hangar3 goon_in_hangar4	ducking_flag
VAR_INT car_van1_lm4 car_van2_lm4 car_van3_lm4 wingless_cessna 

VAR_INT cs_cat cs_lift lift players_vehicle

VAR_INT deadman1 hangar_route
VAR_INT flag_result_1 reset_timera_flag player_car_l4 cs_whip
VAR_INT goon_at_yard1 goon_at_yard2 goon_at_yard3 goon_at_yard4 goon_at_yard5 goon_at_yard6 goon_at_yard7 goon_at_yard8	goon_at_yard9 goon_at_yard10
VAR_INT yard_route1 yard_route2 yard_route3	game_timer_var c_site_area_flag	colombian_car
VAR_INT	yakuza_car1	yakuza_car2 yakuza_guard1 yakuza_guard2 yakuza_guard3 yakuza_guard4	yakuza_guard5 yakuza_car3
VAR_INT goon_in_hangar1_flag goon_in_hangar2_flag goon_in_hangar3_flag goon_in_hangar4_flag
VAR_INT	goon_in_hangar1_ducking goon_in_hangar2_ducking goon_in_hangar3_ducking goon_in_hangar4_ducking
VAR_INT goon_in_hangar1_waitstate goon_in_hangar2_waitstate goon_in_hangar3_waitstate goon_in_hangar4_waitstate
VAR_INT goon_in_hangar1_blip_flag goon_in_hangar2_blip_flag goon_in_hangar3_blip_flag goon_in_hangar4_blip_flag
VAR_INT goon_at_yard1_flag goon_at_yard1_duck goon_at_yard1_duck_timer
VAR_INT goon_at_yard2_flag goon_at_yard2_duck goon_at_yard2_duck_timer
VAR_INT goon_at_yard3_flag goon_at_yard3_duck goon_at_yard3_duck_timer
VAR_INT goon_at_yard4_flag goon_at_yard4_duck goon_at_yard4_duck_timer
VAR_INT goon_at_yard5_flag break_timer break_timer_start
VAR_INT goon_at_yard6_flag 
VAR_INT goon_at_yard7_duck goon_at_yard7_duck_timer
VAR_INT goon_at_yard8_flag goon_at_yard8_duck goon_at_yard8_duck_timer
VAR_INT goon_at_yard9_flag
VAR_INT goon_at_yard10_flag goon_at_yard10_duck goon_at_yard10_duck_timer love4_path_to_airport

VAR_FLOAT van3_x van3_y van3_z x_component y_component differ_x differ_y distance_result1 distance_result2	sum_difference
VAR_FLOAT temp_result_x temp_result_y result1_x result1_y result2_x result2_y
VAR_FLOAT player_lo4_x player_lo4_y	player_lo4_z temp_var_x temp_var_y

// ****************************************Mission Start************************************

mission_start_love4:

flag_player_on_mission = 1
flag_player_on_love_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

SCRIPT_NAME love4

flag_result_1 = 0
reset_timera_flag = 0

goon_in_hangar1_flag = -1
goon_in_hangar2_flag = -1
goon_in_hangar3_flag = -1
goon_in_hangar4_flag = -1

goon_in_hangar1_ducking	= -1
goon_in_hangar2_ducking	= -1
goon_in_hangar3_ducking	= -1
goon_in_hangar4_ducking	= -1

goon_in_hangar1_waitstate = 0
goon_in_hangar2_waitstate = 0
goon_in_hangar3_waitstate = 0
goon_in_hangar4_waitstate = 0

goon_at_yard1_flag = 0
goon_at_yard1_duck = 0
goon_at_yard1_duck_timer = 0

goon_at_yard2_flag = 0
goon_at_yard2_duck = 0
goon_at_yard2_duck_timer = 0

goon_at_yard3_flag = 0
goon_at_yard3_duck = 0
goon_at_yard3_duck_timer = 0

goon_at_yard4_flag = 0
goon_at_yard4_duck = 0
goon_at_yard4_duck_timer = 0

goon_at_yard5_flag = 0

goon_at_yard6_flag = 0

goon_at_yard7_duck = 0
goon_at_yard7_duck_timer = 0

goon_at_yard8_flag = 0
goon_at_yard8_duck = 0
goon_at_yard8_duck_timer = 0

goon_at_yard9_flag = 0

goon_at_yard10_flag = 0
goon_at_yard10_duck = 0
goon_at_yard10_duck_timer = 0

goon_in_hangar1_blip_flag = 0
goon_in_hangar2_blip_flag = 0
goon_in_hangar3_blip_flag = 0
goon_in_hangar4_blip_flag = 0

ducking_flag = 0
c_site_area_flag = 0

hangar_route = 0
yard_route1 = 1
yard_route2 = 2
yard_route3 = 3
{
// ****************************************START OF CUTSCENE********************************

LOAD_SPECIAL_CHARACTER 1 love
REQUEST_MODEL tshrorckgrdn
REQUEST_MODEL tshrorckgrdn_alfas
LOAD_SPECIAL_MODEL cut_obj1 LOVEH

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED tshrorckgrdn_alfas
OR NOT HAS_MODEL_LOADED tshrorckgrdn
OR NOT HAS_MODEL_LOADED cut_obj1
	WAIT 0
ENDWHILE

LOAD_CUTSCENE D4_GTA

SET_CUTSCENE_OFFSET 85.2162 -1532.9093 243.5422

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_love
SET_CUTSCENE_ANIM cs_love love

CREATE_CUTSCENE_HEAD cs_love cut_obj1 cs_lovehead
SET_CUTSCENE_HEAD_ANIM cs_lovehead love

CLEAR_AREA 82.44 -1548.49 28.0 2.0 TRUE

SET_PLAYER_COORDINATES player 82.44 -1548.49 28.0

SET_PLAYER_HEADING player 90.0

DO_FADE 1500 FADE_IN

START_CUTSCENE

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 765
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE4_A 10000 1//"Thank you for retrieving those packages, but they were only a decoy."

WHILE cs_time < 4000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE4_B 10000 1//"Sorry about that, but that's sometimes the way in business."

WHILE cs_time < 6851
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE4_C 10000 1//"My real objective was hidden on the plane all along."

WHILE cs_time < 9951
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE4_D 10000 1//"Unfortunately the port authorities seized the plane and were stripping it down"

WHILE cs_time < 13204
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE4_H 10000 1//"until I intervened at great personal expense."

WHILE cs_time < 16457
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE4_E 10000 1//"Cross the bridge to and go to Francis International Airport."

WHILE cs_time < 19710
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE4_F 10000 1//"I've paid off the officials."

WHILE cs_time < 21394
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE4_G 10000 1//"My property will be waiting for you at the customs hanger in the aircraft's fuselage."

WHILE cs_time < 27666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

DO_FADE 0 FADE_OUT

SET_CAMERA_BEHIND_PLAYER

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn
MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn_alfas

REQUEST_MODEL CAR_PANLANT
REQUEST_MODEL PED_GANG_COLOMBIAN_A
REQUEST_MODEL PLANE_DODO
REQUEST_MODEL CAR_COLUMB

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED CAR_PANLANT
OR NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_A
OR NOT HAS_MODEL_LOADED PLANE_DODO
OR NOT HAS_MODEL_LOADED CAR_COLUMB
	WAIT 0
ENDWHILE

SWITCH_STREAMING ON
DO_FADE 1500 FADE_IN 

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

// ******************************************END OF CUTSCENE********************************

ADD_BLIP_FOR_COORD_OLD -747.23 -435.33 8.35 RED BLIP_ONLY love_4_blip
CHANGE_BLIP_SCALE love_4_blip 3

WHILE NOT IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	WAIT 0

//	IF IS_BUTTON_PRESSED PAD1 TRIANGLE
//	AND IS_BUTTON_PRESSED PAD1 SQUARE
//	AND IS_BUTTON_PRESSED PAD1 CIRCLE
//		WAIT 500
//		SET_PLAYER_COORDINATES player 338.2069 -274.6978 15.8
//		GOTO second_cutscene
//	ENDIF

ENDWHILE

IF IS_NASTY_GAME
	CREATE_OBJECT_NO_OFFSET deadman1 -1276.834 -528.049 10.568 deadman1//-1276.983 -527.532 9.951 deadman1
ELSE
	CREATE_OBJECT_NO_OFFSET deadmanoblood -1276.834 -528.049 10.568 deadman1//-1276.983 -527.532 9.951 deadman1
ENDIF

WHILE NOT LOCATE_PLAYER_ANY_MEANS_2D player -747.23 -435.33 20.0 20.0 0
	WAIT 0
ENDWHILE

REMOVE_BLIP love_4_blip
ADD_BLIP_FOR_COORD_OLD -1268.4851 -528.6431 9.8341 RED BLIP_ONLY love_4_blip
DISPLAY_RADAR 2 // PATHING OFF

WHILE NOT LOCATE_PLAYER_ANY_MEANS_2D player -1268.4851 -528.6431 200.0 200.0 0
	WAIT 0
ENDWHILE

WHILE NOT IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	WAIT 0
ENDWHILE

CREATE_CAR CAR_PANLANT -1282.3678 -549.2936 10.0782 car_van1_lm4
SET_CAR_HEADING car_van1_lm4 110.3045

CREATE_CAR CAR_PANLANT -1281.3341 -561.8243 10.0766 car_van3_lm4
SET_CAR_HEADING car_van3_lm4 153.1196

CREATE_CAR PLANE_DODO -1268.2 -519.0 10.0 wingless_cessna
SET_CAR_HEADING wingless_cessna 180.0

DISPLAY_RADAR 3 // PATHING ON
REMOVE_BLIP	love_4_blip
ADD_BLIP_FOR_CAR wingless_cessna love_4_blip

CREATE_CHAR_INSIDE_CAR car_van1_lm4 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A van1_driver	

CAR_SET_IDLE car_van1_lm4
CAR_SET_IDLE car_van3_lm4

CAR_SET_IDLE wingless_cessna

SET_CAR_CRUISE_SPEED car_van1_lm4 25.0

SET_CAR_DRIVING_STYLE car_van1_lm4 2

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1271.8468 -511.2291 10.0 goon_in_hangar1	
CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1265.1578 -520.6526 10.0 goon_in_hangar2	
CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1263.0977 -520.3745 10.0 goon_in_hangar3	
CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1271.0814 -522.0176 10.0 goon_in_hangar4

SET_CHAR_HEADING goon_in_hangar4 170.5763
TURN_CHAR_TO_FACE_CHAR goon_in_hangar2 goon_in_hangar3
TURN_CHAR_TO_FACE_CHAR goon_in_hangar3 goon_in_hangar2

ADD_ROUTE_POINT hangar_route -1271.8468 -511.2291 9.7954
ADD_ROUTE_POINT hangar_route -1263.3838 -510.6700 9.7954
SET_CHAR_OBJ_FOLLOW_ROUTE goon_in_hangar1 hangar_route FOLLOW_ROUTE_BACKFORWARD

GIVE_WEAPON_TO_CHAR goon_in_hangar1 WEAPONTYPE_CHAINGUN 9999
GIVE_WEAPON_TO_CHAR goon_in_hangar2 WEAPONTYPE_UZI 9999
GIVE_WEAPON_TO_CHAR goon_in_hangar4 WEAPONTYPE_M16 9999

SET_CHAR_THREAT_SEARCH goon_in_hangar1 THREAT_FAST_CAR
SET_CHAR_THREAT_SEARCH goon_in_hangar2 THREAT_FAST_CAR
SET_CHAR_THREAT_SEARCH goon_in_hangar3 THREAT_FAST_CAR
SET_CHAR_THREAT_SEARCH goon_in_hangar4 THREAT_FAST_CAR

IF flag_player_on_mission = 0
	ADD_BLIP_FOR_CHAR goon_in_hangar1 goon_in_hangar1_blip
	ADD_BLIP_FOR_CHAR goon_in_hangar2 goon_in_hangar2_blip
	ADD_BLIP_FOR_CHAR goon_in_hangar3 goon_in_hangar3_blip
	ADD_BLIP_FOR_CHAR goon_in_hangar4 goon_in_hangar4_blip
ENDIF

WHILE NOT LOCATE_PLAYER_ANY_MEANS_2D player -1281.3341 -561.8243 90.0 90.0 0// CESSNA
	
	WAIT 0

	IF IS_CAR_DEAD wingless_cessna
		PRINT_NOW LOVE4_9 5000 1
		GOTO mission_love4_failed
	ENDIF

	IF IS_CAR_DEAD car_van3_lm4
		PRINT_NOW LOV4_10 5000 1
		GOTO mission_love4_failed
	ENDIF

ENDWHILE

IF NOT IS_CAR_DEAD car_van1_lm4
	CAR_GOTO_COORDINATES car_van1_lm4 439.0 -198.0 21.0
ENDIF

IF NOT IS_CHAR_DEAD	goon_in_hangar2
OR NOT IS_CHAR_DEAD	goon_in_hangar3
	SET_CHARS_CHATTING goon_in_hangar2 goon_in_hangar3 1000000
ENDIF

IF NOT IS_CHAR_DEAD	goon_in_hangar4
	SET_CHAR_WAIT_STATE goon_in_hangar4	WAITSTATE_CROSS_ROAD_LOOK 1000000
ENDIF

WHILE NOT IS_CHAR_DEAD goon_in_hangar1
OR NOT IS_CHAR_DEAD	goon_in_hangar2
OR NOT IS_CHAR_DEAD	goon_in_hangar3
OR NOT IS_CHAR_DEAD	goon_in_hangar4

	WAIT 0

	IF IS_CAR_DEAD wingless_cessna
		PRINT_NOW LOVE4_9 5000 1
		GOTO mission_love4_failed
	ENDIF

	IF IS_CAR_DEAD car_van3_lm4
		PRINT_NOW LOV4_10 5000 1
		GOTO mission_love4_failed
	ENDIF

	IF IS_CHAR_DEAD	goon_in_hangar1
		goon_in_hangar1_flag = -100
		goon_in_hangar1_ducking = -100
		REMOVE_BLIP goon_in_hangar1_blip
		GOSUB set_death_flags
	ENDIF

	IF IS_CHAR_DEAD	goon_in_hangar2
		goon_in_hangar2_flag = -100
		goon_in_hangar2_ducking = -100
		REMOVE_BLIP goon_in_hangar2_blip
		GOSUB set_death_flags
	ENDIF

	IF IS_CHAR_DEAD	goon_in_hangar3
		goon_in_hangar3_flag = -100
		goon_in_hangar3_ducking = -100
		REMOVE_BLIP goon_in_hangar3_blip
		GOSUB set_death_flags
	ENDIF

	IF IS_CHAR_DEAD	goon_in_hangar4
		goon_in_hangar4_flag = -100
		goon_in_hangar4_ducking = -100
		REMOVE_BLIP goon_in_hangar4_blip
		GOSUB set_death_flags
	ENDIF

	IF IS_PLAYER_IN_AREA_2D	player -1285.05 -586.535 -1254.959 -542.262 0 //OUT THE FRONT OF THE HANGAR (AREA1)
	AND IS_CAR_ON_SCREEN wingless_cessna
		GOSUB set_death_flags
	ENDIF

	IF IS_PLAYER_IN_AREA_2D player -1290.216 -542.262 -1244.057 -531.793 0 //INSIDE HANGAR (AREA2)
		IF NOT IS_CHAR_DEAD	goon_in_hangar2
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS goon_in_hangar2 player
		ENDIF
		goon_in_hangar2_flag = -100
		goon_in_hangar2_ducking = -100
		GOSUB set_death_flags
	ENDIF

	IF IS_PLAYER_IN_AREA_2D player -1290.216 -531.793 -1244.057 -522.926 0 //INSIDE HANGAR (AREA3)
		IF NOT IS_CHAR_DEAD	goon_in_hangar4
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS goon_in_hangar4 player
		ENDIF
		goon_in_hangar4_flag = -100
		goon_in_hangar4_ducking = -100
		GOSUB set_death_flags
	ENDIF

	IF IS_PLAYER_IN_AREA_2D player -1290.216 -522.926 -1244.057 -496.88 0 //INSIDE HANGAR (AREA4)
		IF NOT IS_CHAR_DEAD	goon_in_hangar1
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS goon_in_hangar1 player
		ENDIF
		goon_in_hangar1_flag = -100
		goon_in_hangar1_ducking = -100
		IF NOT IS_CHAR_DEAD	goon_in_hangar3
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS goon_in_hangar3 player
		ENDIF
		goon_in_hangar3_flag = -100
		goon_in_hangar3_ducking = -100
		GOSUB set_death_flags
	ENDIF

	GOSUB ducking_routine

	IF goon_in_hangar1_ducking > -1
		IF goon_in_hangar1_flag	= 0
			CHAR_SET_IDLE goon_in_hangar1
			SET_CHAR_WAIT_STATE goon_in_hangar1 WAITSTATE_FALSE	100
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar1 -1280.2 -520.1
			goon_in_hangar1_flag = 1
		ENDIF
		IF goon_in_hangar1_flag	= 1
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar1 -1280.2 -520.1 1.0 1.0 0
				goon_in_hangar1_flag = 2
				goon_in_hangar1_ducking = 1
			ENDIF
		ENDIF
	ENDIF

	IF goon_in_hangar2_ducking > -1
		IF goon_in_hangar2_flag	= 0
			CHAR_SET_IDLE goon_in_hangar2
			SET_CHAR_WAIT_STATE goon_in_hangar2 WAITSTATE_FALSE	100
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar2 -1256.4 -521.3//-1256.4 -520.5
			goon_in_hangar2_flag = 1
		ENDIF
		IF goon_in_hangar2_flag	= 1
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar2 -1256.4 -521.3 1.0 1.0 0
				goon_in_hangar2_flag = 2
				goon_in_hangar2_ducking = 1
			ENDIF
		ENDIF
	ENDIF

	IF goon_in_hangar3_ducking > -1
		IF goon_in_hangar3_flag	= 0
			CHAR_SET_IDLE goon_in_hangar3
			SET_CHAR_WAIT_STATE goon_in_hangar3 WAITSTATE_FALSE	100
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar3 -1254.4 -521.3
			GIVE_WEAPON_TO_CHAR goon_in_hangar3 WEAPONTYPE_CHAINGUN 9999
			goon_in_hangar3_flag = 1
		ENDIF
		IF goon_in_hangar3_flag	= 1
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar3 -1254.4 -521.3 1.0 1.0 0
				goon_in_hangar3_flag = 2
				goon_in_hangar3_ducking = 1
			ENDIF
		ENDIF
	ENDIF

	IF goon_in_hangar4_ducking > -1
		IF goon_in_hangar4_flag	= 0
			CHAR_SET_IDLE goon_in_hangar4
			SET_CHAR_WAIT_STATE goon_in_hangar4 WAITSTATE_FALSE	100
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar4 -1280.8 -529.2
			goon_in_hangar4_flag = 1
		ENDIF
		IF goon_in_hangar4_flag	= 1
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar4 -1280.8 -529.2 1.0 1.0 0
				goon_in_hangar4_flag = 2
				goon_in_hangar4_ducking = 1
			ENDIF
		ENDIF
	ENDIF

ENDWHILE

REMOVE_BLIP goon_in_hangar1_blip
REMOVE_BLIP goon_in_hangar2_blip
REMOVE_BLIP goon_in_hangar3_blip
REMOVE_BLIP goon_in_hangar4_blip
MARK_CHAR_AS_NO_LONGER_NEEDED goon_in_hangar1
MARK_CHAR_AS_NO_LONGER_NEEDED goon_in_hangar2
MARK_CHAR_AS_NO_LONGER_NEEDED goon_in_hangar3
MARK_CHAR_AS_NO_LONGER_NEEDED goon_in_hangar4

GET_PLAYER_CHAR player script_controlled_player

PRINT_NOW LOVE4_5 5000 1 //CHECK OUT THE CESSNA

IF IS_CAR_DEAD wingless_cessna
	PRINT_NOW LOVE4_9 5000 1
	GOTO mission_love4_failed
ENDIF

WHILE NOT IS_PLAYER_IN_CAR player wingless_cessna
	
	WAIT 0

	IF IS_CAR_DEAD wingless_cessna
		PRINT_NOW LOVE4_9 5000 1
		GOTO mission_love4_failed
	ENDIF

	IF IS_CAR_DEAD car_van3_lm4
		PRINT_NOW LOV4_10 5000 1
		GOTO mission_love4_failed
	ENDIF

ENDWHILE

WAIT 1000

PRINT_NOW LOVE4_2 3000 1 // "The package is not here"

REMOVE_BLIP love_4_blip

IF IS_CAR_DEAD car_van3_lm4
	PRINT_NOW LOV4_10 5000 1
	GOTO mission_love4_failed
ENDIF

ADD_BLIP_FOR_CAR car_van3_lm4 love_4_blip

WHILE NOT LOCATE_PLAYER_ON_FOOT_CAR_2D player car_van3_lm4 6.0 6.0 0
	
	WAIT 0

	IF IS_CAR_DEAD car_van3_lm4
		PRINT_NOW LOV4_10 5000 1
		GOTO mission_love4_failed
	ENDIF

ENDWHILE

GET_CAR_COORDINATES	car_van3_lm4 van3_x van3_y van3_z

GET_CAR_FORWARD_X car_van3_lm4 x_component
GET_CAR_FORWARD_Y car_van3_lm4 y_component

temp_result_x =	2.8 * y_component  //change both of these to move on the vehicles x axis
temp_result_y =	-2.8 * x_component //

temp_var_x = 0.3 * x_component //change both of these to move on the vehicles y axis
temp_var_y = 0.3 * y_component //

result1_x = temp_result_x - temp_var_x
result1_y = temp_result_y - temp_var_y

result1_x = result1_x + van3_x 
result1_y = result1_y + van3_y

/////////////////

temp_result_x =	-2.8 * y_component //change both of these to move on the vehicles x axis
temp_result_y =	2.8 * x_component  //

temp_var_x = 0.3 * x_component //change both of these to move on the vehicles y axis
temp_var_y = 0.3 * y_component //

result2_x = temp_result_x - temp_var_x
result2_y = temp_result_y - temp_var_y

result2_x = result2_x + van3_x 
result2_y = result2_y + van3_y

van3_z += 0.15

////////////////////////////////////////////////////////////////////////////////

SET_PLAYER_CONTROL player OFF
SWITCH_WIDESCREEN ON

SET_CHAR_OBJ_WAIT_ON_FOOT	script_controlled_player
CHAR_SET_IDLE script_controlled_player

REMOVE_BLIP love_4_blip

GET_PLAYER_COORDINATES player player_lo4_x player_lo4_y	player_lo4_z

differ_x = player_lo4_x - result1_x
differ_y = player_lo4_y - result1_y
differ_x = differ_x * differ_x
differ_y = differ_y * differ_y
sum_difference = differ_x + differ_y
SQRT sum_difference distance_result1

differ_x = player_lo4_x - result2_x
differ_y = player_lo4_y - result2_y
differ_x = differ_x * differ_x
differ_y = differ_y * differ_y
sum_difference = differ_x + differ_y
SQRT sum_difference distance_result2

IF distance_result1	< distance_result2
	flag_result_1 = 1
ELSE
	flag_result_1 = 0
ENDIF

IF flag_result_1 = 1
	SET_FIXED_CAMERA_POSITION result1_x result1_y van3_z 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT result2_x result2_y van3_z INTERPOLATION 
ELSE
	SET_FIXED_CAMERA_POSITION result2_x result2_y van3_z 0.0 0.0 0.0
	POINT_CAMERA_AT_POINT result1_x result1_y van3_z INTERPOLATION 
ENDIF

WAIT 1000

PRINT_NOW LOVE4_3 3000 1 //Construction....yard!

WAIT 2000

RESTORE_CAMERA

SWITCH_WIDESCREEN OFF
SET_PLAYER_CONTROL player ON

PRINT LOVE4_7 5000 1 //GET THERE

ADD_BLIP_FOR_COORD 366.939 -328.025 20.268 love_4_blip // CONSTRUCTION SITE

MARK_CHAR_AS_NO_LONGER_NEEDED goon_in_hangar1
MARK_CHAR_AS_NO_LONGER_NEEDED goon_in_hangar2
MARK_CHAR_AS_NO_LONGER_NEEDED goon_in_hangar3
MARK_CHAR_AS_NO_LONGER_NEEDED goon_in_hangar4
MARK_CHAR_AS_NO_LONGER_NEEDED van1_driver	

MARK_CAR_AS_NO_LONGER_NEEDED car_van1_lm4 
MARK_CAR_AS_NO_LONGER_NEEDED car_van3_lm4

////////////////////////////////////////////////////////////////////////////////

WHILE NOT IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
	WAIT 0
ENDWHILE

second_cutscene:

CREATE_CAR CAR_PANLANT 352.8936 -308.3074 15.8 car_van1_lm4
CREATE_CAR CAR_PANLANT 359.3962 -307.2422 15.8 car_van2_lm4
SET_CAR_HEADING	car_van1_lm4 180.6
SET_CAR_HEADING	car_van2_lm4 222.9

CREATE_CAR CAR_COLUMB 346.8934 -298.4600 15.8 colombian_car
SET_CAR_HEADING colombian_car 111.7

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 343.9994 -306.3081 15.8 goon_at_yard1 // area 1 chatting
CLEAR_CHAR_THREAT_SEARCH goon_at_yard1
SET_CHAR_THREAT_SEARCH goon_at_yard1 THREAT_PLAYER1
SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard1 TRUE
SET_CHAR_USE_PEDNODE_SEEK goon_at_yard1 FALSE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 341.5678 -306.8592 15.8 goon_at_yard2 // area 1 chatting
CLEAR_CHAR_THREAT_SEARCH goon_at_yard2
SET_CHAR_THREAT_SEARCH goon_at_yard2 THREAT_PLAYER1
TURN_CHAR_TO_FACE_CHAR goon_at_yard2 goon_at_yard1
TURN_CHAR_TO_FACE_CHAR goon_at_yard1 goon_at_yard2
SET_CHARS_CHATTING goon_at_yard2 goon_at_yard1 10000000
SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard2 TRUE
SET_CHAR_USE_PEDNODE_SEEK goon_at_yard2 FALSE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 327.7796 -316.6461 15.9 goon_at_yard3 // by concrete area
GIVE_WEAPON_TO_CHAR goon_at_yard3 WEAPONTYPE_CHAINGUN 9999
CLEAR_CHAR_THREAT_SEARCH goon_at_yard3
SET_CHAR_THREAT_SEARCH goon_at_yard3 THREAT_PLAYER1
SET_CHAR_HEADING goon_at_yard3 315.0
SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard3 TRUE
SET_CHAR_USE_PEDNODE_SEEK goon_at_yard3 FALSE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 335.0769 -338.2184 15.8 goon_at_yard4 // by pile of wood SW
GIVE_WEAPON_TO_CHAR goon_at_yard4 WEAPONTYPE_CHAINGUN 9999
CLEAR_CHAR_THREAT_SEARCH goon_at_yard4
SET_CHAR_THREAT_SEARCH goon_at_yard4 THREAT_PLAYER1
SET_CHAR_HEADING goon_at_yard4 25.0
SET_CHAR_WAIT_STATE goon_at_yard4 WAITSTATE_CROSS_ROAD_LOOK 10000000 
SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard4 TRUE
SET_CHAR_USE_PEDNODE_SEEK goon_at_yard4 FALSE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 348.7184 -320.0932 15.8 goon_at_yard5 // by wooden steps
GIVE_WEAPON_TO_CHAR goon_at_yard5 WEAPONTYPE_CHAINGUN 9999
CLEAR_CHAR_THREAT_SEARCH goon_at_yard5
SET_CHAR_THREAT_SEARCH goon_at_yard5 THREAT_PLAYER1
SET_CHAR_HEADING goon_at_yard5 250.0
SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard5 TRUE
SET_CHAR_USE_PEDNODE_SEEK goon_at_yard5 FALSE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 357.1986 -319.7162 15.9 goon_at_yard6 // by concrete steps
GIVE_WEAPON_TO_CHAR goon_at_yard6 WEAPONTYPE_CHAINGUN 9999
CLEAR_CHAR_THREAT_SEARCH goon_at_yard6
SET_CHAR_THREAT_SEARCH goon_at_yard6 THREAT_PLAYER1
SET_CHAR_HEADING goon_at_yard6 250.0
SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard6 TRUE
SET_CHAR_USE_PEDNODE_SEEK goon_at_yard6 FALSE
		   
CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 358.6874 -340.7191 16.0 goon_at_yard7 // behind last box
GIVE_WEAPON_TO_CHAR goon_at_yard7 WEAPONTYPE_CHAINGUN 9999
CLEAR_CHAR_THREAT_SEARCH goon_at_yard7
SET_CHAR_THREAT_SEARCH goon_at_yard7 THREAT_PLAYER1
SET_CHAR_HEADING goon_at_yard7 90.0
SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard7 TRUE
SET_CHAR_USE_PEDNODE_SEEK goon_at_yard7 FALSE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 360.1730 -336.0494 16.0 goon_at_yard8 // by last box
GIVE_WEAPON_TO_CHAR goon_at_yard8 WEAPONTYPE_CHAINGUN 9999
ADD_ROUTE_POINT yard_route3 360.1730 -336.0494 16.0
ADD_ROUTE_POINT yard_route3 372.2496 -335.3521 17.0 
SET_CHAR_OBJ_FOLLOW_ROUTE goon_at_yard8 yard_route3 FOLLOW_ROUTE_BACKFORWARD
CLEAR_CHAR_THREAT_SEARCH goon_at_yard8
SET_CHAR_THREAT_SEARCH goon_at_yard8 THREAT_PLAYER1
SET_CHAR_USE_PEDNODE_SEEK goon_at_yard8 FALSE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 374.7956 -340.4126 16.0 goon_at_yard9 // behind lift
GIVE_WEAPON_TO_CHAR goon_at_yard9 WEAPONTYPE_SHOTGUN 9999
ADD_ROUTE_POINT yard_route2 374.7956 -340.4126 16.0
ADD_ROUTE_POINT yard_route2 375.2283 -316.6560 18.3 
SET_CHAR_OBJ_FOLLOW_ROUTE goon_at_yard9 yard_route2 FOLLOW_ROUTE_BACKFORWARD
CLEAR_CHAR_THREAT_SEARCH goon_at_yard9
SET_CHAR_THREAT_SEARCH goon_at_yard9 THREAT_PLAYER1
SET_CHAR_USE_PEDNODE_SEEK goon_at_yard9 FALSE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 391.0353 -298.6616 17.2 goon_at_yard10 // on building near maze
GIVE_WEAPON_TO_CHAR goon_at_yard10 WEAPONTYPE_CHAINGUN 9999
ADD_ROUTE_POINT yard_route1 391.0353 -298.6616 17.2
ADD_ROUTE_POINT yard_route1 372.7149 -298.7406 17.2 
SET_CHAR_OBJ_FOLLOW_ROUTE goon_at_yard10 yard_route1 FOLLOW_ROUTE_BACKFORWARD
CLEAR_CHAR_THREAT_SEARCH goon_at_yard10
SET_CHAR_THREAT_SEARCH goon_at_yard10 THREAT_PLAYER1
SET_CHAR_HEED_THREATS goon_at_yard10 TRUE
SET_CHAR_USE_PEDNODE_SEEK goon_at_yard10 FALSE

WHILE NOT LOCATE_PLAYER_ON_FOOT_3D player 366.939 -328.025 20.268 1.0 1.0 2.0 1//LIFT

	WAIT 0

	IF c_site_area_flag	= 0
		IF IS_CHAR_DEAD	goon_at_yard1
			c_site_area_flag = 1
		ENDIF

		IF IS_CHAR_DEAD	goon_at_yard2
			c_site_area_flag = 1
		ENDIF

		IF IS_CHAR_DEAD	goon_at_yard3
			c_site_area_flag = 2
		ENDIF

		IF IS_CHAR_DEAD	goon_at_yard4
			c_site_area_flag = 3
		ENDIF

		IF IS_CHAR_DEAD	goon_at_yard5
			c_site_area_flag = 5
		ENDIF

		IF IS_CHAR_DEAD	goon_at_yard6
			c_site_area_flag = 6
		ENDIF

		IF IS_CHAR_DEAD	goon_at_yard7
			c_site_area_flag = 4
		ENDIF

		IF IS_CHAR_DEAD	goon_at_yard8
			c_site_area_flag = 4
		ENDIF

		IF IS_CHAR_DEAD	goon_at_yard9
			c_site_area_flag = 5
		ENDIF
	ENDIF

	IF c_site_area_flag	= 0
		IF IS_PLAYER_IN_AREA_2D player 331.8 -303.2 354.5 -280.2 0 // AREA 1
			c_site_area_flag = 1
		ENDIF
	ENDIF

	IF c_site_area_flag	= 1
		IF IS_PLAYER_IN_AREA_2D player 334.4 -314.6 348.2 -303.2 0 // AREA 2
			c_site_area_flag = 2
		ENDIF
	ENDIF

	IF c_site_area_flag	= 2
		IF IS_PLAYER_IN_AREA_2D player 326.4 -327.9 334.4 -303.2 0 // AREA 3
			c_site_area_flag = 3
		ENDIF
	ENDIF

	IF c_site_area_flag	= 3
		IF IS_PLAYER_IN_AREA_2D player 326.4 -341.8 334.4 -327.9 0 // AREA 4
			c_site_area_flag = 4
		ENDIF
	ENDIF

	IF c_site_area_flag	= 4
		IF IS_PLAYER_IN_AREA_2D player 334.4 -341.8 355.9 -314.6 0 // AREA 5
			c_site_area_flag = 5
		ENDIF
	ENDIF

	IF c_site_area_flag	= 5
		IF IS_PLAYER_IN_AREA_2D player 355.9 -341.8 380.3 -314.6 0 // AREA 6
			c_site_area_flag = 6
		ENDIF
	ENDIF

	GET_GAME_TIMER game_timer_var

	GOSUB goon_at_yard1_routine
	GOSUB goon_at_yard2_routine
	GOSUB goon_at_yard3_routine
	GOSUB goon_at_yard4_routine
	GOSUB goon_at_yard5_routine
	GOSUB goon_at_yard6_routine
	GOSUB goon_at_yard7_routine
	GOSUB goon_at_yard8_routine
	GOSUB goon_at_yard9_routine
	GOSUB goon_at_yard10_routine

	IF IS_CHAR_DEAD goon_at_yard1
	AND IS_CHAR_DEAD goon_at_yard2
	AND IS_CHAR_DEAD goon_at_yard3
	AND IS_CHAR_DEAD goon_at_yard4
	AND IS_CHAR_DEAD goon_at_yard5
		IF IS_CHAR_DEAD goon_at_yard6
		AND IS_CHAR_DEAD goon_at_yard7
		AND IS_CHAR_DEAD goon_at_yard8
		AND IS_CHAR_DEAD goon_at_yard9
			
			IF reset_timera_flag = 0
				TIMERA = 0
				reset_timera_flag = 1
			ENDIF
			
			IF TIMERA > 10000
			AND reset_timera_flag = 1
				PRINT_NOW LOVE4_6 10000 1 //GET INTO THE LIFT
				reset_timera_flag = 2
			ENDIF

		ENDIF
	ENDIF

ENDWHILE

REMOVE_BLIP love_4_blip

// ****************************************START OF CUTSCENE********************************

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

GET_GAME_TIMER break_timer_start
break_timer = 0

WHILE NOT CAN_PLAYER_START_MISSION player
AND break_timer < 5000	//	If player is not in control after 5 secs do the cutscene anyway
	WAIT 0
	GET_GAME_TIMER break_timer
	break_timer = break_timer - break_timer_start
ENDWHILE

MAKE_PLAYER_SAFE_FOR_CUTSCENE player

LOAD_SPECIAL_CHARACTER 1 cat
LOAD_SPECIAL_CHARACTER 2 miguel
LOAD_SPECIAL_CHARACTER 3 asuka
LOAD_SPECIAL_MODEL cut_obj1 d4props//lift
LOAD_SPECIAL_MODEL cut_obj2 cath
LOAD_SPECIAL_MODEL cut_obj3	asukah
LOAD_SPECIAL_MODEL cut_obj4	miguelh
LOAD_SPECIAL_MODEL cut_obj5	lift
REQUEST_MODEL csitecutscene

SWITCH_STREAMING OFF

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_SPECIAL_CHARACTER_LOADED 3
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED cut_obj4
OR NOT HAS_MODEL_LOADED cut_obj5
OR NOT HAS_MODEL_LOADED csitecutscene
	WAIT 0
ENDWHILE

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 374.7956 -340.4126 16.0 16.0 scaffoldlift FALSE

LOAD_CUTSCENE D4_GTA2

SET_CUTSCENE_OFFSET 369.02 -327.5 18.46

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_catalina
SET_CUTSCENE_ANIM cs_catalina cat

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_miguel
SET_CUTSCENE_ANIM cs_miguel miguel

CREATE_CUTSCENE_OBJECT PED_SPECIAL3 cs_asuka
SET_CUTSCENE_ANIM cs_asuka asuka

CREATE_CUTSCENE_OBJECT cut_obj1 cs_whip
SET_CUTSCENE_ANIM cs_whip d4props

CREATE_CUTSCENE_OBJECT cut_obj5 cs_lift
SET_CUTSCENE_ANIM cs_lift lift

CREATE_CUTSCENE_HEAD cs_catalina cut_obj2 cs_cathead
SET_CUTSCENE_HEAD_ANIM cs_cathead cat

CREATE_CUTSCENE_HEAD cs_asuka cut_obj3 cs_asukahead
SET_CUTSCENE_HEAD_ANIM cs_asukahead asuka

CREATE_CUTSCENE_HEAD cs_miguel cut_obj4 cs_mariahead
SET_CUTSCENE_HEAD_ANIM cs_mariahead miguel

//CREATE_CUTSCENE_OBJECT cut_obj2 cs_loot
//SET_CUTSCENE_ANIM cs_loot cs_loot
//
//CREATE_CUTSCENE_OBJECT cut_obj3 cs_colt1
//SET_CUTSCENE_ANIM cs_colt1 colt1
//
//CREATE_CUTSCENE_OBJECT cut_obj4 cs_colt2
//SET_CUTSCENE_ANIM cs_colt2 colt2
//
//CREATE_CUTSCENE_OBJECT cut_obj5 cs_whip
//SET_CUTSCENE_ANIM cs_whip whip

SET_PLAYER_COORDINATES player 373.7523 -327.2676 17.1950

SET_PLAYER_HEADING player 270.0

DO_FADE 1500 FADE_IN

START_CUTSCENE

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 15386
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_A 15000 1//Hey, let's get this out of here. God knows what it is

WHILE cs_time < 18600
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_B 15000 1//but he seems to want it badly enough so it must be worth something.

WHILE cs_time < 21318
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_C 15000 1//Who the Heck!

WHILE cs_time < 21933
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

particle_x = 369.02 - 0.0051 
particle_y = -327.5 - 1.2746 
particle_z = 18.46 + 48.3784	

particle_target_x =	369.02 - 0.0489
particle_target_y =	-327.5 - 1.4178
particle_target_z =	18.46 + 48.6197

temp_var = particle_target_x
particle_target_x =	particle_x - temp_var

temp_var = particle_target_y
particle_target_y =	particle_y - temp_var

temp_var = particle_target_z
particle_target_z =	particle_z - temp_var

ADD_MOVING_PARTICLE_EFFECT POBJECT_CATALINAS_GUNFLASH particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 1.0 0 0 0 0

WHILE cs_time < 22167
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

particle_x = 369.02 + 0.2698 
particle_y = -327.5 - 1.3691 
particle_z = 18.46 + 48.2923

particle_target_x =	369.02 + 0.1917 
particle_target_y =	-327.5 - 1.5893
particle_target_z =	18.46 + 48.4539

temp_var = particle_target_x
particle_target_x =	particle_x - temp_var

temp_var = particle_target_y
particle_target_y =	particle_y - temp_var

temp_var = particle_target_z
particle_target_z =	particle_z - temp_var

ADD_MOVING_PARTICLE_EFFECT POBJECT_CATALINAS_GUNFLASH particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 1.0 0 0 0 0

WHILE cs_time < 22428
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_D 15000 1//YOU!

WHILE cs_time < 23270
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_E 15000 1//Hey take it easy amigo! De nada! De nada!

WHILE cs_time < 26829
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_F 15000 1//I left you pouring your heart out into the gutter!

WHILE cs_time < 29508
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_G 15000 1//Don't shoot amigo. No problem. We all friends. Here, take this.

WHILE cs_time < 33871
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_H 15000 1//Don't be such a pussy!

WHILE cs_time < 35408
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_I 15000 1//We got no choice baby!

WHILE cs_time < 36700
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

particle_x = 369.02 + 2.467 
particle_y = -327.5 - 3.9022 
particle_z = 18.46 + 47.1884

particle_target_x =	369.02 + 2.577 
particle_target_y =	-327.5 - 3.6573
particle_target_z =	18.46 + 47.0965

temp_var = particle_target_x
particle_target_x =	particle_x - temp_var

temp_var = particle_target_y
particle_target_y =	particle_y - temp_var

temp_var = particle_target_z
particle_target_z =	particle_z - temp_var

ADD_MOVING_PARTICLE_EFFECT POBJECT_CATALINAS_GUNFLASH particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 1.0 0 0 0 0

IF IS_NASTY_GAME
	particle_x = 369.02 + 2.4406 
	particle_y = -327.5 - 3.8711 
	particle_z = 18.46 + 47.2215

	particle_target_x =	369.02 + 2.3762 
	particle_target_y =	-327.5 - 4.065
	particle_target_z =	18.46 + 47.3184

	temp_var = particle_target_x
	particle_target_x =	particle_x - temp_var

	temp_var = particle_target_y
	particle_target_y =	particle_y - temp_var

	temp_var = particle_target_z
	particle_target_z =	particle_z - temp_var

	particle_target_x -= particle_x
	particle_target_y -= particle_y
	particle_target_z -= particle_z

	particle_target_x *= 0.05
	particle_target_y *= 0.05
	particle_target_z *= 0.05

	CREATE_SINGLE_PARTICLE PARTICLE_BLOOD_SMALL particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 0.0
	CREATE_SINGLE_PARTICLE PARTICLE_BLOOD_SMALL particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 0.0
	CREATE_SINGLE_PARTICLE PARTICLE_BLOOD_SMALL particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 0.0
	CREATE_SINGLE_PARTICLE PARTICLE_BLOOD_SMALL particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 0.0
	CREATE_SINGLE_PARTICLE PARTICLE_BLOOD_SMALL particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 0.0
	CREATE_SINGLE_PARTICLE PARTICLE_BLOOD_SMALL particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 0.0
	CREATE_SINGLE_PARTICLE PARTICLE_BLOOD_SMALL particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 0.0
	CREATE_SINGLE_PARTICLE PARTICLE_BLOOD_SMALL particle_x particle_y particle_z particle_target_x particle_target_y particle_target_z 0.0

	CREATE_SINGLE_PARTICLE PARTICLE_TEST particle_x particle_y particle_z 0.0 0.0 0.0 0.2
ENDIF

WHILE cs_time < 37627
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_J 15000 1//We always got a choice you dumb bastard!

WHILE cs_time < 41684
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_K 15000 1//I'm sorry about that crazy bitch man, they all the same…..por favor??

WHILE cs_time < 46468
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_L 15000 1//So the whore got away.

WHILE cs_time < 48918
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_M 15000 1//But you've done me a favour,

WHILE cs_time < 50755
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_N 15000 1//you're not the only one that has a score to settle with the Cartel -

WHILE cs_time < 54352
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_O 15000 1//this worm killed my brother!

WHILE cs_time < 56266
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_P 15000 1//I never killed no Yakuza!

WHILE cs_time < 57299
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_Q 15000 1//LIAR! We all saw the Cartel assassin.

WHILE cs_time < 60721
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_R 15000 1//We are going to hunt down and kill all you Colombian dogs!

WHILE cs_time < 64778
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_S 15000 1//I'll be operating on our friend here to extract information and a little pleasure.

WHILE cs_time < 70710
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_T 15000 1//You, drop by later, I'm sure I'll require your services.

WHILE cs_time < 75150
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW GTAB_U 15000 1//Please amigo, don't leave me with her, she psycho chica! Amigo? Hey AMEEEGO!!! …….Aiiieeeeaaargghh!

WHILE cs_time < 86666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE
DO_FADE 0 FADE_OUT

UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
UNLOAD_SPECIAL_CHARACTER 3
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj2
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj3
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj4
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj5
MARK_MODEL_AS_NO_LONGER_NEEDED csitecutscene

REQUEST_MODEL CAR_YAKUZA
REQUEST_MODEL PED_GANG_YAKUZA_A

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED CAR_YAKUZA
OR NOT HAS_MODEL_LOADED	PED_GANG_YAKUZA_A
	WAIT 0
ENDWHILE

SET_VISIBILITY_OF_CLOSEST_OBJECT_OF_TYPE 374.7956 -340.4126 16.0 16.0 scaffoldlift TRUE

SET_CAMERA_BEHIND_PLAYER

IF DOES_OBJECT_EXIST inside_fence
	DELETE_OBJECT inside_fence
ENDIF

IF DOES_OBJECT_EXIST outside_fence
	DELETE_OBJECT outside_fence
ENDIF

CREATE_OBJECT_NO_OFFSET broken_inside 362.827 -341.362 17.375 inside_fence 
DONT_REMOVE_OBJECT inside_fence
CREATE_OBJECT_NO_OFFSET broken_outside 360.852 -390.891 22.622 outside_fence 
DONT_REMOVE_OBJECT outside_fence

CREATE_CAR CAR_YAKUZA 339.8449 -290.6314 16.0 yakuza_car1 // out front
CREATE_CAR CAR_YAKUZA 359.1079 -291.0880 16.0 yakuza_car2 // out front
CREATE_CAR CAR_YAKUZA 363.6012 -339.1167 16.0 yakuza_car3 // smash fence car
SET_CAR_HEADING yakuza_car1	158.2191
SET_CAR_HEADING yakuza_car2 146.8412	
SET_CAR_HEADING yakuza_car3	339.3615

CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A 367.3908 -334.2422 16.1 yakuza_guard1
GIVE_WEAPON_TO_CHAR yakuza_guard1 WEAPONTYPE_UZI 300
SET_CHAR_HEED_THREATS yakuza_guard1 TRUE

CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A 367.6573 -337.8994 16.1 yakuza_guard2
GIVE_WEAPON_TO_CHAR yakuza_guard2 WEAPONTYPE_UZI 300
TURN_CHAR_TO_FACE_CHAR yakuza_guard2 yakuza_guard1
TURN_CHAR_TO_FACE_CHAR yakuza_guard1 yakuza_guard2
SET_CHAR_HEED_THREATS yakuza_guard2 TRUE
SET_CHARS_CHATTING yakuza_guard1 yakuza_guard2 10000000

CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A 361.8262 -345.2548 16.0 yakuza_guard3
GIVE_WEAPON_TO_CHAR yakuza_guard3 WEAPONTYPE_SHOTGUN 300
SET_CHAR_HEADING yakuza_guard3 170.0
SET_CHAR_HEED_THREATS yakuza_guard3 TRUE

CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A 335.5756 -295.7485 16.0 yakuza_guard4
GIVE_WEAPON_TO_CHAR yakuza_guard4 WEAPONTYPE_SHOTGUN 300
SET_CHAR_HEADING yakuza_guard4 237.0
SET_CHAR_HEED_THREATS yakuza_guard4 TRUE

CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A 335.8966 -298.0577 16.0 yakuza_guard5
GIVE_WEAPON_TO_CHAR yakuza_guard5 WEAPONTYPE_UZI 300
SET_CHAR_HEADING yakuza_guard5 129.0
SET_CHAR_STAY_IN_SAME_PLACE	yakuza_guard5 TRUE
SET_CHAR_HEED_THREATS yakuza_guard5 TRUE

IF NOT IS_CHAR_DEAD	goon_at_yard1
	EXPLODE_CHAR_HEAD goon_at_yard1	
ENDIF
IF NOT IS_CHAR_DEAD	goon_at_yard2
	EXPLODE_CHAR_HEAD goon_at_yard2	
ENDIF
IF NOT IS_CHAR_DEAD	goon_at_yard3
	EXPLODE_CHAR_HEAD goon_at_yard3	
ENDIF
IF NOT IS_CHAR_DEAD	goon_at_yard4
	EXPLODE_CHAR_HEAD goon_at_yard4
ENDIF
IF NOT IS_CHAR_DEAD	goon_at_yard5
	EXPLODE_CHAR_HEAD goon_at_yard5	
ENDIF
IF NOT IS_CHAR_DEAD	goon_at_yard6
	EXPLODE_CHAR_HEAD goon_at_yard6	
ENDIF
IF NOT IS_CHAR_DEAD	goon_at_yard7
	EXPLODE_CHAR_HEAD goon_at_yard7	
ENDIF
IF NOT IS_CHAR_DEAD	goon_at_yard8
	EXPLODE_CHAR_HEAD goon_at_yard8
ENDIF
IF NOT IS_CHAR_DEAD	goon_at_yard9
	EXPLODE_CHAR_HEAD goon_at_yard9
ENDIF
IF NOT IS_CHAR_DEAD	goon_at_yard10
	EXPLODE_CHAR_HEAD goon_at_yard10
ENDIF

SWITCH_STREAMING ON
DO_FADE 1500 FADE_IN 

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

// ******************************************END OF CUTSCENE********************************

PRINT_NOW LOVE4_4 5000 1 //"Take the package to Love."

IF NOT IS_CAR_DEAD colombian_car
	IF NOT IS_CHAR_DEAD	yakuza_guard5
		SET_CAR_HEALTH colombian_car 2500
		SET_CHAR_OBJ_DESTROY_CAR yakuza_guard5 colombian_car
	ENDIF
ENDIF

ADD_BLIP_FOR_COORD 87.3 -1548.6 27.255 love_4_blip // LOVES PAD

WHILE NOT LOCATE_STOPPED_PLAYER_ON_FOOT_3D player 87.3 -1548.6 28.3 2.0 1.0 2.0 1
	WAIT 0
ENDWHILE

MARK_CAR_AS_NO_LONGER_NEEDED yakuza_car1
MARK_CAR_AS_NO_LONGER_NEEDED yakuza_car2
MARK_CAR_AS_NO_LONGER_NEEDED yakuza_car3
MARK_CAR_AS_NO_LONGER_NEEDED car_van1_lm4
MARK_CAR_AS_NO_LONGER_NEEDED car_van2_lm4
MARK_CAR_AS_NO_LONGER_NEEDED colombian_car
MARK_CHAR_AS_NO_LONGER_NEEDED yakuza_guard1
MARK_CHAR_AS_NO_LONGER_NEEDED yakuza_guard2
MARK_CHAR_AS_NO_LONGER_NEEDED yakuza_guard3
MARK_CHAR_AS_NO_LONGER_NEEDED yakuza_guard4
MARK_CHAR_AS_NO_LONGER_NEEDED yakuza_guard5
MARK_CHAR_AS_NO_LONGER_NEEDED goon_at_yard1
MARK_CHAR_AS_NO_LONGER_NEEDED goon_at_yard2
MARK_CHAR_AS_NO_LONGER_NEEDED goon_at_yard3
MARK_CHAR_AS_NO_LONGER_NEEDED goon_at_yard4
MARK_CHAR_AS_NO_LONGER_NEEDED goon_at_yard5
MARK_CHAR_AS_NO_LONGER_NEEDED goon_at_yard6
MARK_CHAR_AS_NO_LONGER_NEEDED goon_at_yard7
MARK_CHAR_AS_NO_LONGER_NEEDED goon_at_yard8
MARK_CHAR_AS_NO_LONGER_NEEDED goon_at_yard9
MARK_CHAR_AS_NO_LONGER_NEEDED goon_at_yard10

SET_PLAYER_CONTROL player OFF

SET_EVERYONE_IGNORE_PLAYER player ON
SET_ALL_CARS_CAN_BE_DAMAGED FALSE
CLEAR_WANTED_LEVEL player

SET_FIXED_CAMERA_POSITION 81.3343 -1540.0887 27.7976 0.0 0.0 0.0
POINT_CAMERA_AT_POINT 81.8719 -1540.9318 27.8039 JUMP_CUT

SWITCH_WIDESCREEN ON

GET_PLAYER_CHAR player script_controlled_player

SET_CHAR_OBJ_RUN_TO_COORD script_controlled_player 87.4588 -1548.7035

TIMERA = 0

WHILE NOT LOCATE_PLAYER_ON_FOOT_2D player 87.4588 -1548.7035 1.0 1.0 0
	WAIT 0
	IF TIMERA > 3000
		GOTO get_out_of_loop
	ENDIF
ENDWHILE

get_out_of_loop:

SET_CHAR_OBJ_RUN_TO_COORD script_controlled_player 98.7615 -1548.6489

DO_FADE 1000 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_AREA 87.3 -1548.6 28.3 2.0 0
SET_CHAR_OBJ_NO_OBJ	script_controlled_player
CHAR_SET_IDLE script_controlled_player
SET_CHAR_OBJ_RUN_TO_COORD script_controlled_player 81.2603 -1548.9347
SET_CHAR_OBJ_NO_OBJ	script_controlled_player
CHAR_SET_IDLE script_controlled_player

WAIT 250

SET_PLAYER_COORDINATES player 81.2603 -1548.9347 27.4
SET_PLAYER_HEADING player 90.0
RESTORE_CAMERA_JUMPCUT
SWITCH_WIDESCREEN OFF
SET_PLAYER_CONTROL player ON
SET_CAMERA_IN_FRONT_OF_PLAYER
SET_EVERYONE_IGNORE_PLAYER player OFF
SET_ALL_CARS_CAN_BE_DAMAGED TRUE

DO_FADE 1000 FADE_IN

GOTO mission_love4_passed



// Mission Love 4 failed

mission_love4_failed:
PRINT_BIG M_FAIL 2000 1
RETURN

   

// mission Love 4 passed

mission_love4_passed:

flag_love_mission4_passed = 1

SWITCH_CAR_GENERATOR com_car37 0
//SWITCH_CAR_GENERATOR com_car38 0
SWITCH_CAR_GENERATOR gen_car60 101
SWITCH_CAR_GENERATOR gen_car61 101
SWITCH_CAR_GENERATOR gen_car62 101
SWITCH_CAR_GENERATOR gen_car63 101
SWITCH_ROADS_ON -46.8 -648.0 39.0 -69.1 -614.0 50.0 //Commercial to Suburbia Bridge
REMOVE_BLIP	asuka_contact_blip
PRINT_WITH_NUMBER_BIG M_PASS 50000 2000 1
ADD_SCORE player 50000
CLEAR_WANTED_LEVEL player
REGISTER_MISSION_PASSED	LOVE4
SETUP_ZONE_PED_INFO CONSTRU DAY   (30) (0 0 0) 250 0 50 0 20  //Fort staunton
SETUP_ZONE_PED_INFO CONSTRU NIGHT (15) (0 0 0) 300 0 70 0 10
PLAY_MISSION_PASSED_TUNE 1
PLAYER_MADE_PROGRESS 1
ADD_SPRITE_BLIP_FOR_CONTACT_POINT 366.939 -328.025 20.268 RADAR_SPRITE_ASUKA asuka_contact_blip
START_NEW_SCRIPT asuka_suburban_mission1_loop
START_NEW_SCRIPT love_mission5_loop

RETURN
		


// mission cleanup

mission_cleanup_love4:

DISPLAY_RADAR 3 // PATHING ON

REMOVE_BLIP love_4_blip

REMOVE_BLIP goon_in_hangar1_blip
REMOVE_BLIP goon_in_hangar2_blip
REMOVE_BLIP goon_in_hangar3_blip
REMOVE_BLIP goon_in_hangar4_blip

REMOVE_ROUTE hangar_route
REMOVE_ROUTE yard_route1
REMOVE_ROUTE yard_route2
REMOVE_ROUTE yard_route3

MARK_MODEL_AS_NO_LONGER_NEEDED CAR_PANLANT
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
MARK_MODEL_AS_NO_LONGER_NEEDED PLANE_DODO
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_YAKUZA
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_A
MARK_OBJECT_AS_NO_LONGER_NEEDED deadman1
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_COLUMB

//SET_TARGET_CAR_FOR_MISSION_GARAGE loves_garage -1

flag_player_on_mission = 0
flag_player_on_love_mission = 0
MISSION_HAS_FINISHED
RETURN



///////////////////////////////////////////////////////////////////////////////
set_death_flags:

IF goon_in_hangar1_flag = -1
	goon_in_hangar1_flag = 0
ENDIF
IF goon_in_hangar1_ducking = -1
	goon_in_hangar1_ducking = 0
ENDIF

IF goon_in_hangar2_flag = -1
	goon_in_hangar2_flag = 0
ENDIF
IF goon_in_hangar2_ducking = -1
	goon_in_hangar2_ducking = 0
ENDIF

IF goon_in_hangar3_flag = -1
	goon_in_hangar3_flag = 0
ENDIF
IF goon_in_hangar3_ducking = -1
	goon_in_hangar3_ducking = 0
ENDIF

IF goon_in_hangar4_flag = -1
	goon_in_hangar4_flag = 0
ENDIF
IF goon_in_hangar4_ducking = -1
	goon_in_hangar4_ducking = 0
ENDIF

IF goon_in_hangar1_blip_flag = 0
	IF NOT IS_CHAR_DEAD	goon_in_hangar1
		ADD_BLIP_FOR_CHAR goon_in_hangar1 goon_in_hangar1_blip
		PRINT_NOW LOVE4_1 5000 1 //"KILL them all!!"
		goon_in_hangar1_blip_flag = 1
	ENDIF
ENDIF

IF goon_in_hangar2_blip_flag = 0
	IF NOT IS_CHAR_DEAD	goon_in_hangar2
		ADD_BLIP_FOR_CHAR goon_in_hangar2 goon_in_hangar2_blip
		PRINT_NOW LOVE4_1 5000 1 //"KILL them all!!"
		goon_in_hangar2_blip_flag = 1
	ENDIF
ENDIF

IF goon_in_hangar3_blip_flag = 0
	IF NOT IS_CHAR_DEAD	goon_in_hangar3
		ADD_BLIP_FOR_CHAR goon_in_hangar3 goon_in_hangar3_blip
		PRINT_NOW LOVE4_1 5000 1 //"KILL them all!!"
		goon_in_hangar3_blip_flag = 1
	ENDIF
ENDIF

IF goon_in_hangar4_blip_flag = 0
	IF NOT IS_CHAR_DEAD	goon_in_hangar4
		ADD_BLIP_FOR_CHAR goon_in_hangar4 goon_in_hangar4_blip
		PRINT_NOW LOVE4_1 5000 1 //"KILL them all!!"
		goon_in_hangar4_blip_flag = 1
	ENDIF
ENDIF

RETURN
///////////////////////////////////////////////////////////////////////////////

		
///////////////////////////////////////////////////////////////////////////////
ducking_routine:

IF TIMERA > 3000
	IF ducking_flag = 0
		ducking_flag = 1
	ELSE
		ducking_flag = 0
	ENDIF
	TIMERA = 0
ENDIF

IF goon_in_hangar1_ducking = 1
	IF ducking_flag = 0
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar1 -1280.2 -520.1 1.5 1.5 0
			SET_CHAR_WAIT_STATE goon_in_hangar1 WAITSTATE_FALSE	100
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar1 TRUE
			IF IS_PLAYER_IN_ANY_CAR	player
				STORE_CAR_PLAYER_IS_IN player players_vehicle
				SET_CHAR_OBJ_DESTROY_CAR goon_in_hangar1 players_vehicle
			ELSE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_in_hangar1 player
			ENDIF
			goon_in_hangar1_waitstate = 0
		ELSE
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar1 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar1 -1280.2 -520.1
		ENDIF
	ELSE
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar1 -1280.2 -520.1 1.5 1.5 0
			IF goon_in_hangar1_waitstate = 0
				SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar1 TRUE
				SET_CHAR_OBJ_WAIT_ON_FOOT	goon_in_hangar1
				SET_CHAR_WAIT_STATE goon_in_hangar1 WAITSTATE_PLAYANIM_DUCK	3000
				goon_in_hangar1_waitstate = 1
			ENDIF
		ELSE
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar1 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar1 -1280.2 -520.1
		ENDIF
	ENDIF
ENDIF
		
IF goon_in_hangar2_ducking = 1
	IF ducking_flag = 0
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar2 -1256.4 -521.3 1.5 1.5 0
			SET_CHAR_WAIT_STATE goon_in_hangar2 WAITSTATE_FALSE	100
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar2 TRUE
			IF IS_PLAYER_IN_ANY_CAR	player
				STORE_CAR_PLAYER_IS_IN player players_vehicle
				SET_CHAR_OBJ_DESTROY_CAR goon_in_hangar2 players_vehicle
			ELSE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_in_hangar2 player
			ENDIF
			goon_in_hangar2_waitstate = 0
		ELSE
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar2 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar2 -1256.4 -521.3
		ENDIF
	ELSE
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar2 -1256.4 -521.3 1.5 1.5 0
			IF goon_in_hangar2_waitstate = 0
				SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar2 TRUE
				SET_CHAR_OBJ_WAIT_ON_FOOT	goon_in_hangar2
				SET_CHAR_WAIT_STATE goon_in_hangar2 WAITSTATE_PLAYANIM_DUCK	3000
				goon_in_hangar2_waitstate = 1
			ENDIF
		ELSE
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar2 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar2 -1256.4 -521.3
		ENDIF
	ENDIF
ENDIF
		
IF goon_in_hangar3_ducking = 1
	IF ducking_flag = 1
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar3 -1254.4 -521.3 1.5 1.5 0
			SET_CHAR_WAIT_STATE goon_in_hangar3 WAITSTATE_FALSE	100
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar3 TRUE
			IF IS_PLAYER_IN_ANY_CAR	player
				STORE_CAR_PLAYER_IS_IN player players_vehicle
				SET_CHAR_OBJ_DESTROY_CAR goon_in_hangar3 players_vehicle
			ELSE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_in_hangar3 player
			ENDIF
			goon_in_hangar3_waitstate = 0
		ELSE
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar3 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar3 -1254.4 -521.3
		ENDIF
	ELSE
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar3 -1254.4 -521.3 1.5 1.5 0
			IF goon_in_hangar3_waitstate = 0
				SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar3 TRUE
				SET_CHAR_OBJ_WAIT_ON_FOOT	goon_in_hangar3
				SET_CHAR_WAIT_STATE goon_in_hangar3 WAITSTATE_PLAYANIM_DUCK	3000
				goon_in_hangar3_waitstate = 1
			ENDIF
		ELSE
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar3 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar3 -1254.4 -521.3
		ENDIF
	ENDIF
ENDIF
		
IF goon_in_hangar4_ducking = 1
	IF ducking_flag = 1
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar4 -1280.8 -529.2 1.5 1.5 0
			SET_CHAR_WAIT_STATE goon_in_hangar4 WAITSTATE_FALSE	100
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar4 TRUE
			IF IS_PLAYER_IN_ANY_CAR	player
				STORE_CAR_PLAYER_IS_IN player players_vehicle
				SET_CHAR_OBJ_DESTROY_CAR goon_in_hangar4 players_vehicle
			ELSE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_in_hangar4 player
			ENDIF
			goon_in_hangar4_waitstate = 0
		ELSE
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar4 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar4 -1280.8 -529.2
		ENDIF
	ELSE
		IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_in_hangar4 -1280.8 -529.2 1.5 1.5 0
			IF goon_in_hangar4_waitstate = 0
				SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar4 TRUE
				SET_CHAR_OBJ_WAIT_ON_FOOT	goon_in_hangar4
				SET_CHAR_WAIT_STATE goon_in_hangar4 WAITSTATE_PLAYANIM_DUCK	3000
				goon_in_hangar4_waitstate = 1
			ENDIF
		ELSE
			SET_CHAR_STAY_IN_SAME_PLACE goon_in_hangar4 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD goon_in_hangar4 -1280.8 -529.2
		ENDIF
	ENDIF
ENDIF

RETURN
///////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////
goon_at_yard1_routine:
IF c_site_area_flag > 0
	IF NOT IS_CHAR_DEAD	goon_at_yard1
		IF goon_at_yard1_flag = 0
			SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard1 FALSE
			SET_CHAR_WAIT_STATE goon_at_yard1 WAITSTATE_FALSE 100
			GIVE_WEAPON_TO_CHAR goon_at_yard1 WEAPONTYPE_M16 9999
			SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard1 345.0805 -309.6011
			goon_at_yard1_flag = 1
		ENDIF
		IF goon_at_yard1_flag = 1
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard1 345.0805 -309.6011 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard1	345.3315 -313.2216
				goon_at_yard1_flag = 2
			ENDIF
		ENDIF
		IF goon_at_yard1_flag = 2
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard1	345.3315 -313.2216 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard1 342.1783 -312.7577
				goon_at_yard1_flag = 3
			ENDIF
		ENDIF
		IF goon_at_yard1_flag = 3
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard1	342.1783 -312.7577 1.0 1.0 0
				SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard1 TRUE
				goon_at_yard1_flag = 4
			ENDIF
		ENDIF
		IF goon_at_yard1_flag = 4
			IF game_timer_var > goon_at_yard1_duck_timer
				goon_at_yard1_duck_timer = game_timer_var + 3000
				IF goon_at_yard1_duck = 0
					SET_CHAR_WAIT_STATE goon_at_yard1 WAITSTATE_FALSE 100
					IF IS_PLAYER_IN_ANY_CAR player
						STORE_CAR_PLAYER_IS_IN player players_vehicle
						SET_CHAR_OBJ_DESTROY_CAR goon_at_yard1 players_vehicle
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard1 player
					ENDIF
					IF c_site_area_flag = 1
						goon_at_yard1_duck = 1
					ENDIF
				ELSE
					SET_CHAR_OBJ_WAIT_ON_FOOT goon_at_yard1
					SET_CHAR_WAIT_STATE goon_at_yard1 WAITSTATE_PLAYANIM_DUCK 3000
					goon_at_yard1_duck = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF// IS_CHAR_DEAD goon_at_yard1
ENDIF
RETURN
///////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////
goon_at_yard2_routine:
IF c_site_area_flag > 0
	IF NOT IS_CHAR_DEAD	goon_at_yard2
		IF goon_at_yard2_flag = 0
			SET_CHAR_WAIT_STATE goon_at_yard2 WAITSTATE_FALSE 100
			GIVE_WEAPON_TO_CHAR goon_at_yard2 WEAPONTYPE_CHAINGUN 9999
			SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard2 TRUE
			IF IS_PLAYER_IN_ANY_CAR player
				STORE_CAR_PLAYER_IS_IN player players_vehicle
				SET_CHAR_OBJ_DESTROY_CAR goon_at_yard2 players_vehicle
			ELSE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard2 player
			ENDIF
			goon_at_yard2_flag = 1
			goon_at_yard2_duck_timer = game_timer_var + 2000
		ENDIF
		IF goon_at_yard2_flag = 1
			IF game_timer_var > goon_at_yard2_duck_timer
				SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard2 FALSE
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard2	333.6390 -307.5708
				goon_at_yard2_flag = 2
			ENDIF
		ENDIF
		IF goon_at_yard2_flag = 2
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard2	333.6390 -307.5708 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard2 333.4980 -304.7924
				goon_at_yard2_flag = 3
			ENDIF
		ENDIF
		IF goon_at_yard2_flag = 3
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard2	333.4980 -304.7924 1.0 1.0 0
				SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard2 TRUE
				goon_at_yard2_flag = 4
			ENDIF
		ENDIF
		IF goon_at_yard2_flag = 4
			IF game_timer_var > goon_at_yard2_duck_timer
				goon_at_yard2_duck_timer = game_timer_var + 3000
				IF goon_at_yard2_duck = 0
					SET_CHAR_WAIT_STATE goon_at_yard2 WAITSTATE_FALSE 100
					IF IS_PLAYER_IN_ANY_CAR player
						STORE_CAR_PLAYER_IS_IN player players_vehicle
						SET_CHAR_OBJ_DESTROY_CAR goon_at_yard2 players_vehicle
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard2 player
					ENDIF
					IF c_site_area_flag < 3
						goon_at_yard2_duck = 1
					ENDIF
				ELSE
					SET_CHAR_OBJ_WAIT_ON_FOOT goon_at_yard2
					SET_CHAR_WAIT_STATE goon_at_yard2 WAITSTATE_PLAYANIM_DUCK 3000
					goon_at_yard2_duck = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF// IS_CHAR_DEAD goon_at_yard2
ENDIF
RETURN
///////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////
goon_at_yard3_routine:
IF c_site_area_flag > 1
	IF NOT IS_CHAR_DEAD	goon_at_yard3
		IF goon_at_yard3_flag = 0
			SET_CHAR_WAIT_STATE goon_at_yard3 WAITSTATE_FALSE 100
			SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard3 TRUE
			IF IS_PLAYER_IN_ANY_CAR player
				STORE_CAR_PLAYER_IS_IN player players_vehicle
				SET_CHAR_OBJ_DESTROY_CAR goon_at_yard3 players_vehicle
			ELSE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard3 player
			ENDIF
			goon_at_yard3_flag = 1
			goon_at_yard3_duck_timer = game_timer_var + 2000
		ENDIF
		IF goon_at_yard3_flag = 1
			IF game_timer_var > goon_at_yard3_duck_timer
				SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard3 FALSE
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard3	331.6994 -329.1375
				goon_at_yard3_flag = 2
			ENDIF
		ENDIF
		IF goon_at_yard3_flag = 2
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard3	331.6994 -329.1375 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard3	327.6451 -329.1378
				goon_at_yard3_flag = 3
			ENDIF
		ENDIF
		IF goon_at_yard3_flag = 3
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard3	327.6451 -329.1378 1.0 1.0 0
				SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard3 TRUE
				goon_at_yard3_flag = 4
			ENDIF
		ENDIF
		IF goon_at_yard3_flag = 4
			IF game_timer_var > goon_at_yard3_duck_timer
				goon_at_yard3_duck_timer = game_timer_var + 3000
				IF goon_at_yard3_duck = 0
					SET_CHAR_WAIT_STATE goon_at_yard3 WAITSTATE_FALSE 100
					IF IS_PLAYER_IN_ANY_CAR player
						STORE_CAR_PLAYER_IS_IN player players_vehicle
						SET_CHAR_OBJ_DESTROY_CAR goon_at_yard3 players_vehicle
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard3 player
					ENDIF
					IF c_site_area_flag < 4
						goon_at_yard3_duck = 1
					ENDIF
				ELSE
					SET_CHAR_OBJ_WAIT_ON_FOOT	goon_at_yard3
					SET_CHAR_WAIT_STATE goon_at_yard3 WAITSTATE_PLAYANIM_DUCK 3000
					goon_at_yard3_duck = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF
ENDIF
RETURN
///////////////////////////////////////////////////////////////////////////////

	
///////////////////////////////////////////////////////////////////////////////
goon_at_yard4_routine:
IF c_site_area_flag > 2
	IF NOT IS_CHAR_DEAD	goon_at_yard4
		IF goon_at_yard4_flag = 0
			SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard4 TRUE
			SET_CHAR_WAIT_STATE goon_at_yard4 WAITSTATE_FALSE 100
			IF IS_PLAYER_IN_ANY_CAR player
				STORE_CAR_PLAYER_IS_IN player players_vehicle
				SET_CHAR_OBJ_DESTROY_CAR goon_at_yard4 players_vehicle
			ELSE
				SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard4 player
			ENDIF
			goon_at_yard4_flag = 1
		ENDIF
		IF goon_at_yard4_flag = 1
			IF HAS_CHAR_SPOTTED_PLAYER goon_at_yard4 player
				goon_at_yard4_duck_timer = game_timer_var + 2000
				goon_at_yard4_flag = 2
			ENDIF
		ENDIF
		IF goon_at_yard4_flag = 2
			IF game_timer_var > goon_at_yard4_duck_timer
				SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard4 FALSE
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard4	338.6765 -329.4054
				goon_at_yard4_flag = 3
			ENDIF
		ENDIF
		IF goon_at_yard4_flag = 3
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard4	338.6765 -329.4054 1.0 1.0 0
				SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard4 TRUE
				goon_at_yard4_flag = 4
			ENDIF
		ENDIF
		IF goon_at_yard4_flag = 4
			IF game_timer_var > goon_at_yard4_duck_timer
				goon_at_yard4_duck_timer = game_timer_var + 3000
				IF goon_at_yard4_duck = 0
					SET_CHAR_WAIT_STATE goon_at_yard4 WAITSTATE_FALSE 100
					IF IS_PLAYER_IN_ANY_CAR player
						STORE_CAR_PLAYER_IS_IN player players_vehicle
						SET_CHAR_OBJ_DESTROY_CAR goon_at_yard4 players_vehicle
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard4 player
					ENDIF
					IF c_site_area_flag < 5
						goon_at_yard4_duck = 1
					ENDIF
				ELSE
					SET_CHAR_OBJ_WAIT_ON_FOOT	goon_at_yard4
					SET_CHAR_WAIT_STATE goon_at_yard4 WAITSTATE_PLAYANIM_DUCK 3000
					goon_at_yard4_duck = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF
ENDIF
RETURN
///////////////////////////////////////////////////////////////////////////////

	
///////////////////////////////////////////////////////////////////////////////
goon_at_yard5_routine:
IF c_site_area_flag > 3
	IF NOT IS_CHAR_DEAD	goon_at_yard5
		IF goon_at_yard5_flag = 0
			SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard5 FALSE
			SET_CHAR_WAIT_STATE goon_at_yard5 WAITSTATE_FALSE 100
			SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard5 354.6851 -325.3922
			goon_at_yard5_flag = 1
		ENDIF
		IF goon_at_yard5_flag = 1
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard5 354.6851 -325.3922 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard5 345.9960 -325.4795
				goon_at_yard5_flag = 2
			ENDIF
		ENDIF
		IF goon_at_yard5_flag = 2
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard5 345.9960 -325.4795 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard5 341.6781 -327.4943
				goon_at_yard5_flag = 3
			ENDIF
		ENDIF
		IF goon_at_yard5_flag = 3
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard5 341.6781 -327.4943 1.0 1.0 0
				SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard5 TRUE
				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player players_vehicle
					SET_CHAR_OBJ_DESTROY_CAR goon_at_yard5 players_vehicle
				ELSE
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard5 player
					goon_at_yard5_flag = 4
				ENDIF
			ENDIF
		ENDIF
	ENDIF
ENDIF
RETURN
///////////////////////////////////////////////////////////////////////////////

	
///////////////////////////////////////////////////////////////////////////////
goon_at_yard6_routine:
IF c_site_area_flag > 2
	IF NOT IS_CHAR_DEAD	goon_at_yard6
		IF goon_at_yard6_flag = 0
			SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard6 FALSE
			SET_CHAR_WAIT_STATE goon_at_yard6 WAITSTATE_FALSE 100
			SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard6 365.8858 -317.3099
			goon_at_yard6_flag = 1
		ENDIF
		IF goon_at_yard6_flag = 1
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard6 365.8858 -317.3099 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard6 335.6921 -316.2758
				goon_at_yard6_flag = 2
			ENDIF
		ENDIF
		IF goon_at_yard6_flag = 2
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard6 335.6921 -316.2758 1.0 1.0 0
				SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard6 TRUE
				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player players_vehicle
					SET_CHAR_OBJ_DESTROY_CAR goon_at_yard6 players_vehicle
				ELSE
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard6 player
					goon_at_yard6_flag = 3
				ENDIF
			ENDIF
		ENDIF
	ENDIF
ENDIF
RETURN
///////////////////////////////////////////////////////////////////////////////

	
///////////////////////////////////////////////////////////////////////////////
goon_at_yard7_routine:
IF c_site_area_flag	> 3
	IF NOT IS_CHAR_DEAD	goon_at_yard7
		IF game_timer_var > goon_at_yard7_duck_timer
			SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard7 TRUE
			goon_at_yard7_duck_timer = game_timer_var + 3000
			IF goon_at_yard7_duck = 0
				SET_CHAR_WAIT_STATE goon_at_yard7 WAITSTATE_FALSE 100
				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player players_vehicle
					SET_CHAR_OBJ_DESTROY_CAR goon_at_yard7 players_vehicle
				ELSE
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard7 player
				ENDIF
				IF c_site_area_flag < 6
					goon_at_yard7_duck = 1
				ENDIF
			ELSE
				SET_CHAR_OBJ_WAIT_ON_FOOT goon_at_yard7
				SET_CHAR_WAIT_STATE goon_at_yard7 WAITSTATE_PLAYANIM_DUCK 3000
				goon_at_yard7_duck = 0
			ENDIF
		ENDIF
	ENDIF
ENDIF
RETURN
///////////////////////////////////////////////////////////////////////////////

	
///////////////////////////////////////////////////////////////////////////////
goon_at_yard8_routine:
IF c_site_area_flag > 3
	IF NOT IS_CHAR_DEAD	goon_at_yard8
		IF goon_at_yard8_flag = 0
			SET_CHAR_OBJ_WAIT_ON_FOOT	goon_at_yard8
			CHAR_SET_IDLE goon_at_yard8
			REMOVE_ROUTE yard_route3
			SET_CHAR_WAIT_STATE goon_at_yard8 WAITSTATE_FALSE 100
			SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard8 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard8 375.4750 -331.2
			goon_at_yard8_flag = 1
		ENDIF
		IF goon_at_yard8_flag = 1
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard8	375.4750 -331.2 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard8 363.7481 -330.9657 //363.9961 -330.8928
				goon_at_yard8_flag = 2
			ENDIF
		ENDIF
		IF goon_at_yard8_flag = 2
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard8	363.7481 -330.9657 1.0 1.0 0
				SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard8 TRUE
				goon_at_yard8_flag = 3
			ENDIF
		ENDIF
		IF goon_at_yard8_flag = 3
			IF game_timer_var > goon_at_yard8_duck_timer
				goon_at_yard8_duck_timer = game_timer_var + 3000
				IF goon_at_yard8_duck = 0
					SET_CHAR_WAIT_STATE goon_at_yard8 WAITSTATE_FALSE 100
					IF IS_PLAYER_IN_ANY_CAR player
						STORE_CAR_PLAYER_IS_IN player players_vehicle
						SET_CHAR_OBJ_DESTROY_CAR goon_at_yard8 players_vehicle
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard8 player
					ENDIF
					IF c_site_area_flag < 6
						goon_at_yard8_duck = 1
					ENDIF
					IF goon_at_yard8_duck = 0
						GIVE_WEAPON_TO_CHAR goon_at_yard8 WEAPONTYPE_SHOTGUN 9999
					ENDIF
				ELSE
					SET_CHAR_OBJ_WAIT_ON_FOOT	goon_at_yard8
					SET_CHAR_WAIT_STATE goon_at_yard8 WAITSTATE_PLAYANIM_DUCK 3000
					goon_at_yard8_duck = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF
ENDIF
RETURN
///////////////////////////////////////////////////////////////////////////////

	
///////////////////////////////////////////////////////////////////////////////
goon_at_yard9_routine:
IF c_site_area_flag > 3
	IF NOT IS_CHAR_DEAD	goon_at_yard9
		IF goon_at_yard9_flag = 0
			SET_CHAR_OBJ_WAIT_ON_FOOT goon_at_yard9
			CHAR_SET_IDLE goon_at_yard9
			REMOVE_ROUTE yard_route2
			SET_CHAR_WAIT_STATE goon_at_yard9 WAITSTATE_FALSE 100
			SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard9 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard9	374.9931 -311.8263
			goon_at_yard9_flag = 1
		ENDIF
		IF goon_at_yard9_flag = 1
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard9	374.9931 -311.8263 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard9	348.1611 -301.9640
				goon_at_yard9_flag = 2
			ENDIF
		ENDIF
		IF goon_at_yard9_flag = 2
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard9	348.1611 -301.9640 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard9 342.9392 -302.6671
				goon_at_yard9_flag = 3
			ENDIF
		ENDIF
		IF goon_at_yard9_flag = 3
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard9	342.9392 -302.6671 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard9 327.6495 -317.2610
				goon_at_yard9_flag = 4
			ENDIF
		ENDIF
		IF goon_at_yard9_flag = 4
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard9	327.6495 -317.2610 1.0 1.0 0
				IF c_site_area_flag = 4
					SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard9 TRUE
					IF IS_PLAYER_IN_ANY_CAR player
						STORE_CAR_PLAYER_IS_IN player players_vehicle
						SET_CHAR_OBJ_DESTROY_CAR goon_at_yard9 players_vehicle
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard9 player
					ENDIF
				ELSE
					SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard9 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard9 335.2008 -334.9071
					goon_at_yard9_flag = 5
				ENDIF
			ENDIF
		ENDIF
		IF goon_at_yard9_flag = 5
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard9	335.2008 -334.9071 1.0 1.0 0
				IF c_site_area_flag = 5
					SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard9 TRUE
					IF IS_PLAYER_IN_ANY_CAR player
						STORE_CAR_PLAYER_IS_IN player players_vehicle
						SET_CHAR_OBJ_DESTROY_CAR goon_at_yard9 players_vehicle
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard9 player
					ENDIF
				ELSE
					SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard9 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard9 360.4199 -337.9403
					goon_at_yard9_flag = 6
				ENDIF
			ENDIF
		ENDIF
		IF goon_at_yard9_flag = 6
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard9	360.4199 -337.9403 1.0 1.0 0
				SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard9 TRUE
				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player players_vehicle
					SET_CHAR_OBJ_DESTROY_CAR goon_at_yard9 players_vehicle
				ELSE
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard9 player
				ENDIF
			ENDIF
		ENDIF
	ENDIF
ENDIF
RETURN
///////////////////////////////////////////////////////////////////////////////

	
///////////////////////////////////////////////////////////////////////////////
goon_at_yard10_routine:
IF c_site_area_flag > 0
	IF NOT IS_CHAR_DEAD	goon_at_yard10
		IF goon_at_yard10_flag = 0
			SET_CHAR_HEED_THREATS goon_at_yard10 FALSE
			SET_CHAR_OBJ_WAIT_ON_FOOT goon_at_yard10
			CHAR_SET_IDLE goon_at_yard10
			REMOVE_ROUTE yard_route1
			SET_CHAR_WAIT_STATE goon_at_yard10 WAITSTATE_FALSE 100
			SET_CHAR_STAY_IN_SAME_PLACE goon_at_yard10 FALSE
			SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard10 372.5888 -298.4539
			goon_at_yard10_flag = 1
		ENDIF
		IF goon_at_yard10_flag = 1
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard10 372.5888 -298.4539 1.0 1.0 0
				SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard10 TRUE
				goon_at_yard10_flag = 2
			ENDIF
		ENDIF
		IF goon_at_yard10_flag = 2
			IF c_site_area_flag = 1
				IF game_timer_var > goon_at_yard10_duck_timer
					goon_at_yard10_duck_timer = game_timer_var + 3000
					IF goon_at_yard10_duck = 0
						SET_CHAR_WAIT_STATE goon_at_yard10 WAITSTATE_FALSE 100
						IF IS_PLAYER_IN_ANY_CAR player
							STORE_CAR_PLAYER_IS_IN player players_vehicle
							SET_CHAR_OBJ_DESTROY_CAR goon_at_yard10	players_vehicle
						ELSE
							SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard10 player
						ENDIF
						goon_at_yard10_duck = 1
					ELSE
						SET_CHAR_OBJ_WAIT_ON_FOOT goon_at_yard10
						SET_CHAR_WAIT_STATE goon_at_yard10 WAITSTATE_PLAYANIM_DUCK 3000
						goon_at_yard10_duck = 0
					ENDIF
				ENDIF
			ELSE
				SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard10 FALSE
				SET_CHAR_WAIT_STATE goon_at_yard10 WAITSTATE_FALSE 100
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard10 372.8152 -266.8551
				goon_at_yard10_flag = 3
			ENDIF
		ENDIF
		IF goon_at_yard10_flag = 3
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard10 372.8152 -266.8551 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard10 363.9329 -266.5335
				goon_at_yard10_flag = 4
			ENDIF
		ENDIF
		IF goon_at_yard10_flag = 4
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard10 363.9329 -266.5335 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard10 361.9770 -290.5143
				goon_at_yard10_flag = 5
			ENDIF
		ENDIF
		IF goon_at_yard10_flag = 5
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard10 361.9770 -290.5143 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard10 341.3853 -298.2471
				goon_at_yard10_flag = 6
			ENDIF
		ENDIF
		IF goon_at_yard10_flag = 6
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard10 341.3853 -298.2471 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard10 342.3168 -303.6481
				goon_at_yard10_flag = 7
			ENDIF
		ENDIF
		IF goon_at_yard10_flag = 7
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard10 342.3168 -303.6481 1.0 1.0 0
				IF c_site_area_flag = 2
					SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard10 TRUE
					IF IS_PLAYER_IN_ANY_CAR player
						STORE_CAR_PLAYER_IS_IN player players_vehicle
						SET_CHAR_OBJ_DESTROY_CAR goon_at_yard10	players_vehicle
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard10 player
					ENDIF
				ELSE
					SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard10 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard10 338.2401 -308.2155
					goon_at_yard10_flag = 8
				ENDIF
			ENDIF
		ENDIF
		IF goon_at_yard10_flag = 8
			IF LOCATE_CHAR_ON_FOOT_2D goon_at_yard10 338.2401 -308.2155 1.0 1.0 0
				SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard10 330.4936 -314.1106
				goon_at_yard10_flag = 9
			ENDIF
		ENDIF
		IF goon_at_yard10_flag = 9
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard10 330.4936 -314.1106 1.0 1.0 0
				IF c_site_area_flag = 3
				OR c_site_area_flag = 4
					SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard10 TRUE
					IF IS_PLAYER_IN_ANY_CAR player
						STORE_CAR_PLAYER_IS_IN player players_vehicle
						SET_CHAR_OBJ_DESTROY_CAR goon_at_yard10	players_vehicle
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard10 player
					ENDIF
				ELSE
					SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard10 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard10 334.6789 -338.7348
					goon_at_yard10_flag = 10
				ENDIF
			ENDIF
		ENDIF
		IF goon_at_yard10_flag = 10
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard10 334.6789 -338.7348 1.0 1.0 0
				IF c_site_area_flag = 5
					SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard10 TRUE
					IF IS_PLAYER_IN_ANY_CAR player
						STORE_CAR_PLAYER_IS_IN player players_vehicle
						SET_CHAR_OBJ_DESTROY_CAR goon_at_yard10	players_vehicle
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard10 player
					ENDIF
				ELSE
					SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard10 FALSE
					SET_CHAR_OBJ_RUN_TO_COORD goon_at_yard10 360.2491 -336.6913
					goon_at_yard10_flag = 11
				ENDIF
			ENDIF
		ENDIF
		IF goon_at_yard10_flag = 11
			IF LOCATE_STOPPED_CHAR_ON_FOOT_2D goon_at_yard10 360.2491 -336.6913 1.0 1.0 0
				SET_CHAR_STAY_IN_SAME_PLACE	goon_at_yard10 TRUE
				IF IS_PLAYER_IN_ANY_CAR player
					STORE_CAR_PLAYER_IS_IN player players_vehicle
					SET_CHAR_OBJ_DESTROY_CAR goon_at_yard10	players_vehicle
				ELSE
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT goon_at_yard10 player
				ENDIF
			ENDIF
		ENDIF
	ENDIF// IS_CHAR_DEAD goon_at_yard10
ENDIF
RETURN
///////////////////////////////////////////////////////////////////////////////
}
MISSION_START
// *****************************************************************************************
// ********************************		Love 5 	   *****************************************
// ********************************	Escort Service ***************************************** 
// *****************************************************************************************
// *** The packages and the OJG need transporting to the <destination>. The player must  ***
// *** escort the van. The van will be attacked en-route by the Cartel, the player must  ***
// *** fight off any attackers and protect the van at all costs.						 ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_love5

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_love5_failed
ENDIF

GOSUB mission_cleanup_love5

MISSION_END
 
// Variables for mission

VAR_INT escort_truck truck_driver escort_truck_blip escort_truck_health escort_truck_flag ojg 
VAR_INT columbian_humvee1 columbian_humvee2 columbian_humvee3 columbian_driver_1 columbian_driver_2 columbian_driver_3
VAR_INT car1_attacking_flag	car2_attacking_flag car3_attacking_flag	tank_weapon	escort_truck_health2
VAR_INT colombian_1 colombian_2 colombian_3 colombian_4 colombian_5 colombian_6 colombian_7 colombian_8 colombian_9 colombian_10
VAR_INT colombian_1_flag colombian_2_flag colombian_3_flag colombian_4_flag colombian_5_flag colombian_6_flag colombian_7_flag colombian_8_flag colombian_9_flag colombian_10_flag
VAR_INT columbian_hitman_1 columbian_hitman_2 columbian_hitman_3 columbian_hitman_4	columbian_hitman_5 
VAR_INT columbian_hitman_6 columbian_hitman_7 columbian_hitman_8 columbian_hitman_9 dummy_health
VAR_INT car4_attacking_flag columbian_driver_4 columbian_hitman_10 columbian_hitman_11 columbian_hitman_12 columbian_humvee4

VAR_FLOAT escort_truck_speed columbian_humvee1_speed columbian_humvee2_speed columbian_humvee3_speed columbian_humvee4_speed

// ****************************************Mission Start************************************

mission_start_love5:

flag_player_on_mission 		= 1
flag_player_on_love_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

SCRIPT_NAME love5

car1_attacking_flag	= 0
car2_attacking_flag	= 0
car3_attacking_flag = 0
car4_attacking_flag = 0
escort_truck_flag = 0
colombian_1_flag = 0
colombian_2_flag = 0
colombian_3_flag = 0
colombian_4_flag = 0
dummy_health = 2000

// ****************************************START OF CUTSCENE********************************

//SET_FADING_COLOUR 0 0 0
//
//DO_FADE 1500 FADE_OUT
//
//IF CAN_PLAYER_START_MISSION player
//	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
//ELSE
//	GOTO mission_love5_failed
//ENDIF
//
//PRINT_BIG LOVE5 15000 2 

LOAD_SPECIAL_CHARACTER 1 love
REQUEST_MODEL tshrorckgrdn
REQUEST_MODEL tshrorckgrdn_alfas
LOAD_SPECIAL_MODEL cut_obj1 LOVEH

SWITCH_STREAMING OFF

//WHILE GET_FADING_STATUS
//	WAIT 0
//ENDWHILE

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED tshrorckgrdn
OR NOT HAS_MODEL_LOADED tshrorckgrdn_alfas
OR NOT HAS_MODEL_LOADED cut_obj1
	WAIT 0
ENDWHILE

LOAD_CUTSCENE D5_ES

SET_CUTSCENE_OFFSET 85.2162 -1532.9093 243.5422

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_love
SET_CUTSCENE_ANIM cs_love love

CREATE_CUTSCENE_HEAD cs_love cut_obj1 cs_lovehead
SET_CUTSCENE_HEAD_ANIM cs_lovehead love

CLEAR_AREA 82.44 -1548.49 28.0 2.0 TRUE

SET_PLAYER_COORDINATES player 82.44 -1548.49 28.0

SET_PLAYER_HEADING player 90.0

DO_FADE 1500 FADE_IN

START_CUTSCENE

SWITCH_RUBBISH OFF

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 1324
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE5_A 5000 1//"You are proving to be a safe investment, a rare thing these days."

WHILE cs_time < 6061
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT LOVE5_B 5000 1//"My Oriental friend will need an escort while he takes my latest acquisition to be authenticated."

WHILE cs_time < 10660
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT LOVE5_C 5000 1//"I want you to follow him, and make sure he and my package get to Pike Creek unharmed."

WHILE cs_time < 17500
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

SWITCH_RUBBISH ON

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

DO_FADE 0 FADE_OUT

SET_CAMERA_BEHIND_PLAYER

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn
MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn_alfas
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1

REQUEST_MODEL CAR_SECURICAR 
REQUEST_MODEL CAR_COLUMB
REQUEST_MODEL PED_GANG_COLOMBIAN_A
LOAD_SPECIAL_CHARACTER 2 OJG
LOAD_SPECIAL_CHARACTER 3 S_GUARD

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_A
OR NOT HAS_MODEL_LOADED CAR_COLUMB
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_SPECIAL_CHARACTER_LOADED 3
OR NOT HAS_MODEL_LOADED CAR_SECURICAR
	WAIT 0
ENDWHILE

SWITCH_STREAMING ON

DO_FADE 1500 FADE_IN 

// ******************************************END OF CUTSCENE********************************

CREATE_CAR CAR_SECURICAR 83.6 -1592.3 25.1 escort_truck
CHANGE_CAR_COLOUR escort_truck 0 0

IF IS_CAR_DEAD escort_truck
	PRINT_NOW LOVE5_5 5000 1 //"You failed to protect the truck!"
	GOTO mission_love5_failed
ENDIF
CREATE_CHAR_INSIDE_CAR escort_truck PEDTYPE_SPECIAL PED_SPECIAL3 truck_driver
CREATE_CHAR_AS_PASSENGER escort_truck PEDTYPE_SPECIAL PED_SPECIAL2 0 ojg
SET_CHAR_CANT_BE_DRAGGED_OUT truck_driver TRUE
LOCK_CAR_DOORS escort_truck CARLOCK_LOCKED
SET_CAR_HEADING escort_truck 180.0
SET_CAR_DRIVING_STYLE escort_truck 2
SET_CAR_CRUISE_SPEED escort_truck 18.0
CAR_SET_IDLE escort_truck
SET_CAR_STRONG escort_truck TRUE
SET_CAR_PROOFS escort_truck FALSE FALSE TRUE FALSE FALSE
//SET_CAR_HEALTH escort_truck 2000
ADD_BLIP_FOR_CAR escort_truck escort_truck_blip

CREATE_PICKUP_WITH_AMMO WEAPON_M16 PICKUP_ONCE 600 77.6708 -1589.0255 27.5 tank_weapon

WHILE NOT LOCATE_PLAYER_IN_CAR_CAR_2D player escort_truck 15.0 15.0 0
OR NOT IS_POINT_ON_SCREEN 83.6 -1592.3 25.1 4.0 

	WAIT 0

	IF IS_CAR_DEAD escort_truck
		PRINT_NOW LOVE5_5 5000 1 //"You failed to protect the truck!"
		GOTO mission_love5_failed
	ENDIF

	IF LOCATE_PLAYER_ON_FOOT_CAR_2D	player escort_truck 15.0 15.0 0
		PRINT_NOW LOVE5_2 5000 1 //"You'll need a car!"
	ENDIF

	IF LOCATE_PLAYER_ON_FOOT_CAR_2D	player escort_truck 1.0 1.0 0
	AND IS_PLAYER_STOPPED player
		GOTO car_goto_bit
	ENDIF

ENDWHILE

car_goto_bit:

CAR_GOTO_COORDINATES escort_truck 173.4898 76.3099 14.9781

PRINT_NOW LOVE5_1 5000 1 //"Lets go!"

GET_CAR_HEALTH escort_truck escort_truck_health
IF dummy_health > 499
	IF escort_truck_health < 500
		escort_truck_health += 500
		SET_CAR_HEALTH escort_truck escort_truck_health
		dummy_health -= 500
	ENDIF
ENDIF
GET_CAR_HEALTH escort_truck escort_truck_health
escort_truck_health += dummy_health
escort_truck_health = escort_truck_health / 3
escort_truck_health = escort_truck_health - 250
escort_truck_health = escort_truck_health * 100
escort_truck_health = escort_truck_health / 750
escort_truck_health2 = escort_truck_health
escort_truck_health = 100 - escort_truck_health2
DISPLAY_ONSCREEN_COUNTER_WITH_STRING escort_truck_health COUNTER_DISPLAY_BAR DAM

WHILE NOT escort_truck_flag = 11
	
	WAIT 0
	
    IF IS_CAR_DEAD escort_truck
		PRINT_NOW LOVE5_5 5000 1 //"You failed to protect the truck!"
    	GOTO mission_love5_failed
    ELSE
		IF IS_CAR_UPSIDEDOWN escort_truck
		AND IS_CAR_STOPPED escort_truck
	    	GOTO mission_love5_failed
		ENDIF
//    	IF NOT LOCATE_PLAYER_ANY_MEANS_CAR_2D player escort_truck 220.0 220.0 0
//    		PRINT_NOW LOVE5_4 500 1 //"Get back to the truck and defend it!"
//    		GET_CAR_HEALTH escort_truck escort_truck_health
//    		escort_truck_health -= 3
//			IF escort_truck_health < 1
//				escort_truck_health = 1
//				EXPLODE_CAR escort_truck
//			ELSE
//    			SET_CAR_HEALTH escort_truck escort_truck_health
//			ENDIF
//		ENDIF
    ENDIF

    GET_CAR_HEALTH escort_truck escort_truck_health
	IF dummy_health > 499
		IF escort_truck_health < 500
			escort_truck_health += 500
			SET_CAR_HEALTH escort_truck escort_truck_health
			dummy_health -= 500
		ENDIF
	ENDIF
    GET_CAR_HEALTH escort_truck escort_truck_health
	escort_truck_health += dummy_health
	escort_truck_health = escort_truck_health / 3
	escort_truck_health = escort_truck_health - 250
	escort_truck_health = escort_truck_health * 100
	escort_truck_health = escort_truck_health / 750
	escort_truck_health2 = escort_truck_health
	escort_truck_health = 100 - escort_truck_health2
	IF escort_truck_health > 100
		escort_truck_health = 100
	ENDIF
	
	IF escort_truck_flag = 0
		IF LOCATE_CAR_2D escort_truck 173.4898 76.3099 10.0 10.0 0	//out front of hospital
			CAR_GOTO_COORDINATES escort_truck 559.5281 88.7876 -21.0725
			escort_truck_flag = 1
		ENDIF
	ENDIF

	IF escort_truck_flag = 1
		IF LOCATE_CAR_2D escort_truck 302.0435 -12.4083 10.0 10.0 0//291.4709 8.6224 10.0 10.0 0
			SET_CAR_IGNORE_LEVEL_TRANSITIONS escort_truck TRUE
			IF NOT IS_CHAR_DEAD	ojg
				SET_CHAR_STAYS_IN_CURRENT_LEVEL ojg FALSE
			ENDIF
			IF NOT IS_CHAR_DEAD	truck_driver
				SET_CHAR_STAYS_IN_CURRENT_LEVEL truck_driver FALSE
			ENDIF
			SET_CAR_DRIVING_STYLE escort_truck	1
			SET_CAR_DENSITY_MULTIPLIER 0.5
		ENDIF	
	ENDIF	

	IF escort_truck_flag = 1
		IF LOCATE_CAR_2D escort_truck 559.5281 88.7876 10.0 10.0 0	 //first junction in tunnel
			CAR_GOTO_COORDINATES escort_truck -320.4337 87.1647 -21.0725
			escort_truck_flag =	2
		ENDIF
	ENDIF

	IF escort_truck_flag = 2
		IF LOCATE_CAR_2D escort_truck -320.4337 87.1647 10.0 10.0 0  //before airport junction	in tunnel
			CAR_GOTO_COORDINATES escort_truck -573.8346 -426.376 -5.76
			escort_truck_flag =	3
		ENDIF
	ENDIF

	IF escort_truck_flag = 3
		IF LOCATE_CAR_2D escort_truck -573.8346 -426.376 10.0 10.0 0  //Before sububan collision loadup
			IF NOT IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
				PRINT_NOW LOVE5_3 200 1 //"Go ahead to scout the tunnel exit!"
			ELSE
				escort_truck_flag =	4
			ENDIF
		ENDIF
	ENDIF

	IF escort_truck_flag = 4
		IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
			CAR_GOTO_COORDINATES escort_truck -634.9936 -491.1914 16.1379
			escort_truck_flag = 5
		ENDIF
	ENDIF

	IF escort_truck_flag = 5
		IF LOCATE_CAR_2D escort_truck -634.9936 -491.1914 10.0 10.0 0 //at mouth of tunnel at airport
			CAR_GOTO_COORDINATES escort_truck -864.45 -282.45 32.5
			SET_CAR_IGNORE_LEVEL_TRANSITIONS escort_truck FALSE
			SET_CAR_STAYS_IN_CURRENT_LEVEL escort_truck TRUE
			IF NOT IS_CHAR_DEAD	ojg
				SET_CHAR_STAYS_IN_CURRENT_LEVEL ojg TRUE
			ENDIF
			IF NOT IS_CHAR_DEAD	truck_driver
				SET_CHAR_STAYS_IN_CURRENT_LEVEL truck_driver TRUE
			ENDIF
			SET_CAR_DRIVING_STYLE escort_truck	2
			SET_CAR_DENSITY_MULTIPLIER 1.0
			escort_truck_flag =	6
		ENDIF
	ENDIF

	IF escort_truck_flag = 6
		IF LOCATE_CAR_2D escort_truck -864.45 -282.45 10.0 10.0 0
			CAR_GOTO_COORDINATES escort_truck -975.1670 -74.5367 36.9677
			escort_truck_flag =	7
		ENDIF
	ENDIF

	IF escort_truck_flag = 7
		IF LOCATE_CAR_2D escort_truck -975.1670 -74.5367 10.0 10.0 0 //before junction at warehouse
			GOSUB call_off_the_attackers
			CAR_GOTO_COORDINATES_ACCURATE escort_truck -1044.0 -73.4361 37.8615 // inside garage
			SET_CAR_CRUISE_SPEED escort_truck 12.0
			escort_truck_flag =	8
		ENDIF
	ENDIF

	IF escort_truck_flag = 8
		IF IS_CAR_IN_AREA_2D escort_truck -1022.11 -78.28 -1037.21 -69.17 0 //outside garage
			OPEN_GARAGE escort_garage
			SET_CAR_CRUISE_SPEED escort_truck 5.0
			escort_truck_flag =	9
		ENDIF
	ENDIF

	IF escort_truck_flag = 9
		IF IS_CAR_STOPPED_IN_AREA_2D escort_truck -1049.17 -77.47 -1037.21 -69.17 0
			IF NOT IS_PLAYER_IN_AREA_2D player	-1049.17 -77.47 -1037.21 -69.17 0
				CLOSE_GARAGE escort_garage
				escort_truck_flag =	10
			ENDIF
		ENDIF
	ENDIF

	IF escort_truck_flag = 10
		IF IS_PLAYER_IN_AREA_2D player	-1049.17 -77.47 -1037.21 -69.17 0
			OPEN_GARAGE	escort_garage
			escort_truck_flag = 9
		ENDIF
		IF IS_GARAGE_CLOSED	escort_garage
			DELETE_CAR escort_truck
			GOTO mission_love5_passed
			escort_truck_flag =	11
		ENDIF
	ENDIF

	////////	
IF escort_truck_flag < 9
	IF colombian_1_flag = 0
		IF LOCATE_PLAYER_ANY_MEANS_2D player -13.0 -464.0 220.0 220.0 0	//South of Park Dude 1
		OR LOCATE_CAR_2D escort_truck -13.0 -464.0 220.0 220.0 0
			CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -13.0 -464.0 17.0 colombian_1
			SET_CHAR_HEADING colombian_1 270.0
			GIVE_WEAPON_TO_CHAR colombian_1 WEAPONTYPE_CHAINGUN 9999
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER	colombian_1 TRUE
			CHAR_SET_IDLE colombian_1
			SET_CHAR_PERSONALITY colombian_1 PEDSTAT_TOUGH_GUY
			SET_CHAR_THREAT_SEARCH colombian_1 THREAT_PLAYER1
			SET_CHAR_STAY_IN_SAME_PLACE colombian_1 TRUE
			colombian_1_flag = 1
		ENDIF
	ENDIF

	IF colombian_1_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -13.0 -464.0 220.0 220.0 0
		OR NOT LOCATE_CAR_2D escort_truck -13.0 -464.0 220.0 220.0 0
			DELETE_CHAR colombian_1
			colombian_1_flag = 0
		ENDIF
	ENDIF

	IF colombian_1_flag = 1
		IF IS_CHAR_DEAD colombian_1			
			colombian_1_flag = 2
		ELSE
			IF LOCATE_CHAR_ANY_MEANS_CAR_2D colombian_1 escort_truck 40.0 40.0 0
				SET_CHAR_OBJ_DESTROY_CAR colombian_1 escort_truck
			ENDIF
		ENDIF
	ENDIF

	////////	

	IF colombian_2_flag = 0
		IF LOCATE_PLAYER_ANY_MEANS_2D player 3.7 -467.7 220.0 220.0 0 //South of Park Dude 2
		OR LOCATE_CAR_2D escort_truck 3.7 -467.7 220.0 220.0 0
			CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 3.7 -467.7 17.0 colombian_2
			SET_CHAR_HEADING colombian_2 85.0
			GIVE_WEAPON_TO_CHAR colombian_2 WEAPONTYPE_CHAINGUN 9999
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER	colombian_2 TRUE
			CHAR_SET_IDLE colombian_2
			SET_CHAR_PERSONALITY colombian_2 PEDSTAT_TOUGH_GUY
			SET_CHAR_THREAT_SEARCH colombian_2 THREAT_PLAYER1
			SET_CHAR_STAY_IN_SAME_PLACE colombian_2 TRUE
			colombian_2_flag = 1
		ENDIF
	ENDIF

	IF colombian_2_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player 3.7 -467.7 220.0 220.0 0
		OR NOT LOCATE_CAR_2D escort_truck 3.7 -467.7 220.0 220.0 0
			DELETE_CHAR colombian_2
			colombian_2_flag = 0
		ENDIF
	ENDIF

	IF colombian_2_flag = 1
		IF IS_CHAR_DEAD colombian_2			
			colombian_2_flag = 2
		ELSE
			IF LOCATE_CHAR_ANY_MEANS_CAR_2D colombian_2 escort_truck 40.0 40.0 0
				SET_CHAR_OBJ_DESTROY_CAR colombian_2 escort_truck
			ENDIF
		ENDIF
	ENDIF
	
	////////	

	IF colombian_3_flag = 0
		IF LOCATE_PLAYER_ANY_MEANS_2D player 124.4 -111.2 220.0 220.0 0	//By the university
		OR LOCATE_CAR_2D escort_truck 124.4 -111.2 220.0 220.0 0
			CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 124.4 -111.2 16.0 colombian_3
			SET_CHAR_HEADING colombian_3 85.0
			GIVE_WEAPON_TO_CHAR colombian_3 WEAPONTYPE_CHAINGUN 9999
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER	colombian_3 TRUE
			CHAR_SET_IDLE colombian_3
			SET_CHAR_PERSONALITY colombian_3 PEDSTAT_TOUGH_GUY
			SET_CHAR_THREAT_SEARCH colombian_3 THREAT_PLAYER1
			SET_CHAR_STAY_IN_SAME_PLACE colombian_3 TRUE
			colombian_3_flag = 1
		ENDIF
	ENDIF

	IF colombian_3_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player 124.4 -111.2 220.0 220.0 0
		OR NOT LOCATE_CAR_2D escort_truck 124.4 -111.2 220.0 220.0 0
			DELETE_CHAR colombian_3
			colombian_3_flag = 0
		ENDIF
	ENDIF

	IF colombian_3_flag = 1
		IF IS_CHAR_DEAD colombian_3
			colombian_3_flag = 2
		ELSE
			IF LOCATE_CHAR_ANY_MEANS_CAR_2D colombian_3 escort_truck 40.0 40.0 0
				SET_CHAR_OBJ_DESTROY_CAR colombian_3 escort_truck
			ENDIF
		ENDIF
	ENDIF
	
	////////	

	IF colombian_4_flag = 0
		IF LOCATE_PLAYER_ANY_MEANS_2D player 8.65 -262.74 220.0 220.0 0	//On the Stadium steps
		OR LOCATE_CAR_2D escort_truck 8.65 -262.74 220.0 220.0 0
			CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 8.65 -262.74 16.0 colombian_4
			SET_CHAR_HEADING colombian_4 163.0
			GIVE_WEAPON_TO_CHAR colombian_4 WEAPONTYPE_CHAINGUN 9999
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER	colombian_4 TRUE
			CHAR_SET_IDLE colombian_4
			SET_CHAR_PERSONALITY colombian_4 PEDSTAT_TOUGH_GUY
			SET_CHAR_THREAT_SEARCH colombian_4 THREAT_PLAYER1
			SET_CHAR_STAY_IN_SAME_PLACE colombian_4 TRUE
			colombian_4_flag = 1
		ENDIF
	ENDIF

	IF colombian_4_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player 8.65 -262.74 220.0 220.0 0
		OR NOT LOCATE_CAR_2D escort_truck 8.65 -262.74 220.0 220.0 0
			DELETE_CHAR colombian_4
			colombian_4_flag = 0
		ENDIF
	ENDIF

	IF colombian_4_flag = 1
		IF IS_CHAR_DEAD colombian_4
			colombian_4_flag = 2
		ELSE
			IF LOCATE_CHAR_ANY_MEANS_CAR_2D colombian_4 escort_truck 40.0 40.0 0
				SET_CHAR_OBJ_DESTROY_CAR colombian_4 escort_truck
			ENDIF
		ENDIF
	ENDIF
	
	////////	

	IF colombian_5_flag = 0
		IF LOCATE_PLAYER_ANY_MEANS_2D player 287.5946 17.6184 220.0 220.0 0	// On entrance to tunnel commercial
		OR LOCATE_CAR_2D escort_truck 287.5946 17.6184 220.0 220.0 0
			CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 287.5946 17.6184 19.0714 colombian_5
			SET_CHAR_HEADING colombian_5 0.0
			GIVE_WEAPON_TO_CHAR colombian_5 WEAPONTYPE_CHAINGUN 9999
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER	colombian_5 TRUE
			CHAR_SET_IDLE colombian_5
			SET_CHAR_PERSONALITY colombian_5 PEDSTAT_TOUGH_GUY
			SET_CHAR_THREAT_SEARCH colombian_5 THREAT_PLAYER1
			SET_CHAR_STAY_IN_SAME_PLACE colombian_5 TRUE
			colombian_5_flag = 1
		ENDIF
	ENDIF

	IF colombian_5_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player 287.5946 17.6184 220.0 220.0 0
		OR NOT LOCATE_CAR_2D escort_truck 287.5946 17.6184 220.0 220.0 0
			DELETE_CHAR colombian_5
			colombian_5_flag = 0
		ENDIF
	ENDIF

	IF colombian_5_flag = 1
		IF IS_CHAR_DEAD colombian_5
			colombian_5_flag = 2
		ELSE
			IF LOCATE_CHAR_ANY_MEANS_CAR_2D colombian_5 escort_truck 40.0 40.0 0
				SET_CHAR_OBJ_DESTROY_CAR colombian_5 escort_truck
			ENDIF
		ENDIF
	ENDIF
	
	////////	

	IF colombian_6_flag = 0
		IF LOCATE_PLAYER_ANY_MEANS_2D player 537.7727 119.5505 220.0 220.0 0 // In tunnel at first junction
		OR LOCATE_CAR_2D escort_truck 537.7727 119.5505 220.0 220.0 0
			CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 537.7727 119.5505 -20.3699 colombian_6
			SET_CHAR_HEADING colombian_6 238.1071
			GIVE_WEAPON_TO_CHAR colombian_6 WEAPONTYPE_CHAINGUN 9999
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER	colombian_6 TRUE
			CHAR_SET_IDLE colombian_6
			SET_CHAR_PERSONALITY colombian_6 PEDSTAT_TOUGH_GUY
			SET_CHAR_THREAT_SEARCH colombian_6 THREAT_PLAYER1
			SET_CHAR_STAY_IN_SAME_PLACE colombian_6 TRUE
			colombian_6_flag = 1
		ENDIF
	ENDIF

	IF colombian_6_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player 537.7727 119.5505 220.0 220.0 0
		OR NOT LOCATE_CAR_2D escort_truck 537.7727 119.5505 220.0 220.0 0
			DELETE_CHAR colombian_6
			colombian_6_flag = 0
		ENDIF
	ENDIF

	IF colombian_6_flag = 1
		IF IS_CHAR_DEAD colombian_6
			colombian_6_flag = 2
		ELSE
			IF LOCATE_CHAR_ANY_MEANS_CAR_2D colombian_6 escort_truck 40.0 40.0 0
				SET_CHAR_OBJ_DESTROY_CAR colombian_6 escort_truck
			ENDIF
		ENDIF
	ENDIF
	
	////////	

	IF escort_truck_flag > 4
		IF colombian_7_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -632.9545 -499.5869 220.0 220.0 0 // On top of the exit tunnel by airport
			OR LOCATE_CAR_2D escort_truck -632.9545 -499.5869 220.0 220.0 0
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -632.9545 -499.5869 22.3742 colombian_7
				SET_CHAR_HEADING colombian_7 15.2319
				GIVE_WEAPON_TO_CHAR colombian_7 WEAPONTYPE_CHAINGUN 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	colombian_7 TRUE
				CHAR_SET_IDLE colombian_7
				SET_CHAR_PERSONALITY colombian_7 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH colombian_7 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE colombian_7 TRUE
				colombian_7_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF colombian_7_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -632.9545 -499.5869 220.0 220.0 0
		OR NOT LOCATE_CAR_2D escort_truck -632.9545 -499.5869 220.0 220.0 0
			DELETE_CHAR colombian_7
			colombian_7_flag = 0
		ENDIF
	ENDIF

	IF colombian_7_flag = 1
		IF IS_CHAR_DEAD colombian_7
			colombian_7_flag = 2
		ELSE
			IF LOCATE_CHAR_ANY_MEANS_CAR_2D colombian_7 escort_truck 40.0 40.0 0
				SET_CHAR_OBJ_DESTROY_CAR colombian_7 escort_truck
			ENDIF
		ENDIF
	ENDIF
	
	////////	

	IF colombian_8_flag = 0
		IF LOCATE_PLAYER_ANY_MEANS_2D player -982.5755 -115.7109 220.0 220.0 0 // By the warehouse
		OR LOCATE_CAR_2D escort_truck -982.5755 -115.7109 220.0 220.0 0
			CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -982.5755 -115.7109 33.0045 colombian_8
			SET_CHAR_HEADING colombian_8 234.9669
			GIVE_WEAPON_TO_CHAR colombian_8 WEAPONTYPE_CHAINGUN 9999
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER	colombian_8 TRUE
			CHAR_SET_IDLE colombian_8
			SET_CHAR_PERSONALITY colombian_8 PEDSTAT_TOUGH_GUY
			SET_CHAR_THREAT_SEARCH colombian_8 THREAT_PLAYER1
			SET_CHAR_STAY_IN_SAME_PLACE colombian_8 TRUE
			colombian_8_flag = 1
		ENDIF
	ENDIF

	IF colombian_8_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -982.5755 -115.7109 220.0 220.0 0
		OR NOT LOCATE_CAR_2D escort_truck -982.5755 -115.7109 220.0 220.0 0
			DELETE_CHAR colombian_8
			colombian_8_flag = 0
		ENDIF
	ENDIF

	IF colombian_8_flag = 1
		IF IS_CHAR_DEAD colombian_8
			colombian_8_flag = 2
		ELSE
			IF LOCATE_CHAR_ANY_MEANS_CAR_2D colombian_8 escort_truck 40.0 40.0 0
				SET_CHAR_OBJ_DESTROY_CAR colombian_8 escort_truck
			ENDIF
		ENDIF
	ENDIF
	
	////////	

	IF colombian_9_flag = 0
		IF LOCATE_PLAYER_ANY_MEANS_2D player -967.8587 -103.2732 220.0 220.0 0 // By the warehouse
		OR LOCATE_CAR_2D escort_truck -967.8587 -103.2732 220.0 220.0 0
			CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -967.8587 -103.2732 34.2468 colombian_9
			SET_CHAR_HEADING colombian_9 110.3819
			GIVE_WEAPON_TO_CHAR colombian_9 WEAPONTYPE_CHAINGUN 9999
			SET_CHAR_ONLY_DAMAGED_BY_PLAYER	colombian_9 TRUE
			CHAR_SET_IDLE colombian_9
			SET_CHAR_PERSONALITY colombian_9 PEDSTAT_TOUGH_GUY
			SET_CHAR_THREAT_SEARCH colombian_9 THREAT_PLAYER1
			SET_CHAR_STAY_IN_SAME_PLACE colombian_9 TRUE
			colombian_9_flag = 1
		ENDIF
	ENDIF

	IF colombian_9_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -967.8587 -103.2732 220.0 220.0 0
		OR NOT LOCATE_CAR_2D escort_truck -967.8587 -103.2732 220.0 220.0 0
			DELETE_CHAR colombian_9
			colombian_9_flag = 0
		ENDIF
	ENDIF

	IF colombian_9_flag = 1
		IF IS_CHAR_DEAD colombian_9
			colombian_9_flag = 2
		ELSE
			IF LOCATE_CHAR_ANY_MEANS_CAR_2D colombian_9 escort_truck 40.0 40.0 0
				SET_CHAR_OBJ_DESTROY_CAR colombian_9 escort_truck
			ENDIF
		ENDIF
	ENDIF
	
	////////	

	IF escort_truck_flag > 4
		IF colombian_10_flag = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player -655.9044 -405.6324 220.0 220.0 0 // On central reservation by airport
			OR LOCATE_CAR_2D escort_truck -655.9044 -405.6324 220.0 220.0 0
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -655.9044 -405.6324 17.8121 colombian_10
				SET_CHAR_HEADING colombian_10 234.7831
				GIVE_WEAPON_TO_CHAR colombian_10 WEAPONTYPE_CHAINGUN 9999
				SET_CHAR_ONLY_DAMAGED_BY_PLAYER	colombian_10 TRUE
				CHAR_SET_IDLE colombian_10
				SET_CHAR_PERSONALITY colombian_10 PEDSTAT_TOUGH_GUY
				SET_CHAR_THREAT_SEARCH colombian_10 THREAT_PLAYER1
				SET_CHAR_STAY_IN_SAME_PLACE colombian_10 TRUE
				colombian_10_flag = 1
			ENDIF
		ENDIF
	ENDIF

	IF colombian_10_flag = 1
		IF NOT LOCATE_PLAYER_ANY_MEANS_2D player -655.9044 -405.6324 220.0 220.0 0
		OR NOT LOCATE_CAR_2D escort_truck -655.9044 -405.6324 220.0 220.0 0
			DELETE_CHAR colombian_10
			colombian_10_flag = 0
		ENDIF
	ENDIF

	IF colombian_10_flag = 1
		IF IS_CHAR_DEAD colombian_10
			colombian_10_flag = 2
		ELSE
			IF LOCATE_CHAR_ANY_MEANS_CAR_2D colombian_10 escort_truck 40.0 40.0 0
				SET_CHAR_OBJ_DESTROY_CAR colombian_10 escort_truck
			ENDIF
		ENDIF
	ENDIF
	
	////////
	
	IF car1_attacking_flag = 0
    	IF LOCATE_CAR_2D escort_truck 41.0 -1070.0 40.0 40.0 0
			
			IF NOT IS_POINT_ON_SCREEN 122.0 -1099.0 26.0 4.0
				CREATE_CAR CAR_COLUMB 122.0 -1099.0 26.0 columbian_humvee1
				SET_CAR_HEADING columbian_humvee1 65.0
			ELSE
				CREATE_CAR CAR_COLUMB -50.0 -1021.0 26.0 columbian_humvee1
				SET_CAR_HEADING columbian_humvee1 240.0
			ENDIF

			SET_CAR_STAYS_IN_CURRENT_LEVEL columbian_humvee1 FALSE
			CREATE_CHAR_INSIDE_CAR columbian_humvee1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A columbian_driver_1
			CREATE_CHAR_AS_PASSENGER columbian_humvee1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 0 columbian_hitman_1
			CREATE_CHAR_AS_PASSENGER columbian_humvee1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1 columbian_hitman_3
			CREATE_CHAR_AS_PASSENGER columbian_humvee1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 2 columbian_hitman_5
			SET_CAR_CRUISE_SPEED columbian_humvee1 40.0
			SET_CAR_HEALTH columbian_humvee1 650
			SET_CAR_DRIVING_STYLE columbian_humvee1 2
			SET_CAR_DRIVING_STYLE escort_truck 2
			SET_CAR_CRUISE_SPEED escort_truck 25.0
			CAR_SET_IDLE columbian_humvee1
    		SET_CAR_BLOCK_CAR columbian_humvee1 escort_truck
			car1_attacking_flag = 1
    	ENDIF
	ENDIF

	IF car1_attacking_flag > 0
		IF IS_CAR_DEAD columbian_humvee1
			car1_attacking_flag = -100
		ELSE
			IF NOT IS_CHAR_DEAD	columbian_driver_1
				IF NOT IS_CHAR_IN_CAR columbian_driver_1 columbian_humvee1
					GIVE_WEAPON_TO_CHAR	columbian_driver_1 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_driver_1	escort_truck
				ENDIF
			ENDIF
			IF IS_PLAYER_IN_CAR player columbian_humvee1
				IF NOT IS_CHAR_DEAD columbian_hitman_1
					GIVE_WEAPON_TO_CHAR	columbian_hitman_1 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_1 player
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_3
					GIVE_WEAPON_TO_CHAR	columbian_hitman_3 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_3 player
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_5
					GIVE_WEAPON_TO_CHAR	columbian_hitman_5 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_5 player
				ENDIF
			ENDIF
			IF IS_CAR_UPSIDEDOWN columbian_humvee1
			AND IS_CAR_STOPPED columbian_humvee1
				IF NOT IS_CHAR_DEAD columbian_driver_1
					GIVE_WEAPON_TO_CHAR	columbian_driver_1 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_driver_1	escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_1
					GIVE_WEAPON_TO_CHAR	columbian_hitman_1 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_1 escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_3
					GIVE_WEAPON_TO_CHAR	columbian_hitman_3 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_3 escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_5
					GIVE_WEAPON_TO_CHAR	columbian_hitman_5 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_5 escort_truck
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF car1_attacking_flag = 1
		IF NOT IS_CHAR_DEAD columbian_hitman_1
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee1 columbian_humvee1_speed
			IF columbian_humvee1_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_1 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_1 columbian_humvee1
					SET_CHAR_RUNNING columbian_hitman_1 TRUE
					car1_attacking_flag = 2
				ENDIF
			ENDIF
		ELSE
			car1_attacking_flag = 2
		ENDIF
	ENDIF

	IF car1_attacking_flag = 2
		IF NOT IS_CHAR_DEAD columbian_hitman_1
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_1
				GIVE_WEAPON_TO_CHAR columbian_hitman_1 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_1	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee1 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee1 escort_truck
				car1_attacking_flag = 3
			ENDIF
		ELSE
			car1_attacking_flag = 3
		ENDIF
	ENDIF

	IF car1_attacking_flag = 3
		IF NOT IS_CHAR_DEAD columbian_hitman_3
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee1 columbian_humvee1_speed
			IF columbian_humvee1_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_3 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_3 columbian_humvee1
					SET_CHAR_RUNNING columbian_hitman_3 TRUE
					car1_attacking_flag = 4
				ENDIF
			ENDIF
		ELSE
			car1_attacking_flag = 4
		ENDIF
	ENDIF

	IF car1_attacking_flag = 4
		IF NOT IS_CHAR_DEAD columbian_hitman_3
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_3
				GIVE_WEAPON_TO_CHAR columbian_hitman_3 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_3	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee1 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee1 escort_truck
				car1_attacking_flag = 5
			ENDIF
		ELSE
			car1_attacking_flag = 5
		ENDIF
	ENDIF

	IF car1_attacking_flag = 5
		IF NOT IS_CHAR_DEAD columbian_hitman_5
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee1 columbian_humvee1_speed
			IF columbian_humvee1_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_5 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_5 columbian_humvee1
					SET_CHAR_RUNNING columbian_hitman_5 TRUE
					car1_attacking_flag = 6
				ENDIF
			ENDIF
		ELSE
			car1_attacking_flag = 6
		ENDIF
	ENDIF

	IF car1_attacking_flag = 6
		IF NOT IS_CHAR_DEAD columbian_hitman_5
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_5
				GIVE_WEAPON_TO_CHAR columbian_hitman_5 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_5	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee1 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee1 escort_truck
				car1_attacking_flag = 7
			ENDIF
		ELSE
			car1_attacking_flag = 7
		ENDIF
	ENDIF

	IF car1_attacking_flag = 7
		SET_CAR_CRUISE_SPEED columbian_humvee1 40.0
		SET_CAR_RAM_CAR columbian_humvee1 escort_truck
		car1_attacking_flag = 8
	ENDIF
	
	 ////////////////////////////////////

	IF car2_attacking_flag = 0
    	IF LOCATE_CAR_2D escort_truck 2.0 -405.0 40.0 40.0 0
			
			IF NOT IS_POINT_ON_SCREEN -86.0 -409.0 16.0 4.0
				CREATE_CAR CAR_COLUMB -86.0 -409.0 16.0 columbian_humvee2
				SET_CAR_HEADING columbian_humvee2 270.0
			ELSE
				CREATE_CAR CAR_COLUMB -100.0 -409.0 16.0 columbian_humvee2
				SET_CAR_HEADING columbian_humvee2 90.0
			ENDIF
			
			SET_CAR_STAYS_IN_CURRENT_LEVEL columbian_humvee2 FALSE
			CREATE_CHAR_INSIDE_CAR columbian_humvee2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A columbian_driver_2
			CREATE_CHAR_AS_PASSENGER columbian_humvee2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 0 columbian_hitman_2
			CREATE_CHAR_AS_PASSENGER columbian_humvee2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1 columbian_hitman_4
			CREATE_CHAR_AS_PASSENGER columbian_humvee2 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 2 columbian_hitman_6
			SET_CAR_CRUISE_SPEED columbian_humvee2 40.0
			SET_CAR_DRIVING_STYLE columbian_humvee2 2
			SET_CAR_HEALTH columbian_humvee2 650
			CAR_SET_IDLE columbian_humvee2
    		SET_CAR_BLOCK_CAR columbian_humvee2 escort_truck
			car2_attacking_flag = 1
    	ENDIF
	ENDIF

	IF car2_attacking_flag > 0
		IF IS_CAR_DEAD columbian_humvee2
			car2_attacking_flag = -100
		ELSE
			IF NOT IS_CHAR_DEAD	columbian_driver_2
				IF NOT IS_CHAR_IN_CAR columbian_driver_2 columbian_humvee2
					GIVE_WEAPON_TO_CHAR	columbian_driver_2 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_driver_2	escort_truck
				ENDIF
			ENDIF
			IF IS_PLAYER_IN_CAR player columbian_humvee2
				IF NOT IS_CHAR_DEAD columbian_hitman_2
					GIVE_WEAPON_TO_CHAR	columbian_hitman_2 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_2 player
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_4
					GIVE_WEAPON_TO_CHAR	columbian_hitman_4 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_4 player
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_6
					GIVE_WEAPON_TO_CHAR	columbian_hitman_6 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_6 player
				ENDIF
			ENDIF
			IF IS_CAR_UPSIDEDOWN columbian_humvee2
			AND IS_CAR_STOPPED columbian_humvee2
				IF NOT IS_CHAR_DEAD columbian_driver_2
					GIVE_WEAPON_TO_CHAR	columbian_driver_2 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_driver_2	escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_2
					GIVE_WEAPON_TO_CHAR	columbian_hitman_2 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_2 escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_4
					GIVE_WEAPON_TO_CHAR	columbian_hitman_4 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_4 escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_6
					GIVE_WEAPON_TO_CHAR	columbian_hitman_6 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_6 escort_truck
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF car2_attacking_flag = 1
		IF NOT IS_CHAR_DEAD columbian_hitman_2
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee2 columbian_humvee2_speed
			IF columbian_humvee2_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_2 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_2 columbian_humvee2
					SET_CHAR_RUNNING columbian_hitman_2 TRUE
					car2_attacking_flag = 2
				ENDIF
			ENDIF
		ELSE
			car2_attacking_flag = 2
		ENDIF
	ENDIF

	IF car2_attacking_flag = 2
		IF NOT IS_CHAR_DEAD columbian_hitman_2
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_2
				GIVE_WEAPON_TO_CHAR columbian_hitman_2 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_2	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee2 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee2 escort_truck
				car2_attacking_flag = 3
			ENDIF
		ELSE
			car2_attacking_flag = 3
		ENDIF
	ENDIF

	IF car2_attacking_flag = 3
		IF NOT IS_CHAR_DEAD columbian_hitman_4
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee2 columbian_humvee2_speed
			IF columbian_humvee2_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_4 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_4 columbian_humvee2
					SET_CHAR_RUNNING columbian_hitman_4 TRUE
					car2_attacking_flag = 4
				ENDIF
			ENDIF
		ELSE
			car2_attacking_flag = 4
		ENDIF
	ENDIF

	IF car2_attacking_flag = 4
		IF NOT IS_CHAR_DEAD columbian_hitman_4
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_4
				GIVE_WEAPON_TO_CHAR columbian_hitman_4 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_4	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee2 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee2 escort_truck
				car2_attacking_flag = 5
			ENDIF
		ELSE
			car2_attacking_flag = 5
		ENDIF
	ENDIF
	
	IF car2_attacking_flag = 5
		IF NOT IS_CHAR_DEAD columbian_hitman_6
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee2 columbian_humvee2_speed
			IF columbian_humvee2_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_6 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_6 columbian_humvee2
					SET_CHAR_RUNNING columbian_hitman_6 TRUE
					car2_attacking_flag = 6
				ENDIF
			ENDIF
		ELSE
			car2_attacking_flag = 6
		ENDIF
	ENDIF

	IF car2_attacking_flag = 6
		IF NOT IS_CHAR_DEAD columbian_hitman_6
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_6
				GIVE_WEAPON_TO_CHAR columbian_hitman_6 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_6	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee2 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee2 escort_truck
				car2_attacking_flag = 7
			ENDIF
		ELSE
			car2_attacking_flag = 7
		ENDIF
	ENDIF

	IF car2_attacking_flag = 7
		SET_CAR_CRUISE_SPEED columbian_humvee2 40.0
		SET_CAR_RAM_CAR columbian_humvee2 escort_truck
		car2_attacking_flag = 8
	ENDIF

	////////////////////////////////////
	
	IF escort_truck_flag > 4
		IF car3_attacking_flag = 0
	    	IF LOCATE_CAR_2D escort_truck -645.8259 -435.9940 40.0 40.0 0
				
				IF NOT IS_POINT_ON_SCREEN -823.6705 -435.0647 10.0779 4.0
					CREATE_CAR CAR_COLUMB -823.6705 -435.0647 10.0779 columbian_humvee3
					SET_CAR_HEADING columbian_humvee3 272.1213
				ELSE
					CREATE_CAR CAR_COLUMB -735.5045 -577.3362 7.6714 columbian_humvee3
					SET_CAR_HEADING columbian_humvee3 7.8079
				ENDIF

				SET_CAR_STAYS_IN_CURRENT_LEVEL columbian_humvee3 FALSE
				CREATE_CHAR_INSIDE_CAR columbian_humvee3 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A columbian_driver_3
				CREATE_CHAR_AS_PASSENGER columbian_humvee3 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 0 columbian_hitman_7
				CREATE_CHAR_AS_PASSENGER columbian_humvee3 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1 columbian_hitman_8
				CREATE_CHAR_AS_PASSENGER columbian_humvee3 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 2 columbian_hitman_9
				SET_CAR_CRUISE_SPEED columbian_humvee3 40.0
				SET_CAR_HEALTH columbian_humvee3 650
				SET_CAR_DRIVING_STYLE columbian_humvee3 2
				CAR_SET_IDLE columbian_humvee3
	    		SET_CAR_BLOCK_CAR columbian_humvee3 escort_truck
				car3_attacking_flag = 1
	    	ENDIF
		ENDIF
	ENDIF
	
	IF car3_attacking_flag > 0
		IF IS_CAR_DEAD columbian_humvee3
			car3_attacking_flag = -100
		ELSE
			IF NOT IS_CHAR_DEAD	columbian_driver_3
				IF NOT IS_CHAR_IN_CAR columbian_driver_3 columbian_humvee3
					GIVE_WEAPON_TO_CHAR	columbian_driver_3 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_driver_3	escort_truck
				ENDIF
			ENDIF
			IF IS_PLAYER_IN_CAR player columbian_humvee3
				IF NOT IS_CHAR_DEAD columbian_hitman_7
					GIVE_WEAPON_TO_CHAR	columbian_hitman_7 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_7 player
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_8
					GIVE_WEAPON_TO_CHAR	columbian_hitman_8 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_8 player
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_9
					GIVE_WEAPON_TO_CHAR	columbian_hitman_9 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_9 player
				ENDIF
			ENDIF
			IF IS_CAR_UPSIDEDOWN columbian_humvee3
			AND IS_CAR_STOPPED columbian_humvee3
				IF NOT IS_CHAR_DEAD columbian_driver_3
					GIVE_WEAPON_TO_CHAR	columbian_driver_3 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_driver_3	escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_7
					GIVE_WEAPON_TO_CHAR	columbian_hitman_7 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_7 escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_8
					GIVE_WEAPON_TO_CHAR	columbian_hitman_8 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_8 escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_9
					GIVE_WEAPON_TO_CHAR	columbian_hitman_9 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_9 escort_truck
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF car3_attacking_flag = 1
		IF NOT IS_CHAR_DEAD columbian_hitman_7
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee3 columbian_humvee3_speed
			IF columbian_humvee3_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_7 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_7 columbian_humvee3
					SET_CHAR_RUNNING columbian_hitman_7 TRUE
					car3_attacking_flag = 2
				ENDIF
			ENDIF
		ELSE
			car3_attacking_flag = 2
		ENDIF
	ENDIF

	IF car3_attacking_flag = 2
		IF NOT IS_CHAR_DEAD columbian_hitman_7
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_7
				GIVE_WEAPON_TO_CHAR columbian_hitman_7 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_7	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee3 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee3 escort_truck
				car3_attacking_flag = 3
			ENDIF
		ELSE
			car3_attacking_flag = 3
		ENDIF
	ENDIF

	IF car3_attacking_flag = 3
		IF NOT IS_CHAR_DEAD columbian_hitman_8
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee3 columbian_humvee3_speed
			IF columbian_humvee3_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_8 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_8 columbian_humvee3
					SET_CHAR_RUNNING columbian_hitman_8 TRUE
					car3_attacking_flag = 4
				ENDIF
			ENDIF
		ELSE
			car3_attacking_flag = 4
		ENDIF
	ENDIF

	IF car3_attacking_flag = 4
		IF NOT IS_CHAR_DEAD columbian_hitman_8
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_8
				GIVE_WEAPON_TO_CHAR columbian_hitman_8 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_8	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee3 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee3 escort_truck
				car3_attacking_flag = 5
			ENDIF
		ELSE
			car3_attacking_flag = 5
		ENDIF
	ENDIF
	
	IF car3_attacking_flag = 5
		IF NOT IS_CHAR_DEAD columbian_hitman_9
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee3 columbian_humvee3_speed
			IF columbian_humvee3_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_9 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_9 columbian_humvee3
					SET_CHAR_RUNNING columbian_hitman_9 TRUE
					car3_attacking_flag = 6
				ENDIF
			ENDIF
		ELSE
			car3_attacking_flag = 6
		ENDIF
	ENDIF

	IF car3_attacking_flag = 6
		IF NOT IS_CHAR_DEAD columbian_hitman_9
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_9
				GIVE_WEAPON_TO_CHAR columbian_hitman_9 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_9	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee3 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee3 escort_truck
				car3_attacking_flag = 7
			ENDIF
		ELSE
			car3_attacking_flag = 7
		ENDIF
	ENDIF

	IF car3_attacking_flag = 7
		SET_CAR_CRUISE_SPEED columbian_humvee3 40.0
		SET_CAR_RAM_CAR columbian_humvee3 escort_truck
		car3_attacking_flag = 8
	ENDIF
	
	////////
	
	IF car4_attacking_flag = 0
    	IF LOCATE_CAR_2D escort_truck -645.8259 -435.9940 40.0 40.0 0
			
			IF NOT IS_POINT_ON_SCREEN -1017.6605 -226.1589 37.9967 4.0
				CREATE_CAR CAR_COLUMB -1017.6605 -226.1589 37.9967 columbian_humvee4
				SET_CAR_HEADING columbian_humvee4 284.9633
			ELSE
				CREATE_CAR CAR_COLUMB -878.8591 -229.1282 28.1703 columbian_humvee4
				SET_CAR_HEADING columbian_humvee4 84.5748
			ENDIF

			SET_CAR_STAYS_IN_CURRENT_LEVEL columbian_humvee4 FALSE
			CREATE_CHAR_INSIDE_CAR columbian_humvee4 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A columbian_driver_4
			CREATE_CHAR_AS_PASSENGER columbian_humvee4 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 0 columbian_hitman_10
			CREATE_CHAR_AS_PASSENGER columbian_humvee4 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1 columbian_hitman_11
			CREATE_CHAR_AS_PASSENGER columbian_humvee4 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 2 columbian_hitman_12
			SET_CAR_CRUISE_SPEED columbian_humvee4 40.0
			SET_CAR_HEALTH columbian_humvee4 650
			SET_CAR_DRIVING_STYLE columbian_humvee4 2
			CAR_SET_IDLE columbian_humvee4
    		SET_CAR_BLOCK_CAR columbian_humvee4 escort_truck
			car4_attacking_flag = 1
    	ENDIF
	ENDIF

	IF car4_attacking_flag > 0
		IF IS_CAR_DEAD columbian_humvee4
			car4_attacking_flag = -100
		ELSE
			IF NOT IS_CHAR_DEAD	columbian_driver_4
				IF NOT IS_CHAR_IN_CAR columbian_driver_4 columbian_humvee4
					GIVE_WEAPON_TO_CHAR	columbian_driver_4 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_driver_4	escort_truck
				ENDIF
			ENDIF
			IF IS_PLAYER_IN_CAR player columbian_humvee4
				IF NOT IS_CHAR_DEAD columbian_hitman_10
					GIVE_WEAPON_TO_CHAR	columbian_hitman_10 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_10 player
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_11
					GIVE_WEAPON_TO_CHAR	columbian_hitman_11 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_11 player
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_12
					GIVE_WEAPON_TO_CHAR	columbian_hitman_12 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT columbian_hitman_12 player
				ENDIF
			ENDIF
			IF IS_CAR_UPSIDEDOWN columbian_humvee4
			AND IS_CAR_STOPPED columbian_humvee4
				IF NOT IS_CHAR_DEAD columbian_driver_4
					GIVE_WEAPON_TO_CHAR	columbian_driver_4 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_driver_4	escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_10
					GIVE_WEAPON_TO_CHAR	columbian_hitman_10 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_10 escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_11
					GIVE_WEAPON_TO_CHAR	columbian_hitman_11 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_11 escort_truck
				ENDIF
				IF NOT IS_CHAR_DEAD columbian_hitman_12
					GIVE_WEAPON_TO_CHAR	columbian_hitman_12 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_12 escort_truck
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF car4_attacking_flag = 1
		IF NOT IS_CHAR_DEAD columbian_hitman_10
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee4 columbian_humvee4_speed
			IF columbian_humvee4_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_10 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_10 columbian_humvee4
					SET_CHAR_RUNNING columbian_hitman_10 TRUE
					car4_attacking_flag = 2
				ENDIF
			ENDIF
		ELSE
			car4_attacking_flag = 2
		ENDIF
	ENDIF

	IF car4_attacking_flag = 2
		IF NOT IS_CHAR_DEAD columbian_hitman_10
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_10
				GIVE_WEAPON_TO_CHAR columbian_hitman_10 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_10	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee4 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee4 escort_truck
				car4_attacking_flag = 3
			ENDIF
		ELSE
			car4_attacking_flag = 3
		ENDIF
	ENDIF

	IF car4_attacking_flag = 3
		IF NOT IS_CHAR_DEAD columbian_hitman_11
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee4 columbian_humvee4_speed
			IF columbian_humvee4_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_11 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_11 columbian_humvee4
					SET_CHAR_RUNNING columbian_hitman_11 TRUE
					car4_attacking_flag = 4
				ENDIF
			ENDIF
		ELSE
			car4_attacking_flag = 4
		ENDIF
	ENDIF

	IF car4_attacking_flag = 4
		IF NOT IS_CHAR_DEAD columbian_hitman_11
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_11
				GIVE_WEAPON_TO_CHAR columbian_hitman_11 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_11	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee4 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee4 escort_truck
				car4_attacking_flag = 5
			ENDIF
		ELSE
			car4_attacking_flag = 5
		ENDIF
	ENDIF

	IF car4_attacking_flag = 5
		IF NOT IS_CHAR_DEAD columbian_hitman_12
			GET_CAR_SPEED escort_truck escort_truck_speed
			GET_CAR_SPEED columbian_humvee4 columbian_humvee4_speed
			IF columbian_humvee4_speed < 10.0
			AND escort_truck_speed < 4.0
				IF LOCATE_CHAR_IN_CAR_CAR_2D columbian_hitman_12 escort_truck 10.0 10.0 0
					SET_CHAR_OBJ_LEAVE_CAR columbian_hitman_12 columbian_humvee4
					SET_CHAR_RUNNING columbian_hitman_12 TRUE
					car4_attacking_flag = 6
				ENDIF
			ENDIF
		ELSE
			car4_attacking_flag = 6
		ENDIF
	ENDIF

	IF car4_attacking_flag = 6
		IF NOT IS_CHAR_DEAD columbian_hitman_12
			IF NOT IS_CHAR_IN_ANY_CAR columbian_hitman_12
				GIVE_WEAPON_TO_CHAR columbian_hitman_12 WEAPONTYPE_CHAINGUN 999
				SET_CHAR_OBJ_DESTROY_CAR columbian_hitman_12	escort_truck
				SET_CAR_CRUISE_SPEED columbian_humvee4 40.0
    			SET_CAR_BLOCK_CAR columbian_humvee4 escort_truck
				car4_attacking_flag = 7
			ENDIF
		ELSE
			car4_attacking_flag = 7
		ENDIF
	ENDIF

	IF car4_attacking_flag = 7
		SET_CAR_CRUISE_SPEED columbian_humvee4 40.0
		SET_CAR_RAM_CAR columbian_humvee4 escort_truck
		car4_attacking_flag = 8
	ENDIF
	
	 ////////////////////////////////////

ELSE
	MARK_CAR_AS_NO_LONGER_NEEDED columbian_humvee1
	MARK_CAR_AS_NO_LONGER_NEEDED columbian_humvee2
	MARK_CAR_AS_NO_LONGER_NEEDED columbian_humvee3

	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_driver_1
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_driver_2
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_driver_3

	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_1
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_2
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_3
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_4
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_5
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_6
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_7
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_8
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_9
	
	MARK_CHAR_AS_NO_LONGER_NEEDED colombian_1
	MARK_CHAR_AS_NO_LONGER_NEEDED colombian_2
	MARK_CHAR_AS_NO_LONGER_NEEDED colombian_3
	MARK_CHAR_AS_NO_LONGER_NEEDED colombian_4
	MARK_CHAR_AS_NO_LONGER_NEEDED colombian_5
	MARK_CHAR_AS_NO_LONGER_NEEDED colombian_6
	MARK_CHAR_AS_NO_LONGER_NEEDED colombian_7
	MARK_CHAR_AS_NO_LONGER_NEEDED colombian_8
	MARK_CHAR_AS_NO_LONGER_NEEDED colombian_9
	MARK_CHAR_AS_NO_LONGER_NEEDED colombian_10
ENDIF

ENDWHILE

GOTO mission_love5_passed
	   		
	
// Mission love 5 failed

mission_love5_failed:
PRINT_BIG M_FAIL 2000 1
RETURN

   

// mission love 5 passed

mission_love5_passed:

flag_love_mission5_passed = 1
PRINT_WITH_NUMBER_BIG M_PASS 40000 2000 1
ADD_SCORE player 40000
CLEAR_WANTED_LEVEL player
PLAY_MISSION_PASSED_TUNE 1
REGISTER_MISSION_PASSED	LOVE5
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT love_mission6_loop
RETURN
		


// mission cleanup

mission_cleanup_love5:

flag_player_on_mission = 0
flag_player_on_love_mission = 0

IF NOT HAS_PICKUP_BEEN_COLLECTED tank_weapon
	REMOVE_PICKUP tank_weapon
ENDIF
CLEAR_ONSCREEN_COUNTER escort_truck_health
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SECURICAR
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_COLUMB
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
UNLOAD_SPECIAL_CHARACTER 2
UNLOAD_SPECIAL_CHARACTER 3
SET_CAR_DENSITY_MULTIPLIER 1.0

REMOVE_BLIP	escort_truck_blip

MISSION_HAS_FINISHED

RETURN
		


call_off_the_attackers:

	IF NOT IS_CAR_DEAD columbian_humvee1
		CAR_WANDER_RANDOMLY	columbian_humvee1
	ENDIF
	IF NOT IS_CAR_DEAD columbian_humvee2
		CAR_WANDER_RANDOMLY	columbian_humvee2
	ENDIF
	IF NOT IS_CAR_DEAD columbian_humvee3
		CAR_WANDER_RANDOMLY	columbian_humvee3
	ENDIF
	IF NOT IS_CAR_DEAD columbian_humvee4
		CAR_WANDER_RANDOMLY	columbian_humvee4
	ENDIF
	IF NOT IS_CHAR_DEAD	columbian_hitman_1
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_1 player
	ENDIF
	IF NOT IS_CHAR_DEAD columbian_hitman_2
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_2 player
	ENDIF
	IF NOT IS_CHAR_DEAD	columbian_hitman_3
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_3 player
	ENDIF
	IF NOT IS_CHAR_DEAD	columbian_hitman_4
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_4 player
	ENDIF
	IF NOT IS_CHAR_DEAD	columbian_hitman_5
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_5 player
	ENDIF
	IF NOT IS_CHAR_DEAD	columbian_hitman_6
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_6 player
	ENDIF
	IF NOT IS_CHAR_DEAD	columbian_hitman_7
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_7 player
	ENDIF
	IF NOT IS_CHAR_DEAD	columbian_hitman_8
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_8 player
	ENDIF
	IF NOT IS_CHAR_DEAD	columbian_hitman_9
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_9 player
	ENDIF
	IF NOT IS_CHAR_DEAD	columbian_hitman_10
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_10 player
	ENDIF
	IF NOT IS_CHAR_DEAD	columbian_hitman_11
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_11 player
	ENDIF
	IF NOT IS_CHAR_DEAD	columbian_hitman_12
		SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS columbian_hitman_12 player
	ENDIF
	MARK_CAR_AS_NO_LONGER_NEEDED columbian_humvee1
	MARK_CAR_AS_NO_LONGER_NEEDED columbian_humvee2
	MARK_CAR_AS_NO_LONGER_NEEDED columbian_humvee3
	MARK_CAR_AS_NO_LONGER_NEEDED columbian_humvee4
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_1
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_2
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_3
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_4
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_5
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_6
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_7
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_8
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_9
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_10
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_11
	MARK_CHAR_AS_NO_LONGER_NEEDED columbian_hitman_12
	car1_attacking_flag = -100
	car2_attacking_flag = -100
	car3_attacking_flag = -100
	car4_attacking_flag = -100

RETURN
MISSION_START
// *****************************************************************************************
// *******************************    Donald Love 6    ************************************* 
// *******************************    Swat the SWAT    *************************************
// *****************************************************************************************
// *** Ray has tipped off Love that the Liberty PD are going to mount a raid on his pad. ***
// *** Three SWAT vans are going to approach the contact point from different directions ***
// *** to trap any one escaping.  The player must take out the SWAT teams.				 ***
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_love6

IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_love6_failed
ENDIF

GOSUB mission_cleanup_love6

MISSION_END
 
// Variables For Mission

VAR_INT	decoy_van swat_1 swat_2 swat_3 swat_4 swat_5 cop_1 cop_2 cop_3 	 //CARS
VAR_INT ped_swat_1 ped_swat_2 ped_swat_3 ped_swat_4 ped_swat_5 ped_swat_6 ped_swat_7 ped_swat_8 //SWAT PEDS
VAR_INT ped_cop_1 ped_cop_2 ped_cop_3 ped_cop_4 ped_cop_5 ped_cop_6 //COP PEDS
VAR_INT survival_time decoy_van_blip get_in_van decoy_van_health decoy_van_health2//TIMER BLIPS ETC
VAR_INT out_of_car_timer_present out_of_car_timer_start	out_of_car_timer out_of_car_timer_diff out_of_car_timer_secs

// ****************************************Mission Start************************************

mission_start_love6:

flag_player_on_mission = 1
flag_player_on_love_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

SCRIPT_NAME love6

get_in_van = 0
survival_time = 180000

// ****************************************START OF CUTSCENE********************************

//SET_FADING_COLOUR 0 0 0
//
//DO_FADE 1500 FADE_OUT
//
//IF CAN_PLAYER_START_MISSION player
//	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
//ELSE
//	GOTO mission_love6_failed
//ENDIF
//
//PRINT_BIG LOVE6	15000 2

LOAD_SPECIAL_CHARACTER 1 love2
LOAD_SPECIAL_MODEL cut_obj1 LOVEH
REQUEST_MODEL tshrorckgrdn
REQUEST_MODEL tshrorckgrdn_alfas

//WHILE GET_FADING_STATUS
//	WAIT 0
//ENDWHILE

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_MODEL_LOADED tshrorckgrdn
OR NOT HAS_MODEL_LOADED tshrorckgrdn_alfas
OR NOT HAS_MODEL_LOADED cut_obj1
	WAIT 0
ENDWHILE

LOAD_CUTSCENE D6_STS

SET_CUTSCENE_OFFSET 85.2162 -1532.9093 243.5422

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_love
SET_CUTSCENE_ANIM cs_love love2

CREATE_CUTSCENE_HEAD cs_love CUT_OBJ1 cs_lovehead
SET_CUTSCENE_HEAD_ANIM cs_lovehead love

CLEAR_AREA 82.44 -1548.49 28.0 2.0 TRUE

SET_PLAYER_COORDINATES player 82.44 -1548.49 28.0

SET_PLAYER_HEADING player 90.0

DO_FADE 1000 FADE_IN

START_CUTSCENE

SWITCH_RUBBISH OFF

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 1526
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE6_A 5000 1 //"A lesson in business, my friend;"

WHILE cs_time < 3011
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE6_E 5000 1 //"if you have a unique commodity, the world and his wife will try to wrestle it from your grasp."

WHILE cs_time < 7026
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE6_B 5000 1 //"Even if they have little understanding as to its true value."

WHILE cs_time < 10679
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE6_C 5000 1 //"SWAT teams have cordoned the area around my friend and the package."

WHILE cs_time < 14011
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE6_D 5000 1 //"Get over there, pick up the van and bust out as a decoy."

WHILE cs_time < 16741
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW LOVE6_F 5000 1 //"Keep them busy for 5 minutes and he should make good his escape!"

WHILE cs_time < 20333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1000 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

//WHILE NOT HAS_CUTSCENE_FINISHED
//	WAIT 0
//ENDWHILE

SWITCH_RUBBISH ON

CLEAR_PRINTS

CLEAR_CUTSCENE

//DO_FADE 0 FADE_OUT

SET_CAMERA_BEHIND_PLAYER

UNLOAD_SPECIAL_CHARACTER 1
MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn
MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn_alfas
MARK_MODEL_AS_NO_LONGER_NEEDED cut_obj1

SET_SWAT_REQUIRED TRUE
REQUEST_MODEL CAR_ENFORCER
REQUEST_MODEL PED_SWAT
REQUEST_MODEL PED_COP
REQUEST_MODEL CAR_POLICE
REQUEST_MODEL CAR_SECURICAR

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED CAR_ENFORCER
OR NOT HAS_MODEL_LOADED	CAR_POLICE
OR NOT HAS_MODEL_LOADED	PED_COP
OR NOT HAS_MODEL_LOADED	PED_SWAT
OR NOT HAS_MODEL_LOADED	CAR_SECURICAR
	WAIT 0
ENDWHILE

SWITCH_STREAMING ON
DO_FADE 1000 FADE_IN 

LOAD_MISSION_AUDIO LO6_A

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

// ******************************************END OF CUTSCENE********************************

ADD_BLIP_FOR_COORD_OLD -1026.5 -73.5 39.0 RED BLIP_ONLY decoy_van_blip
CHANGE_BLIP_SCALE decoy_van_blip 3

WHILE NOT IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
	WAIT 0
ENDWHILE

WHILE NOT LOCATE_PLAYER_ANY_MEANS_2D player -1026.5 -73.5 200.0 200.0 0
	WAIT 0
ENDWHILE

SET_MAX_WANTED_LEVEL 6

CREATE_CAR CAR_SECURICAR -1026.5 -73.5 39.0 decoy_van
CHANGE_CAR_COLOUR decoy_van 0 0
SET_CAR_HEADING decoy_van 270.0
CAR_SET_IDLE decoy_van
LOCK_CAR_DOORS decoy_van CARLOCK_UNLOCKED
SET_CAR_STRONG decoy_van TRUE

REMOVE_BLIP	decoy_van_blip
ADD_BLIP_FOR_CAR decoy_van decoy_van_blip

CREATE_CAR CAR_ENFORCER -1005.5 11.0 44.0 swat_1
SET_CAR_HEADING swat_1 119.0
CAR_SET_IDLE swat_1
CREATE_CHAR_INSIDE_CAR swat_1 PEDTYPE_COP PED_SWAT ped_swat_1
GIVE_WEAPON_TO_CHAR ped_swat_1 WEAPONTYPE_SHOTGUN 50
CHAR_SET_IDLE ped_swat_1
SET_CHAR_OBJ_NO_OBJ	ped_swat_1
SET_CAR_MISSION	swat_1 MISSION_NONE

CREATE_CAR CAR_ENFORCER -1112.4 -46.4 49.0 swat_2
SET_CAR_HEADING swat_2 212.0
CAR_SET_IDLE swat_2
CREATE_CHAR_INSIDE_CAR swat_2 PEDTYPE_COP PED_SWAT ped_swat_2
GIVE_WEAPON_TO_CHAR ped_swat_2 WEAPONTYPE_SHOTGUN 50
CHAR_SET_IDLE ped_swat_2
SET_CHAR_OBJ_NO_OBJ	ped_swat_2
SET_CAR_MISSION	swat_2 MISSION_NONE

CREATE_CAR CAR_ENFORCER -1118.4 -63.6 48.7 swat_3
SET_CAR_HEADING swat_3 321.0
CAR_SET_IDLE swat_3
CREATE_CHAR_INSIDE_CAR swat_3 PEDTYPE_COP PED_SWAT ped_swat_3
GIVE_WEAPON_TO_CHAR ped_swat_3 WEAPONTYPE_SHOTGUN 50
CHAR_SET_IDLE ped_swat_3
SET_CHAR_OBJ_NO_OBJ	ped_swat_3
SET_CAR_MISSION	swat_3 MISSION_NONE

CREATE_CAR CAR_ENFORCER -963.3 -108.7 34.7 swat_4
SET_CAR_HEADING swat_4 103.0
CAR_SET_IDLE swat_4
CREATE_CHAR_INSIDE_CAR swat_4 PEDTYPE_COP PED_SWAT ped_swat_4
GIVE_WEAPON_TO_CHAR ped_swat_4 WEAPONTYPE_SHOTGUN 50
CHAR_SET_IDLE ped_swat_4
SET_CHAR_OBJ_NO_OBJ	ped_swat_4
SET_CAR_MISSION	swat_4 MISSION_NONE

CREATE_CAR CAR_ENFORCER -957.0 -111.0 34.5 swat_5
SET_CAR_HEADING swat_5 108.5
CAR_SET_IDLE swat_5
CREATE_CHAR_INSIDE_CAR swat_5 PEDTYPE_COP PED_SWAT ped_swat_5
GIVE_WEAPON_TO_CHAR ped_swat_5 WEAPONTYPE_SHOTGUN 50
CHAR_SET_IDLE ped_swat_5
SET_CHAR_OBJ_NO_OBJ	ped_swat_5
SET_CAR_MISSION	swat_5 MISSION_NONE

CREATE_CAR CAR_POLICE -983.0 -120.3 33.6 cop_1
SET_CAR_HEADING cop_1 270.0
CAR_SET_IDLE cop_1
CREATE_CHAR_INSIDE_CAR cop_1 PEDTYPE_COP PED_COP ped_cop_1
GIVE_WEAPON_TO_CHAR ped_cop_1 WEAPONTYPE_PISTOL	100
CHAR_SET_IDLE ped_cop_1
SET_CHAR_OBJ_NO_OBJ	ped_cop_1
SET_CAR_MISSION	cop_1 MISSION_NONE

CREATE_CAR CAR_POLICE -1018.8 4.4 43.7 cop_2
SET_CAR_HEADING cop_2 262.0
CAR_SET_IDLE cop_2
CREATE_CHAR_INSIDE_CAR cop_2 PEDTYPE_COP PED_COP ped_cop_2
GIVE_WEAPON_TO_CHAR ped_cop_2 WEAPONTYPE_PISTOL	100
CHAR_SET_IDLE ped_cop_2
SET_CHAR_OBJ_NO_OBJ	ped_cop_2
SET_CAR_MISSION	cop_2 MISSION_NONE

CREATE_CAR CAR_POLICE -1114.4 -50.0 48.6 cop_3
SET_CAR_HEADING cop_3 202.0
CAR_SET_IDLE cop_3
CREATE_CHAR_INSIDE_CAR cop_3 PEDTYPE_COP PED_COP ped_cop_3
GIVE_WEAPON_TO_CHAR ped_cop_3 WEAPONTYPE_PISTOL	100
CHAR_SET_IDLE ped_cop_3
SET_CHAR_OBJ_NO_OBJ	ped_cop_3
SET_CAR_MISSION	cop_3 MISSION_NONE


CREATE_CHAR PEDTYPE_COP PED_SWAT -1115.7 -63.9 48.8 ped_swat_6
SET_CHAR_HEADING ped_swat_6 342.0
GIVE_WEAPON_TO_CHAR ped_swat_6 WEAPONTYPE_SHOTGUN 50
CHAR_SET_IDLE ped_swat_6
SET_CHAR_OBJ_NO_OBJ	ped_swat_6

CREATE_CHAR PEDTYPE_COP PED_SWAT -965.3 -111.2 34.0 ped_swat_7
SET_CHAR_HEADING ped_swat_7 41.0
GIVE_WEAPON_TO_CHAR ped_swat_7 WEAPONTYPE_SHOTGUN 50
CHAR_SET_IDLE ped_swat_7
SET_CHAR_OBJ_NO_OBJ	ped_swat_7

CREATE_CHAR PEDTYPE_COP PED_SWAT -960.5 -113.0 34.0 ped_swat_8
SET_CHAR_HEADING ped_swat_8 173.0
GIVE_WEAPON_TO_CHAR ped_swat_8 WEAPONTYPE_SHOTGUN 50
CHAR_SET_IDLE ped_swat_8
SET_CHAR_OBJ_NO_OBJ	ped_swat_8

CREATE_CHAR PEDTYPE_COP PED_COP -1103.4 -47.8 48.8 ped_cop_4
SET_CHAR_HEADING ped_cop_4 255.0
GIVE_WEAPON_TO_CHAR ped_cop_4 WEAPONTYPE_SHOTGUN 50
CHAR_SET_IDLE ped_cop_4
SET_CHAR_OBJ_NO_OBJ	ped_cop_4

CREATE_CHAR PEDTYPE_COP PED_COP -984.0 -91.2 36.0 ped_cop_5
SET_CHAR_HEADING ped_cop_5 339.0
GIVE_WEAPON_TO_CHAR ped_cop_5 WEAPONTYPE_SHOTGUN 50
CHAR_SET_IDLE ped_cop_5
SET_CHAR_OBJ_NO_OBJ	ped_cop_5

CREATE_CHAR PEDTYPE_COP PED_COP -1005.0 5.5 43.8 ped_cop_6
SET_CHAR_HEADING ped_cop_6 169.0
GIVE_WEAPON_TO_CHAR ped_cop_6 WEAPONTYPE_SHOTGUN 50
CHAR_SET_IDLE ped_cop_6
SET_CHAR_OBJ_NO_OBJ	ped_cop_6

WHILE NOT IS_PLAYER_IN_CAR player decoy_van
	
	WAIT 0

	IF IS_CAR_DEAD decoy_van
		GOTO mission_love6_failed
	ENDIF

ENDWHILE

REMOVE_BLIP decoy_van_blip

//PRINT_NOW GOGO 5000 1 //GO GO GO!!

IF NOT IS_CHAR_DEAD ped_swat_6
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS ped_swat_6 player
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_swat_6
ENDIF

IF NOT IS_CHAR_DEAD ped_swat_7
	SET_CHAR_OBJ_DESTROY_CAR ped_swat_7 decoy_van
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_swat_7
ENDIF

IF NOT IS_CHAR_DEAD ped_swat_8
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS ped_swat_8 player
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_swat_8
ENDIF

IF NOT IS_CHAR_DEAD ped_cop_4
	SET_CHAR_OBJ_DESTROY_CAR ped_cop_4 decoy_van
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_cop_4
ENDIF

IF NOT IS_CHAR_DEAD ped_cop_5
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS ped_cop_5 player
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_cop_5
ENDIF

IF NOT IS_CHAR_DEAD ped_cop_6
	SET_CHAR_OBJ_DESTROY_CAR ped_cop_6 decoy_van
	MARK_CHAR_AS_NO_LONGER_NEEDED ped_cop_6
ENDIF

IF NOT IS_CAR_DEAD swat_1
	SET_CAR_CRUISE_SPEED swat_1 100.0
	SET_CAR_DRIVING_STYLE swat_1 2
	SET_CAR_RAM_CAR	swat_1 decoy_van
	MARK_CAR_AS_NO_LONGER_NEEDED swat_1
ENDIF

IF NOT IS_CAR_DEAD swat_2
	SET_CAR_CRUISE_SPEED swat_2 100.0
	SET_CAR_DRIVING_STYLE swat_2 2
	SET_CAR_RAM_CAR	swat_2 decoy_van
	MARK_CAR_AS_NO_LONGER_NEEDED swat_2
ENDIF

IF NOT IS_CAR_DEAD swat_3
	SET_CAR_CRUISE_SPEED swat_3 100.0
	SET_CAR_DRIVING_STYLE swat_3 2
	SET_CAR_RAM_CAR	swat_3 decoy_van
	MARK_CAR_AS_NO_LONGER_NEEDED swat_3
ENDIF

IF NOT IS_CAR_DEAD swat_4
	SET_CAR_CRUISE_SPEED swat_4 100.0
	SET_CAR_DRIVING_STYLE swat_4 2
	SET_CAR_RAM_CAR	swat_4 decoy_van
	MARK_CAR_AS_NO_LONGER_NEEDED swat_4
ENDIF

IF NOT IS_CAR_DEAD swat_5
	SET_CAR_CRUISE_SPEED swat_5 100.0
	SET_CAR_DRIVING_STYLE swat_5 2
	SET_CAR_RAM_CAR	swat_5 decoy_van
	MARK_CAR_AS_NO_LONGER_NEEDED swat_5
ENDIF

IF NOT IS_CAR_DEAD cop_1
	SET_CAR_CRUISE_SPEED cop_1 100.0
	SET_CAR_DRIVING_STYLE cop_1 2
	SET_CAR_RAM_CAR	cop_1 decoy_van
	MARK_CAR_AS_NO_LONGER_NEEDED cop_1
ENDIF

IF NOT IS_CAR_DEAD cop_2
	SET_CAR_CRUISE_SPEED cop_2 100.0
	SET_CAR_DRIVING_STYLE cop_2 2
	SET_CAR_RAM_CAR	cop_2 decoy_van
	MARK_CAR_AS_NO_LONGER_NEEDED cop_2
ENDIF

IF NOT IS_CAR_DEAD cop_3
	SET_CAR_CRUISE_SPEED cop_3 100.0
	SET_CAR_DRIVING_STYLE cop_3 2
	SET_CAR_RAM_CAR	cop_3 decoy_van
	MARK_CAR_AS_NO_LONGER_NEEDED cop_3
ENDIF

ALTER_WANTED_LEVEL player 6 

DISPLAY_ONSCREEN_TIMER survival_time

PRINT_NOW LOVE6_1 5000 1//"Now lead the cops away!"

IF HAS_MISSION_AUDIO_LOADED
	PLAY_MISSION_AUDIO
ENDIF

GET_CAR_HEALTH decoy_van decoy_van_health
//escort_truck_health += dummy_health
//escort_truck_health = escort_truck_health / 2
decoy_van_health = decoy_van_health - 250
decoy_van_health = decoy_van_health * 100
decoy_van_health = decoy_van_health / 750
decoy_van_health2 = decoy_van_health
decoy_van_health = 100 - decoy_van_health2
IF decoy_van_health > 100
	decoy_van_health = 100
ENDIF

DISPLAY_ONSCREEN_COUNTER_WITH_STRING decoy_van_health COUNTER_DISPLAY_BAR DAM
	
WHILE survival_time > 0
	WAIT 0

	IF IS_CAR_DEAD decoy_van
		GOTO mission_love6_failed
	ENDIF

	ALTER_WANTED_LEVEL player 6

    GET_CAR_HEALTH decoy_van decoy_van_health
//	escort_truck_health += dummy_health
//	escort_truck_health = escort_truck_health / 2
	decoy_van_health = decoy_van_health - 250
	decoy_van_health = decoy_van_health * 100
	decoy_van_health = decoy_van_health / 750
	decoy_van_health2 = decoy_van_health
	decoy_van_health = 100 - decoy_van_health2
	IF decoy_van_health > 100
		decoy_van_health = 100
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player decoy_van
		IF get_in_van = 0
			GET_GAME_TIMER out_of_car_timer_start
			IF survival_time > 15000
				out_of_car_timer = 15000
			ELSE
				out_of_car_timer = survival_time
			ENDIF 
			ADD_BLIP_FOR_CAR decoy_van decoy_van_blip
			get_in_van = 1
		ENDIF
		GET_GAME_TIMER out_of_car_timer_present
		out_of_car_timer_diff = out_of_car_timer_present - out_of_car_timer_start
		out_of_car_timer -= out_of_car_timer_diff
		out_of_car_timer_start = out_of_car_timer_present
		out_of_car_timer_secs = out_of_car_timer / 1000
		PRINT_WITH_NUMBER_NOW LOVE6_3 out_of_car_timer_secs 200 1 //~g~You have ~1~ seconds to return to the Securicar before you fail the mission.
		IF out_of_car_timer_secs < 1 
			PRINT_NOW LOVE6_4 3000 1//~r~You ditched the Decoy Securicar!
			GOTO mission_love6_failed
		ENDIF
	ENDIF

	IF IS_PLAYER_IN_CAR player decoy_van
	AND get_in_van = 1
		REMOVE_BLIP	decoy_van_blip
		get_in_van = 0
	ENDIF

ENDWHILE

IF LOCATE_PLAYER_ANY_MEANS_2D PLAYER -1026.5 -73.5 160.0 160.0 0
	PRINT_NOW LOVE6_2 5000 1//"You failed to lead the police far enough away."
	GOTO mission_love6_failed
ENDIF

GOTO mission_love6_passed


// Mission Love 6 failed

mission_love6_failed:
PRINT_BIG M_FAIL 5000 1
RETURN

   

// mission Love 6 passed

mission_love6_passed:

flag_love_mission6_passed = 1
PRINT_WITH_NUMBER_BIG M_PASS 35000 5000 1
ADD_SCORE player 35000 
CLEAR_WANTED_LEVEL player
REGISTER_MISSION_PASSED	LOVE6
PLAY_MISSION_PASSED_TUNE 1
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT love_mission7_loop
RETURN
		


// mission cleanup

mission_cleanup_love6:

flag_player_on_mission = 0
flag_player_on_love_mission = 0
		
REMOVE_BLIP	decoy_van_blip
CLEAR_ONSCREEN_TIMER survival_time
CLEAR_ONSCREEN_COUNTER decoy_van_health

SET_SWAT_REQUIRED FALSE
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SECURICAR
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_POLICE
MARK_MODEL_AS_NO_LONGER_NEEDED PED_COP
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_ENFORCER
MARK_MODEL_AS_NO_LONGER_NEEDED PED_SWAT

MISSION_HAS_FINISHED
RETURN
		


MISSION_START
// *****************************************************************************************
// *******************************    Donald Love 7    ************************************* 
// *******************************    Left the Scene   *************************************
// *****************************************************************************************
// ***************************    	Love has disapeared!   *********************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_love7

GOSUB mission_cleanup_love7

MISSION_END
 
// ****************************************Mission Start************************************

mission_start_love7:

flag_player_on_mission = 1
flag_player_on_love_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

SCRIPT_NAME love7

// ****************************************START OF CUTSCENE********************************

//SET_FADING_COLOUR 0 0 0
//
//DO_FADE 1500 FADE_OUT
//
//IF CAN_PLAYER_START_MISSION player
//	MAKE_PLAYER_SAFE_FOR_CUTSCENE player
//ELSE
//	GOTO mission_love7_failed
//ENDIF
//
//PRINT_BIG LOVE7	15000 2

REQUEST_MODEL tshrorckgrdn
REQUEST_MODEL tshrorckgrdn_alfas

//WHILE GET_FADING_STATUS
//	WAIT 0
//ENDWHILE

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED tshrorckgrdn_alfas
OR NOT HAS_MODEL_LOADED tshrorckgrdn
	WAIT 0
ENDWHILE

LOAD_CUTSCENE D7_MLD

SET_CUTSCENE_OFFSET 85.2162 -1532.9093 243.5422

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CLEAR_AREA 82.44 -1548.49 28.0 2.0 TRUE

SET_PLAYER_COORDINATES player 82.44 -1548.49 28.0

SET_PLAYER_HEADING player 90.0

DO_FADE 1500 FADE_IN

START_CUTSCENE

SWITCH_RUBBISH OFF

GET_CUTSCENE_TIME cs_time

WHILE cs_time < 15000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0
ENDWHILE

SWITCH_STREAMING ON
SWITCH_RUBBISH ON

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

DO_FADE 0 FADE_OUT

MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn
MARK_MODEL_AS_NO_LONGER_NEEDED tshrorckgrdn_alfas

SET_CAMERA_BEHIND_PLAYER

DO_FADE 1500 FADE_IN 

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

// ******************************************END OF CUTSCENE********************************

GOTO mission_love7_passed


// Mission Love 7 failed

mission_love7_failed:
RETURN

   

// mission Love 7 passed

mission_love7_passed:

flag_love_mission7_passed = 1
PLAYER_MADE_PROGRESS 1
REMOVE_BLIP love_contact_blip
CLEAR_WANTED_LEVEL player
PLAY_MISSION_PASSED_TUNE 1
REGISTER_MISSION_PASSED	LOVE7
RETURN
		


// mission cleanup

mission_cleanup_love7:

flag_player_on_mission = 0
flag_player_on_love_mission = 0
		
MISSION_HAS_FINISHED
RETURN
		


MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ***********************************ASUKA SUBURBAN MISSION 1****************************** 
// *****************************************************************************************
// ******************************************'BAIT'*****************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_as1
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_as1_failed
ENDIF
GOSUB mission_cleanup_as1

MISSION_END
 
// Variables for mission

VAR_INT cartel_car_a_as1 cartel_car_b_as1 cartel_car_d_as1 //cartel_car_c_as1
VAR_INT cartel1_as1 cartel2_as1 cartel3_as1 cartel4_as1
VAR_INT cartel5_as1 cartel6_as1 cartel7_as1 cartel8_as1
//VAR_INT cartel9_as1 cartel10_as1 cartel11_as1 cartel12_as1
VAR_INT cartel13_as1 cartel14_as1 cartel15_as1 cartel16_as1


VAR_INT blip_cartel1 blip_cartel2 blip_cartel3 blip_cartel4
VAR_INT blip_cartel5 blip_cartel6 blip_cartel7 blip_cartel8
//VAR_INT blip_cartel9 blip_cartel10 blip_cartel11 blip_cartel12
VAR_INT blip_cartel13 blip_cartel14 blip_cartel15 blip_cartel16

VAR_INT blip_cartelcar_a blip_cartelcar_b blip_cartelcar_d //blip_cartelcar_c

VAR_INT cartel1_as1_dead cartel2_as1_dead cartel3_as1_dead cartel4_as1_dead
VAR_INT cartel5_as1_dead cartel6_as1_dead cartel7_as1_dead cartel8_as1_dead
//VAR_INT cartel9_as1_dead cartel10_as1_dead cartel11_as1_dead cartel12_as1_dead
VAR_INT cartel13_as1_dead cartel14_as1_dead cartel15_as1_dead cartel16_as1_dead


VAR_INT yakuza1_as1 yakuza2_as1 yakuza3_as1 yakuza4_as1
VAR_INT yakuza5_as1 yakuza6_as1 yakuza7_as1 yakuza8_as1

VAR_INT flag_yak1_dead flag_yak2_dead flag_yak3_dead flag_yak4_dead
VAR_INT flag_yak5_dead flag_yak6_dead //flag_yak7_dead flag_yak8_dead

VAR_INT yak1_mission //yak4_mission

VAR_INT flag_yakuza_created_as1
VAR_INT counter_yakuza_killed_as1
VAR_INT flag_wellybob //flag_all_yak_dead

VAR_INT yaks_a_killed_by_player yaks_b_killed_by_player yaks_killed_by_player
VAR_INT flag_a_attack flag_b_attack flag_d_attack //flag_c_attack

VAR_INT blip_cartel_a_as1 blip_cartel_b_as1 blip_cartel_d_as1 //blip_cartel_c_as1
VAR_INT blip_killzone

VAR_INT flag_cartel_a_created
VAR_INT flag_cartel_b_created
//VAR_INT flag_cartel_c_created
VAR_INT flag_cartel_d_created
VAR_INT counter_cartels_killed_as1 counter_asukas_revenge counter_bailouts //counter_yak_ammo
//VAR_INT flag_cartelcar_a_dead flag_cartelcar_b_dead flag_cartelcar_c_dead flag_cartelcar_d_dead

//VAR_INT flag_blip_removed_a flag_blip_removed_b flag_blip_removed_c flag_blip_removed_d
//VAR_INT flag_car_a_blip flag_car_b_blip flag_car_c_blip flag_car_d_blip

VAR_INT flag_bailout_a flag_bailout_b flag_bailout_d //flag_bailout_c

VAR_FLOAT cartel_heading

VAR_FLOAT killzone_cent_x killzone_cent_y
VAR_FLOAT killzone_min_x killzone_min_y killzone_max_x killzone_max_y
VAR_FLOAT cartel_a_x cartel_a_y
VAR_FLOAT cartel_b_x cartel_b_y
//VAR_FLOAT cartel_c_x cartel_c_y
VAR_FLOAT cartel_d_x cartel_d_y
VAR_FLOAT yak1_x yak1_y
VAR_FLOAT yak2_x yak2_y
VAR_FLOAT yak3_x yak3_y
VAR_FLOAT yak4_x yak4_y
VAR_FLOAT yak5_x yak5_y
VAR_FLOAT yak6_x yak6_y
/*
VAR_INT timer_reset_car_a timer_reset_car_b timer_reset_car_c timer_reset_car_d
VAR_INT timer_start_car_a timer_start_car_b timer_start_car_c timer_start_car_d
VAR_INT timer_current_car_a timer_current_car_b timer_current_car_c timer_current_car_d
VAR_INT car_a_time_dif car_b_time_dif car_c_time_dif car_d_time_dif
*/
VAR_FLOAT car_a_x_old car_a_y_old car_a_z_old car_a_as1_x car_a_as1_y car_a_as1_z
VAR_FLOAT car_b_x_old car_b_y_old car_b_z_old car_b_as1_x car_b_as1_y car_b_as1_z
//VAR_FLOAT car_c_x_old car_c_y_old car_c_z_old car_c_as1_x car_c_as1_y car_c_as1_z
VAR_FLOAT car_d_x_old car_d_y_old car_d_z_old car_d_as1_x car_d_as1_y car_d_as1_z


VAR_FLOAT cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z
VAR_FLOAT cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z
//VAR_FLOAT cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z
VAR_FLOAT cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z

//VAR_FLOAT player_x player_y player_z



// ****************************************Mission Start************************************

mission_start_as1:
REGISTER_MISSION_GIVEN
SCRIPT_NAME asusb1 
flag_player_on_mission = 1
flag_player_on_asuka_suburban_mission = 1

// multiple targets, dont bother pathing
DISPLAY_RADAR 2 // PATHING OFF

WAIT 0

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_as1_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

PRINT_BIG ( AS1 ) 15000 2
*/

//  ******************************************* START OF CUTSCENE ***************************

REQUEST_MODEL csitecutscene

LOAD_SPECIAL_CHARACTER 1 asuka
LOAD_SPECIAL_CHARACTER 2 miguel

LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 ASUKAH
LOAD_SPECIAL_MODEL cut_obj3 WHIP

/*
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
*/

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED csitecutscene
 WAIT 0
ENDWHILE

WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
	WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
	WAIT 0
ENDWHILE

LOAD_CUTSCENE a6_bait

SWITCH_STREAMING ON

SET_CUTSCENE_OFFSET 369.02 -327.5 18.46
  
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player
 
CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_asuka
SET_CUTSCENE_ANIM cs_asuka asuka

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_miguel
SET_CUTSCENE_ANIM cs_miguel miguel
 
CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player
 
CREATE_CUTSCENE_HEAD cs_asuka CUT_OBJ2 cs_asukahead
SET_CUTSCENE_HEAD_ANIM cs_asukahead asuka

CREATE_CUTSCENE_OBJECT cut_obj3 cs_whip
SET_CUTSCENE_ANIM cs_whip WHIP

//CREATE_CUTSCENE_HEAD cs_miguel CUT_OBJ3 cs_miguelhead
//SET_CUTSCENE_HEAD_ANIM cs_miguelhead miguel

SET_PLAYER_COORDINATES player 373.7523 -327.2676 17.1950
 
SET_PLAYER_HEADING player 270.0
 
DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

START_CUTSCENE

//------CUTSCENE TEXT-----------------------------
GET_CUTSCENE_TIME cs_time

WHILE cs_time < 3598
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW (AS1_A) 10000 1
 
WHILE cs_time < 6277
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS1_B) 10000 1
 
WHILE cs_time < 12209
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS1_C) 10000 1
 
WHILE cs_time < 17758
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS1_D) 10000 1

WHILE cs_time < 22581
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS1_E) 2500 1

WHILE cs_time < 29000
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
DO_FADE 1500 FADE_OUT
 
WHILE NOT HAS_CUTSCENE_FINISHED
 WAIT 0
ENDWHILE
  
CLEAR_PRINTS
 
WHILE GET_FADING_STATUS
 WAIT 0
ENDWHILE
 
CLEAR_CUTSCENE
 
DO_FADE 0 FADE_OUT
 
SET_CAMERA_BEHIND_PLAYER
 
WAIT 500
 
DO_FADE 1500 FADE_IN 
  
UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
MARK_MODEL_AS_NO_LONGER_NEEDED csitecutscene

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3

SWITCH_RUBBISH ON
SWITCH_STREAMING ON
SWITCH_WORLD_PROCESSING ON
// ******************************************END OF CUTSCENE********************************

//---------------------------------SET FLAGS & VARIABLES-------------------------------------------



flag_yak1_dead = 0
flag_yak2_dead = 0
flag_yak3_dead = 0
flag_yak4_dead = 0
flag_yak5_dead = 0
flag_yak6_dead = 0
//flag_all_yak_dead = 0

counter_yakuza_killed_as1 = 0
/*
flag_blip_removed_a = 0
flag_blip_removed_b = 0
flag_blip_removed_c = 0
flag_blip_removed_d = 0

flag_car_a_blip = 0
flag_car_b_blip = 0
flag_car_c_blip = 0
flag_car_d_blip = 0
*/

yak1_mission = 0
//yak4_mission = 0

flag_cartel_a_created = 0
flag_cartel_b_created = 0
//flag_cartel_c_created = 0
flag_cartel_d_created = 0
flag_yakuza_created_as1 = 0

//flag_cartelcar_a_dead = 0
//flag_cartelcar_b_dead = 0
//flag_cartelcar_c_dead = 0
//flag_cartelcar_d_dead = 0

cartel1_as1_dead = 0
cartel2_as1_dead = 0
cartel3_as1_dead = 0
cartel4_as1_dead = 0
cartel5_as1_dead = 0
cartel6_as1_dead = 0
cartel7_as1_dead = 0
cartel8_as1_dead = 0
/*
cartel9_as1_dead = 0
cartel10_as1_dead = 0
cartel11_as1_dead = 0
cartel12_as1_dead = 0
*/
cartel13_as1_dead = 0
cartel14_as1_dead = 0
cartel15_as1_dead = 0
cartel16_as1_dead = 0

counter_cartels_killed_as1 = 0
counter_asukas_revenge = 0
counter_bailouts = 0
//counter_yak_ammo = 0

flag_bailout_a = 0
flag_bailout_b = 0
//flag_bailout_c = 0
flag_bailout_d = 0

yaks_a_killed_by_player = 0
yaks_b_killed_by_player = 0
yaks_killed_by_player = 0

//timer_as3_start = 0
timer_as3_now = 0
//timer_as3_dif = 0
particle_time = 0
flag_particle = 0

flag_a_attack = 0
flag_b_attack = 0
flag_d_attack = 0
//flag_c_attack = 0

flag_wellybob = 0
// ****************************************LOCATION COORDS**************************************

killzone_cent_x = -1185.0
killzone_cent_y = 105.0
killzone_min_x = -1254.0
killzone_min_y = 85.0
killzone_max_x = -1178.0
killzone_max_y = 160.0

cartel_a_x = -996.85// Punk Noodles
cartel_a_y = -247.5

cartel_b_x = -877.0// Dam (east end)
cartel_b_y = 562.0

//cartel_c_x = -714.0// AIRPORT
//cartel_c_y = -722.0

cartel_d_x = -459.0// Cedar Grove
cartel_d_y = 251.5

yak1_x = -1168.0 
yak1_y = 110.26
yak2_x = -1185.0
yak2_y = 90.4
yak3_x = -1205.24
yak3_y = 94.11
yak4_x = -1160.0
yak4_y = 119.57
yak5_x = -1173.3
yak5_y = 95.5
yak6_x = -1184.5
yak6_y = 122.6

car_a_as1_x = 0.0
car_a_as1_y = 0.0
car_a_as1_z	= 0.0
car_b_as1_x = 0.0
car_b_as1_y = 0.0
car_b_as1_z	= 0.0
//car_c_as1_x = 0.0
//car_c_as1_y = 0.0
//car_c_as1_z = 0.0
car_d_as1_x = 0.0
car_d_as1_y = 0.0
car_d_as1_z	= 0.0

ADD_BLIP_FOR_COORD cartel_a_x cartel_a_y -100.0 blip_cartel_a_as1
ADD_BLIP_FOR_COORD cartel_b_x cartel_b_y -100.0 blip_cartel_b_as1
//ADD_BLIP_FOR_COORD cartel_c_x cartel_c_y -100.0 blip_cartel_c_as1
ADD_BLIP_FOR_COORD cartel_d_x cartel_d_y -100.0 blip_cartel_d_as1
ADD_BLIP_FOR_COORD killzone_cent_x killzone_cent_y -100.0 blip_killzone
CHANGE_BLIP_COLOUR blip_killzone 4

DISPLAY_ONSCREEN_COUNTER_WITH_STRING counter_cartels_killed_as1 COUNTER_DISPLAY_NUMBER KILLS

SWITCH_ROADS_OFF killzone_min_x killzone_min_y 65.0 -1170.0 killzone_max_y 85.0 


// Mission stuff goes here
/*
REQUEST_MODEL PED_FEMALE1
WHILE NOT HAS_MODEL_LOADED PED_FEMALE1
	WAIT 0
ENDWHILE

REQUEST_MODEL PED_FEMALE2
WHILE NOT HAS_MODEL_LOADED PED_FEMALE2
	WAIT 0
ENDWHILE
*/
REQUEST_MODEL PED_GANG_YAKUZA_A
WHILE NOT HAS_MODEL_LOADED PED_GANG_YAKUZA_A
	WAIT 0
ENDWHILE

REQUEST_MODEL PED_GANG_YAKUZA_B
WHILE NOT HAS_MODEL_LOADED PED_GANG_YAKUZA_B
	WAIT 0
ENDWHILE

REQUEST_MODEL PED_GANG_COLOMBIAN_A
WHILE NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_A
	WAIT 0
ENDWHILE

REQUEST_MODEL PED_GANG_COLOMBIAN_B
WHILE NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_B
	WAIT 0
ENDWHILE

REQUEST_MODEL CAR_SENTINEL
WHILE NOT HAS_MODEL_LOADED CAR_SENTINEL
	WAIT 0
ENDWHILE

/*
REQUEST_MODEL PED_MALE3
WHILE NOT HAS_MODEL_LOADED PED_MALE3
	WAIT 0
ENDWHILE

REQUEST_MODEL PED_MALE4
WHILE NOT HAS_MODEL_LOADED PED_MALE4
	WAIT 0
ENDWHILE



PRINT_NOW ( AS1_A ) 4000 1 //"Go and find the Colombian death squads and lead them to the Kill Zone."
WAIT 4000
PRINT_NOW ( AS1_B ) 4000 1 //"But be careful! They are professionals and they're being paid to kill you!"
WAIT 4000
*/

RESET_NUM_OF_MODELS_KILLED_BY_PLAYER


WHILE counter_cartels_killed_as1 < 12

WAIT 0

	GET_PLAYER_COORDINATES player player_x player_y player_z
	
	IF LOCATE_PLAYER_ANY_MEANS_3D player killzone_min_x killzone_min_y 65.0 killzone_max_x killzone_max_y 75.0 false
		flag_wellybob = 1
	ELSE
		flag_wellybob = 0
	ENDIF 
	
	GOSUB yak_deaths

	IF counter_bailouts > counter_asukas_revenge
		PRINT_NOW (AS1_H) 3000 1 //you failed to lead the Deathsquad into the Yakuza trap!!
		GOTO mission_as1_failed
	ENDIF


	IF counter_yakuza_killed_as1 > 5
		PRINT_NOW ( AS1_G ) 3000 1 //Too many Yakuza are dead!!
		GOTO mission_as1_failed
	ENDIF
	
	GOSUB cartel_deaths

	GOSUB vegetables

  	GOSUB unhappy_car_check

//---------------------------------YAKUZA KILLZONE GENERATION-----------------------------------------------------------

	IF flag_yakuza_created_as1 = 0
		IF IS_PLAYER_IN_ZONE player SUB_IND
		OR IS_PLAYER_IN_ZONE player BIG_DAM
			IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN				
				
				IF flag_yak1_dead = 0
					CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A yak1_x yak1_y 70.0 yakuza1_as1
					SET_CHAR_HEADING yakuza1_as1 130.0
					CLEAR_CHAR_THREAT_SEARCH yakuza1_as1
					SET_CHAR_THREAT_SEARCH yakuza1_as1 THREAT_GANG_COLOMBIAN
					SET_CHAR_THREAT_SEARCH yakuza1_as1 THREAT_COP
					ADD_ARMOUR_TO_CHAR yakuza1_as1 100
					GIVE_WEAPON_TO_CHAR yakuza1_as1 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_STAY_IN_SAME_PLACE yakuza1_as1 true
				ENDIF

				IF flag_yak2_dead = 0	
					CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_B yak2_x yak2_y 72.06 yakuza2_as1
					SET_CHAR_HEADING yakuza2_as1 45.0
					CLEAR_CHAR_THREAT_SEARCH yakuza2_as1
					SET_CHAR_THREAT_SEARCH yakuza2_as1 THREAT_GANG_COLOMBIAN
					SET_CHAR_THREAT_SEARCH yakuza2_as1 THREAT_COP
					ADD_ARMOUR_TO_CHAR yakuza2_as1 100
					GIVE_WEAPON_TO_CHAR yakuza2_as1 WEAPONTYPE_SHOTGUN 999
					SET_CHAR_STAY_IN_SAME_PLACE yakuza2_as1 true
				ENDIF

				IF flag_yak3_dead = 0	
					CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_B yak3_x yak3_y 72.06 yakuza3_as1
					SET_CHAR_HEADING yakuza3_as1 295.0
					CLEAR_CHAR_THREAT_SEARCH yakuza3_as1
					SET_CHAR_THREAT_SEARCH yakuza3_as1 THREAT_GANG_COLOMBIAN
					SET_CHAR_THREAT_SEARCH yakuza3_as1 THREAT_COP
					ADD_ARMOUR_TO_CHAR yakuza3_as1 100
					GIVE_WEAPON_TO_CHAR yakuza3_as1 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_STAY_IN_SAME_PLACE yakuza3_as1 true
				ENDIF

				IF flag_yak4_dead = 0	
					CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A yak4_x yak4_y 72.06 yakuza4_as1
					SET_CHAR_HEADING yakuza4_as1 130.0
					CLEAR_CHAR_THREAT_SEARCH yakuza4_as1
					SET_CHAR_THREAT_SEARCH yakuza4_as1 THREAT_GANG_COLOMBIAN
					SET_CHAR_THREAT_SEARCH yakuza4_as1 THREAT_COP
					ADD_ARMOUR_TO_CHAR yakuza4_as1 100
					GIVE_WEAPON_TO_CHAR yakuza4_as1 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_STAY_IN_SAME_PLACE yakuza4_as1 true
				ENDIF

				IF flag_yak5_dead = 0	
					CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_A yak5_x yak5_y 72.44 yakuza5_as1
					SET_CHAR_HEADING yakuza5_as1 60.0
					CLEAR_CHAR_THREAT_SEARCH yakuza5_as1
					SET_CHAR_THREAT_SEARCH yakuza5_as1 THREAT_GANG_COLOMBIAN
					SET_CHAR_THREAT_SEARCH yakuza5_as1 THREAT_COP_CAR
					ADD_ARMOUR_TO_CHAR yakuza5_as1 100
					GIVE_WEAPON_TO_CHAR yakuza5_as1 WEAPONTYPE_CHAINGUN 999
					SET_CHAR_STAY_IN_SAME_PLACE yakuza5_as1 true
				ENDIF

				IF flag_yak6_dead = 0	
					CREATE_CHAR PEDTYPE_GANG_YAKUZA PED_GANG_YAKUZA_B yak6_x yak6_y 68.76 yakuza6_as1
					SET_CHAR_HEADING yakuza6_as1 180.0
					CLEAR_CHAR_THREAT_SEARCH yakuza6_as1
					SET_CHAR_THREAT_SEARCH yakuza6_as1 THREAT_GANG_COLOMBIAN
					SET_CHAR_THREAT_SEARCH yakuza6_as1 THREAT_COP_CAR
					ADD_ARMOUR_TO_CHAR yakuza6_as1 100
					GIVE_WEAPON_TO_CHAR yakuza6_as1 WEAPONTYPE_SHOTGUN 999
					SET_CHAR_STAY_IN_SAME_PLACE yakuza6_as1 true
				ENDIF


				flag_yakuza_created_as1 = 1
			ENDIF
		ENDIF
	ENDIF

	IF flag_yakuza_created_as1 = 1
		IF NOT IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
			DELETE_CHAR yakuza1_as1
			DELETE_CHAR yakuza2_as1
			DELETE_CHAR yakuza3_as1
			DELETE_CHAR yakuza4_as1
			DELETE_CHAR yakuza5_as1
			DELETE_CHAR yakuza6_as1
			flag_yakuza_created_as1 = 0
		ENDIF
		/*
		IF counter_yak_ammo = 0
			IF counter_asukas_revenge = 1
				IF NOT IS_CHAR_DEAD	yakuza1_as1
					ADD_AMMO_TO_CHAR yakuza1_as1 WEAPONTYPE_CHAINGUN 30
				ENDIF
				IF NOT IS_CHAR_DEAD	yakuza2_as1
					ADD_AMMO_TO_CHAR yakuza2_as1 WEAPONTYPE_SHOTGUN 7
				ENDIF
				IF NOT IS_CHAR_DEAD	yakuza3_as1
					ADD_AMMO_TO_CHAR yakuza3_as1 WEAPONTYPE_CHAINGUN 30
				ENDIF
				IF NOT IS_CHAR_DEAD	yakuza4_as1
					ADD_AMMO_TO_CHAR yakuza4_as1 WEAPONTYPE_M16 60
				ENDIF
				IF NOT IS_CHAR_DEAD	yakuza5_as1
					ADD_AMMO_TO_CHAR yakuza5_as1 WEAPONTYPE_M16 60
				ENDIF
				IF NOT IS_CHAR_DEAD	yakuza6_as1
					ADD_AMMO_TO_CHAR yakuza6_as1 WEAPONTYPE_SHOTGUN 7
				ENDIF
				++ counter_yak_ammo
			ENDIF
		ENDIF
		IF counter_yak_ammo = 1
			IF counter_asukas_revenge = 2
				IF NOT IS_CHAR_DEAD	yakuza1_as1
					ADD_AMMO_TO_CHAR yakuza1_as1 WEAPONTYPE_CHAINGUN 30
				ENDIF
				IF NOT IS_CHAR_DEAD	yakuza2_as1
					ADD_AMMO_TO_CHAR yakuza2_as1 WEAPONTYPE_SHOTGUN 7
				ENDIF
				IF NOT IS_CHAR_DEAD	yakuza3_as1
					ADD_AMMO_TO_CHAR yakuza3_as1 WEAPONTYPE_CHAINGUN 30
				ENDIF
				IF NOT IS_CHAR_DEAD	yakuza4_as1
					ADD_AMMO_TO_CHAR yakuza4_as1 WEAPONTYPE_M16 60
				ENDIF
				IF NOT IS_CHAR_DEAD	yakuza5_as1
					ADD_AMMO_TO_CHAR yakuza5_as1 WEAPONTYPE_M16 60
				ENDIF
				IF NOT IS_CHAR_DEAD	yakuza6_as1
					ADD_AMMO_TO_CHAR yakuza6_as1 WEAPONTYPE_SHOTGUN 7
				ENDIF
				++ counter_yak_ammo
			ENDIF
		ENDIF
		*/
  ENDIF



//--------------------------------CARTEL DEATH SQUAD 1 GENERATOR----------------------------------------


   
	IF flag_cartel_a_created = 0
			IF IS_PLAYER_IN_ZONE player SUB_IND
			OR IS_PLAYER_IN_ZONE player AIRPORT
				CREATE_CAR CAR_SENTINEL cartel_a_x cartel_a_y 34.0 cartel_car_a_as1
				SET_CAR_HEADING cartel_car_a_as1 270.0
				SET_UPSIDEDOWN_CAR_NOT_DAMAGED cartel_car_a_as1 true
				CREATE_CHAR_INSIDE_CAR cartel_car_a_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B cartel1_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_a_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 0 cartel2_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_a_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 1 cartel3_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_a_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 2 cartel4_as1
				CAR_SET_IDLE cartel_car_a_as1

				flag_cartel_a_created = 1
			ENDIF
	ENDIF


//-----------------------------------CARTEL DEATH SQUAD 1 ATTACK-----------------------------------------
		
		
		IF flag_cartel_a_created = 1

			IF flag_a_attack = 0
				IF LOCATE_PLAYER_ANY_MEANS_2D player cartel_a_x cartel_a_y 30.0 30.0 false
					IF NOT IS_CAR_DEAD cartel_car_a_as1
						SET_CAR_STRONG cartel_car_a_as1 TRUE
						LOCK_CAR_DOORS cartel_car_a_as1 CARLOCK_LOCKED
						SET_CAR_ONLY_DAMAGED_BY_PLAYER cartel_car_a_as1 True
						REMOVE_BLIP blip_cartel_a_as1
						SET_CAR_CRUISE_SPEED cartel_car_a_as1 50.0
						SET_CAR_MISSION cartel_car_a_as1 MISSION_RAMPLAYER_CLOSE
						SET_CAR_DRIVING_STYLE cartel_car_a_as1 2
						ADD_BLIP_FOR_CAR cartel_car_a_as1 blip_cartelcar_a
						SET_CAR_STAYS_IN_CURRENT_LEVEL cartel_car_a_as1 FALSE
						//SET_CAR_WATERTIGHT cartel_car_a_as1 TRUE
						flag_a_attack = 1
					ENDIF
				ELSE
					IF IS_CAR_DEAD cartel_car_a_as1
						REMOVE_BLIP	blip_cartel_a_as1
					ENDIF
				ENDIF
			ENDIF
			
			IF IS_CAR_DEAD cartel_car_a_as1
			AND flag_a_attack = 0
				PRINT_NOW (AS1_H) 3000 1 //you failed to lead the Deathsquad into the Yakuza trap!!
				GOTO mission_as1_failed
			ENDIF

			
			IF NOT IS_CAR_DEAD cartel_car_a_as1
				IF flag_bailout_a = 0
				AND flag_a_attack = 1	
					IF NOT LOCATE_CAR_2D cartel_car_a_as1 player_x player_y 40.0 40.0 false
						SET_CAR_CRUISE_SPEED cartel_car_a_as1 30.0
						//CAR_WANDER_RANDOMLY cartel_car_a_as1
						//SET_CAR_MISSION cartel_car_a_as1 MISSION_NONE
						//CAR_GOTO_COORDINATES cartel_car_a_as1 player_x player_y player_z
						//SET_CAR_DRIVING_STYLE cartel_car_a_as1 2
					ELSE
						SET_CAR_CRUISE_SPEED cartel_car_a_as1 60.0
						//SET_CAR_MISSION cartel_car_a_as1 MISSION_RAMPLAYER_FARAWAY
						//SET_CAR_DRIVING_STYLE cartel_car_a_as1 2
					ENDIF

					IF NOT IS_CAR_HEALTH_GREATER cartel_car_a_as1 250
						GOSUB bailout_a
					ENDIF
						
					IF NOT IS_PLAYER_IN_ANY_CAR player
					AND flag_bailout_a = 0
					AND NOT IS_CAR_DEAD cartel_car_a_as1
						IF flag_wellybob = 0
							GET_PLAYER_COORDINATES player player_x player_y player_z
							IF LOCATE_CAR_3D cartel_car_a_as1 player_x player_y player_z 10.0 10.0 5.0 false
								GOSUB bailout_a
							ENDIF
						ENDIF
					ENDIF
					IF NOT IS_CAR_DEAD cartel_car_a_as1
						IF LOCATE_CAR_3D cartel_car_a_as1 killzone_cent_x killzone_cent_y 70.0 17.0 30.0 3.0 false
						AND flag_bailout_a = 0
							SET_CAR_ONLY_DAMAGED_BY_PLAYER cartel_car_a_as1 false
							++ counter_asukas_revenge
							GOSUB bailout_a
						ENDIF
					ENDIF
				ENDIF
			ENDIF


			IF flag_bailout_a = 1
				IF NOT IS_CHAR_DEAD cartel1_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel1_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel2_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel2_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel3_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel3_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel4_as1
					IF LOCATE_CHAR_ON_FOOT_2D cartel4_as1 killzone_cent_x killzone_cent_y 15.0 15.0 false
					AND NOT IS_CHAR_DEAD yakuza1_as1
						SET_CHAR_OBJ_KILL_CHAR_ANY_MEANS cartel4_as1 yakuza1_as1
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel4_as1 player
					ENDIF
				ENDIF
			ENDIF

	
		ENDIF


//--------------------------------CARTEL DEATH SQUAD 2 GENERATOR-----------------------------------


   
	IF flag_cartel_b_created = 0
			IF IS_PLAYER_IN_ZONE player BIG_DAM
				CREATE_CAR CAR_SENTINEL cartel_b_x cartel_b_y 74.2 cartel_car_b_as1
				SET_UPSIDEDOWN_CAR_NOT_DAMAGED cartel_car_b_as1 true
				SET_CAR_HEADING cartel_car_b_as1 180.0
				CREATE_CHAR_INSIDE_CAR cartel_car_b_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A cartel5_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_b_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 0 cartel6_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_b_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1 cartel7_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_b_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 2 cartel8_as1
				CAR_SET_IDLE cartel_car_b_as1

				flag_cartel_b_created = 1
			ENDIF
	ENDIF


//-----------------------------------CARTEL DEATH SQUAD 2 ATTACK----------------------------------
		
		
		IF flag_cartel_b_created = 1

			IF flag_b_attack = 0
				IF LOCATE_PLAYER_ANY_MEANS_2D player cartel_b_x cartel_b_y 40.0 40.0 false
					IF NOT IS_CAR_DEAD cartel_car_b_as1
						SET_CAR_STRONG cartel_car_b_as1 TRUE
						LOCK_CAR_DOORS cartel_car_b_as1 CARLOCK_LOCKED
						SET_CAR_ONLY_DAMAGED_BY_PLAYER cartel_car_b_as1 True
						REMOVE_BLIP blip_cartel_b_as1
						SET_CAR_CRUISE_SPEED cartel_car_b_as1 50.0
						SET_CAR_MISSION cartel_car_b_as1 MISSION_RAMPLAYER_CLOSE
						SET_CAR_DRIVING_STYLE cartel_car_b_as1 2
						ADD_BLIP_FOR_CAR cartel_car_b_as1 blip_cartelcar_b
						SET_CAR_STAYS_IN_CURRENT_LEVEL cartel_car_b_as1 FALSE
						//SET_CAR_WATERTIGHT cartel_car_b_as1 TRUE
						flag_b_attack = 1
					ENDIF
				ELSE
					IF IS_CAR_DEAD cartel_car_b_as1
						REMOVE_BLIP	blip_cartel_b_as1
					ENDIF
				ENDIF
			ENDIF

			IF IS_CAR_DEAD cartel_car_b_as1
			AND flag_b_attack = 0
				PRINT_NOW (AS1_H) 3000 1 //you failed to lead the Deathsquad into the Yakuza trap!!
				GOTO mission_as1_failed
			ENDIF
			
			IF NOT IS_CAR_DEAD cartel_car_b_as1
				IF flag_bailout_b = 0
				AND flag_b_attack = 1
					IF NOT LOCATE_CAR_2D cartel_car_b_as1 player_x player_y 40.0 40.0 false
						SET_CAR_CRUISE_SPEED cartel_car_b_as1 30.0
						//CAR_WANDER_RANDOMLY cartel_car_b_as1
						//SET_CAR_MISSION cartel_car_b_as1 MISSION_NONE
						//CAR_GOTO_COORDINATES cartel_car_b_as1 player_x player_y player_z
						//SET_CAR_DRIVING_STYLE cartel_car_b_as1 2
					ELSE
						SET_CAR_CRUISE_SPEED cartel_car_b_as1 60.0
						//SET_CAR_MISSION cartel_car_b_as1 MISSION_RAMPLAYER_FARAWAY
						//SET_CAR_DRIVING_STYLE cartel_car_b_as1 2
					ENDIF
					/*
					IF IS_CAR_IN_AREA_2D cartel_car_b_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
						CAR_GOTO_COORDINATES cartel_car_b_as1 killzone_cent_x killzone_cent_y 70.0
					ENDIF
					*/
					IF NOT IS_CAR_HEALTH_GREATER cartel_car_b_as1 250
						GOSUB bailout_b
					ENDIF
					
					
					IF NOT IS_PLAYER_IN_ANY_CAR player
					AND flag_bailout_b = 0
					AND NOT IS_CAR_DEAD	cartel_car_b_as1
						IF flag_wellybob = 0
							GET_PLAYER_COORDINATES player player_x player_y player_z
							IF LOCATE_CAR_3D cartel_car_b_as1 player_x player_y player_z 10.0 10.0 5.0 false
								GOSUB bailout_b
							ENDIF
						ENDIF
					ENDIF
					IF NOT IS_CAR_DEAD cartel_car_b_as1
						IF LOCATE_CAR_3D cartel_car_b_as1 killzone_cent_x killzone_cent_y 70.0 17.0 30.0 3.0 false
						AND flag_bailout_b = 0												
							SET_CAR_ONLY_DAMAGED_BY_PLAYER cartel_car_b_as1 false
							++ counter_asukas_revenge
							GOSUB bailout_b
						ENDIF
					ENDIF
				ENDIF
			ENDIF


			IF flag_bailout_b = 1
				IF NOT IS_CHAR_DEAD cartel5_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel5_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel6_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel6_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel7_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel7_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel8_as1
					IF LOCATE_CHAR_ON_FOOT_2D cartel8_as1 killzone_cent_x killzone_cent_y 15.0 15.0 false
					AND NOT IS_CHAR_DEAD yakuza4_as1
						SET_CHAR_OBJ_KILL_CHAR_ANY_MEANS cartel8_as1 yakuza4_as1
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel8_as1 player
					ENDIF
				ENDIF
			ENDIF

	
		ENDIF

/*
//--------------------------------CARTEL DEATH SQUAD 3 GENERATOR-----------------------------------


   
	IF flag_cartel_c_created = 0
			IF IS_PLAYER_IN_ZONE player AIRPORT
				CREATE_CAR CAR_SENTINEL cartel_c_x cartel_c_y 9.0 cartel_car_c_as1
				SET_UPSIDEDOWN_CAR_NOT_DAMAGED cartel_car_c_as1 true
				SET_CAR_HEADING cartel_car_c_as1 55.0
				CREATE_CHAR_INSIDE_CAR cartel_car_c_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A cartel9_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_c_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 0 cartel10_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_c_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1 cartel11_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_c_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 2 cartel12_as1
				CAR_SET_IDLE cartel_car_c_as1

				flag_cartel_c_created = 1
			ENDIF
	ENDIF


//-----------------------------------CARTEL DEATH SQUAD 3 ATTACK----------------------------------
		
		
		IF flag_cartel_c_created = 1

			IF flag_c_attack = 0
				IF LOCATE_PLAYER_ANY_MEANS_2D player cartel_c_x cartel_c_y 30.0 30.0 false
					IF NOT IS_CAR_DEAD cartel_car_c_as1
						SET_CAR_STRONG cartel_car_c_as1 TRUE
						LOCK_CAR_DOORS cartel_car_c_as1 CARLOCK_LOCKED
						SET_CAR_ONLY_DAMAGED_BY_PLAYER cartel_car_c_as1 True
						REMOVE_BLIP blip_cartel_c_as1
						SET_CAR_CRUISE_SPEED cartel_car_c_as1 50.0
						SET_CAR_MISSION cartel_car_c_as1 MISSION_RAMPLAYER_CLOSE
						SET_CAR_DRIVING_STYLE cartel_car_c_as1 2
						ADD_BLIP_FOR_CAR cartel_car_c_as1 blip_cartelcar_c
						SET_CAR_STAYS_IN_CURRENT_LEVEL cartel_car_c_as1 FALSE
						flag_c_attack = 1
					ENDIF
				ELSE
					IF IS_CAR_DEAD cartel_car_c_as1
						REMOVE_BLIP	blip_cartel_c_as1
					ENDIF
				ENDIF
			ENDIF

			
			IF NOT IS_CAR_DEAD cartel_car_c_as1
				IF flag_bailout_c = 0
				AND flag_c_attack = 1	
					IF NOT LOCATE_CAR_2D cartel_car_c_as1 player_x player_y 40.0 40.0 false
						SET_CAR_CRUISE_SPEED cartel_car_c_as1 30.0
						//SET_CAR_MISSION cartel_car_c_as1 MISSION_NONE
						//CAR_GOTO_COORDINATES cartel_car_c_as1 player_x player_y player_z
						//SET_CAR_DRIVING_STYLE cartel_car_c_as1 2
					ELSE
						SET_CAR_CRUISE_SPEED cartel_car_c_as1 50.0
						//SET_CAR_MISSION cartel_car_c_as1 MISSION_RAMPLAYER_FARAWAY
						//SET_CAR_DRIVING_STYLE cartel_car_c_as1 2
					ENDIF
					
					IF NOT IS_CAR_HEALTH_GREATER cartel_car_c_as1 250
						GOSUB bailout_c
					ENDIF
					
					
					IF NOT IS_PLAYER_IN_ANY_CAR player
					AND flag_bailout_c = 0
					AND NOT IS_CAR_DEAD cartel_car_c_as1
						IF flag_wellybob = 0
							GET_PLAYER_COORDINATES player player_x player_y player_z
							IF LOCATE_CAR_3D cartel_car_c_as1 player_x player_y player_z 10.0 10.0 5.0 false
								GOSUB bailout_c
							ENDIF
						ENDIF
					ENDIF
					IF NOT IS_CAR_DEAD cartel_car_c_as1
						IF LOCATE_CAR_2D cartel_car_c_as1 killzone_cent_x killzone_cent_y 15.0 15.0 false
						AND flag_bailout_c = 0
							SET_CAR_ONLY_DAMAGED_BY_PLAYER cartel_car_c_as1 false
							++ counter_asukas_revenge
							GOSUB bailout_c
						ENDIF
					ENDIF
				ENDIF
			ENDIF


			IF flag_bailout_c = 1
				IF NOT IS_CHAR_DEAD cartel9_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel9_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel10_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel10_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel11_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel11_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel12_as1
					IF LOCATE_CHAR_ON_FOOT_2D cartel12_as1 killzone_cent_x killzone_cent_y 15.0 15.0 false
					AND NOT IS_CHAR_DEAD yakuza1_as1
						SET_CHAR_OBJ_KILL_CHAR_ANY_MEANS cartel12_as1 yakuza1_as1
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel12_as1 player
					ENDIF
				ENDIF
			ENDIF

	
		ENDIF

*/
//--------------------------------CARTEL DEATH SQUAD 4 GENERATOR-----------------------------------


   
	IF flag_cartel_d_created = 0
			IF LOCATE_PLAYER_ANY_MEANS_3D player cartel_d_x cartel_d_y 70.0 70.0 70.0 20.0 false
				CREATE_CAR CAR_SENTINEL cartel_d_x cartel_d_y 70.0 cartel_car_d_as1
				SET_UPSIDEDOWN_CAR_NOT_DAMAGED cartel_car_d_as1 true
				SET_CAR_HEADING cartel_car_d_as1 180.0
				CAR_SET_IDLE cartel_car_d_as1
				CREATE_CHAR_INSIDE_CAR cartel_car_d_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A cartel13_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_d_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 0 cartel14_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_d_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A 1 cartel15_as1
				CREATE_CHAR_AS_PASSENGER cartel_car_d_as1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B 2 cartel16_as1
				CAR_SET_IDLE cartel_car_d_as1
				
				flag_cartel_d_created = 1
			ENDIF
	ENDIF


//-----------------------------------CARTEL DEATH SQUAD 4 ATTACK----------------------------------
		
		
		IF flag_cartel_d_created = 1

			IF flag_d_attack = 0
				IF LOCATE_PLAYER_ANY_MEANS_3D player cartel_d_x cartel_d_y 70.0 30.0 30.0 20.0 false
					IF NOT IS_CAR_DEAD cartel_car_d_as1
						SET_CAR_STRONG cartel_car_d_as1 TRUE
						LOCK_CAR_DOORS cartel_car_d_as1 CARLOCK_LOCKED
						SET_CAR_ONLY_DAMAGED_BY_PLAYER cartel_car_d_as1 True
						REMOVE_BLIP blip_cartel_d_as1
						SET_CAR_CRUISE_SPEED cartel_car_d_as1 50.0
						SET_CAR_MISSION cartel_car_d_as1 MISSION_RAMPLAYER_CLOSE
						SET_CAR_DRIVING_STYLE cartel_car_d_as1 2
						ADD_BLIP_FOR_CAR cartel_car_d_as1 blip_cartelcar_d
						SET_CAR_STAYS_IN_CURRENT_LEVEL cartel_car_d_as1 FALSE
						//SET_CAR_WATERTIGHT cartel_car_d_as1 TRUE
						flag_d_attack = 1
					ENDIF
				ELSE
					IF IS_CAR_DEAD cartel_car_d_as1
						REMOVE_BLIP	blip_cartel_d_as1
					ENDIF
				ENDIF
			ENDIF

			IF IS_CAR_DEAD cartel_car_d_as1
			AND flag_d_attack = 0
				PRINT_NOW (AS1_H) 3000 1 //you failed to lead the Deathsquad into the Yakuza trap!!
				GOTO mission_as1_failed
			ENDIF
			
			IF NOT IS_CAR_DEAD cartel_car_d_as1
				IF flag_bailout_d = 0
				AND flag_d_attack = 1	
					IF NOT LOCATE_CAR_2D cartel_car_d_as1 player_x player_y 40.0 40.0 false
						SET_CAR_CRUISE_SPEED cartel_car_d_as1 30.0
						//CAR_WANDER_RANDOMLY cartel_car_d_as1
						//SET_CAR_MISSION cartel_car_d_as1 MISSION_NONE
						//CAR_GOTO_COORDINATES cartel_car_d_as1 player_x player_y player_z
						//SET_CAR_DRIVING_STYLE cartel_car_d_as1 2
					ELSE
						SET_CAR_CRUISE_SPEED cartel_car_d_as1 60.0
						//SET_CAR_MISSION cartel_car_d_as1 MISSION_RAMPLAYER_FARAWAY
						//SET_CAR_DRIVING_STYLE cartel_car_d_as1 2
					ENDIF
					/*
					IF IS_CAR_IN_AREA_2D cartel_car_d_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
						CAR_GOTO_COORDINATES cartel_car_d_as1 killzone_cent_x killzone_cent_y 70.0
					ENDIF
					*/
					IF NOT IS_CAR_HEALTH_GREATER cartel_car_d_as1 250
					//OR IS_CAR_UPSIDEDOWN cartel_car_d_as1
						GOSUB bailout_d
					ENDIF
					
					
					IF NOT IS_PLAYER_IN_ANY_CAR player
					AND flag_bailout_d = 0
					AND NOT IS_CAR_DEAD cartel_car_d_as1
						IF flag_wellybob = 0
							GET_PLAYER_COORDINATES player player_x player_y player_z
							IF LOCATE_CAR_3D cartel_car_d_as1 player_x player_y player_z 10.0 10.0 5.0 false
								GOSUB bailout_d
							ENDIF
						ENDIF
					ENDIF
					IF NOT IS_CAR_DEAD cartel_car_d_as1
						IF LOCATE_CAR_3D cartel_car_d_as1 killzone_cent_x killzone_cent_y 70.0 17.0 30.0 3.0 false
						AND flag_bailout_d = 0
							SET_CAR_ONLY_DAMAGED_BY_PLAYER cartel_car_d_as1 false
							++ counter_asukas_revenge
							GOSUB bailout_d
						ENDIF
					ENDIF
				ENDIF
			ENDIF


			IF flag_bailout_d = 1
				IF NOT IS_CHAR_DEAD cartel13_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel13_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel14_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel14_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel15_as1
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel15_as1 player
				ENDIF
				IF NOT IS_CHAR_DEAD cartel16_as1
					IF LOCATE_CHAR_ON_FOOT_2D cartel16_as1 killzone_cent_x killzone_cent_y 15.0 15.0 false
					AND NOT IS_CHAR_DEAD yakuza4_as1
						SET_CHAR_OBJ_KILL_CHAR_ANY_MEANS cartel16_as1 yakuza4_as1
					ELSE
						SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS cartel16_as1 player
					ENDIF
				ENDIF
			ENDIF

	
		ENDIF


//----------------------------------------------YAK1 MISSIONS------------------------------------------------------

		/*
		IF flag_yakuza_created_as1 = 1
			IF NOT IS_CHAR_DEAD yakuza1_as1
				IF flag_cartel_a_created = 1
					IF NOT IS_CHAR_DEAD cartel3_as1
					AND yak1_mission = 0
						IF IS_CHAR_IN_AREA_2D cartel3_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT yakuza1_as1 cartel3_as1
							yak1_mission = 1
						ENDIF
					ENDIF
				ENDIF

				IF flag_cartel_b_created = 1
					IF NOT IS_CHAR_DEAD cartel8_as1
					AND yak1_mission = 0
						IF IS_CHAR_IN_AREA_2D cartel8_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT yakuza1_as1 cartel8_as1
							yak1_mission = 2
						ENDIF
					ENDIF
				ENDIF
				
				IF flag_cartel_c_created = 1
					IF NOT IS_CHAR_DEAD cartel9_as1
					AND yak1_mission = 0
						IF IS_CHAR_IN_AREA_2D cartel9_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT yakuza1_as1 cartel9_as1
							yak1_mission = 3
						ENDIF
					ENDIF
					IF NOT IS_CHAR_DEAD cartel10_as1
					AND yak1_mission = 0
						IF IS_CHAR_IN_AREA_2D cartel10_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT yakuza1_as1 cartel10_as1
							yak1_mission = 4
						ENDIF
					ENDIF
					IF NOT IS_CHAR_DEAD cartel11_as1
					AND yak1_mission = 0
						IF IS_CHAR_IN_AREA_2D cartel11_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT yakuza1_as1 cartel11_as1
							yak1_mission = 5
						ENDIF
					ENDIF
					IF NOT IS_CHAR_DEAD cartel12_as1
					AND yak1_mission = 0
						IF IS_CHAR_IN_AREA_2D cartel12_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT yakuza1_as1 cartel12_as1
							yak1_mission = 6
						ENDIF
					ENDIF
				ENDIF

				IF flag_cartel_d_created = 1
					IF NOT IS_CHAR_DEAD cartel16_as1
					AND yak1_mission = 0
						IF IS_CHAR_IN_AREA_2D cartel16_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
							SET_CHAR_OBJ_KILL_CHAR_ON_FOOT yakuza1_as1 cartel16_as1
							yak1_mission = 7
						ENDIF
					ENDIF
				ENDIF
				
			ENDIF
		ENDIF
		*/
//------------------------------------------YAK4 MISSIONS---------------------------------------------
		/*
		IF flag_yakuza_created_as1 = 1
			IF NOT IS_CHAR_DEAD yakuza4_as1
				IF flag_cartel_a_created = 1
					IF NOT IS_CAR_DEAD cartel_car_a_as1
					AND yak4_mission = 0
						IF IS_CAR_IN_AREA_2D cartel_car_a_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
							SET_CHAR_OBJ_DESTROY_CAR yakuza4_as1 cartel_car_a_as1
							yak4_mission = 1
						ENDIF
					ENDIF
				ENDIF
				IF flag_cartel_b_created = 1
					IF NOT IS_CAR_DEAD cartel_car_b_as1
					AND yak4_mission = 0
						IF IS_CAR_IN_AREA_2D cartel_car_b_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
							SET_CHAR_OBJ_DESTROY_CAR yakuza4_as1 cartel_car_b_as1
							yak4_mission = 2
						ENDIF
					ENDIF
				ENDIF
				
				IF flag_cartel_c_created = 1
					IF NOT IS_CAR_DEAD cartel_car_c_as1
					AND yak4_mission = 0
						IF IS_CAR_IN_AREA_2D cartel_car_c_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
							SET_CHAR_OBJ_DESTROY_CAR yakuza4_as1 cartel_car_c_as1
							yak4_mission = 3
						ENDIF
					ENDIF
				ENDIF
				
				IF flag_cartel_d_created = 1
					IF NOT IS_CAR_DEAD cartel_car_d_as1
					AND yak4_mission = 0
						IF IS_CAR_IN_AREA_2D cartel_car_d_as1 killzone_min_x killzone_min_y killzone_max_x killzone_max_y false
							SET_CHAR_OBJ_DESTROY_CAR yakuza4_as1 cartel_car_d_as1
							yak4_mission = 4
						ENDIF
					ENDIF
				ENDIF
				
			ENDIF
		ENDIF
		*/


ENDWHILE    	


IF counter_asukas_revenge > 2
	GOTO mission_as1_passed
ELSE
	PRINT_NOW (AS1_H) 3000 1
ENDIF
	   		


// Mission Asuka Sub1 failed

mission_as1_failed:
PRINT_BIG ( M_FAIL ) 2000 1

IF HAS_PLAYER_BEEN_ARRESTED player
	OVERRIDE_POLICE_STATION_LEVEL LEVEL_COMMERCIAL
ENDIF

IF IS_PLAYER_DEAD player
	OVERRIDE_HOSPITAL_LEVEL LEVEL_COMMERCIAL
ENDIF

RETURN

   

// mission Asuka Sub1 passed

mission_as1_passed:

flag_asuka_suburban_mission1_passed = 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 35000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
CLEAR_WANTED_LEVEL player
ADD_SCORE player 35000
REGISTER_MISSION_PASSED AS1 
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT asuka_suburban_mission2_loop
RETURN
		


// mission cleanup

mission_cleanup_as1:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_asuka_suburban_mission = 0

CLEAR_ONSCREEN_COUNTER counter_cartels_killed_as1

GOSUB blip_removal

REMOVE_BLIP blip_cartel_a_as1
REMOVE_BLIP blip_cartel_b_as1
//REMOVE_BLIP blip_cartel_c_as1
REMOVE_BLIP blip_cartel_d_as1
REMOVE_BLIP blip_killzone
REMOVE_BLIP blip_cartelcar_a
REMOVE_BLIP blip_cartelcar_b
//REMOVE_BLIP blip_cartelcar_c
REMOVE_BLIP blip_cartelcar_d

MARK_CAR_AS_NO_LONGER_NEEDED cartel_car_a_as1
MARK_CAR_AS_NO_LONGER_NEEDED cartel_car_b_as1
//MARK_CAR_AS_NO_LONGER_NEEDED cartel_car_c_as1
MARK_CAR_AS_NO_LONGER_NEEDED cartel_car_d_as1

MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_YAKUZA_B
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_B
//MARK_MODEL_AS_NO_LONGER_NEEDED PED_FEMALE1
//MARK_MODEL_AS_NO_LONGER_NEEDED PED_FEMALE2
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SENTINEL

//SWITCH_ROADS_ON killzone_min_x killzone_min_y 65.0 -1170.0 killzone_max_y 85.0 


MISSION_HAS_FINISHED
RETURN
		

///________________________________GOSUBS_______GOSUBS________________________________BYTHEWAY


//-----------------------------------------CHECK FOR YAK DEATHS-------------------------------

yak_deaths:


	IF flag_yakuza_created_as1 = 1
		IF IS_CHAR_DEAD yakuza1_as1
			IF flag_yak1_dead = 0	
				++ counter_yakuza_killed_as1
				flag_yak1_dead = 1
			ENDIF
		ENDIF

		IF IS_CHAR_DEAD yakuza2_as1
			IF flag_yak2_dead = 0	
				++ counter_yakuza_killed_as1
				flag_yak2_dead = 1
			ENDIF
		ENDIF

		IF IS_CHAR_DEAD yakuza3_as1
			IF flag_yak3_dead = 0	
				++ counter_yakuza_killed_as1
				flag_yak3_dead = 1
			ENDIF
		ENDIF

		IF IS_CHAR_DEAD yakuza4_as1
			IF flag_yak4_dead = 0	
				++ counter_yakuza_killed_as1
				flag_yak4_dead = 1
			ENDIF
		ENDIF

		IF IS_CHAR_DEAD yakuza5_as1
			IF flag_yak5_dead = 0	
				++ counter_yakuza_killed_as1
				flag_yak5_dead = 1
			ENDIF
		ENDIF

		IF IS_CHAR_DEAD yakuza6_as1
			IF flag_yak6_dead = 0	
				++ counter_yakuza_killed_as1
				flag_yak6_dead = 1
			ENDIF
		ENDIF
		
		GET_NUM_OF_MODELS_KILLED_BY_PLAYER PED_GANG_YAKUZA_A yaks_a_killed_by_player
		GET_NUM_OF_MODELS_KILLED_BY_PLAYER PED_GANG_YAKUZA_B yaks_b_killed_by_player
		yaks_killed_by_player = yaks_a_killed_by_player + yaks_b_killed_by_player

		IF yaks_killed_by_player > 2
			IF NOT IS_CHAR_DEAD yakuza1_as1
				SET_CHAR_THREAT_SEARCH yakuza1_as1 THREAT_PLAYER1
			ENDIF
			IF NOT IS_CHAR_DEAD yakuza2_as1
				SET_CHAR_THREAT_SEARCH yakuza2_as1 THREAT_PLAYER1
			ENDIF
			IF NOT IS_CHAR_DEAD yakuza3_as1
				SET_CHAR_THREAT_SEARCH yakuza3_as1 THREAT_PLAYER1
			ENDIF
			IF NOT IS_CHAR_DEAD yakuza4_as1
				SET_CHAR_THREAT_SEARCH yakuza4_as1 THREAT_PLAYER1
			ENDIF
			IF NOT IS_CHAR_DEAD yakuza5_as1
				SET_CHAR_THREAT_SEARCH yakuza5_as1 THREAT_PLAYER1
			ENDIF
			IF NOT IS_CHAR_DEAD yakuza6_as1
				SET_CHAR_THREAT_SEARCH yakuza6_as1 THREAT_PLAYER1
			ENDIF
	   ENDIF
	ENDIF
RETURN


//-----------------------------------------------------'BAILOUTS'----------------

bailout_a:
	
IF flag_bailout_a = 0
	//flag_cartelcar_a_dead = 1
	flag_bailout_a = 1
	++ counter_bailouts
	
	REMOVE_BLIP blip_cartelcar_a
	LOCK_CAR_DOORS cartel_car_a_as1 CARLOCK_UNLOCKED 
	IF NOT IS_CHAR_DEAD cartel1_as1
	AND NOT IS_CAR_DEAD	cartel_car_a_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel1_as1 cartel_car_a_as1
		WHILE IS_CHAR_IN_CAR cartel1_as1 cartel_car_a_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel1_as1
				GOTO c_a_2
			ENDIF
			IF IS_CAR_DEAD cartel_car_a_as1
				GOTO c_a_2
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel1_as1
		SET_CHAR_THREAT_SEARCH cartel1_as1 THREAT_PLAYER1 
		GIVE_WEAPON_TO_CHAR cartel1_as1 WEAPONTYPE_M16 100
		ADD_BLIP_FOR_CHAR cartel1_as1 blip_cartel1
	ENDIF

	c_a_2:
	IF NOT IS_CHAR_DEAD cartel2_as1
	AND NOT IS_CAR_DEAD	cartel_car_a_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel2_as1 cartel_car_a_as1
		WHILE IS_CHAR_IN_CAR cartel2_as1 cartel_car_a_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel2_as1
				GOTO c_a_3
			ENDIF
			IF IS_CAR_DEAD cartel_car_a_as1
				GOTO c_a_3
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel2_as1
		SET_CHAR_THREAT_SEARCH cartel2_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel2_as1 WEAPONTYPE_M16 100
		ADD_BLIP_FOR_CHAR cartel2_as1 blip_cartel2
	ENDIF

	c_a_3:
	IF NOT IS_CHAR_DEAD cartel3_as1
	AND NOT IS_CAR_DEAD	cartel_car_a_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel3_as1 cartel_car_a_as1
		WHILE IS_CHAR_IN_CAR cartel3_as1 cartel_car_a_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel3_as1
				GOTO c_a_4
			ENDIF
			IF IS_CAR_DEAD cartel_car_a_as1
				GOTO c_a_4
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel3_as1
		SET_CHAR_THREAT_SEARCH cartel3_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel3_as1 WEAPONTYPE_SHOTGUN 15
		ADD_BLIP_FOR_CHAR cartel3_as1 blip_cartel3
	ENDIF

	c_a_4:
	IF NOT IS_CHAR_DEAD cartel4_as1
	AND NOT IS_CAR_DEAD	cartel_car_a_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel4_as1 cartel_car_a_as1
		WHILE IS_CHAR_IN_CAR cartel4_as1 cartel_car_a_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel4_as1
				GOTO c_a_5
			ENDIF
			IF IS_CAR_DEAD cartel_car_a_as1
				GOTO c_a_5
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel4_as1
		SET_CHAR_THREAT_SEARCH cartel4_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel4_as1 WEAPONTYPE_SHOTGUN 15
		ADD_BLIP_FOR_CHAR cartel4_as1 blip_cartel4
	ENDIF

	c_a_5:
	//MARK_CAR_AS_NO_LONGER_NEEDED cartel_car_a_as1
ENDIF
RETURN


bailout_b:
IF flag_bailout_b = 0
	//flag_cartelcar_b_dead = 1
	flag_bailout_b = 1
	++ counter_bailouts
	
	REMOVE_BLIP blip_cartelcar_b
	LOCK_CAR_DOORS cartel_car_b_as1 CARLOCK_UNLOCKED
	IF NOT IS_CHAR_DEAD cartel5_as1
	AND NOT IS_CAR_DEAD	cartel_car_b_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel5_as1 cartel_car_b_as1
		WHILE IS_CHAR_IN_CAR cartel5_as1 cartel_car_b_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel5_as1
				GOTO c_b_2
			ENDIF
			IF IS_CAR_DEAD cartel_car_b_as1
				GOTO c_b_2
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel5_as1
		SET_CHAR_THREAT_SEARCH cartel5_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel5_as1 WEAPONTYPE_UZI 90
		ADD_BLIP_FOR_CHAR cartel5_as1 blip_cartel5
	ENDIF

	c_b_2:
	IF NOT IS_CHAR_DEAD cartel6_as1
	AND NOT IS_CAR_DEAD	cartel_car_b_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel6_as1 cartel_car_b_as1
		WHILE IS_CHAR_IN_CAR cartel6_as1 cartel_car_b_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel6_as1
				GOTO c_b_3
			ENDIF
			IF IS_CAR_DEAD cartel_car_b_as1
				GOTO c_b_3
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel6_as1
		SET_CHAR_THREAT_SEARCH cartel6_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel6_as1 WEAPONTYPE_UZI 90
		ADD_BLIP_FOR_CHAR cartel6_as1 blip_cartel6
	ENDIF

	c_b_3:
	IF NOT IS_CHAR_DEAD cartel7_as1
	AND NOT IS_CAR_DEAD	cartel_car_b_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel7_as1 cartel_car_b_as1
		WHILE IS_CHAR_IN_CAR cartel7_as1 cartel_car_b_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel7_as1
				GOTO c_b_4
			ENDIF
			IF IS_CAR_DEAD cartel_car_b_as1
				GOTO c_b_4
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel7_as1
		SET_CHAR_THREAT_SEARCH cartel7_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel7_as1 WEAPONTYPE_UZI 90
		ADD_BLIP_FOR_CHAR cartel7_as1 blip_cartel7
	ENDIF

	c_b_4:
	IF NOT IS_CHAR_DEAD cartel8_as1
	AND NOT IS_CAR_DEAD	cartel_car_b_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel8_as1 cartel_car_b_as1
		WHILE IS_CHAR_IN_CAR cartel8_as1 cartel_car_b_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel8_as1
				GOTO c_b_5
			ENDIF
			IF IS_CAR_DEAD cartel_car_b_as1
				GOTO c_b_5
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel8_as1
		SET_CHAR_THREAT_SEARCH cartel8_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel8_as1 WEAPONTYPE_M16 100
		ADD_BLIP_FOR_CHAR cartel8_as1 blip_cartel8
	ENDIF

	c_b_5:
	//MARK_CAR_AS_NO_LONGER_NEEDED cartel_car_b_as1
ENDIF
RETURN
/*
bailout_c:
IF flag_bailout_c = 0
	REMOVE_BLIP blip_cartelcar_c
	LOCK_CAR_DOORS cartel_car_c_as1 CARLOCK_UNLOCKED
	IF NOT IS_CHAR_DEAD cartel9_as1
	AND NOT IS_CAR_DEAD	cartel_car_c_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel9_as1 cartel_car_c_as1
		WHILE IS_CHAR_IN_CAR cartel9_as1 cartel_car_c_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel9_as1
				GOTO c_c_2
			ENDIF
			IF IS_CAR_DEAD cartel_car_c_as1
				GOTO c_c_2
			ENDIF
		ENDWHILE
		SET_CHAR_THREAT_SEARCH cartel9_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel9_as1 WEAPONTYPE_SHOTGUN 10
		ADD_BLIP_FOR_CHAR cartel9_as1 blip_cartel9
	ENDIF

	c_c_2:
	IF NOT IS_CHAR_DEAD cartel10_as1
	AND NOT IS_CAR_DEAD	cartel_car_c_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel10_as1 cartel_car_c_as1
		WHILE IS_CHAR_IN_CAR cartel10_as1 cartel_car_c_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel10_as1
				GOTO c_c_3
			ENDIF
			IF IS_CAR_DEAD cartel_car_c_as1
				GOTO c_c_3
			ENDIF
		ENDWHILE
		SET_CHAR_THREAT_SEARCH cartel10_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel10_as1 WEAPONTYPE_M16 100
		ADD_BLIP_FOR_CHAR cartel10_as1 blip_cartel10
	ENDIF

	c_c_3:
	IF NOT IS_CHAR_DEAD cartel11_as1
	AND NOT IS_CAR_DEAD	cartel_car_c_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel11_as1 cartel_car_c_as1
		WHILE IS_CHAR_IN_CAR cartel11_as1 cartel_car_c_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel11_as1
				GOTO c_c_4
			ENDIF
			IF IS_CAR_DEAD cartel_car_c_as1
				GOTO c_c_4
			ENDIF
		ENDWHILE
		SET_CHAR_THREAT_SEARCH cartel11_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel11_as1 WEAPONTYPE_M16 100
		ADD_BLIP_FOR_CHAR cartel11_as1 blip_cartel11
	ENDIF

	c_c_4:
	IF NOT IS_CHAR_DEAD cartel12_as1
	AND NOT IS_CAR_DEAD	cartel_car_c_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel12_as1 cartel_car_c_as1
		WHILE IS_CHAR_IN_CAR cartel12_as1 cartel_car_c_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel12_as1
				GOTO c_c_5
			ENDIF
			IF IS_CAR_DEAD cartel_car_c_as1
				GOTO c_c_5
			ENDIF
		ENDWHILE
		SET_CHAR_THREAT_SEARCH cartel12_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel12_as1 WEAPONTYPE_SHOTGUN 15
		ADD_BLIP_FOR_CHAR cartel12_as1 blip_cartel12
	ENDIF

	c_c_5:
	flag_cartelcar_c_dead = 1
	flag_bailout_c = 1
	++ counter_bailouts
	//MARK_CAR_AS_NO_LONGER_NEEDED cartel_car_c_as1
ENDIF
RETURN
*/
bailout_d:
IF flag_bailout_d = 0
	//flag_cartelcar_d_dead = 1
	flag_bailout_d = 1
	++ counter_bailouts
	
	REMOVE_BLIP blip_cartelcar_d
	LOCK_CAR_DOORS cartel_car_d_as1 CARLOCK_UNLOCKED
	IF NOT IS_CHAR_DEAD cartel13_as1
	AND NOT IS_CAR_DEAD	cartel_car_d_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel13_as1 cartel_car_d_as1
		WHILE IS_CHAR_IN_CAR cartel13_as1 cartel_car_d_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel13_as1
				GOTO c_d_2
			ENDIF
			IF IS_CAR_DEAD cartel_car_d_as1
				GOTO c_d_2
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel13_as1
		SET_CHAR_THREAT_SEARCH cartel13_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel13_as1 WEAPONTYPE_M16 100
		ADD_BLIP_FOR_CHAR cartel13_as1 blip_cartel13
	ENDIF

	c_d_2:
	IF NOT IS_CHAR_DEAD cartel14_as1
	AND NOT IS_CAR_DEAD	cartel_car_d_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel14_as1 cartel_car_d_as1
		WHILE IS_CHAR_IN_CAR cartel14_as1 cartel_car_d_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel14_as1
				GOTO c_d_3
			ENDIF
			IF IS_CAR_DEAD cartel_car_d_as1
				GOTO c_d_3
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel14_as1
		SET_CHAR_THREAT_SEARCH cartel14_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel14_as1 WEAPONTYPE_M16 100
		ADD_BLIP_FOR_CHAR cartel14_as1 blip_cartel14
	ENDIF

	c_d_3:
	IF NOT IS_CHAR_DEAD cartel15_as1
	AND NOT IS_CAR_DEAD	cartel_car_d_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel15_as1 cartel_car_d_as1
		WHILE IS_CHAR_IN_CAR cartel15_as1 cartel_car_d_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel15_as1
				GOTO c_d_4
			ENDIF
			IF IS_CAR_DEAD cartel_car_d_as1
				GOTO c_d_4
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel15_as1
		SET_CHAR_THREAT_SEARCH cartel15_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel15_as1 WEAPONTYPE_SHOTGUN 15
		ADD_BLIP_FOR_CHAR cartel15_as1 blip_cartel15
	ENDIF

	c_d_4:
	IF NOT IS_CHAR_DEAD cartel16_as1
	AND NOT IS_CAR_DEAD	cartel_car_d_as1
		SET_CHAR_OBJ_LEAVE_CAR cartel16_as1 cartel_car_d_as1
		WHILE IS_CHAR_IN_CAR cartel16_as1 cartel_car_d_as1
			WAIT 0
			IF IS_CHAR_DEAD cartel16_as1
				GOTO c_d_5
			ENDIF
			IF IS_CAR_DEAD cartel_car_d_as1
				GOTO c_d_5
			ENDIF
		ENDWHILE
		//CLEAR_CHAR_THREAT_SEARCH cartel16_as1
		SET_CHAR_THREAT_SEARCH cartel16_as1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR cartel16_as1 WEAPONTYPE_M16 100
		ADD_BLIP_FOR_CHAR cartel16_as1 blip_cartel16
	ENDIF

	c_d_5:
	//MARK_CAR_AS_NO_LONGER_NEEDED cartel_car_d_as1
ENDIF
RETURN

//-----------------------------------------------CARTEL DEATHS-----------------------------
cartel_deaths:

IF flag_cartel_a_created = 1
	
	IF cartel1_as1_dead = 0
		IF IS_CHAR_DEAD cartel1_as1
			IF cartel1_as1_dead = 0
				cartel1_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel1
			ENDIF
		ENDIF 
	ENDIF


	IF cartel2_as1_dead = 0
		IF IS_CHAR_DEAD cartel2_as1
			IF cartel2_as1_dead = 0
				cartel2_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel2
			ENDIF
		ENDIF 
	ENDIF


	IF cartel3_as1_dead = 0
		IF IS_CHAR_DEAD cartel3_as1
			IF cartel3_as1_dead = 0
				cartel3_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel3
				IF yak1_mission = 1
					yak1_mission = 0
				ENDIF
			ENDIF
		ENDIF 
	ENDIF


	IF cartel4_as1_dead = 0
		IF IS_CHAR_DEAD cartel4_as1
			IF cartel4_as1_dead = 0
				cartel4_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel4
			ENDIF
		ENDIF
	ENDIF
	
	IF cartel4_as1_dead = 1
		IF cartel3_as1_dead = 1
			IF cartel2_as1_dead = 1
				IF cartel1_as1_dead = 1
					IF flag_bailout_a =0
						++ counter_bailouts
						flag_bailout_a = 1
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF 
	 
ENDIF

IF flag_cartel_b_created = 1
	IF cartel5_as1_dead = 0
		IF IS_CHAR_DEAD cartel5_as1
			IF cartel5_as1_dead = 0
				cartel5_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel5
			ENDIF
		ENDIF
	ENDIF 



	IF cartel6_as1_dead = 0
		IF IS_CHAR_DEAD cartel6_as1
			IF cartel6_as1_dead = 0
				cartel6_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel6
			ENDIF
		ENDIF
	ENDIF 



	IF cartel7_as1_dead = 0
		IF IS_CHAR_DEAD cartel7_as1
			IF cartel7_as1_dead = 0
				cartel7_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel7
			ENDIF
		ENDIF
	ENDIF 



	IF cartel8_as1_dead = 0
		IF IS_CHAR_DEAD cartel8_as1
			IF cartel8_as1_dead = 0
				cartel8_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel8
				IF yak1_mission = 2
					yak1_mission = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
	IF cartel8_as1_dead = 1
		IF cartel7_as1_dead = 1
			IF cartel6_as1_dead = 1
				IF cartel5_as1_dead = 1
					IF flag_bailout_b =0
						++ counter_bailouts
						flag_bailout_b = 1
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	 
ENDIF
/*
IF flag_cartel_c_created = 1
	IF cartel9_as1_dead = 0
		IF IS_CHAR_DEAD cartel9_as1
			IF cartel9_as1_dead = 0
				cartel9_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel9
				IF yak1_mission = 3
					yak1_mission = 0
				ENDIF
			ENDIF
		ENDIF 
	ENDIF


	IF cartel10_as1_dead = 0
		IF IS_CHAR_DEAD cartel10_as1
			IF cartel10_as1_dead = 0
				cartel10_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel10
				IF yak1_mission = 4
					yak1_mission = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF 


	IF cartel11_as1_dead = 0
		IF IS_CHAR_DEAD cartel11_as1
			IF cartel11_as1_dead = 0
				cartel11_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel11
				IF yak1_mission = 5
					yak1_mission = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF 


	IF cartel12_as1_dead = 0
		IF IS_CHAR_DEAD cartel12_as1
			IF cartel12_as1_dead = 0
				cartel12_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel12
				IF yak1_mission = 6
					yak1_mission = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
	
	
	IF cartel12_as1_dead = 1
		IF cartel11_as1_dead = 1
			IF cartel10_as1_dead = 1
				IF cartel9_as1_dead = 1
					flag_cartel_c_created = 2
				ENDIF
			ENDIF
		ENDIF
	ENDIF 
	 
ENDIF
*/
IF flag_cartel_d_created = 1
	IF cartel13_as1_dead = 0
		IF IS_CHAR_DEAD cartel13_as1
			IF cartel13_as1_dead = 0
				cartel13_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel13
			ENDIF
		ENDIF
	ENDIF 


	IF cartel14_as1_dead = 0
		IF IS_CHAR_DEAD cartel14_as1
			IF cartel14_as1_dead = 0
				cartel14_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel14
			ENDIF
		ENDIF
	ENDIF 


	IF cartel15_as1_dead = 0
		IF IS_CHAR_DEAD cartel15_as1
			IF cartel15_as1_dead = 0
				cartel15_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel15
			ENDIF
		ENDIF 
	ENDIF


	IF cartel16_as1_dead = 0
		IF IS_CHAR_DEAD cartel16_as1
			IF cartel16_as1_dead = 0
				cartel16_as1_dead = 1
				++ counter_cartels_killed_as1
				REMOVE_BLIP blip_cartel16
				IF yak1_mission = 7
					yak1_mission = 0
				ENDIF
			ENDIF
		ENDIF
	ENDIF
	
	IF cartel16_as1_dead = 1
		IF cartel15_as1_dead = 1
			IF cartel14_as1_dead = 1
				IF cartel13_as1_dead = 1
					IF flag_bailout_d =0
						++ counter_bailouts
						flag_bailout_d = 1
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	ENDIF 
	 
ENDIF


RETURN

//------------------------------------STUCK CAR ROUTINES-------------------------------------

cartel_car_a_stuck:

		IF NOT IS_CAR_DEAD cartel_car_a_as1

			IF IS_CAR_UPSIDEDOWN cartel_car_a_as1
			AND IS_CAR_STOPPED cartel_car_a_as1
				IF NOT IS_CAR_ON_SCREEN cartel_car_a_as1
					GET_CAR_COORDINATES cartel_car_a_as1 cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z cartel_heading
					IF NOT IS_POINT_ON_SCREEN cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z 3.0
						SET_CAR_COORDINATES cartel_car_a_as1 cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z
						SET_CAR_HEADING	cartel_car_a_as1 cartel_heading
						SET_JAMES_CAR_ON_PATH_TO_PLAYER cartel_car_a_as1
					ENDIF
				ELSE
					GOSUB bailout_a
				ENDIF
			ENDIF

			IF IS_CAR_IN_WATER cartel_car_a_as1
				//PRINT_BIG (Y1_TEST) 2000 1//CAR IN WATER!! ---test stuff
				IF NOT IS_CAR_ON_SCREEN cartel_car_a_as1
					GET_CAR_COORDINATES cartel_car_a_as1 cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z cartel_heading
					IF NOT IS_POINT_ON_SCREEN cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z 3.0
						SET_CAR_COORDINATES cartel_car_a_as1 cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z
						SET_CAR_HEADING	cartel_car_a_as1 cartel_heading
						SET_JAMES_CAR_ON_PATH_TO_PLAYER cartel_car_a_as1
					ENDIF
				ELSE
					flag_bailout_a = 1
					++ counter_bailouts
					REMOVE_BLIP	blip_cartelcar_a
					SET_CAR_WATERTIGHT cartel_car_a_as1 FALSE
					GOSUB cartel_deaths
					RETURN
				ENDIF
			ENDIF
			/*
			IF timer_reset_car_a = 1
				IF NOT IS_CAR_STOPPED cartel_car_a_as1
					timer_reset_car_a = 0
				ENDIF
			ENDIF
					
			IF IS_CAR_STOPPED cartel_car_a_as1
				IF timer_reset_car_a = 0
					GET_GAME_TIMER timer_start_car_a
					timer_reset_car_a = 1
				ENDIF

				IF timer_reset_car_a = 1
					GET_GAME_TIMER timer_current_car_a
					car_a_time_dif = timer_current_car_a - timer_start_car_a
				ENDIF

				IF car_a_time_dif > 4000
					IF NOT IS_CAR_ON_SCREEN cartel_car_a_as1
						GET_CAR_COORDINATES cartel_car_a_as1 cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z
						GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z cartel_heading
						IF NOT IS_POINT_ON_SCREEN cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z 3.0
							SET_CAR_COORDINATES cartel_car_a_as1 cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z
							SET_CAR_HEADING	cartel_car_a_as1 cartel_heading
							timer_reset_car_a = 0
						ENDIF
					ENDIF
				ENDIF
			ENDIF*/
		ELSE
			REMOVE_BLIP	blip_cartelcar_a
		ENDIF

RETURN

cartel_car_b_stuck:

		IF NOT IS_CAR_DEAD cartel_car_b_as1
			IF IS_CAR_UPSIDEDOWN cartel_car_b_as1
			AND IS_CAR_STOPPED cartel_car_b_as1
				IF NOT IS_CAR_ON_SCREEN cartel_car_b_as1
					GET_CAR_COORDINATES cartel_car_b_as1 cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z cartel_heading
					IF NOT IS_POINT_ON_SCREEN cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z 3.0
						SET_CAR_COORDINATES cartel_car_b_as1 cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z
						SET_CAR_HEADING cartel_car_b_as1 cartel_heading
						SET_JAMES_CAR_ON_PATH_TO_PLAYER cartel_car_b_as1
					ENDIF
				ELSE
					GOSUB bailout_b
				ENDIF
			ENDIF

			IF IS_CAR_IN_WATER cartel_car_b_as1
				//PRINT_BIG (Y1_TEST) 2000 1//CAR IN WATER!!----test stuff
				IF NOT IS_CAR_ON_SCREEN cartel_car_b_as1
					GET_CAR_COORDINATES cartel_car_b_as1 cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z cartel_heading
					IF NOT IS_POINT_ON_SCREEN cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z 3.0
						SET_CAR_COORDINATES cartel_car_b_as1 cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z
						SET_CAR_HEADING cartel_car_b_as1 cartel_heading
						SET_JAMES_CAR_ON_PATH_TO_PLAYER cartel_car_b_as1
					ENDIF
				ELSE
					flag_bailout_b = 1
					SET_CAR_WATERTIGHT cartel_car_b_as1 FALSE
					++ counter_bailouts
					REMOVE_BLIP	blip_cartelcar_b
					GOSUB cartel_deaths
					RETURN
				ENDIF
			ENDIF
			/*
			IF timer_reset_car_b = 1
				IF NOT IS_CAR_STOPPED cartel_car_b_as1
					timer_reset_car_b = 0
				ENDIF
			ENDIF
					
			IF IS_CAR_STOPPED cartel_car_b_as1
				IF timer_reset_car_b = 0
					GET_GAME_TIMER timer_start_car_b
					timer_reset_car_b = 1
				ENDIF

				IF timer_reset_car_b = 1
					GET_GAME_TIMER timer_current_car_b
					car_b_time_dif = timer_current_car_b - timer_start_car_b
				ENDIF

				IF car_b_time_dif > 4000
					IF NOT IS_CAR_ON_SCREEN cartel_car_b_as1
						GET_CAR_COORDINATES cartel_car_b_as1 cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z
						GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z cartel_heading
						IF NOT IS_POINT_ON_SCREEN cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z 3.0
							SET_CAR_COORDINATES cartel_car_b_as1 cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z
							SET_CAR_HEADING cartel_car_b_as1 cartel_heading
							timer_reset_car_b = 0
						ENDIF
					ENDIF
				ENDIF
			ENDIF*/
		ELSE
			REMOVE_BLIP	blip_cartelcar_b
		ENDIF

RETURN
/*
cartel_car_c_stuck:

		IF NOT IS_CAR_DEAD cartel_car_c_as1
			IF IS_CAR_UPSIDEDOWN cartel_car_c_as1
			AND IS_CAR_STOPPED cartel_car_c_as1
				IF NOT IS_CAR_ON_SCREEN cartel_car_c_as1
					GET_CAR_COORDINATES cartel_car_c_as1 cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z cartel_heading
					IF NOT IS_POINT_ON_SCREEN cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z 3.0
						SET_CAR_COORDINATES cartel_car_c_as1 cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z
						SET_CAR_HEADING	cartel_car_c_as1 cartel_heading
					ENDIF
				ELSE
					GOSUB bailout_c
				ENDIF
			ENDIF

			IF IS_CAR_IN_WATER cartel_car_c_as1
				//PRINT_BIG (Y1_TEST) 2000 1//CAR IN WATER!!----test stuff!!
				IF NOT IS_CAR_ON_SCREEN cartel_car_c_as1
					GET_CAR_COORDINATES cartel_car_c_as1 cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z cartel_heading
					IF NOT IS_POINT_ON_SCREEN cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z 3.0
						SET_CAR_COORDINATES cartel_car_c_as1 cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z
						SET_CAR_HEADING	cartel_car_c_as1 cartel_heading
					ENDIF
				ELSE
					flag_bailout_c = 1
					REMOVE_BLIP	blip_cartelcar_c
					GOSUB cartel_deaths
					RETURN
				ENDIF
			ENDIF

			IF timer_reset_car_c = 1
				IF NOT IS_CAR_STOPPED cartel_car_c_as1
					timer_reset_car_c = 0
				ENDIF
			ENDIF
					
			IF IS_CAR_STOPPED cartel_car_c_as1
				IF timer_reset_car_c = 0
					GET_GAME_TIMER timer_start_car_c
					timer_reset_car_c = 1
				ENDIF

				IF timer_reset_car_c = 1
					GET_GAME_TIMER timer_current_car_c
					car_c_time_dif = timer_current_car_c - timer_start_car_c
				ENDIF

				IF car_c_time_dif > 4000
					IF NOT IS_CAR_ON_SCREEN cartel_car_c_as1
						GET_CAR_COORDINATES cartel_car_c_as1 cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z
						GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z cartel_heading
						IF NOT IS_POINT_ON_SCREEN cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z 3.0
							SET_CAR_COORDINATES cartel_car_c_as1 cartel_car_c_as1_x cartel_car_c_as1_y cartel_car_c_as1_z
							SET_CAR_HEADING	cartel_car_c_as1 cartel_heading
							timer_reset_car_c = 0
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ELSE
			REMOVE_BLIP	blip_cartelcar_c
		ENDIF

RETURN
*/
cartel_car_d_stuck:

		IF NOT IS_CAR_DEAD cartel_car_d_as1
			IF IS_CAR_UPSIDEDOWN cartel_car_d_as1
			AND IS_CAR_STOPPED cartel_car_d_as1
				IF NOT IS_CAR_ON_SCREEN cartel_car_d_as1
					GET_CAR_COORDINATES cartel_car_d_as1 cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z cartel_heading
					IF NOT IS_POINT_ON_SCREEN cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z 3.0
						SET_CAR_COORDINATES cartel_car_d_as1 cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z
						SET_CAR_HEADING	cartel_car_d_as1 cartel_heading
						SET_JAMES_CAR_ON_PATH_TO_PLAYER cartel_car_d_as1
					ENDIF
				ELSE
					GOSUB bailout_d
				ENDIF
			ENDIF

			IF IS_CAR_IN_WATER cartel_car_d_as1
				//PRINT_BIG (Y1_TEST) 2000 1//CAR IN WATER!! ---etst stuff!!
				IF NOT IS_CAR_ON_SCREEN cartel_car_d_as1
					GET_CAR_COORDINATES cartel_car_d_as1 cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z cartel_heading
					IF NOT IS_POINT_ON_SCREEN cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z 3.0
						SET_CAR_COORDINATES cartel_car_d_as1 cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z
						SET_CAR_HEADING	cartel_car_d_as1 cartel_heading
						SET_JAMES_CAR_ON_PATH_TO_PLAYER cartel_car_d_as1
					ENDIF
				ELSE
					flag_bailout_d = 1
					SET_CAR_WATERTIGHT cartel_car_d_as1 FALSE
					++ counter_bailouts
					REMOVE_BLIP	blip_cartelcar_d
					GOSUB cartel_deaths
					RETURN
				ENDIF
			ENDIF
			/*
			IF timer_reset_car_d = 1
				IF NOT IS_CAR_STOPPED cartel_car_d_as1
					timer_reset_car_d = 0
				ENDIF
			ENDIF
					
			IF IS_CAR_STOPPED cartel_car_d_as1
				IF timer_reset_car_d = 0
					GET_GAME_TIMER timer_start_car_d
					timer_reset_car_d = 1
				ENDIF

				IF timer_reset_car_d = 1
					GET_GAME_TIMER timer_current_car_d
					car_d_time_dif = timer_current_car_d - timer_start_car_d
				ENDIF

				IF car_d_time_dif > 4000
					IF NOT IS_CAR_ON_SCREEN cartel_car_d_as1
						GET_CAR_COORDINATES cartel_car_d_as1 cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z
						GET_CLOSEST_CAR_NODE_WITH_HEADING cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z cartel_heading
						IF NOT IS_POINT_ON_SCREEN cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z 3.0
							SET_CAR_COORDINATES cartel_car_d_as1 cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z
							SET_CAR_HEADING	cartel_car_d_as1 cartel_heading
							timer_reset_car_d = 0
						ENDIF
					ENDIF
				ENDIF
			ENDIF*/
		ELSE
			REMOVE_BLIP	blip_cartelcar_d
		ENDIF

RETURN


vegetables:

	IF flag_cartel_a_created = 1
		IF NOT IS_CAR_DEAD cartel_car_a_as1
			IF flag_bailout_a = 0
			AND flag_a_attack = 1
				GOSUB cartel_car_a_stuck
			ENDIF
		ELSE
			REMOVE_BLIP	blip_cartelcar_a
			//yak4_mission = 0
		ENDIF
	ENDIF

	IF flag_cartel_b_created = 1
		IF NOT IS_CAR_DEAD cartel_car_b_as1
			IF flag_bailout_b = 0
			AND flag_b_attack = 1
				GOSUB cartel_car_b_stuck
			ENDIF
		ELSE
			REMOVE_BLIP	blip_cartelcar_b
			//yak4_mission = 0
		ENDIF
	ENDIF
	/*
	IF flag_cartel_c_created = 1
		IF NOT IS_CAR_DEAD cartel_car_c_as1
			IF flag_bailout_c = 0
			AND flag_c_attack = 1
				GOSUB cartel_car_c_stuck
			ENDIF
		ELSE
			REMOVE_BLIP	blip_cartelcar_c
			yak4_mission = 0
		ENDIF
	ENDIF
	*/
	IF flag_cartel_d_created = 1
		IF NOT IS_CAR_DEAD cartel_car_d_as1
			IF flag_bailout_d = 0
			AND flag_d_attack = 1
				GOSUB cartel_car_d_stuck
			ENDIF
		ELSE
			REMOVE_BLIP	blip_cartelcar_d
			//yak4_mission = 0
		ENDIF
	ENDIF

RETURN

//------------------------------------CLEAN-UP GOSUBS-----------------------------------------
blip_removal:
	REMOVE_BLIP blip_cartel1
	REMOVE_BLIP blip_cartel2
	REMOVE_BLIP blip_cartel3
	REMOVE_BLIP blip_cartel4
	REMOVE_BLIP blip_cartel5
	REMOVE_BLIP blip_cartel6
	REMOVE_BLIP blip_cartel7
	REMOVE_BLIP blip_cartel8
	/*
	REMOVE_BLIP blip_cartel9
	REMOVE_BLIP blip_cartel10
	REMOVE_BLIP blip_cartel11
	REMOVE_BLIP blip_cartel12
	*/
	REMOVE_BLIP blip_cartel13
	REMOVE_BLIP blip_cartel14
	REMOVE_BLIP blip_cartel15
	REMOVE_BLIP blip_cartel16

	IF flag_yak1_dead = 0
		MARK_CHAR_AS_NO_LONGER_NEEDED yakuza1_as1	
	ENDIF
	IF flag_yak2_dead = 0	
		MARK_CHAR_AS_NO_LONGER_NEEDED yakuza2_as1	
	ENDIF
	IF flag_yak3_dead = 0	
		MARK_CHAR_AS_NO_LONGER_NEEDED yakuza3_as1	
	ENDIF
	IF flag_yak4_dead = 0	
		MARK_CHAR_AS_NO_LONGER_NEEDED yakuza4_as1	
	ENDIF
	IF flag_yak5_dead = 0	
		MARK_CHAR_AS_NO_LONGER_NEEDED yakuza5_as1	
	ENDIF
	IF flag_yak6_dead = 0	
		MARK_CHAR_AS_NO_LONGER_NEEDED yakuza6_as1	
	ENDIF

RETURN

// ***********extrat stuck car gosub*********************

unhappy_car_check:

	GET_GAME_TIMER timer_as3_now
   //	timer_as3_dif = timer_as3_now - timer_as3_start
	IF timer_as3_now > particle_time
		particle_time = timer_as3_now + 6000
		flag_particle = 1
	ENDIF

	IF flag_particle = 1
		IF NOT IS_CAR_DEAD cartel_car_a_as1
		AND flag_a_attack = 1
		AND flag_bailout_a = 0
			car_a_x_old = car_a_as1_x
			car_a_y_old = car_a_as1_y
			car_a_z_old = car_a_as1_z

			GET_CAR_COORDINATES cartel_car_a_as1 car_a_as1_x car_a_as1_y car_a_as1_z
			IF LOCATE_CAR_2D cartel_car_a_as1 car_a_x_old car_a_y_old 3.0 3.0 false
				IF NOT IS_CAR_ON_SCREEN cartel_car_a_as1
					//GET_CAR_COORDINATES cartel_car_a_as1 cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING car_a_as1_x car_a_as1_y car_a_as1_z cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z cartel_heading
					IF NOT IS_POINT_ON_SCREEN cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z 3.0
						SET_CAR_COORDINATES cartel_car_a_as1 cartel_car_a_as1_x cartel_car_a_as1_y cartel_car_a_as1_z
						SET_CAR_HEADING	cartel_car_a_as1 cartel_heading
						SET_JAMES_CAR_ON_PATH_TO_PLAYER cartel_car_a_as1
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		
		IF NOT IS_CAR_DEAD cartel_car_b_as1
		AND flag_b_attack = 1
		AND flag_bailout_b = 0
			car_b_x_old = car_b_as1_x
			car_b_y_old = car_b_as1_y
			car_b_z_old = car_b_as1_z

			GET_CAR_COORDINATES cartel_car_b_as1 car_b_as1_x car_b_as1_y car_b_as1_z
			IF LOCATE_CAR_2D cartel_car_b_as1 car_b_x_old car_b_y_old 3.0 3.0 false
				IF NOT IS_CAR_ON_SCREEN cartel_car_b_as1
					//GET_CAR_COORDINATES cartel_car_b_as1 cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING car_b_as1_x car_b_as1_y car_b_as1_z cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z cartel_heading
					IF NOT IS_POINT_ON_SCREEN cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z 3.0
						SET_CAR_COORDINATES cartel_car_b_as1 cartel_car_b_as1_x cartel_car_b_as1_y cartel_car_b_as1_z
						SET_CAR_HEADING	cartel_car_b_as1 cartel_heading
						SET_JAMES_CAR_ON_PATH_TO_PLAYER cartel_car_b_as1
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		
		IF NOT IS_CAR_DEAD cartel_car_d_as1
		AND flag_d_attack = 1
		AND flag_bailout_d = 0
			car_d_x_old = car_d_as1_x
			car_d_y_old = car_d_as1_y
			car_d_z_old = car_d_as1_z

			GET_CAR_COORDINATES cartel_car_d_as1 car_d_as1_x car_d_as1_y car_d_as1_z
			IF LOCATE_CAR_2D cartel_car_d_as1 car_d_x_old car_d_y_old 3.0 3.0 false
				IF NOT IS_CAR_ON_SCREEN cartel_car_d_as1
					//GET_CAR_COORDINATES cartel_car_d_as1 cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z
					GET_CLOSEST_CAR_NODE_WITH_HEADING car_d_as1_x car_d_as1_y car_d_as1_z cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z cartel_heading
					IF NOT IS_POINT_ON_SCREEN cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z 3.0
						SET_CAR_COORDINATES cartel_car_d_as1 cartel_car_d_as1_x cartel_car_d_as1_y cartel_car_d_as1_z
						SET_CAR_HEADING	cartel_car_d_as1 cartel_heading
						SET_JAMES_CAR_ON_PATH_TO_PLAYER cartel_car_d_as1
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		
		flag_particle = 0
	ENDIF

RETURN
MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ***********************************ASUKA SUBURBAN MISSION 2****************************** 
// *****************************************************************************************
// **************************************'Espresso-2-Go'***********************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_as2
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_as2_failed
ENDIF
GOSUB mission_cleanup_as2

MISSION_END
 
// Variables for mission

VAR_INT kappa_1 kappa_3 kappa_4 //kappa_2
VAR_INT kappa_5 kappa_6 kappa_7 //kappa_8
VAR_INT kappa_9 kappa_10 kappa_12 //kappa_11

//VAR_INT varmint_1 varmint_2 
VAR_INT patriot_1 //patriot_2 
VAR_INT flag_guard1_created flag_guard2_created
 
VAR_INT kappa_1_fire kappa_2_fire kappa_3_fire kappa_4_fire
VAR_INT kappa_5_fire kappa_6_fire kappa_7_fire kappa_8_fire
VAR_INT kappa_9_fire kappa_10_fire kappa_11_fire kappa_12_fire

VAR_INT kappa_cartel1 kappa_cartel2 kappa_cartel3 kappa_cartel4
VAR_INT kappa_cartel5 kappa_cartel6 kappa_cartel7 kappa_cartel8
VAR_INT kappa_cartel9 kappa_cartel10 kappa_cartel11 kappa_cartel12

VAR_INT flag_kappa1_dead flag_kappa2_dead flag_kappa3_dead flag_kappa4_dead
VAR_INT flag_kappa5_dead flag_kappa6_dead flag_kappa7_dead flag_kappa8_dead
VAR_INT flag_kappa9_dead flag_kappa10_dead flag_kappa11_dead flag_kappa12_dead

VAR_INT flag_kappa1_created flag_kappa2_created flag_kappa3_created flag_kappa4_created
VAR_INT flag_kappa5_created flag_kappa6_created flag_kappa7_created flag_kappa8_created
VAR_INT flag_kappa9_created flag_kappa10_created flag_kappa11_created flag_kappa12_created

VAR_INT blip_kappa1_created blip_kappa2_created blip_kappa3_created blip_kappa4_created
VAR_INT blip_kappa5_created blip_kappa6_created blip_kappa7_created blip_kappa8_created
VAR_INT blip_kappa9_created blip_kappa10_created blip_kappa11_created blip_kappa12_created

VAR_INT blip_kappa1 blip_kappa2 blip_kappa3 blip_kappa4
VAR_INT blip_kappa5 blip_kappa6 blip_kappa7 blip_kappa8
VAR_INT blip_kappa9 blip_kappa10 blip_kappa11 blip_kappa12

VAR_INT kappa_time
VAR_INT flag_timer_started
//VAR_INT cs_whip
VAR_INT timer_as2_dif timer_as2_now timer_as2_start flag_particle_as2 particle_time_as2

VAR_INT counter_kappa_dead
VAR_INT counter_kappa_dead_ind
VAR_INT counter_kappa_dead_com
VAR_INT counter_kappa_dead_sub

VAR_INT flag_as2_1 flag_as2_2 flag_as2_3

VAR_FLOAT kappa1_x kappa1_y
VAR_FLOAT kappa2_x kappa2_y
VAR_FLOAT kappa3_x kappa3_y
VAR_FLOAT kappa4_x kappa4_y
VAR_FLOAT kappa5_x kappa5_y
VAR_FLOAT kappa6_x kappa6_y
VAR_FLOAT kappa7_x kappa7_y
VAR_FLOAT kappa8_x kappa8_y
VAR_FLOAT kappa9_x kappa9_y
VAR_FLOAT kappa10_x kappa10_y
VAR_FLOAT kappa11_x kappa11_y
VAR_FLOAT kappa12_x kappa12_y
VAR_FLOAT steam_x steam_y steam_z

//--test stuff-------------

VAR_FLOAT test_x test_y
VAR_INT kappa_test





//VAR_FLOAT min_x_as2 min_y_as2 min_z_as2 max_x_as2 max_y_as2 max_z_as2



// ****************************************Mission Start************************************

mission_start_as2:
REGISTER_MISSION_GIVEN
SCRIPT_NAME asusb2 
flag_player_on_mission = 1
flag_player_on_asuka_suburban_mission = 1

WAIT 0

//WAIT 1000

//---------------------------------SET FLAGS & VARIABLES-------------------------------------------


flag_kappa1_dead = 0
flag_kappa2_dead = 0
flag_kappa3_dead = 0
flag_kappa4_dead = 0
flag_kappa5_dead = 0
flag_kappa6_dead = 0
flag_kappa7_dead = 0
flag_kappa8_dead = 0
flag_kappa9_dead = 0
flag_kappa10_dead = 0
flag_kappa11_dead = 0
flag_kappa12_dead = 0

flag_kappa1_created = 0
flag_kappa2_created = 0
flag_kappa3_created = 0
flag_kappa4_created = 0
flag_kappa5_created = 0
flag_kappa6_created = 0
flag_kappa7_created = 0
flag_kappa8_created = 0
flag_kappa9_created = 0
flag_kappa10_created = 0
flag_kappa11_created = 0
flag_kappa12_created = 0

blip_kappa1_created = 0
blip_kappa2_created = 0
blip_kappa3_created = 0
blip_kappa4_created = 0
blip_kappa5_created = 0
blip_kappa6_created = 0
blip_kappa7_created = 0
blip_kappa8_created = 0
blip_kappa9_created = 0
blip_kappa10_created = 0
blip_kappa11_created = 0
blip_kappa12_created = 0


counter_kappa_dead = 0

particle_time_as2 = 0

counter_kappa_dead_ind = 0
counter_kappa_dead_com = 0
counter_kappa_dead_sub = 0

flag_as2_1 = 0
flag_as2_2 = 0
flag_as2_3 = 0
flag_particle_as2 = 0

flag_guard1_created = 0

kappa_time = 470000
flag_timer_started = 0

// ****************************************LOCATION COORDS**************************************

kappa1_x = 1342.0
kappa1_y = -821.0 //dock entrance

kappa2_x = 1024.1
kappa2_y = -465.57 //tube station

kappa3_x = 1351.22
kappa3_y = -259.56 //St Marks

kappa4_x = 286.4
kappa4_y = -667.8 //NEWPORT

kappa5_x = 28.0
kappa5_y = -850.0 //PARK

kappa6_x = 14.16
kappa6_y = -1140.0 //BED POINT

kappa7_x = 73.16
kappa7_y = -1359.8 //BED POINT

kappa8_x = -221.0
kappa8_y = -197.0 //ASPATRIA

kappa9_x = 282.8
kappa9_y = -1492.4 // TORRINGTON

kappa10_x = -644.0
kappa10_y = -721.5 // AIRPORT

kappa11_x = -212.0
kappa11_y = 310.0 //cedar grove

kappa12_x = -1255.0
kappa12_y = -113.0 //Pike Creek



//  ******************************************* START OF CUTSCENE ***************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_as2_failed
ENDIF

//	PRINT_BIG ( AS2 ) 15000 2

SET_FADING_COLOUR 0 0 0

DO_FADE 250 FADE_OUT

PRINT_BIG ( AS2 ) 15000 2

SWITCH_STREAMING OFF
*/

REQUEST_MODEL csitecutscene

LOAD_SPECIAL_CHARACTER 1 asuka
LOAD_SPECIAL_CHARACTER 2 miguel

LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 ASUKAH
LOAD_SPECIAL_MODEL cut_obj3 WHIP

/*
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
*/

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED csitecutscene
 WAIT 0
ENDWHILE

 
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
 WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj3
	WAIT 0
ENDWHILE


LOAD_CUTSCENE a7_etg

SWITCH_STREAMING ON

SET_CUTSCENE_OFFSET 369.02 -327.5 18.46
  
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player
 
CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_asuka
SET_CUTSCENE_ANIM cs_asuka asuka

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_miguel
SET_CUTSCENE_ANIM cs_miguel miguel
 
CREATE_CUTSCENE_OBJECT cut_obj3 cs_whip
SET_CUTSCENE_ANIM cs_whip WHIP

CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player
 
CREATE_CUTSCENE_HEAD cs_asuka CUT_OBJ2 cs_asukahead
SET_CUTSCENE_HEAD_ANIM cs_asukahead asuka

//CREATE_CUTSCENE_HEAD cs_miguel CUT_OBJ3 cs_miguelhead
//SET_CUTSCENE_HEAD_ANIM cs_miguelhead miguel

SET_PLAYER_COORDINATES player 373.7523 -327.2676 17.1950
 
SET_PLAYER_HEADING player 270.0
 
DO_FADE 250 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING OFF
SWITCH_WORLD_PROCESSING OFF

START_CUTSCENE

//------CUTSCENE TEXT-----------------------------
GET_CUTSCENE_TIME cs_time

WHILE cs_time < 3445
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW (AS2_A1) 10000 1

WHILE cs_time < 7961
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW (AS2_A2) 10000 1

WHILE cs_time < 9836
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW (AS2_A) 10000 1
 
WHILE cs_time < 13013
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS2_B) 10000 1
 
WHILE cs_time < 16802
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS2_C) 10000 1
 
WHILE cs_time < 20591
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS2_D) 10000 1

WHILE cs_time < 23499
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS2_E) 10000 1

WHILE cs_time < 27594
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS2_F) 10000 1

WHILE cs_time < 30000
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
DO_FADE 1500 FADE_OUT
 
WHILE NOT HAS_CUTSCENE_FINISHED
 WAIT 0
ENDWHILE
  
CLEAR_PRINTS
 
WHILE GET_FADING_STATUS
 WAIT 0
ENDWHILE
 
CLEAR_CUTSCENE
 
DO_FADE 0 FADE_OUT
 
SET_CAMERA_BEHIND_PLAYER
 
WAIT 500
 
DO_FADE 1500 FADE_IN 
  
UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
MARK_MODEL_AS_NO_LONGER_NEEDED csitecutscene

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3

SWITCH_RUBBISH ON
SWITCH_STREAMING ON
SWITCH_WORLD_PROCESSING ON
// ******************************************END OF CUTSCENE********************************



// Mission stuff goes here

DISPLAY_ONSCREEN_COUNTER_WITH_STRING counter_kappa_dead COUNTER_DISPLAY_NUMBER KILLS

GET_GAME_TIMER timer_as2_start

PRINT_NOW (AS2_12) 5000 1//Cruise Liberty's districts to find etc. etc.

PRINT_SOON (AS2_12A) 5000 1

SET_GANG_WEAPONS GANG_MAFIA WEAPONTYPE_PISTOL WEAPONTYPE_UZI //The Mafia


/*
REQUEST_MODEL PED_FEMALE1
WHILE NOT HAS_MODEL_LOADED PED_FEMALE1
	WAIT 0
ENDWHILE
*/
REQUEST_MODEL coffee
WHILE NOT HAS_MODEL_LOADED coffee
	WAIT 0
ENDWHILE

REQUEST_MODEL CAR_COLUMB
WHILE NOT HAS_MODEL_LOADED CAR_COLUMB
	WAIT 0
ENDWHILE
REQUEST_MODEL PED_GANG_COLOMBIAN_A
WHILE NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_A
	WAIT 0
ENDWHILE
REQUEST_MODEL PED_GANG_COLOMBIAN_B
WHILE NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_B
	WAIT 0
ENDWHILE

/*
PRINT_NOW (AS2_A) 4000 1 //We underestimated Catalina's plans for SPANK. It reaches far beyond the Yardies selling it on street corners.
MESSAGE_WAIT 4000 true
PRINT_NOW (AS2_B) 4000 1 //The Cartel have a front company; The Kappa Coffee House franchise.
MESSAGE_WAIT 4000 true
PRINT_NOW (AS2_C) 4000 1 //They've been selling SPANK through street stalls all over Liberty's three districts.
MESSAGE_WAIT 4000 true
PRINT_NOW (AS2_D) 4000 1 //Put all these drug barrows out of operation!!
MESSAGE_WAIT 4000 true
PRINT_NOW (AS2_E) 4000 1 //Once you've done the first hit, you'll have eight minutes before the Cartel can warn their pushers.
MESSAGE_WAIT 4000 true

//-----test stuff-----
test_x = 354.0
test_y = -327.0
CREATE_OBJECT coffee test_x test_y -100.0 kappa_test
//SET_OBJECT_HEADING kappa_test 0.0
*/

WHILE counter_kappa_dead < 9
	WAIT 0
//-------------------------------------------CREATE KAPPAS------------------------------------------------------------------------------------
	IF IS_COLLISION_IN_MEMORY LEVEL_INDUSTRIAL
		IF flag_kappa1_created = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player kappa1_x kappa1_y 150.0 150.0 false
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A kappa1_x kappa1_y -100.0 kappa_cartel1
				//SET_CHAR_HEADING kappa_cartel1 270.0
				SET_CHAR_THREAT_SEARCH kappa_cartel1 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel1 WEAPONTYPE_UZI 60
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel1 true
				CREATE_OBJECT coffee kappa1_x kappa1_y -100.0 kappa_1
				SET_OBJECT_HEADING kappa_1 180.0
				SET_OBJECT_COLLISION kappa_1 true
				SET_OBJECT_DYNAMIC kappa_1 false
				//ADD_PARTICLE_EFFECT POBJECT_DRY_ICE -1350.4 -259.6 49.7 false
				IF blip_kappa1_created = 0
					ADD_BLIP_FOR_OBJECT kappa_1 blip_kappa1
					blip_kappa1_created = 1
				ENDIF
				flag_Kappa1_created = 1
			ENDIF
		ENDIF
				
		/*
		IF flag_kappa2_created = 0
			IF LOCATE_PLAYER_ANY_MEANS_2D player kappa2_x kappa2_y 70.0 70.0 false
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B kappa2_x kappa2_y -100.0 kappa_cartel2
				//SET_CHAR_HEADING kappa_cartel2 270.0
				SET_CHAR_THREAT_SEARCH kappa_cartel2 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel2 WEAPONTYPE_UZI 60
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel2 true
				CREATE_OBJECT coffee kappa2_x kappa2_y -100.0 kappa_2
				SET_OBJECT_HEADING kappa_2 270.0
				SET_OBJECT_COLLISION kappa_2 true
				SET_OBJECT_DYNAMIC kappa_2 false
				//ADD_PARTICLE_EFFECT POBJECT_DRY_ICE 1024.2 -466.5 14.9 false
				IF blip_kappa2_created = 0
					ADD_BLIP_FOR_OBJECT kappa_2 blip_kappa2
					blip_kappa2_created = 1
				ENDIF
				flag_Kappa2_created = 1
			ENDIF
		ENDIF
		*/
		
		IF flag_kappa3_created = 0
			IF IS_PLAYER_IN_ZONE player LITTLEI
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A kappa3_x kappa3_y -100.0 kappa_cartel3
				SET_CHAR_HEADING kappa_cartel3 270.0
				SET_CHAR_THREAT_SEARCH kappa_cartel3 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel3 WEAPONTYPE_SHOTGUN 10
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel3 true
				CREATE_OBJECT coffee kappa3_x kappa3_y -100.0 kappa_3
				SET_OBJECT_HEADING kappa_3 180.0
				SET_OBJECT_COLLISION kappa_3 true
				SET_OBJECT_DYNAMIC kappa_3 false
				//ADD_PARTICLE_EFFECT POBJECT_DRY_ICE 1343.3 -845.5 15.0 false
				IF blip_kappa3_created = 0
					ADD_BLIP_FOR_OBJECT kappa_3 blip_kappa3
					blip_kappa3_created = 1
				ENDIF
				flag_Kappa3_created = 1
			ENDIF
		ENDIF
   /*	ELSE
		IF flag_kappa1_created = 1
			IF flag_kappa1_dead = 0
					DELETE_CHAR kappa_cartel1
					DELETE_OBJECT kappa_1
					flag_kappa1_created = 0
					blip_kappa1_created = 0
			ENDIF
			IF flag_kappa1_dead = 1
					DELETE_CHAR kappa_cartel1
					DELETE_OBJECT kappa_1
			ENDIF
		ENDIF
		
		IF flag_kappa2_created = 1
			IF flag_kappa2_dead = 0
					DELETE_CHAR kappa_cartel2
					DELETE_OBJECT kappa_2
					flag_kappa2_created = 0
					blip_kappa2_created = 0
			ENDIF
			IF flag_kappa2_dead = 1
					DELETE_CHAR kappa_cartel2
					DELETE_OBJECT kappa_2
			ENDIF
		ENDIF
		
		IF flag_kappa3_created = 1
			IF flag_kappa3_dead = 0
					DELETE_CHAR kappa_cartel3
					DELETE_OBJECT kappa_3
					flag_kappa3_created = 0
					blip_kappa3_created = 0
			ENDIF
			IF flag_kappa3_dead = 1
					DELETE_CHAR kappa_cartel3
					DELETE_OBJECT kappa_3
			ENDIF
		ENDIF
		*/
	ENDIF
	
	IF IS_COLLISION_IN_MEMORY LEVEL_COMMERCIAL
		IF flag_kappa4_created = 0
			//IF IS_PLAYER_IN_ZONE player COM_EAS
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B kappa4_x kappa4_y -100.0 kappa_cartel4
				SET_CHAR_HEADING kappa_cartel4 360.0
				SET_CHAR_THREAT_SEARCH kappa_cartel4 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel4 WEAPONTYPE_UZI 60
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel4 true
				ADD_ARMOUR_TO_CHAR kappa_cartel4 100
				CREATE_OBJECT coffee kappa4_x kappa4_y -100.0 kappa_4
				//ADD_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION 286.5 -668.5 26.2 false
				SET_OBJECT_HEADING kappa_4 270.0
				SET_OBJECT_COLLISION kappa_4 true
				SET_OBJECT_DYNAMIC kappa_4 false
				IF blip_kappa4_created = 0
					ADD_BLIP_FOR_OBJECT kappa_4 blip_kappa4
					blip_kappa4_created = 1
				ENDIF
				flag_Kappa4_created = 1
			//ENDIF
		ENDIF

		IF flag_kappa5_created = 0
			IF IS_PLAYER_IN_ZONE player PARK
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A kappa5_x kappa5_y -100.0 kappa_cartel5
				SET_CHAR_THREAT_SEARCH kappa_cartel5 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel5 WEAPONTYPE_UZI 60
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel5 true
				CREATE_OBJECT coffee kappa5_x kappa5_y -100.0 kappa_5
				SET_OBJECT_COLLISION kappa_5 true
				SET_OBJECT_DYNAMIC kappa_5 false
				//ADD_PARTICLE_EFFECT POBJECT_DRY_ICE 28.6 -849.9 32.7 false
				IF blip_kappa5_created = 0
					ADD_BLIP_FOR_OBJECT kappa_5 blip_kappa5
					blip_kappa5_created = 1
				ENDIF
				flag_Kappa5_created = 1
			ENDIF
		ENDIF

		IF flag_kappa6_created = 0
			IF IS_PLAYER_IN_ZONE player	SHOPING
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B kappa6_x kappa6_y -100.0 kappa_cartel6
				SET_CHAR_HEADING kappa_cartel6 190.0
				SET_CHAR_THREAT_SEARCH kappa_cartel6 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel6 WEAPONTYPE_UZI 60
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel6 true
				CREATE_OBJECT coffee kappa6_x kappa6_y -100.0 kappa_6
				SET_OBJECT_HEADING kappa_6 145.0
				SET_OBJECT_COLLISION kappa_6 true
				SET_OBJECT_DYNAMIC kappa_6 false
				//ADD_PARTICLE_EFFECT POBJECT_DRY_ICE 13.67 -1140.5 26.19 false
				IF blip_kappa6_created = 0
					ADD_BLIP_FOR_OBJECT kappa_6 blip_kappa6
					blip_kappa6_created = 1
				ENDIF
				flag_Kappa6_created = 1
			ENDIF
		ENDIF

		IF flag_kappa7_created = 0
			IF IS_PLAYER_IN_ZONE player	SHOPING
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A kappa7_x kappa7_y -100.0 kappa_cartel7
				//SET_CHAR_HEADING kappa_cartel7 190.0
				SET_CHAR_THREAT_SEARCH kappa_cartel7 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel7 WEAPONTYPE_UZI 60
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel7 true
				CREATE_OBJECT coffee kappa7_x kappa7_y -100.0 kappa_7
				SET_OBJECT_COLLISION kappa_7 true
				SET_OBJECT_DYNAMIC kappa_7 false
				//ADD_PARTICLE_EFFECT POBJECT_DRY_ICE 74.0 -1359.6 26.2 false
				IF blip_kappa7_created = 0
					ADD_BLIP_FOR_OBJECT kappa_7 blip_kappa7
					blip_kappa7_created = 1
				ENDIF
				flag_Kappa7_created = 1
			ENDIF
		ENDIF
		/*
		IF flag_kappa8_created = 0
			IF IS_PLAYER_IN_ZONE player	STADIUM
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B kappa8_x kappa8_y -100.0 kappa_cartel8
				SET_CHAR_HEADING kappa_cartel8 350.0
				SET_CHAR_THREAT_SEARCH kappa_cartel8 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel8 WEAPONTYPE_SHOTGUN 10
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel8 true
				CREATE_OBJECT coffee kappa8_x kappa8_y -100.0 kappa_8
				SET_OBJECT_HEADING kappa_8 270.0
				SET_OBJECT_COLLISION kappa_8 true
				SET_OBJECT_DYNAMIC kappa_8 false
				//ADD_PARTICLE_EFFECT POBJECT_DRY_ICE -220.8 -197.5 12.1 false
				IF blip_kappa8_created = 0
					ADD_BLIP_FOR_OBJECT kappa_8 blip_kappa8
					blip_kappa8_created = 1
				ENDIF
				flag_Kappa8_created = 1
			ENDIF
		ENDIF
		*/
		IF flag_kappa9_created = 0
			IF IS_PLAYER_IN_ZONE player	YAKUSA
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A kappa9_x kappa9_y 23.7 kappa_cartel9
				SET_CHAR_THREAT_SEARCH kappa_cartel9 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel9 WEAPONTYPE_SHOTGUN 10
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel9 true
				CREATE_OBJECT coffee kappa9_x kappa9_y -100.0 kappa_9
				SET_OBJECT_HEADING kappa_9 270.0
				SET_OBJECT_COLLISION kappa_9 true
				SET_OBJECT_DYNAMIC kappa_9 false
				//ADD_PARTICLE_EFFECT POBJECT_DRY_ICE 282.9 -1493.1 23.7 false
				IF blip_kappa9_created = 0
					ADD_BLIP_FOR_OBJECT kappa_9 blip_kappa9
					blip_kappa9_created = 1
				ENDIF
				flag_Kappa9_created = 1
			ENDIF
		ENDIF
  /*	ELSE
		IF flag_kappa10_created = 1
			IF flag_kappa4_dead = 0
					DELETE_CHAR kappa_cartel4
					DELETE_OBJECT kappa_4
					flag_kappa4_created = 0
					blip_kappa4_created = 0
			ENDIF
			IF flag_kappa4_dead = 1
					DELETE_CHAR kappa_cartel4
					DELETE_OBJECT kappa_4
			ENDIF
		ENDIF
		IF flag_kappa5_created = 1
			IF flag_kappa5_dead = 0
					DELETE_CHAR kappa_cartel5
					DELETE_OBJECT kappa_5
					flag_kappa5_created = 0
					blip_kappa5_created = 0
			ENDIF
			IF flag_kappa5_dead = 1
					DELETE_CHAR kappa_cartel5
					DELETE_OBJECT kappa_5
			ENDIF
		ENDIF
		IF flag_kappa6_created = 1
			IF flag_kappa6_dead = 0
					DELETE_CHAR kappa_cartel6
					DELETE_OBJECT kappa_6
					flag_kappa6_created = 0
					blip_kappa6_created = 0
			ENDIF
			IF flag_kappa6_dead = 1
					DELETE_CHAR kappa_cartel6
					DELETE_OBJECT kappa_6
			ENDIF
		ENDIF
		IF flag_kappa7_created = 1
			IF flag_kappa7_dead = 0
					DELETE_CHAR kappa_cartel7
					DELETE_OBJECT kappa_7
					flag_kappa7_created = 0
					blip_kappa7_created = 0
			ENDIF
			IF flag_kappa7_dead = 1
					DELETE_CHAR kappa_cartel7
					DELETE_OBJECT kappa_7
			ENDIF
		ENDIF
		
		IF flag_kappa8_created = 1
			IF flag_kappa8_dead = 0
					DELETE_CHAR kappa_cartel8
					DELETE_OBJECT kappa_8
					flag_kappa8_created = 0
					blip_kappa8_created = 0
			ENDIF
			IF flag_kappa8_dead = 1
					DELETE_CHAR kappa_cartel8
					DELETE_OBJECT kappa_8
			ENDIF
		ENDIF
		
		IF flag_kappa9_created = 1
			IF flag_kappa9_dead = 0
					DELETE_CHAR kappa_cartel9
					DELETE_OBJECT kappa_9
					flag_kappa9_created = 0
					blip_kappa9_created = 0
			ENDIF
			IF flag_kappa9_dead = 1
					DELETE_CHAR kappa_cartel9
					DELETE_OBJECT kappa_9
			ENDIF
		ENDIF
		*/
	ENDIF
	
	IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
		IF flag_kappa10_created = 0
			IF IS_PLAYER_IN_ZONE player AIRPORT
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B kappa10_x kappa10_y 18.9 kappa_cartel10
				SET_CHAR_HEADING kappa_cartel10 50.0
				SET_CHAR_THREAT_SEARCH kappa_cartel10 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel10 WEAPONTYPE_UZI 60
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel10 true
				CREATE_OBJECT coffee kappa10_x kappa10_y -100.0 kappa_10
				SET_OBJECT_COLLISION kappa_10 true
				SET_OBJECT_DYNAMIC kappa_10 false
				//ADD_PARTICLE_EFFECT POBJECT_DRY_ICE -724.3 -548.8 9.1 false
				IF blip_kappa10_created = 0
					ADD_BLIP_FOR_OBJECT kappa_10 blip_kappa10
					blip_kappa10_created = 1
				ENDIF
				flag_Kappa10_created = 1
			ENDIF
		ENDIF
		/*
		IF flag_kappa11_created = 0
			IF IS_PLAYER_IN_ZONE player SWANKS
			OR IS_PLAYER_IN_ZONE player PROJECT
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A kappa11_x kappa11_y -100.0 kappa_cartel11
				SET_CHAR_HEADING kappa_cartel11 90.0
				SET_CHAR_THREAT_SEARCH kappa_cartel11 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel11 WEAPONTYPE_UZI 60
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel11 true
				CREATE_OBJECT coffee kappa11_x kappa11_y -100.0 kappa_11
				SET_OBJECT_HEADING kappa_11 0.0
				SET_OBJECT_COLLISION kappa_11 true
				SET_OBJECT_DYNAMIC kappa_11 false
				IF blip_kappa11_created = 0
					ADD_BLIP_FOR_OBJECT kappa_11 blip_kappa11
					blip_kappa11_created = 1
				ENDIF
				flag_Kappa11_created = 1
			ENDIF
		ENDIF
		*/
		IF flag_kappa12_created = 0
			IF IS_PLAYER_IN_ZONE player SUB_IND
				CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B kappa12_x kappa12_y -100.0 kappa_cartel12
				SET_CHAR_THREAT_SEARCH kappa_cartel12 THREAT_PLAYER1
				GIVE_WEAPON_TO_CHAR kappa_cartel12 WEAPONTYPE_UZI 60
				CREATE_OBJECT coffee kappa12_x kappa12_y -100.0 kappa_12
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel12 true
				SET_OBJECT_COLLISION kappa_12 true
				SET_OBJECT_DYNAMIC kappa_12 false
				IF blip_kappa12_created = 0
					ADD_BLIP_FOR_OBJECT kappa_12 blip_kappa12
					blip_kappa12_created = 1
				ENDIF
				flag_Kappa12_created = 1
			ENDIF
		ENDIF

		IF flag_kappa10_created = 1
		OR flag_kappa12_created = 1
			IF flag_guard1_created = 0
				CREATE_CAR CAR_COLUMB -706.3 -285.7 18.3 patriot_1
				CREATE_CHAR_INSIDE_CAR patriot_1 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A varmint_1
				GIVE_WEAPON_TO_CHAR varmint_1 WEAPONTYPE_UZI 60
				SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS varmint_1 player
				flag_guard1_created = 1
			ENDIF
		ENDIF
   /*	ELSE
		IF flag_kappa10_created = 1
			IF flag_kappa10_dead = 0
					DELETE_CHAR kappa_cartel10
					DELETE_OBJECT kappa_10
					flag_kappa10_created = 0
					blip_kappa10_created = 0
			ENDIF
			IF flag_kappa10_dead = 1
					DELETE_CHAR kappa_cartel10
					DELETE_OBJECT kappa_10
			ENDIF
		ENDIF
		
		IF flag_kappa11_created = 1
			IF flag_kappa11_dead = 0
					DELETE_CHAR kappa_cartel11
					DELETE_OBJECT kappa_11
					flag_kappa11_created = 0
					blip_kappa11_created = 0
			ENDIF
			IF flag_kappa11_dead = 1
					DELETE_CHAR kappa_cartel11
					DELETE_OBJECT kappa_11
			ENDIF
		ENDIF
		
		IF flag_kappa12_created = 1
			IF flag_kappa12_dead = 0
					DELETE_CHAR kappa_cartel12
					DELETE_OBJECT kappa_12
					flag_kappa12_created = 0
					blip_kappa12_created = 0
			ENDIF
			IF flag_kappa12_dead = 1
					DELETE_CHAR kappa_cartel12
					DELETE_OBJECT kappa_12
			ENDIF
		ENDIF
		*/
	ENDIF
//---------------------------------------KAPPA DEATH CHECK---------------------------------------------------------------------------------------
	IF flag_kappa1_dead = 0
	AND flag_kappa1_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_1
			flag_kappa1_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_ind
			//kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
			REMOVE_BLIP blip_kappa1
			IF NOT IS_CHAR_DEAD	kappa_cartel1
				CLEAR_CHAR_THREAT_SEARCH kappa_cartel1
				SET_CHAR_OBJ_RUN_TO_COORD kappa_cartel1 1335.5 -820.5
			ENDIF
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel1
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel1 player
		ENDIF
	ENDIF
	IF flag_kappa1_dead > 0
		IF NOT IS_CHAR_DEAD	kappa_cartel1
			IF IS_CHAR_OBJECTIVE_PASSED kappa_cartel1
				TURN_CHAR_TO_FACE_PLAYER kappa_cartel1 player
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel1 false
				//MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel1
				SET_CHAR_THREAT_SEARCH kappa_cartel1 THREAT_PLAYER1
				//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel1 player
			ENDIF
		ENDIF
	ENDIF

	/*
	IF flag_kappa2_dead = 0
	AND flag_kappa2_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_2
			flag_kappa2_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_ind
			kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
			REMOVE_BLIP blip_kappa2
			MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel2
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel2
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel2 player
		ENDIF
	ENDIF
	*/
	IF flag_kappa3_dead = 0
	AND flag_kappa3_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_3
			flag_kappa3_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_ind
			//kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
			REMOVE_BLIP blip_kappa3
			IF NOT IS_CHAR_DEAD	kappa_cartel3
				CLEAR_CHAR_THREAT_SEARCH kappa_cartel3
				SET_CHAR_OBJ_RUN_TO_COORD kappa_cartel3 1342.7 -259.0
			ENDIF
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel3
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel3 player
		ENDIF
	ENDIF
	IF flag_kappa3_dead > 0
		IF NOT IS_CHAR_DEAD	kappa_cartel3
			IF IS_CHAR_OBJECTIVE_PASSED kappa_cartel3
				TURN_CHAR_TO_FACE_PLAYER kappa_cartel3 player
				//MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel3
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel3 false
				SET_CHAR_THREAT_SEARCH kappa_cartel3 THREAT_PLAYER1
				//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel3 player
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_kappa4_dead = 0
	AND flag_kappa4_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_4
			flag_kappa4_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_com
			//kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
			REMOVE_BLIP blip_kappa4
			IF NOT IS_CHAR_DEAD	kappa_cartel4
				CLEAR_CHAR_THREAT_SEARCH kappa_cartel4
				SET_CHAR_OBJ_RUN_TO_COORD kappa_cartel4 280.0 -676.5
			ENDIF
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel4
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel4 player
		ENDIF
	ENDIF
	IF flag_kappa4_dead > 0
		IF NOT IS_CHAR_DEAD	kappa_cartel4
			IF IS_CHAR_OBJECTIVE_PASSED kappa_cartel4
				TURN_CHAR_TO_FACE_PLAYER kappa_cartel4 player
				//MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel4
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel4 false
				SET_CHAR_THREAT_SEARCH kappa_cartel4 THREAT_PLAYER1
				//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel4 player
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_kappa5_dead = 0
	AND flag_kappa5_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_5
			flag_kappa5_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_com
			//kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
			REMOVE_BLIP blip_kappa5
			IF NOT IS_CHAR_DEAD	kappa_cartel5
				CLEAR_CHAR_THREAT_SEARCH kappa_cartel5
				SET_CHAR_OBJ_RUN_TO_COORD kappa_cartel5 34.5 -850.0
			ENDIF
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel5
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel5 player
		ENDIF
	ENDIF
	IF flag_kappa5_dead > 0
		IF NOT IS_CHAR_DEAD	kappa_cartel5
			IF IS_CHAR_OBJECTIVE_PASSED kappa_cartel5
				TURN_CHAR_TO_FACE_PLAYER kappa_cartel5 player
				//MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel5
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel5 false
				SET_CHAR_THREAT_SEARCH kappa_cartel5 THREAT_PLAYER1
				//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel5 player
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_kappa6_dead = 0
	AND flag_kappa6_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_6
			flag_kappa6_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_com
			//kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
			REMOVE_BLIP blip_kappa6
			IF NOT IS_CHAR_DEAD	kappa_cartel6
				CLEAR_CHAR_THREAT_SEARCH kappa_cartel6
				SET_CHAR_OBJ_RUN_TO_COORD kappa_cartel6 13.7 -1135.3
			ENDIF
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel6
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel6 player
		ENDIF
	ENDIF
	IF flag_kappa6_dead > 0
		IF NOT IS_CHAR_DEAD	kappa_cartel6
			IF IS_CHAR_OBJECTIVE_PASSED kappa_cartel6
				TURN_CHAR_TO_FACE_PLAYER kappa_cartel6 player
				//MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel6
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel6 false
				SET_CHAR_THREAT_SEARCH kappa_cartel6 THREAT_PLAYER1
				//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel6 player
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_kappa7_dead = 0
	AND flag_kappa7_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_7
			flag_kappa7_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_com
			//kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
			REMOVE_BLIP blip_kappa7
			IF NOT IS_CHAR_DEAD	kappa_cartel7
				CLEAR_CHAR_THREAT_SEARCH kappa_cartel7
				SET_CHAR_OBJ_RUN_TO_COORD kappa_cartel7 79.0 -1361.0
			ENDIF
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel7
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel7 player
		ENDIF
	ENDIF
	IF flag_kappa7_dead > 0
		IF NOT IS_CHAR_DEAD	kappa_cartel7
			IF IS_CHAR_OBJECTIVE_PASSED kappa_cartel7
				TURN_CHAR_TO_FACE_PLAYER kappa_cartel7 player
				//MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel7
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel7 false
				SET_CHAR_THREAT_SEARCH kappa_cartel7 THREAT_PLAYER1
				//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel7 player
			ENDIF
		ENDIF
	ENDIF
	/*
	IF flag_kappa8_dead = 0
	AND flag_kappa8_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_8
			flag_kappa8_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_com
			kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
			REMOVE_BLIP blip_kappa8
			MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel8
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel8
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel8 player
		ENDIF
	ENDIF
	*/
	IF flag_kappa9_dead = 0
	AND flag_kappa9_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_9
			flag_kappa9_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_com
			//kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
		   	REMOVE_BLIP blip_kappa9
			IF NOT IS_CHAR_DEAD	kappa_cartel9
				CLEAR_CHAR_THREAT_SEARCH kappa_cartel9
				SET_CHAR_OBJ_RUN_TO_COORD kappa_cartel9 282.5 -1501.0
			ENDIF
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel9
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel9 player
		ENDIF
	ENDIF
	IF flag_kappa9_dead > 0
		IF NOT IS_CHAR_DEAD	kappa_cartel9
			IF IS_CHAR_OBJECTIVE_PASSED kappa_cartel9
				TURN_CHAR_TO_FACE_PLAYER kappa_cartel9 player
				//MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel9
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel9 false
				SET_CHAR_THREAT_SEARCH kappa_cartel9 THREAT_PLAYER1
				//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel9 player
			ENDIF
		ENDIF
	ENDIF
	
	IF flag_kappa10_dead = 0
	AND flag_kappa10_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_10
			flag_kappa10_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_sub
			//kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
			REMOVE_BLIP blip_kappa10
			IF NOT IS_CHAR_DEAD	kappa_cartel10
				CLEAR_CHAR_THREAT_SEARCH kappa_cartel10
				SET_CHAR_OBJ_RUN_TO_COORD kappa_cartel10 -638.8 -721.6
			ENDIF
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel10
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel10 player
		ENDIF
	ENDIF
	IF flag_kappa10_dead > 0
		IF NOT IS_CHAR_DEAD	kappa_cartel10
			IF IS_CHAR_OBJECTIVE_PASSED kappa_cartel10
				TURN_CHAR_TO_FACE_PLAYER kappa_cartel10 player
				//MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel10
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel10 false
				SET_CHAR_THREAT_SEARCH kappa_cartel10 THREAT_PLAYER1
				//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel10 player
			ENDIF
		ENDIF
	ENDIF
	
	/*
	IF flag_kappa11_dead = 0
	AND flag_kappa11_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_11
			flag_kappa11_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_sub
			kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
			REMOVE_BLIP blip_kappa11
			MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel11
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel11
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel11 player
		ENDIF
	ENDIF
	*/
	IF flag_kappa12_dead = 0
	AND flag_kappa12_created = 1
		IF HAS_OBJECT_BEEN_DAMAGED kappa_12
			flag_kappa12_dead = 1
			++ counter_kappa_dead
			++ counter_kappa_dead_sub
			//kappa_time = kappa_time + 10000
			PRINT_WITH_NUMBER_BIG (AS2_11) counter_kappa_dead 2000 1
			REMOVE_BLIP blip_kappa12
			IF NOT IS_CHAR_DEAD	kappa_cartel12
				CLEAR_CHAR_THREAT_SEARCH kappa_cartel12
				SET_CHAR_OBJ_RUN_TO_COORD kappa_cartel12 -1251.0 -114.5
			ENDIF
		ENDIF
		IF NOT IS_CHAR_DEAD	kappa_cartel12
			TURN_CHAR_TO_FACE_PLAYER kappa_cartel12 player
		ENDIF
	ENDIF
	IF flag_kappa12_dead > 0
		IF NOT IS_CHAR_DEAD	kappa_cartel12
			IF IS_CHAR_OBJECTIVE_PASSED kappa_cartel12
				TURN_CHAR_TO_FACE_PLAYER kappa_cartel12 player
				//MARK_CHAR_AS_NO_LONGER_NEEDED kappa_cartel12
				SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel12 false
				SET_CHAR_THREAT_SEARCH kappa_cartel12 THREAT_PLAYER1
				//SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel12 player
			ENDIF
		ENDIF
	ENDIF
//---------------------STEAM--------------------------

	GET_GAME_TIMER timer_as2_now
	timer_as2_dif = timer_as2_now - timer_as2_start
	IF timer_as2_dif > particle_time_as2
			particle_time_as2 = particle_time_as2 + 50
			flag_particle_as2 = 1
	ENDIF

	IF flag_particle_as2 = 1
		IF flag_kappa1_dead = 0
		AND flag_kappa1_created = 1
			GET_OBJECT_COORDINATES kappa_1 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa1_dead = 1
		AND flag_kappa1_created = 1
			GET_OBJECT_COORDINATES kappa_1 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_1_fire
			flag_kappa1_dead = 2
		ENDIF
		/*
		IF flag_kappa2_dead = 0
		AND flag_kappa2_created = 1
			GET_OBJECT_COORDINATES kappa_2 steam_x steam_y steam_z
			steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa2_dead = 1
		AND flag_kappa2_created = 1
			GET_OBJECT_COORDINATES kappa_2 steam_x steam_y steam_z
			steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_2_fire
			flag_kappa2_dead = 2
		ENDIF
		*/
		IF flag_kappa3_dead = 0
		AND flag_kappa3_created = 1
			GET_OBJECT_COORDINATES kappa_3 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa3_dead = 1
		AND flag_kappa3_created = 1
			GET_OBJECT_COORDINATES kappa_3 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_3_fire
			flag_kappa3_dead = 2
		ENDIF
		
		IF flag_kappa4_dead = 0
		AND flag_kappa4_created = 1
			GET_OBJECT_COORDINATES kappa_4 steam_x steam_y steam_z
			steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa4_dead = 1
		AND flag_kappa4_created = 1
			GET_OBJECT_COORDINATES kappa_4 steam_x steam_y steam_z
			steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_4_fire
			flag_kappa4_dead = 2
		ENDIF
		
		IF flag_kappa5_dead = 0
		AND flag_kappa5_created = 1
			GET_OBJECT_COORDINATES kappa_5 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa5_dead = 1
		AND flag_kappa5_created = 1
			GET_OBJECT_COORDINATES kappa_5 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_5_fire
			flag_kappa5_dead = 2
		ENDIF
		
		IF flag_kappa6_dead = 0
		AND flag_kappa6_created = 1
			GET_OBJECT_COORDINATES kappa_6 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			steam_x = steam_x - 1.0
			steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa6_dead = 1
		AND flag_kappa6_created = 1
			GET_OBJECT_COORDINATES kappa_6 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			steam_x = steam_x - 1.0
			steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_6_fire
			flag_kappa6_dead = 2
		ENDIF
		
		IF flag_kappa7_dead = 0
		AND flag_kappa7_created = 1
			GET_OBJECT_COORDINATES kappa_7 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa7_dead = 1
		AND flag_kappa7_created = 1
			GET_OBJECT_COORDINATES kappa_7 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_7_fire
			flag_kappa7_dead = 2
		ENDIF
		/*
		IF flag_kappa8_dead = 0
		AND flag_kappa8_created = 1
			GET_OBJECT_COORDINATES kappa_8 steam_x steam_y steam_z
			steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa8_dead = 1
		AND flag_kappa8_created = 1
			GET_OBJECT_COORDINATES kappa_8 steam_x steam_y steam_z
			steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_8_fire
			flag_kappa8_dead = 2
		ENDIF
		*/
		IF flag_kappa9_dead = 0
		AND flag_kappa9_created = 1
			GET_OBJECT_COORDINATES kappa_9 steam_x steam_y steam_z
			steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa9_dead = 1
		AND flag_kappa9_created = 1
			GET_OBJECT_COORDINATES kappa_9 steam_x steam_y steam_z
			steam_x = steam_x + 1.0
			//steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_9_fire
			flag_kappa9_dead = 2
		ENDIF
		
		IF flag_kappa10_dead = 0
		AND flag_kappa10_created = 1
			GET_OBJECT_COORDINATES kappa_10 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa10_dead = 1
		AND flag_kappa10_created = 1
			GET_OBJECT_COORDINATES kappa_10 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_10_fire
			flag_kappa10_dead = 2
		ENDIF
		/*
		IF flag_kappa11_dead = 0
		AND flag_kappa11_created = 1
			GET_OBJECT_COORDINATES kappa_11 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa11_dead = 1
		AND flag_kappa11_created = 1
			GET_OBJECT_COORDINATES kappa_11 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_11_fire
			flag_kappa11_dead = 2
		ENDIF
		*/
		IF flag_kappa12_dead = 0
		AND flag_kappa12_created = 1
			GET_OBJECT_COORDINATES kappa_12 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE_SLOWMOTION steam_x steam_y steam_z 0.0 0.0 0.0 0.3 0 0 0 50
		ENDIF
		IF flag_kappa12_dead = 1
		AND flag_kappa12_created = 1
			GET_OBJECT_COORDINATES kappa_12 steam_x steam_y steam_z
			//steam_x = steam_x + 1.0
			steam_y = steam_y + 1.0
			//steam_x = steam_x - 1.0
			//steam_y = steam_y - 1.0 
			START_SCRIPT_FIRE steam_x steam_y steam_z kappa_12_fire
			flag_kappa12_dead = 2
		ENDIF

		flag_particle_as2 = 0
	ENDIF


//-------------------------------------------TIMER-------TIMER----TIMER----------------------------------------

	IF kappa_time < 1
		PRINT_NOW (AS2_4) 3000 1 //The Cartel have warned their pushers!!
		//WAIT 3000
		GOTO mission_as2_failed
	ENDIF

	IF counter_kappa_dead = 1
	AND flag_timer_started = 0
		DISPLAY_ONSCREEN_TIMER kappa_time
		flag_timer_started = 1
	ENDIF

//----------------------------------------PLAYER INFO----------------------------------------------------------

	IF counter_kappa_dead_ind = 2
	AND flag_as2_1 = 0
		PRINT_NOW (AS2_1) 3000 1 //All Espresso Carts in Portland wrecked!
		WAIT 3000
		flag_as2_1 = 1
		IF flag_as2_2 = 0
		AND flag_as2_3 = 0
			PRINT_NOW (AS2_5) 4000 1 //There are still coffee carts in Staunton Island and Shoreside Vale!
			WAIT 3000
		ENDIF
		IF flag_as2_2 = 1
		AND flag_as2_3 = 0
			PRINT_NOW (AS2_6) 4000 1 //There are still coffee carts in Shoreside Vale!
			WAIT 3000
		ENDIF
		IF flag_as2_2 = 0
		AND flag_as2_3 = 1
			PRINT_NOW (AS2_7) 4000 1 //There are still coffee carts on Staunton Island!
			WAIT 3000
		ENDIF

	ENDIF

	IF counter_kappa_dead_com = 5
	AND flag_as2_2 = 0
		PRINT_NOW (AS2_2) 3000 1 //All Espresso Carts in Downtown wrecked!
		WAIT 3000
		flag_as2_2 = 1
		IF flag_as2_1 = 0
		AND flag_as2_3 = 0
			PRINT_NOW (AS2_9) 4000 1 //There are still coffee carts in Portland and Shoreside Vale!
			WAIT 3000
		ENDIF
		IF flag_as2_1 = 1
		AND flag_as2_3 = 0
			PRINT_NOW (AS2_6) 4000 1 //There are still coffee carts in Shoreside Vale!
			WAIT 3000
		ENDIF
		IF flag_as2_1 = 0
		AND flag_as2_3 = 1
			PRINT_NOW (AS2_8) 4000 1 //There are still coffee carts in Portland!
			WAIT 3000
		ENDIF

	ENDIF

	IF counter_kappa_dead_sub = 2
	AND flag_as2_3 = 0
		PRINT_NOW (AS2_3) 3000 1 //All Espresso Carts in Shoreside Vale wrecked!
		WAIT 3000
		flag_as2_3 = 1
		IF flag_as2_1 = 0
		AND flag_as2_2 = 0
			PRINT_NOW (AS2_10) 4000 1 //There are still coffee carts in Portland and Staunton Island!
			WAIT 3000
		ENDIF
		IF flag_as2_1 = 1
		AND flag_as2_2 = 0
			PRINT_NOW (AS2_7) 4000 1 //There are still coffee carts on Staunton Island!
			WAIT 3000
		ENDIF
		IF flag_as2_1 = 0
		AND flag_as2_2 = 1
			PRINT_NOW (AS2_8) 4000 1 //There are still coffee carts in Portland!
			WAIT 3000
		ENDIF

	ENDIF


	
ENDWHILE



GOTO mission_as2_passed
	   		


// Mission Asuka Sub2 failed

mission_as2_failed:
PRINT_BIG ( M_FAIL ) 2000 1

IF HAS_PLAYER_BEEN_ARRESTED player
	OVERRIDE_POLICE_STATION_LEVEL LEVEL_COMMERCIAL
ENDIF

IF IS_PLAYER_DEAD player
	OVERRIDE_HOSPITAL_LEVEL LEVEL_COMMERCIAL
ENDIF

RETURN

   

// mission Asuka Sub2 passed

mission_as2_passed:

flag_asuka_suburban_mission2_passed = 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 40000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
CLEAR_WANTED_LEVEL player
ADD_SCORE player 40000
REGISTER_MISSION_PASSED AS2
PLAYER_MADE_PROGRESS 1
START_NEW_SCRIPT asuka_suburban_mission3_loop
RETURN
		


// mission cleanup

mission_cleanup_as2:

flag_player_on_mission = 0
flag_player_on_asuka_suburban_mission = 0

CLEAR_ONSCREEN_TIMER kappa_time
CLEAR_ONSCREEN_COUNTER counter_kappa_dead

SET_GANG_WEAPONS GANG_MAFIA WEAPONTYPE_PISTOL WEAPONTYPE_SHOTGUN //The Mafia

IF flag_kappa1_dead = 0
AND flag_kappa1_created = 1
   REMOVE_BLIP blip_kappa1
ENDIF
/*IF flag_kappa2_dead = 0
AND flag_kappa2_created = 1
   REMOVE_BLIP blip_kappa2
ENDIF*/	
IF flag_kappa3_dead = 0
AND flag_kappa3_created = 1
   REMOVE_BLIP blip_kappa3
ENDIF	
IF flag_kappa4_dead = 0
AND flag_kappa4_created = 1
   REMOVE_BLIP blip_kappa4
ENDIF	
IF flag_kappa5_dead = 0
AND flag_kappa5_created = 1
   REMOVE_BLIP blip_kappa5
ENDIF	
IF flag_kappa6_dead = 0
AND flag_kappa6_created = 1
   REMOVE_BLIP blip_kappa6
ENDIF	
IF flag_kappa7_dead = 0
AND flag_kappa7_created = 1
   REMOVE_BLIP blip_kappa7
ENDIF	
/*IF flag_kappa8_dead = 0
AND flag_kappa8_created = 1
   REMOVE_BLIP blip_kappa8
ENDIF*/	
IF flag_kappa9_dead = 0
AND flag_kappa9_created = 1
   REMOVE_BLIP blip_kappa9
ENDIF	
IF flag_kappa10_dead = 0
AND flag_kappa10_created = 1
   REMOVE_BLIP blip_kappa10
ENDIF	
/*IF flag_kappa11_dead = 0
AND flag_kappa11_created = 1
   REMOVE_BLIP blip_kappa11
ENDIF*/	
IF flag_kappa12_dead = 0
AND flag_kappa12_created = 1
   REMOVE_BLIP blip_kappa12
ENDIF	
	
REMOVE_ALL_SCRIPT_FIRES

MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_1
//MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_2
MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_3
MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_4
MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_5
MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_6
MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_7
//MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_8
MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_9
MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_10
//MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_11
MARK_OBJECT_AS_NO_LONGER_NEEDED kappa_12

MARK_MODEL_AS_NO_LONGER_NEEDED CAR_COLUMB
MARK_MODEL_AS_NO_LONGER_NEEDED coffee

MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_B



MISSION_HAS_FINISHED
RETURN
		

///________________________________GOSUBS_______GOSUBS________________________________BYTHEWAY

MISSION_START
// *****************************************************************************************
// *****************************************************************************************
// *****************************************************************************************
// ***********************************ASUKA SUBURBAN MISSION 3****************************** 
// *****************************************************************************************
// ***************************************'Plane to Sea'************************************
// *****************************************************************************************

// Mission start stuff

GOSUB mission_start_as3
IF HAS_DEATHARREST_BEEN_EXECUTED 
	GOSUB mission_as3_failed
ENDIF
GOSUB mission_cleanup_as3

MISSION_END
 
// Variables for mission
VAR_INT timer_as3 player_as3_boat dodo_as3

VAR_INT bouy_1_as3 bouy_2_as3 bouy_3_as3 bouy_4_as3 bouy_5_as3
VAR_INT bouy_6_as3 bouy_7_as3 bouy_8_as3 bouy_9_as3 bouy_10_as3
VAR_INT bouy_point

VAR_INT blip_as3_boat blip_as3_bouy blip_as3_dodo blip_stash
VAR_INT blip_charlie_1 blip_charlie_2 blip_charlie_3 blip_charlie_4
VAR_INT blip_charlie_5 blip_charlie_6 blip_charlie_7 blip_charlie_8

VAR_FLOAT platform_x platform_y
VAR_FLOAT dodo_as3_x dodo_as3_y dodo_as3_z

VAR_INT charlie_1 charlie_2 charlie_3 charlie_4
VAR_INT charlie_5 charlie_6 charlie_7 charlie_8
VAR_INT rocket_as3

VAR_FLOAT charlie_1_x charlie_1_y charlie_1_z
VAR_FLOAT charlie_2_x charlie_2_y charlie_2_z
VAR_FLOAT charlie_3_x charlie_3_y charlie_3_z
VAR_FLOAT charlie_4_x charlie_4_y charlie_4_z
VAR_FLOAT charlie_5_x charlie_5_y charlie_5_z
VAR_FLOAT charlie_6_x charlie_6_y charlie_6_z
VAR_FLOAT charlie_7_x charlie_7_y charlie_7_z
VAR_FLOAT charlie_8_x charlie_8_y charlie_8_z

VAR_FLOAT min_x max_x min_y max_y min_z max_z

VAR_INT counter_charlie flag_counter_message particle_time flag_particle flag_boat_message
VAR_INT flag_charlie_1 flag_charlie_2 flag_charlie_3 flag_charlie_4
VAR_INT flag_charlie_5 flag_charlie_6 flag_charlie_7 flag_charlie_8

VAR_INT flag_commence_approach flag_runway_blip flag_boat_blip flag_bouy_blip
VAR_INT timer_as3_start timer_as3_now timer_as3_dif
VAR_INT flag_created_baddies flag_mission_as3_failed

VAR_INT bypassForMorgan
bypassForMorgan = 0


// ****************************************Mission Start************************************

mission_start_as3:
REGISTER_MISSION_GIVEN
SCRIPT_NAME asusb3 
//PRINT_BIG ( AS3 ) 5000 1

flag_player_on_mission = 1
flag_player_on_asuka_mission = 1

WAIT 0

// to fix unncessary pathing into the construction site
DISPLAY_RADAR 4 // PATHING STOP AT ROAD

//----------------------------SET FLAGS & VARIABLES--------------------------------------------

timer_as3 = 210000
counter_charlie = 0
flag_commence_approach = 0
flag_counter_message = 0
flag_runway_blip = 0
flag_boat_blip = 0
flag_bouy_blip = 0
particle_time = 0
flag_particle = 0

flag_charlie_1 = 0
flag_charlie_2 = 0
flag_charlie_3 = 0
flag_charlie_4 = 0
flag_charlie_5 = 0
flag_charlie_6 = 0
flag_charlie_7 = 0
flag_charlie_8 = 0

flag_messages = 0
flag_created_baddies = 0
flag_mission_as3_failed = 0
flag_boat_message = 0
// ---------------------------LOCATION COORDS--------------------------------------------------

platform_x = -805.0 
platform_y = -1310.0

killzone_min_x = -1460.0
killzone_min_y = -1050.0
killzone_max_x = -1450.0
killzone_max_y = -1040.0


//  ******************************************* START OF CUTSCENE ***************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_as3_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 250 FADE_OUT

PRINT_BIG ( AS3 ) 15000 2

SWITCH_STREAMING OFF
*/

REQUEST_MODEL csitecutscene

LOAD_SPECIAL_CHARACTER 1 asuka
LOAD_SPECIAL_CHARACTER 2 miguel
LOAD_SPECIAL_CHARACTER 3 maria
LOAD_SPECIAL_MODEL cut_obj1 PLAYERH
LOAD_SPECIAL_MODEL cut_obj2 ASUKAH
LOAD_SPECIAL_MODEL cut_obj3 MARIAH
LOAD_SPECIAL_MODEL cut_obj4 WHIP

/*
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE
*/

LOAD_ALL_MODELS_NOW

WHILE NOT HAS_MODEL_LOADED csitecutscene
 WAIT 0
ENDWHILE
 
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_SPECIAL_CHARACTER_LOADED 3
 WAIT 0
ENDWHILE

WHILE NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj3
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED cut_obj4
 WAIT 0
ENDWHILE

LOAD_CUTSCENE a8_ps

SWITCH_STREAMING ON

SET_CUTSCENE_OFFSET 369.02 -327.5 18.46
  
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player
 
CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_asuka
SET_CUTSCENE_ANIM cs_asuka asuka

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_miguel
SET_CUTSCENE_ANIM cs_miguel miguel

CREATE_CUTSCENE_OBJECT PED_SPECIAL3 cs_maria
SET_CUTSCENE_ANIM cs_maria maria

CREATE_CUTSCENE_OBJECT cut_obj4 cs_whip
SET_CUTSCENE_ANIM cs_whip WHIP
 
CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
SET_CUTSCENE_HEAD_ANIM cs_playerhead player

CREATE_CUTSCENE_HEAD cs_maria CUT_OBJ3 cs_mariahead
SET_CUTSCENE_HEAD_ANIM cs_mariahead maria
 
CREATE_CUTSCENE_HEAD cs_asuka CUT_OBJ2 cs_asukahead
SET_CUTSCENE_HEAD_ANIM cs_asukahead asuka
/*
CREATE_CUTSCENE_HEAD cs_miguel CUT_OBJ3 cs_miguelhead
SET_CUTSCENE_HEAD_ANIM cs_miguelhead miguel
*/
SET_PLAYER_COORDINATES player 373.7523 -327.2676 17.1950
 
SET_PLAYER_HEADING player 270.0
 
DO_FADE 250 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING OFF
//SWITCH_WORLD_PROCESSING OFF

START_CUTSCENE

//------CUTSCENE TEXT-----------------------------
GET_CUTSCENE_TIME cs_time

WHILE cs_time < 459
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW (AS3_A) 5000 1
 
WHILE cs_time < 4401
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_B) 3000 1
 
WHILE cs_time < 7348
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_C) 5000 1
 
WHILE cs_time < 10448
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_C1) 5000 1

WHILE cs_time < 11597
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_D) 2000 1

WHILE cs_time < 13625
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_E) 3000 1

WHILE cs_time < 16457
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_F) 5000 1

WHILE cs_time < 19021
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_F1) 5000 1

WHILE cs_time < 22389
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_G) 5000 1

WHILE cs_time < 26064
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_G1) 5000 1

WHILE cs_time < 28628
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_H) 5000 1

WHILE cs_time < 33182
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_H1) 5000 1

WHILE cs_time < 35785
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_I) 3000 1

WHILE cs_time < 39765
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_J) 3000 1

WHILE cs_time < 42026
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (AS3_K) 3000 1

//WHILE cs_time < 12000
WHILE cs_time < 44333
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
DO_FADE 1500 FADE_OUT
 
WHILE NOT HAS_CUTSCENE_FINISHED
 WAIT 0
ENDWHILE
  
CLEAR_PRINTS
 
WHILE GET_FADING_STATUS
 WAIT 0
ENDWHILE
 
CLEAR_CUTSCENE
 
DO_FADE 0 FADE_OUT
 
SET_CAMERA_BEHIND_PLAYER
 
WAIT 500
 
DO_FADE 1000 FADE_IN 
  
UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
UNLOAD_SPECIAL_CHARACTER 3

MARK_MODEL_AS_NO_LONGER_NEEDED csitecutscene

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ3
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ4

SWITCH_STREAMING ON 
SWITCH_RUBBISH ON
//SWITCH_WORLD_PROCESSING ON

// ******************************************END OF CUTSCENE********************************


// Mission stuff goes here

DISPLAY_ONSCREEN_TIMER timer_as3

//----------------------------LOAD MODELS------------------------------------------------------

REQUEST_MODEL BOAT_REEFER
WHILE NOT HAS_MODEL_LOADED BOAT_REEFER
	WAIT 0
ENDWHILE

CREATE_CAR BOAT_REEFER -330.5 -1462.4 0.0 player_as3_boat
SET_CAR_HEADING player_as3_boat 95.0

ADD_BLIP_FOR_CAR player_as3_boat blip_as3_boat
flag_boat_blip = 1

CREATE_PICKUP WEAPON_ROCKET PICKUP_ONCE -279.6 -1473.8 6.2 rocket_as3

REQUEST_MODEL PLANE_DEADDODO
WHILE NOT HAS_MODEL_LOADED PLANE_DEADDODO
	WAIT 0
ENDWHILE

REQUEST_MODEL packagelarge
WHILE NOT HAS_MODEL_LOADED packagelarge
	WAIT 0
ENDWHILE

REQUEST_MODEL bouy
WHILE NOT HAS_MODEL_LOADED bouy
	WAIT 0
ENDWHILE

REQUEST_MODEL PLANE_DODO
WHILE NOT HAS_MODEL_LOADED PLANE_DODO
	WAIT 0
ENDWHILE

/*
PRINT AS3_A 5000 1//"There is a plane coming into Francis International in (2/3/4/5/6) hours time. It is full of Catalina's poison."
MESSAGE_WAIT 5000 1

PRINT AS3_B 5000 1//"You can avoid airport security by getting a boat out to the runway-light pontoons and shooting the plane down on it's approach."
MESSAGE_WAIT 5000 1

PRINT AS3_C 5000 1//"Collect the charlie from the debris and stash it!"
MESSAGE_WAIT 5000 1

*/





CREATE_OBJECT bouy -825.0 -1360.0 2.0 bouy_1_as3
CREATE_OBJECT bouy -705.0 -1410.0 2.0 bouy_3_as3
CREATE_OBJECT bouy -585.0 -1460.0 2.0 bouy_5_as3
CREATE_OBJECT bouy -785.0 -1260.0 2.0 bouy_6_as3
CREATE_OBJECT bouy -665.0 -1310.0 2.0 bouy_8_as3
CREATE_OBJECT bouy -545.0 -1360.0 2.0 bouy_10_as3
CREATE_OBJECT bouy -765.0 -1385.0 2.0 bouy_2_as3
CREATE_OBJECT bouy -645.0 -1435.0 2.0 bouy_4_as3
CREATE_OBJECT bouy -725.0 -1285.0 2.0 bouy_7_as3
CREATE_OBJECT bouy -605.0 -1335.0 2.0 bouy_9_as3
CREATE_OBJECT bouy platform_x platform_y 2.0 bouy_point

SET_OBJECT_COLLISION bouy_1_as3 true
SET_OBJECT_DYNAMIC bouy_1_as3 true
SET_OBJECT_COLLISION bouy_2_as3 true
SET_OBJECT_DYNAMIC bouy_2_as3 true
SET_OBJECT_COLLISION bouy_3_as3 true
SET_OBJECT_DYNAMIC bouy_3_as3 true
SET_OBJECT_COLLISION bouy_4_as3 true
SET_OBJECT_DYNAMIC bouy_4_as3 true
SET_OBJECT_COLLISION bouy_5_as3 true
SET_OBJECT_DYNAMIC bouy_5_as3 true
SET_OBJECT_COLLISION bouy_6_as3 true
SET_OBJECT_DYNAMIC bouy_6_as3 true
SET_OBJECT_COLLISION bouy_7_as3 true
SET_OBJECT_DYNAMIC bouy_7_as3 true
SET_OBJECT_COLLISION bouy_8_as3 true
SET_OBJECT_DYNAMIC bouy_8_as3 true
SET_OBJECT_COLLISION bouy_9_as3 true
SET_OBJECT_DYNAMIC bouy_9_as3 true
SET_OBJECT_COLLISION bouy_10_as3 true
SET_OBJECT_DYNAMIC bouy_10_as3 true
SET_OBJECT_COLLISION bouy_point true
SET_OBJECT_DYNAMIC bouy_point true

//ADD_BLIP_FOR_OBJECT bouy_point blip_as3_bouy
//CHANGE_BLIP_COLOUR blip_as3_bouy 4

//-----------------CREATE CARTEL BADDIES--------------------------------------

REQUEST_MODEL PED_GANG_COLOMBIAN_A
WHILE NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_A
	WAIT 0
ENDWHILE

REQUEST_MODEL PED_GANG_COLOMBIAN_B
WHILE NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_B
	WAIT 0
ENDWHILE

REQUEST_MODEL CAR_COLUMB
WHILE NOT HAS_MODEL_LOADED CAR_COLUMB
	WAIT 0
ENDWHILE

GOSUB baddies

IF bypassForMorgan = 1  // Skip to the end of the mission so Morgan can see the cutscene.
GOTO loop_as3_8
bypassForMorgan = 0
ENDIF

loop_as3_1: //---player not at location and plane not triggered----------------

	WAIT 0

	IF flag_messages = 0
		IF flag_boat_message = 0
			PRINT_NOW (AS3_1) 4000 1//Find the boat and get to the runway marker bouys!
			flag_boat_message = 1
			flag_messages = 1
		ENDIF
	ENDIF
	IF flag_messages = 0
		IF flag_boat_message = 1
			PRINT_NOW (AS3_1A) 4000 1//~g~Now get to the ~b~marker buoy!
			flag_boat_message = 2
			flag_messages = 1
		ENDIF
	ENDIF

	IF IS_PLAYER_IN_MODEL player BOAT_REEFER
	OR IS_PLAYER_IN_MODEL player BOAT_PREDATOR
	OR IS_PLAYER_IN_MODEL player BOAT_SPEEDER
		IF flag_boat_blip = 1
			REMOVE_BLIP	blip_as3_boat
			flag_boat_blip = 0
		ENDIF
		IF flag_bouy_blip = 0
			ADD_BLIP_FOR_OBJECT bouy_point blip_as3_bouy
			flag_bouy_blip = 1
			flag_messages = 0
		ENDIF

	ENDIF
	IF NOT IS_PLAYER_IN_MODEL player BOAT_REEFER
	AND NOT IS_PLAYER_IN_MODEL player BOAT_PREDATOR
	AND NOT IS_PLAYER_IN_MODEL player BOAT_SPEEDER
		IF flag_boat_blip = 0
		AND NOT IS_CAR_DEAD	player_as3_boat
			ADD_BLIP_FOR_CAR player_as3_boat blip_as3_boat
			flag_boat_blip = 1
		ENDIF
		IF flag_bouy_blip = 1
			REMOVE_BLIP blip_as3_bouy
			flag_bouy_blip = 0
			flag_messages = 0
		ENDIF
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_2D player platform_x platform_y 160.0 160.0 false
		IF NOT IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
			LOAD_COLLISION_WITH_SCREEN LEVEL_SUBURBAN
		ENDIF
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_2D player platform_x platform_y 15.0 15.0 false
		REMOVE_BLIP	blip_as3_bouy
		CLEAR_PRINTS
		flag_messages = 0
		GOTO loop_as3_3
	ENDIF

	IF timer_as3 < 91000
		IF flag_commence_approach = 0
			START_DRUG_RUN
			flag_commence_approach = 1
			FIND_DRUG_PLANE_COORDINATES dodo_as3_x dodo_as3_y dodo_as3_z
			ADD_BLIP_FOR_COORD_OLD dodo_as3_x dodo_as3_y dodo_as3_z 4 blip_only blip_as3_dodo
			CHANGE_BLIP_SCALE blip_as3_dodo 2
		ENDIF
		CLEAR_PRINTS
		flag_messages = 0
		GOTO loop_as3_2
	ENDIF
	
	IF timer_as3 < 1
		CLEAR_ONSCREEN_TIMER timer_as3
	ENDIF
	GOSUB baddies
	
GOTO loop_as3_1
	

  
loop_as3_2: //---player not at location and plane is triggered-----------------

	WAIT 0
	REMOVE_BLIP blip_as3_dodo
	
	IF flag_messages = 0
		IF flag_boat_message = 0
			PRINT_NOW (AS3_1) 4000 1//Find the boat and get to the runway marker bouys!
			flag_boat_message = 1
			flag_messages = 1
		ENDIF
	ENDIF
	IF flag_messages = 0
		IF flag_boat_message = 1
			PRINT_NOW (AS3_2) 4000 1//Get to the runway marker buoys! The plane is on its final approach!!
			flag_boat_message = 2
			flag_messages = 1
		ENDIF
	ENDIF
	
	IF IS_PLAYER_IN_MODEL player BOAT_REEFER
	OR IS_PLAYER_IN_MODEL player BOAT_PREDATOR
	OR IS_PLAYER_IN_MODEL player BOAT_SPEEDER
		IF flag_boat_blip = 1
			REMOVE_BLIP	blip_as3_boat
			flag_boat_blip = 0
		ENDIF
		IF flag_bouy_blip = 0
			ADD_BLIP_FOR_OBJECT bouy_point blip_as3_bouy
			flag_bouy_blip = 1
			flag_messages = 0
			flag_boat_message = 1
		ENDIF
	ENDIF
	IF NOT IS_PLAYER_IN_MODEL player BOAT_REEFER
	AND NOT IS_PLAYER_IN_MODEL player BOAT_PREDATOR
	AND NOT IS_PLAYER_IN_MODEL player BOAT_SPEEDER
		IF flag_boat_blip = 0
		AND NOT IS_CAR_DEAD	player_as3_boat
			ADD_BLIP_FOR_CAR player_as3_boat blip_as3_boat
			flag_boat_blip = 1
		ENDIF
		IF flag_bouy_blip = 1
			REMOVE_BLIP blip_as3_bouy
			flag_bouy_blip = 0
			flag_messages = 0
			flag_boat_message = 1
		ENDIF
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_2D player platform_x platform_y 160.0 160.0 false
		IF NOT IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
			LOAD_COLLISION_WITH_SCREEN LEVEL_SUBURBAN
		ENDIF
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_2D player platform_x platform_y 15.0 15.0 false
		REMOVE_BLIP	blip_as3_bouy
		CLEAR_PRINTS
		flag_messages = 0
		GOTO loop_as3_4
	ENDIF

	IF HAS_DRUG_RUN_BEEN_COMPLETED
		GOTO mission_as3_failed
	ENDIF

	IF HAS_DRUG_PLANE_BEEN_SHOT_DOWN
		CLEAR_PRINTS
		CLEAR_ONSCREEN_TIMER timer_as3
		flag_messages = 0
		GOTO loop_as3_6
	ENDIF
	
	IF timer_as3 < 1
		CLEAR_ONSCREEN_TIMER timer_as3
	ENDIF
	
	//TEST BLIP FOR PLANE
	FIND_DRUG_PLANE_COORDINATES dodo_as3_x dodo_as3_y dodo_as3_z
	ADD_BLIP_FOR_COORD_OLD dodo_as3_x dodo_as3_y dodo_as3_z 4 blip_only blip_as3_dodo
	CHANGE_BLIP_SCALE blip_as3_dodo 3
	
	GOSUB area_check
	IF flag_mission_as3_failed = 1
		GOTO mission_as3_failed	
	ENDIF
	GOSUB baddies

GOTO loop_as3_2


loop_as3_3: //---player at location, plane not triggered-----------------------

	WAIT 0

	IF flag_messages = 0
		PRINT_NOW (AS3_3) 4000 1 //Wait for the plane to start its approach!
		flag_messages = 0
	ENDIF

	IF IS_PLAYER_IN_MODEL player BOAT_REEFER
	OR IS_PLAYER_IN_MODEL player BOAT_PREDATOR
	OR IS_PLAYER_IN_MODEL player BOAT_SPEEDER
		IF flag_boat_blip = 1
			REMOVE_BLIP	blip_as3_boat
			flag_boat_blip = 0
		ENDIF
		IF flag_bouy_blip = 0
			ADD_BLIP_FOR_OBJECT bouy_point blip_as3_bouy
			flag_bouy_blip = 1
			flag_messages = 0
		ENDIF
	ENDIF
	IF NOT IS_PLAYER_IN_MODEL player BOAT_REEFER
	AND NOT IS_PLAYER_IN_MODEL player BOAT_PREDATOR
	AND NOT IS_PLAYER_IN_MODEL player BOAT_SPEEDER
		IF flag_boat_blip = 0
		AND NOT IS_CAR_DEAD	player_as3_boat
			ADD_BLIP_FOR_CAR player_as3_boat blip_as3_boat
			flag_boat_blip = 1
		ENDIF
		IF flag_bouy_blip = 1
			REMOVE_BLIP blip_as3_bouy
			flag_bouy_blip = 0
			flag_messages = 0
		ENDIF
	ENDIF

	IF timer_as3 < 91000
		IF flag_commence_approach = 0
			START_DRUG_RUN
			flag_commence_approach = 1
			FIND_DRUG_PLANE_COORDINATES dodo_as3_x dodo_as3_y dodo_as3_z
			ADD_BLIP_FOR_COORD_OLD dodo_as3_x dodo_as3_y dodo_as3_z 4 blip_only blip_as3_dodo
			CHANGE_BLIP_SCALE blip_as3_dodo 3
		ENDIF
		CLEAR_PRINTS
		flag_messages = 0
		GOTO loop_as3_4
	ENDIF

	IF timer_as3 < 1
		CLEAR_ONSCREEN_TIMER timer_as3
	ENDIF

	GOSUB baddies

GOTO loop_as3_3


loop_as3_4: //---player at location, plane triggered---------------------------

	WAIT 0
	
	REMOVE_BLIP blip_as3_dodo

	//IF NOT IS_CURRENT_PLAYER_WEAPON player WEAPONTYPE_ROCKET
	IF flag_messages = 0
		PRINT_NOW (AS3_4) 4000 1 //Use a rocket launcher to shoot the plane down!
		flag_messages = 1
	ENDIF

	IF NOT IS_CAR_DEAD player_as3_boat
		IF IS_PLAYER_IN_CAR	player player_as3_boat
		AND flag_boat_blip = 1
			REMOVE_BLIP	blip_as3_boat
			flag_boat_blip = 0
		ENDIF
		IF NOT IS_PLAYER_IN_CAR player player_as3_boat
		AND flag_boat_blip = 0
			ADD_BLIP_FOR_CAR player_as3_boat blip_as3_boat
			flag_boat_blip = 1
			flag_messages = 0
		ENDIF
	ENDIF
	
	IF HAS_DRUG_RUN_BEEN_COMPLETED
		GOTO mission_as3_failed
	ENDIF
	
	IF HAS_DRUG_PLANE_BEEN_SHOT_DOWN
		CLEAR_PRINTS
		CLEAR_ONSCREEN_TIMER timer_as3
		flag_messages = 0
		GOTO loop_as3_6
	ENDIF
	
	IF timer_as3 < 1
		CLEAR_ONSCREEN_TIMER timer_as3
	ENDIF

	//TEST BLIP FOR PLANE
	FIND_DRUG_PLANE_COORDINATES dodo_as3_x dodo_as3_y dodo_as3_z
	ADD_BLIP_FOR_COORD_OLD dodo_as3_x dodo_as3_y dodo_as3_z 4 blip_only blip_as3_dodo
	CHANGE_BLIP_SCALE blip_as3_dodo 2
	
	GOSUB area_check
	IF flag_mission_as3_failed = 1
		GOTO mission_as3_failed	
	ENDIF
	GOSUB baddies

GOTO loop_as3_4


loop_as3_6: //---drug shipment shot down---(NB not really a loop!)-------------

	//FIND_DRUG_PLANE_COORDINATES dodo_as3_x dodo_as3_y dodo_as3_z
	REMOVE_BLIP	blip_as3_boat
	REMOVE_BLIP blip_as3_bouy
	CREATE_CAR PLANE_DODO dodo_as3_x dodo_as3_y dodo_as3_z dodo_as3
	SET_CAR_HEALTH dodo_as3 1
	dodo_as3_x = dodo_as3_x + 1.0

	CREATE_OBJECT_NO_OFFSET packagelarge dodo_as3_x dodo_as3_y dodo_as3_z charlie_1
	FLASH_OBJECT charlie_1 On	
	SET_OBJECT_COLLISION charlie_1 TRUE
	SET_OBJECT_DYNAMIC charlie_1 TRUE
	ADD_BLIP_FOR_OBJECT charlie_1 blip_charlie_1
	ADD_TO_OBJECT_VELOCITY charlie_1 18.0 12.0 6.0 //blossom pattern
	//ADD_TO_OBJECT_VELOCITY charlie_1 10.0 0.0 0.0 //dodo velocity


	dodo_as3_y = dodo_as3_y - 1.0
	
	CREATE_OBJECT_NO_OFFSET packagelarge dodo_as3_x dodo_as3_y dodo_as3_z charlie_2
	FLASH_OBJECT charlie_2 On	
	SET_OBJECT_COLLISION charlie_2 TRUE
	SET_OBJECT_DYNAMIC charlie_2 TRUE
	ADD_BLIP_FOR_OBJECT charlie_2 blip_charlie_2
	ADD_TO_OBJECT_VELOCITY charlie_2 14.0 -19.0 7.0


	dodo_as3_x = dodo_as3_x - 1.0
	
	CREATE_OBJECT_NO_OFFSET packagelarge dodo_as3_x dodo_as3_y dodo_as3_z charlie_3
	FLASH_OBJECT charlie_3 On	
	SET_OBJECT_COLLISION charlie_3 TRUE
	SET_OBJECT_DYNAMIC charlie_3 TRUE
	ADD_BLIP_FOR_OBJECT charlie_3 blip_charlie_3
	ADD_TO_OBJECT_VELOCITY charlie_3 13.0 -15.0 1.0

	dodo_as3_x = dodo_as3_x - 1.0

	CREATE_OBJECT_NO_OFFSET packagelarge dodo_as3_x dodo_as3_y dodo_as3_z charlie_4
	FLASH_OBJECT charlie_4 On	
	SET_OBJECT_COLLISION charlie_4 TRUE
	SET_OBJECT_DYNAMIC charlie_4 TRUE
	ADD_BLIP_FOR_OBJECT charlie_4 blip_charlie_4
	ADD_TO_OBJECT_VELOCITY charlie_4 -18.0 -19.5 4.0

	dodo_as3_y = dodo_as3_y + 1.0

	CREATE_OBJECT_NO_OFFSET packagelarge dodo_as3_x dodo_as3_y dodo_as3_z charlie_5
	FLASH_OBJECT charlie_5 On	
	SET_OBJECT_COLLISION charlie_5 TRUE
	SET_OBJECT_DYNAMIC charlie_5 TRUE
	ADD_BLIP_FOR_OBJECT charlie_5 blip_charlie_5
	ADD_TO_OBJECT_VELOCITY charlie_5 -7.0 11.0 8.0

	dodo_as3_y = dodo_as3_y + 1.0

	CREATE_OBJECT_NO_OFFSET packagelarge dodo_as3_x dodo_as3_y dodo_as3_z charlie_6
	FLASH_OBJECT charlie_6 On	
	SET_OBJECT_COLLISION charlie_6 TRUE
	SET_OBJECT_DYNAMIC charlie_6 TRUE
	ADD_BLIP_FOR_OBJECT charlie_6 blip_charlie_6
	ADD_TO_OBJECT_VELOCITY charlie_6 -17.0 4.8 7.0

	dodo_as3_x = dodo_as3_x + 1.0

	CREATE_OBJECT_NO_OFFSET packagelarge dodo_as3_x dodo_as3_y dodo_as3_z charlie_7
	FLASH_OBJECT charlie_7 On	
	SET_OBJECT_COLLISION charlie_7 TRUE
	SET_OBJECT_DYNAMIC charlie_7 TRUE
	ADD_BLIP_FOR_OBJECT charlie_7 blip_charlie_7
	ADD_TO_OBJECT_VELOCITY charlie_7 -11.0 12.0 7.0

	dodo_as3_x = dodo_as3_x + 1.0

	CREATE_OBJECT_NO_OFFSET packagelarge dodo_as3_x dodo_as3_y dodo_as3_z charlie_8
	FLASH_OBJECT charlie_8 On	
	SET_OBJECT_COLLISION charlie_8 TRUE
	SET_OBJECT_DYNAMIC charlie_8 TRUE
	ADD_BLIP_FOR_OBJECT charlie_8 blip_charlie_8
	ADD_TO_OBJECT_VELOCITY charlie_8 10.0 10.0 0.0

	GET_GAME_TIMER timer_as3_start

loop_as3_7: //----collect the packages!!--------------

WHILE counter_charlie  < 8

	WAIT 0

	GOSUB baddies

	IF flag_counter_message = 0
		PRINT_NOW (AS3_5) 5000 1//Collect the cargo!
		flag_counter_message = 1
	ENDIF
	
	GET_GAME_TIMER timer_as3_now
	timer_as3_dif = timer_as3_now - timer_as3_start
	IF timer_as3_dif > particle_time
		particle_time = timer_as3_dif + 200
		flag_particle = 1
	ENDIF
	
	IF flag_particle = 1

		IF flag_charlie_1 = 0
			GET_OBJECT_COORDINATES charlie_1 charlie_1_x charlie_1_y charlie_1_z
			/*
			min_x = charlie_1_x - 0.2
			max_x = charlie_1_x	+ 0.2
			min_y = charlie_1_y	- 0.2
			max_y = charlie_1_y	+ 0.2
			min_z = charlie_1_z	- 0.2
			max_z = charlie_1_z	+ 0.2
			REMOVE_PARTICLE_EFFECTS_IN_AREA Min_x Min_y Min_z Max_x Max_y Max_z
			*/
			IF timer_as3_dif < 6000
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIRE_TRAIL  charlie_1_x charlie_1_y charlie_1_z 0.0 0.0 0.0 0.4 0 0 0 200
			ENDIF
			IF timer_as3_dif > 6000
				ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE  charlie_1_x charlie_1_y charlie_1_z 0.0 0.0 0.0 0.3 0 0 0 200
			ENDIF
		ENDIF
		
		IF flag_charlie_2 = 0
			GET_OBJECT_COORDINATES charlie_2 charlie_2_x charlie_2_y charlie_2_z

			IF timer_as3_dif < 4000
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIRE_TRAIL  charlie_2_x charlie_2_y charlie_2_z 0.0 0.0 0.0 0.4 0 0 0 200
			ENDIF
			IF timer_as3_dif > 4000
				ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE  charlie_2_x charlie_2_y charlie_2_z 0.0 0.0 0.0 0.3 0 0 0 200
			ENDIF
		ENDIF
		
		IF flag_charlie_3 = 0
			GET_OBJECT_COORDINATES charlie_3 charlie_3_x charlie_3_y charlie_3_z

			IF timer_as3_dif < 7000
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIRE_TRAIL  charlie_3_x charlie_3_y charlie_3_z 0.0 0.0 0.0 0.4 0 0 0 200
			ENDIF
			IF timer_as3_dif > 7000
				ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE  charlie_3_x charlie_3_y charlie_3_z 0.0 0.0 0.0 0.3 0 0 0 200
			ENDIF
		ENDIF
		
		IF flag_charlie_4 = 0
			GET_OBJECT_COORDINATES charlie_4 charlie_4_x charlie_4_y charlie_4_z

			IF timer_as3_dif < 3500
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIRE_TRAIL  charlie_4_x charlie_4_y charlie_4_z 0.0 0.0 0.0 0.4 0 0 0 200
			ENDIF
			IF timer_as3_dif > 3500
				ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE  charlie_4_x charlie_4_y charlie_4_z 0.0 0.0 0.0 0.3 0 0 0 200
			ENDIF
		ENDIF
		
		IF flag_charlie_5 = 0
			GET_OBJECT_COORDINATES charlie_5 charlie_5_x charlie_5_y charlie_5_z

			IF timer_as3_dif < 8000
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIRE_TRAIL  charlie_5_x charlie_5_y charlie_5_z 0.0 0.0 0.0 0.4 0 0 0 200
			ENDIF
			IF timer_as3_dif > 8000
				ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE  charlie_5_x charlie_5_y charlie_5_z 0.0 0.0 0.0 0.3 0 0 0 200
			ENDIF
		ENDIF
		
		IF flag_charlie_6 = 0
			GET_OBJECT_COORDINATES charlie_6 charlie_6_x charlie_6_y charlie_6_z

			IF timer_as3_dif < 6000
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIRE_TRAIL  charlie_6_x charlie_6_y charlie_6_z 0.0 0.0 0.0 0.4 0 0 0 200
			ENDIF
			IF timer_as3_dif > 6000
				ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE  charlie_6_x charlie_6_y charlie_6_z 0.0 0.0 0.0 0.3 0 0 0 200
			ENDIF
		ENDIF
		
		IF flag_charlie_7 = 0
			GET_OBJECT_COORDINATES charlie_7 charlie_7_x charlie_7_y charlie_7_z

			IF timer_as3_dif < 7500
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIRE_TRAIL  charlie_7_x charlie_7_y charlie_7_z 0.0 0.0 0.0 0.4 0 0 0 200
			ENDIF
			IF timer_as3_dif > 7500
				ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE  charlie_7_x charlie_7_y charlie_7_z 0.0 0.0 0.0 0.3 0 0 0 200
			ENDIF
		ENDIF
		
		IF flag_charlie_8 = 0
			GET_OBJECT_COORDINATES charlie_8 charlie_8_x charlie_8_y charlie_8_z

			IF timer_as3_dif < 4750
				ADD_MOVING_PARTICLE_EFFECT POBJECT_FIRE_TRAIL  charlie_8_x charlie_8_y charlie_8_z 0.0 0.0 0.0 0.4 0 0 0 200
			ENDIF
			IF timer_as3_dif > 4750
				ADD_MOVING_PARTICLE_EFFECT POBJECT_DRY_ICE  charlie_8_x charlie_8_y charlie_8_z 0.0 0.0 0.0 0.3 0 0 0 200
			ENDIF
		ENDIF
		
		flag_particle = 0
	

	ENDIF


	IF IS_PLAYER_IN_MODEL player BOAT_REEFER
	OR IS_PLAYER_IN_MODEL player BOAT_PREDATOR
	OR IS_PLAYER_IN_MODEL player BOAT_SPEEDER
		IF flag_charlie_1 = 0		
			IF LOCATE_PLAYER_ANY_MEANS_3D player charlie_1_x charlie_1_y charlie_1_z 4.0 4.0 4.0 false
				REMOVE_BLIP blip_charlie_1
				DELETE_OBJECT charlie_1
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_1 = 1
			ENDIF
		ENDIF
		IF flag_charlie_2 = 0
			IF LOCATE_PLAYER_ANY_MEANS_3D player charlie_2_x charlie_2_y charlie_2_z 4.0 4.0 4.0 false
				REMOVE_BLIP blip_charlie_2
				DELETE_OBJECT charlie_2
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_2 = 1
			ENDIF
		ENDIF
		IF flag_charlie_3 = 0
			IF LOCATE_PLAYER_ANY_MEANS_3D player charlie_3_x charlie_3_y charlie_3_z 4.0 4.0 4.0 false
				REMOVE_BLIP blip_charlie_3
				DELETE_OBJECT charlie_3
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_3 = 1
			ENDIF
		ENDIF
		IF flag_charlie_4 = 0
			IF LOCATE_PLAYER_ANY_MEANS_3D player charlie_4_x charlie_4_y charlie_4_z 4.0 4.0 4.0 false
				REMOVE_BLIP blip_charlie_4
				DELETE_OBJECT charlie_4
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_4 = 1
			ENDIF
		ENDIF
		IF flag_charlie_5 = 0
			IF LOCATE_PLAYER_ANY_MEANS_3D player charlie_5_x charlie_5_y charlie_5_z 4.0 4.0 4.0 false
				REMOVE_BLIP blip_charlie_5
				DELETE_OBJECT charlie_5
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_5 = 1
			ENDIF
		ENDIF
		IF flag_charlie_6 = 0
			IF LOCATE_PLAYER_ANY_MEANS_3D player charlie_6_x charlie_6_y charlie_6_z 4.0 4.0 4.0 false
				REMOVE_BLIP blip_charlie_6
				DELETE_OBJECT charlie_6
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_6 = 1
			ENDIF
		ENDIF
		IF flag_charlie_7 = 0
			IF LOCATE_PLAYER_ANY_MEANS_3D player charlie_7_x charlie_7_y charlie_7_z 4.0 4.0 4.0 false
				REMOVE_BLIP blip_charlie_7
				DELETE_OBJECT charlie_7
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_7 = 1
			ENDIF
		ENDIF
		IF flag_charlie_8 = 0
			IF LOCATE_PLAYER_ANY_MEANS_3D player charlie_8_x charlie_8_y charlie_8_z 4.0 4.0 4.0 false
				REMOVE_BLIP blip_charlie_8
				DELETE_OBJECT charlie_8
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_8 = 1
			ENDIF
		ENDIF
	ELSE
		IF flag_charlie_1 = 0		
			IF IS_PLAYER_TOUCHING_OBJECT player charlie_1
				REMOVE_BLIP blip_charlie_1
				DELETE_OBJECT charlie_1
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_1 = 1
			ENDIF
		ENDIF
		IF flag_charlie_2 = 0
			IF IS_PLAYER_TOUCHING_OBJECT player charlie_2
				REMOVE_BLIP blip_charlie_2
				DELETE_OBJECT charlie_2
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_2 = 1
			ENDIF
		ENDIF
		IF flag_charlie_3 = 0
			IF IS_PLAYER_TOUCHING_OBJECT player charlie_3
				REMOVE_BLIP blip_charlie_3
				DELETE_OBJECT charlie_3
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_3 = 1
			ENDIF
		ENDIF
		IF flag_charlie_4 = 0
			IF IS_PLAYER_TOUCHING_OBJECT player charlie_4
				REMOVE_BLIP blip_charlie_4
				DELETE_OBJECT charlie_4
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_4 = 1
			ENDIF
		ENDIF
		IF flag_charlie_5 = 0
			IF IS_PLAYER_TOUCHING_OBJECT player charlie_5
				REMOVE_BLIP blip_charlie_5
				DELETE_OBJECT charlie_5
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_5 = 1
			ENDIF
		ENDIF
		IF flag_charlie_6 = 0
			IF IS_PLAYER_TOUCHING_OBJECT player charlie_6
				REMOVE_BLIP blip_charlie_6
				DELETE_OBJECT charlie_6
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_6 = 1
			ENDIF
		ENDIF
		IF flag_charlie_7 = 0
			IF IS_PLAYER_TOUCHING_OBJECT player charlie_7
				REMOVE_BLIP blip_charlie_7
				DELETE_OBJECT charlie_7
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_7 = 1
			ENDIF
		ENDIF
		IF flag_charlie_8 = 0
			IF IS_PLAYER_TOUCHING_OBJECT player charlie_8
				REMOVE_BLIP blip_charlie_8
				DELETE_OBJECT charlie_8
				++ counter_charlie
				PRINT_WITH_NUMBER_NOW (AS3_6) counter_charlie 3000 1
				flag_charlie_8 = 1
			ENDIF
		ENDIF

	ENDIF
	
	
ENDWHILE

loop_as3_8: //------------------------------Stashing the Charlie-----------------------------------

PRINT_NOW (STASH) 4000 1

ADD_BLIP_FOR_COORD 367.25 -328.0 19.5 blip_stash

WHILE NOT LOCATE_PLAYER_ON_FOOT_3D player 366.939 -328.025 18.5 1.0 1.0 4.0 true
	WAIT 0
ENDWHILE

REMOVE_BLIP blip_stash
//  ******************************************* START OF CUTSCENE ***************************


MAKE_PLAYER_SAFE_FOR_CUTSCENE Player

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

SWITCH_STREAMING OFF

PRINT_BIG ( AS4 ) 15000 2

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

REQUEST_MODEL csitecutscene

LOAD_SPECIAL_CHARACTER 1 asuka
LOAD_SPECIAL_CHARACTER 2 miguel

LOAD_SPECIAL_MODEL cut_obj1 whip
LOAD_SPECIAL_MODEL cut_obj2 note

/*
WHILE GET_FADING_STATUS
	WAIT 0

ENDWHILE
*/

LOAD_ALL_MODELS_NOW
 
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
OR NOT HAS_MODEL_LOADED cut_obj1
OR NOT HAS_MODEL_LOADED cut_obj2
OR NOT HAS_MODEL_LOADED csitecutscene
	WAIT 0
ENDWHILE

LOAD_CUTSCENE a9_asd

SET_CUTSCENE_OFFSET 369.02 -327.5 18.46
  
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player
 
CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_asuka
SET_CUTSCENE_ANIM cs_asuka asuka

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_miguel
SET_CUTSCENE_ANIM cs_miguel miguel
 
CREATE_CUTSCENE_OBJECT CUT_OBJ1 cs_whip
SET_CUTSCENE_ANIM cs_whip whip
 
CREATE_CUTSCENE_OBJECT CUT_OBJ2 cs_note
SET_CUTSCENE_ANIM cs_note note

//CREATE_CUTSCENE_HEAD cs_miguel CUT_OBJ3 cs_miguelhead
//SET_CUTSCENE_HEAD_ANIM cs_miguelhead miguel

SET_PLAYER_COORDINATES player 373.7523 -327.2676 17.1950
 
SET_PLAYER_HEADING player 270.0
 
DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON
START_CUTSCENE

//------CUTSCENE TEXT-----------------------------
GET_CUTSCENE_TIME cs_time

WHILE cs_time < 3000
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW (CAT1_A) 5000 1
 
WHILE cs_time < 8000
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
PRINT_NOW (CAT1_B) 4000 1
 
WHILE cs_time < 12444
 WAIT 0
 GET_CUTSCENE_TIME cs_time
ENDWHILE
 
 
DO_FADE 1500 FADE_OUT
 
WHILE GET_FADING_STATUS
 WAIT 0
ENDWHILE
 
WHILE NOT HAS_CUTSCENE_FINISHED
 WAIT 0
ENDWHILE
  
CLEAR_PRINTS
 
CLEAR_CUTSCENE
 
//DO_FADE 0 FADE_OUT
 
SET_CAMERA_BEHIND_PLAYER
 
WAIT 500
 
DO_FADE 1500 FADE_IN 
  
UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2

MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED csitecutscene

SWITCH_RUBBISH ON
// ******************************************END OF CUTSCENE********************************


GOTO mission_as3_passed
	   		


// Mission Asuka Sub3 failed

mission_as3_failed:
PRINT_BIG ( M_FAIL ) 2000 1

IF HAS_PLAYER_BEEN_ARRESTED player
	OVERRIDE_POLICE_STATION_LEVEL LEVEL_COMMERCIAL
ENDIF

IF IS_PLAYER_DEAD player
	OVERRIDE_HOSPITAL_LEVEL LEVEL_COMMERCIAL
ENDIF

RETURN

   

// mission Asuka Sub3 passed

mission_as3_passed:

flag_asuka_suburban_mission3_passed = 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 45000 5000 1
PLAY_MISSION_PASSED_TUNE 1 
CLEAR_WANTED_LEVEL player
ADD_SCORE player 45000
REMOVE_BLIP asuka_contact_blip
REMOVE_BLIP maria_contact_blip
ADD_SPRITE_BLIP_FOR_CONTACT_POINT -362.8 245.9 60.0 RADAR_SPRITE_CAT maria_contact_blip
START_NEW_SCRIPT cat_mission1_loop
REGISTER_MISSION_PASSED AS3
PLAYER_MADE_PROGRESS 1
//START_NEW_SCRIPT asuka_suburban_mission4_loop
RETURN
		


// mission cleanup

mission_cleanup_as3:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_asuka_suburban_mission = 0

CLEAR_ONSCREEN_TIMER timer_as3
REMOVE_BLIP	blip_as3_boat
REMOVE_BLIP blip_as3_dodo
REMOVE_BLIP blip_as3_bouy
REMOVE_BLIP blip_stash

IF NOT HAS_PICKUP_BEEN_COLLECTED rocket_as3
	REMOVE_PICKUP rocket_as3
ENDIF

MARK_MODEL_AS_NO_LONGER_NEEDED bouy
MARK_MODEL_AS_NO_LONGER_NEEDED BOAT_REEFER
MARK_MODEL_AS_NO_LONGER_NEEDED packagelarge
MARK_MODEL_AS_NO_LONGER_NEEDED PLANE_DEADDODO
MARK_MODEL_AS_NO_LONGER_NEEDED PLANE_DODO
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_B
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_COLUMB


MISSION_HAS_FINISHED
RETURN
		

///________________________________GOSUBS_______GOSUBS________________________________BYTHEWAY


baddies:

IF flag_created_baddies = 0
	IF IS_COLLISION_IN_MEMORY LEVEL_SUBURBAN
		CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1015.0 -1269.0 -100.0 kappa_cartel1
		SET_CHAR_HEADING kappa_cartel1 265.0
		SET_CHAR_THREAT_SEARCH kappa_cartel1 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR kappa_cartel1 WEAPONTYPE_CHAINGUN 100
		ADD_ARMOUR_TO_CHAR kappa_cartel1 100
		//SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel1 true

		CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1013.0 -1260.7 -100.0 kappa_cartel2
		SET_CHAR_HEADING kappa_cartel2 300.0
		SET_CHAR_THREAT_SEARCH kappa_cartel2 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR kappa_cartel2 WEAPONTYPE_M16 100
		ADD_ARMOUR_TO_CHAR kappa_cartel2 100
		//SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel2 true

		CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1027.3 -1265.2 -100.0 kappa_cartel3
		SET_CHAR_HEADING kappa_cartel3 265.0
		SET_CHAR_THREAT_SEARCH kappa_cartel3 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR kappa_cartel3 WEAPONTYPE_CHAINGUN 100
		ADD_ARMOUR_TO_CHAR kappa_cartel3 100
		//SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel3 true

		CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1380.0 -1043.0 -100.0 kappa_cartel4
		SET_CHAR_HEADING kappa_cartel4 340.0
		SET_CHAR_THREAT_SEARCH kappa_cartel4 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR kappa_cartel4 WEAPONTYPE_M16 100
		ADD_ARMOUR_TO_CHAR kappa_cartel4 100
		//SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel4 true

		CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1392.0 -1043.3 -100.0 kappa_cartel5
		SET_CHAR_HEADING kappa_cartel5 240.0
		SET_CHAR_THREAT_SEARCH kappa_cartel5 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR kappa_cartel5 WEAPONTYPE_M16 100
		ADD_ARMOUR_TO_CHAR kappa_cartel5 100
		//SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel5 true


		CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1488.0 -1056.0 -100.0 kappa_cartel6
		SET_CHAR_HEADING kappa_cartel6 110.0
		SET_CHAR_THREAT_SEARCH kappa_cartel6 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR kappa_cartel6 WEAPONTYPE_M16 100
		ADD_ARMOUR_TO_CHAR kappa_cartel6 100
		//SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel6 true

		CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1473.0 -1062.0 -100.0 kappa_cartel7
		SET_CHAR_HEADING kappa_cartel7 280.0
		SET_CHAR_THREAT_SEARCH kappa_cartel7 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR kappa_cartel7 WEAPONTYPE_M16 100
		ADD_ARMOUR_TO_CHAR kappa_cartel7 100
		//SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel7 true

		CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -849.0 -1235.0 -100.0 kappa_cartel8
		SET_CHAR_HEADING kappa_cartel8 250.0
		SET_CHAR_THREAT_SEARCH kappa_cartel8 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR kappa_cartel8 WEAPONTYPE_CHAINGUN 100
		ADD_ARMOUR_TO_CHAR kappa_cartel8 100
		//SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel1 true

		CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1478.0 -1055.0 -100.0 kappa_cartel9
		SET_CHAR_HEADING kappa_cartel9 250.0
		SET_CHAR_THREAT_SEARCH kappa_cartel9 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR kappa_cartel9 WEAPONTYPE_CHAINGUN 100
		ADD_ARMOUR_TO_CHAR kappa_cartel9 100
		//SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel1 true

		CREATE_CAR CAR_COLUMB -1019.0 -1263.0 -100.0 cartel_car_a_as1
		SET_CAR_HEADING cartel_car_a_as1 50.0

		CREATE_CAR CAR_COLUMB -1383.3 -1045.0 -100.0 cartel_car_b_as1
		SET_CAR_HEADING cartel_car_b_as1 231.5

		CREATE_CAR CAR_COLUMB -1478.3 -1062.8 -100.0 cartel_car_d_as1
		SET_CAR_HEADING cartel_car_b_as1 250.0
		
		CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1385.3 -1035.0 -100.0 kappa_cartel10
		SET_CHAR_HEADING kappa_cartel10 231.0
		SET_CHAR_THREAT_SEARCH kappa_cartel10 THREAT_PLAYER1
		GIVE_WEAPON_TO_CHAR kappa_cartel10 WEAPONTYPE_ROCKET 5
		ADD_ARMOUR_TO_CHAR kappa_cartel10 100
		SET_CHAR_STAY_IN_SAME_PLACE kappa_cartel1 true

		flag_created_baddies = 1
	ENDIF
ENDIF

IF flag_created_baddies = 1
	IF LOCATE_PLAYER_ANY_MEANS_2D player -1019.0 -1263.0 60.0 60.0 false
		IF NOT IS_CHAR_DEAD kappa_cartel3
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel3 player
		ENDIF
	ENDIF

	IF LOCATE_PLAYER_ANY_MEANS_2D player -1385.3 -1035.0 80.0 80.0 false
		IF NOT IS_CHAR_DEAD kappa_cartel4
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel4 player
		ENDIF
		IF NOT IS_CHAR_DEAD kappa_cartel5
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel5 player
		ENDIF
	ENDIF

	IF LOCATE_PLAYER_ANY_MEANS_2D player -1478.3 -1062.8 80.0 80.0 false
		IF NOT IS_CHAR_DEAD kappa_cartel6
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel6 player
		ENDIF
		IF NOT IS_CHAR_DEAD kappa_cartel7
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel7 player
		ENDIF
		IF NOT IS_CHAR_DEAD kappa_cartel9
			SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS kappa_cartel9 player
		ENDIF
	ENDIF
ENDIF

RETURN



area_check:

IF dodo_as3_x > killzone_min_x
AND dodo_as3_x < killzone_max_x
	IF dodo_as3_y > killzone_min_y
	AND dodo_as3_y < killzone_max_y
		IF dodo_as3_z > 5.0
		AND dodo_as3_z < 30.0
			flag_mission_as3_failed = 1
		ENDIF
	ENDIF
ENDIF

RETURN
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************
// *************************************Hood Mission 1****************************************
// ****************************************Drive By*******************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME hood1

// Mission start stuff

GOSUB mission_start_hood1
      
GOSUB mission_cleanup_hood1

MISSION_END


// Variables for mission

VAR_INT frenzy_state

VAR_INT radar_blip_coord_hm1

VAR_INT flag_blip_on_hm1
	
// ***************************************Mission Start*************************************


mission_start_hood1:

flag_player_on_mission = 1

flag_player_on_hood_mission = 1

flag_blip_on_hm1 = 0

REGISTER_MISSION_GIVEN

WAIT 0

{

SET_DEATHARREST_STATE OFF

SETUP_ZONE_PED_INFO PROJECT DAY   (30) (0 0 0 0) 0 0 800 0 //WICHITA GARDENS 
SETUP_ZONE_PED_INFO PROJECT NIGHT (30) (0 0 0 0) 0 0 800 0

// ****************************************START OF CUTSCENE********************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_hood1_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( HM_1 ) 15000 2 //"Uzi Driver"

SWITCH_STREAMING OFF

//LOAD_SPECIAL_MODEL cut_obj1 PLAYERH			

WHILE GET_FADING_STATUS
					  
	WAIT 0

ENDWHILE
*/

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS -414.57 97.73 1.0 -589.29 -101.77 20.0 

//LOAD_ALL_MODELS_NOW

//WHILE NOT HAS_MODEL_LOADED cut_obj1

//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE hd_ph1 
SET_CUTSCENE_OFFSET -444.714 -6.321 2.9
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player


DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2096
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( HM1_A ) 10000 1 //"Yo this is D-ice of the Red Jacks!" 

WHILE cs_time < 4887
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM1_B ) 10000 1  //"I got a problem that's messin' my rep." 

WHILE cs_time < 7511
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM1_C ) 10000 1  //"These yound punks..." 

WHILE cs_time < 12668
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM1_D ) 10000 1 //"Nine is their tag...." 

WHILE cs_time < 16765
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM1_G ) 10000 1 //"is another day the Jacks..." 

WHILE cs_time < 19026
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM1_E ) 10000 1  //I want you to show..." 

WHILE cs_time < 23017
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM1_H ) 10000 1  //"Mow those nines down." 

WHILE cs_time < 25018
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM1_F ) 10000 1  ///"Watch your back..."

WHILE cs_time < 28865
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( HM1_F ) 

WHILE cs_time < 30000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

//SWITCH_STREAMING ON

WAIT 500

DO_FADE 1500 FADE_IN

//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

SET_PED_DENSITY_MULTIPLIER 1.0


// ****************************************END OF CUTSCENE**********************************

IF NOT IS_PLAYER_PLAYING player
	PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
	GOTO mission_hood1_failed
ENDIF

WHILE GET_FADING_STATUS

	WAIT 0

	IF NOT IS_PLAYER_PLAYING player
		PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
		GOTO mission_hood1_failed
	ENDIF

ENDWHILE

// waiting for the player to get to the zone

PRINT_NOW ( HM1_2 ) 5000 1 //"Get a vehicle!"

IF flag_done_drive_by_help = 0

	GET_CONTROLLER_MODE	controlmode

	PRINT_HELP ( DRIVE_A ) //"Have an Uzi selected when entering a vehicle then look left or right and press the ~h~| button~w~ to fire."
	flag_done_drive_by_help = 1
		
ENDIF


WHILE NOT IS_PLAYER_IN_ANY_CAR player

	WAIT 0

	IF NOT IS_PLAYER_PLAYING player
		PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
		GOTO mission_hood1_failed
	ENDIF

ENDWHILE

PRINT_NOW ( HM1_3 ) 5000 1 //"Get to the correct zone!"
ADD_BLIP_FOR_COORD -442.3 -6.8 -100.0 radar_blip_coord_hm1
flag_blip_on_hm1 = 1

WHILE NOT IS_PLAYER_IN_ZONE	player PROJECT
AND NOT IS_PLAYER_IN_ANY_CAR player

	WAIT 0

	IF NOT IS_PLAYER_PLAYING player
		PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
		GOTO mission_hood1_failed
	ENDIF

ENDWHILE

REMOVE_BLIP radar_blip_coord_hm1
flag_blip_on_hm1 = 0

START_KILL_FRENZY ( HM1_1 ) WEAPONTYPE_UZI_DRIVEBY 150000 20 PED_GANG_HOOD_B -1 -1 -1 FALSE

READ_KILL_FRENZY_STATUS frenzy_state

WHILE frenzy_state = 1

	WAIT 0

	READ_KILL_FRENZY_STATUS frenzy_state

	IF NOT IS_PLAYER_PLAYING player
		PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
		GOTO mission_hood1_failed
	ELSE

		IF NOT IS_PLAYER_IN_ZONE player PROJECT

			IF flag_blip_on_hm1 = 0
				ADD_BLIP_FOR_COORD -442.3 -6.8 -100.0 radar_blip_coord_hm1
				PRINT_NOW ( HM1_3 ) 5000 1 //"Get to the correct zone!"
				flag_blip_on_hm1 = 1
			ENDIF

		ELSE
			
			IF flag_blip_on_hm1 = 1
				REMOVE_BLIP radar_blip_coord_hm1
				flag_blip_on_hm1 = 0
			ENDIF

		ENDIF

	ENDIF
			
ENDWHILE

READ_KILL_FRENZY_STATUS frenzy_state



IF frenzy_state = 2
	GOTO mission_hood1_passed
ENDIF

IF frenzy_state = 3
	PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
	GOTO mission_hood1_failed
ENDIF

} 

// Mission hood1 failed

mission_hood1_failed:

IF HAS_PLAYER_BEEN_ARRESTED player
	OVERRIDE_POLICE_STATION_LEVEL LEVEL_SUBURBAN 
ENDIF

IF IS_PLAYER_DEAD player
	OVERRIDE_HOSPITAL_LEVEL LEVEL_SUBURBAN
ENDIF

RETURN


   

// mission hood1 passed

mission_hood1_passed:

flag_hood_mission1_passed = 1
REGISTER_MISSION_PASSED ( HM_1 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 10000
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT hood_mission2_loop

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		


// mission cleanup

mission_cleanup_hood1:

flag_player_on_mission = 0
flag_player_on_hood_mission = 0
REMOVE_BLIP radar_blip_coord_hm1
SETUP_ZONE_PED_INFO PROJECT DAY   (13) (0 0 0 0) 0 0 300 20 //WICHITA GARDENS 
SETUP_ZONE_PED_INFO PROJECT NIGHT ( 9) (0 0 0 0) 0 0 400 10
MISSION_HAS_FINISHED
RETURN
		

  
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Hood Mission 2****************************************
// **************************************R C ASSASSIN*****************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME hood2

// Mission start stuff

GOSUB mission_start_hood2

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_hood2_failed
	ENDIF

GOSUB mission_cleanup_hood2

MISSION_END


// Variables for mission

VAR_INT mission_car_hm2

VAR_INT radar_blip_car1_hm2

VAR_INT target_van1_hm2

VAR_INT target_van2_hm2

VAR_INT target_van3_hm2

VAR_INT van_driver1_hm2  //Drives van 1

VAR_INT van_driver2_hm2  //Drives van 2

VAR_INT van_driver3_hm2  //Drives van 3

VAR_INT radar_blip_van1_hm2

VAR_INT radar_blip_van2_hm2

VAR_INT radar_blip_van3_hm2

VAR_INT flag_van1_dead_hm2

VAR_INT flag_van2_dead_hm2

VAR_INT flag_van3_dead_hm2

VAR_INT counter_all_vans_dead_hm2

VAR_INT counter_no_of_cars_player_had_hm2

VAR_INT flag_player_got_car_hm2

VAR_INT flag_buggy_help2_hm2

VAR_INT flag_buggy_help3_hm2

VAR_INT flag_buggy_help1_hm2

VAR_INT buggies_left_hm2

VAR_INT total_buggy_hm2
	
// ***************************************Mission Start*************************************


mission_start_hood2:

flag_player_on_mission = 1

flag_player_on_hood_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

counter_all_vans_dead_hm2 = 0

flag_van1_dead_hm2 = 0

flag_van2_dead_hm2 = 0

flag_van3_dead_hm2 = 0

counter_all_vans_dead_hm2 = 0

counter_no_of_cars_player_had_hm2 = 0

flag_player_got_car_hm2 = 0

flag_buggy_help2_hm2 = 0

flag_buggy_help3_hm2 = 0

flag_buggy_help1_hm2 = 0

buggies_left_hm2 = 0

total_buggy_hm2 = 5

{

// *****************************************START OF CUTSCENE*******************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_hood2_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( HM_2 ) 15000 2 //"TOYMINATOR"

SWITCH_STREAMING OFF

//LOAD_SPECIAL_MODEL cut_obj1 PLAYERH			

WHILE GET_FADING_STATUS
					  
	WAIT 0

ENDWHILE
*/

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS -414.57 97.73 1.0 -589.29 -101.77 20.0

//LOAD_ALL_MODELS_NOW

//WHILE NOT HAS_MODEL_LOADED cut_obj1

//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE hd_ph2 
SET_CUTSCENE_OFFSET -444.714 -6.321 2.9
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player


DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( HM2_A ) 10000 1  //" Those Nines are..." 

WHILE cs_time < 3468
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM2_B ) 10000 1  //"These Bitches..." 

WHILE cs_time < 6630
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM2_C ) 10000 1  //"and slinging it to brothers..." 

WHILE cs_time < 8077
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM2_D ) 10000 1  //"Theres a car parked up the way..." 

WHILE cs_time < 9819
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM2_E ) 10000 1 //"There's some stuff in there.." 

WHILE cs_time < 12413
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM2_F ) 10000 1  //"and wreck all there..."

WHILE cs_time < 14200
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( HM2_F ) 

WHILE cs_time < 15333
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

//SWITCH_STREAMING ON

WAIT 500

DO_FADE 1500 FADE_IN

//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

SET_PED_DENSITY_MULTIPLIER 1.0

// ******************************************END OF CUTSCENE********************************


REQUEST_MODEL CAR_TOYZ

REQUEST_MODEL CAR_SECURICAR

REQUEST_MODEL car_rcbandit

WHILE NOT HAS_MODEL_LOADED CAR_TOYZ
OR NOT HAS_MODEL_LOADED CAR_SECURICAR
OR NOT HAS_MODEL_LOADED car_rcbandit
	
	WAIT 0

ENDWHILE

CREATE_CAR CAR_TOYZ -682.02 76.60 -100.0 mission_car_hm2

//SET_CAR_HEADING mission_car_hm2 0.0

ADD_BLIP_FOR_CAR mission_car_hm2 radar_blip_car1_hm2

// waiting for the player to get into the control car

WHILE NOT IS_PLAYER_SITTING_IN_CAR player mission_car_hm2

	WAIT 0

	IF IS_CAR_DEAD mission_car_hm2
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_hood2_failed
	ENDIF

ENDWHILE

// when going around in the RC cars, dont path
DISPLAY_RADAR 2 // PATHING OFF

buggies_left_hm2 = total_buggy_hm2 - counter_no_of_cars_player_had_hm2

DISPLAY_ONSCREEN_COUNTER_WITH_STRING buggies_left_hm2 COUNTER_DISPLAY_NUMBER ( BUGGY )

SET_POLICE_IGNORE_PLAYER player ON

REMOVE_BLIP radar_blip_car1_hm2

PRINT_HELP ( HM2_1 ) //"Use the radio controlled cars to destroy the trucks press | to detonate"
flag_buggy_help1_hm2 = 1

CLEAR_AREA -681.42 91.35 17.7 2.0 TRUE 

GIVE_REMOTE_CONTROLLED_CAR_TO_PLAYER player -681.42 91.35 17.7 94.0

++ counter_no_of_cars_player_had_hm2

// creates van 1

CREATE_CAR CAR_SECURICAR -841.0 -130.0 -100.0 target_van1_hm2

CREATE_CHAR_INSIDE_CAR target_van1_hm2 PEDTYPE_CIVMALE PED_MALE1 van_driver1_hm2

SET_CAR_ONLY_DAMAGED_BY_PLAYER target_van1_hm2 TRUE

SET_CAR_AVOID_LEVEL_TRANSITIONS target_van1_hm2 TRUE 

ADD_BLIP_FOR_CAR target_van1_hm2 radar_blip_van1_hm2

SET_CAR_DRIVING_STYLE target_van1_hm2 2

SET_CAR_CRUISE_SPEED target_van1_hm2 12.0

CAR_WANDER_RANDOMLY target_van1_hm2

// creates van 2

CREATE_CAR CAR_SECURICAR -437.0 -67.0 -100.0 target_van2_hm2

CREATE_CHAR_INSIDE_CAR target_van2_hm2 PEDTYPE_CIVMALE PED_MALE1 van_driver2_hm2

SET_CAR_ONLY_DAMAGED_BY_PLAYER target_van2_hm2 TRUE

SET_CAR_AVOID_LEVEL_TRANSITIONS target_van2_hm2 TRUE

ADD_BLIP_FOR_CAR target_van2_hm2 radar_blip_van2_hm2

SET_CAR_DRIVING_STYLE target_van2_hm2 2

SET_CAR_CRUISE_SPEED target_van2_hm2 12.0

CAR_WANDER_RANDOMLY target_van2_hm2

// creates van 3

CREATE_CAR CAR_SECURICAR -1172.0 467.0 -100.0 target_van3_hm2

CREATE_CHAR_INSIDE_CAR target_van3_hm2 PEDTYPE_CIVMALE PED_MALE1 van_driver3_hm2

SET_CAR_ONLY_DAMAGED_BY_PLAYER target_van3_hm2 TRUE

SET_CAR_AVOID_LEVEL_TRANSITIONS target_van3_hm2 TRUE

ADD_BLIP_FOR_CAR target_van3_hm2 radar_blip_van3_hm2

SET_CAR_DRIVING_STYLE target_van3_hm2 2

SET_CAR_CRUISE_SPEED target_van3_hm2 12.0

CAR_WANDER_RANDOMLY target_van3_hm2

// waiting for the player to destroy all of the vans

buggies_left_hm2 = total_buggy_hm2 - counter_no_of_cars_player_had_hm2

timerb = 0

WHILE NOT counter_all_vans_dead_hm2 = 3

	WAIT 0

	buggies_left_hm2 = total_buggy_hm2 - counter_no_of_cars_player_had_hm2 

	IF flag_buggy_help2_hm2 = 0
	AND flag_buggy_help1_hm2 = 1

		IF timerb > 7000
			PRINT_HELP ( HM2_3 ) //"The buggies can go underneath vehicles but if you touch the wheels the buggy will detonate instantly."
			flag_buggy_help2_hm2 = 1
			//timerb = 0
		ENDIF
		
	ENDIF
	
	IF flag_buggy_help3_hm2 = 0

		IF flag_buggy_help2_hm2 = 1 
	
			IF timerb > 14000
				PRINT_HELP ( HM2_4 ) //"The buggy will detonate if you get out of range!"
				flag_buggy_help3_hm2 = 1
			ENDIF
			
		ENDIF
		
	ENDIF  
	
	CLEAR_WANTED_LEVEL player

IF NOT IS_CAR_DEAD mission_car_hm2 

	IF NOT IS_PLAYER_IN_REMOTE_MODE player
	AND counter_no_of_cars_player_had_hm2 < 6
	AND flag_player_got_car_hm2 = 0
	AND IS_PLAYER_SITTING_IN_CAR player mission_car_hm2
		CLEAR_AREA -681.42 91.35 17.7 2.0 FALSE
		GIVE_REMOTE_CONTROLLED_CAR_TO_PLAYER player -681.42 91.35 17.7 94.0
		++ counter_no_of_cars_player_had_hm2
		flag_player_got_car_hm2 = 1 
	ENDIF

ENDIF

IF NOT IS_PLAYER_IN_REMOTE_MODE player
	flag_player_got_car_hm2 = 0
ENDIF

IF flag_van1_dead_hm2 = 0

	IF IS_CAR_DEAD target_van1_hm2
		++ counter_all_vans_dead_hm2
		PRINT_NOW ( HM2_6 ) 5000 1 //"Armoured Car destroyed!"
		REMOVE_BLIP radar_blip_van1_hm2
		flag_van1_dead_hm2 = 1
	 ENDIF

ENDIF

IF flag_van2_dead_hm2 = 0

	IF IS_CAR_DEAD target_van2_hm2
		++ counter_all_vans_dead_hm2
		PRINT_NOW ( HM2_6 ) 5000 1 //"Armoured Car destroyed!"
		REMOVE_BLIP radar_blip_van2_hm2
		flag_van2_dead_hm2 = 1
	 ENDIF

ENDIF

IF flag_van3_dead_hm2 = 0

	IF IS_CAR_DEAD target_van3_hm2
		++ counter_all_vans_dead_hm2
		PRINT_NOW ( HM2_6 ) 5000 1 //"Armoured Car destroyed!"
		REMOVE_BLIP radar_blip_van3_hm2
		flag_van3_dead_hm2 = 1
	 ENDIF

ENDIF

IF counter_no_of_cars_player_had_hm2 = 5
AND flag_player_got_car_hm2 = 0
AND NOT counter_all_vans_dead_hm2 = 3
	PRINT_NOW ( HM2_2 ) 5000 1 //"You failed to destroy all the armoured cars!"
	GOTO mission_hood2_failed

ENDIF

IF NOT IS_PLAYER_IN_ANY_CAR player
	PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"
	PRINT_NOW ( HM2_2 ) 5000 1 //"You failed to destroy all the armoured cars!"
	GOTO mission_hood2_failed
ENDIF 

ENDWHILE

BLOW_UP_RC_BUGGY

WAIT 1000
CLEAR_PRINTS
WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE


}

GOTO mission_hood2_passed

 

// Mission hood2 failed

mission_hood2_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

IF HAS_PLAYER_BEEN_ARRESTED player
	OVERRIDE_POLICE_STATION_LEVEL LEVEL_SUBURBAN 
ENDIF

IF IS_PLAYER_DEAD player
	OVERRIDE_HOSPITAL_LEVEL LEVEL_SUBURBAN
ENDIF

RETURN


   

// mission hood2 passed

mission_hood2_passed:

flag_hood_mission2_passed = 1
REGISTER_MISSION_PASSED ( HM_2 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //"Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1 
ADD_SCORE player 10000
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT hood_mission3_loop

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		


// mission cleanup

mission_cleanup_hood2:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_hood_mission = 0
LOAD_SCENE -660.9 76.0 18.7
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_TOYZ
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_SECURICAR
MARK_MODEL_AS_NO_LONGER_NEEDED car_rcbandit
CLEAR_ONSCREEN_COUNTER buggies_left_hm2
REMOVE_BLIP radar_blip_car1_hm2
REMOVE_BLIP radar_blip_van1_hm2
REMOVE_BLIP radar_blip_van2_hm2
REMOVE_BLIP radar_blip_van3_hm2
MISSION_HAS_FINISHED
RETURN
		

  
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************
// *************************************Hood Mission 3****************************************
// *************************************Rigged To Blow****************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME hood3

// Mission start stuff

GOSUB mission_start_hood3

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_hood3_failed
	ENDIF

GOSUB mission_cleanup_hood3

MISSION_END


// Variables for mission

VAR_INT car_hm3

VAR_INT radar_blip_car1_hm3

VAR_INT timer_hm3

VAR_INT radar_blip_coord1_hm3

VAR_FLOAT carx_hm3

VAR_FLOAT cary_hm3

VAR_FLOAT carz_hm3

VAR_INT radar_blip_coord2_hm3

VAR_INT radar_blip_coord3_hm3

VAR_INT flag_player_had_repair_message_hm3

VAR_INT flag_player_had_car_message_hm3

VAR_INT flag_blip2_on

VAR_INT current_time_hm3

VAR_INT best_time_hm3

VAR_INT car_health_hm3

VAR_INT car_damage_hm3

VAR_INT flag_dont_check_stuff_hm3

VAR_INT flag_player_had_out_message_hm3

// ***************************************Mission Start*************************************

mission_start_hood3:

flag_player_on_mission = 1

flag_player_on_hood_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_player_had_repair_message_hm3 = 0

flag_player_had_car_message_hm3 = 0

flag_blip2_on = 0

blob_flag = 1

timer_hm3 = 361000  // 6 mins

car_health_hm3 = 1000

car_damage_hm3 = 0

flag_dont_check_stuff_hm3 = 0

flag_player_had_out_message_hm3 = 0

{

// ********************************************START OF CUTSCENE****************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_hood3_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( HM_3 ) 15000 2 //"RIGGED TO BLOW"

SWITCH_STREAMING OFF

//LOAD_SPECIAL_MODEL cut_obj1 PLAYERH			

WHILE GET_FADING_STATUS
				  
	WAIT 0

ENDWHILE
*/

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS -414.57 97.73 1.0 -589.29 -101.77 20.0

//LOAD_ALL_MODELS_NOW

//WHILE NOT HAS_MODEL_LOADED cut_obj1

//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE hd_ph3 
SET_CUTSCENE_OFFSET -444.714 -6.321 2.9

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player


DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( HM3_A ) 10000 1  //"Some effa..." 

WHILE cs_time < 4262
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM3_B ) 10000 1 //"If I lose those wheels..." 

WHILE cs_time < 7770
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM3_C ) 10000 1 //"Pick up my car..." 

WHILE cs_time < 11514
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM3_D ) 10000 1 //"Let them diffuse..." 

WHILE cs_time < 14528
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM3_E ) 10000 1 //"The clocks...." 

WHILE cs_time < 17707
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM3_F ) 10000 1 //"You hit one pot hole..." 

WHILE cs_time < 20250
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM3_G ) 10000 1 //"Now move it..."

WHILE cs_time < 20951
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( HM3_G ) 

WHILE cs_time < 21666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

//SWITCH_STREAMING ON

WAIT 500

DO_FADE 1500 FADE_IN

//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

SET_PED_DENSITY_MULTIPLIER 1.0


// *********************************************END OF CUTSCENE*****************************

CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_MAFIA THREAT_PLAYER1

CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1

CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_DIABLO THREAT_PLAYER1

CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_YAKUZA THREAT_PLAYER1

CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_YARDIE THREAT_PLAYER1

CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_COLOMBIAN THREAT_PLAYER1

CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_HOOD THREAT_PLAYER1

REQUEST_MODEL CAR_INFERNUS

WHILE NOT HAS_MODEL_LOADED CAR_INFERNUS
	
	WAIT 0

ENDWHILE

CREATE_CAR CAR_INFERNUS -682.0 76.0 -100.0 car_hm3

SET_CAR_HEADING car_hm3 0.0

SET_CAN_RESPRAY_CAR car_hm3 FALSE

ADD_BLIP_FOR_CAR car_hm3 radar_blip_car1_hm3

SET_TARGET_CAR_FOR_MISSION_GARAGE garage_hm3 car_hm3

DISPLAY_ONSCREEN_TIMER timer_hm3

IF IS_CAR_DEAD car_hm3
	PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
	GOTO mission_hood3_failed
ENDIF

// waiting for the player to get into the car

WHILE NOT IS_PLAYER_IN_CAR player car_hm3

	WAIT 0

	IF IS_CAR_DEAD car_hm3
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_hood3_failed
	ELSE

		IF IS_CAR_UPSIDEDOWN car_hm3
		AND IS_CAR_STOPPED car_hm3 
			PRINT_NOW ( UPSIDE ) 5000 1 //"You've flipped your wheels!"
			GOTO mission_hood3_failed
		ENDIF
		
	ENDIF

	IF timer_hm3 = 0
		car_damage_hm3 = 100
		EXPLODE_CAR car_hm3
	ENDIF
			
ENDWHILE

REMOVE_BLIP radar_blip_car1_hm3

PRINT_NOW ( HM3_1 ) 7000 1 //"Get to the garage but watch out if the car takes too much damage it will blow!

ADD_BLIP_FOR_COORD 1354.7 -312.9 48.9 radar_blip_coord1_hm3

DISPLAY_ONSCREEN_COUNTER_WITH_STRING car_damage_hm3 COUNTER_DISPLAY_BAR ( DETON ) 

// waiting for the player to reach the garage

WHILE NOT IS_CAR_IN_MISSION_GARAGE garage_hm3

	WAIT 0
	
	IF IS_CAR_DEAD car_hm3
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_hood3_failed
	ELSE

		GET_CAR_HEALTH car_hm3 car_health_hm3

		car_damage_hm3 = 1000 - car_health_hm3
		
		IF car_damage_hm3 > 100
			car_damage_hm3 = 100
		ENDIF


		IF IS_CAR_UPSIDEDOWN car_hm3
		AND IS_CAR_STOPPED car_hm3
			PRINT_NOW ( UPSIDE ) 5000 1 //"You've flipped your wheels!"
			GOTO mission_hood3_failed
		ENDIF

	ENDIF
	
	IF timer_hm3 = 0
		car_damage_hm3 = 100
		EXPLODE_CAR car_hm3
	ENDIF

	IF car_damage_hm3 = 100
		EXPLODE_CAR car_hm3
	ENDIF

	IF NOT IS_PLAYER_IN_CAR player car_hm3
	AND flag_player_had_car_message_hm3 = 0
		PRINT_NOW ( IN_VEH ) 7000 1 //" Get back in the car and get on with the mission!"
		REMOVE_BLIP radar_blip_coord1_hm3
		ADD_BLIP_FOR_CAR car_hm3 radar_blip_car1_hm3
		flag_player_had_car_message_hm3 = 1
	ENDIF

	IF IS_PLAYER_IN_CAR player car_hm3
	AND flag_player_had_car_message_hm3 = 1
		REMOVE_BLIP radar_blip_car1_hm3
		ADD_BLIP_FOR_COORD 1354.7 -312.9 48.9 radar_blip_coord1_hm3
		flag_player_had_car_message_hm3 = 0
	ENDIF
	
ENDWHILE

current_time_hm3 = 361000 - timer_hm3

current_time_hm3 = current_time_hm3 / 1000

REGISTER_DEFUSE_BOMB_TIME current_time_hm3

REMOVE_BLIP radar_blip_coord1_hm3

CLEAR_ONSCREEN_COUNTER car_damage_hm3

CLEAR_ONSCREEN_TIMER timer_hm3

PRINT_NOW ( HM3_2 ) 7000 1 //"Bring the car back and I want it mint - no damage!"

ADD_BLIP_FOR_COORD -682.0 76.0 -100.0 radar_blip_coord2_hm3

flag_blip2_on = 1

blob_flag = 1

WHILE NOT LOCATE_STOPPED_CAR_3D car_hm3 -682.0 76.0 17.4 3.0 4.0 4.0 blob_flag
OR IS_CAR_VISIBLY_DAMAGED car_hm3
OR IS_PLAYER_IN_CAR player car_hm3 	   
	
	WAIT 0
			   
	IF IS_CAR_DEAD car_hm3
		PRINT_NOW ( WRECKED ) 5000 1 //"The vehicle's wrecked!"
		GOTO mission_hood3_failed
	ELSE

		IF IS_CAR_UPSIDEDOWN car_hm3
		AND IS_CAR_STOPPED car_hm3
			PRINT_NOW ( UPSIDE ) 5000 1 //"You've flipped your wheels!"
			GOTO mission_hood3_failed
		ENDIF

	ENDIF

	IF LOCATE_STOPPED_CAR_3D car_hm3 -682.0 76.0 17.4 3.0 4.0 4.0 FALSE

		IF NOT IS_CAR_VISIBLY_DAMAGED car_hm3
			flag_dont_check_stuff_hm3 = 1
		ENDIF

		IF flag_player_had_out_message_hm3 = 0
			PRINT_NOW ( OUT_VEH ) 5000 1 //"Get out of the vehicle!"
			flag_player_had_out_message_hm3 = 1
		ENDIF

	ELSE
		flag_dont_check_stuff_hm3 = 0
		flag_player_had_out_message_hm3 = 0
	ENDIF
	
	IF flag_dont_check_stuff_hm3 = 0 	
	
		IF IS_PLAYER_IN_CAR player car_hm3
				
			IF flag_player_had_car_message_hm3 = 1
				REMOVE_BLIP radar_blip_car1_hm3
				flag_player_had_car_message_hm3 = 0
			ENDIF

			IF IS_CAR_VISIBLY_DAMAGED car_hm3

				IF flag_player_had_repair_message_hm3 = 0
					PRINT_NOW ( HM3_3 ) 7000 1 //"Get the car repaired I want it mint!"
					REMOVE_BLIP radar_blip_coord2_hm3
					ADD_SPRITE_BLIP_FOR_COORD 925.0 -359.5 -100.0 RADAR_SPRITE_SPRAY radar_blip_coord3_hm3
					flag_blip2_on = 0
					flag_player_had_repair_message_hm3 = 1

					DISPLAY_RADAR 6 // PATHING PAY N SPRAY
				ENDIF

				blob_flag = 0
										    
			ELSE
			
				IF flag_blip2_on = 0
					REMOVE_BLIP radar_blip_coord3_hm3
					DISPLAY_RADAR 3 // PATHING ON // reset

					ADD_BLIP_FOR_COORD -682.0 76.0 -100.0 radar_blip_coord2_hm3
					PRINT_NOW ( HM3_2 ) 7000 1 //"Bring the car back and I want it mint - no damage!"
					flag_blip2_on = 1
				ENDIF

				blob_flag = 1
						
				flag_player_had_repair_message_hm3 = 0
													
			ENDIF
			
		ELSE
	
			IF flag_player_had_car_message_hm3 = 0
				PRINT_NOW ( IN_VEH ) 7000 1 //" Get back in the car and get on with the mission!"
				REMOVE_BLIP radar_blip_coord2_hm3
				flag_blip2_on = 0
				ADD_BLIP_FOR_CAR car_hm3 radar_blip_car1_hm3
				flag_player_had_car_message_hm3 = 1
			ENDIF
			blob_flag = 0
			flag_player_had_repair_message_hm3 = 0		

		ENDIF

	ENDIF

ENDWHILE

DISPLAY_RADAR 3 // PATHING ON // reset

IF NOT IS_CAR_DEAD car_hm3
	CHANGE_CAR_LOCK car_hm3 CARLOCK_LOCKED
ENDIF

REMOVE_BLIP radar_blip_coord2_hm3


}	
		    
GOTO mission_hood3_passed

 

// Mission hood3 failed

mission_hood3_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

IF HAS_PLAYER_BEEN_ARRESTED player
	OVERRIDE_POLICE_STATION_LEVEL LEVEL_SUBURBAN 
ENDIF

IF IS_PLAYER_DEAD player
	OVERRIDE_HOSPITAL_LEVEL LEVEL_SUBURBAN
ENDIF

RETURN


   

// mission hood3 passed

mission_hood3_passed:

IF flag_hood_mission3_passed = 0
	REGISTER_MISSION_PASSED ( HM_3 )
	PLAYER_MADE_PROGRESS 1
	PRINT_WITH_NUMBER_BIG ( M_PASS ) 20000 5000 1 //Mission Passed!"
	PLAY_MISSION_PASSED_TUNE 1
	ADD_SCORE player 20000
	CLEAR_WANTED_LEVEL player
	START_NEW_SCRIPT hood_mission4_loop
	flag_hood_mission3_passed = 1

ELSE
	ADD_SCORE player 20000
	PRINT_WITH_NUMBER_BIG ( M_PASS ) 20000 5000 1 //Mission Passed!"
	PLAY_MISSION_PASSED_TUNE 1
	CLEAR_WANTED_LEVEL player
ENDIF

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		


// mission cleanup

mission_cleanup_hood3:

DISPLAY_RADAR 3 // PATHING ON

flag_player_on_mission = 0
flag_player_on_hood_mission = 0
SET_TARGET_CAR_FOR_MISSION_GARAGE garage_hm3 -1
CLEAR_ONSCREEN_TIMER timer_hm3
CLEAR_ONSCREEN_COUNTER car_damage_hm3
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_INFERNUS
REMOVE_BLIP radar_blip_car1_hm3
REMOVE_BLIP radar_blip_coord1_hm3
REMOVE_BLIP radar_blip_coord2_hm3
SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_MAFIA THREAT_PLAYER1
SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_TRIAD THREAT_PLAYER1
SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_COLOMBIAN THREAT_PLAYER1

IF flag_yardie_mission2_passed = 1
	SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_DIABLO THREAT_PLAYER1
ENDIF

IF flag_yardie_mission4_passed = 1
	SET_THREAT_FOR_PED_TYPE PEDTYPE_GANG_YARDIE THREAT_PLAYER1
ENDIF	 

MISSION_HAS_FINISHED
RETURN
		

  
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************
// *************************************Hood Mission 4****************************************
// ****************************************The Race*******************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME hood4

// Mission start stuff

GOSUB mission_start_hood4

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_hood4_failed
	ENDIF

GOSUB mission_cleanup_hood4

MISSION_END


// Variables for mission

VAR_INT total_no_pills_carried_hm4  //Total no of pills eaten since race started

VAR_INT radar_blip_coord1_hm4

VAR_INT no_of_pills_carried_hm4  //no of pills player is carrying

VAR_INT flag_player_in_area_hm4

VAR_INT timer_hm4

VAR_INT car_hm4

VAR_INT radar_blip_car1_hm4

VAR_INT flag_player_had_car_message_hm4

VAR_INT flag_blip_added_hm4

VAR_INT radar_blip_coord2_hm4

	
// ***************************************Mission Start*************************************


mission_start_hood4:

flag_player_on_mission = 1

flag_player_on_hood_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

total_no_pills_carried_hm4 = 0

flag_player_in_area_hm4 = 0

timer_hm4 = 361000 // 6 mins

flag_player_had_car_message_hm4 = 0

flag_blip_added_hm4 = 0

{

// *******************************************START OF CUTSCENE*****************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_hood4_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( HM_4 ) 15000 2 //"GOLD GRAB"	

SWITCH_STREAMING OFF

//LOAD_SPECIAL_MODEL cut_obj1 PLAYERH			

WHILE GET_FADING_STATUS
				  
	WAIT 0

ENDWHILE
*/

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS -414.57 97.73 1.0 -589.29 -101.77 20.0

//LOAD_ALL_MODELS_NOW

//WHILE NOT HAS_MODEL_LOADED cut_obj1

//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE hd_ph4 
SET_CUTSCENE_OFFSET -444.714 -6.321 2.9
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player


DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2096
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( HM4_A ) 10000 1 //"Yo a Federal..." 

WHILE cs_time < 5840
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM4_B ) 10000 1 //"There's platinum all..." 

WHILE cs_time < 8171
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM4_C ) 10000 1  //"Get a car..." 

WHILE cs_time < 11161
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM4_F ) 10000 1 //"You can drop..." 

WHILE cs_time < 13963
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM4_G ) 10000 1 //"This platinum..." 

WHILE cs_time < 17683
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM4_H ) 10000 1 //"So make regular drop..."

WHILE cs_time < 19787
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( HM4_H ) 

WHILE cs_time < 20433
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

//SWITCH_STREAMING ON

WAIT 500

DO_FADE 1500 FADE_IN

//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

SET_PED_DENSITY_MULTIPLIER 1.0

// *********************************************END OF CUTSCENE*****************************

PRINT_NOW ( HM4_D ) 5000 1 //"Get a vehicle!"

WHILE NOT IS_PLAYER_IN_ANY_CAR player

	WAIT 0
	
ENDWHILE

STORE_CAR_PLAYER_IS_IN player car_hm4

SET_TARGET_CAR_FOR_MISSION_GARAGE garage_hm4 car_hm4

//REMOVE_BLIP radar_blip_car1_hm4

ADD_BLIP_FOR_COORD -1080.0 -163.2 -100.0 radar_blip_coord2_hm4

PRINT_NOW ( HM4_1 ) 7000 1 //"Head to the location where the cargo is scattered!"

START_PACMAN_SCRAMBLE -1080.0 -163.2 -100.0 100.0 90  // 90 tokens are created

DISPLAY_ONSCREEN_TIMER timer_hm4

DISPLAY_ONSCREEN_COUNTER_WITH_STRING total_no_pills_carried_hm4 COUNTER_DISPLAY_NUMBER collect 

// waiting for the player to get the correct number of pills

WHILE NOT total_no_pills_carried_hm4 >= 30

	WAIT 0
	
	GET_NUMBER_OF_POWER_PILLS_CARRIED no_of_pills_carried_hm4

	IF IS_PLAYER_IN_AREA_3D player -824.7 -165.5 32.8 -843.5 -171.7 37.0 FALSE
		CLEAR_WANTED_LEVEL player
	ENDIF

// Checks to see if any pills are carried and switches off airport blip and puts on the drop off blip

	IF no_of_pills_carried_hm4 > 0

		IF flag_blip_added_hm4 = 0
			REMOVE_BLIP radar_blip_coord2_hm4
			ADD_BLIP_FOR_COORD -844.9 -169.6 32.8 radar_blip_coord1_hm4  // Coords for where the gold is to be dropped off
			PRINT_NOW ( HM4_2 ) 7000 1 //"Remember when the vehicle becomes too heavy and slow goto the garage and drop off the cargo."
			flag_blip_added_hm4 = 1
		ENDIF

	ENDIF	
     	
// Checks and removes the no of pills that the player has collected	 
	
		IF IS_PLAYER_IN_ANY_CAR player

			STORE_CAR_PLAYER_IS_IN player car_hm4
			SET_TARGET_CAR_FOR_MISSION_GARAGE garage_hm4 car_hm4

		    IF IS_PLAYER_STOPPED_IN_AREA_IN_CAR_3D player -824.7 -165.5 32.8 -843.5 -171.7 37.0 FALSE
			AND flag_player_in_area_hm4 = 0
				total_no_pills_carried_hm4 += no_of_pills_carried_hm4
				ADD_ONE_OFF_SOUND -834.9 -168.8 33.9 SOUND_UNLOAD_GOLD
				CLEAR_NUMBER_OF_POWER_PILLS_CARRIED
				flag_player_in_area_hm4 = 1
			ENDIF
	
			IF IS_PLAYER_IN_CAR player car_hm4
			AND NOT IS_PLAYER_STOPPED_IN_AREA_IN_CAR_3D player -824.7 -165.5 32.8 -843.5 -171.7 37.0 FALSE
			AND flag_player_in_area_hm4 = 1
				flag_player_in_area_hm4 = 0
			ENDIF

		ENDIF

// Checks for the player getting in and out of the car

		IF NOT IS_PLAYER_IN_ANY_CAR player

			SET_TARGET_CAR_FOR_MISSION_GARAGE garage_hm4 -1
			
			IF flag_player_had_car_message_hm4 = 0
				PRINT_NOW ( IN_VEH2 ) 5000 1 //"Get into the vehicle!"
				IF flag_blip_added_hm4 = 1
					REMOVE_BLIP radar_blip_coord1_hm4
				ENDIF
				flag_player_had_car_message_hm4 = 1
			ENDIF
			
		ELSE

			STORE_CAR_PLAYER_IS_IN player car_hm4
			SET_TARGET_CAR_FOR_MISSION_GARAGE garage_hm4 car_hm4
			
			IF flag_player_had_car_message_hm4 = 1
				IF flag_blip_added_hm4 = 1
					ADD_BLIP_FOR_COORD -844.9 -169.6 32.8 radar_blip_coord1_hm4
				ENDIF
				flag_player_had_car_message_hm4 = 0
			ENDIF
			
		ENDIF 
	
	IF timer_hm4 = 0
		PRINT_NOW ( OUTTIME ) 5000 1 //"Your out of time!"
		GOTO mission_hood4_failed
	ENDIF  
			
ENDWHILE

REMOVE_BLIP radar_blip_coord1_hm4

}  

GOTO mission_hood4_passed

 

// Mission hood4 failed

mission_hood4_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

SET_TARGET_CAR_FOR_MISSION_GARAGE garage_hm4 -1

IF HAS_PLAYER_BEEN_ARRESTED player
	OVERRIDE_POLICE_STATION_LEVEL LEVEL_SUBURBAN 
ENDIF

IF IS_PLAYER_DEAD player
	OVERRIDE_HOSPITAL_LEVEL LEVEL_SUBURBAN
ENDIF

RETURN


   

// mission hood4 passed

mission_hood4_passed:

flag_hood_mission4_passed = 1
REGISTER_MISSION_PASSED ( HM_4 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 25000 5000 1 //Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 25000
CLEAR_WANTED_LEVEL player
START_NEW_SCRIPT hood_mission5_loop

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		


// mission cleanup

mission_cleanup_hood4:

flag_player_on_mission = 0
flag_player_on_hood_mission = 0
SET_TARGET_CAR_FOR_MISSION_GARAGE garage_hm4 -1
CLEAR_NUMBER_OF_POWER_PILLS_CARRIED
CLEAR_PACMAN
REMOVE_BLIP radar_blip_coord1_hm4
REMOVE_BLIP radar_blip_coord2_hm4
CLEAR_ONSCREEN_TIMER timer_hm4
CLEAR_ONSCREEN_COUNTER total_no_pills_carried_hm4 // TEST STUFF
MISSION_HAS_FINISHED
RETURN
		

  
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************
// *************************************Hood Mission 5****************************************
// ***********************************Baseball Bat Fight**************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

SCRIPT_NAME hood5

// Mission start stuff

GOSUB mission_start_hood5

	IF HAS_DEATHARREST_BEEN_EXECUTED
		GOSUB mission_hood5_failed
	ENDIF

GOSUB mission_cleanup_hood5

MISSION_END


// Variables for mission

VAR_INT baddie1_hm5

VAR_INT baddie2_hm5

VAR_INT baddie3_hm5

VAR_INT baddie4_hm5

VAR_INT baddie5_hm5

VAR_INT baddie6_hm5

VAR_INT baddie7_hm5

VAR_INT baddie8_hm5

VAR_INT baddie9_hm5

VAR_INT radar_blip_ped1_hm5  // Radar blip for baddie 1

VAR_INT radar_blip_ped2_hm5  // Radar blip for baddie 2

VAR_INT radar_blip_ped3_hm5  // Radar blip for baddie 3

VAR_INT radar_blip_ped4_hm5  // Radar blip for baddie 4

VAR_INT radar_blip_ped5_hm5  // Radar blip for baddie 5

VAR_INT radar_blip_ped6_hm5  // Radar blip for baddie 6

VAR_INT radar_blip_ped7_hm5  // Radar blip for baddie 7

VAR_INT radar_blip_ped8_hm5  // Radar blip for baddie 8

VAR_INT radar_blip_ped9_hm5  // Radar blip for baddie 9

VAR_INT flag_baddie1_dead_hm5

VAR_INT flag_baddie2_dead_hm5

VAR_INT flag_baddie3_dead_hm5

VAR_INT flag_baddie4_dead_hm5

VAR_INT flag_baddie5_dead_hm5

VAR_INT flag_baddie6_dead_hm5

VAR_INT flag_baddie7_dead_hm5

VAR_INT flag_baddie8_dead_hm5

VAR_INT flag_baddie9_dead_hm5

VAR_INT counter_no_of_baddies_dead_hm5

VAR_INT radar_blip_goodie_hm5

VAR_INT goodie_hm5

VAR_INT bat_hm5

VAR_INT flag_players_buddy_normal

VAR_INT flag_goodie_hm5_dead_hm5

VAR_INT car_hm5

VAR_INT flag_goodie_message_hm5

VAR_INT flag_bat_created_hm5

VAR_INT flag_bat_collected_hm5

VAR_INT flag_player_in_area_hm5

VAR_INT flag_baddie1_mad_hm5

VAR_INT flag_baddie2_mad_hm5

VAR_INT flag_baddie3_mad_hm5

VAR_INT flag_baddie4_mad_hm5

VAR_INT flag_baddie5_mad_hm5

VAR_INT flag_baddie6_mad_hm5

VAR_INT flag_baddie7_mad_hm5

VAR_INT flag_baddie8_mad_hm5

VAR_INT flag_baddie9_mad_hm5

	
// ***************************************Mission Start*************************************


mission_start_hood5:

flag_player_on_mission = 1

flag_player_on_hood_mission = 1

REGISTER_MISSION_GIVEN

WAIT 0

flag_baddie1_dead_hm5 = 0

flag_baddie2_dead_hm5 = 0

flag_baddie3_dead_hm5 = 0

flag_baddie4_dead_hm5 = 0

flag_baddie5_dead_hm5 = 0

flag_baddie6_dead_hm5 = 0

flag_baddie7_dead_hm5 = 0

flag_baddie8_dead_hm5 = 0

flag_baddie9_dead_hm5 = 0

counter_no_of_baddies_dead_hm5 = 0

flag_players_buddy_normal = 0

flag_goodie_hm5_dead_hm5 = 0

flag_goodie_message_hm5 = 0

flag_bat_created_hm5 = 0

flag_bat_collected_hm5 = 0

flag_player_in_area_hm5 = 0

flag_baddie1_mad_hm5 = 0

flag_baddie2_mad_hm5 = 0

flag_baddie3_mad_hm5 = 0

flag_baddie4_mad_hm5 = 0

flag_baddie5_mad_hm5 = 0

flag_baddie6_mad_hm5 = 0

flag_baddie7_mad_hm5 = 0

flag_baddie8_mad_hm5 = 0

flag_baddie9_mad_hm5 = 0

{

// ****************************************START OF CUTSCENE********************************

/*
IF CAN_PLAYER_START_MISSION Player
	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player
ELSE
	GOTO mission_hood5_failed
ENDIF

SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

PRINT_BIG ( HM_5 ) 15000 2 //"RUMBLE BLUES"

SWITCH_STREAMING OFF

//LOAD_SPECIAL_MODEL cut_obj1 PLAYERH			

WHILE GET_FADING_STATUS
					  
	WAIT 0

ENDWHILE
*/

SET_PED_DENSITY_MULTIPLIER 0.0

CLEAR_AREA_OF_CHARS -414.57 97.73 1.0 -589.29 -101.77 20.0

//LOAD_ALL_MODELS_NOW

//WHILE NOT HAS_MODEL_LOADED cut_obj1

//	WAIT 0

//ENDWHILE

LOAD_CUTSCENE hd_ph5 
SET_CUTSCENE_OFFSET -444.714 -6.321 2.9
					
CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ1 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player


DO_FADE 1500 FADE_IN

SWITCH_STREAMING ON

START_CUTSCENE

// Displays cutscene text


GET_CUTSCENE_TIME cs_time

WHILE cs_time < 2190
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE
PRINT_NOW ( HM5_A ) 10000 1  //"Them Nines..." 

WHILE cs_time < 4403
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM5_B ) 10000 1  //"But they still..." 

WHILE cs_time < 6287
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM5_C ) 10000 1  //"They agreed to..." 

WHILE cs_time < 7888
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM5_D ) 10000 1 //"A gang of them..." 

WHILE cs_time < 9678
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM5_E ) 10000 1 //"Two of yaw" 

WHILE cs_time < 11491
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM5_F ) 10000 1  //"I'd join you..." 

WHILE cs_time < 12974
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM5_G ) 10000 1  //"I ain't due my..."

WHILE cs_time < 14952
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM5_H ) 10000 1 //"Y'kmow what..."

WHILE cs_time < 16068
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM5_I ) 10000 1 //"Go and meet..."

WHILE cs_time < 17531
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( HM5_J ) 10000 1 //"He'll show..."

WHILE cs_time < 19234
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_THIS_PRINT ( HM5_J )

WHILE cs_time < 20166
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

DO_FADE 1500 FADE_OUT

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

CLEAR_PRINTS

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CLEAR_CUTSCENE

//SWITCH_STREAMING ON

WAIT 500

DO_FADE 1500 FADE_IN

//MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1

SET_PED_DENSITY_MULTIPLIER 1.0

// *****************************************END OF CUTSCENE**********************************


REQUEST_MODEL PED_GANG_HOOD_A

REQUEST_MODEL PED_GANG_HOOD_B

WHILE NOT HAS_MODEL_LOADED PED_GANG_HOOD_A
OR NOT HAS_MODEL_LOADED PED_GANG_HOOD_B
	
	WAIT 0

ENDWHILE

SWITCH_ROADS_OFF -414.997 77.799 2.5 -267.467 103.23 10.0

SWITCH_ROADS_OFF -286.387 77.799 2.5 -215.814 272.287 10.0

CREATE_PICKUP WEAPON_BAT pickup_once -637.0 -28.5 -100.0 bat_hm5

flag_bat_created_hm5 = 1

// Creates players helper ped

CREATE_CHAR PEDTYPE_CIVMALE PED_GANG_HOOD_A -640.9 -28.8 18.8 goodie_hm5

SET_CHAR_HEADING goodie_hm5 180.0

GIVE_WEAPON_TO_CHAR goodie_hm5 WEAPONTYPE_BASEBALLBAT 1

ADD_BLIP_FOR_CHAR goodie_hm5 radar_blip_goodie_hm5

CLEAR_CHAR_THREAT_SEARCH goodie_hm5

WHILE NOT LOCATE_PLAYER_ANY_MEANS_CHAR_2D player goodie_hm5 8.0 8.0 FALSE

	WAIT 0

	IF IS_CHAR_DEAD goodie_hm5
		PRINT_NOW ( HM5_4 ) 5000 1 //"Your contact is dead!"
		GOTO mission_hood5_failed
		flag_goodie_hm5_dead_hm5 = 1	
	ENDIF

	IF flag_bat_created_hm5 = 1

		IF flag_bat_collected_hm5 = 0
		
			IF HAS_PICKUP_BEEN_COLLECTED bat_hm5
				flag_bat_collected_hm5 = 1
			ENDIF

		ENDIF

	ENDIF
	
ENDWHILE

TURN_CHAR_TO_FACE_PLAYER goodie_hm5 player
SET_PLAYER_AS_LEADER goodie_hm5 player
REMOVE_BLIP radar_blip_goodie_hm5

LOAD_MISSION_AUDIO H5_A

WHILE NOT HAS_MISSION_AUDIO_LOADED
	
	WAIT 0

	IF IS_CHAR_DEAD goodie_hm5
		PRINT_NOW ( HM5_4 ) 5000 1 //"Your contact is dead!"
		GOTO mission_hood5_failed
		flag_goodie_hm5_dead_hm5 = 1	
	ENDIF 
		
	IF NOT IS_CHAR_IN_PLAYERS_GROUP goodie_hm5 player
	AND flag_goodie_message_hm5 = 0
		PRINT_NOW ( HEY9 ) 5000 1 //"You have not got the information from the contact go back and get it."
		ADD_BLIP_FOR_CHAR goodie_hm5 radar_blip_goodie_hm5
		flag_goodie_message_hm5 = 1
	ENDIF
	
	IF LOCATE_PLAYER_ANY_MEANS_CHAR_2D player goodie_hm5 8.0 8.0 FALSE
	AND flag_goodie_message_hm5 = 1
		SET_PLAYER_AS_LEADER goodie_hm5 player
		REMOVE_BLIP radar_blip_goodie_hm5
		flag_goodie_message_hm5 = 0
	ENDIF

	IF flag_bat_created_hm5 = 1

		IF flag_bat_collected_hm5 = 0
		
			IF HAS_PICKUP_BEEN_COLLECTED bat_hm5
				flag_bat_collected_hm5 = 1
			ENDIF

		ENDIF

	ENDIF

ENDWHILE

REMOVE_BLIP radar_blip_goodie_hm5

PLAY_MISSION_AUDIO

PRINT_NOW ( HM5_1 ) 7000 1 //"Yo, Ice setyou was comin'. There are rules, bats only, no guns, no cars

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CHAR_DEAD goodie_hm5
		PRINT_NOW ( HM5_4 ) 5000 1 //"Your contact is dead!"
		GOTO mission_hood5_failed
		flag_goodie_hm5_dead_hm5 = 1	
	ENDIF

	IF flag_bat_created_hm5 = 1

		IF flag_bat_collected_hm5 = 0
		
			IF HAS_PICKUP_BEEN_COLLECTED bat_hm5
				flag_bat_collected_hm5 = 1
			ENDIF

		ENDIF

	ENDIF

ENDWHILE

CLEAR_THIS_PRINT ( HM5_1 )

LOAD_MISSION_AUDIO H5_B

WHILE NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0

	IF IS_CHAR_DEAD goodie_hm5
		PRINT_NOW ( HM5_4 ) 5000 1 //"Your contact is dead!"
		GOTO mission_hood5_failed
		flag_goodie_hm5_dead_hm5 = 1	
	ENDIF

	IF flag_bat_created_hm5 = 1

		IF flag_bat_collected_hm5 = 0
		
			IF HAS_PICKUP_BEEN_COLLECTED bat_hm5
				flag_bat_collected_hm5 = 1
			ENDIF

		ENDIF

	ENDIF

ENDWHILE

PLAY_MISSION_AUDIO

PRINT ( HM5_5 ) 7000 1 //"This is a battle for respect, you cool?"  //Change to print now when audio is there

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CHAR_DEAD goodie_hm5
		PRINT_NOW ( HM5_4 ) 5000 1 //"Your contact is dead!"
		GOTO mission_hood5_failed
		flag_goodie_hm5_dead_hm5 = 1	
	ENDIF

	IF flag_bat_created_hm5 = 1

		IF flag_bat_collected_hm5 = 0
		
			IF HAS_PICKUP_BEEN_COLLECTED bat_hm5
				flag_bat_collected_hm5 = 1
			ENDIF

		ENDIF

	ENDIF

ENDWHILE

CLEAR_THIS_PRINT ( HM5_5 )

LOAD_MISSION_AUDIO H5_C

WHILE NOT HAS_MISSION_AUDIO_LOADED

	WAIT 0

	IF IS_CHAR_DEAD goodie_hm5
		PRINT_NOW ( HM5_4 ) 5000 1 //"Your contact is dead!"
		GOTO mission_hood5_failed
		flag_goodie_hm5_dead_hm5 = 1	
	ENDIF

	IF flag_bat_created_hm5 = 1

		IF flag_bat_collected_hm5 = 0
		
			IF HAS_PICKUP_BEEN_COLLECTED bat_hm5
				flag_bat_collected_hm5 = 1
			ENDIF

		ENDIF

	ENDIF

ENDWHILE

PLAY_MISSION_AUDIO

PRINT ( HM5_6 ) 7000 1 //"Lets go crack some blue skulls ( should be purple )"  //Change to print now when audio is there

WHILE NOT HAS_MISSION_AUDIO_FINISHED

	WAIT 0

	IF IS_CHAR_DEAD goodie_hm5
		PRINT_NOW ( HM5_4 ) 5000 1 //"Your contact is dead!"
		GOTO mission_hood5_failed
		flag_goodie_hm5_dead_hm5 = 1	
	ENDIF

	IF flag_bat_created_hm5 = 1

		IF flag_bat_collected_hm5 = 0
		
			IF HAS_PICKUP_BEEN_COLLECTED bat_hm5
				flag_bat_collected_hm5 = 1
			ENDIF

		ENDIF

	ENDIF

ENDWHILE

CLEAR_THIS_PRINT ( HM5_6 )

// Creates baddie1

CREATE_CHAR PEDTYPE_GANG_HOOD PED_GANG_HOOD_B -237.0 315.5 -100.0 baddie1_hm5

SET_CHAR_HEALTH baddie1_hm5 250

SET_CHAR_PERSONALITY baddie1_hm5 PEDSTAT_TOUGH_GUY

SET_CHAR_THREAT_SEARCH baddie1_hm5 THREAT_PLAYER1

GIVE_WEAPON_TO_CHAR baddie1_hm5 WEAPONTYPE_BASEBALLBAT 1

ADD_BLIP_FOR_CHAR baddie1_hm5 radar_blip_ped1_hm5

SET_CHAR_HEED_THREATS baddie1_hm5 TRUE

TURN_CHAR_TO_FACE_COORD baddie1_hm5 -232.0 253.0 -100.0

SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie1_hm5 TRUE

// Creates baddie2

CREATE_CHAR PEDTYPE_GANG_HOOD PED_GANG_HOOD_B -234.1 315.5 -100.0 baddie2_hm5

SET_CHAR_HEALTH baddie2_hm5 250

SET_CHAR_PERSONALITY baddie2_hm5 PEDSTAT_TOUGH_GUY

SET_CHAR_THREAT_SEARCH baddie2_hm5 THREAT_PLAYER1

GIVE_WEAPON_TO_CHAR baddie2_hm5 WEAPONTYPE_BASEBALLBAT 1

ADD_BLIP_FOR_CHAR baddie2_hm5 radar_blip_ped2_hm5

SET_CHAR_HEED_THREATS baddie2_hm5 TRUE

TURN_CHAR_TO_FACE_COORD baddie2_hm5 -232.0 253.0 -100.0

SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie2_hm5 TRUE

// Creates baddie3

CREATE_CHAR PEDTYPE_GANG_HOOD PED_GANG_HOOD_B -229.3 315.5 -100.0 baddie3_hm5

SET_CHAR_HEALTH baddie3_hm5 250

SET_CHAR_PERSONALITY baddie3_hm5 PEDSTAT_TOUGH_GUY

SET_CHAR_THREAT_SEARCH baddie3_hm5 THREAT_PLAYER1

GIVE_WEAPON_TO_CHAR baddie3_hm5 WEAPONTYPE_BASEBALLBAT 1

ADD_BLIP_FOR_CHAR baddie3_hm5 radar_blip_ped3_hm5

SET_CHAR_HEED_THREATS baddie3_hm5 TRUE

TURN_CHAR_TO_FACE_COORD baddie3_hm5 -232.0 253.0 -100.0

SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie3_hm5 TRUE

// Creates baddie4

CREATE_CHAR PEDTYPE_GANG_HOOD PED_GANG_HOOD_B -222.5 298.4 -100.0 baddie4_hm5  //281.5

SET_CHAR_HEALTH baddie4_hm5 250

SET_CHAR_PERSONALITY baddie4_hm5 PEDSTAT_TOUGH_GUY

SET_CHAR_THREAT_SEARCH baddie4_hm5 THREAT_PLAYER1

GIVE_WEAPON_TO_CHAR baddie4_hm5 WEAPONTYPE_BASEBALLBAT 1

ADD_BLIP_FOR_CHAR baddie4_hm5 radar_blip_ped4_hm5

SET_CHAR_HEED_THREATS baddie4_hm5 TRUE

TURN_CHAR_TO_FACE_COORD baddie4_hm5 -226.1 280.8 -100.0

SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie4_hm5 TRUE

// Creates baddie5

CREATE_CHAR PEDTYPE_GANG_HOOD PED_GANG_HOOD_B -222.5 287.6 -100.0 baddie5_hm5

SET_CHAR_HEALTH baddie5_hm5 250

SET_CHAR_PERSONALITY baddie5_hm5 PEDSTAT_TOUGH_GUY

SET_CHAR_THREAT_SEARCH baddie5_hm5 THREAT_PLAYER1

GIVE_WEAPON_TO_CHAR baddie5_hm5 WEAPONTYPE_BASEBALLBAT 1

ADD_BLIP_FOR_CHAR baddie5_hm5 radar_blip_ped5_hm5

SET_CHAR_HEED_THREATS baddie5_hm5 TRUE

TURN_CHAR_TO_FACE_COORD baddie5_hm5 -226.1 280.8 -100.0

SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie5_hm5 TRUE

// Creates baddie6

CREATE_CHAR PEDTYPE_GANG_HOOD PED_GANG_HOOD_B -222.5 275.9 -100.0 baddie6_hm5

SET_CHAR_HEALTH baddie6_hm5 250

SET_CHAR_PERSONALITY baddie6_hm5 PEDSTAT_TOUGH_GUY

SET_CHAR_THREAT_SEARCH baddie6_hm5 THREAT_PLAYER1

GIVE_WEAPON_TO_CHAR baddie6_hm5 WEAPONTYPE_BASEBALLBAT 1

ADD_BLIP_FOR_CHAR baddie6_hm5 radar_blip_ped6_hm5

SET_CHAR_HEED_THREATS baddie6_hm5 TRUE

TURN_CHAR_TO_FACE_COORD baddie6_hm5 -226.1 280.8 -100.0

SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie6_hm5 TRUE

// Creates baddie7

CREATE_CHAR PEDTYPE_GANG_HOOD PED_GANG_HOOD_B -239.8 287.6 -100.0 baddie7_hm5

SET_CHAR_HEALTH baddie7_hm5 250

SET_CHAR_PERSONALITY baddie7_hm5 PEDSTAT_TOUGH_GUY

SET_CHAR_THREAT_SEARCH baddie7_hm5 THREAT_PLAYER1

GIVE_WEAPON_TO_CHAR baddie7_hm5 WEAPONTYPE_BASEBALLBAT 1

ADD_BLIP_FOR_CHAR baddie7_hm5 radar_blip_ped7_hm5

SET_CHAR_HEED_THREATS baddie7_hm5 TRUE

TURN_CHAR_TO_FACE_COORD baddie7_hm5 -226.1 280.8 -100.0

SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie7_hm5 TRUE

// Creates baddie8

CREATE_CHAR PEDTYPE_GANG_HOOD PED_GANG_HOOD_B -239.8 298.4 -100.0 baddie8_hm5

SET_CHAR_HEALTH baddie8_hm5 250

SET_CHAR_PERSONALITY baddie8_hm5 PEDSTAT_TOUGH_GUY

SET_CHAR_THREAT_SEARCH baddie8_hm5 THREAT_PLAYER1

GIVE_WEAPON_TO_CHAR baddie8_hm5 WEAPONTYPE_BASEBALLBAT 1

ADD_BLIP_FOR_CHAR baddie8_hm5 radar_blip_ped8_hm5

SET_CHAR_HEED_THREATS baddie8_hm5 TRUE

TURN_CHAR_TO_FACE_COORD baddie8_hm5 -226.1 280.8 -100.0

SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie8_hm5 TRUE

// Creates baddie9

CREATE_CHAR PEDTYPE_GANG_HOOD PED_GANG_HOOD_B -239.8 275.9 -100.0 baddie9_hm5

SET_CHAR_HEALTH baddie9_hm5 250

SET_CHAR_PERSONALITY baddie9_hm5 PEDSTAT_TOUGH_GUY

SET_CHAR_THREAT_SEARCH baddie9_hm5 THREAT_PLAYER1

GIVE_WEAPON_TO_CHAR baddie9_hm5 WEAPONTYPE_BASEBALLBAT 1

ADD_BLIP_FOR_CHAR baddie9_hm5 radar_blip_ped9_hm5

SET_CHAR_HEED_THREATS baddie9_hm5 TRUE

TURN_CHAR_TO_FACE_COORD baddie9_hm5 -226.1 280.8 -100.0

SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie9_hm5 TRUE

// waiting for all the guys to be dead

WHILE NOT counter_no_of_baddies_dead_hm5 = 9

	WAIT 0

	IF IS_CHAR_DEAD goodie_hm5
		flag_goodie_hm5_dead_hm5 = 1
	ENDIF

IF IS_PLAYER_IN_AREA_3D player -247.3 333.9 2.0 -209.5 250.2 15.0 FALSE

	flag_player_in_area_hm5 = 1
   
	IF flag_goodie_hm5_dead_hm5 = 0
	
		IF NOT IS_CHAR_IN_ANY_CAR goodie_hm5  

 			IF flag_players_buddy_normal = 0
				LEAVE_GROUP goodie_hm5
				SET_CHAR_THREAT_SEARCH goodie_hm5 THREAT_GANG_HOOD
				SET_CHAR_PERSONALITY goodie_hm5 PEDSTAT_TOUGH_GUY
				flag_players_buddy_normal = 1
			ENDIF

		ENDIF

	ENDIF
	
ENDIF

IF flag_player_in_area_hm5 = 1

	IF flag_baddie1_mad_hm5 = 0

		IF NOT IS_CHAR_DEAD baddie1_hm5
			TURN_CHAR_TO_FACE_PLAYER baddie1_hm5 player
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT baddie1_hm5 player
			flag_baddie1_mad_hm5 = 1
		ENDIF

	ENDIF

	IF flag_baddie2_mad_hm5 = 0

		IF NOT IS_CHAR_DEAD baddie2_hm5
			TURN_CHAR_TO_FACE_PLAYER baddie2_hm5 player
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT baddie2_hm5 player
			flag_baddie2_mad_hm5 = 1
		ENDIF

	ENDIF

	IF flag_baddie3_mad_hm5 = 0

		IF NOT IS_CHAR_DEAD baddie3_hm5
			TURN_CHAR_TO_FACE_PLAYER baddie3_hm5 player
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT baddie3_hm5 player
			flag_baddie3_mad_hm5 = 1
		ENDIF

	ENDIF

	IF flag_baddie4_mad_hm5 = 0

		IF NOT IS_CHAR_DEAD baddie4_hm5
			TURN_CHAR_TO_FACE_PLAYER baddie4_hm5 player
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT baddie4_hm5 player
			flag_baddie4_mad_hm5 = 1
		ENDIF

	ENDIF

	IF flag_baddie5_mad_hm5 = 0

		IF NOT IS_CHAR_DEAD baddie5_hm5
			TURN_CHAR_TO_FACE_PLAYER baddie5_hm5 player
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT baddie5_hm5 player
			flag_baddie5_mad_hm5 = 1
		ENDIF

	ENDIF

	IF flag_baddie6_mad_hm5 = 0

		IF NOT IS_CHAR_DEAD baddie6_hm5
			TURN_CHAR_TO_FACE_PLAYER baddie6_hm5 player
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT baddie6_hm5 player
			flag_baddie6_mad_hm5 = 1
		ENDIF

	ENDIF

	IF flag_baddie7_mad_hm5 = 0

		IF NOT IS_CHAR_DEAD baddie7_hm5
			TURN_CHAR_TO_FACE_PLAYER baddie7_hm5 player
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT baddie7_hm5 player
			flag_baddie7_mad_hm5 = 1
		ENDIF

	ENDIF

	IF flag_baddie8_mad_hm5 = 0

		IF NOT IS_CHAR_DEAD baddie8_hm5
			TURN_CHAR_TO_FACE_PLAYER baddie8_hm5 player
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT baddie8_hm5 player
			flag_baddie8_mad_hm5 = 1
		ENDIF

	ENDIF

	IF flag_baddie9_mad_hm5 = 0

		IF NOT IS_CHAR_DEAD baddie9_hm5
			TURN_CHAR_TO_FACE_PLAYER baddie9_hm5 player
			SET_CHAR_OBJ_KILL_PLAYER_ON_FOOT baddie9_hm5 player
			flag_baddie9_mad_hm5 = 1
		ENDIF

	ENDIF
	
ENDIF 	

// Checks for baddie1

IF flag_baddie1_dead_hm5 = 0

	IF IS_CHAR_DEAD baddie1_hm5

		IF HAS_CHAR_BEEN_DAMAGED_BY_WEAPON baddie1_hm5 WEAPONTYPE_BASEBALLBAT
			REMOVE_BLIP radar_blip_ped1_hm5
			++ counter_no_of_baddies_dead_hm5
			flag_baddie1_dead_hm5 = 1
		ELSE
			PRINT_NOW ( HM5_3 ) 7000 1 //You were told to use a baseball bat only!"
			GOTO mission_hood5_failed
		ENDIF

	ENDIF

ENDIF

// Checks for baddie2

IF flag_baddie2_dead_hm5 = 0

	IF IS_CHAR_DEAD baddie2_hm5

		IF HAS_CHAR_BEEN_DAMAGED_BY_WEAPON baddie2_hm5 WEAPONTYPE_BASEBALLBAT
			REMOVE_BLIP radar_blip_ped2_hm5
			++ counter_no_of_baddies_dead_hm5
			flag_baddie2_dead_hm5 = 1
		ELSE
			PRINT_NOW ( HM5_3 ) 7000 1 //You were told to use a baseball bat only!"
			GOTO mission_hood5_failed
		ENDIF

	ENDIF

ENDIF

// Checks for baddie3

IF flag_baddie3_dead_hm5 = 0

	IF IS_CHAR_DEAD baddie3_hm5

		IF HAS_CHAR_BEEN_DAMAGED_BY_WEAPON baddie3_hm5 WEAPONTYPE_BASEBALLBAT
			REMOVE_BLIP radar_blip_ped3_hm5
			++ counter_no_of_baddies_dead_hm5
			flag_baddie3_dead_hm5 = 1
		ELSE
			PRINT_NOW ( HM5_3 ) 7000 1 //You were told to use a baseball bat only!"
			GOTO mission_hood5_failed
		ENDIF

	ENDIF

ENDIF

// Checks for baddie4

IF flag_baddie4_dead_hm5 = 0

	IF IS_CHAR_DEAD baddie4_hm5

		IF HAS_CHAR_BEEN_DAMAGED_BY_WEAPON baddie4_hm5 WEAPONTYPE_BASEBALLBAT
			REMOVE_BLIP radar_blip_ped4_hm5
			++ counter_no_of_baddies_dead_hm5
			flag_baddie4_dead_hm5 = 1
		ELSE
			PRINT_NOW ( HM5_3 ) 7000 1 //You were told to use a baseball bat only!"
			GOTO mission_hood5_failed
		ENDIF

	ENDIF

ENDIF

// Checks for baddie5

IF flag_baddie5_dead_hm5 = 0

	IF IS_CHAR_DEAD baddie5_hm5

		IF HAS_CHAR_BEEN_DAMAGED_BY_WEAPON baddie5_hm5 WEAPONTYPE_BASEBALLBAT
			REMOVE_BLIP radar_blip_ped5_hm5
			++ counter_no_of_baddies_dead_hm5
			flag_baddie5_dead_hm5 = 1
		ELSE
			PRINT_NOW ( HM5_3 ) 7000 1 //You were told to use a baseball bat only!"
			GOTO mission_hood5_failed
		ENDIF

	ENDIF

ENDIF

// Checks for baddie6

IF flag_baddie6_dead_hm5 = 0

	IF IS_CHAR_DEAD baddie6_hm5

		IF HAS_CHAR_BEEN_DAMAGED_BY_WEAPON baddie6_hm5 WEAPONTYPE_BASEBALLBAT
			REMOVE_BLIP radar_blip_ped6_hm5
			++ counter_no_of_baddies_dead_hm5
			flag_baddie6_dead_hm5 = 1
		ELSE
			PRINT_NOW ( HM5_3 ) 7000 1 //You were told to use a baseball bat only!"
			GOTO mission_hood5_failed
		ENDIF

	ENDIF

ENDIF


// Checks for baddie7

IF flag_baddie7_dead_hm5 = 0

	IF IS_CHAR_DEAD baddie7_hm5

		IF HAS_CHAR_BEEN_DAMAGED_BY_WEAPON baddie7_hm5 WEAPONTYPE_BASEBALLBAT
			REMOVE_BLIP radar_blip_ped7_hm5
			++ counter_no_of_baddies_dead_hm5
			flag_baddie7_dead_hm5 = 1
		ELSE
			PRINT_NOW ( HM5_3 ) 7000 1 //You were told to use a baseball bat only!"
			GOTO mission_hood5_failed
		ENDIF

	ENDIF

ENDIF

// Checks for baddie8

IF flag_baddie8_dead_hm5 = 0

	IF IS_CHAR_DEAD baddie8_hm5

		IF HAS_CHAR_BEEN_DAMAGED_BY_WEAPON baddie8_hm5 WEAPONTYPE_BASEBALLBAT
			REMOVE_BLIP radar_blip_ped8_hm5
			++ counter_no_of_baddies_dead_hm5
			flag_baddie8_dead_hm5 = 1
		ELSE
			PRINT_NOW ( HM5_3 ) 7000 1 //You were told to use a baseball bat only!"
			GOTO mission_hood5_failed
		ENDIF

	ENDIF

ENDIF

// Checks for baddie9

IF flag_baddie9_dead_hm5 = 0

	IF IS_CHAR_DEAD baddie9_hm5

		IF HAS_CHAR_BEEN_DAMAGED_BY_WEAPON baddie9_hm5 WEAPONTYPE_BASEBALLBAT
			REMOVE_BLIP radar_blip_ped9_hm5
			++ counter_no_of_baddies_dead_hm5
			flag_baddie9_dead_hm5 = 1
		ELSE
			PRINT_NOW ( HM5_3 ) 7000 1 //You were told to use a baseball bat only!"
			GOTO mission_hood5_failed
		ENDIF

	ENDIF

ENDIF

	IF IS_PLAYER_SHOOTING_IN_AREA player -327.0 72.0 -134.0 350.0 FALSE
 
		IF flag_baddie1_dead_hm5 = 0
			GIVE_WEAPON_TO_CHAR baddie1_hm5 WEAPONTYPE_UZI 30000 
		ENDIF

		IF flag_baddie2_dead_hm5 = 0
			GIVE_WEAPON_TO_CHAR baddie2_hm5 WEAPONTYPE_UZI 30000 
		ENDIF

		IF flag_baddie3_dead_hm5 = 0
			GIVE_WEAPON_TO_CHAR baddie3_hm5 WEAPONTYPE_UZI 30000 
		ENDIF

		IF flag_baddie4_dead_hm5 = 0
			GIVE_WEAPON_TO_CHAR baddie4_hm5 WEAPONTYPE_UZI 30000 
		ENDIF

		IF flag_baddie5_dead_hm5 = 0
			GIVE_WEAPON_TO_CHAR baddie5_hm5 WEAPONTYPE_UZI 30000 
		ENDIF

		IF flag_baddie6_dead_hm5 = 0
			GIVE_WEAPON_TO_CHAR baddie6_hm5 WEAPONTYPE_UZI 30000 
		ENDIF

		IF flag_baddie7_dead_hm5 = 0
			GIVE_WEAPON_TO_CHAR baddie7_hm5 WEAPONTYPE_UZI 30000 
		ENDIF

		IF flag_baddie8_dead_hm5 = 0
			GIVE_WEAPON_TO_CHAR baddie8_hm5 WEAPONTYPE_UZI 30000 
		ENDIF

		IF flag_baddie9_dead_hm5 = 0
			GIVE_WEAPON_TO_CHAR baddie9_hm5 WEAPONTYPE_UZI 30000 
		ENDIF
				 
		PRINT_NOW ( HM5_3 ) 7000 1 //You were told to use a baseball bat only!"
		GOTO mission_hood5_failed
	
	ENDIF

	IF flag_bat_created_hm5 = 1

		IF flag_bat_collected_hm5 = 0
		
			IF HAS_PICKUP_BEEN_COLLECTED bat_hm5
				flag_bat_collected_hm5 = 1
			ENDIF

		ENDIF

	ENDIF

ENDWHILE

} 

GOTO mission_hood5_passed

 

// Mission hood5 failed

mission_hood5_failed:

PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed!"

IF HAS_PLAYER_BEEN_ARRESTED player
	OVERRIDE_POLICE_STATION_LEVEL LEVEL_SUBURBAN 
ENDIF

IF IS_PLAYER_DEAD player
	OVERRIDE_HOSPITAL_LEVEL LEVEL_SUBURBAN
ENDIF

RETURN


   

// mission hood5 passed

mission_hood5_passed:

flag_hood_mission5_passed = 1
REGISTER_MISSION_PASSED ( HM_5 )
PLAYER_MADE_PROGRESS 1
PRINT_WITH_NUMBER_BIG ( M_PASS ) 10000 5000 1 //Mission Passed!"
PLAY_MISSION_PASSED_TUNE 1
ADD_SCORE player 10000
CLEAR_WANTED_LEVEL player
REMOVE_BLIP hood_contact_blip
SET_GANG_PED_MODEL_PREFERENCE GANG_HOOD 0
START_NEW_SCRIPT hood_mission3_loop   

	// achievement checker, called after passing each phone mission
	// we can't create subroutines in gta3.. so we have to deal with this chunk being copypasta'd
	// goofy arrangement because you can't have too many ANDs in a single IF
	IF flag_meat_mission1_passed = 1
	AND flag_meat_mission2_passed = 1
	AND flag_meat_mission3_passed = 1
	AND flag_meat_mission4_passed = 1

		IF flag_diablo_mission1_passed = 1
		AND flag_diablo_mission2_passed = 1
		AND flag_diablo_mission3_passed = 1
		AND flag_diablo_mission4_passed = 1

			IF flag_yardie_mission1_passed = 1
			AND flag_yardie_mission2_passed = 1
			AND flag_yardie_mission3_passed = 1
			AND flag_yardie_mission4_passed = 1

				IF flag_hood_mission1_passed = 1
				AND flag_hood_mission2_passed = 1
				AND flag_hood_mission3_passed = 1
				AND flag_hood_mission4_passed = 1
				AND flag_hood_mission5_passed = 1
					USE_TEXT_COMMANDS 123 // HACKED achievement unlock // TALKS_A_LOT
				ENDIF
			ENDIF
		ENDIF
	ENDIF

RETURN
		


// mission cleanup

mission_cleanup_hood5:

flag_player_on_mission = 0
flag_player_on_hood_mission = 0
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_HOOD_B
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_HOOD_A
REMOVE_BLIP radar_blip_goodie_hm5
REMOVE_BLIP radar_blip_ped1_hm5
REMOVE_BLIP radar_blip_ped2_hm5
REMOVE_BLIP radar_blip_ped3_hm5
REMOVE_BLIP radar_blip_ped4_hm5
REMOVE_BLIP radar_blip_ped5_hm5
REMOVE_BLIP radar_blip_ped6_hm5
REMOVE_BLIP radar_blip_ped7_hm5
REMOVE_BLIP radar_blip_ped8_hm5
REMOVE_BLIP radar_blip_ped9_hm5

IF flag_bat_created_hm5 = 1

	IF flag_bat_collected_hm5 = 0
		REMOVE_PICKUP bat_hm5
	ENDIF

ENDIF

IF flag_baddie1_dead_hm5 = 0

	IF NOT IS_CHAR_DEAD baddie1_hm5
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie1_hm5 FALSE
	ENDIF

ENDIF

IF flag_baddie2_dead_hm5 = 0

	IF NOT IS_CHAR_DEAD baddie2_hm5
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie2_hm5 FALSE
	ENDIF

ENDIF

IF flag_baddie3_dead_hm5 = 0

	IF NOT IS_CHAR_DEAD baddie3_hm5
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie3_hm5 FALSE
	ENDIF

ENDIF

IF flag_baddie4_dead_hm5 = 0

	IF NOT IS_CHAR_DEAD baddie4_hm5
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie4_hm5 FALSE
	ENDIF

ENDIF

IF flag_baddie5_dead_hm5 = 0

	IF NOT IS_CHAR_DEAD baddie5_hm5
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie5_hm5 FALSE
	ENDIF

ENDIF

IF flag_baddie6_dead_hm5 = 0

	IF NOT IS_CHAR_DEAD baddie6_hm5
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie6_hm5 FALSE
	ENDIF

ENDIF

IF flag_baddie7_dead_hm5 = 0

	IF NOT IS_CHAR_DEAD baddie7_hm5
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie7_hm5 FALSE
	ENDIF

ENDIF

IF flag_baddie8_dead_hm5 = 0

	IF NOT IS_CHAR_DEAD baddie8_hm5
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie8_hm5 FALSE
	ENDIF

ENDIF

IF flag_baddie9_dead_hm5 = 0

	IF NOT IS_CHAR_DEAD baddie9_hm5
		SET_CHAR_ONLY_DAMAGED_BY_PLAYER baddie9_hm5 FALSE
	ENDIF

ENDIF

MISSION_HAS_FINISHED
RETURN
		

  
MISSION_START
// *******************************************************************************************
// *******************************************************************************************
// *************************************Cat mission 1*****************************************
// *************************************FINAL MISSION*****************************************
// *******************************************************************************************
// *******************************************************************************************
// *******************************************************************************************

// Mission start stuff

GOSUB mission_start_cat1

IF HAS_DEATHARREST_BEEN_EXECUTED
	GOSUB mission_cat1_failed
ENDIF

GOSUB mission_cleanup_cat1			  

MISSION_END

// Variables for mission

VAR_INT blip1_cat1 marias_blip 
VAR_INT	colubian_guard1 colubian_guard2 colubian_guard3 colubian_guard4 colubian_guard5 colubian_guard6 colubian_guard7 colubian_guard8 
VAR_INT	colubian_guard9 colubian_guard10 colubian_guard11 colubian_guard12 colubian_guard13 colubian_guard14 colubian_guard15 colubian_guard16
VAR_INT colubian_guard17 colubian_guard18 colubian_guard19 colubian_guard20 colubian_guard21 colubian_guard22 colubian_guard23 colubian_guard24  
VAR_INT colubian_guard25 colubian_guard26
VAR_INT colubian_car1 colubian_car2 colubian_car3 colubian_car4 colubian_car5 colubian_car6 colubian_car7 colubian_car8
VAR_INT escape_chopper set_as_leader_before	been_on_heli_pad Dead_guards_gun
VAR_INT countdown_cat1 rocket_launch added_the_blip_for_maria maria_created_before
VAR_INT camera_cut first_credits_loop
VAR_INT shaggin_waggin maria_prossie
VAR_FLOAT playerx_cat playery_cat playerz_cat

// ***************************************Mission Start*************************************

mission_start_cat1:

REGISTER_MISSION_GIVEN
flag_player_on_mission = 1
flag_player_on_cat_mission = 1
SCRIPT_NAME cat1
WAIT 0

added_the_blip_for_maria = 0
been_on_heli_pad = 0
set_as_leader_before = 0
maria_created_before = 0
flag_player_on_mission = 1
camera_cut = 0

SETUP_ZONE_PED_INFO WEE_DAM DAY   (0) 0 0 0 0 0 0 0 0  
SETUP_ZONE_PED_INFO WEE_DAM NIGHT (0) 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO WEE_DAM DAY   (0) 0 0 0 0 0 0 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO WEE_DAM NIGHT (0) 0 0 0 0 0 0 0 0 0 0 0 0 0	0


{
CLEAR_WANTED_LEVEL player


LOAD_SPECIAL_CHARACTER 1 Maria
LOAD_SPECIAL_CHARACTER 2 cat
LOAD_SPECIAL_CHARACTER 3 col2
LOAD_SPECIAL_CHARACTER 4 colrob
LOAD_SPECIAL_MODEL cut_obj1	fulcase
LOAD_SPECIAL_MODEL cut_obj2	cath
REQUEST_MODEL PED_GANG_COLOMBIAN_A
REQUEST_MODEL PED_GANG_COLOMBIAN_B
REQUEST_MODEL CAR_COLUMB
REQUEST_MODEL CAR_FLATBED
REQUEST_MODEL New_Colmansn
REQUEST_MODEL landpart15
REQUEST_MODEL Security_Hut 
REQUEST_MODEL columansion_wall

LOAD_ALL_MODELS_NOW

	WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
	OR NOT HAS_SPECIAL_CHARACTER_LOADED 2
	OR NOT HAS_SPECIAL_CHARACTER_LOADED 4
	OR NOT HAS_MODEL_LOADED cut_obj1
	OR NOT HAS_MODEL_LOADED cut_obj2
		WAIT 0
	ENDWHILE

	WHILE NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_A 
	OR NOT HAS_MODEL_LOADED PED_GANG_COLOMBIAN_B
		WAIT 0
	ENDWHILE

	WHILE NOT HAS_MODEL_LOADED CAR_COLUMB
	OR NOT HAS_MODEL_LOADED	New_Colmansn
	OR NOT HAS_MODEL_LOADED	landpart15
	OR NOT HAS_MODEL_LOADED Security_Hut
	OR NOT HAS_MODEL_LOADED columansion_wall
		WAIT 0

	ENDWHILE

LOAD_SCENE -363.5 243.5 59.3

LOAD_CUTSCENE C1_TEX
SET_CUTSCENE_OFFSET -358.553 249.189 59.329 

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_maria
SET_CUTSCENE_ANIM cs_maria maria

CREATE_CUTSCENE_OBJECT PED_SPECIAL2 cs_cat
SET_CUTSCENE_ANIM cs_cat cat

//CREATE_CUTSCENE_OBJECT PED_SPECIAL3 cs_colub1
//SET_CUTSCENE_ANIM cs_colub1 col2 //(unarmed) 

CREATE_CUTSCENE_OBJECT PED_SPECIAL4 cs_colub2
SET_CUTSCENE_ANIM cs_colub2 colrob //(Pistol)  

CREATE_CUTSCENE_OBJECT PED_GANG_COLOMBIAN_A cs_colub3
SET_CUTSCENE_ANIM cs_colub3 gang11 //(unarmed)

CREATE_CUTSCENE_OBJECT PED_GANG_COLOMBIAN_B cs_colub4
SET_CUTSCENE_ANIM cs_colub4 gang12 //(unarmed) 

CREATE_CUTSCENE_OBJECT cut_obj1 cs_case
SET_CUTSCENE_ANIM cs_case fulcase 

CREATE_CUTSCENE_HEAD cs_cat cut_obj2 cs_cathead
SET_CUTSCENE_HEAD_ANIM cs_cathead cat

CREATE_CAR CAR_COLUMB -422.9 291.8 61.8 colubian_car1
SET_CAR_HEADING colubian_car1 226.0

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -395.4 293.4 -100.0 colubian_guard1	//Near Cat
GIVE_WEAPON_TO_CHAR colubian_guard1 WEAPONTYPE_UZI 200
//ADD_ARMOUR_TO_CHAR colubian_guard1 100

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -368.1 252.4 -100.0 colubian_guard3	//Guarding gate (west)
GIVE_WEAPON_TO_CHAR colubian_guard3 WEAPONTYPE_UZI 200
SET_CHAR_HEADING colubian_guard3 0.0

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -358.0 251.8 -100.0 colubian_guard4	//Guarding gate	(east)
GIVE_WEAPON_TO_CHAR colubian_guard4 WEAPONTYPE_UZI 200
SET_CHAR_HEADING colubian_guard4 0.0

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -392.4 301.0 70.7 colubian_guard12 //On masion balcony (west)
GIVE_WEAPON_TO_CHAR colubian_guard12 WEAPONTYPE_CHAINGUN 200
SET_CHAR_HEADING colubian_guard12 0.0
SET_CHAR_STAY_IN_SAME_PLACE colubian_guard12 TRUE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -374.0 301.0 70.7 colubian_guard13 //On masion balcony (east)
GIVE_WEAPON_TO_CHAR colubian_guard13 WEAPONTYPE_CHAINGUN 200
SET_CHAR_HEADING colubian_guard13 0.0
SET_CHAR_STAY_IN_SAME_PLACE colubian_guard13 TRUE

SET_EVERYONE_IGNORE_PLAYER Player ON

TURN_CHAR_TO_FACE_PLAYER colubian_guard1 Player
TURN_CHAR_TO_FACE_PLAYER colubian_guard12 Player
TURN_CHAR_TO_FACE_PLAYER colubian_guard13 Player
CLEAR_AREA -362.8 246.5 60.0 4.5 TRUE


CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -380.1 282.6 -100.0 colubian_guard2	 //Dead guard
SET_CHAR_HEADING colubian_guard2 229.0
SET_CHAR_HEALTH	colubian_guard2 0

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF
SWITCH_STREAMING ON			 
START_CUTSCENE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time


WHILE cs_time < 22000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

SET_PLAYER_COORDINATES player -363.3 253.0 -100.0
//PRINT_NOW ( CAT2_A1 ) 3000 2 // Mission brief

WHILE cs_time < 32166
	WAIT 0		
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( CAT2_A ) 10000 2 // Mission brief

WHILE cs_time < 38548
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( CAT2_B ) 10000 2 // Mission brief

WHILE cs_time < 40043
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( CAT2_B2 ) 10000 2 // Mission brief

WHILE cs_time < 43684
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( CAT2_C ) 10000 2 // Mission brief

WHILE cs_time < 45711
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( CAT2_D ) 10000 2 // Mission brief

WHILE cs_time < 52048
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( CAT2_E ) 10000 2 // Mission brief

WHILE cs_time < 54527
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( CAT2_E2 ) 10000 2 // Mission brief

WHILE cs_time < 57558
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( CAT2_E3 ) 10000 2 // Mission brief

WHILE cs_time < 58661
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS 

WHILE cs_time < 65000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

CLEAR_PRINTS

DO_FADE 1000 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

CREATE_PICKUP_WITH_AMMO WEAPON_COLT45 PICKUP_ONCE 48 -380.1 282.6 62.6 Dead_guards_gun
CLEAR_AREA -381.8 284.0 62.9 1.0 TRUE
SET_PLAYER_COORDINATES player -381.8 284.0 -100.0
SET_PLAYER_HEADING player 232.0

//WHILE NOT HAS_CUTSCENE_FINISHED
//	WAIT 0
//ENDWHILE

//SWITCH_WORLD_PROCESSING ON
SWITCH_RUBBISH ON
CLEAR_CUTSCENE
SET_EVERYONE_IGNORE_PLAYER Player ON
SET_CAMERA_BEHIND_PLAYER


REMOVE_ALL_PLAYER_WEAPONS Player

//WAIT 500

DO_FADE 1000 FADE_IN

IF nicked_half_a_mil_before = 0
	ADD_SCORE player -500000
	nicked_half_a_mil_before = 1
ENDIF

UNLOAD_SPECIAL_CHARACTER 3
UNLOAD_SPECIAL_CHARACTER 4
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ1
MARK_MODEL_AS_NO_LONGER_NEEDED CUT_OBJ2
MARK_MODEL_AS_NO_LONGER_NEEDED New_Colmansn
MARK_MODEL_AS_NO_LONGER_NEEDED landpart15
MARK_MODEL_AS_NO_LONGER_NEEDED Security_Hut
MARK_MODEL_AS_NO_LONGER_NEEDED columansion_wall

	WHILE NOT HAS_MODEL_LOADED CAR_FLATBED
		WAIT 0

	ENDWHILE

PRINT_NOW ( CATINF1 ) 5000 2 // Mission brief

WAIT 1000


SET_EVERYONE_IGNORE_PLAYER Player OFF
//GOTO last_cutscene //TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

//flag_cat_mission1_passed = 1
//START_NEW_SCRIPT credits_loop
//GOSUB credits


countdown_cat1 = 421000
DISPLAY_ONSCREEN_TIMER countdown_cat1


IF NOT IS_CHAR_DEAD colubian_guard1
AND NOT IS_CHAR_DEAD colubian_guard2
AND NOT IS_CHAR_DEAD colubian_guard12
AND NOT IS_CHAR_DEAD colubian_guard13
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard1 Player
	SET_CHAR_THREAT_SEARCH colubian_guard1 THREAT_PLAYER1
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard2 Player
	SET_CHAR_THREAT_SEARCH colubian_guard2 THREAT_PLAYER1
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard12	Player
	SET_CHAR_THREAT_SEARCH colubian_guard12 THREAT_PLAYER1
	SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard13	Player
	SET_CHAR_THREAT_SEARCH colubian_guard13 THREAT_PLAYER1
ENDIF

IF NOT IS_CHAR_DEAD colubian_guard3
AND NOT IS_CHAR_DEAD colubian_guard4
	SET_CHAR_THREAT_SEARCH colubian_guard3 THREAT_PLAYER1
	SET_CHAR_THREAT_SEARCH colubian_guard4 THREAT_PLAYER1
ENDIF

SWITCH_PED_ROADS_OFF -942.6 337.0 10.0 -953.6 361.4 30.0 // DAM

WHILE IS_PLAYER_IN_AREA_3D player -448.0 241.7 50.0 -292.4 365.2 90.0 FALSE
	WAIT 0

	IF countdown_cat1 = 0
		GOTO mission_cat1_failed
	ENDIF

	CLEAR_WANTED_LEVEL player
	
ENDWHILE

START_CATALINA_HELI							  

escape_chopper = -1

WHILE escape_chopper = -1
	WAIT 0
		GRAB_CATALINA_HELI escape_chopper
ENDWHILE

WAIT 1000

IF NOT IS_CAR_DEAD escape_chopper 
	ADD_BLIP_FOR_CAR escape_chopper blip1_cat1
	CHANGE_BLIP_DISPLAY blip1_cat1 BLIP_ONLY
	SET_FIXED_CAMERA_POSITION -364.5 243.7 62.7 0.0 0.0 0.0
	POINT_CAMERA_AT_CAR escape_chopper FIXED INTERPOLATION
	SWITCH_WIDESCREEN ON
	SET_PLAYER_CONTROL Player Off
	SET_POLICE_IGNORE_PLAYER Player ON
	SET_EVERYONE_IGNORE_PLAYER Player ON
	SET_CAR_PROOFS escape_chopper TRUE TRUE TRUE TRUE TRUE
ENDIF

IF IS_PLAYER_IN_ANY_CAR Player
	APPLY_BRAKES_TO_PLAYERS_CAR Player ON
ENDIF


WAIT 5000

RESTORE_CAMERA
SWITCH_WIDESCREEN OFF
SET_PLAYER_CONTROL Player ON
APPLY_BRAKES_TO_PLAYERS_CAR Player OFF
SET_POLICE_IGNORE_PLAYER Player OFF
SET_EVERYONE_IGNORE_PLAYER Player OFF

IF IS_PLAYER_IN_ANY_CAR Player
	APPLY_BRAKES_TO_PLAYERS_CAR Player OFF
ENDIF

PRINT_NOW ( CATINF2 ) 5000 2 // Mission brief

	WHILE NOT IS_PLAYER_IN_ZONE player BIG_DAM
		WAIT 0

		IF countdown_cat1 = 0
			PRINT_NOW ( OUTTIME ) 5000 1
			GOTO mission_cat1_failed
		ENDIF

		IF HAS_CATALINA_HELI_BEEN_SHOT_DOWN
			GOTO end_of_game
		ENDIF

		CLEAR_WANTED_LEVEL player

	ENDWHILE


SET_THREAT_FOR_PED_TYPE	PEDTYPE_GANG_COLOMBIAN THREAT_PLAYER1
SET_GANG_WEAPONS GANG_COLOMBIAN WEAPONTYPE_UZI WEAPONTYPE_CHAINGUN //The COLUMBIANS

MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard1
MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard2
MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard3
MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard4

CREATE_CAR CAR_COLUMB -946.8 310.0 -100.0 colubian_car6
SET_CAR_HEADING colubian_car6 104.7

CREATE_CAR CAR_COLUMB -952.3 310.3 -100.0 colubian_car7
SET_CAR_HEADING colubian_car7 78.8

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -955.5 309.7 -100.0 colubian_guard14 //guards by 1st columbian block
SET_CHAR_HEADING colubian_guard14 220.0
SET_CHAR_THREAT_SEARCH colubian_guard14 THREAT_PLAYER1
//ADD_ARMOUR_TO_CHAR colubian_guard14 100
GIVE_WEAPON_TO_CHAR colubian_guard14 WEAPONTYPE_CHAINGUN 500

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -943.0 311.0 -100.0 colubian_guard15 //guards by 1st columbian block
SET_CHAR_HEADING colubian_guard15 176.0
//ADD_ARMOUR_TO_CHAR colubian_guard15 100
SET_CHAR_THREAT_SEARCH colubian_guard15 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR colubian_guard15 WEAPONTYPE_CHAINGUN 500

CREATE_CAR CAR_COLUMB -1035.7 464.1 -100.0 colubian_car2
SET_CAR_HEADING colubian_car2 194.0

CREATE_CAR CAR_COLUMB -1033.8 458.9 -100.0 colubian_car3
SET_CAR_HEADING colubian_car3 330.8


CREATE_PICKUP_WITH_AMMO WEAPON_ROCKET PICKUP_ONCE 3 -1149.7 347.7 30.4 rocket_launch

	WHILE NOT IS_PLAYER_IN_ZONE player WEE_DAM
		WAIT 0

		IF countdown_cat1 = 0
			PRINT_NOW ( OUTTIME ) 5000 1
			GOTO mission_cat1_failed
		ENDIF

		IF HAS_CATALINA_HELI_BEEN_SHOT_DOWN
			GOTO end_of_game
		ENDIF

		CLEAR_WANTED_LEVEL player

	ENDWHILE

SET_POLICE_IGNORE_PLAYER Player ON


//SET_GANG_PLAYER_ATTITUDE GANG_COLOMBIAN HATES player //The COLUMBIANS

//SWITCH_PED_ROADS_ON -952.5 361.4 10.0 -939.3 374.0 30.0 // DAM
/*
SETUP_ZONE_PED_INFO WEE_DAM DAY   (15) 0 0 0 0 0 1000 0 0  
SETUP_ZONE_PED_INFO WEE_DAM NIGHT (15) 0 0 0 0 0 1000 0 0
SETUP_ZONE_CAR_INFO WEE_DAM DAY   (0) 0 0 0 0 0 0 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO WEE_DAM NIGHT (0) 0 0 0 0 0 0 0 0 0 0 0 0 0	0
*/

	WHILE NOT IS_PLAYER_IN_AREA_3D player -927.4 391.5 50.0 -1124.3 485.1 0.0 FALSE
		WAIT 0							  

		IF countdown_cat1 = 0
			GOTO mission_cat1_failed
		ENDIF

		IF HAS_CATALINA_HELI_BEEN_SHOT_DOWN
			GOTO end_of_game
		ENDIF

		CLEAR_WANTED_LEVEL player
		
	ENDWHILE

MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard14
MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard15
MARK_CAR_AS_NO_LONGER_NEEDED colubian_car6
MARK_CAR_AS_NO_LONGER_NEEDED colubian_car7

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1037.2 467.9 -100.0 colubian_guard5 //guards by 2nd columbian block
SET_CHAR_HEADING colubian_guard5 272.0
SET_CHAR_THREAT_SEARCH colubian_guard5 THREAT_PLAYER1
//ADD_ARMOUR_TO_CHAR colubian_guard5 100
GIVE_WEAPON_TO_CHAR colubian_guard5 WEAPONTYPE_M16 500

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1035.0 454.8 -100.0 colubian_guard6 //guards by 2nd columbian block
SET_CHAR_HEADING colubian_guard6 247.0
//ADD_ARMOUR_TO_CHAR colubian_guard6 100
SET_CHAR_THREAT_SEARCH colubian_guard6 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR colubian_guard6 WEAPONTYPE_M16 500

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1087.8 472.0 -100.0 colubian_guard7 //Fist guard on tower
SET_CHAR_HEADING colubian_guard7 237.0
//ADD_ARMOUR_TO_CHAR colubian_guard7 100
SET_CHAR_STAY_IN_SAME_PLACE colubian_guard7 TRUE
SET_CHAR_THREAT_SEARCH colubian_guard7 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR colubian_guard7 WEAPONTYPE_M16 500
SET_CHAR_ACCURACY colubian_guard7 40

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1142.3 445.3 -100.0 colubian_guard8 //First guard on second tower
SET_CHAR_HEADING colubian_guard8 287.0
//ADD_ARMOUR_TO_CHAR colubian_guard8 100
SET_CHAR_STAY_IN_SAME_PLACE colubian_guard8 TRUE
SET_CHAR_THREAT_SEARCH colubian_guard8 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR colubian_guard8 WEAPONTYPE_M16 500
SET_CHAR_ACCURACY colubian_guard8 40

CREATE_CAR CAR_FLATBED -1086.1 464.4 -100.0 colubian_car4
SET_CAR_HEADING colubian_car4 215.0

CREATE_CAR CAR_FLATBED -1174.8 406.9 -100.0 colubian_car5
SET_CAR_HEADING colubian_car5 322.0

CREATE_CAR CAR_FLATBED -1164.2 393.7 -100.0 colubian_car8
SET_CAR_HEADING colubian_car8 23.8

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1065.3 453.8 -100.0 colubian_guard16 //guards by 2nd columbian block
SET_CHAR_HEADING colubian_guard16 289.0
SET_CHAR_THREAT_SEARCH colubian_guard16 THREAT_PLAYER1
//ADD_ARMOUR_TO_CHAR colubian_guard16 100
GIVE_WEAPON_TO_CHAR colubian_guard16 WEAPONTYPE_CHAINGUN 500
SET_CHAR_STAY_IN_SAME_PLACE colubian_guard16 TRUE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1066.3 475.8 -100.0 colubian_guard17 //guards by 2nd columbian block
SET_CHAR_HEADING colubian_guard17 224.0
//ADD_ARMOUR_TO_CHAR colubian_guard17 100
SET_CHAR_THREAT_SEARCH colubian_guard17 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR colubian_guard17 WEAPONTYPE_CHAINGUN 500

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1104.9 440.1 -100.0 colubian_guard18 //On boxes
SET_CHAR_HEADING colubian_guard18 292.0
SET_CHAR_THREAT_SEARCH colubian_guard18 THREAT_PLAYER1
//ADD_ARMOUR_TO_CHAR colubian_guard18 100
GIVE_WEAPON_TO_CHAR colubian_guard18 WEAPONTYPE_M16 500

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1125.4 448.8 -100.0 colubian_guard19 //On boxes
SET_CHAR_HEADING colubian_guard19 272.0
//ADD_ARMOUR_TO_CHAR colubian_guard19 100
SET_CHAR_THREAT_SEARCH colubian_guard19 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR colubian_guard19 WEAPONTYPE_M16 500
SET_CHAR_STAY_IN_SAME_PLACE colubian_guard19 TRUE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1159.5 424.2 -100.0 colubian_guard22 //By boxes
SET_CHAR_HEADING colubian_guard22 278.0
//ADD_ARMOUR_TO_CHAR colubian_guard22 100
SET_CHAR_THREAT_SEARCH colubian_guard22 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR colubian_guard22 WEAPONTYPE_CHAINGUN 500

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1170.0 379.9 -100.0 colubian_guard23 //ground near heli pad
SET_CHAR_HEADING colubian_guard23 309.0
//ADD_ARMOUR_TO_CHAR colubian_guard23 100
SET_CHAR_THREAT_SEARCH colubian_guard23 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR colubian_guard23 WEAPONTYPE_CHAINGUN 500

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1171.7 384.8 -100.0 colubian_guard24 //ground near heli pad
SET_CHAR_HEADING colubian_guard24 309.0
//ADD_ARMOUR_TO_CHAR colubian_guard24 100
SET_CHAR_THREAT_SEARCH colubian_guard24 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR colubian_guard24 WEAPONTYPE_M16 500

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1156.8 407.5 -100.0 colubian_guard26 //ground near heli pad
SET_CHAR_HEADING colubian_guard26 319.0
//ADD_ARMOUR_TO_CHAR colubian_guard26 100
SET_CHAR_THREAT_SEARCH colubian_guard26 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR colubian_guard26 WEAPONTYPE_M16 500

	WHILE NOT IS_PLAYER_IN_AREA_3D player -1111.2 446.0 20.0 -1221.7 366.6 30.0 FALSE
		WAIT 0

		IF countdown_cat1 = 0
			PRINT_NOW ( OUTTIME ) 5000 1
			GOTO mission_cat1_failed
		ENDIF

		IF HAS_CATALINA_HELI_BEEN_SHOT_DOWN
			GOTO end_of_game
		ENDIF

		CLEAR_WANTED_LEVEL player

	ENDWHILE

//MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard5
//MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard6
//MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard7
//MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard8
//MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard16
//MARK_CHAR_AS_NO_LONGER_NEEDED colubian_guard17
MARK_CAR_AS_NO_LONGER_NEEDED colubian_car2
MARK_CAR_AS_NO_LONGER_NEEDED colubian_car3

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1183.0 370.9 -100.0 colubian_guard9 //Below Heli Pad with flame thrower
SET_CHAR_HEADING colubian_guard9 342.0
SET_CHAR_THREAT_SEARCH colubian_guard9 THREAT_PLAYER1
//ADD_ARMOUR_TO_CHAR colubian_guard9 100
GIVE_WEAPON_TO_CHAR colubian_guard9 WEAPONTYPE_FLAMETHROWER 1000
SET_CHAR_ACCURACY colubian_guard9 30

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B -1204.9 343.0 -100.0 colubian_guard10 //On heli pad with flame thrower
SET_CHAR_HEADING colubian_guard10 342.0
//ADD_ARMOUR_TO_CHAR colubian_guard10 100
SET_CHAR_THREAT_SEARCH colubian_guard10 THREAT_PLAYER1
GIVE_WEAPON_TO_CHAR colubian_guard10 WEAPONTYPE_FLAMETHROWER 1000
SET_CHAR_STAY_IN_SAME_PLACE colubian_guard10 TRUE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1188.5 368.0 -100.0 colubian_guard20 //On heli pad with M16
SET_CHAR_HEADING colubian_guard20 7.0
SET_CHAR_THREAT_SEARCH colubian_guard20 THREAT_PLAYER1
//ADD_ARMOUR_TO_CHAR colubian_guard20 100
GIVE_WEAPON_TO_CHAR colubian_guard20 WEAPONTYPE_M16 1000
SET_CHAR_ACCURACY colubian_guard20 30
SET_CHAR_STAY_IN_SAME_PLACE colubian_guard20 TRUE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1176.3 357.1 -100.0 colubian_guard21 //On heli pad with AK47
SET_CHAR_HEADING colubian_guard21 58.0
SET_CHAR_THREAT_SEARCH colubian_guard21 THREAT_PLAYER1
//ADD_ARMOUR_TO_CHAR colubian_guard21 100
GIVE_WEAPON_TO_CHAR colubian_guard21 WEAPONTYPE_CHAINGUN 1000
SET_CHAR_ACCURACY colubian_guard21 30
SET_CHAR_STAY_IN_SAME_PLACE colubian_guard21 TRUE

CREATE_CHAR PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_A -1199.4 334.1 -100.0 colubian_guard25 //On heli pad with AK47
SET_CHAR_HEADING colubian_guard25 3.0
SET_CHAR_THREAT_SEARCH colubian_guard21 THREAT_PLAYER1
//ADD_ARMOUR_TO_CHAR colubian_guard25 100
GIVE_WEAPON_TO_CHAR colubian_guard25 WEAPONTYPE_CHAINGUN 1000
SET_CHAR_ACCURACY colubian_guard25 30
SET_CHAR_STAY_IN_SAME_PLACE colubian_guard25 TRUE
										 
CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 -1201.6 338.6 -100.0 maria
SET_CHAR_PROOFS maria TRUE TRUE TRUE TRUE TRUE
SET_ANIM_GROUP_FOR_CHAR maria ANIM_SEXY_WOMANPED
CHAR_LOOK_AT_PLAYER_ALWAYS maria Player
SET_CHAR_HEADING maria 339.0
maria_created_before = 1

CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL2 -1182.0 346.1 -100.0 catalina
SET_CHAR_PROOFS catalina TRUE TRUE TRUE TRUE TRUE
SET_ANIM_GROUP_FOR_CHAR	catalina ANIM_SEXY_WOMANPED

//SHORT CATALINA ESCAPE CUT SCENE
	IF NOT IS_CHAR_DEAD catalina 
		SET_FIXED_CAMERA_POSITION -1190.6 334.4 32.1 0.0 0.0 0.0
		POINT_CAMERA_AT_CHAR maria FIXED JUMP_CUT
		SET_PLAYER_CONTROL Player OFF
		SWITCH_WIDESCREEN ON
		//SET_POLICE_IGNORE_PLAYER player ON
		SET_EVERYONE_IGNORE_PLAYER Player ON

		IF IS_PLAYER_IN_ANY_CAR Player
			APPLY_BRAKES_TO_PLAYERS_CAR Player ON
		ENDIF

		LOAD_MISSION_AUDIO C_1

		WAIT 3000

		IF NOT IS_CHAR_DEAD	catalina
			POINT_CAMERA_AT_CHAR catalina FIXED INTERPOLATION
			SET_CHAR_OBJ_RUN_TO_COORD catalina -1163.3 341.2
			PRINT_NOW ( CAT2_J ) 3000 2 // Mission brief
		ENDIF

		WHILE NOT HAS_MISSION_AUDIO_LOADED
			WAIT 0
		ENDWHILE

		PLAY_MISSION_AUDIO

	ENDIF

	WAIT 3000

//SWITCH_ROADS_ON -952.5 361.4 10.0 -939.3 374.0 30.0 // DAM

SWITCH_WIDESCREEN OFF
SET_PLAYER_CONTROL Player ON
RESTORE_CAMERA_JUMPCUT
DELETE_CHAR	catalina
//SET_POLICE_IGNORE_PLAYER Player OFF
SET_EVERYONE_IGNORE_PLAYER Player OFF

	IF IS_PLAYER_IN_ANY_CAR Player
		APPLY_BRAKES_TO_PLAYERS_CAR Player OFF
	ENDIF

WAIT 1000

IF NOT IS_CHAR_DEAD	maria
	SET_CHAR_PROOFS maria FALSE FALSE FALSE FALSE FALSE
ENDIF

	IF NOT IS_CAR_DEAD escape_chopper
		SET_CAR_PROOFS escape_chopper FALSE FALSE FALSE FALSE FALSE 
		CATALINA_HELI_TAKE_OFF
	ENDIF

IF NOT IS_CAR_DEAD colubian_car5
	CREATE_CHAR_INSIDE_CAR colubian_car5 PEDTYPE_GANG_COLOMBIAN PED_GANG_COLOMBIAN_B colubian_guard11
	GIVE_WEAPON_TO_CHAR colubian_guard11 WEAPONTYPE_CHAINGUN 300
	SET_CAR_MISSION colubian_car5 MISSION_RAMPLAYER_FARAWAY
	SET_CAR_CRUISE_SPEED colubian_car5 40.0
	SET_CAR_DRIVING_STYLE colubian_car5 3
ENDIF

	  
	WHILE NOT HAS_CATALINA_HELI_BEEN_SHOT_DOWN 
		WAIT 0
		
		GET_PLAYER_COORDINATES Player playerx_cat playery_cat playerz_cat

		IF countdown_cat1 = 0
			PRINT_NOW ( OUTTIME ) 5000 1
			GOTO mission_cat1_failed
		ENDIF

		IF IS_CHAR_DEAD	maria
			PRINT_NOW ( BITCH_D ) 5000 1
			GOTO mission_cat1_failed  
		ENDIF
		
		IF LOCATE_PLAYER_ON_FOOT_CHAR_3D Player maria 10.0 10.0 3.0 FALSE
			IF set_as_leader_before = 0
				STOP_CHAR_LOOKING maria
				SET_PLAYER_AS_LEADER maria player 
				set_as_leader_before = 1
			ENDIF 
		ELSE
			IF set_as_leader_before = 1
				set_as_leader_before = 0
			ENDIF
		ENDIF	
		/*
		IF NOT IS_CAR_DEAD escape_chopper
			IF LOCATE_PLAYER_ANY_MEANS_CAR_3D Player escape_chopper 20.0 20.0 30.0 FALSE
				GET_PLAYER_COORDINATES Player playerx_cat playery_cat playerz_cat
				//playerz_cat = playerz_cat + 1

				SET_FIXED_CAMERA_POSITION playerx_cat playery_cat playerz_cat 0.0 0.0 0.0
				POINT_CAMERA_AT_CAR escape_chopper FIXED INTERPOLATION
			ELSE
				RESTORE_CAMERA 
			ENDIF
		ENDIF
		*/
		IF IS_PLAYER_IN_AREA_3D Player -1142.0 327.8 29.0 -1215.6 368.4 40.0 FALSE
			IF been_on_heli_pad = 0
  				IF NOT IS_CHAR_DEAD	colubian_guard10
					SET_CHAR_STAY_IN_SAME_PLACE colubian_guard10 FALSE
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard10 Player
				ENDIF
				IF NOT IS_CHAR_DEAD	colubian_guard20
					SET_CHAR_STAY_IN_SAME_PLACE colubian_guard20 FALSE
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard20 Player
				ENDIF
				IF NOT IS_CHAR_DEAD	colubian_guard21
					SET_CHAR_STAY_IN_SAME_PLACE colubian_guard21 FALSE
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard21 Player
				ENDIF
				IF NOT IS_CHAR_DEAD	colubian_guard25
					SET_CHAR_STAY_IN_SAME_PLACE colubian_guard25 FALSE
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard25 Player
				ENDIF

				been_on_heli_pad = 1
			ENDIF
		ENDIF
		
		CLEAR_WANTED_LEVEL player
					
	ENDWHILE

//RESTORE_CAMERA

end_of_game:

SET_FADING_COLOUR 255 255 255
DO_FADE 500 FADE_OUT

CLEAR_ONSCREEN_TIMER countdown_cat1
REMOVE_CATALINA_HELI

IF maria_created_before = 0
	CREATE_CHAR PEDTYPE_SPECIAL PED_SPECIAL1 -1201.6 338.6 -100.0 maria
	SET_CHAR_PROOFS maria TRUE TRUE TRUE TRUE TRUE
	SET_ANIM_GROUP_FOR_CHAR	maria ANIM_SEXY_WOMANPED
	CHAR_LOOK_AT_PLAYER_ALWAYS maria Player
	SET_CHAR_HEADING maria 339.0
ENDIF

DO_FADE 500 FADE_IN

	WHILE NOT IS_CHAR_IN_PLAYERS_GROUP maria Player
		WAIT 0

		IF IS_CHAR_DEAD	maria
			PRINT_NOW ( BITCH_D ) 5000 1
			GOTO mission_cat1_failed  
		ENDIF

		IF NOT IS_CHAR_IN_PLAYERS_GROUP maria Player
			IF added_the_blip_for_maria = 0
				ADD_BLIP_FOR_CHAR maria marias_blip
				added_the_blip_for_maria = 1
			ENDIF
		ELSE
			IF added_the_blip_for_maria = 1
				REMOVE_BLIP marias_blip
				added_the_blip_for_maria = 0
			ENDIF
		ENDIF

		IF LOCATE_PLAYER_ON_FOOT_CHAR_3D Player maria 10.0 10.0 3.0 FALSE
			IF set_as_leader_before = 0
				STOP_CHAR_LOOKING maria
				SET_PLAYER_AS_LEADER maria player 
				set_as_leader_before = 1
			ENDIF 
		ELSE
			IF set_as_leader_before = 1
				set_as_leader_before = 0
			ENDIF
		ENDIF

		IF IS_PLAYER_IN_AREA_3D Player -1142.0 327.8 29.0 -1215.6 368.4 40.0 FALSE
			IF been_on_heli_pad = 0
				IF NOT IS_CHAR_DEAD	colubian_guard10
					SET_CHAR_STAY_IN_SAME_PLACE colubian_guard10 FALSE
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard10 Player
				ENDIF
				IF NOT IS_CHAR_DEAD	colubian_guard20
					SET_CHAR_STAY_IN_SAME_PLACE colubian_guard20 FALSE
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard20 Player
				ENDIF
				IF NOT IS_CHAR_DEAD	colubian_guard21
					SET_CHAR_STAY_IN_SAME_PLACE colubian_guard21 FALSE
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard21 Player
				ENDIF
				IF NOT IS_CHAR_DEAD	colubian_guard25
					SET_CHAR_STAY_IN_SAME_PLACE colubian_guard25 FALSE
					SET_CHAR_OBJ_KILL_PLAYER_ANY_MEANS colubian_guard25 Player
				ENDIF

				been_on_heli_pad = 1
			ENDIF
		ENDIF

		CLEAR_WANTED_LEVEL player
		
	ENDWHILE

//last_cutscene:	//TEST!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	GET_GAME_TIMER breakout_timer_start
	breakout_diff = 0

	WHILE NOT CAN_PLAYER_START_MISSION Player
	AND breakout_diff < 5000	//	if player is not in control after 5 secs do the cutscene anyway
		WAIT 0

		IF IS_CHAR_DEAD	maria
			PRINT_NOW ( BITCH_D ) 5000 1
			GOTO mission_cat1_failed  
		ENDIF

		GET_GAME_TIMER breakout_timer							
		breakout_diff = breakout_timer - breakout_timer_start
	ENDWHILE

	MAKE_PLAYER_SAFE_FOR_CUTSCENE Player


//END OF GAME CUT_SCENE***************************************************************************************************
CLEAR_AREA -1148.7 443.2 35.5 150.0 False  // GS-SC: Dead enemies weren't being cleared once the cutscene began

DELETE_CHAR colubian_guard8 // GS-SC: Clear room for cutscene

CLEAR_WANTED_LEVEL player
SET_FADING_COLOUR 0 0 0

DO_FADE 1500 FADE_OUT

//PRINT_BIG ( CAT2 ) 5000 2 //"Catalina"

TIMERA = 0

FORCE_WEATHER_NOW WEATHER_SUNNY

WHILE TIMERA < 1500
	WAIT 0

ENDWHILE

LOAD_SPECIAL_CHARACTER 1 Maria
	
WHILE NOT HAS_SPECIAL_CHARACTER_LOADED 1
	WAIT 0
ENDWHILE

LOAD_CUTSCENE END
LOAD_END_OF_GAME_TUNE
SET_CUTSCENE_OFFSET -1031.7601 451.7612 22.5624 

CREATE_CUTSCENE_OBJECT PED_PLAYER cs_player
SET_CUTSCENE_ANIM cs_player player

CREATE_CUTSCENE_OBJECT PED_SPECIAL1 cs_maria
SET_CUTSCENE_ANIM cs_maria maria

//CREATE_CUTSCENE_HEAD cs_maria CUT_OBJ1 cs_mariahead
//SET_CUTSCENE_HEAD_ANIM cs_mariahead maria

//CREATE_CUTSCENE_HEAD cs_player CUT_OBJ3 cs_playerhead
//SET_CUTSCENE_HEAD_ANIM cs_playerhead player

//CLEAR_AREA -381.8 284.0 62.9 1.0 TRUE
//SET_PLAYER_COORDINATES player -381.8 284.0 -100.0
//SET_PLAYER_HEADING player 232.0

//IF NOT IS_CHAR_DEAD	colubian_guard8
	//SET_CHAR_HEALTH	colubian_guard8 0
//ENDIF

DO_FADE 1500 FADE_IN

SWITCH_RUBBISH OFF

START_CUTSCENE
PLAY_END_OF_GAME_TUNE

// Displays cutscene text

GET_CUTSCENE_TIME cs_time


WHILE cs_time < 5507
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_A ) 10000 2 // Mission brief

WHILE cs_time < 7855
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_B ) 10000 2 // Mission brief

WHILE cs_time < 10313
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_C ) 10000 2 // Mission brief

WHILE cs_time < 13610
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_D ) 10000 2 // Mission brief

WHILE cs_time < 16428
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_E ) 10000 2 // Mission brief

WHILE cs_time < 20514
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_F ) 10000 2 // Mission brief

WHILE cs_time < 22827
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_G ) 10000 2 // Mission brief

WHILE cs_time < 26173
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_H ) 10000 2 // Mission brief

WHILE cs_time < 28028
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_I ) 10000 2 // Mission brief

WHILE cs_time < 29276
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_J ) 10000 2 // Mission brief

WHILE cs_time < 31901
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_K ) 10000 2 // Mission brief

WHILE cs_time < 35772
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_L ) 10000 2 // Mission brief

WHILE cs_time < 38820
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_M ) 10000 2 // Mission brief

WHILE cs_time < 42136
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_N ) 10000 2 // Mission brief

WHILE cs_time < 44646
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_O ) 10000 2 // Mission brief

WHILE cs_time < 46971
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_P ) 10000 2 // Mission brief

WHILE cs_time < 49254
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_Q ) 10000 2 // Mission brief

WHILE cs_time < 51621
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_R ) 10000 2 // Mission brief

WHILE cs_time < 54000
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_S ) 10000 2 // Mission brief

WHILE cs_time < 56584
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_T ) 10000 2 // Mission brief

WHILE cs_time < 59278
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE

PRINT_NOW ( END_U ) 4000 2 // Mission brief

WHILE cs_time < 66666
	WAIT 0
	GET_CUTSCENE_TIME cs_time
ENDWHILE


SET_MUSIC_DOES_FADE FALSE

SET_FADING_COLOUR 1 1 1
DO_FADE 2000 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

WHILE NOT HAS_CUTSCENE_FINISHED
	WAIT 0

ENDWHILE

//SWITCH_WORLD_PROCESSING ON
CLEAR_PRINTS
CLEAR_CUTSCENE

GOSUB mission_start_credits
//SET_CAMERA_BEHIND_PLAYER


}
GOTO mission_cat1_passed


 // Mission cat1 failed

mission_cat1_failed:
PRINT_BIG ( M_FAIL ) 5000 1 //"Mission Failed"
	IF NOT IS_CHAR_DEAD	maria
		REMOVE_CHAR_ELEGANTLY maria 
	ENDIF
RETURN

   

// mission cat1 passed

mission_cat1_passed:							 

USE_TEXT_COMMANDS 110 // HACKED achievement unlock // NOT_SO_FAST

flag_cat_mission1_passed = 1
flag_suburban_passed = 1
//PLAY_MISSION_PASSED_TUNE 1
//PRINT_WITH_NUMBER_BIG ( M_PASS ) 1000000 5000 1 //"Mission Passed!"
CLEAR_WANTED_LEVEL player
REGISTER_MISSION_PASSED	CAT2
PLAYER_MADE_PROGRESS 1
REMOVE_BLIP maria_contact_blip
SWITCH_CAR_GENERATOR special_tank 101
SUBURBAN_PASSED
//START_NEW_SCRIPT credits_loop
RETURN
		


// mission cleanup

mission_cleanup_cat1:

flag_player_on_mission = 0
flag_player_on_cat_mission = 0
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_A
MARK_MODEL_AS_NO_LONGER_NEEDED PED_GANG_COLOMBIAN_B
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_COLUMB
MARK_MODEL_AS_NO_LONGER_NEEDED CAR_FLATBED
UNLOAD_SPECIAL_CHARACTER 1
UNLOAD_SPECIAL_CHARACTER 2
UNLOAD_SPECIAL_CHARACTER 3
UNLOAD_SPECIAL_CHARACTER 4
//SET_FADING_COLOUR 0 0 0
CLEAR_ONSCREEN_TIMER countdown_cat1
SWITCH_PED_ROADS_ON -942.6 337.0 10.0 -953.6 361.4 30.0 // DAM
REMOVE_BLIP blip1_cat1 
REMOVE_BLIP marias_blip
DELETE_CHAR	catalina
REMOVE_CATALINA_HELI
REMOVE_PICKUP rocket_launch
REMOVE_PICKUP Dead_guards_gun
SETUP_ZONE_PED_INFO WEE_DAM DAY   (8) 0 0 0 0 0 100 0 0  
SETUP_ZONE_PED_INFO WEE_DAM NIGHT (5) 0 0 0 0 0 100 0 0
SETUP_ZONE_CAR_INFO WEE_DAM DAY   (0) 0 0 0 0 0 0 0 0 0 0 0 0 0 0
SETUP_ZONE_CAR_INFO WEE_DAM NIGHT (0) 0 0 0 0 0 0 0 0 0 0 0 0 0	0
//DO_FADE 0 FADE_OUT
//CLEAR_THREAT_FOR_PED_TYPE PEDTYPE_GANG_COLOMBIAN THREAT_PLAYER1
MISSION_HAS_FINISHED
RETURN





// **************************************CREDITS************************************************

mission_start_credits:
{
WAIT 0
SET_PLAYER_CONTROL player OFF
SET_EVERYONE_IGNORE_PLAYER player TRUE
SET_PLAYER_VISIBLE player FALSE
SWITCH_RUBBISH OFF
SWITCH_WIDESCREEN ON
ADD_SCORE player 1000000

START_CREDITS
TIMERA = 0
SET_TIME_OF_DAY 2 40
GOTO first_credits_loop

WHILE NOT ARE_CREDITS_FINISHED 
	WAIT 0

	IF camera_cut = 0

		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0

			IF TIMERA > 40000
				IF IS_BUTTON_PRESSED PAD1 CROSS
					GOTO final_final_scene
				ENDIF
			ENDIF

		ENDWHILE

		first_credits_loop:

		SET_PLAYER_COORDINATES player -361.9 248.0 -100.0 // Colubian mansion
		SET_FIXED_CAMERA_POSITION -364.393 265.064 82.87 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT -363.973 264.189 82.632 JUMP_CUT

		TIMERB = 0

		WHILE TIMERB < 20000
			WAIT 0

			IF TIMERA > 40000
				IF IS_BUTTON_PRESSED PAD1 CROSS
					GOTO final_final_scene
				ENDIF
			ENDIF

			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF

		ENDWHILE

		DO_FADE 1500 FADE_IN
		TIMERB = 0

		WHILE TIMERB < 30000
			WAIT 0

			IF TIMERA > 40000
				IF IS_BUTTON_PRESSED PAD1 CROSS
					GOTO final_final_scene
				ENDIF
			ENDIF
			
			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF
				
		ENDWHILE

		camera_cut = 1	
	ENDIF
	
	IF camera_cut = 1

		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF

			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF

		ENDWHILE

		SET_PLAYER_COORDINATES player -1174.25 -7.017 -100.0 // Industrial bit
		SET_FIXED_CAMERA_POSITION -1176.481 -17.694 75.992 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT -1175.726 -17.055 75.847 JUMP_CUT
		SET_TIME_OF_DAY 5 40

		TIMERB = 0

		WHILE TIMERB < 20000
			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF

			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF

		ENDWHILE

		DO_FADE 1500 FADE_IN
		TIMERB = 0

		WHILE TIMERB < 30000
			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF
			
			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF
				
		ENDWHILE

		camera_cut = 2	
	ENDIF

	IF camera_cut = 2

		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF

			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF

		ENDWHILE

		SET_PLAYER_COORDINATES player -468.7 -3.3 -100.0 // Projects
		SET_FIXED_CAMERA_POSITION -413.07 19.261 54.403 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT -413.942 18.976 54.006 JUMP_CUT

		TIMERB = 0

		WHILE TIMERB < 20000
			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF

			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF

		ENDWHILE

		DO_FADE 1500 FADE_IN
		TIMERB = 0

		WHILE TIMERB < 30000
			WAIT 0 

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF
			
			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF
							
		ENDWHILE

		camera_cut = 3	
	ENDIF
	
	IF camera_cut = 3

		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF

			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF

		ENDWHILE

		SET_PLAYER_COORDINATES player -855.7 -717.3 -100.0 // Airport
		SET_FIXED_CAMERA_POSITION -959.517 -656.414 55.464 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT -958.668 -656.912 55.288 JUMP_CUT
		SET_TIME_OF_DAY 22 0

		TIMERB = 0

		WHILE TIMERB < 20000
			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF

			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF

		ENDWHILE

		DO_FADE 1500 FADE_IN
		TIMERB = 0

		WHILE TIMERB < 30000
			WAIT 0 

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF
			
			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF
							
		ENDWHILE

		camera_cut = 4	
	ENDIF

	IF camera_cut = 4

		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF

			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF

		ENDWHILE

		SET_PLAYER_COORDINATES player -532.7 -611.7 43.3 // Bridge
		SET_FIXED_CAMERA_POSITION -571.592 -611.137 67.566 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT -570.697 -611.579 67.493 JUMP_CUT

		TIMERB = 0

		WHILE TIMERB < 20000
			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF

			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF

		ENDWHILE

		DO_FADE 1500 FADE_IN
		TIMERB = 0

		WHILE TIMERB < 30000
			WAIT 0 

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF
			
			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF
							
		ENDWHILE

		camera_cut = 5	
	ENDIF

	IF camera_cut = 5

		DO_FADE 1500 FADE_OUT
		WHILE GET_FADING_STATUS
			WAIT 0

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF

			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF

		ENDWHILE

		SET_PLAYER_COORDINATES player -671.6 -155.9 -100.0 // Twisted Bridge
		SET_FIXED_CAMERA_POSITION -706.590 -219.085 25.797 0.0 0.0 0.0
		POINT_CAMERA_AT_POINT -706.155 -218.190 25.696 JUMP_CUT
		SET_TIME_OF_DAY 1 20
		FORCE_WEATHER_NOW WEATHER_RAINY

		TIMERB = 0

		WHILE TIMERB < 20000
			WAIT 0
			
			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF

			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF

		ENDWHILE

		DO_FADE 1500 FADE_IN
		TIMERB = 0

		WHILE TIMERB < 40000
			WAIT 0 

			IF IS_BUTTON_PRESSED PAD1 CROSS
				GOTO final_final_scene
			ENDIF
			
			IF ARE_CREDITS_FINISHED
				GOTO final_final_scene
			ENDIF
							
		ENDWHILE

		camera_cut = 0	
	ENDIF
									  	
ENDWHILE

// **********************************END OF CAMERA CUTSCENE****************************

final_final_scene:

STOP_CREDITS
//FORCE_WEATHER_NOW WEATHER_CLOUDY   			

//SET_FADING_COLOUR 0 0 0
SET_TIME_OF_DAY 7 00

SET_MUSIC_DOES_FADE TRUE

DO_FADE 2000 FADE_OUT

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

SET_PLAYER_VISIBLE player TRUE
SET_PLAYER_HEALTH player 100
CLEAR_AREA -666.8 -1.8 18.8 2.0 TRUE
SET_PLAYER_COORDINATES player -666.8 -1.8 -100.0
LOAD_SCENE -666.8 -1.8 19.0
SET_PLAYER_HEADING player 180.0
RESTORE_CAMERA_JUMPCUT
SET_CAMERA_IN_FRONT_OF_PLAYER
SWITCH_WIDESCREEN OFF
TIMERB = 0

flag_player_on_mission = 0
flag_player_on_cat_mission = 0

TIMERB = 0

WHILE TIMERB < 2500
	WAIT 0

ENDWHILE

DO_FADE 2000 FADE_IN
STOP_END_OF_GAME_TUNE

WHILE GET_FADING_STATUS
	WAIT 0
ENDWHILE

RETURN

}
