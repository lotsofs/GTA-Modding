Grand Theft Auto GXT Editor 1.3
===============================

WARNING: Before editing *.gxt files back them up!
ВНИМАНИЕ: Перед редактированием файлов *.gxt сделайте резервные копии!

* Что это?

Как явствует из названия, редактор ресурсных файлов GTA, тех самых,
что содержат тексты, названия и сообщения игры. Ориентирован, в
основном, на использование для перевода файлов на родной язык.
Поддерживаются версии .gxt-файлов от GTA2, GTA3, GTA: Vice City и
GTA: San Andreas.


* Что требуется для работы?

Сам файл gxtedit.exe и редактируемый ресурсный файл с расширением
.gxt, .gxs или .txt (да, бывает и такое). Также желательно иметь в
каталоге с программой текстуры со шрифтами в файлах font1.bmp и
font2.bmp, и при необходимости - таблицу транслитерации gtarus.tbl.


* Как настроить программу?

После запуска вы в своё удовольствие можете наблюдать пустое окно
программы.  Время загрузить редактируемый файл.

Теперь следует разобраться с транслитерацией. Если редактирование
будет из английского в английский - проблем нет, можно забыть об
этом, но иначе стоит нажать Ctrl+T и ввести в открывшееся окно
строку перевода. Формат её прост: сначала 32 заглавных русских
буквы (кроме 'Ё'), затем - 32 строчных, и под конец, если требуется -
символы Ё и ё, а также украинские Є, є, I и i. По умолчанию (а также
если ввести пустую строку) транслитерация отсутствует. Вместо ввода
можно загрузить строку из файла; по умолчанию при запуске
загружается gtarus.tbl.

Далее, если в каталоге с программой отсутствуют файлы font1.bmp или
font2.bmp, их можно загрузить через пункты Settings->Load texture.
Текстуры нужны исключительно для окна preview внизу окна, так что
если их у вас нет - не проблема.

Для GTA San Andreas можно загрузить (Ctrl+K) список ключей, которые
будут показываться вместо шестнадцатеричных значений CRC32. Список
представляет собой простой текстовый файл, пример идёт в комплекте
под названием keys_sa.lst (файл с таким названием загружается
автоматически).


* Как происходит сам процесс?

После загрузки файла (Ctrl+O) окно заполняется его содержимым.
Основное отличие файлов gta2 и gta3 от gta:vc и gta:sa в том,
что в последних строки хранятся, разбитые на несколько секций.
Секции можно выбирать в столбце слева. Очевидно, что справа при
этом появятся строки из соответствующей секции. Если планируется
перевод, то не мешает также загрузить файл для сопоставления строк
(base file, Ctrl+B). Его содержимое появляется рядом с соответствующими
строками из основного файла. Разумеется, сохранить файл можно
обычными средствами (например, Ctrl+S).

Для редактирования строки следует дважды надавить на неё мышкой,
либо подвести курсор и нажать enter. Кстати, если загружены
соответствующие текстуры, то в нижнем правом окне будет отображаться
примерный вид того, как выбранная строка будет выглядеть в игре.

Окно редактирования состоит из двух частей (не считая кнопок):
исходной строки и поля редактирования. Текст можно набирать как
обычно, но особо внимательные заметят, что в строках присутствуют
управляющие последовательности, заключённые в символы '~'. После
ввода этого символа появится окно, где можно выбрать, какой именно
код вставить (вместо выбора достаточно нажать соответствующую
клавишу). Назначение большинства этих кодов таково:

~1~ - числовой параметр, например, количество заработанных денег;
~a~ - название района в игре (например, Idlewood);
~b~ - имя (например, Sweet);
~h~ - выделение слов повышенной яркостью;
~k~ - определённая пользователем клавиша (например, ~k~~PED_FIREWEAPON~);
~n~ - перевод строки;
~r~ - текст сообщения о проваленной миссии;
~s~ (~g~ для GTA:VC) - текст приказа (иди туда-то, сделай то-то);
~w~ - обычный текст, по умолчанию;
~y~ - название строения (например, Hospital);
~z~ - похоже, так выделяются титры в заставках;

Коды a, b, n, s, z, y практически (или совсем) не используются в GTA3
и GTA Vice City (в GTA2 вообще другая нотация).

Выбрав код ~k~, требуется выбрать, какую именно переменную требуется
вставить. После завершения редактировать Enter - принять изменения.
Если требуется, строка будет автоматически перекодирована с помощью
таблицы транслитерации.

Последовательность ~n~ обозначает перевод строки. В окне
предварительного просмотра строка, однако, не переводится (сложно
реализовать, да и ни к чему).


* Работа с секциями

Для распределения задачи перевода текстовые ресурсы можно разбить
на несколько файлов, и далее редактировать их по отдельности. Для
этого предназначены пункты Import / Export. Секции хранятся либо в
двоичном виде в файлах *.gxs, либо как текст - в *.txt. В меню
Settings можно выбрать, следует ли перекодировать строки при работе
с текстовыми файлами (Translate text export). Секции можно загружать
и через пункт Open - при этом загружать основной файл, разумеется,
необязательно. Аналогично, с помощью пункта Save отредактированные
секции можно сохранять обратно.

После выбора пункта меню (или кнопки) Import и выбора одного или
нескольких (!) файлов будет отображено окно, где нужно выбрать,
какие именно секции импортировать. После нажатия Continue выбранные
секции по возможности будут загружены и включены в открытый файл.

Пункт меню Mass export предназначен для экспортирования нескольких
секций в один файл. После его выбора необходимо выделить названия
секций, которые необходимо сохранить. Если при этом включить режим
One section - one file, то, понятно, все секции разойдутся по файлам.
В следующем окне будет необходимо ввести основу имени файла:
например, если ввести sec_.gxs, то имена будут в форме sec_XXXX.gxs,
где XXXX - название секции. Объединять файлы с секциями нельзя, но
можно поэкспортировать нужные секции скопом, умело оперируя
вышеупомянутым режимом.


* Как писать по-русски?

В оригинальных файлах игры, конечно, шрифтовые текстуры русских букв
не содержат, так что их потребуется сделать и затолкать туда
самостоятельно. После рисования текстуры также нужно сделать файл
раскладки для автоматической транслитерации. В файле font1r.bmp
находится, по моему мнению, наиболее полная раскладка символов, не
задевающая латиницу и правильно отображающаяся в верхний регистр.
Файл транслитерации для неё - gtavcrus.tbl. Разумеется, моя шрифтовая
текстура не является окончательной, а всего лишь служит основой для
более умелых художников.


* Чего не хватает?

Текстуры загружаются из *.bmp, а не непосредственно из ресурсных
файлов, поскольку формат их мне неизвестен. Вытащить эти текстуры
можно с помощью программы "Vice City TXD Viewer"
(http://people.freenet.de/steve-m) или "ViceTXD"
(http://gtavice.com). Из GTA San Andreas текстуры вытаскиваются
с помощью "TXD Workshop" (http://www.gtatools.com/). Рисунки на
кнопках тоже повторяются, но, поскольку кнопок всего пять, это
не должно быть проблемой.


* Что изменилось с предыдущих версий?

1.1		Добавлено отображение символов '!', '(', ')', '$' для второго
		(жирного) шрифта. Добавлены новые функции импорта/экспорта
		секций. Размеры символов теперь могут читаться из gta-vc.exe.

1.2		В файле транслитерации добавились символы украинской раскладки.
		Поддерживаются GTA2 и GTA San Andreas, версия теперь определяется
		автоматически. Позиция курсора не сбрасывается после
		редактирования строки. Четыре шрифта вместо трёх. Изменены
		форматы файлов экспорта gxs и txt (сохраняется версия игры).
		Шрифты Vice City в комплекте заменены на шрифты San Andreas.
		Пример перевода остался тот же. Добавлены файлы транслитерации
		gtasarus.tbl для пиратской версии San Andreas и gta2rus.tbl для
		GTA2 от "Буки".

		Версия 1.2 случайно утекла в интернет до завершения работы над
		ней, потому пришлось увеличивать номер до 1.3. Формально 1.3 -
		это завершённая версия 1.2.

1.3		Появился способ показывать нормальные ключи вместо CRC32.
		Для этого нужен файл со списком всех возможных ключей. Пример,
		созданный на основе анализа main.scm, gta_sa.exe и
		AudioEvents.txt, включён в архив (keys_sa.lst, загружается по
		умолчанию). Пофиксены мелкие глюки и недочёты. Обновлены разные
		списки для San Andreas. Появился поиск по строкам. Обновил
		документацию и перевёл её на английский язык.


* Автор

Zverik, он же - Илья Зверев.
e-mail: zverik@rbcmail.ru
Страничка программы: http://zverik.rbcmail.ru/gxtedit.html
